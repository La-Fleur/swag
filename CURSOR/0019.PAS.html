<html>
<head><title> "Very GOOD Cursor Unit" by JON JASIUNAS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: JON JASIUNAS
Subj: Cursor Stuff

Here's a bit of code that will hide / unhide the cursor, without using
assembler: }

</i></font><font color="#FF0000"><b>uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>R<font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>HideCursor<font color="#000080">;
</font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ HideCursor }
  </i></font>R<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$03</font><font color="#000080">;    </font><font color="#008000"><i>{- Current cursor status }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;    </font><font color="#008000"><i>{- Set cursor }
  </i></font>R<font color="#000080">.</font>CH <font color="#000080">:= </font>R<font color="#000080">.</font>Ch <font color="#FF0000"><b>or </b></font><font color="#800000">$20</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>R<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ HideCursor }

</i></font><font color="#FF0000"><b>procedure </b></font>ShowCursor<font color="#000080">;
</font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ ShowCursor }
  </i></font>R<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$03</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>R<font color="#000080">);
  </font>R<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
  </font>R<font color="#000080">.</font>CH <font color="#000080">:= </font>R<font color="#000080">.</font>CH <font color="#FF0000"><b>and </b></font><font color="#800000">$1F</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>R<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ ShowCursor }

{ However, if you want to use assembler, you can, and you don't need the
  DOS unit.  Here's my Cursor modification unit (in assembler), if you're
  interested. }

{****************************
 *     CURSOR.PAS v1.0      *
 *                          *
 *  General purpose cursor  *
 *  manipulation routines   *
 ****************************

1992-93 - HyperDrive Software
Released into the Public Domain.}

{$S-,R-,D-}
{$IFOPT O+}
  {$F+}
{$ENDIF}

</i></font><font color="#FF0000"><b>unit </b></font>Cursor<font color="#000080">;

</font><font color="#008000"><i>{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\}
                                   </i></font><font color="#FF0000"><b>interface
</b></font><font color="#008000"><i>{/////////////////////////////////////////////////////////////////////////////}

</i></font><font color="#FF0000"><b>const
  </b></font>csLine  <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">;
  </font>csHalf  <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;
  </font>csBlock <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DefineCursor<font color="#000080">(</font>Size<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>GotoXy<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>RestoreCursor<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>HideCursor<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>ShowCursor<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>CursorHidden<font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#008000"><i>{\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\}
                                 </i></font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{/////////////////////////////////////////////////////////////////////////////}

</i></font><font color="#FF0000"><b>var
  </b></font>dcStart<font color="#000080">, </font>dcEnd<font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#008000"><i>{=============================================================================}

</i></font><font color="#FF0000"><b>procedure </b></font>DefineCursor<font color="#000080">(</font>Size<font color="#000080">: </font>Byte<font color="#000080">);  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ DefineCursor }
  </i></font><font color="#FF00FF">mov   AH, $0F
  int   $10
  cmp   AL, $07
  jne   @Color

@Mono:
  mov   AH, $03
  int   $10
  cmp   Size, csLine
  je    @MonoL
  cmp   Size, csHalf
  je    @MonoH
  cmp   Size, csBlock
  je    @MonoB
@MonoL:
  mov   CH, $0C
  jmp   @MonoDone
@MonoH:
  mov   CH, $07
  jmp   @MonoDone
@MonoB:
  mov   CH, $00
@MonoDone:
  mov   CL, $0D
  jmp   @Done

@Color:
  mov   AH, $03
  int   $10
  cmp   Size, csLine
  je    @ColorL
  cmp   Size, csHalf
  je    @ColorH
  cmp   Size, csBlock
  je    @ColorB
@ColorL:
  mov   CH, $06
  jmp   @ColorDone
@ColorH:
  mov   CH, $04
  jmp   @ColorDone
@ColorB:
  mov   CH, $00
@ColorDone:
  mov   CL, $07

@Done:
  mov   AH, $01
  int   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ DefineCursor }

{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>procedure </b></font>GotoXy<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">);  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ GotoXy }
  </i></font><font color="#FF00FF">mov   AH, $0F
  int   $10
  mov   AH, $02
  dec   Y
  mov   DH, Y
  dec   X
  mov   DL, X
  int   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ GotoXy }

{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>procedure </b></font>RestoreCursor<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ RestoreCursor }
  </i></font><font color="#FF00FF">mov   AH, $01
  mov   CH, dcStart
  mov   CL, dcEnd
  int   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ RestoreCursor }

{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>procedure </b></font>HideCursor<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ HideCursor }
  </i></font><font color="#FF00FF">mov   AH, $03
  int   $10
  mov   AH, $01
  or    CH, $20
  int   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ HideCursor }

{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>procedure </b></font>ShowCursor<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ ShowCursor }
  </i></font><font color="#FF00FF">mov   AH, $03
  int   $10
  mov   AH, $01
  and   CH, $1F
  int   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ ShowCursor }

{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>function  </b></font>CursorHidden<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ CursorHidden }

  </i></font><font color="#FF00FF">mov   AH, $03
  int   $10
  cmp   CH, $20
  je    @Hidden
  mov   AL, $00
  jmp   @</font><font color="#FF0000"><b>End
</b></font><font color="#000080">@</font>Hidden<font color="#000080">:
  </font>mov   AL<font color="#000080">, </font><font color="#800000">$01</font><font color="#000080">;
@</font><font color="#FF0000"><b>End</b></font><font color="#000080">:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ CursorHidden }

{-----------------------------------------------------------------------------}
                                {** PRIVATE **}
{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>procedure </b></font>SaveCursor<font color="#000080">;  </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm     </b></font><font color="#008000"><i>{ SaveCursor }
  </i></font><font color="#FF00FF">mov   AH, $03
  int   $10
  mov   dcStart, CH
  mov   dcEnd, CL
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ SaveCursor }

{=============================================================================}
{$F+}

</i></font><font color="#FF0000"><b>var
  </b></font>OldExitProc<font color="#000080">: </font>Pointer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>NewExitProc<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ExitProc <font color="#000080">:= </font>OldExitProc<font color="#000080">;
  </font>RestoreCursor<font color="#000080">;               </font><font color="#008000"><i>{- Restore startup cursor mode }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{ NewExitProc }

{$F-}
{=============================================================================}

</i></font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{ Cursor }
  </i></font>OldExitProc <font color="#000080">:= </font>ExitProc<font color="#000080">;
  </font>ExitProc    <font color="#000080">:= @</font>NewExitProc<font color="#000080">;
  </font>SaveCursor<font color="#000080">;                  </font><font color="#008000"><i>{- Save startup cursor mode }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.    </font><font color="#008000"><i>{ Cursor }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
