<html>
<head><title> "CUSOR Handling #1" by JOHN GIESBRECHT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>cursor<font color="#000080">;

</font><font color="#008000"><i>(*
 *  CURSOR v1.1 - a Unit to provide extended control of cursor shape.
 *
 *  Public Domain 1991 by John Giesbrecht (1:247/128)
 *
 *  Notes:
 *
 *  - This version requires Turbo Pascal 6.0 or later.
 *  - These routines affect only the cursor on page 0.
 *  - This Unit installs an Exit Procedure which restores the cursor
 *    to its original shape when the Programme terminates.
 *)

</i></font><font color="#FF0000"><b>Interface

Procedure </b></font>cursoroff<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>cursoron<font color="#000080">;           </font><font color="#008000"><i>(* original cursor shape *)

</i></font><font color="#FF0000"><b>Procedure </b></font>blockcursor<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>halfblockcursor<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>linecursor<font color="#000080">;         </font><font color="#008000"><i>(* Default Dos cursor    *)

</i></font><font color="#FF0000"><b>Procedure </b></font>setcursor<font color="#000080">(</font>startline<font color="#000080">, </font>endline <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>getcursor<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>startline<font color="#000080">, </font>endline <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#008000"><i>(********************************************************************)

</i></font><font color="#FF0000"><b>Implementation

Const
  </b></font>mono <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>origstartline<font color="#000080">,
  </font>origendline<font color="#000080">,
  </font>mode <font color="#000080">: </font>Byte<font color="#000080">;
  </font>origexitproc <font color="#000080">: </font>Pointer<font color="#000080">;

</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>setcursor<font color="#000080">(</font>startline<font color="#000080">, </font>endline <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov ah, $01
  mov ch, startline
  mov cl, endline
  int $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>getcursor<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>startline<font color="#000080">, </font>endline <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov ah, $03
  mov bh, $00
  int $10
  les di, startline
  mov Byte ptr es:[di], ch
  les di, endline
  mov Byte ptr es:[di], cl
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>cursoroff<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>setcursor<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>cursoron<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>setcursor<font color="#000080">(</font>origstartline<font color="#000080">, </font>origendline<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>blockcursor<font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font>mode <font color="#000080">= </font>mono
    <font color="#FF0000"><b>then </b></font>setcursor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">)
    </font><font color="#FF0000"><b>else </b></font>setcursor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>halfblockcursor<font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font>mode <font color="#000080">= </font>mono
    <font color="#FF0000"><b>then </b></font>setcursor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">)
    </font><font color="#FF0000"><b>else </b></font>setcursor<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>linecursor<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mode <font color="#000080">= </font>mono
    <font color="#FF0000"><b>then </b></font>setcursor<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">)
    </font><font color="#FF0000"><b>else </b></font>setcursor<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(********************************************************************)
</i></font><font color="#FF0000"><b>Procedure </b></font>restorecursor<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>system<font color="#000080">.</font>exitproc <font color="#000080">:= </font>origexitproc<font color="#000080">;
  </font>cursoron<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(**  I N I T I A L I Z A T I O N  ***********************************)
</i></font><font color="#FF0000"><b>begin
 </b></font>getcursor<font color="#000080">(</font>origstartline<font color="#000080">, </font>origendline<font color="#000080">);
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov ah, $0F
  int $10
  mov mode, al
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>origexitproc <font color="#000080">:= </font>system<font color="#000080">.</font>exitproc<font color="#000080">;
 </font>system<font color="#000080">.</font>exitproc <font color="#000080">:= </font>addr<font color="#000080">(</font>restorecursor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
