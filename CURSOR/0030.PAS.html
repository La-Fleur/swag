<html>
<head><title> "Spinning Cursor Unit" by FIRE&ICE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I (Fire&amp;Ice if you use screen-names) would like to contribute something
to SWAG, if you
like it. It is a modified spinning cursor unit. I found out that the
original spinkey
code (I forgot the authors name, sorry) has an error (as follows):
        If you type:
                Welcine to the wonderful world of Oz!!!
        And then backspace over it (to change what you say), so it says:
                Welc
        And then type the following message:
                Welcome to Houston!
        The String Concatenated will be:
                Welcome to Houston!erful world of Oz!!!

So, I rewrote the stuff to account for the backspace key. I have
included two units:
Cursor.pas and Incl.Pas

**Cursor Requires Incl to compile (I guess Incl could be of MISC
classification)
***PLEEZ Lemme know what you think and whether or not u will put it on
SWAG.
(oh, I did use a little code I got off SWAG for the PCBOut Proc in
CURSOR.PAS)

-Thanx

Fire&amp;Ice
}

</i></font><font color="#FF0000"><b>Unit </b></font>Cursor<font color="#000080">;
</font><font color="#008000"><i>{ Created By Fire&amp;Ice }
{ Last Modified: 11/3/96 }

(* This Unit Contains Several Useful Procedures For A Spinning Cursor
Shape.
   It Serves No Real Purpose, But It's Cooler Than The Normal Cursor.
   It Contains The Following Procedures:
     SetCursor = Turns The Cursor On/Off.
     Pause2    = A Pretty Neat Pause Procedure With Color
     Spinner   = Actual Procedure For Spinning The Cursor.
     SpinStr   = Reads A String With A Spinning Cursor.
     SpinInt   = Reads An Integer With A Spinning Cursor.
     SpinReal  = Reads A Real With A Spinning Cursor.
     SpinChr   = Reads A Char And Converts and Outputs It In Uppercase.
     PCBOut    = Reads A String And Can Use PCB Color Codes To Format
it.
*)
</i></font><font color="#FF0000"><b>INTERFACE
Type
  </b></font>String255<font color="#000080">=</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];

</font><font color="#FF0000"><b>Const
  On</b></font><font color="#000080">=</font>True<font color="#000080">;
  </font>Off<font color="#000080">=</font>False<font color="#000080">;
  </font>Yes<font color="#000080">=</font>True<font color="#000080">;
  </font>No<font color="#000080">=</font>False<font color="#000080">;
</font><font color="#008000"><i>{ These are all the Textcolor() Options...                          }
  </i></font>Black<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;        </font><font color="#008000"><i>{ Black                                          }
  </i></font>DkBlue<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;       </font><font color="#008000"><i>{ Dark Blue                                      }
  </i></font>DkGreen<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;      </font><font color="#008000"><i>{ Dark Green                                     }
  </i></font>DkTurquoise<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;  </font><font color="#008000"><i>{ Dark Turquoise                                 }
  </i></font>DkRed<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;        </font><font color="#008000"><i>{ Dark Red                                       }
  </i></font>DkPurple<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;     </font><font color="#008000"><i>{ Dark Purple                                    }
  </i></font>Brown<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">;        </font><font color="#008000"><i>{ Brown                                          }
  </i></font>LtGray<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;       </font><font color="#008000"><i>{ Standard Text Color (Light Gray)               }
  </i></font>DkGray<font color="#000080">=</font><font color="#800000">8</font><font color="#000080">;       </font><font color="#008000"><i>{ Dark Gray                                      }
  </i></font>LtBlue<font color="#000080">=</font><font color="#800000">9</font><font color="#000080">;       </font><font color="#008000"><i>{ Light Blue                                     }
  </i></font>LtGreen<font color="#000080">=</font><font color="#800000">10</font><font color="#000080">;     </font><font color="#008000"><i>{ Light Green                                    }
  </i></font>LtTurquoise<font color="#000080">=</font><font color="#800000">11</font><font color="#000080">; </font><font color="#008000"><i>{ Light Turquoise                                }
  </i></font>LtRed<font color="#000080">=</font><font color="#800000">12</font><font color="#000080">;       </font><font color="#008000"><i>{ Light Red (Pink)                               }
  </i></font>LtPurple<font color="#000080">=</font><font color="#800000">13</font><font color="#000080">;    </font><font color="#008000"><i>{ Light Purple                                   }
  </i></font>Yellow<font color="#000080">=</font><font color="#800000">14</font><font color="#000080">;      </font><font color="#008000"><i>{ Yellow                                         }
  </i></font>White<font color="#000080">=</font><font color="#800000">15</font><font color="#000080">;       </font><font color="#008000"><i>{ White                                          }
  </i></font>Flash<font color="#000080">=</font><font color="#800000">16</font><font color="#000080">;       </font><font color="#008000"><i>{ Text Attrib for Flashing (Add 16 to Color Num) }

  </i></font><font color="#FF0000"><b>Procedure </b></font>SetCursor<font color="#000080">(</font>Flg<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>Pause2<font color="#000080">(</font>NormCol<font color="#000080">, </font>CycCol<font color="#000080">, </font>StarCol<font color="#000080">:</font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>Spinner<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>SpinStr<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Inpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>SpinInt<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Intg<font color="#000080">:</font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>SpinReal<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Intg<font color="#000080">:</font>Real<font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>SpinChr<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Cr<font color="#000080">:</font>Char<font color="#000080">);
  </font><font color="#FF0000"><b>Procedure </b></font>PCBOut<font color="#000080">(</font>stream<font color="#000080">:</font>string255<font color="#000080">; </font>ret<font color="#000080">:</font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION
Uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">, </font>Inc<font color="#000080">;  </font><font color="#008000"><i>{ cut out INC below !! }

</i></font><font color="#FF0000"><b>Const
  </b></font>SpinChar<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= (</font><font color="#800000">'&Auml;'</font><font color="#000080">,</font><font color="#800000">'\'</font><font color="#000080">,</font><font color="#800000">'&sup3;'</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Key<font color="#000080">:</font>Char<font color="#000080">;
  </font>InfoLen<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#008000"><i>{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>SetCursor<font color="#000080">(</font>Flg<font color="#000080">: </font>Boolean<font color="#000080">);
        </font><font color="#FF0000"><b>Var
          </b></font>reg <font color="#000080">: </font>Registers<font color="#000080">;

        </font><font color="#FF0000"><b>Begin
          If </b></font>Flg<font color="#000080">=</font>True <font color="#FF0000"><b>Then              </b></font><font color="#008000"><i>{ Turn cursor on }
         </i></font><font color="#FF0000"><b>If </b></font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0049</font><font color="#000080">] = </font><font color="#800000">7 </font><font color="#FF0000"><b>Then
              </b></font>reg<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$B0C            </font><font color="#008000"><i>{ If monochrome monitor }
         </i></font><font color="#FF0000"><b>Else
           </b></font>reg<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$607               </font><font color="#008000"><i>{ If color monitor }
          </i></font><font color="#FF0000"><b>Else                          </b></font><font color="#008000"><i>{ Turn cursor off }
            </i></font>reg<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$2020</font><font color="#000080">;
          </font>reg<font color="#000080">.</font>bx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>reg<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0100</font><font color="#000080">;              </font><font color="#008000"><i>{ Set the interrupt function }
          </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>reg<font color="#000080">);                </font><font color="#008000"><i>{ Call the interrupt }
        </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{ of PROCEDURE SetCursor }
{*************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>Pause2<font color="#000080">(</font>NormCol<font color="#000080">, </font>CycCol<font color="#000080">, </font>StarCol<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Const
  </b></font>D<font color="#000080">=</font><font color="#800000">115</font><font color="#000080">;
  </font>X<font color="#000080">=</font><font color="#800000">38</font><font color="#000080">;
  </font>PD<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= (</font><font color="#800000">'P'</font><font color="#000080">, </font><font color="#800000">'A'</font><font color="#000080">, </font><font color="#800000">'U'</font><font color="#000080">, </font><font color="#800000">'S'</font><font color="#000080">, </font><font color="#800000">'E'</font><font color="#000080">, </font><font color="#800000">'D'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Loop<font color="#000080">, </font>CurHi<font color="#000080">:</font>Integer<font color="#000080">;
  </font>Y<font color="#000080">:</font>Byte<font color="#000080">;
  </font>Back<font color="#000080">:</font>Boolean<font color="#000080">;
  </font>K<font color="#000080">:</font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>SetCursor<font color="#000080">(</font>False<font color="#000080">);</font>Writeln<font color="#000080">;
  </font>CurHi<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;</font>Y<font color="#000080">:=</font>WhereY<font color="#000080">;</font>Back<font color="#000080">:=</font>False<font color="#000080">;
  </font>GotoXY<font color="#000080">(</font><font color="#800000">37</font><font color="#000080">, </font>Y<font color="#000080">);</font>CC<font color="#000080">(</font>StarCol<font color="#000080">+</font>Flash<font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font>Y<font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">);</font>CC<font color="#000080">(</font>NormCol<font color="#000080">);</font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>Loop<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>Do
      Begin
        For </b></font>Loop<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>Do
          Begin
            If </b></font>Loop<font color="#000080">=</font>CurHi <font color="#FF0000"><b>Then
              Begin
                </b></font>CC<font color="#000080">(</font>CycCol<font color="#000080">);
                </font>Write<font color="#000080">(</font>PD<font color="#000080">[</font>Loop<font color="#000080">]);
              </font><font color="#FF0000"><b>End
              Else
              Begin
                </b></font>CC<font color="#000080">(</font>NormCol<font color="#000080">);
                </font>Write<font color="#000080">(</font>PD<font color="#000080">[</font>Loop<font color="#000080">]);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>CurHi<font color="#000080">=</font><font color="#800000">6 </font><font color="#FF0000"><b>Then
      Begin
        </b></font>CurHi<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
        </font>Back<font color="#000080">:=</font>True
      <font color="#FF0000"><b>End
      Else
      If </b></font><font color="#000080">(</font>Back<font color="#000080">=</font>True<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>CurHi <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>CurHi<font color="#000080">:=</font>CurHi<font color="#000080">-</font><font color="#800000">1
      </font><font color="#FF0000"><b>Else
      If </b></font><font color="#000080">(</font>Back<font color="#000080">=</font>True<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>CurHi <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
          </b></font>CurHi<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
          </font>Back<font color="#000080">:=</font>False
        <font color="#FF0000"><b>End
      Else
        </b></font>CurHi<font color="#000080">:=</font>CurHi<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>Delay<font color="#000080">(</font>D<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
  </font>K<font color="#000080">:=</font>Readkey<font color="#000080">;</font>GotoXY<font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font>Y<font color="#000080">);</font>CC<font color="#000080">(</font>LtGray<font color="#000080">);</font>Writeln<font color="#000080">;
  </font>SetCursor<font color="#000080">(</font>True<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE Pause2 }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>Spinner<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>X<font color="#000080">, </font>Y<font color="#000080">:</font>Byte<font color="#000080">;
    </font>Q<font color="#000080">:</font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>X<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Y<font color="#000080">:=</font>WhereY<font color="#000080">;
    </font>Q<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>Write<font color="#000080">(</font>SpinChar<font color="#000080">[</font>Q<font color="#000080">]);
      </font>Delay<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
      </font>Q<font color="#000080">:=</font>Q<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Q <font color="#000080">= </font><font color="#800000">5 </font><font color="#FF0000"><b>Then
        </b></font>Q<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
      </font>Key<font color="#000080">:=</font>Readkey<font color="#000080">;
      </font>Write<font color="#000080">(</font>Key<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Key<font color="#000080">=</font>Chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">)) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>InfoLen <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>InfoLen<font color="#000080">:=</font>InfoLen <font color="#000080">- </font><font color="#800000">1
      </font><font color="#FF0000"><b>Else
        </b></font>InfoLen<font color="#000080">:=</font>InfoLen <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE Spinner }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>SpinStr<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Inpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

  </font><font color="#FF0000"><b>Label </b></font>Top<font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>Cycler<font color="#000080">, </font>Cycl2<font color="#000080">:</font>Integer<font color="#000080">;
    </font>Tstr<font color="#000080">, </font>Tstr2<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>L<font color="#000080">:</font>Integer<font color="#000080">;


  </font><font color="#FF0000"><b>Begin
    </b></font>SetCursor<font color="#000080">(</font>Off<font color="#000080">);
    </font>Top<font color="#000080">:
    </font>Write<font color="#000080">(</font>Prpt<font color="#000080">);
    </font>Inpt<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font>InfoLen<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>Tstr<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font>L<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>Spinner<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Key<font color="#000080">&lt;&gt;</font>Chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
          </b></font>L<font color="#000080">:=</font>L<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
          </font>Inpt<font color="#000080">:=</font>Inpt<font color="#000080">+</font>Key<font color="#000080">;
        </font><font color="#FF0000"><b>End
        Else
        Begin
          </b></font>Tstr2<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
          </font><font color="#FF0000"><b>For </b></font>Cycl2<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
            Begin
              </b></font>Tstr2<font color="#000080">:=</font>Tstr2<font color="#000080">+</font>Inpt<font color="#000080">[</font>Cycl2<font color="#000080">];
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of FOR Cycl2 }
          </i></font>L<font color="#000080">:=</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
          </font>Inpt<font color="#000080">:=</font>Tstr2<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of IF Key... }

    </i></font><font color="#FF0000"><b>Until </b></font>Key<font color="#000080">=</font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>InfoLen <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>InfoLen<font color="#000080">:=</font>InfoLen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

    </font><font color="#FF0000"><b>If </b></font>InfoLen <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      For </b></font>Cycler<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>InfoLen <font color="#FF0000"><b>DO
        Begin
          </b></font>Tstr<font color="#000080">:=</font>Tstr<font color="#000080">+</font>Inpt<font color="#000080">[</font>Cycler<font color="#000080">]
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of FOR Cycler }
      </i></font>Inpt<font color="#000080">:=</font>Tstr<font color="#000080">;
    </font><font color="#FF0000"><b>End
    Else
      Begin
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'ERR: Invalid Entry!'</font><font color="#000080">);
        </font><font color="#FF0000"><b>goto </b></font>Top
      <font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>SetCursor<font color="#000080">(</font><font color="#FF0000"><b>On</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE SpinStr }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>SpinInt<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Intg<font color="#000080">:</font>Integer<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Cd<font color="#000080">:</font>Integer<font color="#000080">;
    </font>Inpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>SpinStr<font color="#000080">(</font>Prpt<font color="#000080">, </font>Inpt<font color="#000080">);
    </font>Val<font color="#000080">(</font>Inpt<font color="#000080">,</font>Intg<font color="#000080">,</font>Cd<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE SpinInt }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>SpinReal<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Intg<font color="#000080">:</font>Real<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Cd<font color="#000080">:</font>Integer<font color="#000080">;
    </font>Inpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>SpinStr<font color="#000080">(</font>Prpt<font color="#000080">, </font>Inpt<font color="#000080">);
    </font>Val<font color="#000080">(</font>Inpt<font color="#000080">,</font>Intg<font color="#000080">,</font>Cd<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE SpinReal }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>SpinChr<font color="#000080">(</font>Prpt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>Cr<font color="#000080">:</font>Char<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>X<font color="#000080">, </font>Y<font color="#000080">:</font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>SetCursor<font color="#000080">(</font>Off<font color="#000080">);
    </font>Write<font color="#000080">(</font>Prpt<font color="#000080">);
    </font>Spinner<font color="#000080">;
    </font>X<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Y<font color="#000080">:=</font>WhereY<font color="#000080">; </font>X<font color="#000080">:=</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
    </font>Cr<font color="#000080">:=</font>UpCase<font color="#000080">(</font>Key<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>Cr<font color="#000080">);
    </font>SetCursor<font color="#000080">(</font><font color="#FF0000"><b>On</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE SpinChr }
{**************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>PCBOut<font color="#000080">(</font>stream<font color="#000080">:</font>string255<font color="#000080">; </font>ret<font color="#000080">:</font>boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>_retval<font color="#000080">:</font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">,</font>out1<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];

  </font><font color="#FF0000"><b>Begin
    For </b></font>_retval<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>length<font color="#000080">(</font>stream<font color="#000080">) </font><font color="#FF0000"><b>Do
      Begin
        out</b></font><font color="#000080">:=</font>copy<font color="#000080">(</font>stream<font color="#000080">,</font>_retval<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>Case out</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Of
          </b></font><font color="#800000">'@'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin
                </b></font>out1<font color="#000080">:=</font>copy<font color="#000080">(</font>stream<font color="#000080">,</font>_retval<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                </font><font color="#FF0000"><b>Case </b></font>out1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Of
                  </b></font><font color="#800000">'0'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                  </font><font color="#800000">'1'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#800000">'2'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
                  </font><font color="#800000">'3'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
                  </font><font color="#800000">'4'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
                  </font><font color="#800000">'5'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
                  </font><font color="#800000">'6'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
                  </font><font color="#800000">'7'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
                  </font><font color="#800000">'8'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);
                  </font><font color="#800000">'9'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);
                  </font><font color="#800000">'A'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
                  </font><font color="#800000">'B'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
                  </font><font color="#800000">'C'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
                  </font><font color="#800000">'D'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
                  </font><font color="#800000">'E'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
                  </font><font color="#800000">'F'</font><font color="#000080">:</font>TextBackground<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>out1<font color="#000080">:=</font>Copy<font color="#000080">(</font>stream<font color="#000080">,</font>_retval<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                </font><font color="#FF0000"><b>Case </b></font>out1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Of
                  </b></font><font color="#800000">'0'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                  </font><font color="#800000">'1'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#800000">'2'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
                  </font><font color="#800000">'3'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
                  </font><font color="#800000">'4'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
                  </font><font color="#800000">'5'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
                  </font><font color="#800000">'6'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
                  </font><font color="#800000">'7'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
                  </font><font color="#800000">'8'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);
                  </font><font color="#800000">'9'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);
                  </font><font color="#800000">'A'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
                  </font><font color="#800000">'B'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
                  </font><font color="#800000">'C'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
                  </font><font color="#800000">'D'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
                  </font><font color="#800000">'E'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
                  </font><font color="#800000">'F'</font><font color="#000080">:</font>TextColor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>_retval<font color="#000080">:=</font>_retval<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Else </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>out</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>ret<font color="#000080">=</font>Yes <font color="#FF0000"><b>Then </b></font>writeln<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ of PROCEDURE PCBOut }
{**************************************************************************}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">. </font><font color="#008000"><i>{ of Unit Cursor }

{ --------------   CUT -------------- }

</i></font><font color="#FF0000"><b>Unit </b></font>Inc<font color="#000080">;

</font><font color="#008000"><i>{ Created By: Fire&amp;Ice }
{ Last Modified: 10/11/96 }
</i></font><font color="#FF0000"><b>INTERFACE

Function </b></font>Right<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>numbr<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Left<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>numbr<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Pause<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CC<font color="#000080">(</font>col<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>BC<font color="#000080">(</font>col<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Cnt_Txt <font color="#000080">(</font>txt<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Const
</b></font><font color="#008000"><i>{ These are all the Textcolor() Options...                          }
  </i></font>Black<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;        </font><font color="#008000"><i>{ Black                                          }
  </i></font>DkBlue<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;       </font><font color="#008000"><i>{ Dark Blue                                      }
  </i></font>DkGreen<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;      </font><font color="#008000"><i>{ Dark Green                                     }
  </i></font>DkTurquoise<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;  </font><font color="#008000"><i>{ Dark Turquoise                                 }
  </i></font>DkRed<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;        </font><font color="#008000"><i>{ Dark Red                                       }
  </i></font>DkPurple<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;     </font><font color="#008000"><i>{ Dark Purple                                    }
  </i></font>Brown<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">;        </font><font color="#008000"><i>{ Brown                                          }
  </i></font>LtGray<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;       </font><font color="#008000"><i>{ Standard Text Color (Light Gray)               }
  </i></font>DkGray<font color="#000080">=</font><font color="#800000">8</font><font color="#000080">;       </font><font color="#008000"><i>{ Dark Gray                                      }
  </i></font>LtBlue<font color="#000080">=</font><font color="#800000">9</font><font color="#000080">;       </font><font color="#008000"><i>{ Light Blue                                     }
  </i></font>LtGreen<font color="#000080">=</font><font color="#800000">10</font><font color="#000080">;     </font><font color="#008000"><i>{ Light Green                                    }
  </i></font>LtTurquoise<font color="#000080">=</font><font color="#800000">11</font><font color="#000080">; </font><font color="#008000"><i>{ Light Turquoise                                }
  </i></font>LtRed<font color="#000080">=</font><font color="#800000">12</font><font color="#000080">;       </font><font color="#008000"><i>{ Light Red (Pink)                               }
  </i></font>LtPurple<font color="#000080">=</font><font color="#800000">13</font><font color="#000080">;    </font><font color="#008000"><i>{ Light Purple                                   }
  </i></font>Yellow<font color="#000080">=</font><font color="#800000">14</font><font color="#000080">;      </font><font color="#008000"><i>{ Yellow                                         }
  </i></font>White<font color="#000080">=</font><font color="#800000">15</font><font color="#000080">;       </font><font color="#008000"><i>{ White                                          }
  </i></font>Flash<font color="#000080">=</font><font color="#800000">16</font><font color="#000080">;       </font><font color="#008000"><i>{ Text Attrib for Flashing (Add 16 to Color Num) }
{ Number of Columns in the Screen (For Procedure Cnt_Txt) }
  </i></font>NumCols<font color="#000080">=</font><font color="#800000">80</font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION
uses </b></font>Crt<font color="#000080">;

</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Right<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>numbr<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>loc<font color="#000080">:</font>byte<font color="#000080">;                                        </font><font color="#008000"><i>{ Like The MSBasic }
                                                  { Right Procedure }
</i></font><font color="#FF0000"><b>Begin
  If </b></font>numbr <font color="#000080">&gt;= </font>LENGTH<font color="#000080">(</font>Strng<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Right<font color="#000080">:=</font>strng
  <font color="#FF0000"><b>Else
    Begin
      </b></font>loc<font color="#000080">:=</font>length<font color="#000080">(</font>strng<font color="#000080">)-</font>numbr<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font>Right<font color="#000080">:=</font>copy<font color="#000080">(</font>strng<font color="#000080">,</font>loc<font color="#000080">,</font>numbr<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Left<font color="#000080">(</font>Strng<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>numbr<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;       </font><font color="#008000"><i>{ Like The MSBasic
}
  </i></font><font color="#FF0000"><b>Begin                                              </b></font><font color="#008000"><i>{ Left Procedure }
    </i></font>Left<font color="#000080">:=</font>COPY<font color="#000080">(</font>Strng<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>numbr<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>Pause<font color="#000080">;                      </font><font color="#008000"><i>{ This Procedure pauses the
program }
</i></font><font color="#FF0000"><b>Var
  </b></font>Wtt<font color="#000080">:</font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>writeln<font color="#000080">;</font>write<font color="#000080">(</font><font color="#800000">'Press Any Key To Continue...'</font><font color="#000080">);</font>Wtt<font color="#000080">:=</font>readkey<font color="#000080">;</font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>CC<font color="#000080">(</font>col<font color="#000080">:</font>integer<font color="#000080">);      </font><font color="#008000"><i>{ Easier than typing Textcolor() }
  </i></font><font color="#FF0000"><b>Begin
    </b></font>Textcolor<font color="#000080">(</font>col<font color="#000080">);           </font><font color="#008000"><i>{ ** CC stands for 'Color Change' ** }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>BC<font color="#000080">(</font>col<font color="#000080">:</font>integer<font color="#000080">);    </font><font color="#008000"><i>{ Easier than typing Textbackground() }
  </i></font><font color="#FF0000"><b>Begin
    </b></font>Textbackground<font color="#000080">(</font>col<font color="#000080">);    </font><font color="#008000"><i>{ ** BC stands for 'Background Change' ** }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>Cnt_Txt <font color="#000080">(</font>txt<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);         </font><font color="#008000"><i>{ This Procedure does the }
</i></font><font color="#FF0000"><b>Var
  </b></font>shft<font color="#000080">:</font>integer<font color="#000080">;                     </font><font color="#008000"><i>{ task of centering a line of text }

  </i></font><font color="#FF0000"><b>Begin
    </b></font>Shft<font color="#000080">:=(</font>NumCols <font color="#000080">- </font>Length<font color="#000080">(</font>txt<font color="#000080">)) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
    </font>Shft<font color="#000080">:=</font>Shft<font color="#000080">+</font>Length<font color="#000080">(</font>txt<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>txt<font color="#000080">:</font>shft<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{***************************************************************************}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p></body>
</html>
