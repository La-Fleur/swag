<html>
<head><title> "cursor stuff" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{To make all cursor routines complete, here are the ones I use: }

</i></font><font color="#FF0000"><b>procedure </b></font>setcursorshape<font color="#000080">(</font>shape <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,1; mov cx,shape; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>linecursor<font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>Rows <font color="#FF0000"><b>of
    </b></font><font color="#800000">25 </font><font color="#000080">: </font><font color="#FF0000"><b>case </b></font>VidCard <font color="#FF0000"><b>of
           </b></font>cga<font color="#000080">,</font>ega <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
           </font>mda <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">$b</font><font color="#000080">+</font><font color="#800000">$c</font><font color="#000080">);
           </font>vga <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">$d</font><font color="#000080">+</font><font color="#800000">$e</font><font color="#000080">);
         </font><font color="#FF0000"><b>else </b></font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#800000">40 </font><font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">8</font><font color="#000080">+</font><font color="#800000">9</font><font color="#000080">);
  </font><font color="#FF0000"><b>else </b></font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>halfcursor<font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>Rows <font color="#FF0000"><b>of
    </b></font><font color="#800000">25 </font><font color="#000080">: </font><font color="#FF0000"><b>case </b></font>VidCard <font color="#FF0000"><b>of
           </b></font>cga<font color="#000080">,</font>ega <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
           </font>mda <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">$c</font><font color="#000080">);
           </font>vga <font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">$e</font><font color="#000080">);
         </font><font color="#FF0000"><b>else </b></font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#800000">40 </font><font color="#000080">: </font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">4</font><font color="#000080">+</font><font color="#800000">9</font><font color="#000080">);
  </font><font color="#FF0000"><b>else </b></font>setcursorshape<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">7</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>blockcursor<font color="#000080">; </font><font color="#FF0000"><b>begin
  </b></font>setcursorshape<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>cursoron<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,3; mov bh,0; int 10h; and ch,not 20h; mov ah,1; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>cursoroff<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,3; mov bh,0; int 10h; or ch,20h; mov ah,1; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getcursorshape <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,3; mov bh,0; int 10h; mov ax,cx; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

&gt;--- </font>cut here 

The carddetectionroutines are <font color="#FF0000"><b>as </b></font>follows<font color="#000080">:

&gt;--- </font>cut here 

<font color="#FF0000"><b>const
  </b></font>mda <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                                                     </font><font color="#008000"><i>{ MDA and HGC }
  </i></font>cga <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>ega <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>ega_mono <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;                                        </font><font color="#008000"><i>{ EGA and MDA-Monitor }
  </i></font>vga <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>vga_mono <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;                                           </font><font color="#008000"><i>{ VGA and VGA-Mono }
  </i></font>mcga <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
  </font>mcga_mono <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;                                        </font><font color="#008000"><i>{ MCGA and MCGA-Mono }

</i></font><font color="#FF0000"><b>var
  </b></font>VidCard <font color="#000080">: </font>byte<font color="#000080">;                                </font><font color="#008000"><i>{ Code for active videocard }

</i></font><font color="#FF0000"><b>procedure </b></font>VideoInit<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>VidMode <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">= (</font>mda<font color="#000080">,</font>cga<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>ega<font color="#000080">,</font>ega_mono<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>vga_mono<font color="#000080">,
                                    </font>vga<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>mcga<font color="#000080">,</font>mcga_mono<font color="#000080">,</font>mcga<font color="#000080">);
  </font>EgaMode <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">= (</font>ega<font color="#000080">,</font>ega<font color="#000080">,</font>ega_mono<font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>Regs <font color="#000080">: </font>registers<font color="#000080">;                           </font><font color="#008000"><i>{ Processorregisters for int's }

</i></font><font color="#FF0000"><b>begin
  </b></font>VidCard <font color="#000080">:= </font><font color="#800000">$ff</font><font color="#000080">;                                </font><font color="#008000"><i>{ No videocard detected yet }

  { --- Check card-type ---------------------------------------------------- }

  </i></font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$1a00</font><font color="#000080">;                                 </font><font color="#008000"><i>{ Call BIOS function 1Ah }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">$1a </font><font color="#FF0000"><b>then begin                           </b></font><font color="#008000"><i>{ VGA of MCGA? - Yes }
    </i></font>VidCard <font color="#000080">:= </font>VidMode<font color="#000080">[</font>Regs<font color="#000080">.</font>bl<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];                      </font><font color="#008000"><i>{ Get cod from table }
    </i></font>Color <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font><font color="#000080">((</font>VidCard <font color="#000080">= </font>mda<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>VidCard <font color="#000080">= </font>ega_mono<font color="#000080">));
  </font><font color="#FF0000"><b>end
  else begin                               </b></font><font color="#008000"><i>{ No VGA or MCGA, search EGA-card }
    </i></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;                           </font><font color="#008000"><i>{ Function 12h subfunction 10h }
    </i></font>Regs<font color="#000080">.</font>bl <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);                                        </font><font color="#008000"><i>{ Call Video-BIOS }
    </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>bl <font color="#000080">&lt;&gt; </font><font color="#800000">$10 </font><font color="#FF0000"><b>then begin                                </b></font><font color="#008000"><i>{ EGA? - Yes }
      </i></font>VidCard <font color="#000080">:= </font>EgaMode<font color="#000080">[(</font>Regs<font color="#000080">.</font>cl <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">];                  </font><font color="#008000"><i>{ Get Code }
      </i></font>Color <font color="#000080">:= </font>VidCard <font color="#000080">&lt;&gt; </font>ega_mono<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ --- Define pointer to video-RAM ---------------------------------------- }

  </i></font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">15</font><font color="#000080">;                                  </font><font color="#008000"><i>{ Define actual video-mode }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);                                </font><font color="#008000"><i>{ Call BIOS video-interrupt }
  </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>v_vidseg <font color="#000080">:= </font><font color="#800000">$b000                   </font><font color="#008000"><i>{ Monochrome mode? }
  </i></font><font color="#FF0000"><b>else </b></font>v_vidseg <font color="#000080">:= </font><font color="#800000">$b800</font><font color="#000080">;                                    </font><font color="#008000"><i>{ No, Colormode }

  </i></font><font color="#FF0000"><b>if </b></font>VidCard <font color="#000080">= </font><font color="#800000">$ff </font><font color="#FF0000"><b>then begin                   </b></font><font color="#008000"><i>{ No EGA, VGA or MCGA? - Yes }
    </i></font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>VidCard <font color="#000080">:= </font>mda <font color="#FF0000"><b>else </b></font>VidCard <font color="#000080">:= </font>cga<font color="#000080">;
    </font>Color <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font><font color="#000080">((</font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">));
    </font>SnowProtect <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;                                   </font><font color="#008000"><i>{ Chose actual screen page }
  </i></font>Regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                                  </font><font color="#008000"><i>{ Page zero }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);                                </font><font color="#008000"><i>{ Call BIOS video-interrupt }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

&gt;--- </font>cut here 

This might <font color="#FF0000"><b>not </b></font>compile straight off<font color="#000080">, </font>but I guess you can imagine what<font color="#800000">'s
</font>possibly missing<font color="#000080">. ;-) (</font>like <font color="#800000">'uses dos'</font><font color="#000080">)

</font><font color="#FF0000"><b>If </b></font>everything works<font color="#000080">, </font>you can easily define your cursor <font color="#FF0000"><b>with </b></font>statements <font color="#FF0000"><b>as</b></font><font color="#000080">:

</font>linecursor<font color="#000080">,
</font>blockcursor<font color="#000080">,
</font>cursoroff<font color="#000080">,
</font>cursoron<font color="#000080">,
</font>etc<font color="#000080">...

</font>Should work <font color="#FF0000"><b>on </b></font>every possible videocard<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CURSOR SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
