<html>
<head><title> "Blinking LED's" by CLAUS ILGINNIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
CL&gt;Does anyone know how to make the Num Lock,Caps Lock, and Scroll lock lights
CL&gt;turn on and off?

--------------------------------8&lt;-----------------
$40:$17  BYTE    Keyboard status flags 1:
                    bit 7 =1 INSert active
                    bit 6 =1 Caps Lock active
                    bit 5 =1 Num Lock active
                    bit 4 =1 Scroll Lock active
                    bit 3 =1 either Alt pressed
                    bit 2 =1 either Ctrl pressed
                    bit 1 =1 Left Shift pressed
                    bit 0 =1 Right Shift pressed


Port[$3F2] w   diskette controller DOR (Digital Output Register)
                 bit 7-6    reserved PS/2
                 bit 7 = 1  drive 3 motor enable
                 bit 6 = 1  drive 2 motor enable
                 bit 5 = 1  drive 1 motor enable
                 bit 4 = 1  drive 0 motor enable
                 bit 3 = 1  diskette DMA enable (reserved PS/2)
                 bit 2 = 1  FDC enable  (controller reset)
                       = 0  hold FDC at reset
                 bit 1-0    drive select (0=A 1=B ..)
}

</i></font><font color="#FF0000"><b>Program </b></font>BlinkBlink<font color="#000080">;
</font><font color="#008000"><i>{ you MUST have a diskette in drive 'B' to use this }
</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>DiskCtr       <font color="#000080">= </font><font color="#800000">$03F2</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR   </b></font>i<font color="#000080">,</font>j           <font color="#000080">: </font>Byte<font color="#000080">;
      </font>OldKB         <font color="#000080">: </font>Byte<font color="#000080">;
      </font>KBStat        <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;

      </font><font color="#FF0000"><b>Out           </b></font><font color="#000080">: </font>Byte<font color="#000080">;
      </font>ch<font color="#000080">:</font>char<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>i<font color="#000080">:=</font><font color="#800000">$40</font><font color="#000080">;
  </font>j<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>OldKB<font color="#000080">:=</font>KBStat<font color="#000080">;

  </font>Writeln<font color="#000080">(</font><font color="#800000">'So blink Drive B: ... Taste druecken'</font><font color="#000080">);
  </font><font color="#008000"><i>{Eigentlich sollte auch Drive A: blinken, aber das klappt bei mir irgend-}
  {wie nicht :-( }

  </i></font><font color="#FF0000"><b>Repeat
    </b></font>Delay<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">);
    </font><font color="#FF0000"><b>Out</b></font><font color="#000080">:=</font>j <font color="#FF0000"><b>OR </b></font><font color="#800000">$F0</font><font color="#000080">;
    </font>Port<font color="#000080">[</font>DiskCtr<font color="#000080">]:=</font><font color="#FF0000"><b>Out</b></font><font color="#000080">;
    </font>j<font color="#000080">:=(</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;

  </font>ch<font color="#000080">:=</font>ReadKey<font color="#000080">;

  </font>Writeln<font color="#000080">(</font><font color="#800000">'Und so die Tastatur-LEDs ... Taste druecken'</font><font color="#000080">);

  </font><font color="#FF0000"><b>Repeat
    </b></font>KBStat<font color="#000080">:=</font>i<font color="#000080">;
    </font>Delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Keypressed  <font color="#FF0000"><b>then </b></font>nosound<font color="#000080">;
    </font>i<font color="#000080">:=</font>i <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>i<font color="#000080">=</font><font color="#800000">$8 </font><font color="#FF0000"><b>then
      </b></font>i<font color="#000080">:=</font><font color="#800000">$40</font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Keypressed<font color="#000080">;
  </font>KBStat<font color="#000080">:=</font>OldKB<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
