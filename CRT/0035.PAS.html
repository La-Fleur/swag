<html>
<head><title> "Re: Using PORTS" by PETER LOUWEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   Direct port access
   &szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;
  For access to the 80x86 CPU data ports, Borland Pascal implements two
  predefined arrays, Port and PortW.

  Both are one-dimensional arrays, and each element represents a data port,
  whose port address corresponds to its index.

  The index type is the integer type Word. Components of the port array are of
  type Byte and components of the PortW array are of type Word.

  When a value is assigned to a component of Port or PortW, the value is
  output to the selected port. When a component of Port or PortW is referenced
  in an expression, its value is input from the selected port.

  Use of the Port and PortW arrays is restricted to assignment and reference
  in expressions only; that is, components of Port and PortW cannot be used as
  variable parameters. Also, references to the entire Port or PortW array
  (reference without index) are not allowed.

Simply type &quot;port&quot;, put the cursor on it, then press Ctrl+F1.

Reading a port (port nr. $378 in this case): x := Port[$378];
Writing to that same port                  : Port[$378] := x
in which X is a byte variable.

A colourful example:
}

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Playing_with_Ports<font color="#000080">;

</font><font color="#008000"><i>{$X+}

</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetVideomode<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>mode<font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM </b></font><font color="#FF00FF">mov AL, mode
    xor AH, AH
    int $10
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetColor<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>Color<font color="#000080">, </font>Blue<font color="#000080">, </font>Green<font color="#000080">, </font>Red<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN </b></font>port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font>Color<font color="#000080">;
      </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Red<font color="#000080">;
      </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Green<font color="#000080">;
      </font>port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Blue
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ - Main: }

</i></font><font color="#FF0000"><b>CONST </b></font>Color_U_Want <font color="#000080">= </font>Crt<font color="#000080">.</font>Blue<font color="#000080">;  </font><font color="#008000"><i>{ -- Or whatever. }
      </i></font>pause        <font color="#000080">= </font><font color="#800000">500</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>Red<font color="#000080">, </font>Green<font color="#000080">, </font>Blue<font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font>SetVideomode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);  </font><font color="#008000"><i>{ -- To be sure. }
      </i></font>TextBackground<font color="#000080">(</font>Color_U_Want<font color="#000080">); </font>clrscr<font color="#000080">;
      </font>gotoxy<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">); </font>write<font color="#000080">(</font><font color="#800000">'D a z z l i n g'</font><font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">); </font>write<font color="#000080">(</font><font color="#800000">'      o r'</font><font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">); </font>write<font color="#000080">(</font><font color="#800000">'    w h a t'</font><font color="#000080">);
      </font>readkey<font color="#000080">;
      </font>randomize<font color="#000080">;
      </font><font color="#FF0000"><b>REPEAT </b></font>SetColor<font color="#000080">(</font>Color_U_Want<font color="#000080">, </font>random<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">), </font>random<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">), </font>random<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">));
             </font>delay<font color="#000080">(</font>pause<font color="#000080">)
      </font><font color="#FF0000"><b>UNTIL </b></font>keypressed<font color="#000080">;
      </font>delay<font color="#000080">(</font>pause<font color="#000080">);
      </font>SetVideomode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>A list <font color="#FF0000"><b>of </b></font>what each port does can be found <font color="#FF0000"><b>in </b></font>Ralf Brown<font color="#800000">'s Interrupt List
</font><font color="#000080">(</font>filenames INTERnnx<font color="#000080">.</font>ZIP<font color="#000080">; &quot;</font>nn<font color="#000080">&quot; = </font>version number<font color="#000080">, </font>currently <font color="#800000">48</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font><font color="#000080">&quot;</font>x<font color="#000080">&quot; </font><font color="#FF0000"><b>is </b></font>a
letter<font color="#000080">).


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p></body>
</html>
