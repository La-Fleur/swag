<html>
<head><title> "Stop Screen Output" by ANDREW EIGUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JP&gt; I've got a problem. I'm writing a program that uses a lot of
 JP&gt; compression programs with just a simple shell command. It
 JP&gt; works fine with all of them except from LHA. I execute the
 JP&gt; the line 'LHA E FILENAME.LZH BAH.TXT &gt;NUL', and the '&gt;NUL'
 JP&gt; is enough for all the others, thou not LHA. It still writes
 JP&gt; a lot of crap to the screen. How do I prevent this ?

With the following technique:
}

</i></font><font color="#FF0000"><b>Program </b></font>PreventFromScreenOutput<font color="#000080">;
</font><font color="#008000"><i>{ Written by Andrew Eigus of 2:5100/33 or andrew@cs.rau.lv }
{ Public domain, source that runs any program and prevents it from output
  to a screen }

{$M $4000,0,0} { 16k stack, no heap }

</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NewInt10Vector<font color="#000080">; </font>interrupt<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ This is a simple IRET instruction to all of Int 10h functions }
</i></font><font color="#FF0000"><b>Asm
End</b></font><font color="#000080">; </font><font color="#008000"><i>{ NewInt10Vector }

</i></font><font color="#FF0000"><b>Procedure </b></font>Execute<font color="#000080">(</font>Command <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>OldInt10Vector <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  if </b></font>Command <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    </b></font>Command <font color="#000080">:= </font><font color="#800000">'/C ' </font><font color="#000080">+ </font>Command <font color="#000080">+ </font><font color="#800000">' &gt;nul' </font><font color="#FF0000"><b>else </b></font>Exit<font color="#000080">;
  </font>GetIntVec<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>OldInt10Vector<font color="#000080">);
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, @</font>NewInt10Vector<font color="#000080">);
  </font>SwapVectors<font color="#000080">;
  </font>Exec<font color="#000080">(</font>GetEnv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">), </font>Command<font color="#000080">);
  </font>SwapVectors<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Bad command or file name'</font><font color="#000080">);
  </font>SetIntVec<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>OldInt10Vector<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Execute }

</i></font><font color="#FF0000"><b>var </b></font>Command <font color="#000080">: </font>ComStr<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Command <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
  begin
    </b></font>Write<font color="#000080">(</font><font color="#800000">'Enter command or file name: '</font><font color="#000080">);
    </font>ReadLn<font color="#000080">(</font>Command<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Execute<font color="#000080">(</font>Command<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


</font>BTW<font color="#000080">, </font>it even runs gfx programs <font color="#FF0000"><b>and </b></font>runs <font color="#FF0000"><b>with </b></font>no screen output<font color="#000080">! </font><font color="#FF0000"><b>And </b></font>tested <font color="#FF0000"><b>with
</b></font>LHA<font color="#000080">. </font>It temporary eliminates the video bios support <font color="#000080">(</font>Int <font color="#800000">10</font>h<font color="#000080">) </font>thus preventing
hardware writes <font color="#FF0000"><b>to </b></font>the screen<font color="#000080">. </font>It <font color="#FF0000"><b>is </b></font>quite a rude approach but it works<font color="#000080">!

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CRT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
