<html>
<head><title> "Good Mouse Support" by ANDREW EIGUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Unit </b></font>Mouse<font color="#000080">;
</font><font color="#008000"><i>{ Copyright (c) 1991, Crazy Systems Software, Inc. }

{$G+}

{
 *************************************************
 *                                               *
 *       Mouse in Text Mode Interface Unit       *
 *            for Borland Pascal 7.0             *
 *                                               *
 *      Completely written by  Andrew Eigus      *
 *************************************************
}

</i></font><font color="#FF0000"><b>interface

type
  </b></font>TMouseWinRect <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>word
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>TMouseParamTable <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>BaudRate<font color="#000080">,  </font><font color="#008000"><i>{ Baud rate / 100 }
    </i></font>Emulation<font color="#000080">,
    </font>ReportRate<font color="#000080">, </font><font color="#008000"><i>{ Report rate }
    </i></font>FirmRev<font color="#000080">,
    </font>ZeroWord<font color="#000080">,  </font><font color="#008000"><i>{ Should be zero }
    </i></font>Port<font color="#000080">,  </font><font color="#008000"><i>{ Com Port used }
    </i></font>PhysButtons<font color="#000080">, </font><font color="#008000"><i>{ Physical buttons }
    </i></font>LogButtons <font color="#000080">: </font>word <font color="#008000"><i>{ Logical buttons }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>TMouseRec <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Keys<font color="#000080">,
    </font>Hzints<font color="#000080">,
    </font>Page<font color="#000080">,
    </font>XCoord<font color="#000080">,
    </font>YCoord<font color="#000080">,
    </font>HSpeed<font color="#000080">,
    </font>VSpeed<font color="#000080">,
    </font>DSpeed <font color="#000080">: </font>word<font color="#000080">;
    </font>Column<font color="#000080">,
    </font>Row <font color="#000080">: </font>byte<font color="#000080">;
    </font>W <font color="#000080">: </font>TMouseWinRect<font color="#000080">;
    </font>ButtonClicked <font color="#000080">: </font>byte<font color="#000080">;
    </font>ParamTable <font color="#000080">: </font>TMouseParamTable
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>LeftButton  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>MidButton   <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>RightButton <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;

  </font>mNoInts    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>m30HzInts  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>m50HzInts  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>m100HzInts <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>m200HzInts <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>M <font color="#000080">: </font>TMouseRec<font color="#000080">;
  </font>MouseInstalled <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>InstallMouse <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetMouseInfo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>M <font color="#000080">: </font>TMouseRec<font color="#000080">) : </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ButtonReleased <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>SetMouseCursor<font color="#000080">(</font>CursorOn <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>SetMouseCursorType<font color="#000080">(</font>HotSpotX<font color="#000080">, </font>HotSpotY <font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>CursorImage<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>MoveMouseTo<font color="#000080">(</font>XCoord<font color="#000080">, </font>YCoord <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>SetMouseWindow<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>GetMouseSpeed<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>SetMouseSpeed<font color="#000080">(</font>HorSpeed<font color="#000080">, </font>VrtSpeed<font color="#000080">, </font>DblSpeed <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>SetMouseInts<font color="#000080">(</font>Hz <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>GetMousePage <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>SetMousePage<font color="#000080">(</font>Page <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>UninstallMouse<font color="#000080">;

</font><font color="#FF0000"><b>implementation

Function </b></font>InstallMouse<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">XOR AX,AX  </font><font color="#008000"><i>{ zero function }
  </i></font><font color="#FF00FF">INT 33h
  CMP AL,0
  JE  @@1
  MOV MouseInstalled,True
  LEA DI,M
  MOV [ES:DI](TMouseRec).Keys,0
  MOV [ES:DI](TMouseRec).Keys,BX
  PUSH ES
  PUSH DI
  CALL GetMouseInfo
  CALL GetMousePage
  CALL GetMouseSpeed
  MOV [ES:DI](TMouseRec).W.X1,1
  MOV [ES:DI](TMouseRec).W.Y1,1
  MOV [ES:DI](TMouseRec).W.X2,639
  MOV [ES:DI](TMouseRec).W.Y2,199
  MOV AX,246Ch
  LEA DX,M.ParamTable
  INT 33h
  MOV AL,True
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ InstallMouse }

</i></font><font color="#FF0000"><b>Function </b></font>GetMouseInfo<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,0003h
  INT 33h
  LES DI,M
  MOV [ES:DI](TMouseRec).XCoord,CX
  SHR CX,3
  INC CL
  MOV [ES:DI](TMouseRec).Column,CL
  MOV [ES:DI](TMouseRec).YCoord,DX
  SHR DX,3
  INC DL
  MOV [ES:DI](TMouseRec).Row,DL
  MOV [ES:DI](TMouseRec).ButtonClicked,BL
  MOV AL,BL   </font><font color="#008000"><i>{ LeftButton, MidButton or RightButton }
</i></font><font color="#FF00FF">@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetMouseInfo }

</i></font><font color="#FF0000"><b>Function </b></font>ButtonReleased<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LEA DI,M
  PUSH ES
  PUSH DI
  CALL GetMouseInfo
  MOV AL,True
  CMP BL,0
  JE  @@1
  MOV AL,False
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ ButtonReleased }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMouseCursor<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@2
  MOV AX,0001h
  CMP CursorOn,True
  JE  @@1
  MOV AX,0002h
@@1:
  INT 33h
@@2:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMouseCursor }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMouseCursorType<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,000Ah
  MOV BX,HotSpotX
  MOV CX,HotSpotY
  LES DX,CursorImage
  INT 33h
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMouseCursorType }

</i></font><font color="#FF0000"><b>Procedure </b></font>MoveMouseTo<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,0004h
  MOV CX,XCoord
  MOV DX,YCoord
  INT 33h
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ MoveMouseTo }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMouseWindow<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  LEA DI,M
  MOV AX,0007h
  MOV CX,X1
  MOV [ES:DI](TMouseRec).W.X1,CX
  MOV DX,X2
  MOV [ES:DI](TMouseRec).W.X2,DX
  INT 33h
  MOV AX,0008h
  MOV CX,Y1
  MOV [ES:DI](TMouseRec).W.Y1,CX
  MOV DX,Y2
  MOV [ES:DI](TMouseRec).W.Y2,DX
  INT 33h
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMouseWindow }

</i></font><font color="#FF0000"><b>Procedure </b></font>GetMouseSpeed<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,001Bh
  INT 33h
  LEA DI,M
  MOV [ES:DI](TMouseRec).HSpeed,BX
  MOV [ES:DI](TMouseRec).VSpeed,CX
  MOV [ES:DI](TMouseRec).DSpeed,DX
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetMouseSpeed }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMouseSpeed<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,001Ah
  MOV BX,HorSpeed
  MOV CX,VrtSpeed
  MOV DX,DblSpeed
  INT 33h
  CALL GetMouseSpeed
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMouseSpeed }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMouseInts<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,001Ch
  MOV BX,Hz
  INT 33h
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMouseInts }

</i></font><font color="#FF0000"><b>Function </b></font>GetMousePage<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,001Eh
  INT 33h
  LEA DI,M
  MOV [ES:DI](TMouseRec).Page,BX
  MOV AX,BX
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetMousePage }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetMousePage<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,001D
  MOV BX,Page
  INT 33h
  CALL GetMousePage
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetMousePage }

</i></font><font color="#FF0000"><b>Procedure </b></font>UninstallMouse<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">CMP MouseInstalled,True
  JNE @@1
  MOV AX,0020h
  INT 33h
@@1:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ UninstallMouse }

</i></font><font color="#FF0000"><b>Begin
  </b></font>MouseInstalled <font color="#000080">:= </font>False<font color="#000080">;
  </font>FillChar<font color="#000080">(</font>M<font color="#000080">, </font>SizeOf<font color="#000080">(</font>TMouseRec<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">. </font><font color="#008000"><i>{ Mouse }

{---now the demo program---}

</i></font><font color="#FF0000"><b>Program </b></font>MouDemo<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">, </font>Mouse<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  if </b></font>InstallMouse <font color="#FF0000"><b>then
  begin
    </b></font>ClrScr<font color="#000080">;
    </font>SetMouseCursor<font color="#000080">(</font>True<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Mouse is installed.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Click left mouse button in the upper left corner of your ' </font><font color="#000080">+
      </font><font color="#800000">'screen to quit.'</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat
      </b></font>GetMouseInfo<font color="#000080">(</font>M<font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>M<font color="#000080">.</font>ButtonClicked <font color="#000080">= </font>LeftButton<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>M<font color="#000080">.</font>Column <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>M<font color="#000080">.</font>Row <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">);
    </font>Write<font color="#000080">(</font><font color="#800000">'Waiting to release left button...'</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat until </b></font>ButtonReleased<font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">);
    </font>ClrEol<font color="#000080">;
    </font>SetMouseCursor<font color="#000080">(</font>False<font color="#000080">);
    </font>UninstallMouse
  <font color="#FF0000"><b>end else </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Mouse is NOT installed.'</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
