<html>
<head><title> "Mouse Interrupt Handling-Update" by ALEKSANDAR DLABAC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>MouseInt<font color="#000080">;
</font><font color="#008000"><i>{
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc; Mouse interrupt subroutine handling  &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;           Aleksandar Dlabac          &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;     (C)1997. Dlabac Bros. Company    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;    ------------------------------    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.urc.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.pmf.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
               &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;
}
  </i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

  </font><font color="#FF0000"><b>Var </b></font>ConditionMask <font color="#000080">: </font>word<font color="#000080">; </font><font color="#008000"><i>{  bits:   F-5   4   3   2   1   0
                            unused -----|    |   |   |   |   |
     call if right button released ----------|   |   |   |   |
      call if right button pressed --------------|   |   |   |
      call if left button released ------------------|   |   |
       call if left button pressed ----------------------|   |
               call if mouse moves --------------------------|

     Note: with this mask you define which action will cause your subroutine
           to execute. For example mask 0000000000001010 defines that
           subroutine will be executed every time the left or right mouse
           button is released. }
      </i></font>ButtonState   <font color="#000080">: </font>word<font color="#000080">; </font><font color="#008000"><i>{ 0 - none, 1 - left, 2 - right, 3 - both }
      </i></font>CursorColumn  <font color="#000080">: </font>word<font color="#000080">;
      </font>CursorRow     <font color="#000080">: </font>word<font color="#000080">;
      </font>HorMickeyCnt  <font color="#000080">: </font>word<font color="#000080">;
      </font>VertMickeyCnt <font color="#000080">: </font>word<font color="#000080">;
      </font>OldES<font color="#000080">, </font>OldDX  <font color="#000080">: </font>word<font color="#000080">;
      </font>BothButtons   <font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>DoSomething<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
        Asm
          </b></font><font color="#FF00FF">MOV  AX,0002H     </font><font color="#008000"><i>{ Hide cursor }
          </i></font><font color="#FF00FF">INT  33H
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ClrScr<font color="#000080">;
      </font>Write <font color="#000080">(</font><font color="#800000">'Press both mouse buttons to exit...'</font><font color="#000080">);
      </font>GotoXY <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">'Buttons: '</font><font color="#000080">);
        </font><font color="#FF0000"><b>Case </b></font>ButtonState <font color="#FF0000"><b>and </b></font><font color="#800000">$0003 </font><font color="#FF0000"><b>of
          </b></font><font color="#800000">0 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'None'</font><font color="#000080">);
          </font><font color="#800000">1 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'Left'</font><font color="#000080">);
          </font><font color="#800000">2 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'Right'</font><font color="#000080">);
          </font><font color="#800000">3 </font><font color="#000080">: </font>BothButtons<font color="#000080">:=</font>True
        <font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>GotoXY <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">'X: '</font><font color="#000080">,</font>CursorColumn<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'     Y: '</font><font color="#000080">,</font>CursorRow<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>Asm
          </b></font><font color="#FF00FF">MOV  AX,0001H     </font><font color="#008000"><i>{ Show cursor }
          </i></font><font color="#FF00FF">INT  33H
        </font><font color="#FF0000"><b>End
    End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>MouseHandler<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Asm
      </b></font><font color="#FF00FF">PUSH DS
      PUSH AX
      MOV  AX,Seg @Data
      MOV  DS,AX
      POP  AX
      MOV  ConditionMask,AX
      MOV  ButtonState,BX
      MOV  CursorColumn,CX
      MOV  CursorRow,DX
      MOV  HorMickeyCnt,SI
      MOV  VertMickeyCnt,DI
      CALL DoSomething
      POP  DS
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>Status <font color="#000080">: </font>word<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>BothButtons<font color="#000080">:=</font>False<font color="#000080">;
        </font><font color="#FF0000"><b>Asm
          </b></font><font color="#FF00FF">MOV  AX,0000H
          INT  33H
          MOV  Status,AX
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Status<font color="#000080">=</font><font color="#800000">$0000 </font><font color="#FF0000"><b>then
        Begin
          </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Mouse driver not installed!'</font><font color="#000080">);
          </font>Halt
        <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Asm
          </b></font><font color="#FF00FF">MOV  AX,0014H
          MOV  CX,00011111B   </font><font color="#008000"><i>{ All actions. }
          </i></font><font color="#FF00FF">MOV  DX,Seg MouseHandler
          MOV  ES,DX
          MOV  DX,Offset MouseHandler
          INT  33H
          MOV  OldES,ES
          MOV  OldDX,DX
          MOV  AX,0001H
          INT  33H            </font><font color="#008000"><i>{ Get previous subroutine }
        </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ClrScr<font color="#000080">;
      </font>Write <font color="#000080">(</font><font color="#800000">'Your mouse is waiting...'</font><font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      Asm
        </b></font><font color="#FF00FF">MOV  AX,0002H       </font><font color="#008000"><i>{ Hide cursor }
        </i></font><font color="#FF00FF">INT  33H
        MOV  AX,0014H
        MOV  CX,00011111B
        MOV  ES,OldES
        MOV  DX,OldDX
        INT  33H           </font><font color="#008000"><i>{ Return previous subroutine }
      </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ClrScr
    <font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Begin
      </b></font>Init<font color="#000080">;
        </font><font color="#FF0000"><b>Repeat
        Until </b></font>BothButtons<font color="#000080">;
      </font>Done
    <font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p></body>
</html>
