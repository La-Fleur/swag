<html>
<head><title> "Standard Mouse Routines" by BJARKE VIKSOE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>MOUSE<font color="#000080">;
</font><font color="#008000"><i>{
	Mouse
	- by Bjarke Viksoe

	One of the standard &quot;hey, I can handle the mouse, too&quot; units.
}


</i></font><font color="#FF0000"><b>INTERFACE

function </b></font>InitMouse <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Initialize mouse to its default values for current screenmode.
 Mouse is turned off.
 Returns TRUE if mouse is present.}
</i></font><font color="#FF0000"><b>function </b></font>MouseDriverPresent <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Returns TRUE if there were a mouse driver out there...}
</i></font><font color="#FF0000"><b>procedure </b></font>MouseOn<font color="#000080">;
</font><font color="#008000"><i>{Turns mouse image on}
</i></font><font color="#FF0000"><b>procedure </b></font>MouseOff<font color="#000080">;
</font><font color="#008000"><i>{Turns mouse image off}
</i></font><font color="#FF0000"><b>procedure </b></font>MouseInfo<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>lb<font color="#000080">,</font>rb <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#008000"><i>{Get information about current x- and y-positions.
 Also return info about current status of mouse buttons}
</i></font><font color="#FF0000"><b>function </b></font>LeftButton <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Retuns TRUE if left mouse button is pressed}
</i></font><font color="#FF0000"><b>function </b></font>RightButton <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Retuns TRUE if right mouse button is pressed}
</i></font><font color="#FF0000"><b>procedure </b></font>LastButtonPress<font color="#000080">(</font>button <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Returns last x/y mouse pos when 'button' was pressed}
</i></font><font color="#FF0000"><b>procedure </b></font>LastButtonRelease<font color="#000080">(</font>button <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Returns last x/y mouse pos when 'button' was released}
</i></font><font color="#FF0000"><b>procedure </b></font>SetMousePos<font color="#000080">(</font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Set mouse position on screen...}
</i></font><font color="#FF0000"><b>procedure </b></font>SetMouseWindow<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Set mouse window limit}
</i></font><font color="#FF0000"><b>procedure </b></font>SetMouseImage<font color="#000080">(</font>hotx<font color="#000080">,</font>hoty <font color="#000080">: </font>integer<font color="#000080">; </font>Image <font color="#000080">: </font>pointer<font color="#000080">);
</font><font color="#008000"><i>{Change mouse pointer image.
 &quot;Hot?&quot; ranges from -16 to 16
 &quot;Image&quot; is 16 words of mask + 16 words of image}
</i></font><font color="#FF0000"><b>procedure </b></font>ReadMouseMotionCounters<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#008000"><i>{Read mouse's motion counters}
</i></font><font color="#FF0000"><b>procedure </b></font>DefineMouseRatio<font color="#000080">(</font>h<font color="#000080">,</font>v <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{Change mouse Mickey/pixel ratio}


</i></font><font color="#FF0000"><b>IMPLEMENTATION

function </b></font>InitMouse <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">xor</font>	<font color="#FF00FF">ax,ax
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">not</font>	<font color="#FF00FF">ax
</font>	<font color="#FF00FF">xor</font>	<font color="#FF00FF">ax,1
</font>	<font color="#FF00FF">and</font>	<font color="#FF00FF">ax,1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>MouseDriverPresent <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$21 </font><font color="#008000"><i>{try to reset mouse}
</i></font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">cmp</font>	<font color="#FF00FF">ax,-1
</font>	<font color="#FF00FF">je</font>		<font color="#FF00FF">@found
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0</font>	<font color="#008000"><i>{not there. might be bad driver version... try setup mouse}
</i></font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">push</font>	<font color="#FF00FF">ax
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$2</font>	<font color="#008000"><i>{quickly hide it again}
</i></font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">pop</font>	<font color="#FF00FF">ax
@found:
</font>	<font color="#FF00FF">inc</font>	<font color="#FF00FF">ax
</font>	<font color="#FF00FF">xor</font>	<font color="#FF00FF">ax,1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>MouseOn<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0001
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>MouseOff<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0002
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>MouseInfo<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>lb<font color="#000080">,</font>rb <font color="#000080">: </font>boolean<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0003
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">si,x
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:si],cx
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">si,y
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:si],dx

</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,bx
</font>	<font color="#FF00FF">and</font>	<font color="#FF00FF">al,1
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">si,lb
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:si],al
</font>	<font color="#FF00FF">shr</font>	<font color="#FF00FF">bl,1
</font>	<font color="#FF00FF">and</font>	<font color="#FF00FF">bl,1
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">si,rb
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:si],bl
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LeftButton <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,3
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,bx
</font>	<font color="#FF00FF">and</font>	<font color="#FF00FF">ax,1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RightButton <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,3
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,bx
</font>	<font color="#FF00FF">shr</font>	<font color="#FF00FF">ax,1
</font>	<font color="#FF00FF">and</font>	<font color="#FF00FF">ax,1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LastButtonPress<font color="#000080">(</font>button <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,5
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">bx,button
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,x
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],cx
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,y
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],dx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LastButtonRelease<font color="#000080">(</font>button <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,6
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">bx,button
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,x
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],cx
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,y
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],dx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetMousePos<font color="#000080">(</font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0004
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">cx,x
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">dx,y
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetMouseWindow<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2 <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0007
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">cx,x1
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">dx,x2
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0008
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">cx,y1
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">dx,y2
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetMouseImage<font color="#000080">(</font>hotx<font color="#000080">,</font>hoty <font color="#000080">: </font>integer<font color="#000080">; </font>Image <font color="#000080">: </font>pointer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$0009
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">bx,hotx
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">cx,hoty
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">dx,Image
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DefineMouseRatio<font color="#000080">(</font>h<font color="#000080">,</font>v <font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$000F
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">cx,h
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">dx,v
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ReadMouseMotionCounters<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">ax,$000B
</font>	<font color="#FF00FF">int</font>	<font color="#FF00FF">$33
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,x
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],cx
</font>	<font color="#FF00FF">les</font>	<font color="#FF00FF">di,y
</font>	<font color="#FF00FF">mov</font>	<font color="#FF00FF">[es:di],dx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p></body>
</html>
