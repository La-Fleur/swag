<html>
<head><title> "A Compelte Mouse Unit" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Mouse<font color="#000080">;

</font><font color="#008000"><i>{Program:   Master Mouse Routine Library}

</i></font><font color="#FF0000"><b>INTERFACE

USES </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>CONST

  </b></font><font color="#008000"><i>{Button press definitions}

   </i></font>PrL <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
   </font>PrR <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
   </font>PrLr <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
   </font>PrM <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
   </font>PrLM <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
   </font>PrMR <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
   </font>PrAll <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
   </font>PrNone <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#008000"><i>{Button definitions}

   </i></font>ButtonLeft <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
   </font>ButtonRight <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
   </font>ButtonMiddle <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>ThereIsAMouse<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>MouseReset<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GetMouseStatus
         <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>MPosX<font color="#000080">, </font>MPosY<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearButton <font color="#000080">(</font>Button<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>MouseOn<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>MouseOff<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetMouseSoftCursor
   <font color="#000080">(</font>MouseChar<font color="#000080">, </font>MouseFGColor<font color="#000080">, </font>MouseBGColor<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

CONST
   </b></font>MouseIntr <font color="#000080">= </font><font color="#800000">$33</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>MouseVisible                         <font color="#000080">: </font>Boolean<font color="#000080">;
   </font>MHMax<font color="#000080">, </font>MVMax<font color="#000080">, </font>MHCell<font color="#000080">, </font>MVCell         <font color="#000080">: </font>Word<font color="#000080">;
   </font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MouseHandler <font color="#000080">(</font>A<font color="#000080">, </font>B<font color="#000080">, </font>C<font color="#000080">, </font>D<font color="#000080">: </font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN
      WITH </b></font>Regs <font color="#FF0000"><b>DO
                        BEGIN
                                </b></font>ax <font color="#000080">:= </font>A<font color="#000080">;
                                </font>bx <font color="#000080">:= </font>B<font color="#000080">;
                                </font>cx <font color="#000080">:= </font>C<font color="#000080">;
                                </font>dx <font color="#000080">:= </font>D<font color="#000080">;
                                </font>Intr<font color="#000080">(</font>MouseIntr<font color="#000080">, </font>Regs<font color="#000080">)
                        </font><font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetButtonUpStatus
  <font color="#000080">(</font>Button<font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>MPosX<font color="#000080">, </font>MPosY<font color="#000080">: </font>Word<font color="#000080">): </font>Boolean<font color="#000080">;

   </font><font color="#FF0000"><b>BEGIN
      WITH </b></font>Regs <font color="#FF0000"><b>DO
                        BEGIN
                                </b></font>ax <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
                                </font>bx <font color="#000080">:= </font>Button<font color="#000080">;
                                </font>MouseHandler<font color="#000080">(</font>ax<font color="#000080">, </font>bx<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                                </font>MPosX <font color="#000080">:= </font>cx <font color="#FF0000"><b>DIV </b></font>MHCell <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                </font>MPosY <font color="#000080">:= </font>dx <font color="#FF0000"><b>DIV </b></font>MVCell <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                </font><font color="#FF0000"><b>IF </b></font>ax <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                                        </b></font>GetButtonUpStatus <font color="#000080">:= </font>TRUE
                                <font color="#FF0000"><b>ELSE
                                        </b></font>GetButtonUpStatus <font color="#000080">:= </font>FALSE
                        <font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearButton <font color="#000080">(</font>Button<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>MPosX<font color="#000080">,</font>MPosY<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>BEGIN
      REPEAT UNTIL
          </b></font>GetButtonUpStatus<font color="#000080">(</font>Button<font color="#000080">, </font>MPosX<font color="#000080">,</font>MPosY<font color="#000080">)
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetMouseStatus
         <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>MPosX<font color="#000080">, </font>MPosY<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      WITH </b></font>Regs <font color="#FF0000"><b>DO
                        BEGIN
                                </b></font>ax <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                                </font>MouseHandler<font color="#000080">(</font>ax<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                                </font>GetMouseStatus <font color="#000080">:= </font>bx<font color="#000080">;
                                </font>MPosX <font color="#000080">:= </font>cx <font color="#FF0000"><b>DIV </b></font>MHCell <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                </font>MPosY <font color="#000080">:= </font>dx <font color="#FF0000"><b>DIV </b></font>MVCell <font color="#000080">+ </font><font color="#800000">1
                        </font><font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MouseOff<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF </b></font>MouseVisible <font color="#FF0000"><b>THEN
                        BEGIN
                                </b></font>MouseHandler<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                                </font>MouseVisible <font color="#000080">:= </font>FALSE
                        <font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MouseOn<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF NOT </b></font>MouseVisible <font color="#FF0000"><b>THEN
                        BEGIN
                                </b></font>MouseHandler<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                                </font>MouseVisible <font color="#000080">:= </font>TRUE
                        <font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>MouseReset<font color="#000080">: </font>Boolean<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      </b></font>MHMax <font color="#000080">:= </font><font color="#800000">639</font><font color="#000080">; </font><font color="#008000"><i>{Max virtual horizontal pos}
      </i></font>MVMax <font color="#000080">:= </font><font color="#800000">199</font><font color="#000080">; </font><font color="#008000"><i>{Max virtual vertical pos}
      </i></font>MHCell <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;  </font><font color="#008000"><i>{Mouse horizontal cell width}
      </i></font>MVCell <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;  </font><font color="#008000"><i>{Mouse vertical cell height}
      </i></font>MouseHandler<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>Regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
         </b></font>MouseReset <font color="#000080">:= </font>FALSE
      <font color="#FF0000"><b>ELSE
         </b></font>MouseReset <font color="#000080">:= </font>TRUE<font color="#000080">;
                        </font>MouseVisible <font color="#000080">:= </font>FALSE
   <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetMouseSoftCursor
   <font color="#000080">(</font>MouseChar<font color="#000080">, </font>MouseFGColor<font color="#000080">, </font>MouseBGColor<font color="#000080">: </font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN
      </b></font>MouseOn<font color="#000080">;
      </font>Regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
      </font>Regs<font color="#000080">.</font>bx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{Select software cursor}
   {Screen Mask Value (don't change character)}
      </i></font>Regs<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">$8800</font><font color="#000080">;
      </font>Regs<font color="#000080">.</font>dx <font color="#000080">:= </font><font color="#800000">$8800 </font><font color="#000080">+ </font>MouseBGColor <font color="#000080">* </font><font color="#800000">4096 </font><font color="#000080">+
                  </font>MouseFGColor <font color="#000080">* </font><font color="#800000">256 </font><font color="#000080">+ </font>MouseChar<font color="#000080">;
      </font>Intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">,</font>Regs<font color="#000080">);
      </font>MouseOff
   <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ThereIsAMouse<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>CONST
   </b></font>IRET <font color="#000080">= </font><font color="#800000">207</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>MouseSegment <font color="#000080">: </font>Word <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$00CE</font><font color="#000080">;
   </font>MouseOffset <font color="#000080">: </font>Word <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$00CC</font><font color="#000080">;
   </font>MouseInstruction<font color="#000080">: </font>Byte<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF </b></font><font color="#000080">(</font>MouseSegment <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
           </b></font><font color="#000080">(</font>MouseOffset <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
         </b></font>ThereIsAMouse <font color="#000080">:= </font>FALSE
      <font color="#FF0000"><b>ELSE
                        BEGIN
                                </b></font>MouseInstruction <font color="#000080">:=
                   </font>MEM<font color="#000080">[</font>MouseSegment<font color="#000080">:</font>MouseOffset<font color="#000080">];
                                </font><font color="#FF0000"><b>IF </b></font>MouseInstruction <font color="#000080">= </font>IRET <font color="#FF0000"><b>THEN
                                        </b></font>ThereIsAMouse <font color="#000080">:= </font>FALSE
                                <font color="#FF0000"><b>ELSE
                                        </b></font>ThereIsAMouse <font color="#000080">:= </font>TRUE
                        <font color="#FF0000"><b>END
   END</b></font><font color="#000080">;

</font><font color="#008000"><i>{No initialization section}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
