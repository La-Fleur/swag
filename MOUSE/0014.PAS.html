<html>
<head><title> "What PORT is Mouse on" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{************************************************************}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>WhatPortIsTheMouseOn<font color="#000080">;   </font><font color="#008000"><i>{ Sept 18/93, Greg Estabrooks}
</i></font><font color="#FF0000"><b>TYPE
    </b></font>MouseParamTable <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                        </b></font>BaudRate   <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Baud Rate Div 100}
                        </i></font>Emulation  <font color="#000080">:</font>WORD<font color="#000080">;
                        </font>ReportRate <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Report Rate.     }
                        </i></font>FirmRev    <font color="#000080">:</font>WORD<font color="#000080">;
                        </font>ZeroWord   <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Should be zero.  }
                        </i></font>PortLoc    <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Com Port Used.   }
                        </i></font>PhysButtons<font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Physical Buttons.}
                        </i></font>LogButtons <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#008000"><i>{ Logical Buttons. }
                      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>MouseInf <font color="#000080">:</font>MouseParamTable<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetMouseInf<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>MouseTable <font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{ Routine to Get info about mouse.   }
                       { NOTE Doesn't check to see if a     }
                       {  a mouse is installed.             }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Push AX                      </font><font color="#008000"><i>{ Save Registers Used.       }
  </i></font><font color="#FF00FF">Push ES
  Push DX
  Mov AX,$246C                 </font><font color="#008000"><i>{ Get Mouse Parameters.      }
  </i></font><font color="#FF00FF">LES DX,MouseTable            </font><font color="#008000"><i>{ Point ES:DX to Param Table.}
  </i></font><font color="#FF00FF">Int $33                      </font><font color="#008000"><i>{ Call Mouse Interrupt.      }
  </i></font><font color="#FF00FF">Pop DX                       </font><font color="#008000"><i>{ Restore Registers used.    }
  </i></font><font color="#FF00FF">Pop ES
  Pop AX
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{GetMouseInf}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GetMouseInf<font color="#000080">(</font>MouseInf<font color="#000080">);        </font><font color="#008000"><i>{ Get mouse info.            }
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'     ___Mouse Info___'</font><font color="#000080">); </font><font color="#008000"><i>{ Show a title.          }
  </i></font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>WITH </b></font>MouseInf <font color="#FF0000"><b>DO              </b></font><font color="#008000"><i>{ Display Mouse Info.        }
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Baud Rate     : '</font><font color="#000080">,</font>BaudRate <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Emulation     : '</font><font color="#000080">,</font>Emulation<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Report Rate   : '</font><font color="#000080">,</font>ReportRate<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'FirmWare Rev  : '</font><font color="#000080">,</font>FirmRev<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Com Port      : '</font><font color="#000080">,</font>PortLoc<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Physical Butns: '</font><font color="#000080">,</font>PhysButtons<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Logical Buttns: '</font><font color="#000080">,</font>LogButtons<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Readln<font color="#000080">;                       </font><font color="#008000"><i>{ Wait for user to have a look.}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{WhatPortIsTheMouseOn}
{************************************************************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
