<html>
<head><title> "Mouse Library" by LOU DUCHEZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: LOU DUCHEZ
Subj: mouse Library
}

</i></font><font color="#FF0000"><b>unit </b></font>mouse<font color="#000080">;
</font><font color="#FF0000"><b>interface                                 </b></font><font color="#008000"><i>{ &quot;Global&quot; declarations }
</i></font><font color="#FF0000"><b>var </b></font>mouseexist<font color="#000080">, </font>mousecursoron<font color="#000080">: </font>boolean<font color="#000080">;   </font><font color="#008000"><i>{ Is a mouse hooked up? / Is the    }
</i></font><font color="#FF0000"><b>procedure </b></font>mouseinit<font color="#000080">;                      </font><font color="#008000"><i>{   mouse cursor &quot;on&quot;?              }
</i></font><font color="#FF0000"><b>procedure </b></font>mouseon<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>mouseoff<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>mousex<font color="#000080">: </font>word<font color="#000080">;                    </font><font color="#008000"><i>{ Note about coordinates: these     }
</i></font><font color="#FF0000"><b>function </b></font>mousey<font color="#000080">: </font>word<font color="#000080">;                    </font><font color="#008000"><i>{  routines return values starting  }
</i></font><font color="#FF0000"><b>function </b></font>mouseleft<font color="#000080">: </font>boolean<font color="#000080">;              </font><font color="#008000"><i>{  at 0, not 1 (even in text mode). }
</i></font><font color="#FF0000"><b>function </b></font>mousemiddle<font color="#000080">: </font>boolean<font color="#000080">;            </font><font color="#008000"><i>{  So for text mode, you may want   }
</i></font><font color="#FF0000"><b>function </b></font>mouseright<font color="#000080">: </font>boolean<font color="#000080">;             </font><font color="#008000"><i>{  to modify a bit ...              }
</i></font><font color="#FF0000"><b>procedure </b></font>setmousexy<font color="#000080">(</font>newx<font color="#000080">, </font>newy<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>limitmouse<font color="#000080">(</font>lox<font color="#000080">, </font>loy<font color="#000080">, </font>hix<font color="#000080">, </font>hiy<font color="#000080">: </font>word<font color="#000080">);


</font><font color="#FF0000"><b>implementation                            </b></font><font color="#008000"><i>{ internal workings }
</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>regs<font color="#000080">: </font>registers<font color="#000080">;                      </font><font color="#008000"><i>{ Used for the &quot;mouse&quot; interrupts }
    </i></font>xshift<font color="#000080">, </font>yshift<font color="#000080">: </font>byte<font color="#000080">;                 </font><font color="#008000"><i>{ Depending on your video mode, you }
                                          {  may need to convert &quot;mouse&quot;      }
                                          {  coordinates to / from &quot;video&quot;    }
</i></font><font color="#FF0000"><b>procedure </b></font>calcshifts<font color="#000080">;                     </font><font color="#008000"><i>{  coordinates.  It's a matter of   }
</i></font><font color="#FF0000"><b>var </b></font>tempregs<font color="#000080">: </font>registers<font color="#000080">;                  </font><font color="#008000"><i>{  shifting left/right; xshift      }
</i></font><font color="#FF0000"><b>begin                                     </b></font><font color="#008000"><i>{  records how to shift the &quot;X&quot;,    }
  </i></font>tempregs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$0f</font><font color="#000080">;                     </font><font color="#008000"><i>{  and yshift records for the &quot;Y&quot;.  }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>tempregs<font color="#000080">);                    </font><font color="#008000"><i>{ Procedure CalcShifts figures out  }
  </i></font><font color="#FF0000"><b>case </b></font>tempregs<font color="#000080">.</font>al <font color="#FF0000"><b>of                     </b></font><font color="#008000"><i>{  what text mode you're in and how }
    </i></font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">: </font><font color="#FF0000"><b>begin                  </b></font><font color="#008000"><i>{  much to shift by.  It gets the   }
      </i></font>xshift <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;                        </font><font color="#008000"><i>{  video mode w/interrupt $10/$0f;  }
      </i></font>yshift <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;                        </font><font color="#008000"><i>{  modes 0, 1, 2, 3 and 7 are text  }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                </font><font color="#008000"><i>{  modes.  4, 5, $0d and $13 are    }
    </i></font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">$0d</font><font color="#000080">, </font><font color="#800000">$13</font><font color="#000080">: </font><font color="#FF0000"><b>begin                 </b></font><font color="#008000"><i>{  320 x 200 graphics modes.  All   }
      </i></font>xshift <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                        </font><font color="#008000"><i>{  other graphics modes are okay    }
      </i></font>yshift <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                        </font><font color="#008000"><i>{  &quot;as is&quot;, although come to think  }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                </font><font color="#008000"><i>{  of it I had a CGA system when I  }
    </i></font><font color="#FF0000"><b>else begin                            </b></font><font color="#008000"><i>{  wrote this library and thus      }
      </i></font>xshift <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                        </font><font color="#008000"><i>{  couldn't text VGA modes ...      }
      </i></font>yshift <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>mouseinit<font color="#000080">;                  </font><font color="#008000"><i>{ Initializes mouse -- determines if   }
</i></font><font color="#FF0000"><b>begin                                 </b></font><font color="#008000"><i>{ one is present, then figures out the }
  </i></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;                   </font><font color="#008000"><i>{ shifts, and initializes the &quot;cursor&quot; }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);                    </font><font color="#008000"><i>{ variable to &quot;false&quot;. }
  </i></font>mouseexist <font color="#000080">:= (</font>regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">$FFFF</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>mouseexist <font color="#FF0000"><b>then </b></font>calcshifts<font color="#000080">;      </font><font color="#008000"><i>{ Called automatically on startup; you }
  </i></font>mousecursoron <font color="#000080">:= </font>false<font color="#000080">;             </font><font color="#008000"><i>{ should call it if you change video   }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                </font><font color="#008000"><i>{ modes in the program. }


</i></font><font color="#FF0000"><b>procedure </b></font>mouseon<font color="#000080">;                    </font><font color="#008000"><i>{ Turns cursor ON. }
</i></font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin            </b></font><font color="#008000"><i>{ Note: you really should &quot;pair&quot; each }
    </i></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0001</font><font color="#000080">;                 </font><font color="#008000"><i>{  &quot;on&quot; with an &quot;off&quot;; if you don't,  }
    </i></font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);                  </font><font color="#008000"><i>{  the PC can get confused. }
    </i></font>mousecursoron <font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>mouseoff<font color="#000080">;                   </font><font color="#008000"><i>{ Turns cursor OFF.  Note: when writing }
</i></font><font color="#FF0000"><b>begin                                 </b></font><font color="#008000"><i>{  to the screen, you typically want to }
  </i></font><font color="#FF0000"><b>if </b></font>mouseexist <font color="#FF0000"><b>then begin            </b></font><font color="#008000"><i>{  turn the cursor OFF: the PC isn't    }
    </i></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0002</font><font color="#000080">;                 </font><font color="#008000"><i>{  smart enough to say, &quot;I'm writing a  }
    </i></font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);                  </font><font color="#008000"><i>{  character right where the mouse      }
    </i></font>mousecursoron <font color="#000080">:= </font>false<font color="#000080">;           </font><font color="#008000"><i>{  cursor is: better make it inverse    }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                              </font><font color="#008000"><i>{  video&quot;.  So you need to shut it off. }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>mousex<font color="#000080">: </font>word<font color="#000080">;                </font><font color="#008000"><i>{ Gets the current mouse column. }
</i></font><font color="#FF0000"><b>var </b></font>tempword<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0003</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
    </font>tempword <font color="#000080">:= </font>regs<font color="#000080">.</font>cx<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    </b></font>tempword <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mousex <font color="#000080">:= </font>tempword <font color="#FF0000"><b>shr </b></font>xshift<font color="#000080">;      </font><font color="#008000"><i>{ one of those funky &quot;shift&quot; things }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>mousey<font color="#000080">: </font>word<font color="#000080">;                </font><font color="#008000"><i>{ Gets the current mouse row. }
</i></font><font color="#FF0000"><b>var </b></font>tempword<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0003</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
    </font>tempword <font color="#000080">:= </font>regs<font color="#000080">.</font>dx<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    </b></font>tempword <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mousey <font color="#000080">:= </font>tempword <font color="#FF0000"><b>shr </b></font>yshift<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>mouseleft<font color="#000080">: </font>boolean<font color="#000080">;      </font><font color="#008000"><i>{ Is the left button down? }
</i></font><font color="#FF0000"><b>var </b></font>tempword<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0003</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
    </font>tempword <font color="#000080">:= </font>regs<font color="#000080">.</font>bx<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    </b></font>tempword <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mouseleft <font color="#000080">:= </font>mouseexist <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>and </b></font>tempword <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>mousemiddle<font color="#000080">: </font>boolean<font color="#000080">;    </font><font color="#008000"><i>{ Is the middle button down? }
</i></font><font color="#FF0000"><b>var </b></font>tempword<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0003</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
    </font>tempword <font color="#000080">:= </font>regs<font color="#000080">.</font>bx<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    </b></font>tempword <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mousemiddle <font color="#000080">:= </font>mouseexist <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">4 </font><font color="#FF0000"><b>and </b></font>tempword <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>mouseright<font color="#000080">: </font>boolean<font color="#000080">;     </font><font color="#008000"><i>{ Is the right button down? }
</i></font><font color="#FF0000"><b>var </b></font>tempword<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>mouseexist <font color="#FF0000"><b>then begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0003</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
    </font>tempword <font color="#000080">:= </font>regs<font color="#000080">.</font>bx<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    </b></font>tempword <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>mouseright <font color="#000080">:= </font>mouseexist <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">2 </font><font color="#FF0000"><b>and </b></font>tempword <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>setmousexy<font color="#000080">(</font>newx<font color="#000080">, </font>newy<font color="#000080">: </font>word<font color="#000080">);   </font><font color="#008000"><i>{ Position mouse cursor. }
</i></font><font color="#FF0000"><b>begin
  </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0004</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font>newx <font color="#FF0000"><b>shl </b></font>xshift<font color="#000080">;             </font><font color="#008000"><i>{ Shifts to get it into &quot;mouse&quot; }
  </i></font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font>newy <font color="#FF0000"><b>shl </b></font>yshift<font color="#000080">;             </font><font color="#008000"><i>{  coordinates. }
  </i></font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>limitmouse<font color="#000080">(</font>lox<font color="#000080">, </font>loy<font color="#000080">, </font>hix<font color="#000080">, </font>hiy<font color="#000080">: </font>word<font color="#000080">);   </font><font color="#008000"><i>{ Restrict mouse movements. }
</i></font><font color="#FF0000"><b>begin
  </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$0f</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>regs<font color="#000080">);
  </font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0007</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font>lox <font color="#FF0000"><b>shl </b></font>xshift<font color="#000080">;
  </font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font>hix <font color="#FF0000"><b>shl </b></font>xshift<font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
  </font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$0008</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font>loy <font color="#FF0000"><b>shl </b></font>yshift<font color="#000080">;
  </font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font>hiy <font color="#FF0000"><b>shl </b></font>yshift<font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">, </font>regs<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin                 </b></font><font color="#008000"><i>{ Startup code: initializes mouse and gets video mode. }
  </i></font>mouseinit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
