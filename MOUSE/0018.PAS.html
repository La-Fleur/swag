<html>
<head><title> "TP7 Mouse Unit" by MARK MILBRATH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>MouseDemo<font color="#000080">;   </font><font color="#008000"><i>{ I just learned this little piece of wizardry }
</i></font><font color="#FF0000"><b>Uses                 </b></font><font color="#008000"><i>{ so I thought I would pass it on -- have fun! }
  </i></font>Crt<font color="#000080">,</font>Dos<font color="#000080">,</font>Drivers<font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>CharType<font color="#000080">=</font><font color="#FF0000"><b>Set Of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Key<font color="#000080">:</font>Char<font color="#000080">; </font>ValidKeys<font color="#000080">:</font>CharType<font color="#000080">;
  </font>Button_Status<font color="#000080">,</font>Mouse_X<font color="#000080">,</font>Mouse_Y<font color="#000080">,</font>ButtonPressed<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GetMouse <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Button_Status<font color="#000080">,</font>Mouse_X<font color="#000080">,</font>Mouse_Y<font color="#000080">:</font>Word<font color="#000080">;
                                              </font>Monitor<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var                       </b></font><font color="#008000"><i>{ --------------------------------------- }
  </i></font>Regs<font color="#000080">:</font>Registers<font color="#000080">;         </font><font color="#008000"><i>{ Button_Status     0 = no button pressed }
</i></font><font color="#FF0000"><b>Begin                     </b></font><font color="#008000"><i>{ Mouse_X           X coordinate          }
  </i></font>Regs<font color="#000080">.</font>AX<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;             </font><font color="#008000"><i>{ Mouse_Y           Y coordinate          }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">,</font>Regs<font color="#000080">);         </font><font color="#008000"><i>{ Monitor           0 = off  1 = on       }
  </i></font>Button_Status<font color="#000080">:=</font>Regs<font color="#000080">.</font>BX<font color="#000080">; </font><font color="#008000"><i>{ Monitor can be set to 1 While coding to }
  </i></font>Mouse_X      <font color="#000080">:=</font>Regs<font color="#000080">.</font>CX<font color="#000080">; </font><font color="#008000"><i>{ display Button_Status,   Mouse_X,   and }
  </i></font>Mouse_Y      <font color="#000080">:=</font>Regs<font color="#000080">.</font>DX<font color="#000080">; </font><font color="#008000"><i>{ Mouse_Y in the upper-left corner of the }
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Monitor<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then     </b></font><font color="#008000"><i>{ screen                                  }
    </i></font><font color="#FF0000"><b>Begin                 </b></font><font color="#008000"><i>{ --------------------------------------- }
      </i></font>TextBackGround<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">); </font>TextColor<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>Write<font color="#000080">(</font><font color="#800000">'             '</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>Write<font color="#000080">(</font>Button_Status<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>Mouse_X<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Mouse_Y<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">); </font>Delay<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)
    </font><font color="#FF0000"><b>End
End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GetEvent<font color="#000080">;
</font><font color="#FF0000"><b>Label
  </b></font>ExitLoop<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TextBackGround<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>ClrScr<font color="#000080">; </font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Continue? [Y] or [N]? '</font><font color="#000080">);
  </font>ValidKeys<font color="#000080">:=[</font><font color="#800000">#89</font><font color="#000080">,</font><font color="#800000">#78</font><font color="#000080">];          </font><font color="#008000"><i>{ accept only Y or N as valid keys }
  </i></font>Key<font color="#000080">:=</font><font color="#800000">#255</font><font color="#000080">;                     </font><font color="#008000"><i>{ initialize Key to a nonvalid key }
  </i></font><font color="#FF0000"><b>Repeat
    While </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>KeyPressed<font color="#000080">) </font><font color="#FF0000"><b>Do
      Begin
        </b></font>GetMouse<font color="#000080">(</font>Button_Status<font color="#000080">,</font>Mouse_X<font color="#000080">,</font>Mouse_Y<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
        </font><font color="#FF0000"><b>Repeat                               </b></font><font color="#008000"><i>{ ^  turns monitor off }
          </i></font>GetMouse<font color="#000080">(</font>ButtonPressed<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) </font><font color="#008000"><i>{ X &amp; Y are dummy variables }
        </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>ButtonPressed<font color="#000080">&lt;&gt;</font>Button_Status<font color="#000080">);
    </font><font color="#008000"><i>{ Repeat ^ Until &quot;waits&quot; until a change in Button_Status occurs }
    { this eliminates a &quot;slow&quot; click from being processed as two or }
    { more clicks                                                   }
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Button_Status<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ a mouse button has been pressed }
          </i></font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{ convert mouse clicks into corresponding key codes }
            </i></font><font color="#FF0000"><b>If      </b></font><font color="#000080">(</font>Mouse_X<font color="#000080">=</font><font color="#800000">288</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Mouse_Y<font color="#000080">=</font><font color="#800000">88</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Key<font color="#000080">:=</font><font color="#800000">#89
            </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>Mouse_X<font color="#000080">=</font><font color="#800000">344</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Mouse_Y<font color="#000080">=</font><font color="#800000">88</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Key<font color="#000080">:=</font><font color="#800000">#78</font><font color="#000080">;
            </font><font color="#FF0000"><b>If      </b></font><font color="#000080">(</font>Key <font color="#FF0000"><b>In </b></font>ValidKeys<font color="#000080">)             </font><font color="#FF0000"><b>Then Goto </b></font>ExitLoop
          <font color="#FF0000"><b>End                              </b></font><font color="#008000"><i>{ exit the loop if valid }
      </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;                                 </font><font color="#008000"><i>{ key codes are received }
    </i></font>Key<font color="#000080">:=</font>Upcase<font color="#000080">(</font>ReadKey<font color="#000080">) </font><font color="#008000"><i>{ get keyboard event if KeyPressed is true }
  </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Key <font color="#FF0000"><b>In </b></font>ValidKeys<font color="#000080">);
  </font>ExitLoop<font color="#000080">: </font>TextBackGround<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>ClrScr<font color="#000080">; </font>TextColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Key<font color="#000080">=</font><font color="#800000">#89 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Randomize<font color="#000080">;
      </font>X<font color="#000080">:=</font>Random<font color="#000080">(</font><font color="#800000">61</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;      </font><font color="#008000"><i>{ pick a random X column from 10 to 60 }
      </i></font>Y<font color="#000080">:=</font>Random<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">)+ </font><font color="#800000">3</font><font color="#000080">;      </font><font color="#008000"><i>{ pick a random Y row    from  3 to 23 }
      </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);     </font>Write<font color="#000080">(</font><font color="#800000">#177</font><font color="#000080">);
      </font>GotoXY<font color="#000080">(</font>X<font color="#000080">-</font><font color="#800000">5</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Click here!'</font><font color="#000080">);
              </font><font color="#008000"><i>{ the X column and Y row numbers must be converted to }
              { X and Y coordinates by multiplying the column &amp; row }
              { numbers by 8 and then subtracting 8 from that value }
      </i></font><font color="#FF0000"><b>Repeat  </b></font><font color="#008000"><i>{ for example:  column 40, row 10 converts to 312, 72 }
        </i></font>GetMouse<font color="#000080">(</font>Button_Status<font color="#000080">,</font>Mouse_X<font color="#000080">,</font>Mouse_Y<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
                                             </font><font color="#008000"><i>{ ^   turns monitor on }
      </i></font><font color="#FF0000"><b>Until</b></font><font color="#000080">(</font>Button_Status<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Mouse_X<font color="#000080">=</font>X<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Mouse_Y<font color="#000080">=</font>Y<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">);
      </font>GetEvent                   <font color="#008000"><i>{        ^^^^^               ^^^^^ }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;                         </font><font color="#008000"><i>{ X coordinate        Y coordinate }
  </i></font>HideMouse<font color="#000080">; </font>ClrScr
<font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>InitEvents<font color="#000080">;
        </font><font color="#008000"><i>{ sets the &quot;hide counter&quot; to zero and displays mouse cursor }
        { use ShowMouse to decrement the hide counter               }
        { use HideMouse to increment the hide counter               }
        { when hide counter equals zero the mouse cursor is visible }
  </i></font>GetEvent
<font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MOUSE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
