<html>
<head><title> "LZH Compression" by STEVEN DEBRUYN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DATATYPE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I want to use LZH compression for a backup module in one of my programs. I
found a great working source code. I'll post it here ... only problem I have
is that it's kinda slow ... I need to compress a file of 4 Mb ... this file
contains a lot of empty space. I know this routine could be speeded up a LOT.
Here's how ... (I didn't come up with the idea)

      bytes (i.e. a file full of blanks, or nuls).  I believe
      this would be improved by preceding the encoding with
      run length compression, using 90h as the encodeing signal,
      so that &lt;char&gt; 90h nn (with 2 &lt;= nn &lt;= 255) represents
      &lt;char&gt; followed by nn repetitions, i.e. at least a total
      of nn+1 occurences of &lt;char&gt;.  &lt;90h 0&gt; would represent 90h
      itself, and 90h cannot be run length encoded.  &lt;90h 1&gt;
      would represent EOF, thus embedding a specific EOF marker
      in the file.  This allows use where the actual file length
      is unknown before it is reached, i.e. in communications.

See, this guy says it's possible, now it's up to you guys to do it, I'm not
good experienced enough to come up with it myself.
Hope you can help, in the next 3 messages you'll find the LZH code.
}


{$A+,B-,D+,E+,F-,I-,L+,N+,O-,R-,S-,V-}
{$M 16384,0,655360}
</i></font><font color="#FF0000"><b>program </b></font>LZH_Test<font color="#000080">;
</font><font color="#FF0000"><b>uses
  </b></font>LZH<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>IObuf <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">*</font><font color="#800000">1024</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>infile<font color="#000080">,</font>outfile<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>ibuf<font color="#000080">,</font>obuf<font color="#000080">: </font>IObuf<font color="#000080">;
  </font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>Error <font color="#000080">(</font>msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>writeln<font color="#000080">(</font>msg<font color="#000080">);
    </font>HALT<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}
  </i></font><font color="#FF0000"><b>procedure </b></font>ReadNextBlock<font color="#000080">;
</font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>begin
    </b></font>inptr<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>BlockRead<font color="#000080">(</font>infile<font color="#000080">,</font>inbuf<font color="#000080">^,</font>sizeof<font color="#000080">(</font>ibuf<font color="#000080">),</font>inend<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>IoResult<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">'! Error reading input file'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}
  </i></font><font color="#FF0000"><b>procedure </b></font>WriteNextBlock<font color="#000080">;
</font><font color="#008000"><i>{$F-}
  </i></font><font color="#FF0000"><b>var
    </b></font>wr<font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>BlockWrite<font color="#000080">(</font>outfile<font color="#000080">,</font>outbuf<font color="#000080">^,</font>outptr<font color="#000080">,</font>wr<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>IoResult<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>wr<font color="#000080">&lt;</font>outptr<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Error<font color="#000080">(</font><font color="#800000">'! Error writing output file'</font><font color="#000080">);
    </font>outptr<font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>OpenInput <font color="#000080">(</font>fn<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>infile<font color="#000080">,</font>fn<font color="#000080">); </font>reset<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>IoResult<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">'! Can''t open input file'</font><font color="#000080">);
    </font>inbuf<font color="#000080">:= @</font>ibuf<font color="#000080">;
    </font>ReadToBuffer<font color="#000080">:= </font>ReadNextBlock<font color="#000080">;
    </font>ReadToBuffer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>OpenOutput <font color="#000080">(</font>fn<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>outfile<font color="#000080">,</font>fn<font color="#000080">); </font>rewrite<font color="#000080">(</font>outfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>IoResult<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">'! Can''t open output file'</font><font color="#000080">);
    </font>outbuf<font color="#000080">:= @</font>obuf<font color="#000080">;
    </font>outend<font color="#000080">:= </font>sizeof<font color="#000080">(</font>obuf<font color="#000080">);
    </font>outptr<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>WriteFromBuffer<font color="#000080">:= </font>WriteNextBlock<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{main}
   </i></font><font color="#FF0000"><b>if </b></font>ParamCount<font color="#000080">&lt;&gt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then begin
     </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage: lzhuf e(compression)|d(uncompression) infile outfile'</font><font color="#000080">);
     </font>HALT<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>OpenInput<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
   </font>OpenOutput<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">));
   </font>s<font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>case </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
     </b></font><font color="#800000">'e'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">: </font>Encode<font color="#000080">(</font>filesize<font color="#000080">(</font>infile<font color="#000080">));
     </font><font color="#800000">'d'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">: </font>Decode
   <font color="#FF0000"><b>else
     </b></font>Error<font color="#000080">(</font><font color="#800000">'! Use [D] for Decompression or [E] for Compression'</font><font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>close<font color="#000080">(</font>infile<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>IoResult<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">'! Error closing input file'</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>outptr<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>WriteNextBlock<font color="#000080">;
   </font>close<font color="#000080">(</font>outfile<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>IoResult<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">'! Error closing output file'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{ LZHUF.C English version 1.0
  Based on Japanese version 29-NOV-1988
  LZSS coded by Haruhiko OKUMURA
  Adaptive Huffman Coding coded by Haruyasu YOSHIZAKI
  Edited and translated to English by Kenji RIKITAKE
  Converted to Turbo Pascal 5.0
    by Peter Sawatzki with assistance of Wayne Sullivan
}
{$i-,r-,v-,s-}
</i></font><font color="#FF0000"><b>Unit </b></font>LZH<font color="#000080">;
</font><font color="#FF0000"><b>Interface
type
  </b></font>bufar <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">; </font><font color="#008000"><i>{will be overindexed}
</i></font><font color="#FF0000"><b>var
  </b></font>WriteFromBuffer<font color="#000080">,
  </font>ReadToBuffer<font color="#000080">: </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">;
  </font>inbuf<font color="#000080">,</font>outbuf<font color="#000080">: ^</font>bufar<font color="#000080">;
  </font>inptr<font color="#000080">,</font>inend<font color="#000080">,</font>outptr<font color="#000080">,</font>outend<font color="#000080">: </font>word<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>Encode <font color="#000080">(</font>bytes<font color="#000080">: </font>LongInt<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>Decode<font color="#000080">;

</font><font color="#FF0000"><b>Implementation
Const
</b></font><font color="#008000"><i>{-LZSS Parameters}
  </i></font>N         <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">; </font><font color="#008000"><i>{Size of string buffer}
  </i></font>F         <font color="#000080">= </font><font color="#800000">60</font><font color="#000080">;   </font><font color="#008000"><i>{60 Size of look-ahead buffer}
  </i></font>THRESHOLD <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>NODENIL   <font color="#000080">= </font>N<font color="#000080">;    </font><font color="#008000"><i>{End of tree's node}

{-Huffman coding parameters}
  </i></font>N_CHAR    <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">-</font>THRESHOLD<font color="#000080">+</font>F<font color="#000080">;
                            </font><font color="#008000"><i>{character code (= 0..N_CHAR-1)}
  </i></font>T         <font color="#000080">= </font>N_CHAR<font color="#000080">*</font><font color="#800000">2 </font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{Size of table}
  </i></font>R         <font color="#000080">= </font>T<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;          </font><font color="#008000"><i>{root position}
  </i></font>MAX_FREQ  <font color="#000080">= </font><font color="#800000">$8000</font><font color="#000080">; </font><font color="#008000"><i>{update when cumulative frequency reaches to this value}

{-Tables for encoding/decoding upper 6 bits of sliding dictionary pointer}
{-encoder table}
</i></font>p_len<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
       (</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,
        </font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">);

</font>p_code<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
       (</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$20</font><font color="#000080">,</font><font color="#800000">$30</font><font color="#000080">,</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$50</font><font color="#000080">,</font><font color="#800000">$58</font><font color="#000080">,</font><font color="#800000">$60</font><font color="#000080">,</font><font color="#800000">$68</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$78</font><font color="#000080">,</font><font color="#800000">$80</font><font color="#000080">,</font><font color="#800000">$88</font><font color="#000080">,</font><font color="#800000">$90</font><font color="#000080">,</font><font color="#800000">$94</font><font color="#000080">,</font><font color="#800000">$98</font><font color="#000080">,</font><font color="#800000">$9C</font><font color="#000080">,
        </font><font color="#800000">$A0</font><font color="#000080">,</font><font color="#800000">$A4</font><font color="#000080">,</font><font color="#800000">$A8</font><font color="#000080">,</font><font color="#800000">$AC</font><font color="#000080">,</font><font color="#800000">$B0</font><font color="#000080">,</font><font color="#800000">$B4</font><font color="#000080">,</font><font color="#800000">$B8</font><font color="#000080">,</font><font color="#800000">$BC</font><font color="#000080">,</font><font color="#800000">$C0</font><font color="#000080">,</font><font color="#800000">$C2</font><font color="#000080">,</font><font color="#800000">$C4</font><font color="#000080">,</font><font color="#800000">$C6</font><font color="#000080">,</font><font color="#800000">$C8</font><font color="#000080">,</font><font color="#800000">$CA</font><font color="#000080">,</font><font color="#800000">$CC</font><font color="#000080">,</font><font color="#800000">$CE</font><font color="#000080">,
        </font><font color="#800000">$D0</font><font color="#000080">,</font><font color="#800000">$D2</font><font color="#000080">,</font><font color="#800000">$D4</font><font color="#000080">,</font><font color="#800000">$D6</font><font color="#000080">,</font><font color="#800000">$D8</font><font color="#000080">,</font><font color="#800000">$DA</font><font color="#000080">,</font><font color="#800000">$DC</font><font color="#000080">,</font><font color="#800000">$DE</font><font color="#000080">,</font><font color="#800000">$E0</font><font color="#000080">,</font><font color="#800000">$E2</font><font color="#000080">,</font><font color="#800000">$E4</font><font color="#000080">,</font><font color="#800000">$E6</font><font color="#000080">,</font><font color="#800000">$E8</font><font color="#000080">,</font><font color="#800000">$EA</font><font color="#000080">,</font><font color="#800000">$EC</font><font color="#000080">,</font><font color="#800000">$EE</font><font color="#000080">,
        </font><font color="#800000">$F0</font><font color="#000080">,</font><font color="#800000">$F1</font><font color="#000080">,</font><font color="#800000">$F2</font><font color="#000080">,</font><font color="#800000">$F3</font><font color="#000080">,</font><font color="#800000">$F4</font><font color="#000080">,</font><font color="#800000">$F5</font><font color="#000080">,</font><font color="#800000">$F6</font><font color="#000080">,</font><font color="#800000">$F7</font><font color="#000080">,</font><font color="#800000">$F8</font><font color="#000080">,</font><font color="#800000">$F9</font><font color="#000080">,</font><font color="#800000">$FA</font><font color="#000080">,</font><font color="#800000">$FB</font><font color="#000080">,</font><font color="#800000">$FC</font><font color="#000080">,</font><font color="#800000">$FD</font><font color="#000080">,</font><font color="#800000">$FE</font><font color="#000080">,</font><font color="#800000">$FF</font><font color="#000080">);

</font><font color="#008000"><i>{-decoder table}
</i></font>d_code<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
       (</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,
        </font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,
        </font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,</font><font color="#800000">$01</font><font color="#000080">,
        </font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,</font><font color="#800000">$02</font><font color="#000080">,
        </font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,
        </font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,
        </font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,</font><font color="#800000">$09</font><font color="#000080">,
        </font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0A</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,</font><font color="#800000">$0B</font><font color="#000080">,
        </font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$0D</font><font color="#000080">,</font><font color="#800000">$0D</font><font color="#000080">,</font><font color="#800000">$0D</font><font color="#000080">,</font><font color="#800000">$0D</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,</font><font color="#800000">$0F</font><font color="#000080">,
        </font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">$11</font><font color="#000080">,</font><font color="#800000">$11</font><font color="#000080">,</font><font color="#800000">$11</font><font color="#000080">,</font><font color="#800000">$11</font><font color="#000080">,</font><font color="#800000">$12</font><font color="#000080">,</font><font color="#800000">$12</font><font color="#000080">,</font><font color="#800000">$12</font><font color="#000080">,</font><font color="#800000">$12</font><font color="#000080">,</font><font color="#800000">$13</font><font color="#000080">,</font><font color="#800000">$13</font><font color="#000080">,</font><font color="#800000">$13</font><font color="#000080">,</font><font color="#800000">$13</font><font color="#000080">,
        </font><font color="#800000">$14</font><font color="#000080">,</font><font color="#800000">$14</font><font color="#000080">,</font><font color="#800000">$14</font><font color="#000080">,</font><font color="#800000">$14</font><font color="#000080">,</font><font color="#800000">$15</font><font color="#000080">,</font><font color="#800000">$15</font><font color="#000080">,</font><font color="#800000">$15</font><font color="#000080">,</font><font color="#800000">$15</font><font color="#000080">,</font><font color="#800000">$16</font><font color="#000080">,</font><font color="#800000">$16</font><font color="#000080">,</font><font color="#800000">$16</font><font color="#000080">,</font><font color="#800000">$16</font><font color="#000080">,</font><font color="#800000">$17</font><font color="#000080">,</font><font color="#800000">$17</font><font color="#000080">,</font><font color="#800000">$17</font><font color="#000080">,</font><font color="#800000">$17</font><font color="#000080">,
        </font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$19</font><font color="#000080">,</font><font color="#800000">$19</font><font color="#000080">,</font><font color="#800000">$1A</font><font color="#000080">,</font><font color="#800000">$1A</font><font color="#000080">,</font><font color="#800000">$1B</font><font color="#000080">,</font><font color="#800000">$1B</font><font color="#000080">,</font><font color="#800000">$1C</font><font color="#000080">,</font><font color="#800000">$1C</font><font color="#000080">,</font><font color="#800000">$1D</font><font color="#000080">,</font><font color="#800000">$1D</font><font color="#000080">,</font><font color="#800000">$1E</font><font color="#000080">,</font><font color="#800000">$1E</font><font color="#000080">,</font><font color="#800000">$1F</font><font color="#000080">,</font><font color="#800000">$1F</font><font color="#000080">,
        </font><font color="#800000">$20</font><font color="#000080">,</font><font color="#800000">$20</font><font color="#000080">,</font><font color="#800000">$21</font><font color="#000080">,</font><font color="#800000">$21</font><font color="#000080">,</font><font color="#800000">$22</font><font color="#000080">,</font><font color="#800000">$22</font><font color="#000080">,</font><font color="#800000">$23</font><font color="#000080">,</font><font color="#800000">$23</font><font color="#000080">,</font><font color="#800000">$24</font><font color="#000080">,</font><font color="#800000">$24</font><font color="#000080">,</font><font color="#800000">$25</font><font color="#000080">,</font><font color="#800000">$25</font><font color="#000080">,</font><font color="#800000">$26</font><font color="#000080">,</font><font color="#800000">$26</font><font color="#000080">,</font><font color="#800000">$27</font><font color="#000080">,</font><font color="#800000">$27</font><font color="#000080">,
        </font><font color="#800000">$28</font><font color="#000080">,</font><font color="#800000">$28</font><font color="#000080">,</font><font color="#800000">$29</font><font color="#000080">,</font><font color="#800000">$29</font><font color="#000080">,</font><font color="#800000">$2A</font><font color="#000080">,</font><font color="#800000">$2A</font><font color="#000080">,</font><font color="#800000">$2B</font><font color="#000080">,</font><font color="#800000">$2B</font><font color="#000080">,</font><font color="#800000">$2C</font><font color="#000080">,</font><font color="#800000">$2C</font><font color="#000080">,</font><font color="#800000">$2D</font><font color="#000080">,</font><font color="#800000">$2D</font><font color="#000080">,</font><font color="#800000">$2E</font><font color="#000080">,</font><font color="#800000">$2E</font><font color="#000080">,</font><font color="#800000">$2F</font><font color="#000080">,</font><font color="#800000">$2F</font><font color="#000080">,
        </font><font color="#800000">$30</font><font color="#000080">,</font><font color="#800000">$31</font><font color="#000080">,</font><font color="#800000">$32</font><font color="#000080">,</font><font color="#800000">$33</font><font color="#000080">,</font><font color="#800000">$34</font><font color="#000080">,</font><font color="#800000">$35</font><font color="#000080">,</font><font color="#800000">$36</font><font color="#000080">,</font><font color="#800000">$37</font><font color="#000080">,</font><font color="#800000">$38</font><font color="#000080">,</font><font color="#800000">$39</font><font color="#000080">,</font><font color="#800000">$3A</font><font color="#000080">,</font><font color="#800000">$3B</font><font color="#000080">,</font><font color="#800000">$3C</font><font color="#000080">,</font><font color="#800000">$3D</font><font color="#000080">,</font><font color="#800000">$3E</font><font color="#000080">,</font><font color="#800000">$3F</font><font color="#000080">);

</font>d_len<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
       (</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,
        </font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,
        </font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,
        </font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,
        </font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,</font><font color="#800000">$04</font><font color="#000080">,
        </font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,
        </font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,
        </font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,
        </font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,</font><font color="#800000">$05</font><font color="#000080">,
        </font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,
        </font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,
        </font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,</font><font color="#800000">$06</font><font color="#000080">,
        </font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$07</font><font color="#000080">,
        </font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">);

  </font>getbuf<font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>getlen<font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>putbuf<font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>putlen<font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

  </font>textsize<font color="#000080">: </font>LongInt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>codesize<font color="#000080">: </font>LongInt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>printcount<font color="#000080">: </font>LongInt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>text_buf<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>N <font color="#000080">+ </font>F <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>match_position<font color="#000080">, </font>match_length<font color="#000080">: </font>word<font color="#000080">;
  </font>lson<font color="#000080">,</font>dad<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>N<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
  </font>rson<font color="#000080">:     </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>N <font color="#000080">+ </font><font color="#800000">256</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

  </font>freq<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>T<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">; </font><font color="#008000"><i>{cumulative freq table}

{-pointing parent nodes. area [T..(T + N_CHAR - 1)] are pointers for leaves}
  </i></font>prnt<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>T<font color="#000080">+</font>N_CHAR<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

</font><font color="#008000"><i>{-pointing children nodes (son[], son[] + 1)}
  </i></font>son<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>T<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>getc<font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>getc<font color="#000080">:= </font>inbuf<font color="#000080">^[</font>inptr<font color="#000080">];
    </font>Inc<font color="#000080">(</font>inptr<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>inptr<font color="#000080">=</font>inend <font color="#FF0000"><b>then </b></font>ReadToBuffer
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>putc <font color="#000080">(</font>c<font color="#000080">: </font>byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>outbuf<font color="#000080">^[</font>outptr<font color="#000080">]:= </font>c<font color="#000080">;
    </font>Inc<font color="#000080">(</font>outptr<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>outptr<font color="#000080">=</font>outend <font color="#FF0000"><b>then
      </b></font>WriteFromBuffer
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitTree<font color="#000080">;
</font><font color="#008000"><i>{-Initializing tree}
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:= </font>N<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N<font color="#000080">+</font><font color="#800000">256 </font><font color="#FF0000"><b>do </b></font>rson<font color="#000080">[</font>i<font color="#000080">] := </font>NODENIL<font color="#000080">; </font><font color="#008000"><i>{root}
  </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>N<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do     </b></font>dad<font color="#000080">[</font>i<font color="#000080">]  := </font>NODENIL<font color="#000080">; </font><font color="#008000"><i>{node}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InsertNode <font color="#000080">(</font>r<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{-Inserting node to the tree}
</i></font><font color="#FF0000"><b>Label
  </b></font>Done<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>p<font color="#000080">: </font>word<font color="#000080">;
  </font>geq<font color="#000080">: </font>boolean<font color="#000080">;
  </font>c<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>geq<font color="#000080">:= </font>true<font color="#000080">;
  </font>p<font color="#000080">:= </font>N<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>text_buf<font color="#000080">[</font>r<font color="#000080">];
  </font>rson<font color="#000080">[</font>r<font color="#000080">]:= </font>NODENIL<font color="#000080">;
  </font>lson<font color="#000080">[</font>r<font color="#000080">]:= </font>NODENIL<font color="#000080">;
  </font>match_length <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>TRUE <font color="#FF0000"><b>do begin
    if </b></font>geq <font color="#FF0000"><b>then
      if </b></font>rson<font color="#000080">[</font>p<font color="#000080">]=</font>NODENIL <font color="#FF0000"><b>then begin
        </b></font>rson<font color="#000080">[</font>p<font color="#000080">]:= </font>r<font color="#000080">;
        </font>dad<font color="#000080">[</font>r<font color="#000080">] := </font>p<font color="#000080">;
        </font>exit
      <font color="#FF0000"><b>end else
        </b></font>p<font color="#000080">:= </font>rson<font color="#000080">[</font>p<font color="#000080">]
    </font><font color="#FF0000"><b>else
      if </b></font>lson<font color="#000080">[</font>p<font color="#000080">]=</font>NODENIL <font color="#FF0000"><b>then begin
        </b></font>lson<font color="#000080">[</font>p<font color="#000080">]:= </font>r<font color="#000080">;
        </font>dad<font color="#000080">[</font>r<font color="#000080">] := </font>p<font color="#000080">;
        </font>exit
      <font color="#FF0000"><b>end else
        </b></font>p<font color="#000080">:= </font>lson<font color="#000080">[</font>p<font color="#000080">];
    </font>i<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>F<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>text_buf<font color="#000080">[</font>r<font color="#000080">+</font>i<font color="#000080">]=</font>text_buf<font color="#000080">[</font>p<font color="#000080">+</font>i<font color="#000080">]) </font><font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font>geq<font color="#000080">:= (</font>text_buf<font color="#000080">[</font>r<font color="#000080">+</font>i<font color="#000080">]&gt;=</font>text_buf<font color="#000080">[</font>p<font color="#000080">+</font>i<font color="#000080">]) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>i<font color="#000080">=</font>F<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&gt;</font>THRESHOLD <font color="#FF0000"><b>then begin
      if </b></font>i<font color="#000080">&gt;</font>match_length <font color="#FF0000"><b>then begin
        </b></font>match_position <font color="#000080">:= (</font>r<font color="#000080">-</font>p<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) -</font><font color="#800000">1</font><font color="#000080">;
        </font>match_length<font color="#000080">:= </font>i<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>match_length<font color="#000080">&gt;=</font>F <font color="#FF0000"><b>then goto </b></font>done<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font>match_length <font color="#FF0000"><b>then begin
        </b></font>c<font color="#000080">:= (</font>r<font color="#000080">-</font>p<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) -</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>c<font color="#000080">&lt;</font>match_position <font color="#FF0000"><b>then </b></font>match_position<font color="#000080">:= </font>c
      <font color="#FF0000"><b>end
    end
  end</b></font><font color="#000080">;
  </font>Done<font color="#000080">:
  </font>dad<font color="#000080">[</font>r<font color="#000080">]:= </font>dad<font color="#000080">[</font>p<font color="#000080">];
  </font>lson<font color="#000080">[</font>r<font color="#000080">]:= </font>lson<font color="#000080">[</font>p<font color="#000080">];
  </font>rson<font color="#000080">[</font>r<font color="#000080">]:= </font>rson<font color="#000080">[</font>p<font color="#000080">];
  </font>dad<font color="#000080">[</font>lson<font color="#000080">[</font>p<font color="#000080">]]:= </font>r<font color="#000080">;
  </font>dad<font color="#000080">[</font>rson<font color="#000080">[</font>p<font color="#000080">]]:= </font>r<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>rson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]=</font>p <font color="#FF0000"><b>then
    </b></font>rson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]:= </font>r
  <font color="#FF0000"><b>else
    </b></font>lson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]:= </font>r<font color="#000080">;
  </font>dad<font color="#000080">[</font>p<font color="#000080">]:= </font>NODENIL<font color="#000080">; </font><font color="#008000"><i>{remove p}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DeleteNode <font color="#000080">(</font>p<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{-Delete node from the tree}
</i></font><font color="#FF0000"><b>var
  </b></font>q<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>dad<font color="#000080">[</font>p<font color="#000080">] =</font>NODENIL <font color="#FF0000"><b>then </b></font>exit<font color="#000080">; </font><font color="#008000"><i>{unregistered}
  </i></font><font color="#FF0000"><b>if </b></font>rson<font color="#000080">[</font>p<font color="#000080">]=</font>NODENIL <font color="#FF0000"><b>then </b></font>q<font color="#000080">:= </font>lson<font color="#000080">[</font>p<font color="#000080">] </font><font color="#FF0000"><b>else
  if </b></font>lson<font color="#000080">[</font>p<font color="#000080">]=</font>NODENIL <font color="#FF0000"><b>then </b></font>q<font color="#000080">:= </font>rson<font color="#000080">[</font>p<font color="#000080">] </font><font color="#FF0000"><b>else begin
    </b></font>q<font color="#000080">:= </font>lson<font color="#000080">[</font>p<font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font>rson<font color="#000080">[</font>q<font color="#000080">]&lt;&gt;</font>NODENIL <font color="#FF0000"><b>then begin
      repeat
        </b></font>q<font color="#000080">:= </font>rson<font color="#000080">[</font>q<font color="#000080">];
      </font><font color="#FF0000"><b>until </b></font>rson<font color="#000080">[</font>q<font color="#000080">]=</font>NODENIL<font color="#000080">;
      </font>rson<font color="#000080">[</font>dad<font color="#000080">[</font>q<font color="#000080">]]:= </font>lson<font color="#000080">[</font>q<font color="#000080">];
      </font>dad<font color="#000080">[</font>lson<font color="#000080">[</font>q<font color="#000080">]]:= </font>dad<font color="#000080">[</font>q<font color="#000080">];
      </font>lson<font color="#000080">[</font>q<font color="#000080">]:= </font>lson<font color="#000080">[</font>p<font color="#000080">];
      </font>dad<font color="#000080">[</font>lson<font color="#000080">[</font>p<font color="#000080">]]:= </font>q<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rson<font color="#000080">[</font>q<font color="#000080">]:= </font>rson<font color="#000080">[</font>p<font color="#000080">];
    </font>dad<font color="#000080">[</font>rson<font color="#000080">[</font>p<font color="#000080">]]:= </font>q<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dad<font color="#000080">[</font>q<font color="#000080">]:= </font>dad<font color="#000080">[</font>p<font color="#000080">];
  </font><font color="#FF0000"><b>if </b></font>rson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]=</font>p <font color="#FF0000"><b>then
    </b></font>rson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]:= </font>q
  <font color="#FF0000"><b>else
    </b></font>lson<font color="#000080">[</font>dad<font color="#000080">[</font>p<font color="#000080">]]:= </font>q<font color="#000080">;
  </font>dad<font color="#000080">[</font>p<font color="#000080">]:= </font>NODENIL<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetBit<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#008000"><i>{-get one bit}
</i></font><font color="#FF0000"><b>begin
  while </b></font>getlen<font color="#000080">&lt;=</font><font color="#800000">8 </font><font color="#FF0000"><b>do begin
    </b></font>getbuf<font color="#000080">:= </font>getbuf <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>WORD<font color="#000080">(</font>getc<font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#000080">(</font><font color="#800000">8</font><font color="#000080">-</font>getlen<font color="#000080">));
    </font>Inc<font color="#000080">(</font>getlen<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetBit<font color="#000080">:= </font>getbuf <font color="#FF0000"><b>SHR </b></font><font color="#800000">15</font><font color="#000080">;
  </font><font color="#008000"><i>{if (getbuf AND $8000)&gt;0 then GetBit:= 1 else GetBit:= 0;}
  </i></font>getbuf<font color="#000080">:= </font>getbuf <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;
  </font>Dec<font color="#000080">(</font>getlen<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GetByte<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{-get a byte}
</i></font><font color="#FF0000"><b>begin
  while </b></font>getlen<font color="#000080">&lt;=</font><font color="#800000">8 </font><font color="#FF0000"><b>do begin
    </b></font>getbuf<font color="#000080">:= </font>getbuf <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>WORD<font color="#000080">(</font>getc<font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#000080">(</font><font color="#800000">8 </font><font color="#000080">- </font>getlen<font color="#000080">));
    </font>Inc<font color="#000080">(</font>getlen<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetByte<font color="#000080">:= </font>Hi<font color="#000080">(</font>getbuf<font color="#000080">);
  </font>getbuf<font color="#000080">:= </font>getbuf <font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
  </font>Dec<font color="#000080">(</font>getlen<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Putcode <font color="#000080">(</font>l<font color="#000080">: </font>byte<font color="#000080">; </font>c<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{-output l bits}
</i></font><font color="#FF0000"><b>begin
  </b></font>putbuf<font color="#000080">:= </font>putbuf <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>c <font color="#FF0000"><b>SHR </b></font>putlen<font color="#000080">);
  </font>Inc<font color="#000080">(</font>putlen<font color="#000080">,</font>l<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>putlen<font color="#000080">&gt;=</font><font color="#800000">8 </font><font color="#FF0000"><b>then begin
    </b></font>putc<font color="#000080">(</font>Hi<font color="#000080">(</font>putbuf<font color="#000080">));
    </font>Dec<font color="#000080">(</font>putlen<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>putlen<font color="#000080">&gt;=</font><font color="#800000">8 </font><font color="#FF0000"><b>then begin
      </b></font>putc<font color="#000080">(</font>Lo<font color="#000080">(</font>putbuf<font color="#000080">));
      </font>Inc<font color="#000080">(</font>codesize<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>Dec<font color="#000080">(</font>putlen<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
      </font>putbuf<font color="#000080">:= </font>c <font color="#FF0000"><b>SHL </b></font><font color="#000080">(</font>l<font color="#000080">-</font>putlen<font color="#000080">);
    </font><font color="#FF0000"><b>end else begin
      </b></font>putbuf<font color="#000080">:= </font>Swap<font color="#000080">(</font>putbuf <font color="#FF0000"><b>AND </b></font><font color="#800000">$FF</font><font color="#000080">); </font><font color="#008000"><i>{SHL 8;}
      </i></font>Inc<font color="#000080">(</font>codesize<font color="#000080">);
    </font><font color="#FF0000"><b>end
  end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>StartHuff<font color="#000080">;
</font><font color="#008000"><i>{-initialize freq tree}
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>N_CHAR<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
    </b></font>freq<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">1</font><font color="#000080">;
    </font>son<font color="#000080">[</font>i<font color="#000080">] := </font>i<font color="#000080">+</font>T<font color="#000080">;
    </font>prnt<font color="#000080">[</font>i<font color="#000080">+</font>T<font color="#000080">]:= </font>i
  <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>i<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>j<font color="#000080">:= </font>N_CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>j<font color="#000080">&lt;=</font>R <font color="#FF0000"><b>do begin
    </b></font>freq<font color="#000080">[</font>j<font color="#000080">]:= </font>freq<font color="#000080">[</font>i<font color="#000080">]+</font>freq<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
    </font>son<font color="#000080">[</font>j<font color="#000080">] := </font>i<font color="#000080">;
    </font>prnt<font color="#000080">[</font>i<font color="#000080">]:= </font>j<font color="#000080">;
    </font>prnt<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:= </font>j<font color="#000080">;
    </font>Inc<font color="#000080">(</font>i<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>Inc<font color="#000080">(</font>j<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>freq<font color="#000080">[</font>T<font color="#000080">]:= </font><font color="#800000">$FFFF</font><font color="#000080">;
  </font>prnt<font color="#000080">[</font>R<font color="#000080">]:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>reconst<font color="#000080">;
</font><font color="#008000"><i>{-reconstruct freq tree }
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>f<font color="#000080">,</font>l<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{-halven cumulative freq for leaf nodes}
  </i></font>j<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>T<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font>son<font color="#000080">[</font>i<font color="#000080">]&gt;=</font>T <font color="#FF0000"><b>then begin
      </b></font>freq<font color="#000080">[</font>j<font color="#000080">]:= (</font>freq<font color="#000080">[</font>i<font color="#000080">]+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;
      </font>son<font color="#000080">[</font>j<font color="#000080">] := </font>son<font color="#000080">[</font>i<font color="#000080">];
      </font>Inc<font color="#000080">(</font>j<font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-make a tree : first, connect children nodes}
  </i></font>i<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>j<font color="#000080">:= </font>N_CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>j<font color="#000080">&lt;</font>T <font color="#FF0000"><b>do begin
    </b></font>k<font color="#000080">:= </font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>f<font color="#000080">:= </font>freq<font color="#000080">[</font>i<font color="#000080">]+</font>freq<font color="#000080">[</font>k<font color="#000080">];
    </font>freq<font color="#000080">[</font>j<font color="#000080">]:= </font>f<font color="#000080">;
    </font>k<font color="#000080">:= </font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>f<font color="#000080">&lt;</font>freq<font color="#000080">[</font>k<font color="#000080">] </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>k<font color="#000080">);
    </font>Inc<font color="#000080">(</font>k<font color="#000080">);
    </font>l<font color="#000080">:= (</font>j<font color="#000080">-</font>k<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">;

    </font>move<font color="#000080">(</font>freq<font color="#000080">[</font>k<font color="#000080">],</font>freq<font color="#000080">[</font>k<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>l<font color="#000080">);
    </font>freq<font color="#000080">[</font>k<font color="#000080">]:= </font>f<font color="#000080">;
    </font>move<font color="#000080">(</font>son<font color="#000080">[</font>k<font color="#000080">],</font>son<font color="#000080">[</font>k<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>l<font color="#000080">);
    </font>son<font color="#000080">[</font>k<font color="#000080">]:= </font>i<font color="#000080">;
    </font>Inc<font color="#000080">(</font>i<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font>Inc<font color="#000080">(</font>j<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-connect parent nodes}
  </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>T<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
    </b></font>k<font color="#000080">:= </font>son<font color="#000080">[</font>i<font color="#000080">];
    </font>prnt<font color="#000080">[</font>k<font color="#000080">]:= </font>i<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>k<font color="#000080">&lt;</font>T <font color="#FF0000"><b>then
      </b></font>prnt<font color="#000080">[</font>k<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:= </font>i
  <font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>update<font color="#000080">(</font>c<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#008000"><i>{-update freq tree}
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>l<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>freq<font color="#000080">[</font>R<font color="#000080">]=</font>MAX_FREQ <font color="#FF0000"><b>then </b></font>reconst<font color="#000080">;
  </font>c<font color="#000080">:= </font>prnt<font color="#000080">[</font>c<font color="#000080">+</font>T<font color="#000080">];
  </font><font color="#FF0000"><b>repeat
    </b></font>Inc<font color="#000080">(</font>freq<font color="#000080">[</font>c<font color="#000080">]);
    </font>k<font color="#000080">:= </font>freq<font color="#000080">[</font>c<font color="#000080">];
    </font><font color="#008000"><i>{-swap nodes to keep the tree freq-ordered}
    </i></font>l<font color="#000080">:= </font>c<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>k<font color="#000080">&gt;</font>freq<font color="#000080">[</font>l<font color="#000080">] </font><font color="#FF0000"><b>then begin
      while </b></font>k<font color="#000080">&gt;</font>freq<font color="#000080">[</font>l<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>l<font color="#000080">);
      </font>freq<font color="#000080">[</font>c<font color="#000080">]:= </font>freq<font color="#000080">[</font>l<font color="#000080">];
      </font>freq<font color="#000080">[</font>l<font color="#000080">]:= </font>k<font color="#000080">;

      </font>i<font color="#000080">:= </font>son<font color="#000080">[</font>c<font color="#000080">];
      </font>prnt<font color="#000080">[</font>i<font color="#000080">]:= </font>l<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&lt;</font>T <font color="#FF0000"><b>then </b></font>prnt<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:= </font>l<font color="#000080">;

      </font>j<font color="#000080">:= </font>son<font color="#000080">[</font>l<font color="#000080">];
      </font>son<font color="#000080">[</font>l<font color="#000080">]:= </font>i<font color="#000080">;

      </font>prnt<font color="#000080">[</font>j<font color="#000080">]:= </font>c<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>j<font color="#000080">&lt;</font>T  <font color="#FF0000"><b>then </b></font>prnt<font color="#000080">[</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:= </font>c<font color="#000080">;
      </font>son<font color="#000080">[</font>c<font color="#000080">]:= </font>j<font color="#000080">;

      </font>c <font color="#000080">:= </font>l<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>c<font color="#000080">:= </font>prnt<font color="#000080">[</font>c<font color="#000080">]
  </font><font color="#FF0000"><b>until </b></font>c<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{do it until reaching the root}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>EncodeChar <font color="#000080">(</font>c<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>code<font color="#000080">,</font>len<font color="#000080">,</font>k<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>code<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>len<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>k<font color="#000080">:= </font>prnt<font color="#000080">[</font>c<font color="#000080">+</font>T<font color="#000080">];

  </font><font color="#008000"><i>{-search connections from leaf node to the root}
  </i></font><font color="#FF0000"><b>repeat
    </b></font>code<font color="#000080">:= </font>code <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#008000"><i>{-if node's address is odd, output 1 else output 0}
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>k <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>code<font color="#000080">,</font><font color="#800000">$8000</font><font color="#000080">);
    </font>Inc<font color="#000080">(</font>len<font color="#000080">);
    </font>k<font color="#000080">:= </font>prnt<font color="#000080">[</font>k<font color="#000080">];
  </font><font color="#FF0000"><b>until </b></font>k<font color="#000080">=</font>R<font color="#000080">;
  </font>Putcode<font color="#000080">(</font>len<font color="#000080">,</font>code<font color="#000080">);
  </font>update<font color="#000080">(</font>c<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>EncodePosition<font color="#000080">(</font>c<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{-output upper 6 bits with encoding}
  </i></font>i<font color="#000080">:= </font>c <font color="#FF0000"><b>SHR </b></font><font color="#800000">6</font><font color="#000080">;
  </font>Putcode<font color="#000080">(</font>p_len<font color="#000080">[</font>i<font color="#000080">], </font>WORD<font color="#000080">(</font>p_code<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">);
  </font><font color="#008000"><i>{-output lower 6 bits directly}
  </i></font>Putcode<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">, (</font>c <font color="#FF0000"><b>AND </b></font><font color="#800000">$3F</font><font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">10</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>EncodeEnd<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>putlen<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>putc<font color="#000080">(</font>Hi<font color="#000080">(</font>putbuf<font color="#000080">));
    </font>Inc<font color="#000080">(</font>codesize<font color="#000080">)
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DecodeChar<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>c<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>c<font color="#000080">:= </font>son<font color="#000080">[</font>R<font color="#000080">];
  </font><font color="#008000"><i>{-start searching tree from the root to leaves.
    choose node #(son[]) if input bit = 0
    else choose #(son[]+1) (input bit = 1)}
  </i></font><font color="#FF0000"><b>while </b></font>c<font color="#000080">&lt;</font>T <font color="#FF0000"><b>do </b></font>c<font color="#000080">:= </font>son<font color="#000080">[</font>c<font color="#000080">+</font>GetBit<font color="#000080">];
  </font>Dec<font color="#000080">(</font>c<font color="#000080">,</font>T<font color="#000080">);
  </font>update<font color="#000080">(</font>c<font color="#000080">);
  </font>DecodeChar<font color="#000080">:= </font>c
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DecodePosition<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>c<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{-decode upper 6 bits from given table}
  </i></font>i<font color="#000080">:= </font>GetByte<font color="#000080">;
  </font>c<font color="#000080">:= </font>WORD<font color="#000080">(</font>d_code<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">6</font><font color="#000080">;
  </font>j<font color="#000080">:= </font>d_len<font color="#000080">[</font>i<font color="#000080">];
  </font><font color="#008000"><i>{-input lower 6 bits directly}
  </i></font>Dec<font color="#000080">(</font>j<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>j<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
    </b></font>Dec<font color="#000080">(</font>j<font color="#000080">);
    </font>i<font color="#000080">:= (</font>i <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>GetBit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>DecodePosition<font color="#000080">:= </font>c <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>i <font color="#FF0000"><b>AND </b></font><font color="#800000">$3F</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-Compression }
</i></font><font color="#FF0000"><b>procedure </b></font>Encode <font color="#000080">(</font>bytes<font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#008000"><i>{-Encoding/Compressing}
</i></font><font color="#FF0000"><b>type
  </b></font>ByteRec <font color="#000080">= </font><font color="#FF0000"><b>record
              </b></font>b0<font color="#000080">,</font>b1<font color="#000080">,</font>b2<font color="#000080">,</font>b3<font color="#000080">: </font>byte
            <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>c<font color="#000080">,</font>len<font color="#000080">,</font>r<font color="#000080">,</font>s<font color="#000080">,</font>last_match_length<font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{-write size of original text}
  </i></font><font color="#FF0000"><b>with </b></font>ByteRec<font color="#000080">(</font>Bytes<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>putc<font color="#000080">(</font>b0<font color="#000080">);
    </font>putc<font color="#000080">(</font>b1<font color="#000080">);
    </font>putc<font color="#000080">(</font>b2<font color="#000080">);
    </font>putc<font color="#000080">(</font>b3<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>bytes<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>textsize<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StartHuff<font color="#000080">;
  </font>InitTree<font color="#000080">;
  </font>s<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>r<font color="#000080">:= </font>N<font color="#000080">-</font>F<font color="#000080">;
  </font>fillchar<font color="#000080">(</font>text_buf<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>r<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font>len<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>len<font color="#000080">&lt;</font>F<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>inptr <font color="#FF0000"><b>OR </b></font>inend<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>text_buf<font color="#000080">[</font>r<font color="#000080">+</font>len<font color="#000080">]:= </font>getc<font color="#000080">;
    </font>Inc<font color="#000080">(</font>len<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>textsize <font color="#000080">:= </font>len<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>F <font color="#FF0000"><b>do </b></font>InsertNode<font color="#000080">(</font>r <font color="#000080">- </font>i<font color="#000080">);
  </font>InsertNode<font color="#000080">(</font>r<font color="#000080">);
  </font><font color="#FF0000"><b>repeat
    if </b></font>match_length<font color="#000080">&gt;</font>len <font color="#FF0000"><b>then </b></font>match_length<font color="#000080">:= </font>len<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>match_length<font color="#000080">&lt;=</font>THRESHOLD <font color="#FF0000"><b>then begin
      </b></font>match_length <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>EncodeChar<font color="#000080">(</font>text_buf<font color="#000080">[</font>r<font color="#000080">])
    </font><font color="#FF0000"><b>end else begin
      </b></font>EncodeChar<font color="#000080">(</font><font color="#800000">255 </font><font color="#000080">- </font>THRESHOLD <font color="#000080">+ </font>match_length<font color="#000080">);
      </font>EncodePosition<font color="#000080">(</font>match_position<font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>last_match_length <font color="#000080">:= </font>match_length<font color="#000080">;
    </font>i<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>last_match_length<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>inptr <font color="#FF0000"><b>OR </b></font>inend<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
      </font>DeleteNode<font color="#000080">(</font>s<font color="#000080">);
      </font>c<font color="#000080">:= </font>getc<font color="#000080">;
      </font>text_buf<font color="#000080">[</font>s<font color="#000080">]:= </font>c<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">&lt;</font>F<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>text_buf<font color="#000080">[</font>s<font color="#000080">+</font>N<font color="#000080">]:= </font>c<font color="#000080">;
      </font>s<font color="#000080">:= (</font>s<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>r<font color="#000080">:= (</font>r<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>InsertNode<font color="#000080">(</font>r<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>textsize<font color="#000080">,</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>textsize<font color="#000080">&gt;</font>printcount <font color="#FF0000"><b>then begin
      </b></font>write<font color="#000080">(</font>textsize<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>printcount<font color="#000080">,</font><font color="#800000">1024</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>i<font color="#000080">&lt;</font>last_match_length <font color="#FF0000"><b>do begin
      </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
      </font>DeleteNode<font color="#000080">(</font>s<font color="#000080">);
      </font>s <font color="#000080">:= (</font>s<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>r <font color="#000080">:= (</font>r<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>Dec<font color="#000080">(</font>len<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>len<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>InsertNode<font color="#000080">(</font>r<font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>len<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
  </font>EncodeEnd<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'input:  '</font><font color="#000080">,</font>textsize<font color="#000080">,</font><font color="#800000">' bytes'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'output: '</font><font color="#000080">,</font>codesize<font color="#000080">,</font><font color="#800000">' bytes'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'compression: '</font><font color="#000080">,</font>textsize<font color="#000080">*</font><font color="#800000">100 </font><font color="#FF0000"><b>DIV </b></font>codesize<font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Decode<font color="#000080">;
</font><font color="#008000"><i>{-Decoding/Uncompressing}
</i></font><font color="#FF0000"><b>type
  </b></font>ByteRec <font color="#000080">= </font><font color="#FF0000"><b>Record
              </b></font>b0<font color="#000080">,</font>b1<font color="#000080">,</font>b2<font color="#000080">,</font>b3<font color="#000080">: </font>byte
            <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>r<font color="#000080">,</font>c<font color="#000080">: </font>word<font color="#000080">;
  </font>count<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{-read size of original text}
  </i></font><font color="#FF0000"><b>with </b></font>ByteRec<font color="#000080">(</font>textsize<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>b0<font color="#000080">:= </font>getc<font color="#000080">;
    </font>b1<font color="#000080">:= </font>getc<font color="#000080">;
    </font>b2<font color="#000080">:= </font>getc<font color="#000080">;
    </font>b3<font color="#000080">:= </font>getc
  <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>textsize<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font>StartHuff<font color="#000080">;
  </font>fillchar<font color="#000080">(</font>text_buf<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>N<font color="#000080">-</font>F<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font>r<font color="#000080">:= </font>N<font color="#000080">-</font>F<font color="#000080">;
  </font>count<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>count<font color="#000080">&lt;</font>textsize <font color="#FF0000"><b>do begin
    </b></font>c<font color="#000080">:= </font>DecodeChar<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>c<font color="#000080">&lt;</font><font color="#800000">256 </font><font color="#FF0000"><b>then begin
      </b></font>putc<font color="#000080">(</font>c<font color="#000080">);
      </font>text_buf<font color="#000080">[</font>r<font color="#000080">]:= </font>c<font color="#000080">;
      </font>r<font color="#000080">:= (</font>r<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>count<font color="#000080">)
    </font><font color="#FF0000"><b>end else begin
      </b></font>i<font color="#000080">:= (</font>r<font color="#000080">-</font>DecodePosition<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>j<font color="#000080">:= </font>c<font color="#000080">-</font><font color="#800000">255</font><font color="#000080">+</font>THRESHOLD<font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>j<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
        </b></font>c<font color="#000080">:= </font>text_buf<font color="#000080">[(</font>i<font color="#000080">+</font>k<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)];
        </font>putc<font color="#000080">(</font>c<font color="#000080">);
        </font>text_buf<font color="#000080">[</font>r<font color="#000080">]:= </font>c<font color="#000080">;
        </font>r<font color="#000080">:= (</font>r<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>N<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
        </font>Inc<font color="#000080">(</font>count<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>count<font color="#000080">&gt;</font>printcount <font color="#FF0000"><b>then begin
      </b></font>write<font color="#000080">(</font>count<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>printcount<font color="#000080">,</font><font color="#800000">1024</font><font color="#000080">)
    </font><font color="#FF0000"><b>end
  end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">(</font>count<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DATATYPE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
