<html>
<head><title> "Data Entry Routines" by PETER NEUENDORFFER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Well, this code outlines your problem and it's solution. I assume
you have a single string input procedure. However, why don't you just
position several strings on the screen? The techinique I've outlined
is legit, but a little cumbersome:
(in two messages}
{Regarding your request for a form input technique, I do not know
of a library that handles this, although there probably is one.
Such an object (in the loose sense of the word) could be written in
Turbo Pascal, given a string input handler that you have the source
to so you could modify the exit keys.
   Imagine a procedure getstring that sets single string input that
returns the string when Enter or Tab is pressed, sets a list to &quot;commit&quot;
when enter is pressed as well, and sets a list to &quot;cancel&quot; when escape
is
pressed. Now you can set up a global record structure and skeleton
for form input like so}
</i></font><font color="#FF0000"><b>program </b></font>formit<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
       </font><font color="#FF0000"><b>type
       </b></font>single_string<font color="#000080">=</font><font color="#FF0000"><b>record
           </b></font>startx<font color="#000080">,</font>starty<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{start coordinates of each caption}
           </i></font>caption<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#008000"><i>{the caption for the string}
           </i></font>str<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#008000"><i>{the single string you are getting}
           </i></font>max_permitted<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{maximum length of field}
           </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#008000"><i>{an array storing the strings in the forms and their place
       on the screen}
       </i></font>form_array_type<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">30</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single_string<font color="#000080">;

       </font><font color="#008000"><i>{exit status for each string entered}
       </i></font>exitlist<font color="#000080">=(</font>nocode<font color="#000080">,</font>tabstop<font color="#000080">,</font>cancel<font color="#000080">,</font>commit<font color="#000080">);

       </font><font color="#FF0000"><b>var
       </b></font>form_array<font color="#000080">:</font>form_array_type<font color="#000080">; </font><font color="#008000"><i>{our form with it's strings}
       </i></font>no_strings_in_form<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{how many active strings in form}
       </i></font>exitcode<font color="#000080">:</font>exitlist<font color="#000080">;
       </font>x<font color="#000080">:</font>byte<font color="#000080">;
            </font><font color="#FF0000"><b>Procedure </b></font>getstring<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>input_string<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>max_permitted<font color="#000080">:
            </font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>exitcode<font color="#000080">:
                                   </font>exitlist<font color="#000080">);
                </font><font color="#FF0000"><b>Begin
                </b></font><font color="#008000"><i>{single string input procedure}
                {doen't care about the form structure}

                </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#008000"><i>{SUB PROCEDURE SHOW_FORM}
         </i></font><font color="#FF0000"><b>procedure </b></font>show_form<font color="#000080">(</font>form_array<font color="#000080">:</font>form_array_type<font color="#000080">;
              </font>no_strings_in_form<font color="#000080">:</font>byte<font color="#000080">);
            </font><font color="#FF0000"><b>var
            </b></font>x<font color="#000080">:</font>byte<font color="#000080">;
            </font><font color="#FF0000"><b>begin
            for </b></font>x<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>no_strings_in_form <font color="#FF0000"><b>do
                begin
                </b></font>gotoxy<font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>startx<font color="#000080">,</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>starty<font color="#000080">);
                </font>write<font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>caption<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#008000"><i>{SUB PROCEDURE GET_FORM}

            </i></font><font color="#FF0000"><b>Procedure </b></font>Get_form<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>form_array<font color="#000080">:</font>form_array_type<font color="#000080">;
                  </font>no_items<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>exitcode<font color="#000080">:</font>exitlist<font color="#000080">);
               </font><font color="#FF0000"><b>var
                 </b></font>form_array_index<font color="#000080">:</font>byte<font color="#000080">;
                 </font>current_string<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                 </font>max_permitted<font color="#000080">:</font>byte<font color="#000080">;
                 </font><font color="#008000"><i>{SUB} </i></font><font color="#FF0000"><b>procedure </b></font>get_first_tab<font color="#000080">; </font><font color="#008000"><i>{find top left string}
                      {THESE SCAN PROCEDURES MAY SEEM A LITTLE OBSCURE,
                      THEY ARE DESIGNED TO FIND THE NEXT STRING
                      AND NEED TO BE DEBUGGED}
                      </i></font><font color="#FF0000"><b>var
                      </b></font>x<font color="#000080">:</font>byte<font color="#000080">;
                      </font>lastx<font color="#000080">,</font>lasty<font color="#000080">:</font>byte<font color="#000080">;
                      </font><font color="#FF0000"><b>begin
                      </b></font>form_array_index<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                      </font>lastx<font color="#000080">:=</font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>startx<font color="#000080">;
                      </font>lasty<font color="#000080">:=</font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>starty<font color="#000080">;
                      </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>no_items <font color="#FF0000"><b>do
                          if </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>starty<font color="#000080">&lt;=</font>lasty<font color="#000080">) </font><font color="#FF0000"><b>and
                             </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>startx<font color="#000080">&lt;=</font>lastx<font color="#000080">) </font><font color="#FF0000"><b>then
                             begin
                             </b></font>lasty<font color="#000080">:=</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>starty<font color="#000080">;
                             </font>lastx<font color="#000080">:=</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>startx<font color="#000080">;
                             </font>form_array_index<font color="#000080">:=</font>x<font color="#000080">;
                             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#008000"><i>{SUB}  </i></font><font color="#FF0000"><b>procedure </b></font>get_next_tab<font color="#000080">;
                      </font><font color="#FF0000"><b>var
                      </b></font>found<font color="#000080">:</font>boolean<font color="#000080">;
                      </font>x<font color="#000080">,</font>lastx<font color="#000080">,</font>lasty<font color="#000080">:</font>byte<font color="#000080">;
                      </font>last_form_array_index<font color="#000080">:</font>byte<font color="#000080">;
                      </font><font color="#FF0000"><b>begin
                      </b></font>found<font color="#000080">:=</font>false<font color="#000080">;
                      </font>last_form_array_index<font color="#000080">:=</font>form_array_index<font color="#000080">;
                      </font>lastx<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
                      </font>lasty<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">; </font><font color="#008000"><i>{force values}
                      </i></font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>no_items <font color="#FF0000"><b>do
                          if
                          </b></font><font color="#000080">(</font>x<font color="#000080">&lt;&gt;</font>last_form_array_index<font color="#000080">) </font><font color="#FF0000"><b>and
                          </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>starty<font color="#000080">&lt;=</font>lasty<font color="#000080">)
                          </font><font color="#FF0000"><b>and
                          </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>startx<font color="#000080">&lt;=</font>lastx<font color="#000080">)
                          </font><font color="#FF0000"><b>and
                          </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>starty<font color="#000080">&gt;=
                            </font>form_array<font color="#000080">[</font>last_form_array_index<font color="#000080">].</font>starty<font color="#000080">)
                            </font><font color="#FF0000"><b>and
                          </b></font><font color="#000080">(</font>form_array<font color="#000080">[</font>x<font color="#000080">].</font>startx<font color="#000080">&gt;=
                            </font>form_array<font color="#000080">[</font>last_form_array_index<font color="#000080">].</font>startx<font color="#000080">)
                             </font><font color="#FF0000"><b>then
                                begin
                                  </b></font>form_array_index<font color="#000080">:=</font>x<font color="#000080">;
                                  </font>lasty<font color="#000080">:=</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">]
                                  .</font>starty<font color="#000080">;
                                  </font>lastx<font color="#000080">:=</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].
                                  </font>startx<font color="#000080">;
                                  </font>found<font color="#000080">:=</font>true<font color="#000080">;
                                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>if not </b></font>found <font color="#FF0000"><b>then
                         </b></font>get_first_tab<font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>Begin
               </b></font><font color="#008000"><i>{1. ? find the top left by
                    scanning the startx, starty of form_array}
               </i></font>get_first_tab<font color="#000080">;
               </font><font color="#FF0000"><b>REPEAT

                 </b></font><font color="#008000"><i>{2. Now write the string and get the new string}
                 </i></font>gotoxy<font color="#000080">(</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>startx<font color="#000080">,
                        </font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>starty<font color="#000080">);
                 </font>write<font color="#000080">(</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>caption<font color="#000080">,
                       </font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>str<font color="#000080">);
                 </font>gotoxy<font color="#000080">(</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>startx<font color="#000080">+
                 </font>length<font color="#000080">(</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>caption<font color="#000080">),
                        </font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>starty<font color="#000080">);

                 </font>current_string<font color="#000080">:=</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>str<font color="#000080">;
                 </font>max_permitted<font color="#000080">:=</font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].
                      </font>max_permitted<font color="#000080">;
                 </font>exitcode<font color="#000080">:=</font>nocode<font color="#000080">;
                 </font><font color="#008000"><i>{3. } </i></font>Getstring<font color="#000080">(</font>current_string<font color="#000080">,</font>max_permitted<font color="#000080">,</font>exitcode<font color="#000080">);

                 </font>form_array<font color="#000080">[</font>form_array_index<font color="#000080">].</font>str<font color="#000080">:=</font>current_string<font color="#000080">;

                 </font><font color="#008000"><i>{4. ? find the next placed
                      string to tab to by scanning the startx,
                      starty of form array}
                 </i></font><font color="#FF0000"><b>if </b></font>exitcode <font color="#000080">= </font>tabstop <font color="#FF0000"><b>then
                      begin
                      </b></font><font color="#008000"><i>{? depends on x/y order in array}</i></font><font color="#000080">;
                      </font>get_next_tab<font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                </font><font color="#FF0000"><b>UNTIL </b></font>exitcode <font color="#FF0000"><b>in </b></font><font color="#000080">[</font>cancel<font color="#000080">,</font>commit<font color="#000080">];
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{get_form}

       </i></font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{Calling procedure}
       {initialize array only has to be done once for the form
       within scope}
       </i></font>no_strings_in_form<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>startx<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>starty<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>caption<font color="#000080">:=</font><font color="#800000">'Name '</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>str<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>max_permitted<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>startx<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>starty<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>caption<font color="#000080">:=</font><font color="#800000">'Address '</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>str<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
       </font>form_array<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">].</font>max_permitted<font color="#000080">:=</font><font color="#800000">60</font><font color="#000080">;
       </font><font color="#008000"><i>{ETCETERA}
       {care must be taken not to overlap captions and strings}

       {the array is passed to the form input handler}
       </i></font>clrscr<font color="#000080">;
       </font>show_form<font color="#000080">(</font>form_array<font color="#000080">,</font>no_strings_in_form<font color="#000080">);
       </font>Get_form<font color="#000080">(</font>form_array<font color="#000080">,</font>no_strings_in_form<font color="#000080">,</font>exitcode<font color="#000080">);

       </font><font color="#008000"><i>{the new values of the strings are returned in
       the array form_array, in each .str field}
       </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
