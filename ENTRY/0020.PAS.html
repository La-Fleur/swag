<html>
<head><title> "Re: Entering Characters" by MICHAEL NICOLAI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 SJ&gt;     What is the best way to enter extended characters using readln?  I
 SJ&gt; would really like to assign Ctrl-E to ASCII 130.  I tried using ansi
 SJ&gt; and I could get it to work in dos but Pascal seems to override it.
 SJ&gt; Basically what I am tying to do is make it easy for the user to enter
 SJ&gt; foreign letters into a string.  Any suggestions would be appreciated.
 SJ&gt;                                             Stuart Johnston

To achieve this, you have to prog your own ReadLine-procedure, using
the READKEY and KEYPRESSED functions of TP.
You can't get READLN() to do the job for you. You have to do it your
own. :-)

Here is an example of what an Input-Line routine could look like:
It's only a small one. I also have a much more comfortable one, but it
isn't finished yet. :-)))

----------------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>uses </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>InputLine<font color="#000080">(</font>column<font color="#000080">, </font>line<font color="#000080">, </font>width<font color="#000080">, </font>color <font color="#000080">: </font>byte<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>{
 Function to read one line of input from the keyboard.
}

</i></font><font color="#FF0000"><b>var

 </b></font>i     <font color="#000080">: </font>byte<font color="#000080">;
 </font>key   <font color="#000080">: </font>char<font color="#000080">;
 </font>coln  <font color="#000080">: </font>byte<font color="#000080">;    </font><font color="#008000"><i>{ column of cursor position }
 </i></font>entry <font color="#000080">: </font>byte<font color="#000080">;    </font><font color="#008000"><i>{ pointer into inputstring }
 </i></font>str   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;  </font><font color="#008000"><i>{ input string }

</i></font><font color="#FF0000"><b>begin
 </b></font>textattr <font color="#000080">:= </font>color<font color="#000080">;    </font><font color="#008000"><i>{ set color of whole line }
 </i></font>gotoxy<font color="#000080">(</font>column<font color="#000080">, </font>line<font color="#000080">);
 </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>column <font color="#FF0000"><b>to </b></font><font color="#000080">(</font>column <font color="#000080">+ </font>width <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
  </b></font>write<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">);
 </font>coln <font color="#000080">:= </font>column<font color="#000080">;
 </font>entry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#0</font><font color="#000080">;  </font><font color="#008000"><i>{ empty string }
 </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>do
 begin
  </b></font>gotoxy<font color="#000080">(</font>coln<font color="#000080">, </font>line<font color="#000080">);
  </font>key <font color="#000080">:= </font>readkey<font color="#000080">;
  </font><font color="#FF0000"><b>case </b></font>key <font color="#FF0000"><b>of
   </b></font><font color="#800000">#0 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ Trace Function-keys }
         </i></font>key <font color="#000080">:= </font>readkey<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">#8 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ BACKSPACE-key }
         </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>entry <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
         begin
          </b></font>coln <font color="#000080">:= </font>coln <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
          </font>gotoxy<font color="#000080">(</font>coln<font color="#000080">, </font>line<font color="#000080">);
          </font>write<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">);
          </font>entry <font color="#000080">:= </font>entry <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">#12 </font><font color="#000080">: </font><font color="#FF0000"><b>begin        </b></font><font color="#008000"><i>{ Ctrl-L : delete entire line }
          </i></font>gotoxy<font color="#000080">(</font>column<font color="#000080">, </font>line<font color="#000080">);
          </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>column <font color="#FF0000"><b>to </b></font><font color="#000080">(</font>column <font color="#000080">+ </font>width <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
           </b></font>write<font color="#000080">(</font><font color="#800000">#32</font><font color="#000080">);
          </font>coln <font color="#000080">:= </font>column<font color="#000080">;
          </font>entry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#0</font><font color="#000080">;  </font><font color="#008000"><i>{ empty string }
         </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">#13 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ RETURN-key }
          </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>entry <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{ no RETURN with an empty line! }
          </i></font><font color="#FF0000"><b>begin
           </b></font>str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>char<font color="#000080">(</font>entry <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{ set string length }
           </i></font>InputLine <font color="#000080">:= </font>str<font color="#000080">;
           </font>exit<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">#27 </font><font color="#000080">: </font><font color="#FF0000"><b>begin        </b></font><font color="#008000"><i>{ ESC-key : to abort the entry }
          </i></font>str <font color="#000080">:= </font><font color="#800000">#255</font><font color="#000080">;            </font><font color="#008000"><i>{ set a marker for &quot;ESC-key has been pressed&quot; }
          </i></font>InputLine <font color="#000080">:= </font>str<font color="#000080">;
          </font>exit<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#254 </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                if </b></font><font color="#000080">(</font>entry <font color="#000080">&lt;= </font>width<font color="#000080">) </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ input field full? }
                </i></font><font color="#FF0000"><b>begin
                 </b></font>write<font color="#000080">(</font>key<font color="#000080">);
                 </font>str<font color="#000080">[</font>entry<font color="#000080">] := </font>key<font color="#000080">;
                 </font>entry <font color="#000080">:= </font>entry <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                 </font>coln <font color="#000080">:= </font>coln <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
