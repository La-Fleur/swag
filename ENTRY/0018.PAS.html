<html>
<head><title> "Date Input Routine" by LUIS EVARISTO FONSECA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ This is a big one... This is an (hopefully) error free, full featured, date
input routine. It accepts all known editing keys (such as left, right, del, bs
etc,etc,etc...) and validates the inserted date. Well, the parameters are:

          data(x,y:integer;ct:boolean; var inp:string; var ret:integer);

          (x,y) - coordinates of input location;
          ct    - is insert on (true) or off (false);
          inp   - where the new date will be inserted;
          ret   - return code. 1 means up was pressed, 2 means down pressed;
                  0 means esc was pressed. Any of these abort date entry,
                  although that can be easily fixed by deactivating their
                  entries in the datainput procedure;

Dates get out in the European DD/MM/YY format. This only afects the validation,
so if you want to change it, change the order of x1, x2 and x3 in vali_date to
suit your needs. For instance, to get the format MM/DD/YY, change all x1 in the
val functions to x2, and all x2 to x1. ONLY IN THE VAL, in the beggining of the
vali_date procedure.

Portuguese Freeware, 1994, Luis Evaristo Fonseca Thunderball Software Inc.
}

</i></font><font color="#FF0000"><b>unit </b></font>dateinp<font color="#000080">;

</font><font color="#FF0000"><b>interface    

uses </b></font>crt<font color="#000080">,</font>top<font color="#000080">;

</font><font color="#FF0000"><b>const
    </b></font>BS        <font color="#000080">=   </font><font color="#800000">8</font><font color="#000080">;
    </font>TAB       <font color="#000080">=   </font><font color="#800000">9</font><font color="#000080">;
    </font>CR        <font color="#000080">=  </font><font color="#800000">13</font><font color="#000080">;
    </font>CTRLT     <font color="#000080">=  </font><font color="#800000">20</font><font color="#000080">;
    </font>CTRLY     <font color="#000080">=  </font><font color="#800000">25</font><font color="#000080">;
    </font>ESC       <font color="#000080">=  </font><font color="#800000">27</font><font color="#000080">;
    </font>HOME      <font color="#000080">= </font><font color="#800000">327</font><font color="#000080">;
    </font>UP        <font color="#000080">= </font><font color="#800000">328</font><font color="#000080">;
    </font>ENDK    
    DOWN      <font color="#000080">= </font><font color="#800000">336</font><font color="#000080">;
    </font>LEFT      <font color="#000080">= </font><font color="#800000">331</font><font color="#000080">;
    </font>RIGHT     <font color="#000080">= </font><font color="#800000">333</font><font color="#000080">;
    </font>INS       <font color="#000080">= </font><font color="#800000">338</font><font color="#000080">;
    </font>DEL       <font color="#000080">= </font><font color="#800000">339</font><font color="#000080">;
    </font>CTRLLEFT  <font color="#000080">= </font><font color="#800000">371</font><font color="#000080">;
    </font>CTRLRIGHT <font color="#000080">= </font><font color="#800000">372</font><font color="#000080">;
    </font>ONLYNUM<font color="#000080">=[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];

</font><font color="#FF0000"><b>procedure </b></font>data<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>ct<font color="#000080">:</font>boolean<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ret<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{ lˆ tecla premida }
</i></font><font color="#FF0000"><b>function </b></font>getkey <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>var
    </b></font>ch <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>ch<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then 
        </b></font>getkey <font color="#000080">:= </font>ord<font color="#000080">(</font>readkey<font color="#000080">)+</font><font color="#800000">256
    </font><font color="#FF0000"><b>else
        </b></font>getkey <font color="#000080">:= </font>ord<font color="#000080">(</font>ch<font color="#000080">);   
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ escreve a string no ‚cran }
</i></font><font color="#FF0000"><b>procedure </b></font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>aux<font color="#000080">,</font>conta<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
    </font>write<font color="#000080">(</font><font color="#800000">'  /  /  '</font><font color="#000080">);
    </font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
    </font>aux<font color="#000080">:=</font>x<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>conta<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>inp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do
    begin
        case </b></font>conta <font color="#FF0000"><b>of
            </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                    </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">+</font>conta<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">);
                    </font>write<font color="#000080">(</font>inp<font color="#000080">[</font>conta<font color="#000080">]);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                    </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">+</font>conta<font color="#000080">,</font>y<font color="#000080">);
                    </font>write<font color="#000080">(</font>inp<font color="#000080">[</font>conta<font color="#000080">]);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                    </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">+</font>conta<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">);
                    </font>write<font color="#000080">(</font>inp<font color="#000080">[</font>conta<font color="#000080">]);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ salta para a primeira posi‡„o de cursor v lida, actualiza ‚cran }
</i></font><font color="#FF0000"><b>procedure </b></font>homekey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    </b></font>x1<font color="#000080">:=</font>x<font color="#000080">;
    </font>posic<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ salta para a &pound;ltima posi‡&AElig;o de cursor utilizada, actualiza ‚cran }
</i></font><font color="#FF0000"><b>procedure </b></font>endkey<font color="#000080">(</font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    case </b></font>length<font color="#000080">(</font>inp<font color="#000080">) </font><font color="#FF0000"><b>of
        </b></font><font color="#800000">1</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#800000">2</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
        </font><font color="#800000">3</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
        </font><font color="#800000">4</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">;
        </font><font color="#800000">5</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">;
        </font><font color="#800000">6</font><font color="#000080">:</font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>posic<font color="#000080">:=</font>length<font color="#000080">(</font>inp<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>posic<font color="#000080">&gt;</font><font color="#800000">6 </font><font color="#FF0000"><b>then
        </b></font>posic<font color="#000080">:=</font><font color="#800000">6</font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ move o cursor uma casa para a esquerda, actualiza ‚cran, n„o ultrapassa o }
{ limite m ximo de cursor … esquerda }
</i></font><font color="#FF0000"><b>procedure </b></font>leftkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font>posic<font color="#000080">:=</font>posic<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>x1<font color="#000080">-</font>x<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
        </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>posic<font color="#000080">:=</font>posic<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ move o cursor uma casa para a direita, actualiza ‚cran, n&AElig;o ultrapassa a }
{ posi‡&AElig;o do &pound;ltimo caracter escrito mais uma posi‡&AElig;o }
</i></font><font color="#FF0000"><b>procedure </b></font>rightkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>posic<font color="#000080">:=</font>posic<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">)  </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>inp<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">&lt;</font>posic<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x1<font color="#000080">&gt;</font>x<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
        </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>posic<font color="#000080">:=</font>posic<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ move o cursor para a primeira letra da palavra, ou (caso }
{ o cursor n&AElig;o se encontre sobre nenhuma palavra, a pr&cent;xima }
</i></font><font color="#FF0000"><b>procedure </b></font>ctrll<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    if </b></font>posic<font color="#000080">&lt;</font><font color="#800000">4 </font><font color="#FF0000"><b>then
    begin
        </b></font>posic<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
        </font>x1<font color="#000080">:=</font>x<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
        </b></font>posic<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
        </font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ move o cursor para a primeira letra da palavra seguinte }
</i></font><font color="#FF0000"><b>procedure </b></font>ctrlr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
    case </b></font>posic <font color="#FF0000"><b>of
        </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
            begin
                </b></font>posic<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
                </font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then
            begin
                </b></font>posic<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
                </font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ apaga tudo o que est  escrito, actualiza string e ecran }
</i></font><font color="#FF0000"><b>procedure </b></font>ctrl_y<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
    </b></font>x1<font color="#000080">:=</font>x<font color="#000080">;
    </font>posic<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>inp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ apaga tudo o que est  escrito … direita do cursor, actualiza string e ecran }
</i></font><font color="#FF0000"><b>procedure </b></font>ctrl_t<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>conta<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
    if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;</font>posic <font color="#FF0000"><b>then
        for </b></font>conta<font color="#000080">:=</font>posic <font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>inp<font color="#000080">) </font><font color="#FF0000"><b>do
            </b></font>delete<font color="#000080">(</font>inp<font color="#000080">,</font>posic<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ liga / desliga o modo de inser‡„o &quot;overwrite&quot; (cursor em bloco) ou normal }
</i></font><font color="#FF0000"><b>procedure </b></font>inskey<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>ct<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
    if </b></font>ct<font color="#000080">=</font>true <font color="#FF0000"><b>then
    begin
        </b></font>bigcursor<font color="#000080">;
        </font>ct<font color="#000080">:=</font>false
    <font color="#FF0000"><b>end
    else
    begin
        </b></font>linecursor<font color="#000080">;
        </font>ct<font color="#000080">:=</font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ apaga o caracter … direita na string, actualiza ‚cran }
</i></font><font color="#FF0000"><b>procedure </b></font>delk<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
    if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;=</font>posic <font color="#FF0000"><b>then
        </b></font>delete<font color="#000080">(</font>inp<font color="#000080">,</font>posic<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ apaga o caracter … esquerda na string, actualiza ‚cran, n&AElig;o passa o }
{ limite m ximo … esquerda }
</i></font><font color="#FF0000"><b>procedure </b></font>bsk<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
    if </b></font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">&gt;=</font>x <font color="#FF0000"><b>then
    begin
         </b></font>delete<font color="#000080">(</font>inp<font color="#000080">,</font>posic<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>posic <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>then
             </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">-</font><font color="#800000">2
         </font><font color="#FF0000"><b>else
             </b></font>x1<font color="#000080">:=</font>x1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
         </font>posic<font color="#000080">:=</font>posic<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
         </font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>tabkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>ct<font color="#000080">:</font>boolean<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>conta<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
    case </b></font>posic <font color="#FF0000"><b>of
        </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
            begin
                </b></font>posic<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
                </font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)&gt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then
            begin
                </b></font>posic<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
                </font>x1<font color="#000080">:=</font>x<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>datainput<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>ct<font color="#000080">:</font>boolean<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>ret<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>conta<font color="#000080">,</font>posic<font color="#000080">:</font>integer<font color="#000080">;
    </font>c<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>x1<font color="#000080">:=</font>x<font color="#000080">;
    </font>posic<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y<font color="#000080">);
    </font>c<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>c<font color="#000080">&lt;&gt;</font>CR<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
        </b></font>c<font color="#000080">:=</font>getkey<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>c<font color="#000080">&gt;</font><font color="#800000">28</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">&lt;</font><font color="#800000">256</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>chr<font color="#000080">(</font>c<font color="#000080">) </font><font color="#FF0000"><b>in </b></font>onlynum<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
            if </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x1<font color="#000080">=</font>x<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then
                </b></font>inc<font color="#000080">(</font>x1<font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font>ct<font color="#000080">=</font>true <font color="#FF0000"><b>then
            begin
                if </b></font>length<font color="#000080">(</font>inp<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">&lt;=</font><font color="#800000">6 </font><font color="#FF0000"><b>then
                begin
                    </b></font>insert<font color="#000080">(</font>chr<font color="#000080">(</font>c<font color="#000080">),</font>inp<font color="#000080">,</font>posic<font color="#000080">);
                    </font><font color="#FF0000"><b>if </b></font>posic<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">&lt;=</font><font color="#800000">6 </font><font color="#FF0000"><b>then
                    begin
                        </b></font>inc<font color="#000080">(</font>posic<font color="#000080">);
                        </font>inc<font color="#000080">(</font>x1<font color="#000080">);
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end
            end
            else
            begin
                if </b></font><font color="#000080">(</font>posic<font color="#000080">=</font>length<font color="#000080">(</font>inp<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>length<font color="#000080">(</font>inp<font color="#000080">)&lt;</font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>then
                    </b></font>inp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>inp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">);
                </font>inp<font color="#000080">[</font>posic<font color="#000080">]:=</font>chr<font color="#000080">(</font>c<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>posic<font color="#000080">&lt;</font><font color="#800000">6 </font><font color="#FF0000"><b>then
                begin
                    </b></font>inc<font color="#000080">(</font>x1<font color="#000080">);
                    </font>inc<font color="#000080">(</font>posic<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
        else
        begin
            case </b></font>c <font color="#FF0000"><b>of
                </b></font>BS<font color="#000080">:</font>bsk<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">,</font>inp<font color="#000080">);
                </font>HOME<font color="#000080">:</font>homekey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>ENDK<font color="#000080">:</font>endkey<font color="#000080">(</font>inp<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>LEFT<font color="#000080">:</font>leftkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>RIGHT<font color="#000080">:</font>rightkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>CTRLLEFT<font color="#000080">:</font>ctrll<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>CTRLRIGHT<font color="#000080">:</font>ctrlr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">);
                </font>INS<font color="#000080">:</font>inskey<font color="#000080">(</font>ct<font color="#000080">);
                </font>DEL<font color="#000080">:</font>delk<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">,</font>inp<font color="#000080">);
                </font>TAB<font color="#000080">:</font>tabkey<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>ct<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">,</font>inp<font color="#000080">);
                </font>CTRLY<font color="#000080">:</font>ctrl_y<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">,</font>inp<font color="#000080">);
                </font>CTRLT<font color="#000080">:</font>ctrl_t<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x1<font color="#000080">,</font>posic<font color="#000080">,</font>inp<font color="#000080">);
                </font>UP<font color="#000080">:</font><font color="#FF0000"><b>begin
                        </b></font>ret<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                        </font>exit<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font>DOWN<font color="#000080">:</font><font color="#FF0000"><b>begin
                        </b></font>ret<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
                        </font>exit<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font>ESC<font color="#000080">:</font><font color="#FF0000"><b>begin
                        </b></font>ret<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                        </font>exit<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>writestr<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>x1<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>vali_date<font color="#000080">(</font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>x3<font color="#000080">,</font>code<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>val<font color="#000080">(</font>inp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>inp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>x1<font color="#000080">,</font>code<font color="#000080">);
    </font>val<font color="#000080">(</font>inp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]+</font>inp<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">],</font>x2<font color="#000080">,</font>code<font color="#000080">);
    </font>val<font color="#000080">(</font>inp<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]+</font>inp<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">],</font>x3<font color="#000080">,</font>code<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>inp<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
        if </b></font><font color="#000080">(</font>x2<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x2<font color="#000080">&lt;</font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
            case </b></font>x2 <font color="#FF0000"><b>of
                 </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x1<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x1<font color="#000080">&lt;</font><font color="#800000">32</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                     </b></font>vali_date<font color="#000080">:=</font>true
                                 <font color="#FF0000"><b>else
                                     </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
                 </font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11       </font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x1<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x1<font color="#000080">&lt;</font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                     </b></font>vali_date<font color="#000080">:=</font>true
                                 <font color="#FF0000"><b>else
                                     </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
                 </font><font color="#800000">2              </font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x1<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x1<font color="#000080">&lt;</font><font color="#800000">30</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                 begin
                                     if </b></font><font color="#000080">(</font>x3<font color="#000080">+</font><font color="#800000">1900</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                                     begin
                                         if </b></font>x1<font color="#000080">&lt;</font><font color="#800000">29 </font><font color="#FF0000"><b>then
                                             </b></font>vali_date<font color="#000080">:=</font>true
                                         <font color="#FF0000"><b>else
                                             </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
                                     </font><font color="#FF0000"><b>end
                                     else
                                         if </b></font>x1<font color="#000080">&lt;</font><font color="#800000">30 </font><font color="#FF0000"><b>then
                                             </b></font>vali_date<font color="#000080">:=</font>true
                                         <font color="#FF0000"><b>else
                                             </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
                                 </font><font color="#FF0000"><b>end
                                 else
                                     </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
        else
             </b></font>vali_date<font color="#000080">:=</font>false<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
        </b></font>vali_date<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>data<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;</font>ct<font color="#000080">:</font>boolean<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>inp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ret<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>test<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
    </font>test<font color="#000080">:=</font>false<font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>test<font color="#000080">=</font>false <font color="#FF0000"><b>do
    begin
          </b></font>datainput<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>inp<font color="#000080">,</font>ct<font color="#000080">,</font>ret<font color="#000080">);
          </font>test<font color="#000080">:=</font>vali_date<font color="#000080">(</font>inp<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
