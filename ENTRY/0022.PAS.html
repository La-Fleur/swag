<html>
<head><title> "Excellent ReadPattern" by STERLING BATES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Procedure </b></font>ReadP <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NewIn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>OldIn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Colr <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>FChar <font color="#000080">: </font>Char<font color="#000080">; </font>ValidChars <font color="#000080">: </font>ChSet<font color="#000080">; </font>Patrn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

              </font><font color="#008000"><i>(* NewIn         = Variable containing data entered by user
                 OldIn         = Default input string
                 X,Y           = Coordinates to begin reading
                 FChar         = Fill character at End-of-String
                 ValidChars    = Set of Char of characters valid for input
                                 (in some cases is redundant)
                 Patrn         = String containing three different chars:
                                        'X's for blank space (no data)
                                        '#'s for numbers only
                                        '@'s for alpha characters only
                                        '%'s for both alpha &amp; numeric
characters              *)

  (* When calling ReadP, the prompt should already be on-screen.  X,Y locates
     the point to begin the reading.  When ReadP returns a value in NewIn,
     please note that a pattern of '###X###X####' will be returned looking like
     '##########'.  The X's do not denote a space in the final string.  ie:

                    Please Enter Your Phone Number: (403) 123-4567

     will be returned in NewIn as 4031234567.  The pattern would have resembled
     the example above.

     ** NOTE **  There are functions/procedures required to run this procedure.
                 They are:
                                GetCursor (not necessary)
                                SetCursor (not necessary)
                                WriteP (pattern-writing routine, see next few
                                        posts, is necessary)

     A demo program is included at the bottom of the message.

  *)

  (* Standard disclaimer: I'm not liable for anything this procedure does
                          outside the original purpose of the procedure.  If
                          something bad happens, let me know, but that's all
                          I can do.
  *)

</i></font><font color="#FF0000"><b>Var
   </b></font>CurX<font color="#000080">, </font>StLen<font color="#000080">, </font>PatX<font color="#000080">, </font>NumXs<font color="#000080">, </font>MaxLen<font color="#000080">,
   </font>Tmp                                  <font color="#000080">: </font>Byte<font color="#000080">;
   </font>DefChars                             <font color="#000080">: </font><font color="#FF0000"><b>Set Of </b></font>Char<font color="#000080">;
   </font>OldCursor                            <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Tmp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length <font color="#000080">(</font>Patrn<font color="#000080">) </font><font color="#FF0000"><b>Do
         If </b></font>Patrn<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
            </b></font>Inc <font color="#000080">(</font>Tmp<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>Length <font color="#000080">(</font>OldIn<font color="#000080">) &gt; </font>Length <font color="#000080">(</font>Patrn<font color="#000080">)-</font>Tmp <font color="#FF0000"><b>Then
        </b></font>OldIn <font color="#000080">:= </font>Copy <font color="#000080">(</font>OldIn<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length <font color="#000080">(</font>Patrn<font color="#000080">)-</font>Tmp<font color="#000080">);
     </font>WriteP <font color="#000080">(</font>OldIn<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>HiColr<font color="#000080">,</font>FChar<font color="#000080">,</font>Patrn<font color="#000080">);
     </font>InStr <font color="#000080">:= </font>OldIn<font color="#000080">;
     </font>StLen <font color="#000080">:= </font>Length <font color="#000080">(</font>OldIn<font color="#000080">);
     </font>NumXs <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>StLen <font color="#FF0000"><b>Do
         If </b></font>Patrn<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
            </b></font>Inc <font color="#000080">(</font>NumXs<font color="#000080">);
     </font>CurX <font color="#000080">:= </font>StLen<font color="#000080">+</font>X<font color="#000080">+</font>NumXs<font color="#000080">;
     </font>PatX <font color="#000080">:= </font>StLen<font color="#000080">+</font>NumXs<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>PatX <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
     Begin
          </b></font>PatX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>CurX <font color="#000080">:= </font>X<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>DefChars <font color="#000080">:= </font>ValidChars<font color="#000080">;
     </font>MaxLen <font color="#000080">:= </font>Length <font color="#000080">(</font>Patrn<font color="#000080">);
     </font>OldCursor <font color="#000080">:= </font>GetCursor<font color="#000080">;
     </font><font color="#FF0000"><b>Repeat
           If </b></font>PatX <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
           Begin
                </b></font>PatX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font>CurX <font color="#000080">:= </font>X<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Do
           Begin
                </b></font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                </font>Inc <font color="#000080">(</font>CurX<font color="#000080">);
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font>NumXs <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
           </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>PatX <font color="#FF0000"><b>Do
               If </b></font>Patrn<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                  </b></font>Inc <font color="#000080">(</font>NumXs<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>InsOn <font color="#FF0000"><b>Then
              </b></font>SetCursor <font color="#000080">(</font>DefaultCursor<font color="#000080">)
           </font><font color="#FF0000"><b>Else
               </b></font>SetCursor <font color="#000080">(</font>BlockCursor<font color="#000080">);
           </font>GotoXY <font color="#000080">(</font>CurX<font color="#000080">,</font>Y<font color="#000080">);
           </font><font color="#FF0000"><b>Case </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">] </font><font color="#FF0000"><b>Of
                </b></font><font color="#800000">'#'</font><font color="#000080">: </font>ValidChars <font color="#000080">:= </font>NumChars<font color="#000080">;
                </font><font color="#800000">'@'</font><font color="#000080">: </font>ValidChars <font color="#000080">:= </font>AlphaChars<font color="#000080">;
                </font><font color="#800000">'%'</font><font color="#000080">: </font>ValidChars <font color="#000080">:= </font>NumChars <font color="#000080">+ </font>AlphaChars<font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font>ValidChars <font color="#000080">:= </font>ValidChars <font color="#000080">+ [</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#210</font><font color="#000080">,</font><font color="#800000">#211</font><font color="#000080">] + </font>HKeySet <font color="#000080">+ </font>FuncKeys <font color="#000080">+
                                      </font>MenuKeys <font color="#000080">+ </font>ArrowKeys<font color="#000080">;
           </font><font color="#FF0000"><b>Repeat
                 </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
           </font><font color="#FF0000"><b>Until </b></font>Ch <font color="#FF0000"><b>In </b></font>ValidChars<font color="#000080">;
           </font>SetCursor <font color="#000080">(</font>OldCursor<font color="#000080">);
           </font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>Of
                </b></font><font color="#800000">#8</font><font color="#000080">:
                </font><font color="#FF0000"><b>Begin
                     If </b></font>PatX <font color="#000080">&gt;= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
                     Begin
                          If </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                          Begin
                               While </b></font><font color="#000080">(</font>Patrn<font color="#000080">[</font>PatX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'X'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>PatX <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
                               Begin
                                    </b></font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                                    </font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                               </font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                               </font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                          </font><font color="#FF0000"><b>End
                          Else
                          Begin
                               </b></font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                               </font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>CurX <font color="#000080">&gt;= </font>X<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Length <font color="#000080">(</font>InStr<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                          Begin
                               </b></font>NumXs <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                               </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>PatX <font color="#FF0000"><b>Do
                                   If </b></font>Patrn<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                                      </b></font>Inc <font color="#000080">(</font>NumXs<font color="#000080">);
                               </font>Delete <font color="#000080">(</font>InStr<font color="#000080">,</font>PatX<font color="#000080">-</font>NumXs<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#203</font><font color="#000080">: </font><font color="#008000"><i>{ Left arrow }
                </i></font><font color="#FF0000"><b>Begin
                     If </b></font>CurX <font color="#000080">&gt; </font>X <font color="#FF0000"><b>Then
                        If </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                        Begin
                             </b></font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                             </font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                        </font><font color="#FF0000"><b>End
                        Else
                        Begin
                             While </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Do
                             Begin
                                  </b></font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                                  </font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                             </font>Dec <font color="#000080">(</font>CurX<font color="#000080">);
                             </font>Dec <font color="#000080">(</font>PatX<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                     </font><font color="#FF0000"><b>If </b></font>PatX <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
                     Begin
                          </b></font>CurX <font color="#000080">:= </font>X<font color="#000080">;
                          </font>PatX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#205</font><font color="#000080">: </font><font color="#008000"><i>{ Right arrow }
                      </i></font><font color="#FF0000"><b>If </b></font>PatX<font color="#000080">-</font>NumXs <font color="#000080">&lt;= </font>Length <font color="#000080">(</font>InStr<font color="#000080">) </font><font color="#FF0000"><b>Then
                         If </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                         Begin
                              </b></font>Inc <font color="#000080">(</font>CurX<font color="#000080">);
                              </font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                         </font><font color="#FF0000"><b>End
                         Else
                         Begin
                              </b></font>Inc <font color="#000080">(</font>CurX<font color="#000080">);
                              </font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                              </font><font color="#FF0000"><b>While </b></font>Patrn<font color="#000080">[</font>PatX<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Do
                              Begin
                                   </b></font>Inc <font color="#000080">(</font>CurX<font color="#000080">);
                                   </font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#199</font><font color="#000080">: </font><font color="#008000"><i>{ Home }
                </i></font><font color="#FF0000"><b>Begin
                     </b></font>CurX <font color="#000080">:= </font>X<font color="#000080">;
                     </font>PatX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#207</font><font color="#000080">: </font><font color="#008000"><i>{ End }
                </i></font><font color="#FF0000"><b>Begin
                     </b></font>PatX <font color="#000080">:= </font>Length <font color="#000080">(</font>InStr<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>PatX <font color="#FF0000"><b>Do
                         If </b></font>Patrn<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then
                            </b></font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                     </font>CurX <font color="#000080">:= </font>PatX<font color="#000080">+</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#800000">#210</font><font color="#000080">: </font><font color="#008000"><i>{ Insert }
                      </i></font>InsOn <font color="#000080">:= </font>InsOn <font color="#FF0000"><b>XOr </b></font>True<font color="#000080">;
                </font><font color="#800000">#211</font><font color="#000080">: </font><font color="#008000"><i>{ Delete }
                      </i></font>Delete <font color="#000080">(</font>InStr<font color="#000080">,</font>PatX<font color="#000080">-</font>NumXs<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                </font><font color="#800000">#65</font><font color="#000080">..</font><font color="#800000">#90</font><font color="#000080">,
                </font><font color="#800000">#97</font><font color="#000080">..</font><font color="#800000">#122</font><font color="#000080">, </font><font color="#008000"><i>{ Alphabet }
                </i></font><font color="#800000">#48</font><font color="#000080">..</font><font color="#800000">#57</font><font color="#000080">,  </font><font color="#008000"><i>{ Numbers }
                </i></font><font color="#800000">#91</font><font color="#000080">..</font><font color="#800000">#96</font><font color="#000080">,
                </font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#47</font><font color="#000080">,
                </font><font color="#800000">#58</font><font color="#000080">..</font><font color="#800000">#64</font><font color="#000080">:  </font><font color="#008000"><i>{ Other chars }
                </i></font><font color="#FF0000"><b>Begin
                     If </b></font><font color="#000080">(</font>CurX<font color="#000080">-</font>X <font color="#000080">&lt; </font>MaxLen<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(((</font>Length <font color="#000080">(</font>InStr<font color="#000080">) &lt; </font>MaxLen<font color="#000080">) </font><font color="#FF0000"><b>And
                        </b></font><font color="#000080">(</font>InsOn<font color="#000080">)) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">((</font><font color="#FF0000"><b>Not </b></font>InsOn<font color="#000080">))) </font><font color="#FF0000"><b>Then
                     Begin
                          If </b></font>InsOn <font color="#FF0000"><b>Then
                               </b></font>Insert <font color="#000080">(</font>Ch<font color="#000080">,</font>InStr<font color="#000080">,</font>PatX<font color="#000080">-</font>NumXs<font color="#000080">)
                          </font><font color="#FF0000"><b>Else
                          Begin
                               If </b></font>PatX<font color="#000080">-</font>NumXs <font color="#000080">&gt; </font>Length <font color="#000080">(</font>InStr<font color="#000080">) </font><font color="#FF0000"><b>Then
                                  </b></font>Insert <font color="#000080">(</font>Ch<font color="#000080">,</font>InStr<font color="#000080">,</font>PatX<font color="#000080">-</font>NumXs<font color="#000080">)
                               </font><font color="#FF0000"><b>Else
                                   </b></font>InStr<font color="#000080">[</font>PatX<font color="#000080">-</font>NumXs<font color="#000080">] := </font>Ch<font color="#000080">;
                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                          </font>Inc <font color="#000080">(</font>CurX<font color="#000080">);
                          </font>Inc <font color="#000080">(</font>PatX<font color="#000080">);
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font>Length <font color="#000080">(</font>InStr<font color="#000080">) &gt; </font>Length <font color="#000080">(</font>Patrn<font color="#000080">) </font><font color="#FF0000"><b>Then
              </b></font>InStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr <font color="#000080">(</font>Length <font color="#000080">(</font>Patrn<font color="#000080">));
           </font>WriteP <font color="#000080">(</font>InStr<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Colr<font color="#000080">,</font>FChar<font color="#000080">,</font>Patrn<font color="#000080">);
     </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>Ch <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>Then
        </b></font>NewIn <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>Ch <font color="#000080">= </font><font color="#800000">#13 </font><font color="#FF0000"><b>Then
        </b></font>NewIn <font color="#000080">:= </font>InStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
