<html>
<head><title> "FergSoft! ReadLn" by JUSTIN FERGUSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
        Ok, y'all, here's a function I've been working on for a while, and
        I thought I'd post it for everybody.  It's a modified ReadLn
        routine, and while there's no guarantees, &lt;What's new?&gt;, I _think_
        it's bug free. &lt;Crossing fingers&gt;  If y'all want to use it, go
        ahead, but I would like some credit, 'cuz it took me a while.  Just
        credit FergSoft!, Artificial Reality, Whizard, or Justin Ferguson.
        It's fairly well commented, but just throw any questions you may
        have my way...

--- Cut Here ---
}

</i></font><font color="#FF0000"><b>unit </b></font>FSRead<font color="#000080">;

</font><font color="#008000"><i>{------------------------------------------------------------------------}
{
      FergSoft! ReadLn Routine:

                By Justin Ferguson of FergSoft!,
                a. k. a. Whizard of Artificial Reality.

      FSReadLn reads a string of specified length, at specified
      location, in specified colors, terminated by TAB or Enter.

      Feel free to use this little unit anywhere y'all want, just give
      credit for it.


                                Thanx, Whizard

                                                                         }
{------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>INTERFACE

uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FSReadLn <font color="#000080">(</font>X<font color="#000080">,                                         </font><font color="#008000"><i>{X Location}
                   </i></font>Y<font color="#000080">,                                         </font><font color="#008000"><i>{Y Location}
                   </i></font>FC<font color="#000080">,                                  </font><font color="#008000"><i>{Foreground Color}
                   </i></font>BC<font color="#000080">,                                  </font><font color="#008000"><i>{Background Color}
                   </i></font>StrLength <font color="#000080">: </font>Byte<font color="#000080">;  </font><font color="#008000"><i>{Length of string to input.  Will be
                                       padded with spaces (#32).         }

                   </i></font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font><font color="#FF0000"><b>String       </b></font><font color="#008000"><i>{Default string, leave '' for no
                                           default                       }
                    </i></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>IMPLEMENTATION

Function </b></font>FSReadLn <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>FC<font color="#000080">, </font>BC<font color="#000080">, </font>StrLength <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Default </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">)
                                                                 : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;                      </font><font color="#008000"><i>{Temporary string}
    </i></font>Location <font color="#000080">: </font>Byte<font color="#000080">;                    </font><font color="#008000"><i>{Current location in string}
    </i></font>QuitFlag<font color="#000080">, </font>InsFlag <font color="#000080">: </font>Boolean<font color="#000080">;        </font><font color="#008000"><i>{Flags}
    </i></font>Ch <font color="#000080">: </font>Char<font color="#000080">;                          </font><font color="#008000"><i>{Current Character}
    </i></font>Z <font color="#000080">: </font>Integer<font color="#000080">;                        </font><font color="#008000"><i>{Temp variable}
    </i></font>Cursor <font color="#000080">: </font>Word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0060</font><font color="#000080">; </font><font color="#008000"><i>{Cursor format}

</i></font><font color="#FF0000"><b>begin
     </b></font>QuitFlag <font color="#000080">:= </font>False<font color="#000080">;
     </font>InsFlag <font color="#000080">:= </font>True<font color="#000080">;

     </font><font color="#FF0000"><b>For </b></font>Z <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do               </b></font><font color="#008000"><i>{Clear string to spaces}
         </i></font>Temp<font color="#000080">[</font>Z<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;

     </font><font color="#FF0000"><b>For </b></font>Z <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font><font color="#FF0000"><b>Default</b></font><font color="#000080">) </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{Set to default string}
         </i></font>Temp<font color="#000080">[</font>Z<font color="#000080">] := </font><font color="#FF0000"><b>Default</b></font><font color="#000080">[</font>Z<font color="#000080">];

     </font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>StrLength<font color="#000080">);         </font><font color="#008000"><i>{Set length of string}
     </i></font>Location <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>Ch <font color="#000080">:= </font><font color="#800000">#1</font><font color="#000080">;
     </font>Temp<font color="#000080">[</font>StrLength <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">#32</font><font color="#000080">;
     </font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
     </font>Write<font color="#000080">(</font>Temp<font color="#000080">);

     </font><font color="#FF0000"><b>Repeat
           Case </b></font>Ch <font color="#FF0000"><b>of
                </b></font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#127 </font><font color="#000080">: </font><font color="#FF0000"><b>begin                    </b></font><font color="#008000"><i>{Regular ASCII}
                              </i></font><font color="#FF0000"><b>If </b></font>InsFlag <font color="#000080">= </font>False <font color="#FF0000"><b>then
                                begin
                                  If </b></font>Location <font color="#000080">&lt;= </font>StrLength <font color="#FF0000"><b>then
                                    begin
                                      </b></font>Location <font color="#000080">:= </font>Location <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                      </font>Temp<font color="#000080">[</font>Location<font color="#000080">] := </font>Ch<font color="#000080">;
                                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                  </font><font color="#FF0000"><b>end
                                else
                                  begin
                                    If </b></font>Location <font color="#000080">&lt;= </font>StrLength <font color="#FF0000"><b>then
                                      begin
                                        For </b></font>Z <font color="#000080">:= </font>StrLength <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto
                                                           </b></font>Location <font color="#FF0000"><b>do
                                          </b></font>Temp<font color="#000080">[</font>Z <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>Temp<font color="#000080">[</font>Z<font color="#000080">];

                                          </font>Temp<font color="#000080">[</font>Location<font color="#000080">] := </font>Ch<font color="#000080">;
                                          </font>Location <font color="#000080">:= </font>Location <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#800000">#27       </font><font color="#000080">: </font><font color="#FF0000"><b>begin                              </b></font><font color="#008000"><i>{ESC}
                              </i></font><font color="#FF0000"><b>For </b></font>Z <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>StrLength <font color="#FF0000"><b>do
                                </b></font>Temp<font color="#000080">[</font>Z<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
                              </font>Location <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#800000">#9</font><font color="#000080">, </font><font color="#800000">#13   </font><font color="#000080">: </font>QuitFlag <font color="#000080">:= </font>True<font color="#000080">;           </font><font color="#008000"><i>{Tab}{Enter}
                </i></font><font color="#800000">#8        </font><font color="#000080">: </font><font color="#FF0000"><b>begin                        </b></font><font color="#008000"><i>{Backspace}
                              </i></font><font color="#FF0000"><b>If </b></font>Location <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                                begin
                                  </b></font>Location <font color="#000080">:= </font>Location <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                                    </font><font color="#FF0000"><b>For </b></font>Z <font color="#000080">:= </font>Location <font color="#FF0000"><b>to </b></font>StrLength <font color="#FF0000"><b>do
                                      begin
                                        </b></font>Temp<font color="#000080">[</font>Z<font color="#000080">] := </font>Temp<font color="#000080">[</font>Z <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
                                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                </font><font color="#800000">#0        </font><font color="#000080">: </font><font color="#FF0000"><b>begin     </b></font><font color="#008000"><i>{Extended keys... }
                              </i></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
                              </font><font color="#FF0000"><b>Case </b></font>Ch <font color="#FF0000"><b>of

                                </b></font><font color="#800000">#75 </font><font color="#000080">: </font><font color="#FF0000"><b>begin             </b></font><font color="#008000"><i>{Left arrow}
                                        </i></font><font color="#FF0000"><b>If </b></font>Location <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                                          </b></font>Location <font color="#000080">:= </font>Location <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                </font><font color="#800000">#77 </font><font color="#000080">: </font><font color="#FF0000"><b>begin            </b></font><font color="#008000"><i>{Right arrow}
                                        </i></font><font color="#FF0000"><b>If </b></font>Location <font color="#000080">&lt; (</font>StrLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                          </b></font>Location <font color="#000080">:= </font>Location <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                </font><font color="#800000">#71 </font><font color="#000080">: </font>Location <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;          </font><font color="#008000"><i>{Home}
                                </i></font><font color="#800000">#79 </font><font color="#000080">: </font>Location <font color="#000080">:= </font>StrLength<font color="#000080">;   </font><font color="#008000"><i>{End}
                                </i></font><font color="#800000">#82 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>InsFlag <font color="#000080">= </font>True     <font color="#008000"><i>{Insert}
                                        </i></font><font color="#FF0000"><b>then
                                          begin
                                            </b></font>InsFlag <font color="#000080">:= </font>False<font color="#000080">;
                                            </font><font color="#FF0000"><b>asm
                                               </b></font><font color="#FF00FF">MOV AH, $01
                                               MOV CX, $0F
                                               INT $10
                                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                          </font><font color="#FF0000"><b>end
                                        else
                                          begin
                                            </b></font>InsFlag <font color="#000080">:= </font>True<font color="#000080">;
                                            </font><font color="#FF0000"><b>asm
                                               </b></font><font color="#FF00FF">MOV AH, $01
                                               MOV CL, $07
                                               MOV CH, $06
                                               INT $10
                                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                                                            </font><font color="#008000"><i>{Delete}
                                </i></font><font color="#800000">#83 </font><font color="#000080">: </font><font color="#FF0000"><b>For </b></font>Z <font color="#000080">:= </font>Location <font color="#FF0000"><b>to </b></font>StrLength <font color="#FF0000"><b>do
                                        </b></font>Temp<font color="#000080">[</font>Z<font color="#000080">] := </font>Temp<font color="#000080">[</font>Z <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
                              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

           </font>Temp<font color="#000080">[</font>StrLength <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">#32</font><font color="#000080">;
           </font>GotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
           </font>Write<font color="#000080">(</font>Temp<font color="#000080">);

           </font>TextColor<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
           </font>GotoXY<font color="#000080">(</font><font color="#800000">79</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>InsFlag <font color="#000080">= </font>True <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'I'</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
              </font><font color="#008000"><i>{Note:  Take out above 3 lines to not put an insert
               status 'I' at the bottom of the screen             }

           </i></font>TextColor<font color="#000080">(</font>FC<font color="#000080">);
           </font>TextBackground<font color="#000080">(</font>BC<font color="#000080">);
           </font>GotoXY<font color="#000080">(</font>X <font color="#000080">+ </font>Location <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>Y<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>QuitFlag <font color="#000080">&lt;&gt; </font>True <font color="#FF0000"><b>then </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;

     </font><font color="#FF0000"><b>until </b></font>QuitFlag <font color="#000080">= </font>True<font color="#000080">;

     </font>Temp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>StrLength<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{--------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
