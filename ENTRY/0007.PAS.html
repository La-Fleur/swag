<html>
<head><title> "Key Input Routine" by JEFF FANJOY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">&gt; </font>Does anyone know how <font color="#FF0000"><b>to </b></font>make the input line a certain number <font color="#FF0000"><b>of </b></font>lines
<font color="#000080">&gt; </font>only<font color="#000080">!...</font>sya the user only gets <font color="#FF0000"><b>to </b></font>us <font color="#800000">3 </font>characters<font color="#000080">....

</font>Here <font color="#FF0000"><b>is </b></font>the input routine that I use <font color="#FF0000"><b>for </b></font>all <font color="#FF0000"><b>of </b></font>my programs<font color="#000080">.  </font>You may
<font color="#FF0000"><b>not </b></font>need it so precise<font color="#000080">, </font>so you can cut <font color="#FF0000"><b>out </b></font>anything you don<font color="#800000">'t feel is
</font>necessary but here goes<font color="#000080">:
}

</font><font color="#FF0000"><b>UNIT </b></font>KeyInput<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES </b></font>CRT<font color="#000080">,</font>CURSOR<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetInput<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>InStr<font color="#000080">;                    </font><font color="#008000"><i>{String Passed}
                       </i></font>WhatWas<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;          </font><font color="#008000"><i>{Old value to Remember}
                       </i></font>Len<font color="#000080">: </font>Byte<font color="#000080">;                </font><font color="#008000"><i>{Length of String Max=255}
                       </i></font>XPosition<font color="#000080">,                </font><font color="#008000"><i>{X Cursor Position}
                       </i></font>YPosition<font color="#000080">,                </font><font color="#008000"><i>{Y Cursor Position}
                       </i></font>BackGroundColor<font color="#000080">,          </font><font color="#008000"><i>{Background Color}
                       </i></font>ForeGroundColor<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{Foreground Color}
                       </i></font>BackGroundChar<font color="#000080">: </font>Char<font color="#000080">;     </font><font color="#008000"><i>{Echoed Character on BkSp}
                       </i></font>Caps<font color="#000080">: </font>Boolean<font color="#000080">);           </font><font color="#008000"><i>{CAPS?}
</i></font><font color="#FF0000"><b>IMPLEMENTATION

PROCEDURE </b></font>GetInput<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>InStr<font color="#000080">;
                       </font>WhatWas<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                       </font>Len<font color="#000080">: </font>Byte<font color="#000080">;
                       </font>XPosition<font color="#000080">,
                       </font>YPosition<font color="#000080">,
                       </font>BackGroundColor<font color="#000080">,
                       </font>ForeGroundColor<font color="#000080">: </font>Integer<font color="#000080">;
                       </font>BackGroundChar<font color="#000080">: </font>Char<font color="#000080">;
                       </font>Caps<font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>CONST
   </b></font>BkSp<font color="#000080">: </font>Char <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">);

</font><font color="#FF0000"><b>VAR
   </b></font>InsertKey<font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">;
   </font>Temp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>Ch2<font color="#000080">,
   </font>C<font color="#000080">: </font>Char<font color="#000080">;
   </font>A<font color="#000080">,
   </font>U<font color="#000080">,
   </font>B<font color="#000080">: </font>Byte<font color="#000080">;
   </font>FirstChar<font color="#000080">,
   </font>InsertOn<font color="#000080">,
   </font>NoAdd<font color="#000080">: </font>Boolean<font color="#000080">;
   </font>NewString<font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>InStr<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>InsertKey <font color="#000080">:= </font>InsertKey <font color="#FF0000"><b>OR </b></font><font color="#800000">$80</font><font color="#000080">; </font><font color="#008000"><i>{changes to insert mode}
   </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>InsertKey <font color="#FF0000"><b>AND </b></font><font color="#800000">$80 </font><font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
       </b></font>InsertOn <font color="#000080">:= </font>TRUE<font color="#000080">;
       </font>ShowCursor<font color="#000080">;
    </font><font color="#FF0000"><b>END
   ELSE
    BEGIN
       </b></font>InsertOn <font color="#000080">:= </font>FALSE<font color="#000080">;
       </font>BigCursor<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>FirstChar <font color="#000080">:= </font>TRUE<font color="#000080">;
   </font>NewString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
   </font>TextBackGround<font color="#000080">(</font>BackGroundColor<font color="#000080">);
   </font>TextColor<font color="#000080">(</font>ForeGroundColor<font color="#000080">);
   </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO
    BEGIN
       </b></font>Write<font color="#000080">(</font>BackGroundChar<font color="#000080">); </font><font color="#008000"><i>{shows how many characters are available}
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
   </font>C <font color="#000080">:= </font>Chr<font color="#000080">(</font><font color="#800000">$00</font><font color="#000080">); </font><font color="#008000"><i>{null character input}
   </i></font>TextBackGround<font color="#000080">(</font>ForeGroundColor<font color="#000080">);
   </font>TextColor<font color="#000080">(</font>BackGroundColor<font color="#000080">);
   </font>NewString <font color="#000080">:= </font>WhatWas<font color="#000080">; </font><font color="#008000"><i>{starts with previous value in memory}
   </i></font>Write<font color="#000080">(</font>NewString<font color="#000080">); </font><font color="#008000"><i>{writes previous value to screen for editing}
   </i></font>B <font color="#000080">:= </font>Length<font color="#000080">(</font>WhatWas<font color="#000080">);
   </font>A <font color="#000080">:= </font>B<font color="#000080">;
   </font>TextBackGround<font color="#000080">(</font>BackGroundColor<font color="#000080">);
   </font>TextColor<font color="#000080">(</font>ForeGroundColor<font color="#000080">);
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>C <font color="#000080">&lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">$0D</font><font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>C <font color="#000080">&lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">$1B</font><font color="#000080">)) </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{not CR or ESC}
    </i></font><font color="#FF0000"><b>BEGIN
       </b></font>NoAdd <font color="#000080">:= </font>FALSE<font color="#000080">;
       </font><font color="#FF0000"><b>IF </b></font>Caps <font color="#FF0000"><b>THEN </b></font>C <font color="#000080">:= </font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">) </font><font color="#008000"><i>{if Caps read uppercase else...}
       </i></font><font color="#FF0000"><b>ELSE </b></font>C <font color="#000080">:= </font>ReadKey<font color="#000080">;
       </font><font color="#FF0000"><b>CASE </b></font>C <font color="#FF0000"><b>OF
          </b></font>Chr<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">): </font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{backspace}
                     </i></font><font color="#FF0000"><b>BEGIN
                        IF </b></font>FirstChar <font color="#FF0000"><b>THEN
                         BEGIN
                            </b></font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                            </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
                            </font>Write<font color="#000080">(</font>NewString<font color="#000080">);
                         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                        </font>Write<font color="#000080">(</font>BkSp<font color="#000080">,</font>BackGroundChar<font color="#000080">,</font>BkSp<font color="#000080">);
                        </font>Dec<font color="#000080">(</font>B<font color="#000080">);
                        </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">,</font>WhereY<font color="#000080">);
                        </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                         BEGIN
                            IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                            </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
                        </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>Length<font color="#000080">(</font>NewString<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO
                         BEGIN
                            </b></font>Write<font color="#000080">(</font>BackGroundChar<font color="#000080">);
                         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">,</font>WhereY<font color="#000080">);
                        </font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                        </font>Dec<font color="#000080">(</font>A<font color="#000080">);
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Chr<font color="#000080">(</font><font color="#800000">$1B</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Escape}
                       </i></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                       </font>NewString <font color="#000080">:= </font>WhatWas<font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Chr<font color="#000080">(</font><font color="#800000">$19</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{^Y = clear the editing line}
                       </i></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                       </font>NewString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                       </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
                       </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO
                        BEGIN
                           </b></font>Write<font color="#000080">(</font>BackGroundChar<font color="#000080">);
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                       </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
                       </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                       </font>A <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Chr<font color="#000080">(</font><font color="#800000">$0D</font><font color="#000080">): </font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">; </font><font color="#008000"><i>{enter &lt;CR&gt;}
          </i></font>Chr<font color="#000080">(</font><font color="#800000">$00</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{extended keys always start with null character}
                       </i></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                       </font><font color="#FF0000"><b>IF </b></font>FirstChar <font color="#FF0000"><b>THEN
                        BEGIN
                           </b></font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                           </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
                           </font>Write<font color="#000080">(</font>NewString<font color="#000080">);
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font>C <font color="#000080">:= </font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">);
                       </font><font color="#FF0000"><b>CASE </b></font>C <font color="#FF0000"><b>OF
                          </b></font>Chr<font color="#000080">(</font><font color="#800000">77</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{right arrow}
                                    </i></font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>NewString<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                                     BEGIN
                                        </b></font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
                                        </font>Inc<font color="#000080">(</font>B<font color="#000080">);
                                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                          </font>Chr<font color="#000080">(</font><font color="#800000">75</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{left arrow}
                                      </i></font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                                       BEGIN
                                          </b></font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
                                          </font>Dec<font color="#000080">(</font>B<font color="#000080">);
                                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                          </font>Chr<font color="#000080">(</font><font color="#800000">71</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{home}
                                      </i></font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
                                      </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                          </font>Chr<font color="#000080">(</font><font color="#800000">79</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{end}
                                      </i></font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>Length<font color="#000080">(</font>NewString<font color="#000080">),</font>YPosition<font color="#000080">);
                                      </font>B <font color="#000080">:= </font>Length<font color="#000080">(</font>NewString<font color="#000080">);
                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                          </font>Chr<font color="#000080">(</font><font color="#800000">82</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{insert}
                                      </i></font><font color="#FF0000"><b>IF </b></font>InsertOn <font color="#FF0000"><b>THEN
                                       BEGIN
                                          </b></font>InsertOn <font color="#000080">:= </font>FALSE<font color="#000080">;
                                          </font>BigCursor<font color="#000080">;
                                       </font><font color="#FF0000"><b>END
                                      ELSE
                                       BEGIN
                                          </b></font>InsertOn <font color="#000080">:= </font>TRUE<font color="#000080">;
                                          </font>ShowCursor<font color="#000080">;
                                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                          </font>Chr<font color="#000080">(</font><font color="#800000">83</font><font color="#000080">): </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{del}
                                      </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>B <font color="#000080">&lt; </font>Length<font color="#000080">(</font>NewString<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>B <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                       BEGIN
                                          </b></font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                                          </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                                           BEGIN
                                              IF </b></font>U <font color="#000080">&lt;&gt; </font>B <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                                              </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                          </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">,</font>WhereY<font color="#000080">);
                                          </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
                                          </font>Write<font color="#000080">(</font>BackGroundChar<font color="#000080">);
                                          </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">,</font>WhereY<font color="#000080">);
                                          </font>Dec<font color="#000080">(</font>A<font color="#000080">);
                                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font><font color="#FF0000"><b>WHILE </b></font>Keypressed <font color="#FF0000"><b>DO </b></font>C <font color="#000080">:= </font>ReadKey<font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>A <font color="#000080">&lt; </font>Len<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>NoAdd <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>C <font color="#000080">&lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">))) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>FirstChar<font color="#000080">) </font><font color="#FF0000"><b>AND
          </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font>NoAdd<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>C <font color="#000080">&lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">))) </font><font color="#FF0000"><b>THEN
        BEGIN
           IF </b></font>FirstChar <font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{if first character typed is a real character,then
                             string is removed to start new one else...}
            </i></font><font color="#FF0000"><b>BEGIN
               </b></font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>NewString<font color="#000080">));
               </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
               </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>A <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO
                BEGIN
                   </b></font>Write<font color="#000080">(</font>BackGroundChar<font color="#000080">);
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">,</font>YPosition<font color="#000080">);
               </font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font>Inc<font color="#000080">(</font>B<font color="#000080">);
           </font>Inc<font color="#000080">(</font>A<font color="#000080">);
           </font><font color="#FF0000"><b>IF </b></font>InsertOn <font color="#FF0000"><b>THEN
            BEGIN
               </b></font>Insert<font color="#000080">(</font>C<font color="#000080">,</font>NewString<font color="#000080">,</font>B<font color="#000080">);
               </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                BEGIN
                   IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                   </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
               </font>Write<font color="#000080">(</font>C<font color="#000080">);
               </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
               </font>GotoXY<font color="#000080">(</font>XPosition<font color="#000080">+</font>B<font color="#000080">,</font>WhereY<font color="#000080">);
            </font><font color="#FF0000"><b>END
           ELSE
            BEGIN
               </b></font>Insert<font color="#000080">(</font>C<font color="#000080">,</font>NewString<font color="#000080">,</font>B<font color="#000080">);
               </font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
               </font>Write<font color="#000080">(</font>C<font color="#000080">)
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>TextBackGround<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
