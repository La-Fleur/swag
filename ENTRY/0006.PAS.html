<html>
<head><title> "Generalize Input" by RANDALL WOODMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{===========================================================================
Date: 10-02-93 (06:28)
From: RANDALL WOODMAN
Subj: Input

{-&gt;&gt;&gt;&gt;GetString&lt;&lt;&lt;&lt;--------------------------------------------}
{                                                              }
{ Filename : GETSTRIN.SRC -- Last Modified 7/14/88             }
{                                                              }
{ This is a generalized string-input procedure.  It shows a    }
{ field between vertical bar characters at X,Y, with any       }
{ string value passed initially in XString left-justified in   }
{ the field.  The current state of XString when the user       }
{ presses Return is returned in XString.  The user can press   }
{ ESC and leave the passed value of XString undisturbed, even  }
{ if XString was altered prior to his pressing ESC.            }
{                                                              }
{     From: COMPLETE TURBO PASCAL 5.0  by Jeff Duntemann       }
{    Scott, Foresman &amp; Co., Inc. 1988   ISBN 0-673-38355-5     }
{--------------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetString<font color="#000080">(    </font>X<font color="#000080">,</font>Y      <font color="#000080">: </font>Integer<font color="#000080">;
                    </font><font color="#FF0000"><b>VAR </b></font>XString  <font color="#000080">: </font>String80<font color="#000080">;
                        </font>MaxLen   <font color="#000080">: </font>Integer<font color="#000080">;
                        </font>Capslock <font color="#000080">: </font>Boolean<font color="#000080">;
                        </font>Numeric  <font color="#000080">: </font>Boolean<font color="#000080">;
                        </font>GetReal  <font color="#000080">: </font>Boolean<font color="#000080">;
                    </font><font color="#FF0000"><b>VAR </b></font>RValue   <font color="#000080">: </font>Real<font color="#000080">;
                    </font><font color="#FF0000"><b>VAR </b></font>IValue   <font color="#000080">: </font>Integer<font color="#000080">;
                    </font><font color="#FF0000"><b>VAR </b></font>Error    <font color="#000080">: </font>Integer<font color="#000080">;
                    </font><font color="#FF0000"><b>VAR </b></font>Escape   <font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">,</font>J        <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Ch         <font color="#000080">: </font>Char<font color="#000080">;
    </font>Cursor     <font color="#000080">: </font>Char<font color="#000080">;
    </font>Dot        <font color="#000080">: </font>Char<font color="#000080">;
    </font>BLength    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>ClearIt    <font color="#000080">: </font>String80<font color="#000080">;
    </font>Worker     <font color="#000080">: </font>String80<font color="#000080">;
    </font>Printables <font color="#000080">: </font><font color="#FF0000"><b>SET OF </b></font>Char<font color="#000080">;
    </font>Lowercase  <font color="#000080">: </font><font color="#FF0000"><b>SET OF </b></font>Char<font color="#000080">;
    </font>Numerics   <font color="#000080">: </font><font color="#FF0000"><b>SET OF </b></font>Char<font color="#000080">;
    </font>CR         <font color="#000080">: </font>Boolean<font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
  </b></font>Printables <font color="#000080">:= [</font><font color="#800000">' '</font><font color="#000080">..</font><font color="#800000">'}'</font><font color="#000080">];               </font><font color="#008000"><i>{ Init sets }
  </i></font>Lowercase  <font color="#000080">:= [</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">];
  </font><font color="#FF0000"><b>IF </b></font>GetReal <font color="#FF0000"><b>THEN </b></font>Numerics <font color="#000080">:= [</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'e'</font><font color="#000080">]
    </font><font color="#FF0000"><b>ELSE </b></font>Numerics <font color="#000080">:= [</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];
  </font>Cursor <font color="#000080">:= </font><font color="#800000">'_'</font><font color="#000080">; </font>Dot <font color="#000080">:= </font><font color="#800000">'.'</font><font color="#000080">;
  </font>CR <font color="#000080">:= </font>False<font color="#000080">; </font>Escape <font color="#000080">:= </font>False<font color="#000080">;
  </font>FillChar<font color="#000080">(</font>ClearIt<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ClearIt<font color="#000080">),</font><font color="#800000">'.'</font><font color="#000080">);  </font><font color="#008000"><i>{ Fill the clear string  }
  </i></font>ClearIt<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>MaxLen<font color="#000080">);              </font><font color="#008000"><i>{ Set clear string to MaxLen }

                                { Convert numbers to string if required:  }
  </i></font><font color="#FF0000"><b>IF </b></font>Numeric <font color="#FF0000"><b>THEN               </b></font><font color="#008000"><i>{ Convert zero values to null string: }
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>GetReal <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>RValue <font color="#000080">= </font><font color="#800000">0.0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR
       </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>GetReal <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>IValue <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN </b></font>XString <font color="#000080">:= </font><font color="#800000">''
    </font><font color="#FF0000"><b>ELSE                        </b></font><font color="#008000"><i>{ Convert nonzero values to string equiv: }
      </i></font><font color="#FF0000"><b>IF </b></font>GetReal <font color="#FF0000"><b>THEN </b></font>Str<font color="#000080">(</font>RValue<font color="#000080">:</font>MaxLen<font color="#000080">,</font>XString<font color="#000080">)
        </font><font color="#FF0000"><b>ELSE </b></font>Str<font color="#000080">(</font>IValue<font color="#000080">:</font>MaxLen<font color="#000080">,</font>XString<font color="#000080">);

                                          </font><font color="#008000"><i>{ Truncate string value to MaxLen }
  </i></font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>XString<font color="#000080">) &gt; </font>MaxLen <font color="#FF0000"><b>THEN </b></font>XString<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>MaxLen<font color="#000080">);
  </font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">,</font>ClearIt<font color="#000080">,</font><font color="#800000">'|'</font><font color="#000080">);    </font><font color="#008000"><i>{ Draw the field  }
  </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>XString<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>XString<font color="#000080">)&lt;</font>MaxLen <font color="#FF0000"><b>THEN
    BEGIN
      </b></font>GotoXY<font color="#000080">(</font>X <font color="#000080">+ </font>Length<font color="#000080">(</font>XString<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">);
      </font>Write<font color="#000080">(</font>Cursor<font color="#000080">)                       </font><font color="#008000"><i>{ Draw the Cursor }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Worker <font color="#000080">:= </font>XString<font color="#000080">;      </font><font color="#008000"><i>{ Fill work string with input string     }

  </i></font><font color="#FF0000"><b>REPEAT                  </b></font><font color="#008000"><i>{ Until ESC or (CR) entered }
                          { Wait here for keypress:   }
    </i></font><font color="#FF0000"><b>WHILE NOT </b></font>KeyPressed <font color="#FF0000"><b>DO BEGIN </b></font><font color="#008000"><i>{NULL} </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;

    </font><font color="#FF0000"><b>IF </b></font>Ch <font color="#FF0000"><b>IN </b></font>Printables <font color="#FF0000"><b>THEN              </b></font><font color="#008000"><i>{ If Ch is printable... }
      </i></font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Worker<font color="#000080">) &gt;= </font>MaxLen <font color="#FF0000"><b>THEN </b></font>UhUh <font color="#FF0000"><b>ELSE
        IF </b></font>Numeric <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font>Numerics<font color="#000080">)) </font><font color="#FF0000"><b>THEN </b></font>UhUh <font color="#FF0000"><b>ELSE
          BEGIN
            IF </b></font>Ch <font color="#FF0000"><b>IN </b></font>Lowercase <font color="#FF0000"><b>THEN IF </b></font>Capslock <font color="#FF0000"><b>THEN </b></font>Ch <font color="#000080">:= </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>Ch<font color="#000080">)-</font><font color="#800000">32</font><font color="#000080">);
            </font>Worker <font color="#000080">:= </font>CONCAT<font color="#000080">(</font>Worker<font color="#000080">,</font>Ch<font color="#000080">);
            </font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>Worker<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Worker<font color="#000080">) &lt; </font>MaxLen <font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font>Cursor<font color="#000080">)
          </font><font color="#FF0000"><b>END
    ELSE   </b></font><font color="#008000"><i>{ If Ch is NOT printable... }
      </i></font><font color="#FF0000"><b>CASE </b></font>Ord<font color="#000080">(</font>Ch<font color="#000080">) </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">127 </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Worker<font color="#000080">) &lt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>UhUh <font color="#FF0000"><b>ELSE
                  BEGIN
                    </b></font>Delete<font color="#000080">(</font>Worker<font color="#000080">,</font>Length<font color="#000080">(</font>Worker<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
                    </font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>Worker<font color="#000080">,</font>Cursor<font color="#000080">);
                    </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Worker<font color="#000080">) &lt; </font>MaxLen<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font>Dot<font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

       </font><font color="#800000">13 </font><font color="#000080">: </font>CR <font color="#000080">:= </font>True<font color="#000080">;          </font><font color="#008000"><i>{ Carriage return }

       </i></font><font color="#800000">24 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN                </b></font><font color="#008000"><i>{ CTRL-X : Blank the field }
              </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>ClearIt<font color="#000080">);
              </font>Worker <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;      </font><font color="#008000"><i>{ Blank out work string }
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

       </font><font color="#800000">27 </font><font color="#000080">: </font>Escape <font color="#000080">:= </font>True<font color="#000080">;      </font><font color="#008000"><i>{ ESC }
       </i></font><font color="#FF0000"><b>ELSE </b></font>UhUh                 <font color="#008000"><i>{ CASE ELSE }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ CASE }

  </i></font><font color="#FF0000"><b>UNTIL </b></font>CR <font color="#FF0000"><b>OR </b></font>Escape<font color="#000080">;            </font><font color="#008000"><i>{ Get keypresses until (CR) or }
                                 { ESC pressed }
  </i></font>GotoXY<font color="#000080">(</font>X <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>ClearIt<font color="#000080">);
  </font>GotoXY<font color="#000080">(</font>X <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">); </font>Write<font color="#000080">(</font>Worker<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>CR <font color="#FF0000"><b>THEN                     </b></font><font color="#008000"><i>{ Don't update XString if ESC hit }
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>XString <font color="#000080">:= </font>Worker<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>Numeric <font color="#FF0000"><b>THEN            </b></font><font color="#008000"><i>{ Convert string to Numeric values }
        </i></font><font color="#FF0000"><b>CASE </b></font>GetReal <font color="#FF0000"><b>OF
          </b></font>True  <font color="#000080">: </font>Val<font color="#000080">(</font>Worker<font color="#000080">,</font>RValue<font color="#000080">,</font>Error<font color="#000080">);
          </font>False <font color="#000080">: </font>Val<font color="#000080">(</font>Worker<font color="#000080">,</font>IValue<font color="#000080">,</font>Error<font color="#000080">)
        </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{ CASE }
      </i></font><font color="#FF0000"><b>ELSE
        BEGIN
          </b></font>RValue <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
          </font>IValue <font color="#000080">:= </font><font color="#800000">0
        </font><font color="#FF0000"><b>END
    END
END</b></font><font color="#000080">;  </font><font color="#008000"><i>{ GETString }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
