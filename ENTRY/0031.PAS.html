<html>
<head><title> "How to readln longer than 255 chars" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

Q:  How can I readln() from a file when the lines are longer
than 255 bytes?

A:  ReadLn will accept an array [0..something] of Char as
buffer to put the read characters in and it will make a proper
zero-terminated char out of them. The only limitation is this:
the compiler needs to be able to figure out the size of the
buffer at compile time, which makes the use of a variable
declared as PChar and allocated at run-time impossible.

Workaround:
}

 </i></font><font color="#FF0000"><b>Type
   </b></font><font color="#008000"><i>{use longest line you may encounter here}
   </i></font>TLine <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1024</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; 

   </font>PLine <font color="#000080">= ^</font>TLine<font color="#000080">;

 </font><font color="#FF0000"><b>Var
   </b></font>pBuf<font color="#000080">: </font>PLine<font color="#000080">;
 ...
   </font>New<font color="#000080">( </font>pBuf <font color="#000080">);

 ...
   </font>ReadLn<font color="#000080">( </font>F<font color="#000080">, </font>pBuf<font color="#000080">^ );

</font><font color="#FF0000"><b>To </b></font>pass pBuf <font color="#FF0000"><b>to </b></font>functions that take a parameter <font color="#FF0000"><b>of type </b></font>Pchar<font color="#000080">, 
</font>use a typecast like PChar<font color="#000080">( </font>pBuf <font color="#000080">).

</font>Note<font color="#000080">:  </font>you can use a variable declared <font color="#FF0000"><b>as of type </b></font>TLine <font color="#FF0000"><b>or </b></font>an
equivalent <font color="#FF0000"><b>array of </b></font>char directly<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>course<font color="#000080">, </font>but I tend <font color="#FF0000"><b>to
</b></font>allocate anything larger than <font color="#800000">4 </font>bytes <font color="#FF0000"><b>on </b></font>the heap<font color="#000080">...
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENTRY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
