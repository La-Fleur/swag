<html>
<head><title> "Execute & Redirection" by MARK OUELLET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">------------------------------------------------------------------------

</font>Echo Flag <font color="#000080">:         </font>Permanent<font color="#000080">: </font>N       <font color="#FF0000"><b>Export</b></font><font color="#000080">: </font>N      Personal Read<font color="#000080">: </font>N

 BBS<font color="#000080">: </font><font color="#FF0000"><b>IN</b></font><font color="#000080">-</font>TECH         Conference<font color="#000080">: </font><font color="#FF0000"><b>PASCAL          </b></font>Imported<font color="#000080">: </font><font color="#800000">11</font><font color="#000080">/</font><font color="#800000">14</font><font color="#000080">/</font><font color="#800000">1991
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>DAVID HICKEY                    Num<font color="#000080">: </font><font color="#800000">1442       </font>Date<font color="#000080">: </font><font color="#800000">10</font><font color="#000080">/</font><font color="#800000">31</font><font color="#000080">/</font><font color="#800000">1991
</font>From<font color="#000080">: </font>MARK OUELLET                     Re<font color="#000080">: </font><font color="#800000">0          </font>Time<font color="#000080">: </font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">51 </font>pm
Subj<font color="#000080">: &gt;</font>NUL REDIRECTION               Prvt<font color="#000080">: </font>N          Read<font color="#000080">: </font>N

    <font color="#FF0000"><b>On </b></font><font color="#800000">27 </font>Oct <font color="#800000">91</font><font color="#000080">, </font>you<font color="#000080">, </font>David Hickey<font color="#000080">, </font><font color="#FF0000"><b>of </b></font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">261</font><font color="#000080">/</font><font color="#800000">1108.0 </font>wrote<font color="#000080">...

 </font>DH<font color="#000080">&gt; </font>From the DOS prompt<font color="#000080">, </font>I can redirect things easily<font color="#000080">.  </font>But when I <font color="#FF0000"><b>try </b></font>it <font color="#FF0000"><b>in 
 </b></font>DH<font color="#000080">&gt; </font>my <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>it doesn<font color="#800000">'t work at all.  Here'</font>s what I<font color="#800000">'m doing:
 </font>DH<font color="#000080">&gt; 
 </font>DH<font color="#000080">&gt; </font>EXEC <font color="#000080">(</font><font color="#800000">'C:\Pkzip.Exe'</font><font color="#000080">, </font><font color="#800000">'-o c:\ra\ra.zip c:\ra\ralogs\ra.log &gt;nul'</font><font color="#000080">);
 </font>DH<font color="#000080">&gt; 
 </font>DH<font color="#000080">&gt; </font>The problem <font color="#FF0000"><b>is </b></font>that the information from Pkzip <font color="#FF0000"><b>is not </b></font>being redirected 
 DH<font color="#000080">&gt; </font><font color="#FF0000"><b>to </b></font>NUL
 DH<font color="#000080">&gt; </font>like I want it <font color="#FF0000"><b>to</b></font><font color="#000080">.  </font>It<font color="#800000">'s obviously got to be something I'</font>m <font color="#FF0000"><b>not </b></font>doing 
 DH<font color="#000080">&gt; </font>right<font color="#000080">. </font>Anyone know what it <font color="#FF0000"><b>is</b></font><font color="#000080">?  </font>I<font color="#800000">'ve tried everything I can think of.

</font>David<font color="#000080">,
        </font>This might help you<font color="#000080">,

</font>Msg<font color="#800000">#</font><font color="#000080">:</font><font color="#800000">20994 </font><font color="#000080">*&gt; </font><font color="#FF0000"><b>PASCAL  </b></font>Echo <font color="#000080">&lt;*
</font><font color="#800000">03</font><font color="#000080">/</font><font color="#800000">17</font><font color="#000080">/</font><font color="#800000">89 03</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">:</font><font color="#800000">00
</font>From<font color="#000080">: </font>ROSS WENTWORTH
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>NORBERT LANGE
Subj<font color="#000080">: </font>REPLY <font color="#FF0000"><b>TO </b></font>MSG<font color="#800000"># 20986 </font><font color="#000080">(</font>RE<font color="#000080">: </font>REDIRECTING STDERR<font color="#000080">)
 &gt; </font>I<font color="#800000">'d appreciate seeing some code.  I'</font>ve tried this before<font color="#000080">,
 &gt; </font>using a couple different methods<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>couldn<font color="#800000">'t seem to get
 </font><font color="#000080">&gt; </font>DOS <font color="#FF0000"><b>to </b></font>like redirecting StdErr<font color="#000080">.  </font>I tried the <font color="#800000">$45 </font><font color="#000080">(</font>Duplicate
 <font color="#000080">&gt; </font><font color="#FF0000"><b>File </b></font>Handle<font color="#000080">) </font><font color="#FF0000"><b>function as </b></font>well <font color="#FF0000"><b>with </b></font>no success<font color="#000080">.

</font>Ok<font color="#000080">, </font>here<font color="#800000">'s a routine that can be easily modified to do the job. It replaces 
</font>EXEC from the DOS <font color="#FF0000"><b>unit and </b></font>checks the <font color="#000080">&quot;</font>command line<font color="#000080">&quot; </font><font color="#FF0000"><b>for </b></font>the redirection 
symbols <font color="#000080">(</font><font color="#800000">'&gt;' </font><font color="#FF0000"><b>and </b></font><font color="#800000">'&lt;'</font><font color="#000080">).  </font>One minor change <font color="#FF0000"><b>and </b></font>it will redirect STDERR <font color="#FF0000"><b>to </b></font>the 
<font color="#FF0000"><b>file </b></font><font color="#000080">(</font>see comment below<font color="#000080">).
</font><font color="#008000"><i>{=============================================================}
</i></font><font color="#FF0000"><b>Unit </b></font>Execute<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Procedure </b></font>Exec<font color="#000080">(</font>Path<font color="#000080">,</font>CmdLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ExtractFileName<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Line <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Index <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Delete<font color="#000080">(</font>Line<font color="#000080">,</font>Index<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Index <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Line<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>Index<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">)
    </font><font color="#FF0000"><b>Do </b></font>Delete<font color="#000080">(</font>Line<font color="#000080">,</font>Index<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Index <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Line<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>Index<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
    </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>Line<font color="#000080">[</font>Index<font color="#000080">];
    </font>Delete<font color="#000080">(</font>Line<font color="#000080">,</font>Index<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>ExtractFileName <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CloseHandle<font color="#000080">(</font>Handle <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  With </b></font>Regs <font color="#FF0000"><b>Do
  Begin
    </b></font>AH <font color="#000080">:= </font><font color="#800000">$3E</font><font color="#000080">;
    </font>BX <font color="#000080">:= </font>Handle<font color="#000080">;
    </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Duplicate<font color="#000080">(</font>SourceHandle <font color="#000080">: </font>Word<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>TargetHandle <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  With </b></font>Regs <font color="#FF0000"><b>Do
  Begin
    </b></font>AH <font color="#000080">:= </font><font color="#800000">$45</font><font color="#000080">;
    </font>BX <font color="#000080">:= </font>SourceHandle<font color="#000080">;
    </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
    </font>TargetHandle <font color="#000080">:= </font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ForceDuplicate<font color="#000080">(</font>SourceHandle <font color="#000080">: </font>Word<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>TargetHandle <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  With </b></font>Regs <font color="#FF0000"><b>Do
  Begin
    </b></font>AH <font color="#000080">:= </font><font color="#800000">$46</font><font color="#000080">;
    </font>BX <font color="#000080">:= </font>SourceHandle<font color="#000080">;
    </font>CX <font color="#000080">:= </font>TargetHandle<font color="#000080">;
    </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
    </font>TargetHandle <font color="#000080">:= </font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Exec<font color="#000080">(</font>Path<font color="#000080">,</font>CmdLine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>StdIn   <font color="#000080">: </font>Word<font color="#000080">;
  </font>Stdout  <font color="#000080">: </font>Word<font color="#000080">;
  </font>Index   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>FName   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font>InFile  <font color="#000080">: </font>Text<font color="#000080">;
  </font>OutFile <font color="#000080">: </font>Text<font color="#000080">;

  </font>InHandle  <font color="#000080">: </font>Word<font color="#000080">;
  </font>OutHandle <font color="#000080">: </font>Word<font color="#000080">;
         </font><font color="#008000"><i>{ ===============&gt;&gt;&gt;&gt; }   { change below for STDERR }
</i></font><font color="#FF0000"><b>Begin
  </b></font>StdIn <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>StdOut <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                    </font><font color="#008000"><i>{ change to 2 for StdErr       }
  </i></font>Duplicate<font color="#000080">(</font>StdIn<font color="#000080">,</font>InHandle<font color="#000080">);      </font><font color="#008000"><i>{ duplicate standard input     }
  </i></font>Duplicate<font color="#000080">(</font>StdOut<font color="#000080">,</font>OutHandle<font color="#000080">);    </font><font color="#008000"><i>{ duplicate standard output    }
  </i></font>Index <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'&gt;'</font><font color="#000080">,</font>CmdLine<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Index <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then               </b></font><font color="#008000"><i>{ check for output redirection }
  </i></font><font color="#FF0000"><b>Begin
    </b></font>FName <font color="#000080">:= </font>ExtractFileName<font color="#000080">(</font>CmdLine<font color="#000080">,</font>Index<font color="#000080">);  </font><font color="#008000"><i>{ get output file name }
    </i></font>Assign<font color="#000080">(</font>OutFile<font color="#000080">,</font>FName<font color="#000080">);                    </font><font color="#008000"><i>{ open a text file      }
    </i></font>Rewrite<font color="#000080">(</font>OutFile<font color="#000080">);                         </font><font color="#008000"><i>{ .. for output         }
    </i></font>ForceDuplicate<font color="#000080">(</font>TextRec<font color="#000080">(</font>OutFile<font color="#000080">).</font>Handle<font color="#000080">,</font>StdOut<font color="#000080">);</font><font color="#008000"><i>{ make output same }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Index <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'&lt;'</font><font color="#000080">,</font>CmdLine<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Index <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then               </b></font><font color="#008000"><i>{ check for input redirection }
  </i></font><font color="#FF0000"><b>Begin
    </b></font>FName <font color="#000080">:= </font>ExtractFileName<font color="#000080">(</font>CmdLine<font color="#000080">,</font>Index<font color="#000080">);  </font><font color="#008000"><i>{ get input file name }
    </i></font>Assign<font color="#000080">(</font>InFile<font color="#000080">,</font>FName<font color="#000080">);                     </font><font color="#008000"><i>{ open a text file    }
    </i></font>Reset<font color="#000080">(</font>InFile<font color="#000080">);                            </font><font color="#008000"><i>{ for input           }
    </i></font>ForceDuplicate<font color="#000080">(</font>TextRec<font color="#000080">(</font>InFile<font color="#000080">).</font>Handle<font color="#000080">,</font>StdIn<font color="#000080">);  </font><font color="#008000"><i>{ make input same }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>DOS<font color="#000080">.</font>Exec<font color="#000080">(</font>Path<font color="#000080">,</font>CmdLine<font color="#000080">);           </font><font color="#008000"><i>{ run EXEC }
  </i></font>ForceDuplicate<font color="#000080">(</font>InHandle<font color="#000080">,</font>StdIn<font color="#000080">);   </font><font color="#008000"><i>{ put standard input back to keyboard }
  </i></font>ForceDuplicate<font color="#000080">(</font>OutHandle<font color="#000080">,</font>StdOut<font color="#000080">); </font><font color="#008000"><i>{ put standard output back to screen  }
  </i></font>CloseHandle<font color="#000080">(</font>InHandle<font color="#000080">);            </font><font color="#008000"><i>{ close the redirected input file     }
  </i></font>CloseHandle<font color="#000080">(</font>OutHandle<font color="#000080">);           </font><font color="#008000"><i>{ close the redirected output file    }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{===============================================================}

</i></font>Use it exactly <font color="#FF0000"><b>as </b></font>you would the normal EXEC <font color="#FF0000"><b>procedure</b></font><font color="#000080">:

  </font>Exec<font color="#000080">(</font><font color="#800000">'MASM.EXE'</font><font color="#000080">,</font><font color="#800000">'mystuff.asm'</font><font color="#000080">);

</font><font color="#FF0000"><b>To </b></font>activate redirection simply add the redirection symbols<font color="#000080">, </font>etc<font color="#000080">:

  </font>Exec<font color="#000080">(</font><font color="#800000">'MASM.EXE'</font><font color="#000080">,</font>mystuff<font color="#000080">.</font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">&gt;err.lst');


One note of caution.  This routine temporarily uses extra handles.  It'
s either
two or four more.  The various books I have are not clear as two whether 
duplicated handles 'count' or not. My guess is yes.  If you don't plan on 
redirecting STDIN then remove all the code for duplicating it to cut your
handle overhead in half.

                                    Ross Wentworth

+++ FD 2.00
 Origin: St Dymphna's Retreat via Torrance BBS 213-370-9027 (1:102/345.1)

        Best regards,
        Mark Ouellet.


--- ME2
 * Origin: The Doctor's Tardis, A point in time!! (Fidonet 1:240/1.4)
==============================================================================
 BBS: &reg;&reg; The Information and Technology Exchan
  To: BUTCH ADAMS                  Date: 12-10&Auml;91 (18:00)
From: RUSS PARKS                 Number: 3982   [101] PASCAL
Subj: EXEC()                     Status: Public
------------------------------------------------------------------------------
* In a bleating, agonizing plea to All, Butch Adams groaned:

BA&gt;       I'm wondering if I can get some insight as to how to
BA&gt;use the Exec() command in TP6. What I'm trying to do is this:
BA&gt; Exec('Type Filename|sort &gt; newfilename', '');
BA&gt;I've even tried this:
BA&gt; Exec('Type', 'filename|sort &gt; newfilename');

 Close, but no cigar :-) Try something like this:
        Exec('command.com', '/c type filename | sort &gt; newfilename');

 The first parameter is the path to the program to be run. In this
case, 'TYPE' is an internal DOS command so you need to run
COMMAND.COM. The second parameter is a string with the command
line arguments you want to pass to the program.
  P.S.: The '/c' part of the parameters tells COMMAND.COM to execute
the command, then exit back to the program that originally
called the COMMAND.COM. It's like loading COMMAND.COM, running
a program, then typing 'EXIT'.
Besta'Luck,
Russ

---
 * Origin: Objectively.Speak('Turbo Pascal 6.0, YEAH!'); (1:170/212)
==============================================================================
 BBS: &reg;&reg; The Information and Technology Exchan
  To: BUTCH ADAMS                  Date: 12-10&Auml;91 (21:07)
From: MIKE COPELAND              Number: 4000   [101] PASCAL
Subj: EXEC()                     Status: Public
------------------------------------------------------------------------------
 BA&gt;       I'm wondering if I can get some insight as to how to use the
 BA&gt;Exec() command in TP6. What I'm trying to do is this:

 BA&gt; Exec('Type Filename|sort &gt; newfilename', '');

 BA&gt;I've even tried this:

 BA&gt; Exec('Type', 'filename|sort &gt; newfilename');

 BA&gt;But still no result. Are we able to execute internal commands from
 BA&gt;within a TP program? I've tried loading Command.Com first but all I get
 BA&gt;is the shell to come up and sit there with a C&gt; staring back at me. I
 BA&gt;would appreciate any help with this.

   The process to execute any DOS-callable program/command is more than
you're doing/showing here. Try the following:

</font><font color="#008000"><i>{$M 4096,0,0}  { allocate space for the child process }

  </i></font><font color="#FF00FF">SwapVectors;
  Exec (GetEnv('COMSPEC'),'/C Type filename|sort &gt; newfile');
  SwapVectors;
  if DosError &gt; 0 then  </font><font color="#008000"><i>{ check the result of Exec }
    </i></font><font color="#FF00FF">You_Have_A_Problem;
  if DosExitCode &lt;&gt; 0 then
    You_Have_A_Different_Problem;
  </font><font color="#008000"><i>{ If you get here, everything's okay... }

   </i></font><font color="#FF00FF">Read the manual about SwapVectors, DosError, DosExitCode, GetEnv,
Exec, the $M parameter, and all the stuff you don't understand here...


--- msged 2.07
 * Origin: Hello, Keyboard, my old friend... (1:114/18.10)
==============================================================================
 BBS: &reg;&reg; The Information and Technology Exchan
  To: ANDREW PARK                  Date: 12-10&Auml;91 (21:15)
From: MIKE COPELAND              Number: 4001   [101] PASCAL
Subj: PASCAL                     Status: Public
------------------------------------------------------------------------------
 AP&gt;It's quite simple.
 AP&gt;Here's an example
 AP&gt;</font><font color="#008000"><i>{$M,1025,0,0}  </i></font><font color="#FF00FF">&lt;-- I don't know what this means but you need anyways

   Well, it's very important: it states how much Stack, Heap_Min, and
Heap_Max space you're reserving for the program to use (and how
much space you're leaving for the child process to execute in).
The last (2nd 0) is the most important, since failing to reduce
this from the default of ALL memory will PREVENT the Exec from
having any memory to do its work within. So, setting it to 0
will say &quot;reserve ALL of available memory (except for what's
used by my program itself) for the DOS call I'm going to make
from within my program&quot;.
   If you don't do this, it defaults to 640K - meaning &quot;reserve NO
memory for the exec&quot;.

 AP&gt;Program Copying;
 AP&gt;Uses dos;
 AP&gt;begin
 AP&gt;  exec ('Command.com','copy a:*.* b:');
      Exec (GetEnv('COMSPEC'),'/C copy a:* b:*');
 AP&gt;</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
 </font>AP<font color="#000080">&gt;</font>Something like that<font color="#000080">.  </font>See the manual <font color="#FF0000"><b>for </b></font>Exec section<font color="#000080">.

   </font>You should also wrap that Exec call within a pair <font color="#FF0000"><b>of </b></font>SwapVectors
statements<font color="#000080">...</font>before <font color="#FF0000"><b>and </b></font>after<font color="#000080">. </font>Furthermore<font color="#000080">, </font>it<font color="#800000">'s a good idea to
</font>check DosError <font color="#FF0000"><b>and </b></font>DosExitCode after the action<font color="#000080">, </font>so see <font color="#FF0000"><b>if </b></font>any
problems occurred<font color="#000080">.
   </font>Exec <font color="#FF0000"><b>is </b></font>very useful<font color="#000080">, </font>but it carries a lot <font color="#FF0000"><b>of </b></font><font color="#000080">&quot;</font>baggage<font color="#000080">&quot; </font>when used<font color="#000080">...

--- </font>msged <font color="#800000">2.07
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Hello<font color="#000080">, </font>Keyboard<font color="#000080">, </font>my old friend<font color="#000080">... (</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">114</font><font color="#000080">/</font><font color="#800000">18.10</font><font color="#000080">)
==============================================================================
 </font>BBS<font color="#000080">: &reg;&reg; </font>The Information <font color="#FF0000"><b>and </b></font>Technology Exchan
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>KEVIN HIGGINS                Date<font color="#000080">: </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">04</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">09</font><font color="#000080">:</font><font color="#800000">58</font><font color="#000080">)
</font>From<font color="#000080">: </font>MARK OUELLET               Number<font color="#000080">: </font><font color="#800000">4088   </font><font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>PASCAL
</b></font>Subj<font color="#000080">: </font>RE<font color="#000080">: </font>HEAP KNOWLEDGE         Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
    </font><font color="#FF0000"><b>On </b></font><font color="#800000">29 </font>Dec <font color="#800000">91</font><font color="#000080">, </font>you<font color="#000080">, </font>Kevin Higgins<font color="#000080">, </font><font color="#FF0000"><b>of </b></font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">128</font><font color="#000080">/</font><font color="#800000">74.0 </font>wrote<font color="#000080">...

 </font>KH<font color="#000080">&gt; </font>I still don<font color="#800000">'t understand full use of the {$M} compiler directive.
 </font>KH<font color="#000080">&gt; </font>The <font color="#FF0000"><b>Pascal </b></font>tome I have says nothing other than <font color="#FF0000"><b>if </b></font>you don<font color="#800000">'t use New() or
 </font>KH<font color="#000080">&gt; </font>GetMem<font color="#000080">() </font><font color="#FF0000"><b>to set </b></font>the HeapMin <font color="#FF0000"><b>and </b></font>HeapMax <font color="#FF0000"><b>to </b></font><font color="#800000">0. </font>But it never says what <font color="#FF0000"><b>to
 </b></font>KH<font color="#000080">&gt; </font><font color="#FF0000"><b>set </b></font>it <font color="#FF0000"><b>to if </b></font>you <font color="#FF0000"><b>DO </b></font>you New <font color="#FF0000"><b>or </b></font>GetMem<font color="#000080">. </font>Nor could I find any reference <font color="#FF0000"><b>on
 </b></font>KH<font color="#000080">&gt; </font>ideal settings <font color="#FF0000"><b>for </b></font>a small <font color="#FF0000"><b>program </b></font>which Exec<font color="#800000">'s another fairly small
 </font>KH<font color="#000080">&gt; </font><font color="#FF0000"><b>program</b></font><font color="#000080">....

</font>Kevin<font color="#000080">,
        </font>New<font color="#000080">() </font><font color="#FF0000"><b>and </b></font>GetMem<font color="#000080">() </font>are used <font color="#FF0000"><b>to </b></font>allocate space
<font color="#000080">(</font>memory<font color="#000080">) </font>off the heap <font color="#000080">(</font>That which <font color="#FF0000"><b>is </b></font>left <font color="#FF0000"><b>of </b></font>the <font color="#800000">640 </font>K <font color="#FF0000"><b>of
</b></font>dos memory after your <font color="#FF0000"><b>program is </b></font>loaded <font color="#FF0000"><b>and </b></font>DOS <font color="#FF0000"><b>and </b></font>your
TSRs ect<font color="#000080">...) </font><font color="#FF0000"><b>for </b></font>variables that are created AT RUNTIME<font color="#000080">.
</font>Variables you declare <font color="#FF0000"><b>in </b></font>the usual way ie<font color="#000080">: </font><font color="#FF0000"><b>Var </b></font>X <font color="#000080">: </font>Integer<font color="#000080">;
</font>allready have space allocated <font color="#FF0000"><b>to </b></font>them<font color="#000080">.

        </font>The heap <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to </b></font>allocate memory <font color="#FF0000"><b>to dynamic
</b></font>variables ie<font color="#000080">: </font>variables accessed through the use <font color="#FF0000"><b>of
</b></font>pointers<font color="#000080">. </font>These need <font color="#FF0000"><b>to </b></font>have memory allocated <font color="#FF0000"><b>to </b></font>them
<font color="#000080">(</font>Unless you are using the pointer <font color="#FF0000"><b>to </b></font>access a region <font color="#FF0000"><b>of
</b></font>memory that allready <font color="#FF0000"><b>contains </b></font>information such <font color="#FF0000"><b>as </b></font>the
keyboard buffer etc<font color="#000080">... </font>those allready have memory allocated
<font color="#FF0000"><b>to </b></font>them so you need NO MORE MEMORY <font color="#FF0000"><b>TO </b></font>USE THEM<font color="#000080">.) </font>Those that
<font color="#000080">*</font>YOU<font color="#000080">* </font>create such <font color="#FF0000"><b>as </b></font>linked lists need memory<font color="#000080">. </font>Your <font color="#FF0000"><b>program
</b></font>when compiled will only allocate <font color="#800000">4 </font>bytes <font color="#FF0000"><b>for </b></font>each pointer
<font color="#000080">(</font>Pointers need <font color="#800000">2 </font>words<font color="#000080">, </font>one <font color="#FF0000"><b>for </b></font>the segment<font color="#000080">, </font>one <font color="#FF0000"><b>for </b></font>the
offset <font color="#FF0000"><b>in </b></font>that segment<font color="#000080">) </font>thus the <font color="#800000">4 </font>bytes<font color="#000080">.

</font><font color="#FF0000"><b>As </b></font>a rule <font color="#FF0000"><b>of </b></font>thumb<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you don<font color="#800000">'t create dynamic variables
</font><font color="#FF0000"><b>then </b></font>you can <font color="#FF0000"><b>set </b></font>the <font color="#800000">$</font>M <font color="#FF0000"><b>to</b></font><font color="#000080">: </font><font color="#008000"><i>{$M 16384, 0, 0} </i></font>which <font color="#FF0000"><b>is </b></font>the
minimum<font color="#000080">.

</font><font color="#008000"><i>{$MStack space, minimum heap required to run, Max heap needed}

</i></font>Stack space <font color="#FF0000"><b>is </b></font>the memory needed <font color="#FF0000"><b>to </b></font>hold the stack <font color="#FF0000"><b>of </b></font>your
<font color="#FF0000"><b>program</b></font><font color="#000080">, </font>each time you call a <font color="#FF0000"><b>function or procedure </b></font>from
another one<font color="#000080">, </font>the old adress <font color="#FF0000"><b>is </b></font>pushed onto the stack<font color="#000080">, </font>it
will pulled off when the called <font color="#FF0000"><b>procedure </b></font>finishes <font color="#FF0000"><b>to </b></font>find
<font color="#FF0000"><b>out </b></font>where <font color="#FF0000"><b>to </b></font>go back <font color="#FF0000"><b>and </b></font>continue executing<font color="#000080">. </font>Local
variables<font color="#000080">, </font>parameters are also saved <font color="#FF0000"><b>on </b></font>the stack so they
are <font color="#FF0000"><b>not </b></font>lost <font color="#FF0000"><b>or </b></font>modified <font color="#FF0000"><b>while </b></font>the other <font color="#FF0000"><b>procedure is
</b></font>running<font color="#000080">.

</font>So <font color="#FF0000"><b>if </b></font>you have recursive procedures <font color="#000080">(</font>procedures that call
themselfes<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>use lots <font color="#FF0000"><b>of </b></font>parameters you could <font color="#FF0000"><b>set </b></font>a large
stack<font color="#000080">. </font>you will find this <font color="#FF0000"><b>out </b></font>through trial <font color="#FF0000"><b>and </b></font>error<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>it
doesn<font color="#800000">'t run properly and halts with a *STACK OVERFLOW* error
</font><font color="#000080">(</font>TP runtime error <font color="#800000">202</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>you know you need <font color="#FF0000"><b>to </b></font>increase
the stack space allocated <font color="#FF0000"><b>to </b></font>your <font color="#FF0000"><b>program</b></font><font color="#000080">.

</font>The second parameter <font color="#FF0000"><b>is </b></font>use <font color="#FF0000"><b>IF </b></font>you create <font color="#FF0000"><b>dynamic </b></font>variables<font color="#000080">,
</font>it tells TP you need at least this much heap memory free <font color="#FF0000"><b>to
</b></font>run correctly <font color="#FF0000"><b>and </b></font>that it should return <font color="#FF0000"><b>to </b></font>DOS <font color="#FF0000"><b>with </b></font>an error
<font color="#FF0000"><b>if </b></font>at least that much <font color="#FF0000"><b>is not </b></font>free when you <font color="#FF0000"><b>try to </b></font>load your
<font color="#FF0000"><b>program</b></font><font color="#000080">.

</font>The last paramater <font color="#FF0000"><b>is </b></font>the Maximum heap memory you expect <font color="#FF0000"><b>to
</b></font>use<font color="#000080">, </font>it can be calculated <font color="#FF0000"><b>if </b></font>you know how much you are going
<font color="#FF0000"><b>to </b></font>use like a big <font color="#FF0000"><b>array</b></font><font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you are using linked lists<font color="#000080">,
</font>which can <font color="#FF0000"><b>not </b></font>allways be evaluated <font color="#FF0000"><b>as to </b></font>how many items the
list will contain<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>you might decide <font color="#FF0000"><b>to </b></font>use it all<font color="#000080">.
</font>Setting the <font color="#800000">3</font>rd parameter <font color="#FF0000"><b>to </b></font><font color="#800000">655360. </font>This won<font color="#800000">'t leave any
</font>room <font color="#FF0000"><b>to </b></font>EXEC another <font color="#FF0000"><b>program </b></font>though<font color="#000080">.

</font>So <font color="#FF0000"><b>if </b></font>you intend <font color="#FF0000"><b>to </b></font>run another <font color="#FF0000"><b>program </b></font>from yours<font color="#000080">, </font>say
running PKUNZIP from a TP <font color="#FF0000"><b>program of </b></font>yours<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>you should
<font color="#FF0000"><b>set </b></font>Maximum Heap <font color="#FF0000"><b>to </b></font>a value lower than <font color="#800000">655360. </font><font color="#FF0000"><b>If </b></font>you know
PKUNZIP needs <font color="#800000">55</font>k <font color="#FF0000"><b>to </b></font>run without problems <font color="#FF0000"><b>then </b></font>you could
simply say<font color="#000080">:

        </font><font color="#800000">655360 </font><font color="#000080">- (</font><font color="#800000">55 </font><font color="#000080">* </font><font color="#800000">1024</font><font color="#000080">) = </font><font color="#800000">599040

</font><font color="#FF0000"><b>and set </b></font><font color="#800000">$</font>M <font color="#FF0000"><b>to

</b></font><font color="#008000"><i>{$M 16384, 0, 599040} </i></font>this will ensure you have at least <font color="#800000">55</font>k
free <font color="#FF0000"><b>for </b></font>PKUNZIP yet giving you the maximum heap space at
the same time<font color="#000080">.

</font><font color="#FF0000"><b>As </b></font>allways <font color="#FF0000"><b>if </b></font>you don<font color="#800000">'t use dynamic variables at all don'</font>t
bother <font color="#FF0000"><b>with </b></font>it simply use

<font color="#008000"><i>{$M 16384, 0, 0} </i></font><font color="#FF0000"><b>and </b></font>you will allways have enough memory <font color="#FF0000"><b>to
</b></font>run other programs from your TP programs <font color="#000080">(</font>Unless you don<font color="#800000">'t
</font>have enough memory <font color="#FF0000"><b>to </b></font>run them from DOS <font color="#FF0000"><b>to begin with </b></font><font color="#000080">;-) )


        </font>Best regards<font color="#000080">,
        </font><font color="#FF0000"><b>and </b></font>a very Happy New Year
        Mark Ouellet<font color="#000080">.


--- </font>ME2
 <font color="#000080">* </font>Origin<font color="#000080">: </font>BaseBall <font color="#FF0000"><b>for </b></font>Windows<font color="#000080">, </font>use the disks <font color="#FF0000"><b>as </b></font>bases <font color="#000080">;-) (</font>Fidonet <font color="#800000">1</font><font color="#000080">:</font><font color="#800000">240</font><font color="#000080">/</font><font color="#800000">1.4</font><font color="#000080">)
==============================================================================
 </font>BBS<font color="#000080">: &reg;&reg; </font>The Info<font color="#000080">-</font>Tech BBS <font color="#000080">&macr;&macr;
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>SHANE RUSSO                  Date<font color="#000080">: </font><font color="#800000">01</font><font color="#000080">-</font><font color="#800000">24</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">15</font><font color="#000080">:</font><font color="#800000">00</font><font color="#000080">)
</font>From<font color="#000080">: </font>MIKE COPELAND              Number<font color="#000080">: </font><font color="#800000">5922   </font><font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#800000">$</font>_PASCAL
Subj<font color="#000080">: </font>TP <font color="#800000">6.0 </font><font color="#000080">-- </font>MEMORY ALLOCATI  Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
 </font>SR<font color="#000080">&gt;    </font>Could anyone inform me how <font color="#FF0000"><b>to </b></font>use the <font color="#800000">$</font>M directive correctly<font color="#000080">, </font><font color="#FF0000"><b>and
 </b></font>SR<font color="#000080">&gt;    </font>what it does exactly<font color="#000080">?

 </font>SR<font color="#000080">&gt;    </font>Also<font color="#000080">, </font>what the stack size<font color="#000080">, </font>heap min <font color="#FF0000"><b>and </b></font>heap max are<font color="#000080">? (</font>How <font color="#FF0000"><b>do </b></font>you
 SR<font color="#000080">&gt;    </font>calculate the stack size<font color="#000080">, </font>heap min <font color="#FF0000"><b>and </b></font>heap max<font color="#000080">)

   </font>There <font color="#FF0000"><b>is </b></font>no <font color="#FF0000"><b>absolute</b></font><font color="#000080">, </font>exact answer <font color="#FF0000"><b>to </b></font>this question<font color="#000080">, </font>since every TP
<font color="#FF0000"><b>program </b></font>has different characteristics <font color="#FF0000"><b>and </b></font>requirements<font color="#000080">.
</font>However<font color="#000080">, </font>I will <font color="#FF0000"><b>try to </b></font>give you <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>others<font color="#000080">) </font>some basics<font color="#000080">, </font>from
which you can probably adjust <font color="#FF0000"><b>and </b></font>use <font color="#FF0000"><b>as </b></font>you learn what<font color="#800000">'s right
</font><font color="#FF0000"><b>for </b></font>_you_ <font color="#000080">(</font>every programmer has different styles<font color="#000080">, </font>which also
affect the way the <font color="#800000">$</font>M <font color="#FF0000"><b>is </b></font>used<font color="#000080">):

  </font><font color="#008000"><i>{$M Stack,Heap_Min,Heap_Max}

   </i></font>The Stack <font color="#FF0000"><b>is </b></font>used within your <font color="#FF0000"><b>program for </b></font>calls <font color="#FF0000"><b>to </b></font>subprograms
<font color="#000080">(</font>functions <font color="#FF0000"><b>and </b></font>procedures<font color="#000080">). </font>Its size <font color="#FF0000"><b>is </b></font>dependent <font color="#FF0000"><b>on </b></font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font>how
deep your calls go <font color="#000080">(</font><font color="#FF0000"><b>or </b></font>recurse<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font>how much parameter <font color="#FF0000"><b>and
</b></font>local data <font color="#FF0000"><b>is </b></font>referenced during these calls<font color="#000080">. </font>The worst <font color="#FF0000"><b>case
</b></font>I<font color="#800000">'ve encountered is a recursive sort of strings, where each
</font>level <font color="#FF0000"><b>of </b></font>call <font color="#FF0000"><b>requires </b></font>all the resident data <font color="#FF0000"><b>of </b></font>the routine <font color="#FF0000"><b>and
</b></font>the parameters passed <font color="#000080">(</font><font color="#FF0000"><b>string </b></font>data being so big<font color="#000080">) </font>are saved <font color="#FF0000"><b>on
</b></font>the Stack <font color="#000080">- </font>too many levels <font color="#FF0000"><b>of </b></font>such action will exceed the max<font color="#000080">.
</font>available Stack value<font color="#000080">, </font><font color="#800000">64</font>K<font color="#000080">.
   </font>So<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you<font color="#800000">'re not making heavily-nested (or recursive) calls in your
</font><font color="#FF0000"><b>program</b></font><font color="#000080">, </font>you won<font color="#800000">'t need much Stack space - 8192 is probably plenty.

   </font>Heap <font color="#FF0000"><b>is </b></font>data _you_ explicitly ask <font color="#FF0000"><b>for </b></font><font color="#000080">(</font>unlike the implicit data used
by subprogram calls<font color="#000080">) - </font>by New<font color="#000080">, </font>GetMem <font color="#000080">(</font><font color="#FF0000"><b>in </b></font>TP<font color="#000080">), </font><font color="#FF0000"><b>or </b></font>by calling
<font color="#FF0000"><b>library </b></font>routines which <font color="#FF0000"><b>do </b></font><font color="#000080">(</font>therefore<font color="#000080">, </font>you<font color="#800000">'re not always in
</font>control <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>if </b></font>you<font color="#800000">'re using subroutine libraries you didn'</font>t
create<font color="#000080">). </font>The two parameters stated <font color="#FF0000"><b>in </b></font>the <font color="#800000">$</font>M are <font color="#FF0000"><b>for </b></font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font>the
minimum value you want <font color="#FF0000"><b>to </b></font>reserve <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font>the maximum you want <font color="#FF0000"><b>to </b></font>allow<font color="#000080">.
   </font>I don<font color="#800000">'t know a good reason to ever use any value &gt; 0 for the
</font>Heap_Min parameter<font color="#000080">, </font>since the runtime will allocate what<font color="#800000">'s
</font>needed <font color="#000080">(</font>providing the Heap_Max still has something left<font color="#000080">) -
</font>perhaps performance<font color="#000080">. </font>So<font color="#000080">, </font>it<font color="#800000">'s the Heap_Max that'</font>s critical <font color="#FF0000"><b>for
</b></font>your consideration<font color="#000080">.
   </font>I see <font color="#800000">2 </font>distinct things here<font color="#000080">, </font>which are <font color="#FF0000"><b>in </b></font>conflict <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>thus
require management <font color="#FF0000"><b>of </b></font>this parameter<font color="#000080">): </font><font color="#FF0000"><b>dynamic </b></font>memory use <font color="#FF0000"><b>in
</b></font>your <font color="#FF0000"><b>program</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>use <font color="#FF0000"><b>of </b></font>the Exec <font color="#FF0000"><b>procedure to </b></font>spawn a child
process<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you don<font color="#800000">'t ever do one of these things, then you have
</font>maximum use <font color="#FF0000"><b>of </b></font>the other<font color="#000080">; </font>it<font color="#800000">'s that simple 8&lt;}}.
   </font>However <font color="#000080">(!), </font>doing this <font color="#FF0000"><b>is not </b></font>simple<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you<font color="#800000">'re doing anything
</font>sophistocated <font color="#FF0000"><b>with </b></font>TP<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>instance<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you must use data <font color="#000080">&gt;</font><font color="#800000">64</font>K<font color="#000080">,
</font>you<font color="#800000">'ve _got_ to use pointers - which implies dynamic memory
</font>allocation <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>consumes the Heap<font color="#000080">. </font><font color="#FF0000"><b>If</b></font><font color="#000080">, </font>OTOH<font color="#000080">, </font>you Exec <font color="#FF0000"><b>to </b></font>DOS <font color="#FF0000"><b>to
</b></font>run other programs <font color="#FF0000"><b>or </b></font>DOS calls from within your <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>you
must leave sufficient memory <font color="#FF0000"><b>for </b></font>DOS <font color="#FF0000"><b>to </b></font>load that other
<font color="#FF0000"><b>program</b></font><font color="#000080">, </font>etc<font color="#000080">. </font>This<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>course<font color="#000080">, </font>depends <font color="#FF0000"><b>on </b></font>what you<font color="#800000">'re Exec-ing.
   </font><font color="#FF0000"><b>In </b></font>either <font color="#FF0000"><b>case</b></font><font color="#000080">, </font>your <font color="#FF0000"><b>program </b></font>logic <font color="#FF0000"><b>and </b></font>application must determine
how much Heap_Max <font color="#FF0000"><b>to </b></font>reserve<font color="#000080">. </font>The <font color="#FF0000"><b>default is </b></font><font color="#800000">640</font>K <font color="#000080">(</font>all <font color="#FF0000"><b>of
</b></font>conventional memory<font color="#000080">), </font>which prevents _any_ child process
Exec<font color="#000080">-</font>ing<font color="#000080">. </font>This <font color="#FF0000"><b>default </b></font>will allow maximum possible use <font color="#FF0000"><b>of
dynamic </b></font>memory <font color="#000080">(</font>New<font color="#000080">, </font>GetMem<font color="#000080">); </font>any need <font color="#FF0000"><b>to </b></font>Exec will require a
reduced value <font color="#FF0000"><b>for </b></font>Heap_Max<font color="#000080">.
   </font>I often <font color="#FF0000"><b>do </b></font>a bit <font color="#FF0000"><b>of </b></font>both <font color="#FF0000"><b>in </b></font>my programs<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>I typically use the
following <font color="#800000">$</font>M parameter<font color="#000080">:

   </font><font color="#008000"><i>{$M 8192,0,128000}

</i></font><font color="#FF0000"><b>and </b></font>I change either Stack <font color="#FF0000"><b>or </b></font>Heap_Max <font color="#FF0000"><b>as </b></font>I encounter runtime errors
during development<font color="#000080">. </font>Everyone must <font color="#FF0000"><b>do </b></font>the same<font color="#000080">, </font><font color="#FF0000"><b>for </b></font>the reasons
I stated above<font color="#000080">.
   </font>Note that you _won<font color="#800000">'t_ be able to play with this during development
</font><font color="#FF0000"><b>in </b></font>the IDE<font color="#000080">, </font>since that<font color="#800000">'s a program already consuming a LOT of
</font>available memory<font color="#000080">.
   </font>Hope I made some sense<font color="#000080">/</font>cleared up some confusion<font color="#000080">/</font>helped<font color="#000080">.


--- </font>msged <font color="#800000">2.07
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Hello<font color="#000080">, </font>Keyboard<font color="#000080">, </font>my old friend<font color="#000080">... (</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">114</font><font color="#000080">/</font><font color="#800000">18.10</font><font color="#000080">)


------------------------------------------------------------------------

</font>Echo Flag <font color="#000080">:         </font>Permanent<font color="#000080">: </font>N       <font color="#FF0000"><b>Export</b></font><font color="#000080">: </font>N      Personal Read<font color="#000080">: </font>N

 BBS<font color="#000080">: </font><font color="#FF0000"><b>IN</b></font><font color="#000080">-</font>TECH         Conference<font color="#000080">: </font><font color="#FF0000"><b>PASCAL          </b></font>Imported<font color="#000080">: </font><font color="#800000">11</font><font color="#000080">/</font><font color="#800000">11</font><font color="#000080">/</font><font color="#800000">1991
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>ZAK SMITH                       Num<font color="#000080">: </font><font color="#800000">1295       </font>Date<font color="#000080">: </font><font color="#800000">11</font><font color="#000080">/</font><font color="#800000">03</font><font color="#000080">/</font><font color="#800000">1991
</font>From<font color="#000080">: </font>TREVOR CARLSEN                   Re<font color="#000080">: </font><font color="#800000">0          </font>Time<font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">58 </font>am
Subj<font color="#000080">: &gt;</font>NUL REDIRECTION               Prvt<font color="#000080">: </font>N          Read<font color="#000080">: </font>N

 ZS<font color="#000080">&gt; </font>Change that <font color="#FF0000"><b>to
 </b></font>ZS<font color="#000080">&gt; </font>EXEC <font color="#000080">(</font><font color="#800000">'C:\COMMAND.COM'</font><font color="#000080">,</font><font color="#800000">'c:\pkzip.exe -o ..... &gt;nul'</font><font color="#000080">);

</font>I<font color="#800000">'d reckon that will not work on a majority of systems.  Better is ...

  </font>exec<font color="#000080">(</font>GetEnv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">),</font><font color="#800000">'c:\pkzip...etc'</font><font color="#000080">);

</font>That way it <font color="#FF0000"><b>is not </b></font>command<font color="#000080">.</font>com specific<font color="#000080">.

</font>TeeCee

<font color="#000080">--- </font>TC<font color="#000080">-</font>ED   v2<font color="#000080">.</font><font color="#800000">01  
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>The Pilbara<font color="#800000">'s Pascal Centre (+61 91 732569) (3:690/644)
 
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
