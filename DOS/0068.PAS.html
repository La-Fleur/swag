<html>
<head><title> "System Reboot" by GREG VIGNEAULT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
  System reset via software...

  Using a jump to address $FFFF:0000 doesn't always work to reboot
  a system, particularly under multi-taskers. In a Windows 3.1 DOS-
  session I get a dialog box, about a system violation, that tells
  me to shut down all applications and restart the system -- but my
  PC is certainly not reset by the software reboot attempt.

  AT-class systems ('286+) have a system controller IC which can be
  instructed to reset the system. This will force a reboot even under
  Windows.  The following TP code illustrates this process.

  Since this type of reset will interrupt all other processes, it's
  important that an application first close all files and flush all
  buffers. It would also be a good idea to ask the user if a entire
  system reset is okay. Use this &quot;power reset&quot; prudently! ...
*)
(*******************************************************************)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Reboot<font color="#000080">;     </font><font color="#008000"><i>{ TP system reboot: Jul.19.94 Greg Vigneault    }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SoftReset<font color="#000080">;                    </font><font color="#008000"><i>{ software reset for PC/XTs }
  </i></font><font color="#FF0000"><b>BEGIN                                 </b></font><font color="#008000"><i>{ invalid for multi-taskers }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">( </font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$C0</font><font color="#000080">/                    </font><font color="#008000"><i>{   sub   ax, ax            }
            </i></font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$C0</font><font color="#000080">/                    </font><font color="#008000"><i>{   mov   es, ax            }
            </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$C7</font><font color="#000080">/</font><font color="#800000">6</font><font color="#000080">/</font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">4</font><font color="#000080">/</font><font color="#800000">$34</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/    </font><font color="#008000"><i>{   mov   es:[472h],1234h   }
            </i></font><font color="#800000">$EA</font><font color="#000080">/</font><font color="#800000">0</font><font color="#000080">/</font><font color="#800000">0</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">);           </font><font color="#008000"><i>{   jmp   0FFFFh:0000h      }
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{SoftReset}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>HardReset<font color="#000080">;                    </font><font color="#008000"><i>{ hardware reset for '286+  }
  </i></font><font color="#FF0000"><b>BEGIN                                 </b></font><font color="#008000"><i>{ (uses system controller)  }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">( </font><font color="#800000">$B0</font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/                    </font><font color="#008000"><i>{   mov   al, 0FEh          }
            </i></font><font color="#800000">$E6</font><font color="#000080">/</font><font color="#800000">$64</font><font color="#000080">);                   </font><font color="#008000"><i>{   out   64h, al           }
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{HardReset}</i></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Reboot}

  </i></font>WriteLn<font color="#000080">; </font>WriteLn<font color="#000080">(</font><font color="#800000">'POWER RESET courtesy Greg Vigneault...'</font><font color="#000080">);
  </font>HardReset<font color="#000080">;
  </font><font color="#008000"><i>{ if we're still running then the system is probably a PC/XT...   }
  </i></font>SoftReset<font color="#000080">;

</font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Reboot}</i></font><font color="#000080">.
</font><font color="#008000"><i>{       Internet(Greg.Vigneault@westonia.com) Fido(1:250/636)       }
(*******************************************************************)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0068.PAS">Original</a><b>]</b></p></body>
</html>
