<html>
<head><title> "Simple Multitasker" by HEGEL UDO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0067.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Multi<font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
{                                                                                }
{ Hilfsfunktionen zur quasi-Multitaskingverarbeitung unter Turbo Pascal          }
{                                                                                }
{ (c) 1994 by Hegel Udo                                                          }
{                                                                                }
{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Interface
</b></font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Type
  </b></font>StartProc <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>AddTask <font color="#000080">(</font>Start <font color="#000080">: </font>StartProc<font color="#000080">;</font>StackSize <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Transfer<font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Implementation
</b></font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Type
  </b></font>TaskPtr   <font color="#000080">= ^</font>TaskRec<font color="#000080">;
  </font>TaskRec   <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>StackSize <font color="#000080">: </font>Word<font color="#000080">;
    </font>Stack     <font color="#000080">: </font>Pointer<font color="#000080">;
    </font>SPSave    <font color="#000080">: </font>Word<font color="#000080">;
    </font>SSSave    <font color="#000080">: </font>Word<font color="#000080">;
    </font>BPSave    <font color="#000080">: </font>Word<font color="#000080">;
    </font>Next      <font color="#000080">: </font>TaskPtr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Const
  </b></font>MinStack <font color="#000080">= </font><font color="#800000">1024</font><font color="#000080">;
  </font>MaxStack <font color="#000080">= </font><font color="#800000">32768</font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Var
  </b></font>Tasks    <font color="#000080">: </font>TaskPtr<font color="#000080">;
  </font>AktTask  <font color="#000080">: </font>TaskPtr<font color="#000080">;
  </font>OldExit  <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>AddTask <font color="#000080">(</font>Start <font color="#000080">: </font>StartProc<font color="#000080">;</font>StackSize <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>OS <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>O<font color="#000080">,</font>S <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>W  <font color="#000080">: ^</font>TaskPtr<font color="#000080">;
  </font>SS <font color="#000080">: </font>Word<font color="#000080">;
  </font>SP <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>W <font color="#000080">:= @</font>Tasks<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>Assigned <font color="#000080">(</font>W<font color="#000080">^) </font><font color="#FF0000"><b>do </b></font>W <font color="#000080">:= @</font>W<font color="#000080">^^.</font>Next<font color="#000080">;
  </font>New <font color="#000080">(</font>W<font color="#000080">^);
  </font><font color="#FF0000"><b>if </b></font>StackSize <font color="#000080">&lt; </font>MinStack <font color="#FF0000"><b>then </b></font>StackSize <font color="#000080">:= </font>MinStack<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>StackSize <font color="#000080">&gt; </font>MaxStack <font color="#FF0000"><b>then </b></font>StackSize <font color="#000080">:= </font>MaxStack<font color="#000080">;
  </font>W<font color="#000080">^^.</font>StackSize <font color="#000080">:= </font>StackSize<font color="#000080">;
  </font>GetMem <font color="#000080">(</font>W<font color="#000080">^^.</font>Stack<font color="#000080">,</font>StackSize<font color="#000080">);
  </font>SS <font color="#000080">:= </font>OS<font color="#000080">(</font>W<font color="#000080">^^.</font>Stack<font color="#000080">).</font>S<font color="#000080">;
  </font>SP <font color="#000080">:= </font>OS<font color="#000080">(</font>W<font color="#000080">^^.</font>Stack<font color="#000080">).</font>O<font color="#000080">+</font>StackSize<font color="#000080">-</font><font color="#800000">4</font><font color="#000080">;
  </font>Move <font color="#000080">(</font>Start<font color="#000080">,</font>Ptr<font color="#000080">(</font>SS<font color="#000080">,</font>SP<font color="#000080">)^,</font><font color="#800000">4</font><font color="#000080">);
  </font>W<font color="#000080">^^.</font>SPSave <font color="#000080">:= </font>SP<font color="#000080">;
  </font>W<font color="#000080">^^.</font>SSSave <font color="#000080">:= </font>SS<font color="#000080">;
  </font>W<font color="#000080">^^.</font>BPSave <font color="#000080">:= </font>W<font color="#000080">^^.</font>SPSave<font color="#000080">;
  </font>W<font color="#000080">^^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>Transfer<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES SI,AktTask                               </font><font color="#008000"><i>{ Alter Status sichern }
  </i></font><font color="#FF00FF">MOV ES:[SI].TaskRec.SPSave,SP
  MOV ES:[SI].TaskRec.SSSave,SS
  MOV ES:[SI].TaskRec.BPSave,BP
  MOV AX,Word Ptr ES:[SI].TaskRec.Next         </font><font color="#008000"><i>{ Neue Task bestimmen }
  </i></font><font color="#FF00FF">OR  AX,Word Ptr ES:[SI].TaskRec.Next+2
  JE  @InitNew
  LES SI,ES:[SI].TaskRec.Next
  JMP @DoJob
@InitNew:
  LES SI,Tasks
@DoJob:
  MOV Word Ptr AktTask,SI                      </font><font color="#008000"><i>{ Neue Task Sichern }
  </i></font><font color="#FF00FF">MOV Word Ptr AktTask+2,ES
  CLI                                          </font><font color="#008000"><i>{ Status wieder hertstellen }
  </i></font><font color="#FF00FF">MOV SP,ES:[SI].TaskRec.SPSave
  MOV SS,ES:[SI].TaskRec.SSSave
  STI
  MOV BP,ES:[SI].TaskRec.BPSave
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{--------------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>New <font color="#000080">(</font>Tasks<font color="#000080">);              </font><font color="#008000"><i>{ Hauptprogramm als Task anmelden }
  </i></font>Tasks<font color="#000080">^.</font>StackSize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Tasks<font color="#000080">^.</font>Stack <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>Tasks<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font>AktTask <font color="#000080">:= </font>Tasks<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ --------------------------   DEMO PROGRAM ---------------------- }

</i></font><font color="#FF0000"><b>Program </b></font>Multi_Demo<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>DOS<font color="#000080">, </font>Crt<font color="#000080">, </font>Multi<font color="#000080">;

</font><font color="#FF0000"><b>TYPE

      </b></font>ScreenState <font color="#000080">= (</font>free<font color="#000080">, </font>used<font color="#000080">);          </font><font color="#008000"><i>{ Is screen position free? }
      </i></font>WindowType  <font color="#000080">= </font><font color="#FF0000"><b>Record                 </b></font><font color="#008000"><i>{ Window descriptor }
                      </i></font>X<font color="#000080">,
                      </font>Y<font color="#000080">,
                      </font>Xsize<font color="#000080">,
                      </font>Ysize  <font color="#000080">: </font>Integer<font color="#000080">;
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>var   </b></font>screen      <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">(.</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">81</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">26.</font><font color="#000080">) </font><font color="#FF0000"><b>of </b></font>ScreenState<font color="#000080">;
      </font>WindowTable <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">(.</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20.</font><font color="#000080">) </font><font color="#FF0000"><b>of </b></font>WindowType<font color="#000080">;
      </font>i<font color="#000080">,</font>j<font color="#000080">,                                 </font><font color="#008000"><i>{ Index variables }
      </i></font>NoWindows   <font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{ No. of windows on screen }

</i></font><font color="#FF0000"><b>Procedure </b></font>MakeWindow<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Xsize<font color="#000080">, </font>Ysize<font color="#000080">: </font>Integer<font color="#000080">; </font>Heading<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#008000"><i>{ Reserves screenspace for window and draws border around it }

   </i></font><font color="#FF0000"><b>const </b></font>NEcorner <font color="#000080">= </font><font color="#800000">#187</font><font color="#000080">;                </font><font color="#008000"><i>{ Characters for double-line border }
         </i></font>SEcorner <font color="#000080">= </font><font color="#800000">#188</font><font color="#000080">;
         </font>SWcorner <font color="#000080">= </font><font color="#800000">#200</font><font color="#000080">;
         </font>NWcorner <font color="#000080">= </font><font color="#800000">#201</font><font color="#000080">;
         </font>Hor      <font color="#000080">= </font><font color="#800000">#205</font><font color="#000080">;
         </font>Vert     <font color="#000080">= </font><font color="#800000">#186</font><font color="#000080">;

   </font><font color="#FF0000"><b>var   </b></font>i<font color="#000080">,</font>j <font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
     </b></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);

     </font><font color="#008000"><i>{ Reserve screen space }
     </i></font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font>X <font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>Do
       For </b></font>j<font color="#000080">:=</font>Y <font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>Do </b></font>screen<font color="#000080">(.</font>i<font color="#000080">,</font>j<font color="#000080">.):=</font>used<font color="#000080">;

     </font><font color="#008000"><i>{ Draw border - sides }
     </i></font>i<font color="#000080">:=</font>X<font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>j<font color="#000080">:=</font>Y<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>Do
     Begin
       </b></font>GotoXY<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
       </font>Write<font color="#000080">(</font>Vert<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>i<font color="#000080">:=</font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>j<font color="#000080">:=</font>Y<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>Do
     Begin
       </b></font>GotoXY<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
       </font>Write<font color="#000080">(</font>Vert<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>j<font color="#000080">:=</font>Y<font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font>X<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>Do
     Begin
       </b></font>GotoXY<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
       </font>Write<font color="#000080">(</font>Hor<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>j<font color="#000080">:=</font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font>X<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>Do
     Begin
       </b></font>GotoXY<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
       </font>Write<font color="#000080">(</font>Hor<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#008000"><i>{ Draw border - corners }
     </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
     </font>Write<font color="#000080">(</font>NWcorner<font color="#000080">);
     </font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">);
     </font>Write<font color="#000080">(</font>NEcorner<font color="#000080">);
     </font>GotoXY<font color="#000080">(</font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
     </font>Write<font color="#000080">(</font>SEcorner<font color="#000080">);
     </font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
     </font>Write<font color="#000080">(</font>SWcorner<font color="#000080">);

     </font><font color="#008000"><i>{ Make Heading }
     </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">+(</font>Xsize<font color="#000080">-</font>Length<font color="#000080">(</font>Heading<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font>Y<font color="#000080">);
     </font>Write<font color="#000080">(</font>heading<font color="#000080">);

     </font><font color="#008000"><i>{ Save in table }
     </i></font>NoWindows<font color="#000080">:=</font>NoWindows<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font>WindowTable<font color="#000080">(.</font>NoWindows<font color="#000080">.).</font>X<font color="#000080">:=</font>X<font color="#000080">;
     </font>WindowTable<font color="#000080">(.</font>NoWindows<font color="#000080">.).</font>Y<font color="#000080">:=</font>Y<font color="#000080">;
     </font>WindowTable<font color="#000080">(.</font>NoWindows<font color="#000080">.).</font>Xsize<font color="#000080">:=</font>Xsize<font color="#000080">;
     </font>WindowTable<font color="#000080">(.</font>NoWindows<font color="#000080">.).</font>Ysize<font color="#000080">:=</font>Ysize<font color="#000080">;

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ MakeWindow }

</i></font><font color="#FF0000"><b>Procedure </b></font>SelectWindow<font color="#000080">(</font>i <font color="#000080">: </font>Integer<font color="#000080">);

   </font><font color="#008000"><i>{ Specifies which window will receive subsequent output }

   </i></font><font color="#FF0000"><b>Begin
     With </b></font>WindowTable<font color="#000080">(.</font>i<font color="#000080">.) </font><font color="#FF0000"><b>Do
     Begin
       </b></font>Window<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">+</font>Xsize<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Y<font color="#000080">+</font>Ysize<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SelectWindow }


</i></font><font color="#FF0000"><b>Procedure </b></font>RemoveWindow<font color="#000080">(</font>n<font color="#000080">: </font>Integer<font color="#000080">);

   </font><font color="#008000"><i>{ Removes window number n }

   </i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j <font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
     </b></font>SelectWindow<font color="#000080">(</font>n<font color="#000080">);
     </font><font color="#FF0000"><b>With </b></font>WindowTable<font color="#000080">(.</font>n<font color="#000080">.) </font><font color="#FF0000"><b>Do
     Begin
       </b></font>Window<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>X<font color="#000080">+</font>Xsize<font color="#000080">,</font>Y<font color="#000080">+</font>Ysize<font color="#000080">);
       </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font>X <font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>Xsize <font color="#FF0000"><b>Do
         For </b></font>j<font color="#000080">:=</font>Y <font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>Ysize <font color="#FF0000"><b>Do </b></font>screen<font color="#000080">(.</font>i<font color="#000080">,</font>j<font color="#000080">.):=</font>free<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ With }
     </i></font>ClrScr<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ SelectWindow }

</i></font><font color="#FF0000"><b>Procedure </b></font>Task1<font color="#000080">;</font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
    </b></font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MakeWindow<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Sub Task 1 '</font><font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>FINDFIRST<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">,</font>SR<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>DOSERROR <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          BEGIN
          </b></font>Transfer<font color="#000080">;
          </font>SelectWindow<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">: </font><font color="#800000">12</font><font color="#000080">);
          </font>FINDNEXT<font color="#000080">(</font>SR<font color="#000080">);
          </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Task2<font color="#000080">;</font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
    </b></font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MakeWindow<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Sub Task 2 '</font><font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>FINDFIRST<font color="#000080">(</font><font color="#800000">'\TURBO\TP\*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">,</font>SR<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>DOSERROR <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          BEGIN
          </b></font>Transfer<font color="#000080">;
          </font>SelectWindow<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">: </font><font color="#800000">12</font><font color="#000080">);
          </font>FINDNEXT<font color="#000080">(</font>SR<font color="#000080">);
          </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Task3<font color="#000080">;</font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
    </b></font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MakeWindow<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Sub Task 3 '</font><font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>FINDFIRST<font color="#000080">(</font><font color="#800000">'\TURBO\*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">,</font>SR<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>DOSERROR <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          BEGIN
          </b></font>Transfer<font color="#000080">;
          </font>SelectWindow<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">: </font><font color="#800000">12</font><font color="#000080">);
          </font>FINDNEXT<font color="#000080">(</font>SR<font color="#000080">);
          </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Task4<font color="#000080">;</font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
    </b></font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MakeWindow<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Sub Task 4 '</font><font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>FINDFIRST<font color="#000080">(</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>anyfile<font color="#000080">,</font>SR<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>DOSERROR <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          BEGIN
          </b></font>Transfer<font color="#000080">;
          </font>SelectWindow<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
          </font>WriteLn<font color="#000080">(</font>SR<font color="#000080">.</font>Name <font color="#000080">: </font><font color="#800000">12</font><font color="#000080">);
          </font>FINDNEXT<font color="#000080">(</font>SR<font color="#000080">);
          </font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>ClrScr<font color="#000080">;
  </font>MakeWindow<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">75</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Multi-Program Demo '</font><font color="#000080">);
  </font>SelectWindow<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' This is the MAIN task window and we will start 4 others too'</font><font color="#000080">);
  </font>AddTask <font color="#000080">(</font>Task1<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">);
  </font>AddTask <font color="#000080">(</font>Task2<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">);
  </font>AddTask <font color="#000080">(</font>Task3<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">);
  </font>AddTask <font color="#000080">(</font>Task4<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>Transfer<font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>KEYPRESSED<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0067.PAS">Original</a><b>]</b></p></body>
</html>
