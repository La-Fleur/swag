<html>
<head><title> "Kill DIR Routine" by BRENDEN WALKER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
===========================================================================
 BBS: The Beta Connection
Date: 06-05-93 (12:54)             Number: 67
From: BRENDEN WALKER               Refer#: NONE
  To: WAYNE DOYLE                   Recvd: NO
Subj: DIR. SEARCH                    Conf: (321) Pascal___U
---------------------------------------------------------------------------
 WD&sup3; Hi Everyone,
   &sup3;     I'm interested in finding out how to have the computer search and
   &sup3; find all of the available directories on a disk.  I have a program which
   &sup3; deletes all of *.BAK files on a disk and I'd like to know how it finds
   &sup3; all of the directories.

  The below example code, will kill a directory and all of it's
sub-directories.  This could be modified to delete all of the .BAK files in
all directories on the hard-drive.

  Of course, this may not help much, but I rarely use pseudo-code.
*)

</i></font><font color="#FF0000"><b>procedure </b></font>Kill_Dir<font color="#000080">(</font>p <font color="#000080">: </font>pathstr<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>Od<font color="#000080">, </font>Rd <font color="#000080">: </font>pathstr<font color="#000080">;
    </font>Sr <font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>t <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>getdir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Od<font color="#000080">);
  </font>ChDir<font color="#000080">(</font>p<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>p<font color="#000080">) &gt; </font><font color="#800000">4 </font><font color="#FF0000"><b>then </b></font>p <font color="#000080">:= </font>p <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>anyfile<font color="#000080">, </font>Sr<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>temp <font color="#000080">:= </font>p <font color="#000080">+ </font>Sr<font color="#000080">.</font>Name<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Sr<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
       if </b></font><font color="#000080">(</font>Sr<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Sr<font color="#000080">.</font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>then
       begin
         </b></font>Rd <font color="#000080">:= </font>temp<font color="#000080">;
         </font>Kill_Dir<font color="#000080">(</font>temp<font color="#000080">);
         </font>RmDir<font color="#000080">(</font>Rd<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
      else
      begin
        </b></font>assign<font color="#000080">(</font>t<font color="#000080">,</font>sr<font color="#000080">.</font>name<font color="#000080">);
        </font>erase<font color="#000080">(</font>t<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FindNext<font color="#000080">(</font>Sr<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ChDir<font color="#000080">(</font>Od<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
