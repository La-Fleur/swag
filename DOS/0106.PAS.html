<html>
<head><title> "Console IO in BP7 ( Windows Bin )" by STEPHEN M. OBERHOLTZER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0106.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
&gt;          Hi, I am trying to write a program the writes to Standard output,
&gt; and reads from Standard input from windows console (win95 dosprmpt, winnt
&gt;  dosprmpt)... so the io can be redirected.  The program must be a windows
&gt; program for the project to work:
&gt;                  Using the program as a script for Microsoft Internet
&gt; Information Server on Winnt 3.51, the web server will not execute dos based stdio
&gt; programs.  I have tried using program script(input,output) which reports file not
&gt; open  for write, I have added rewrite(output) which causes an error because output
not assigned.  I have assigned output to '' which outputs nothing to the
console or the redirected file.
&gt;
&gt;                  If anyone understands my problem, and has an idea or
&gt; solution,
&gt;  please help me.  Thank you.
&gt;
&gt;
Ok, here is the solution to your prob : you need to write a text file device
driver. I just happen to have code. You want the StdOut things, i can't
remember how it works =(
p.s. the file's attached.
(*)

</i></font><font color="#FF0000"><b>unit </b></font>SimultIO<font color="#000080">;
</font><font color="#008000"><i>{$D-,F+,R-}
(* Unit for simultaneous I/O.
   This will be useful for redirection - when you write to a
   file assigned to by AssignSimult, data written to it will write to
   the file AND the screen. *)
</i></font><font color="#FF0000"><b>interface
</b></font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>procedure </b></font>AssignSimult<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font>n <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>far</b></font><font color="#000080">; </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>implementation
uses </b></font>Dos<font color="#000080">,</font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>var  </b></font>R <font color="#000080">: </font>Registers<font color="#000080">;
    </font>OP <font color="#000080">: </font>Text<font color="#000080">;
</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>function </b></font>WriteByteToFile<font color="#000080">(</font>FileHandle <font color="#000080">: </font>Word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>value<font color="#000080">) : </font>integer<font color="#000080">;</font><font color="#FF0000"><b>far</b></font><font color="#000080">; </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>var </b></font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>r<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$40</font><font color="#000080">;
 </font>r<font color="#000080">.</font>bx <font color="#000080">:= </font>FileHandle<font color="#000080">;
 </font>r<font color="#000080">.</font>cx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
 </font>r<font color="#000080">.</font>ds <font color="#000080">:= </font>seg<font color="#000080">(</font>value<font color="#000080">);
 </font>r<font color="#000080">.</font>dx <font color="#000080">:= </font>ofs<font color="#000080">(</font>value<font color="#000080">);
 </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>r<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>fcarry<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
   </b></font>r<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$59</font><font color="#000080">; </font><font color="#008000"><i>(* Get extended error info *)
   </i></font>msdos<font color="#000080">(</font>R<font color="#000080">);
   </font>WriteByteToFile <font color="#000080">:= </font>r<font color="#000080">.</font>ax<font color="#000080">; </font><font color="#008000"><i>(* IOResult returns the value in InOutRes *)
  </i></font><font color="#FF0000"><b>end
 else </b></font>WriteByteToFile <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(*
            INT 21,40 - Write To File or Device Using Handle
        AH =  40h
        BX =  file handle
        CX =  number of bytes to write, a zero value truncates/extends
             the file to the current file position
        DS:DX =  pointer to write buffer

        on return:
        AX =  number of bytes written if CF not set
           =  error code if CF set  (see DOS ERROR CODES)

        - if AX is not equal to CX on return, a partial write occurred
        - this function can be used to truncate a file to the current
          file position by writing zero bytes                         *)
{$F+} </i></font><font color="#FF0000"><b>function </b></font>StdOut<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>textrec<font color="#000080">) : </font>integer<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;  </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>var
  </b></font>p<font color="#000080">,</font>err <font color="#000080">: </font>integer<font color="#000080">;
  </font>r <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 if </b></font>f<font color="#000080">.</font>mode<font color="#000080">=</font>fmclosed <font color="#FF0000"><b>then
  begin
   </b></font>StdOut <font color="#000080">:= </font><font color="#800000">103</font><font color="#000080">;
   </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>F <font color="#FF0000"><b>do
   begin
    for </b></font>P <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>bufpos<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
     begin
      </b></font>r<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;
      </font>r<font color="#000080">.</font>dl <font color="#000080">:= </font>ord<font color="#000080">(</font>bufptr<font color="#000080">^[</font>p<font color="#000080">]);
      </font>msdos<font color="#000080">(</font>R<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>BufPos<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StdOut<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>function </b></font>SimultWrite<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>textrec<font color="#000080">): </font>integer<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;  </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>var
  </b></font>p<font color="#000080">,</font>err <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 if </b></font>f<font color="#000080">.</font>mode<font color="#000080">=</font>fmclosed <font color="#FF0000"><b>then
  begin
   </b></font>SimultWrite <font color="#000080">:= </font><font color="#800000">103</font><font color="#000080">;
   </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>F <font color="#FF0000"><b>do
   begin
    for </b></font>P <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>bufpos<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
     begin
      </b></font>err <font color="#000080">:= </font>WriteByteToFile<font color="#000080">(</font>Handle<font color="#000080">,</font>BufPtr<font color="#000080">^[</font>p<font color="#000080">]);
      </font><font color="#FF0000"><b>if </b></font>err<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin
        </b></font>SimultWrite <font color="#000080">:= </font>Err<font color="#000080">;
        </font>BufPos <font color="#000080">:= </font>P<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font>exit<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Write<font color="#000080">(</font>OP<font color="#000080">,</font>BufPtr<font color="#000080">^[</font>p<font color="#000080">]);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>BufPos<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>SimultWrite<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>function </b></font>SimultOpen<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>textrec<font color="#000080">): </font>integer<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;  </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>var
  </b></font>P<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>case </b></font>F<font color="#000080">.</font>Mode <font color="#FF0000"><b>of
   </b></font>FMOutput <font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>(* Rewrite *)
               </i></font><font color="#FF0000"><b>if </b></font>f<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
                begin
                </b></font>F<font color="#000080">.</font>InOutFunc<font color="#000080">:= @</font>StdOut<font color="#000080">;
                </font>F<font color="#000080">.</font>FlushFunc<font color="#000080">:= @</font>StdOut<font color="#000080">;
              </font><font color="#FF0000"><b>end else begin
               </b></font>r<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$3C</font><font color="#000080">;
               </font>r<font color="#000080">.</font>cx <font color="#000080">:=  </font><font color="#800000">$0000</font><font color="#000080">;
               </font>r<font color="#000080">.</font>ds <font color="#000080">:=  </font>Seg<font color="#000080">(</font>F<font color="#000080">.</font>Name<font color="#000080">);
               </font>r<font color="#000080">.</font>dx <font color="#000080">:=  </font>Ofs<font color="#000080">(</font>F<font color="#000080">.</font>Name<font color="#000080">);
               </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>R<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>FCarry<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                 </b></font>R<font color="#000080">.</font>AH <font color="#000080">:=  </font><font color="#800000">$59</font><font color="#000080">;
                 </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
                 </font>SimultOpen <font color="#000080">:=  </font>R<font color="#000080">.</font>AX<font color="#000080">;
                 </font>exit<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>F<font color="#000080">.</font>Handle <font color="#000080">:=  </font>r<font color="#000080">.</font>ax<font color="#000080">;
               </font><font color="#008000"><i>(*
                  INT 21,3C - Create File Using Handle

        AH =  3C
        CX =  file attribute  (see FILE ATTRIBUTES)
        DS:DX =  pointer to ASCIIZ path name

        on return:
        CF =  0 if successful
           =  1 if error
        AX =  files handle if successful
           =  error code if failure  (see DOS ERROR CODES)

        - if file already exists, it is truncated to zero bytes on opening
*)
                </i></font>F<font color="#000080">.</font>InOutFunc<font color="#000080">:= @</font>SimultWrite<font color="#000080">;
                </font>F<font color="#000080">.</font>FlushFunc<font color="#000080">:= @</font>SimultWrite<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>F<font color="#000080">.</font>BufPos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>SimultOpen<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>FMInOut  <font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>(* Append *)
               </i></font>f<font color="#000080">.</font>mode <font color="#000080">:=  </font>fmOutput<font color="#000080">;
               </font>r<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$3d </font><font color="#000080">;
               </font>r<font color="#000080">.</font>al <font color="#000080">:=  </font><font color="#800000">$01</font><font color="#000080">;
               </font>r<font color="#000080">.</font>cx <font color="#000080">:=  </font><font color="#800000">$0000</font><font color="#000080">;
               </font>r<font color="#000080">.</font>ds <font color="#000080">:=  </font>Seg<font color="#000080">(</font>F<font color="#000080">.</font>Name<font color="#000080">);
               </font>r<font color="#000080">.</font>dx <font color="#000080">:=  </font>Ofs<font color="#000080">(</font>F<font color="#000080">.</font>Name<font color="#000080">);
               </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>R<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>FCarry<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                 </b></font>R<font color="#000080">.</font>AH <font color="#000080">:=  </font><font color="#800000">$59</font><font color="#000080">;
                 </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
                 </font>SimultOpen <font color="#000080">:=  </font>R<font color="#000080">.</font>ax<font color="#000080">;
                 </font>exit<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>F<font color="#000080">.</font>Handle <font color="#000080">:=  </font>r<font color="#000080">.</font>ax<font color="#000080">;
               </font>r<font color="#000080">.</font>bx <font color="#000080">:=  </font>r<font color="#000080">.</font>ax<font color="#000080">;
               </font>r<font color="#000080">.</font>al <font color="#000080">:=  </font><font color="#800000">$02</font><font color="#000080">;
               </font>R<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$42</font><font color="#000080">;
               </font>r<font color="#000080">.</font>cx <font color="#000080">:=  </font><font color="#800000">$0000</font><font color="#000080">;
               </font>r<font color="#000080">.</font>dx <font color="#000080">:=  </font><font color="#800000">$0001</font><font color="#000080">; </font><font color="#008000"><i>(* Seek past EOF *)
               </i></font>MsDos<font color="#000080">(</font>R<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>r<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>fcarry<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                 </b></font>r<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$59</font><font color="#000080">;
                 </font>msdos<font color="#000080">(</font>R<font color="#000080">);
                 </font>SimultOpen <font color="#000080">:=  </font>R<font color="#000080">.</font>AX<font color="#000080">;
                 </font>exit<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#008000"><i>(*
               INT 21,42 - Move File Pointer Using Handle

        AH =  42h
        AL =  origin of move:
             00 =  beginning of file plus offset  (SEEK_SET)
             01 =  current location plus offset  (SEEK_CUR)
             02 =  end of file plus offset  (SEEK_END)
        BX =  file handle
        CX =  high order word of number of bytes to move
        DX =  low order word of number of bytes to move

        on return:
        AX =  error code if CF set  (see DOS ERROR CODES)
        DX:AX =  new pointer location if CF not set

        - seeks to specified location in file
                   INT 21,  - Open File Using Handle
        AH =
        AL =  open access mode
             00  read only
             01  write only
             02  read/write
        DS:DX =  pointer to an ASCIIZ file name
 =

        on return:
        AX =  file handle if CF not set
           =  error code if CF set  (see DOS ERROR CODES)
        Access modes in AL:

        =B37=B36=B35=B34=B33=B32=B31=B30=B3  AL
         =B3 =B3 =B3 =B3 =B3 =C0=C4=C1=C4=C1=C4=C4=C4=C4 read/write/updat=
e access mode
         =B3 =B3 =B3 =B3 =C0=C4=C4=C4=C4=C4=C4=C4=C4=C4 reserved, always =
0
         =B3 =C0=C4=C1=C4=C1=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4 sharing mode (=
see below) (DOS 3.1+)
         =C0=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4=C4 1 =  private, =
0 =  inheritable (DOS 3.1+)
=0D
        Sharing mode bits (DOS 3.1+):          Access mode bits:
        654                                    210
        000  compatibility mode (exclusive)    000  read access
        001  deny others read/write access     001  write access
        010  deny others write access          010  read/write access
        011  deny others read access
        100  full access permitted to all
*)
               </i></font>F<font color="#000080">.</font>InOutFunc <font color="#000080">:=  @</font>SimultWrite<font color="#000080">;
               </font>F<font color="#000080">.</font>FlushFunc <font color="#000080">:=  @</font>SimultWrite<font color="#000080">;
               </font>F<font color="#000080">.</font>BufPos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>SimultOpen<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>else
   </b></font>SimultOpen <font color="#000080">:=  </font><font color="#800000">12</font><font color="#000080">; </font><font color="#008000"><i>(* Invalid file access code - you can only Rewrite=
 or Append this *)
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}</i></font><font color="#FF0000"><b>function </b></font>SimultClose<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">: </font>textrec<font color="#000080">): </font>integer<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;  </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>var
  </b></font>P<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>f<font color="#000080">.</font>mode<font color="#000080">= </font>fmclosed <font color="#FF0000"><b>then
  begin
   </b></font>SimultClose <font color="#000080">:=  </font><font color="#800000">103</font><font color="#000080">;
   </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(*
                  INT 21,3E - Close File Using Handle

        AH =  3E
        BX =  file handle to close

        on return:
        AX =  error code if CF set  (see DOS ERROR CODES)

        - if file is opened for update, file time and date stamp
          as well as file size are updated in the directory
        - handle is freed
=0D
 *)
  </i></font>r<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$3E</font><font color="#000080">;
  </font>r<font color="#000080">.</font>bx <font color="#000080">:=  </font>f<font color="#000080">.</font>handle<font color="#000080">;
  </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>R<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>fcarry<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
   begin
    </b></font>r<font color="#000080">.</font>ah <font color="#000080">:=  </font><font color="#800000">$59</font><font color="#000080">;
    </font>MsDos<font color="#000080">(</font>R<font color="#000080">);
    </font>SimultClose <font color="#000080">:=  </font>R<font color="#000080">.</font>AX<font color="#000080">;
    </font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>F<font color="#000080">.</font>Mode <font color="#000080">:=  </font>FMClosed<font color="#000080">;
  </font>SimultClose<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>procedure </b></font>AssignSimult<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f <font color="#000080">: </font>text<font color="#000080">;</font>n <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#008000"><i>{$F-}
</i></font><font color="#FF0000"><b>begin
  with </b></font>textrec<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Mode     <font color="#000080">:=  </font>fmClosed<font color="#000080">;
    </font>Handle   <font color="#000080">:=  </font><font color="#800000">$FFFF</font><font color="#000080">;
    </font>Bufsize  <font color="#000080">:=  </font>SizeOf<font color="#000080">(</font>Buffer<font color="#000080">);
    </font>Bufpos   <font color="#000080">:=  </font><font color="#800000">0</font><font color="#000080">;
    </font>Bufptr   <font color="#000080">:=  @</font>Buffer<font color="#000080">;
    </font>OpenFunc <font color="#000080">:=  @</font>SimultOpen<font color="#000080">;
    </font>CloseFunc<font color="#000080">:=  @</font>SimultClose<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>n<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&gt;</font><font color="#800000">#79 </font><font color="#FF0000"><b>then </b></font>n<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] :=  </font><font color="#800000">#79</font><font color="#000080">; </font><font color="#008000"><i>(* Truncate the name down to 79 chars=
 *)
    </i></font>Move<font color="#000080">(</font>N<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">79</font><font color="#000080">);
    </font>Name<font color="#000080">[</font>Length<font color="#000080">(</font>N<font color="#000080">)] := </font><font color="#800000">#0</font><font color="#000080">; </font><font color="#008000"><i>(* Name is null-terminated *)
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>AssignCRT<font color="#000080">(</font>OP<font color="#000080">);
 </font>Rewrite<font color="#000080">(</font>OP<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0106.PAS">Original</a><b>]</b></p></body>
</html>
