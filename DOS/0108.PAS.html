<html>
<head><title> "DOS Shell Example" by TIM VILLA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0108.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Hi all, I just wanted to leave a note of congratulations and appreciation on
your efforts at the SWAG archive.  The reader is a great little app (I did
the screen saver!) and I've just found quite a few cool things that I hadn't
even thought of trying before in the hardware archive.

I don't know if it's be useful to anyone but I'd like to contribute
something as pretty much everything else I've ever done is already here.
This is the source to a command interpreter with some unix functionality I
call Shell which I've been playing with on and off over the past few years.
I haven't released the source until now but I felt that seeing so many other
people contribute I should do so as well in return.  Shell is available on
SimTel and Oak and is quite widely used.  I don't mind the code being
distributed.

Thanks
Tim
}

{$DEFINE qdebug}

{$IFDEF debug}
{$A-,B-,D+,E-,F-,G+,I+,L+,N-,O-,Q+,R+,S+,V-,X-,M 2700,0,0}
{$ELSE}
{$A-,B-,D-,E-,F-,G+,I-,L-,N-,O-,Q-,R-,S-,V-,X-,M 2300,0,0}
{$ENDIF}

</i></font><font color="#FF0000"><b>program </b></font>Shell<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>BACKSPACE<font color="#000080">=</font><font color="#800000">#8</font><font color="#000080">;                             </font><font color="#008000"><i>{Keyboard character codes}
     </i></font>CTRLD<font color="#000080">=</font><font color="#800000">#4</font><font color="#000080">;
     </font>CTRLU<font color="#000080">=</font><font color="#800000">#21</font><font color="#000080">;
     </font>CTRLBACKSPACE<font color="#000080">=</font><font color="#800000">#127</font><font color="#000080">;
     </font>TAB<font color="#000080">=</font><font color="#800000">#9</font><font color="#000080">;
     </font>ENTER<font color="#000080">=</font><font color="#800000">#13</font><font color="#000080">;
     </font>ESCAPE<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">;
     </font>KHOME<font color="#000080">=</font><font color="#800000">#71</font><font color="#000080">;
     </font>UP<font color="#000080">=</font><font color="#800000">#72</font><font color="#000080">;
     </font>KPGUP<font color="#000080">=</font><font color="#800000">#73</font><font color="#000080">;
     </font>LEFT<font color="#000080">=</font><font color="#800000">#75</font><font color="#000080">;
     </font>RIGHT<font color="#000080">=</font><font color="#800000">#77</font><font color="#000080">;
     </font>KEND<font color="#000080">=</font><font color="#800000">#79</font><font color="#000080">;
     </font>DOWN<font color="#000080">=</font><font color="#800000">#80</font><font color="#000080">;
     </font>KPGDN<font color="#000080">=</font><font color="#800000">#81</font><font color="#000080">;
     </font>INSERTKEY<font color="#000080">=</font><font color="#800000">#82</font><font color="#000080">;
     </font>DELKEY<font color="#000080">=</font><font color="#800000">#83</font><font color="#000080">;
     </font>F1<font color="#000080">=</font><font color="#800000">#59</font><font color="#000080">;
     </font>F2<font color="#000080">=</font><font color="#800000">#60</font><font color="#000080">;
     </font>F3<font color="#000080">=</font><font color="#800000">#61</font><font color="#000080">;
     </font>F7<font color="#000080">=</font><font color="#800000">#65</font><font color="#000080">;
     </font>F8<font color="#000080">=</font><font color="#800000">#66</font><font color="#000080">;
     </font>F10<font color="#000080">=</font><font color="#800000">#68</font><font color="#000080">;
     </font>GUP<font color="#000080">=</font>TRUE<font color="#000080">;                                  </font><font color="#008000"><i>{Scrolling}
     </i></font>GDOWN<font color="#000080">=</font>FALSE<font color="#000080">;
     </font>QUITCMD<font color="#000080">=</font><font color="#800000">'exit'</font><font color="#000080">;                            </font><font color="#008000"><i>{Quit command}
     </i></font>IOINT<font color="#000080">=</font><font color="#800000">$10</font><font color="#000080">;                                 </font><font color="#008000"><i>{DOS IO interrupt}
     </i></font>DOSINT<font color="#000080">=</font><font color="#800000">$21</font><font color="#000080">;                                </font><font color="#008000"><i>{DOS function interrupt}
     </i></font>MOUSEINT<font color="#000080">=</font><font color="#800000">$33</font><font color="#000080">;                              </font><font color="#008000"><i>{Mouse interrupt number}
     </i></font>SCREEN<font color="#000080">=</font><font color="#800000">$B800</font><font color="#000080">;                              </font><font color="#008000"><i>{Screen memory address}
     </i></font>KEYBSTATUS<font color="#000080">=</font><font color="#800000">$417</font><font color="#000080">;                           </font><font color="#008000"><i>{Keyboard status offset}
     </i></font>ALLFILES<font color="#000080">=</font><font color="#800000">$37</font><font color="#000080">;                              </font><font color="#008000"><i>{File mask minus volumeid}
</i></font><font color="#FF0000"><b>var
   </b></font>tvdos<font color="#000080">:</font>pathstr<font color="#000080">;                               </font><font color="#008000"><i>{TVDOS envvar}
   </i></font>path<font color="#000080">:</font>pathstr<font color="#000080">;                                </font><font color="#008000"><i>{PATH envvar}
   </i></font>ppos<font color="#000080">:</font>byte<font color="#000080">;                                   </font><font color="#008000"><i>{Path pointer for GFN}
   </i></font>history<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">]</font><font color="#FF0000"><b>of </b></font>comstr<font color="#000080">;               </font><font color="#008000"><i>{History}
   </i></font>comcount<font color="#000080">:</font>byte<font color="#000080">;                               </font><font color="#008000"><i>{History list counter}
   {The following are only globals to save parameter space}
   </i></font>firstagain<font color="#000080">:</font>boolean<font color="#000080">;                          </font><font color="#008000"><i>{Look for 1st file again}
   </i></font>tabflag<font color="#000080">:</font>boolean<font color="#000080">;                             </font><font color="#008000"><i>{Has tab been pressed}
   </i></font>command<font color="#000080">:</font>comstr<font color="#000080">;                              </font><font color="#008000"><i>{The command line}
   </i></font>promptcolor<font color="#000080">:</font>byte<font color="#000080">;                            </font><font color="#008000"><i>{Prompt color}
   </i></font>dummy<font color="#000080">:</font>integer<font color="#000080">;                               </font><font color="#008000"><i>{Local dummy}

</i></font><font color="#FF0000"><b>procedure </b></font>Initialize<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>checkbreak<font color="#000080">:=</font>false<font color="#000080">;
     </font>directvideo<font color="#000080">:=</font>false<font color="#000080">;                        </font><font color="#008000"><i>{For speech assistants}
     </i></font>tvdos<font color="#000080">:=</font>getenv<font color="#000080">(</font><font color="#800000">'TVDOS'</font><font color="#000080">);
     </font><font color="#008000"><i>{ tvdos := 'c:'; }
     </i></font><font color="#FF0000"><b>if </b></font>tvdos<font color="#000080">=</font><font color="#800000">''</font><font color="#FF0000"><b>then
        begin
             </b></font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: no TVDOS environment variable'</font><font color="#000080">);
             </font>halt<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
     </i></font>path<font color="#000080">:=</font>getenv<font color="#000080">(</font><font color="#800000">'PATH'</font><font color="#000080">);
     </font><font color="#008000"><i>{Add curdir to the path for GFN}
     </i></font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'.\'</font><font color="#000080">,</font>path<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>path<font color="#000080">:=</font><font color="#800000">'.\;'</font><font color="#000080">+</font>path<font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>paramcount<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>val<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>promptcolor<font color="#000080">,</font>dummy<font color="#000080">)
     </font><font color="#FF0000"><b>else
        </b></font>promptcolor<font color="#000080">:=</font>lightblue<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">+</font><font color="#800000">'SHELL V1.9.1 by Tim Villa'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'Type &quot;'</font><font color="#000080">+</font>QUITCMD<font color="#000080">+</font><font color="#800000">'&quot; to escape to DOS'</font><font color="#000080">);
     </font><font color="#008000"><i>{Initialize the history}
     </i></font><font color="#FF0000"><b>for </b></font>comcount<font color="#000080">:=</font><font color="#800000">19 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>history<font color="#000080">[</font>comcount<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#008000"><i>{Initialize the mouse}
     </i></font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">mov ax,0                                </font><font color="#008000"><i>{Reset mouse}
        </i></font><font color="#FF00FF">int MOUSEINT
        mov dummy,ax
        mov ax,7                                </font><font color="#008000"><i>{Set X range}
        </i></font><font color="#FF00FF">mov cx,1
        mov dx,632;
        int MOUSEINT
        mov ax,8                                </font><font color="#008000"><i>{Set Y range}
        </i></font><font color="#FF00FF">mov cx,1
        mov dx,392
        int MOUSEINT
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
     </i></font>write<font color="#000080">(</font><font color="#800000">'Mouse '</font><font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>dummy<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'not '</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'detected'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Initialize}

</i></font><font color="#FF0000"><b>function </b></font>WhereX<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#008000"><i>{Returns x pos on screen}
</i></font><font color="#FF0000"><b>var
   </b></font>temp<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     asm
        </b></font><font color="#FF00FF">mov bh,0                                </font><font color="#008000"><i>{&quot;Graphics&quot; page}
        </i></font><font color="#FF00FF">mov ah,3                                </font><font color="#008000"><i>{Read cursor position}
        </i></font><font color="#FF00FF">int IOINT
        inc dl                                  </font><font color="#008000"><i>{To preserve 0..79}
        </i></font><font color="#FF00FF">mov temp,dl                             </font><font color="#008000"><i>{Mov x result to temp}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>WhereX<font color="#000080">:=</font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{WhereX}

</i></font><font color="#FF0000"><b>procedure </b></font>GotoX<font color="#000080">(</font>x<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#008000"><i>{Move cursor to x,wherey}
</i></font><font color="#FF0000"><b>begin
     asm
        </b></font><font color="#FF00FF">mov bh,0                                </font><font color="#008000"><i>{&quot;Graphics&quot; page}
        </i></font><font color="#FF00FF">mov ah,3                                </font><font color="#008000"><i>{Read cursor position}
        </i></font><font color="#FF00FF">int IOINT
        mov ah,2                                </font><font color="#008000"><i>{Set cursor position}
        </i></font><font color="#FF00FF">dec x                                   </font><font color="#008000"><i>{Columns starts at 0, !1}
        </i></font><font color="#FF00FF">mov dl,x
        int IOINT
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GotoX}

</i></font><font color="#FF0000"><b>function </b></font>Button<font color="#000080">(</font>which<font color="#000080">:</font>char<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#008000"><i>{True if left button down}
</i></font><font color="#FF0000"><b>label
     </b></font>LButton<font color="#000080">,</font>TrueRes<font color="#000080">,</font>FalseRes<font color="#000080">;
</font><font color="#FF0000"><b>begin
     asm
        </b></font><font color="#FF00FF">mov ax,3                                </font><font color="#008000"><i>{Get mouse state}
        </i></font><font color="#FF00FF">int MOUSEINT
        cmp bx,3
        je TrueRes                              </font><font color="#008000"><i>{bx 3 if any button down}
        </i></font><font color="#FF00FF">cmp which,LEFT
        je LButton                              </font><font color="#008000"><i>{Check right utton}
        </i></font><font color="#FF00FF">cmp bx,2
        je TrueRes
        jmp FalseRes                            </font><font color="#008000"><i>{Nope}
        </i></font><font color="#FF00FF">LButton:
        cmp bx,1
        je TrueRes                              </font><font color="#008000"><i>{...else dropout to FalseRes}
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
     </i></font>FalseRes<font color="#000080">:</font>Button<font color="#000080">:=</font>false<font color="#000080">;
     </font>exit<font color="#000080">;
     </font>TrueRes<font color="#000080">:</font>Button<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Button}

</i></font><font color="#FF0000"><b>function </b></font>GetFileName<font color="#000080">(</font>sofar<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>{Responds to TAB to finish command line.
 Returns the remainder of the filename [or whole filename if none given]}
</i></font><font color="#FF0000"><b>var
   </b></font>filerec<font color="#000080">:</font>searchrec<font color="#000080">;                           </font><font color="#008000"><i>{For findfirst}
   </i></font>prefix<font color="#000080">:</font>pathstr<font color="#000080">;                              </font><font color="#008000"><i>{Directory to look in}
   </i></font>filename<font color="#000080">:</font>pathstr<font color="#000080">;                            </font><font color="#008000"><i>{Name we found}
   </i></font>i<font color="#000080">:</font>byte<font color="#000080">;                                      </font><font color="#008000"><i>{Index}
   </i></font>dircmd<font color="#000080">:</font>boolean<font color="#000080">;                              </font><font color="#008000"><i>{Is this a directory command}
   </i></font>cmd<font color="#000080">:</font>boolean<font color="#000080">;                                 </font><font color="#008000"><i>{Is this a command}

   </i></font><font color="#FF0000"><b>procedure </b></font>GetDirEntry<font color="#000080">;
   </font><font color="#008000"><i>{Skips all non directory entries}
   </i></font><font color="#FF0000"><b>begin </b></font>writeln<font color="#000080">(</font>filerec<font color="#000080">.</font>name<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>filerec<font color="#000080">.</font>attr<font color="#000080">);
        </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>filerec<font color="#000080">.</font>attr <font color="#FF0000"><b>and </b></font>DIRECTORY<font color="#000080">)&lt;&gt;</font>DIRECTORY<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>do
              </b></font>findnext<font color="#000080">(</font>filerec<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>filerec<font color="#000080">.</font>name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetDirEntry}

   </i></font><font color="#FF0000"><b>procedure </b></font>GetCmdEntry<font color="#000080">;
   </font><font color="#008000"><i>{Skips all non .EXE .COM .BAT files}
   </i></font><font color="#FF0000"><b>begin
        while </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'.EXE'</font><font color="#000080">,</font>filerec<font color="#000080">.</font>name<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'.COM'</font><font color="#000080">,</font>filerec<font color="#000080">.</font>name<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
              </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'.BAT'</font><font color="#000080">,</font>filerec<font color="#000080">.</font>name<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>filerec<font color="#000080">.</font>attr <font color="#FF0000"><b>and </b></font>DIRECTORY<font color="#000080">) &lt;&gt; </font>DIRECTORY<font color="#000080">) </font><font color="#FF0000"><b>and
              </b></font><font color="#000080">(</font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>do
              </b></font>findnext<font color="#000080">(</font>filerec<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetCmdEntry}

</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{GetFileName}
     {Convert command to lowercase (everything here is in lowercase)}
     </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>sofar<font color="#000080">) </font><font color="#FF0000"><b>do
         if </b></font>sofar<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then
            </b></font>sofar<font color="#000080">[</font>i<font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>sofar<font color="#000080">[</font>i<font color="#000080">])+</font><font color="#800000">32</font><font color="#000080">);
     </font><font color="#008000"><i>{Check for a directory oriented command.  Use &quot;prefix&quot; to save memory}
     </i></font>prefix<font color="#000080">:=</font>copy<font color="#000080">(</font>sofar<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>sofar<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
     </font>dircmd<font color="#000080">:=(</font>prefix<font color="#000080">=</font><font color="#800000">'cd'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>prefix<font color="#000080">=</font><font color="#800000">'rd'</font><font color="#000080">) </font><font color="#FF0000"><b>or
             </b></font><font color="#000080">(</font>prefix<font color="#000080">=</font><font color="#800000">'chdir'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>prefix<font color="#000080">=</font><font color="#800000">'rmdir'</font><font color="#000080">);
     </font>cmd<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>sofar<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#008000"><i>{Eliminate everything before the current &quot;word&quot;}
     </i></font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>sofar<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>delete<font color="#000080">(</font>sofar<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>sofar<font color="#000080">));
     </font><font color="#008000"><i>{And convert forward slashes to backslashes}
     </i></font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>sofar<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>sofar<font color="#000080">[</font>pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>sofar<font color="#000080">)]:=</font><font color="#800000">'\'</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>firstagain <font color="#FF0000"><b>then
        begin
             </b></font><font color="#008000"><i>{We're starting from scratch.  The current directory is in the
              path as set in Initialize so we search the path from the start}
             </i></font>GetFileName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
             </font><font color="#FF0000"><b>repeat
                   </b></font>prefix<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font>i<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">';'</font><font color="#000080">,</font>copy<font color="#000080">(</font>path<font color="#000080">,</font>ppos<font color="#000080">,</font><font color="#800000">79</font><font color="#000080">));
                   </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>i<font color="#000080">:=</font><font color="#800000">255</font><font color="#000080">;
                   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">,</font>sofar<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>sofar<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
                      begin
                           </b></font><font color="#008000"><i>{No drive/path has been specified by the user}
                           </i></font>prefix<font color="#000080">:=</font>copy<font color="#000080">(</font>path<font color="#000080">,</font>ppos<font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
                           </font><font color="#FF0000"><b>if </b></font>prefix<font color="#000080">[</font>length<font color="#000080">(</font>prefix<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\'</font><font color="#FF0000"><b>then
                              </b></font>prefix<font color="#000080">:=</font>prefix<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
                   </i></font>filerec<font color="#000080">.</font>name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font>findfirst<font color="#000080">(</font>prefix<font color="#000080">+</font>sofar<font color="#000080">+</font><font color="#800000">'*.*'</font><font color="#000080">,</font>ALLFILES<font color="#000080">,</font>filerec<font color="#000080">);
                   </font><font color="#008000"><i>{Ignore . and .. filenames}
                   </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>filerec<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>do
                         </b></font>findnext<font color="#000080">(</font>filerec<font color="#000080">);
                   </font><font color="#008000"><i>{Now ignore all but directories if DIRCMD}
                   </i></font><font color="#FF0000"><b>if </b></font>dircmd <font color="#FF0000"><b>then </b></font>GetDirEntry<font color="#000080">;
                   </font><font color="#FF0000"><b>if </b></font>cmd <font color="#FF0000"><b>then </b></font>GetCmdEntry<font color="#000080">;
                   </font>tabflag<font color="#000080">:=</font>true<font color="#000080">;
                   </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&lt;</font><font color="#800000">255 </font><font color="#FF0000"><b>then </b></font>ppos<font color="#000080">:=</font>ppos<font color="#000080">+</font>i<font color="#000080">;
             </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i<font color="#000080">=</font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">18</font><font color="#000080">);
             </font><font color="#008000"><i>{If i is 255 we have run out of subdirs- 255&gt;length(pathstr)
              doserror&lt;&gt;18 means we have found a match somewhere}
             </i></font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font><font color="#800000">255 </font><font color="#FF0000"><b>then </b></font>ppos<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
             </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;          </font><font color="#008000"><i>{No file.  Return ''}
             </i></font>filename<font color="#000080">:=</font>filerec<font color="#000080">.</font>name<font color="#000080">;
             </font>firstagain<font color="#000080">:=</font>false<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#008000"><i>{if}
     </i></font><font color="#FF0000"><b>else
        begin
             </b></font><font color="#008000"><i>{Set filename to what we found here last time}
             {Ignore all but directories if DIRCMD}
             </i></font><font color="#FF0000"><b>if </b></font>dircmd <font color="#FF0000"><b>then </b></font>GetDirEntry<font color="#000080">;
             </font><font color="#FF0000"><b>if </b></font>cmd <font color="#FF0000"><b>then </b></font>GetCmdEntry<font color="#000080">;
             </font>filename<font color="#000080">:=</font>filerec<font color="#000080">.</font>name<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{else}
     {Convert result to lowercase}
     </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>filename<font color="#000080">) </font><font color="#FF0000"><b>do
         if </b></font>filename<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then
            </b></font>filename<font color="#000080">[</font>i<font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>filename<font color="#000080">[</font>i<font color="#000080">])+</font><font color="#800000">32</font><font color="#000080">);
     </font><font color="#008000"><i>{Set up for next TAB}
     </i></font>findnext<font color="#000080">(</font>filerec<font color="#000080">);
     </font><font color="#008000"><i>{If no more files, start again}
     </i></font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
     </font><font color="#008000"><i>{We need to extract the command line entered so far so we can return
      only the remainder, ie the rest of the filename.  First we find the
      last occurrence of a : or \ so we know the where the last instance of
      a filename begins}
     </i></font>i<font color="#000080">:=</font>length<font color="#000080">(</font>sofar<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
           </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
     </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>sofar<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'\'</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">]) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>i<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#008000"><i>{Establish h/m chars we are tacking on}
     </i></font>i<font color="#000080">:=</font>length<font color="#000080">(</font>sofar<font color="#000080">)-</font>i<font color="#000080">;
     </font><font color="#008000"><i>{Extract these chars to get result}
     </i></font>GetFileName<font color="#000080">:=</font>copy<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">+</font>i<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetFileName}

</i></font><font color="#FF0000"><b>function </b></font>GetCmdLine<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>keymap<font color="#000080">=</font><font color="#800000">'qwertyuiop!!!!asdfghjkl!!!!!zxcvbnm'</font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>index<font color="#000080">,</font>c<font color="#000080">:</font>byte<font color="#000080">;                                </font><font color="#008000"><i>{String index, counter}
   </i></font>key<font color="#000080">:</font>char<font color="#000080">;                                    </font><font color="#008000"><i>{User}
   </i></font>cmdline<font color="#000080">:</font>COMSTR<font color="#000080">;                              </font><font color="#008000"><i>{Command line}
   </i></font>lasttabname<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];                      </font><font color="#008000"><i>{Last name from tab press}
   </i></font>comscroll<font color="#000080">:</font>byte<font color="#000080">;                              </font><font color="#008000"><i>{For DOSKEY command scrolling}
   </i></font>gotnull<font color="#000080">:</font>boolean<font color="#000080">;                             </font><font color="#008000"><i>{Has a ctrl char been pressed}
   </i></font>start<font color="#000080">,</font>stop<font color="#000080">:</font>byte<font color="#000080">;                             </font><font color="#008000"><i>{Sel start/end, line#}
   </i></font>linenum<font color="#000080">:</font>integer<font color="#000080">;                             </font><font color="#008000"><i>{Line number mouse is on}
   </i></font>mtext<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                            </font><font color="#008000"><i>{C&amp;P text from mouse}
   </i></font>attrline<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">]</font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;                </font><font color="#008000"><i>{Original attr b/4 highlight}
   </i></font>inson<font color="#000080">:</font>boolean<font color="#000080">;                               </font><font color="#008000"><i>{Insert on or off}
   </i></font>dirlen<font color="#000080">:</font>byte<font color="#000080">;                                 </font><font color="#008000"><i>{Length of dirname}
   </i></font>m<font color="#000080">,</font>s<font color="#000080">,</font>s100<font color="#000080">,</font>oldtime<font color="#000080">,</font>time<font color="#000080">:</font>word<font color="#000080">;                  </font><font color="#008000"><i>{For double click test}
   </i></font>firstscroll<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>label
     </b></font>MyLabel1<font color="#000080">;                                  </font><font color="#008000"><i>{Dummy label}

   </i></font><font color="#FF0000"><b>procedure </b></font>ToggleInsert<font color="#000080">;
   </font><font color="#FF0000"><b>begin
        </b></font>inson<font color="#000080">:=</font><font color="#FF0000"><b>not </b></font>inson<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>inson <font color="#FF0000"><b>then
           asm
              </b></font><font color="#FF00FF">mov ah,1                          </font><font color="#008000"><i>{Set cursor type}
              </i></font><font color="#FF00FF">mov ch,1
              mov cl,4
              int IOINT
           </font><font color="#FF0000"><b>end</b></font><font color="#008000"><i>{asm}
        </i></font><font color="#FF0000"><b>else
           asm
              </b></font><font color="#FF00FF">mov ah,1                          </font><font color="#008000"><i>{Set cursor type}
              </i></font><font color="#FF00FF">mov ch,4
              mov cl,5
              int IOINT;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ToggleInsert}

   </i></font><font color="#FF0000"><b>procedure </b></font>ScrollLastCommand<font color="#000080">(</font>up<font color="#000080">:</font>boolean<font color="#000080">);
   </font><font color="#008000"><i>{DOSKEY up arrow}
   </i></font><font color="#FF0000"><b>begin
        if </b></font>comcount<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>firstscroll <font color="#FF0000"><b>then
           begin
                </b></font>firstscroll<font color="#000080">:=</font>false<font color="#000080">;
                </font>comscroll<font color="#000080">:=</font>comscroll<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
        </i></font><font color="#FF0000"><b>if </b></font>up <font color="#FF0000"><b>then
           begin
                </b></font>dec<font color="#000080">(</font>comscroll<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>comscroll<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>comscroll<font color="#000080">:=</font>comcount<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#008000"><i>{if}
        </i></font><font color="#FF0000"><b>else
           begin
                </b></font>inc<font color="#000080">(</font>comscroll<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>comscroll<font color="#000080">&gt;</font>comcount <font color="#FF0000"><b>then </b></font>comscroll<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{else}
        </i></font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);                        </font><font color="#008000"><i>{Go to start of cmdline}
        </i></font>clreol<font color="#000080">;
        </font>cmdline<font color="#000080">:=</font>history<font color="#000080">[</font>comscroll<font color="#000080">];
        </font>write<font color="#000080">(</font>cmdline<font color="#000080">);
        </font>index<font color="#000080">:=</font>length<font color="#000080">(</font>cmdline<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ScrollLastCommand}

   </i></font><font color="#FF0000"><b>procedure </b></font>NormalKey<font color="#000080">;
   </font><font color="#008000"><i>{Normal alphanumerics}
   </i></font><font color="#FF0000"><b>begin
        </b></font>tabflag<font color="#000080">:=</font>false<font color="#000080">;
        </font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
        </font>firstscroll<font color="#000080">:=</font>true<font color="#000080">;
        </font>ppos<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>gotnull <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">=</font>CTRLD <font color="#FF0000"><b>then
           begin
                </b></font><font color="#008000"><i>{We have a ^D character}
                </i></font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>cmdline<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>delete<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>cmdline<font color="#000080">));
                </font>cmdline<font color="#000080">:=</font>tvdos<font color="#000080">+</font><font color="#800000">'\LISTNAME.EXE '</font><font color="#000080">+</font>cmdline<font color="#000080">;
                </font>key<font color="#000080">:=</font><font color="#800000">#13</font><font color="#000080">;
                </font>exit<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
        </i></font><font color="#FF0000"><b>if </b></font>inson <font color="#FF0000"><b>then
           begin
                </b></font><font color="#008000"><i>{Insert the char}
                </i></font>insert<font color="#000080">(</font>key<font color="#000080">,</font>cmdline<font color="#000080">,</font>index<font color="#000080">);
                </font>inc<font color="#000080">(</font>index<font color="#000080">);
                </font><font color="#008000"><i>{Write what we got now}
                </i></font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                </font>write<font color="#000080">(</font>cmdline<font color="#000080">);
                </font><font color="#008000"><i>{Move one pos to the right of old pos}
                </i></font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                </font>exit<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
        </i></font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&gt;</font>length<font color="#000080">(</font>cmdline<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>cmdline<font color="#000080">:=</font>cmdline<font color="#000080">+</font>key
        <font color="#FF0000"><b>else </b></font>cmdline<font color="#000080">[</font>index<font color="#000080">]:=</font>key<font color="#000080">;
        </font>write<font color="#000080">(</font>key<font color="#000080">);
        </font>inc<font color="#000080">(</font>index<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{NormalKey}

   </i></font><font color="#FF0000"><b>procedure </b></font>GetOldAttr<font color="#000080">;
   </font><font color="#008000"><i>{Saves original chacter attributes}
   </i></font><font color="#FF0000"><b>var
      </b></font>c<font color="#000080">:</font>byte<font color="#000080">;                                   </font><font color="#008000"><i>{Counter}
   </i></font><font color="#FF0000"><b>begin
        </b></font><font color="#008000"><i>{We don't want the area under the mouse so hide it}
        </i></font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,2                             </font><font color="#008000"><i>{Hide mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        </i></font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do
            </b></font>attrline<font color="#000080">[</font>c<font color="#000080">]:=</font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>linenum<font color="#000080">+(</font><font color="#800000">2</font><font color="#000080">*</font>c<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)];
        </font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,1                             </font><font color="#008000"><i>{Show mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetOldAttr}

   </i></font><font color="#FF0000"><b>procedure </b></font>RestoreOldAttr<font color="#000080">(</font>start<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#008000"><i>{Restores old attributes to highlighted text}
   </i></font><font color="#FF0000"><b>var
      </b></font>c<font color="#000080">:</font>byte<font color="#000080">;                                   </font><font color="#008000"><i>{Counter}
   </i></font><font color="#FF0000"><b>begin
        if </b></font>linenum<font color="#000080">=-</font>maxint <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font>start <font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do
            </b></font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>linenum<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">*</font>c<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]:=</font>attrline<font color="#000080">[</font>c<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{RestoreOldAttr}

   </i></font><font color="#FF0000"><b>function </b></font>GetCutAndPaste<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#008000"><i>{Returns text selected with mouse}
   </i></font><font color="#FF0000"><b>var
      </b></font>xpos<font color="#000080">:</font>byte<font color="#000080">;                                </font><font color="#008000"><i>{Mouse x pos ; dummy byte}
      </i></font>c<font color="#000080">,</font>offs<font color="#000080">:</font>integer<font color="#000080">;                           </font><font color="#008000"><i>{Counter, offset of start}
      </i></font>cutstr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                        </font><font color="#008000"><i>{Selected text}
   </i></font><font color="#FF0000"><b>begin
        asm
           </b></font><font color="#FF00FF">mov ax,2                             </font><font color="#008000"><i>{Hide mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        </i></font>RestoreOldAttr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                      </font><font color="#008000"><i>{Clear old highlighted text}
        {Get the initial pos}
        </i></font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,3                             </font><font color="#008000"><i>{Get mouse state}
           </i></font><font color="#FF00FF">int MOUSEINT
           mov ax,cx                            </font><font color="#008000"><i>{Load divisor: x coord}
           </i></font><font color="#FF00FF">add ax,8
           mov bl,8                             </font><font color="#008000"><i>{Set dividend}
           </i></font><font color="#FF00FF">div bl
           mov xpos,al                          </font><font color="#008000"><i>{Use xpos to save mem}
           </i></font><font color="#FF00FF">mov ax,dx                            </font><font color="#008000"><i>{Load divisor: y coord}
           </i></font><font color="#FF00FF">add ax,8
           div bl
           dec al                               </font><font color="#008000"><i>{Now calculate (al-1)*160}
           </i></font><font color="#FF00FF">mov dh,160
           mul dh
           mov offs,ax                          </font><font color="#008000"><i>{Use offs to save mem}
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        {Linenum represents (linenum-1)*160 for offset}
        </i></font>linenum<font color="#000080">:=</font>offs<font color="#000080">;
        </font>start<font color="#000080">:=</font>xpos<font color="#000080">;
        </font>GetOldAttr<font color="#000080">;
        </font><font color="#008000"><i>{Ok highlight etc until the button is released}
        </i></font><font color="#FF0000"><b>repeat
              asm
                 </b></font><font color="#FF00FF">mov ax,3                       </font><font color="#008000"><i>{Get mouse state}
                 </i></font><font color="#FF00FF">int MOUSEINT
                 mov ax,cx
                 add ax,8
                 mov bl,8
                 div bl
                 mov xpos,al
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
              </i></font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font>linenum<font color="#000080">+(</font>start<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font>linenum<font color="#000080">+(</font>xpos<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">-</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>do
                  if </b></font>odd<font color="#000080">(</font>c<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>c<font color="#000080">]:=</font>black<font color="#000080">+</font>lightgray<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">;
              </font>RestoreOldAttr<font color="#000080">(</font>xpos<font color="#000080">);
        </font><font color="#FF0000"><b>until not </b></font>Button<font color="#000080">(</font>LEFT<font color="#000080">);
        </font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,1                             </font><font color="#008000"><i>{Show mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        {Might have to get new mouse x here?}
        {Get our new position and calulate the initial offset}
        </i></font>stop<font color="#000080">:=</font>xpos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>offs<font color="#000080">:=</font>linenum<font color="#000080">+(</font>start<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#008000"><i>{Fill in the string from memory}
        </i></font>cutstr<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>stop<font color="#000080">-</font>start<font color="#000080">)*</font><font color="#800000">2 </font><font color="#FF0000"><b>do
            if not </b></font>odd<font color="#000080">(</font>c<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>cutstr<font color="#000080">:=</font>cutstr<font color="#000080">+</font>chr<font color="#000080">(</font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>offs<font color="#000080">+</font>c<font color="#000080">]);
        </font><font color="#FF0000"><b>if </b></font>start<font color="#000080">&gt;=</font>stop <font color="#FF0000"><b>then </b></font>GetCutAndPaste<font color="#000080">:=</font><font color="#800000">'' </font><font color="#FF0000"><b>else </b></font>GetCutAndPaste<font color="#000080">:=</font>cutstr<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetCutAndPaste}

   </i></font><font color="#FF0000"><b>function </b></font>GetWord<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#008000"><i>{Gets current word as indicated by double clicking}
   </i></font><font color="#FF0000"><b>var
      </b></font>xpos<font color="#000080">:</font>byte<font color="#000080">;                                </font><font color="#008000"><i>{Mouse x,y coords}
      </i></font>offs<font color="#000080">:</font>integer<font color="#000080">;
      </font>cutstr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                        </font><font color="#008000"><i>{Selected text}
      </i></font>c<font color="#000080">:</font>integer<font color="#000080">;
   </font><font color="#FF0000"><b>begin
        asm
           </b></font><font color="#FF00FF">mov ax,2                             </font><font color="#008000"><i>{Hide mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        {Get the initial pos}
        </i></font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,3                             </font><font color="#008000"><i>{Get mouse state}
           </i></font><font color="#FF00FF">int MOUSEINT
           mov ax,cx                            </font><font color="#008000"><i>{Load divisor: x coord}
           </i></font><font color="#FF00FF">add ax,8
           mov bl,8                             </font><font color="#008000"><i>{Set dividend}
           </i></font><font color="#FF00FF">div bl
           mov xpos,al                          </font><font color="#008000"><i>{x coord}
           </i></font><font color="#FF00FF">mov ax,dx                            </font><font color="#008000"><i>{Load divisor: y coord}
           </i></font><font color="#FF00FF">add ax,8
           div bl
           dec al                               </font><font color="#008000"><i>{Now calculate (al-1)*160}
           </i></font><font color="#FF00FF">mov dh,160
           mul dh
           mov offs,ax                          </font><font color="#008000"><i>{This is the memory offset}
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        {Go back to closest space or SOLN}
        </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>offs<font color="#000080">+(</font>xpos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]&lt;&gt;</font><font color="#800000">32</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>xpos<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
              </b></font>xpos<font color="#000080">:=</font>xpos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#008000"><i>{Now move to the right, adding characters until space or EOLN}
        </i></font>cutstr<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>offs<font color="#000080">+(</font>xpos<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]&lt;&gt;</font><font color="#800000">32</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>xpos<font color="#000080">&lt;</font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>do
              begin
                   </b></font>cutstr<font color="#000080">:=</font>cutstr<font color="#000080">+</font>chr<font color="#000080">(</font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>offs<font color="#000080">+</font>xpos<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">]);
                   </font><font color="#008000"><i>{Highlight character}
                   </i></font>mem<font color="#000080">[</font>SCREEN<font color="#000080">:</font>offs<font color="#000080">+</font>xpos<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>black<font color="#000080">+</font>lightgray<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">;
                   </font>xpos<font color="#000080">:=</font>xpos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{while}
        </i></font><font color="#FF0000"><b>asm
           </b></font><font color="#FF00FF">mov ax,1                             </font><font color="#008000"><i>{Show mouse cursor}
           </i></font><font color="#FF00FF">int MOUSEINT
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
        </i></font>GetWord<font color="#000080">:=</font>cutstr<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetWord}

   </i></font><font color="#FF0000"><b>procedure </b></font>FinishCommand<font color="#000080">;
   </font><font color="#008000"><i>{DOSKEY F8}
   </i></font><font color="#FF0000"><b>var
      </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
   </font><font color="#FF0000"><b>begin
        if </b></font>comcount<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>comcount <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
            if </b></font>pos<font color="#000080">(</font>cmdline<font color="#000080">,</font>history<font color="#000080">[</font>i<font color="#000080">])=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
               begin
                    </b></font>cmdline<font color="#000080">:=</font>history<font color="#000080">[</font>i<font color="#000080">];
                    </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                    </font>write<font color="#000080">(</font>cmdline<font color="#000080">);
                    </font>index<font color="#000080">:=</font>length<font color="#000080">(</font>cmdline<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
                    </font>exit<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{FinishCommand}

</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{GetCmdLine}
     </i></font><font color="#FF0000"><b>if </b></font>WhereX<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">;
     </font>getdir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>cmdline<font color="#000080">);                         </font><font color="#008000"><i>{Var used to save memory}
     </i></font>textcolor<font color="#000080">(</font>promptcolor<font color="#000080">);
     </font>write<font color="#000080">(</font>cmdline<font color="#000080">+</font><font color="#800000">'&gt;'</font><font color="#000080">);
     </font>textattr<font color="#000080">:=</font>lightgray<font color="#000080">;
     </font>clreol<font color="#000080">;
     </font>dirlen<font color="#000080">:=</font>length<font color="#000080">(</font>cmdline<font color="#000080">);
     </font>cmdline<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font>comscroll<font color="#000080">:=</font>comcount<font color="#000080">;                       </font><font color="#008000"><i>{Reset scroller}
     </i></font>index<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font>tabflag<font color="#000080">:=</font>false<font color="#000080">;                            </font><font color="#008000"><i>{Reset TAB assoc variables}
     </i></font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
     </font>lasttabname<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font>ppos<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font>gotnull<font color="#000080">:=</font>false<font color="#000080">;
     </font>inson<font color="#000080">:=</font>true<font color="#000080">;
     </font>ToggleInsert<font color="#000080">;                              </font><font color="#008000"><i>{Sets to false, reset cursor}
     </i></font>start<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;                                  </font><font color="#008000"><i>{Reset cut &amp; paste}
     </i></font>stop<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>mtext<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
     </font>linenum<font color="#000080">:=-</font>maxint<font color="#000080">;
     </font>time<font color="#000080">:=</font><font color="#800000">65535</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
           repeat
                 if </b></font>Button<font color="#000080">(</font>LEFT<font color="#000080">) </font><font color="#FF0000"><b>then
                    begin
                         </b></font>oldtime<font color="#000080">:=</font>time<font color="#000080">;
                         </font>gettime<font color="#000080">(</font>s<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">,</font>s100<font color="#000080">);
                         </font>mtext<font color="#000080">:=</font>GetCutAndPaste<font color="#000080">;
                         </font>time<font color="#000080">:=</font>m<font color="#000080">*</font><font color="#800000">60000</font><font color="#000080">+</font>s<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">+</font>s100<font color="#000080">;
                         </font><font color="#FF0000"><b>if </b></font>time<font color="#000080">-</font>oldtime<font color="#000080">&lt;</font><font color="#800000">20 </font><font color="#FF0000"><b>then </b></font>mtext<font color="#000080">:=</font>GetWord<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
                 </i></font><font color="#FF0000"><b>if </b></font>Button<font color="#000080">(</font>RIGHT<font color="#000080">) </font><font color="#FF0000"><b>then
                    begin
                         </b></font>RestoreOldAttr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                         </font>inc<font color="#000080">(</font>index<font color="#000080">,</font>length<font color="#000080">(</font>mtext<font color="#000080">));
                         </font><font color="#008000"><i>{Gotta check for len here}
                         </i></font>cmdline<font color="#000080">:=</font>cmdline<font color="#000080">+</font>mtext<font color="#000080">;
                         </font>write<font color="#000080">(</font>mtext<font color="#000080">);
                         </font><font color="#FF0000"><b>repeat until not </b></font>Button<font color="#000080">(</font>RIGHT<font color="#000080">)
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
           </i></font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
           </font>key<font color="#000080">:=</font>readkey<font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font>gotnull <font color="#FF0000"><b>then
              begin
                   </b></font>gotnull<font color="#000080">:=</font>false<font color="#000080">;
                   </font><font color="#FF0000"><b>case </b></font>key <font color="#FF0000"><b>of
                       </b></font>UP<font color="#000080">:</font>ScrollLastCommand<font color="#000080">(</font>GUP<font color="#000080">); </font><font color="#008000"><i>{DOH2}
                       </i></font>DOWN<font color="#000080">:</font>ScrollLastCommand<font color="#000080">(</font>GDOWN<font color="#000080">);
                       </font>LEFT<font color="#000080">:
                          </font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
                             begin
                                  </b></font>write<font color="#000080">(</font>BACKSPACE<font color="#000080">);
                                  </font>dec<font color="#000080">(</font>index<font color="#000080">);
                             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{KLEFT}
                       </i></font>RIGHT<font color="#000080">:
                          </font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&lt;</font>length<font color="#000080">(</font>cmdline<font color="#000080">) </font><font color="#FF0000"><b>then
                             begin
                                  </b></font>GotoX<font color="#000080">(</font>WhereX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                                  </font>inc<font color="#000080">(</font>index<font color="#000080">);
                             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{KRIGHT}
                       </i></font>KHOME<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                               </font>index<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{KHOME}
                       </i></font>KEND<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">+</font>length<font color="#000080">(</font>cmdline<font color="#000080">));
                               </font>index<font color="#000080">:=</font>length<font color="#000080">(</font>cmdline<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{KEND}
                       </i></font>KPGUP<font color="#000080">,</font>KPGDN<font color="#000080">:;
                       </font>F8<font color="#000080">:</font>FinishCommand<font color="#000080">;
                       </font>F1<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               asm
                                  </b></font><font color="#FF00FF">cmp comcount,0
                                  je MyLabel1
                               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
                               </i></font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>history<font color="#000080">[</font>comcount<font color="#000080">])&lt;</font>index <font color="#FF0000"><b>then
                                  goto </b></font>MyLabel1<font color="#000080">;
                               </font>inc<font color="#000080">(</font>index<font color="#000080">);
                               </font>c<font color="#000080">:=</font>ord<font color="#000080">(</font>history<font color="#000080">[</font>comcount<font color="#000080">,</font>index<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
                               </font>cmdline<font color="#000080">:=</font>cmdline<font color="#000080">+</font>chr<font color="#000080">(</font>c<font color="#000080">);
                               </font>write<font color="#000080">(</font>chr<font color="#000080">(</font>c<font color="#000080">));
                               </font>MyLabel1<font color="#000080">:;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{F1}
                       </i></font>F3<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>history<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">]:=</font>cmdline<font color="#000080">;            </font><font color="#008000"><i>{Temp}
                               </i></font>c<font color="#000080">:=</font>WhereX<font color="#000080">;                       </font><font color="#008000"><i>{Save pos}
                               </i></font>ScrollLastCommand<font color="#000080">(</font>GUP<font color="#000080">);
                               </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                               </font>write<font color="#000080">(</font>history<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">]);
                               </font>GotoX<font color="#000080">(</font>index<font color="#000080">+</font>dirlen<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                               </font>cmdline<font color="#000080">:=</font>history<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">]+
                                        </font>copy<font color="#000080">(</font>cmdline<font color="#000080">,
                                             </font>length<font color="#000080">(</font>history<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">);
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{F3}
                       </i></font>F7<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>cmdline<font color="#000080">:=</font><font color="#800000">'HISTORY'</font><font color="#000080">;
                               </font>writeln<font color="#000080">;
                               </font>key<font color="#000080">:=</font>ENTER<font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{F7}
                       </i></font>INSERTKEY<font color="#000080">:</font>ToggleInsert<font color="#000080">;
                       </font>DELKEY<font color="#000080">:
                          </font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&lt;=</font>length<font color="#000080">(</font>cmdline<font color="#000080">) </font><font color="#FF0000"><b>then
                             begin
                                  if </b></font>index<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
                                     </b></font>cmdline<font color="#000080">:=</font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">)
                                  </font><font color="#FF0000"><b>else
                                     </b></font>cmdline<font color="#000080">:=</font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>index<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)+
                                              </font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">);
                                  </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                                  </font>write<font color="#000080">(</font>cmdline<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
                                  </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{DELKEY:if}
                       </i></font><font color="#800000">#16</font><font color="#000080">..</font><font color="#800000">#25</font><font color="#000080">,
                       </font><font color="#800000">#30</font><font color="#000080">..</font><font color="#800000">#38</font><font color="#000080">,
                       </font><font color="#800000">#44</font><font color="#000080">..</font><font color="#800000">#50</font><font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>writeln<font color="#000080">;
                               </font>cmdline<font color="#000080">:=</font>tvdos<font color="#000080">+</font><font color="#800000">'\SH_'</font><font color="#000080">+
                                        </font>copy<font color="#000080">(</font>keymap<font color="#000080">,</font>ord<font color="#000080">(</font>key<font color="#000080">)-</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">'.BAT'</font><font color="#000080">;
                               </font>key<font color="#000080">:=</font>ENTER<font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ALT keys}
                   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if gotnull}
              </i></font><font color="#FF0000"><b>end
           else
           case </b></font>key <font color="#FF0000"><b>of </b></font>BACKSPACE<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>gotnull<font color="#000080">:=</font>false<font color="#000080">;
                               </font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
                                  begin
                                       if </b></font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font>length<font color="#000080">(</font>cmdline<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">' '</font><font color="#FF0000"><b>then
                                          begin
                                               </b></font>tabflag<font color="#000080">:=</font>false<font color="#000080">;
                                               </font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
                                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
                                       </i></font><font color="#FF0000"><b>if </b></font>index<font color="#000080">&lt;</font>length<font color="#000080">(</font>cmdline<font color="#000080">) </font><font color="#FF0000"><b>then
                                          begin
                                               </b></font><font color="#008000"><i>{Backspace inside command line}
                                               </i></font>cmdline<font color="#000080">:=</font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>index<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">)+</font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font>index<font color="#000080">,</font><font color="#800000">127</font><font color="#000080">);
                                               </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
                                               </font>write<font color="#000080">(</font>cmdline<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
                                               </font>GotoX<font color="#000080">(</font>dirlen<font color="#000080">+</font>index<font color="#000080">);
                                          </font><font color="#FF0000"><b>end</b></font><font color="#008000"><i>{if}
                                       </i></font><font color="#FF0000"><b>else
                                          begin
                                               </b></font><font color="#008000"><i>{Backspace over last character}
                                               </i></font>cmdline<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>cmdline<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])-</font><font color="#800000">1</font><font color="#000080">);
                                               </font>write<font color="#000080">(</font>key<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>key<font color="#000080">);
                                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{else}
                                       </i></font>dec<font color="#000080">(</font>index<font color="#000080">);
                                       </font><font color="#FF0000"><b>if </b></font>tabflag <font color="#FF0000"><b>then
                                          begin
                                               if </b></font>length<font color="#000080">(</font>lasttabname<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                                                  </b></font>lasttabname<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>lasttabname<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])-</font><font color="#800000">1</font><font color="#000080">);
                                               </font>firstagain<font color="#000080">:=</font>true<font color="#000080">;
                                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
                                  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{else}
                          </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{BACKSPACE}
                       </i></font>TAB<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>gotnull<font color="#000080">:=</font>false<font color="#000080">;
                               </font><font color="#FF0000"><b>if </b></font>tabflag <font color="#FF0000"><b>then
                                  begin
                                       </b></font><font color="#008000"><i>{Erase all signs of existence the last
                                        TAB caused}
                                       </i></font>c<font color="#000080">:=</font>length<font color="#000080">(</font>lasttabname<font color="#000080">);
                                       </font>GotoX<font color="#000080">(</font>WhereX<font color="#000080">-</font>c<font color="#000080">);
                                       </font>clreol<font color="#000080">;
                                       </font>index<font color="#000080">:=</font>index<font color="#000080">-</font>c<font color="#000080">;
                                       </font>cmdline<font color="#000080">:=</font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,
                                                     </font>length<font color="#000080">(</font>cmdline<font color="#000080">)-</font>c<font color="#000080">);
                                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
                               </i></font>lasttabname<font color="#000080">:=</font>GetFileName<font color="#000080">(</font>cmdline<font color="#000080">);
                                </font>cmdline<font color="#000080">:=</font>cmdline<font color="#000080">+</font>lasttabname<font color="#000080">;
                               </font>GotoX<font color="#000080">(</font>WhereX<font color="#000080">-</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                               </font>write<font color="#000080">(</font>cmdline<font color="#000080">);
                               </font>index<font color="#000080">:=</font>index<font color="#000080">+</font>length<font color="#000080">(</font>lasttabname<font color="#000080">);
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{TAB}
                       </i></font>ESCAPE<font color="#000080">,</font>CTRLU<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>GotoX<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                </font><font color="#008000"><i>{So can redraw prompt}
                               </i></font>clreol<font color="#000080">;
                               </font>GetCmdLine<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                               </font>firstscroll<font color="#000080">:=</font>true<font color="#000080">;
                               </font>exit<font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ESCAPE}
                       </i></font>ENTER<font color="#000080">:
                          </font><font color="#FF0000"><b>begin
                               </b></font>firstscroll<font color="#000080">:=</font>true<font color="#000080">;
                               </font>RestoreOldAttr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                               </font><font color="#FF0000"><b>asm
                                  </b></font><font color="#FF00FF">mov ax,2              </font><font color="#008000"><i>{Hide mouse cursor}
                                  </i></font><font color="#FF00FF">int 51
                               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
                               </i></font>writeln<font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{ENTER}
                       </i></font>CTRLBACKSPACE<font color="#000080">:</font>halt<font color="#000080">;
                       </font><font color="#800000">#0</font><font color="#000080">:</font>gotnull<font color="#000080">:=</font>true<font color="#000080">;
                       </font><font color="#800000">#3</font><font color="#000080">:;                             </font><font color="#008000"><i>{Ignore leftover ^C}
                       </i></font><font color="#FF0000"><b>else </b></font>NormalKey<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{case}
     </i></font><font color="#FF0000"><b>until </b></font>key<font color="#000080">=</font>ENTER<font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>copy<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">' '</font><font color="#FF0000"><b>do </b></font>delete<font color="#000080">(</font>cmdline<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>GetCmdLine<font color="#000080">:=</font>cmdline<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{GetCmdLine}

</i></font><font color="#FF0000"><b>function </b></font>Exclusions<font color="#000080">(</font>temp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Determines whether command is valid}
{Also executes SHELL commands}
</i></font><font color="#FF0000"><b>var
   </b></font>i<font color="#000080">:</font>byte<font color="#000080">;                                              </font><font color="#008000"><i>{Index}
</i></font><font color="#FF0000"><b>begin
     </b></font>Exclusions<font color="#000080">:=</font>false<font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>temp<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>temp<font color="#000080">[</font>i<font color="#000080">]:=</font>upcase<font color="#000080">(</font>temp<font color="#000080">[</font>i<font color="#000080">]);
     </font><font color="#FF0000"><b>if </b></font>copy<font color="#000080">(</font>temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">'SET ' </font><font color="#FF0000"><b>then
        </b></font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Cannot set environment variables'</font><font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>temp<font color="#000080">=</font><font color="#800000">'HISTORY' </font><font color="#FF0000"><b>then
        begin
             for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>comcount <font color="#FF0000"><b>do </b></font>writeln<font color="#000080">(</font>i<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>history<font color="#000080">[</font>i<font color="#000080">]);
             </font>Exclusions<font color="#000080">:=</font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Exclusions}

</i></font><font color="#FF0000"><b>procedure </b></font>UpdateCommands<font color="#000080">;
</font><font color="#008000"><i>{Adds latest command to command list}
</i></font><font color="#FF0000"><b>var
   </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>byte<font color="#000080">;                                            </font><font color="#008000"><i>{Counter/index}
</i></font><font color="#FF0000"><b>begin
     </b></font>inc<font color="#000080">(</font>comcount<font color="#000080">);
     </font>i<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>comcount<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>command<font color="#000080">&lt;&gt;</font>history<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>do </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&lt;</font>comcount <font color="#FF0000"><b>then
        begin
             </b></font><font color="#008000"><i>{&quot;Remove&quot; this instance and add it to end}
             </i></font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>i <font color="#FF0000"><b>to </b></font>comcount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>history<font color="#000080">[</font>j<font color="#000080">]:=</font>history<font color="#000080">[</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
             </font>history<font color="#000080">[</font>comcount<font color="#000080">]:=</font>command<font color="#000080">;
             </font>dec<font color="#000080">(</font>comcount<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
     </i></font><font color="#FF0000"><b>if </b></font>comcount<font color="#000080">=</font><font color="#800000">21 </font><font color="#FF0000"><b>then
     </b></font><font color="#008000"><i>{Move all commands &quot;down&quot; one}
        </i></font><font color="#FF0000"><b>for </b></font>comcount<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">20 </font><font color="#FF0000"><b>do
            </b></font>history<font color="#000080">[</font>comcount<font color="#000080">]:=</font>history<font color="#000080">[</font>comcount<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
     </font><font color="#008000"><i>{Add new command to end of array}
     </i></font>history<font color="#000080">[</font>comcount<font color="#000080">]:=</font>command<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{UpdateCommands}

</i></font><font color="#FF0000"><b>procedure </b></font>BuildLastCommand<font color="#000080">;
</font><font color="#008000"><i>{Gets last command using UNIX ! syntax}
</i></font><font color="#FF0000"><b>var
   </b></font>i<font color="#000080">:</font>byte<font color="#000080">;                                              </font><font color="#008000"><i>{Counter}
</i></font><font color="#FF0000"><b>begin
     </b></font>command<font color="#000080">:=</font>copy<font color="#000080">(</font>command<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">79</font><font color="#000080">);
     </font>val<font color="#000080">(</font>command<font color="#000080">,</font>i<font color="#000080">,</font>dummy<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>comcount<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
             </b></font>command<font color="#000080">:=</font>history<font color="#000080">[</font>i<font color="#000080">];
             </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
     </i></font><font color="#FF0000"><b>if </b></font>comcount<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        for </b></font>i<font color="#000080">:=</font>comcount <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
            if </b></font>pos<font color="#000080">(</font>command<font color="#000080">,</font>history<font color="#000080">[</font>i<font color="#000080">])=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
               begin
                    </b></font>command<font color="#000080">:=</font>history<font color="#000080">[</font>i<font color="#000080">];
                    </font>exit<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
     </i></font>command<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{BuildLastCommand}

</i></font><font color="#FF0000"><b>procedure </b></font>DoCommands<font color="#000080">;
</font><font color="#008000"><i>{Reads and executes commands}
</i></font><font color="#FF0000"><b>begin
     repeat
           repeat
                 asm
                    </b></font><font color="#FF00FF">mov ax,1                            </font><font color="#008000"><i>{Show mouse cursor}
                    </i></font><font color="#FF00FF">int 51
                    mov ax,8                            </font><font color="#008000"><i>{Set Y range}
                    </i></font><font color="#FF00FF">mov cx,1
                    mov dx,392
                    int MOUSEINT
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{asm}
                 </i></font>command<font color="#000080">:=</font>GetCmdLine<font color="#000080">;
                 </font><font color="#FF0000"><b>if </b></font>command<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'!'</font><font color="#FF0000"><b>then </b></font>BuildLastCommand<font color="#000080">;
           </font><font color="#FF0000"><b>until </b></font>command<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font>copy<font color="#000080">(</font>command<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">)&lt;&gt;</font><font color="#800000">'C:\TVDOS\SH_' </font><font color="#FF0000"><b>then
              </b></font>UpdateCommands<font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>command<font color="#000080">&lt;&gt;</font>QUITCMD<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Exclusions<font color="#000080">(</font>command<font color="#000080">)) </font><font color="#FF0000"><b>then
              begin
                   </b></font>swapvectors<font color="#000080">;
                   </font>exec<font color="#000080">(</font>tvdos<font color="#000080">+</font><font color="#800000">'\COMMAND.COM'</font><font color="#000080">,</font><font color="#800000">'/C '</font><font color="#000080">+</font>command<font color="#000080">);
                   </font>swapvectors<font color="#000080">;
                   </font><font color="#FF0000"><b>case </b></font>doserror <font color="#FF0000"><b>of </b></font><font color="#800000">0</font><font color="#000080">:;
                                    </font><font color="#800000">1</font><font color="#000080">:</font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Cannot use root directory for TVDOS'</font><font color="#000080">);
                                    </font><font color="#800000">2</font><font color="#000080">:</font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Command interpreter missing'</font><font color="#000080">);
                                    </font><font color="#800000">3</font><font color="#000080">:</font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Bad TVDOS directory'</font><font color="#000080">);
                                    </font><font color="#800000">8</font><font color="#000080">:</font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Out of memory or system error'</font><font color="#000080">);
                                    </font><font color="#FF0000"><b>else </b></font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: error '</font><font color="#000080">,</font>doserror<font color="#000080">);
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{case}
              </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}
     </i></font><font color="#FF0000"><b>until </b></font>command<font color="#000080">=</font>QUITCMD<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{DoCommands}

</i></font><font color="#FF0000"><b>begin
     </b></font>Initialize<font color="#000080">;
     </font>DoCommands<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Terminating'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>NOTES

We get a stack overflow every time NormalKey <font color="#FF0000"><b>is </b></font>pressed when DEBUG <font color="#FF0000"><b>is on</b></font><font color="#000080">.
</font>There don<font color="#800000">'t appear to be any problems with the stack but bear this in mind!

</font>Check <font color="#FF0000"><b>to </b></font>see <font color="#FF0000"><b>if </b></font>there <font color="#FF0000"><b>is </b></font>a <font color="#000080">* </font>around here somewhere so we can find partly
specified extensions<font color="#000080">}

</font>Use mem<font color="#000080">[</font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$417</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>to </b></font>switch off all key locks

Taken from Exclusions<font color="#000080">:

     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'SHELL'</font><font color="#000080">,</font>temp<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>pos<font color="#000080">(</font><font color="#800000">'DEL'</font><font color="#000080">,</font>temp<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">'REN'</font><font color="#000080">,</font>temp<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        begin
             </b></font>writeln<font color="#000080">(</font><font color="#800000">'SHELL: Access denied'</font><font color="#000080">);
             </font>Exclusions<font color="#000080">:=</font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{if}

</i></font>QUIRKS

<font color="#800000">8.  </font>The stack <font color="#FF0000"><b>is </b></font>unstable<font color="#000080">.  </font>Don<font color="#800000">'t make it any smaller
11. </font>Pressing F3 <font color="#FF0000"><b>to </b></font>recall a shorter command<font color="#000080">.  </font>No bug but hmmm<font color="#000080">...

</font>BUGS

<font color="#800000">12. </font>Use <font color="#FF0000"><b>of </b></font>TAB after starting a new line causes error <font color="#800000">201
13. </font>Use <font color="#FF0000"><b>of </b></font>TAB after a <font color="#000080">. </font><font color="#FF0000"><b>is on </b></font>the command line screws up GFN
<font color="#800000">14. </font>Can<font color="#800000">'t cd TAB for directories with A bit set-check (attr &amp;&amp; DIRECTORY)

</font>ERROR CODES

<font color="#800000">01</font><font color="#000080">: (</font><font color="#FF0000"><b>Not </b></font>sure why<font color="#000080">) </font><font color="#800000">$</font>TVDOS <font color="#FF0000"><b>is in </b></font>a root directory<font color="#000080">.  </font>Probably C<font color="#000080">:\\ </font>I guess
<font color="#800000">02</font><font color="#000080">: </font><font color="#FF0000"><b>File not </b></font>found<font color="#000080">-</font><font color="#800000">$</font>TVDOS <font color="#000080">\</font>COMMAND<font color="#000080">.</font>COM <font color="#FF0000"><b>is </b></font>missing
<font color="#800000">08</font><font color="#000080">: </font><font color="#FF0000"><b>Not </b></font>enough memory<font color="#000080">.  </font>No memory <font color="#FF0000"><b>or </b></font>system error

VERSION

<font color="#800000">1.8.2  </font>Fixed bug where prompt color <font color="#FF0000"><b>is </b></font>used by DOS command
<font color="#800000">1.9.0
1.9.1  </font>Get network directory names completing properly

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0108.PAS">Original</a><b>]</b></p></body>
</html>
