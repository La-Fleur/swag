<html>
<head><title> "4DOS File Descriptions" by WILLEM DE VRIES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0087.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ Please check below for the WINDOWS version of this code }
{$A+,B-,D+,E+,F-,G+,I+,L+,N+,O-,P-,Q+,R+,S+,T-,V+,X+,Y+}

</i></font><font color="#FF0000"><b>Unit </b></font>D4Dos<font color="#000080">;
</font><font color="#008000"><i>{
******************4DOS description functions****************
Written by: W. de Vries, dVELP Services
Target:     DOS real-mode
Date:       March 1994
Purpose:    Reading and modifying the 4DOS file descriptions
************************************************************

Usage: GetDescript(FileName / directoryname): String;
       Returns the description of the filename or directory name.
       Use a full path to specify the exact location of the file.
}

</i></font><font color="#FF0000"><b>Interface
         Function </b></font>GetDescript<font color="#000080">(</font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>Function </b></font>SetDescript<font color="#000080">(</font>Name<font color="#000080">, </font>Descript<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Implementation
Uses </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Upper<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Replace this function if you've got a faster one}

</i></font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Str<font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>Str<font color="#000080">[</font>i<font color="#000080">] := </font>Upcase<font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">]);
    </font>Upper <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>getDescriptFileName<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Internal function that gives the complete path of DESCRIPT.ION}
</i></font><font color="#FF0000"><b>Var </b></font>D<font color="#000080">: </font>DirStr<font color="#000080">;
    </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
    </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;
    </font>tmp<font color="#000080">: </font>PathStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
     If </b></font>Name<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then
     begin
        </b></font>getDescriptFileName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>tmp <font color="#000080">:= </font>FExpand<font color="#000080">(</font>Name<font color="#000080">);
     </font>FSplit<font color="#000080">(</font>tmp<font color="#000080">, </font>D<font color="#000080">, </font>N<font color="#000080">, </font>E<font color="#000080">);
     </font>Tmp<font color="#000080">:= </font>D<font color="#000080">;
     </font>getDescriptFileName<font color="#000080">:= </font>tmp<font color="#000080">+</font><font color="#800000">'DESCRIPT.ION'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetName<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Returns only the filename without the path}

</i></font><font color="#FF0000"><b>Var </b></font>D<font color="#000080">: </font>DirStr<font color="#000080">;
    </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
    </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;
    </font>tmp<font color="#000080">: </font>PathStr<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     If </b></font>Name<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then
     begin
        </b></font>getName <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>tmp <font color="#000080">:= </font>FExpand<font color="#000080">(</font>Name<font color="#000080">);
     </font>FSplit<font color="#000080">(</font>tmp<font color="#000080">, </font>D<font color="#000080">, </font>N<font color="#000080">, </font>E<font color="#000080">);
     </font>getName<font color="#000080">:= </font>N<font color="#000080">+</font>E<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDescript<font color="#000080">(</font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Input: The path/name of a file
output: The 4DOS file description
        or '' if there is no description}

</i></font><font color="#FF0000"><b>Var
    </b></font>IOBuf<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{2 Kb read-buffer}
    </i></font>f<font color="#000080">: </font>text<font color="#000080">;
    </font>Regel<font color="#000080">, </font>tmp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Found <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Found <font color="#000080">:= </font>False<font color="#000080">;
     </font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>GetDescriptFileName<font color="#000080">(</font>Name<font color="#000080">));
     </font>SetTextBuf<font color="#000080">(</font>F<font color="#000080">, </font>IOBuf<font color="#000080">);
     </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>f<font color="#000080">);</font><font color="#008000"><i>{$I+}
     </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
        </b></font>GetDescript <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Found<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>do
     begin
           </b></font>ReadLn<font color="#000080">(</font>f<font color="#000080">, </font>regel<font color="#000080">);
           </font>Tmp <font color="#000080">:= </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>regel<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
           </font>Found <font color="#000080">:= </font>Upper<font color="#000080">(</font>Tmp<font color="#000080">) = </font>Upper<font color="#000080">(</font>GetName<font color="#000080">(</font>Name<font color="#000080">));
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>Found <font color="#FF0000"><b>then
     begin
       </b></font>GetDescript <font color="#000080">:= </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Regel<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Regel<font color="#000080">));
     </font><font color="#FF0000"><b>end
     else
       </b></font>GetDescript <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font>Close<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetDescript<font color="#000080">(</font>Name<font color="#000080">, </font>Descript<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Input: the path/name of a file, the description of the file. Enter '' for
        the description to remove it.
Output: True if the description has been succesfully set, otherwise
        it is false.}


</i></font><font color="#FF0000"><b>Type </b></font>FileInfo<font color="#000080">=^</font>FileRec<font color="#000080">;
    </font>FileRec<font color="#000080">= </font><font color="#FF0000"><b>Record
              </b></font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
              </font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
              </font>Next<font color="#000080">: </font>FileInfo<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>f<font color="#000080">: </font>Text<font color="#000080">;
    </font>IOBuf<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{2 Kb read-buffer}
    </i></font>BeginPtr<font color="#000080">, </font>UsePtr<font color="#000080">, </font>EndPtr<font color="#000080">: </font>FileInfo<font color="#000080">;
    </font>regel<font color="#000080">, </font>tmp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>FileFound<font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ReadInfo<font color="#000080">;
  </font><font color="#008000"><i>{Read all descriptions in a pointer-array}
  </i></font><font color="#FF0000"><b>Begin
      </b></font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
      </i></font>FileFound <font color="#000080">:= </font>False<font color="#000080">;
      </font>BeginPtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>UsePtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>EndPtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>then
      begin </b></font><font color="#008000"><i>{The DESCRIPT.ION file does not exist: create a new one}
            {$I-} </i></font>Rewrite<font color="#000080">(</font>f<font color="#000080">);</font><font color="#008000"><i>{$I+}
            </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                  </b></font>exit<font color="#000080">;
            </font>BeginPtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">);</font><font color="#008000"><i>{Create a new record}
            </i></font>BeginPtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>Upper<font color="#000080">(</font>GetName<font color="#000080">(</font>Name<font color="#000080">));
            </font>BeginPtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>Descript<font color="#000080">;
            </font>BeginPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
            </font>EndPtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;
      </font><font color="#FF0000"><b>end else
        While not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
        begin
           </b></font>Readln<font color="#000080">(</font>f<font color="#000080">, </font>regel<font color="#000080">);
           </font>UsePtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">); </font><font color="#008000"><i>{just create a new record}
           </i></font>tmp <font color="#000080">:= </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>regel<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
           </font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>tmp<font color="#000080">;
           </font><font color="#FF0000"><b>If </b></font>Upper<font color="#000080">(</font>tmp<font color="#000080">)=</font>Upper<font color="#000080">(</font>GetName<font color="#000080">(</font>Name<font color="#000080">)) </font><font color="#FF0000"><b>then
           begin
              </b></font>FileFound <font color="#000080">:= </font>True<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>Descript <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
              begin
                 </b></font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>getName<font color="#000080">(</font>tmp<font color="#000080">); </font><font color="#008000"><i>{File found in list, change it!}
                 </i></font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>Descript<font color="#000080">;
                 </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end else
              begin
                 </b></font>Dispose<font color="#000080">(</font>UsePtr<font color="#000080">); </font><font color="#008000"><i>{Description is NIL, remove the new record}
                 </i></font>UsePtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end else
           begin
              </b></font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>GetName<font color="#000080">(</font>tmp<font color="#000080">);
              </font><font color="#FF0000"><b>If </b></font>Regel <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
                  </b></font>tmp <font color="#000080">:=</font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Regel<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Regel<font color="#000080">))
              </font><font color="#FF0000"><b>else
                  </b></font>tmp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
              </font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>tmp<font color="#000080">;
              </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

           </font><font color="#FF0000"><b>If </b></font>BeginPtr<font color="#000080">=</font><font color="#FF0000"><b>nil then
           begin
              </b></font>BeginPtr <font color="#000080">:= </font>UsePtr<font color="#000080">; </font><font color="#008000"><i>{Created a new array}
              </i></font>EndPtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;      </font><font color="#008000"><i>{Point the endpointer to the begin}
           </i></font><font color="#FF0000"><b>end else
           begin
              </b></font>EndPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font>UsePtr<font color="#000080">; </font><font color="#008000"><i>{Stick the new record to the previous one}
              </i></font><font color="#FF0000"><b>If </b></font>UsePtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
                 </b></font>EndPtr <font color="#000080">:= </font>UsePtr<font color="#000080">;  </font><font color="#008000"><i>{Point the EndPtr to the last record}
           </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>FileFound<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Descript <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
            </b></font>UsePtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">); </font><font color="#008000"><i>{Create a new record}
            </i></font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>Upper<font color="#000080">(</font>getName<font color="#000080">(</font>Name<font color="#000080">));
            </font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>Descript<font color="#000080">;
            </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
            </font>EndPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font>UsePtr<font color="#000080">;
            </font>EndPtr <font color="#000080">:= </font>UsePtr<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Close<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{Close file}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>WriteInfo<font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
      </b></font>SetFAttr<font color="#000080">(</font>f<font color="#000080">, </font>Archive<font color="#000080">); </font><font color="#008000"><i>{Unhide the file}
      </i></font>WriteInfo <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#008000"><i>{$I-} </i></font>Rewrite<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
      </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
         </b></font>WriteInfo <font color="#000080">:= </font>False<font color="#000080">;
         </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>BeginPtr <font color="#000080">= </font><font color="#FF0000"><b>nil then
      begin
           </b></font>Close<font color="#000080">(</font>f<font color="#000080">);   </font><font color="#008000"><i>{No descriptions: delete file}
           </i></font>Erase<font color="#000080">(</font>f<font color="#000080">);
           </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font>BeginPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
      Begin
           </b></font>Writeln<font color="#000080">(</font>f<font color="#000080">, </font>BeginPtr<font color="#000080">^.</font>FileName<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>BeginPtr<font color="#000080">^.</font>Str<font color="#000080">);
           </font>UsePtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;
           </font>BeginPtr <font color="#000080">:= </font>UsePtr<font color="#000080">^.</font>Next<font color="#000080">; </font><font color="#008000"><i>{Move the begin-pointer 1 up}
           </i></font>Dispose<font color="#000080">(</font>UsePtr<font color="#000080">);      </font><font color="#008000"><i>{Delete first record}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Close<font color="#000080">(</font>f<font color="#000080">);
      </font>SetFAttr<font color="#000080">(</font>f<font color="#000080">, </font>Hidden<font color="#000080">); </font><font color="#008000"><i>{Hide the DESCRIPT.ION file}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>SetDescript <font color="#000080">:= </font>False<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>Name<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then
        </b></font>Exit<font color="#000080">;                              </font><font color="#008000"><i>{If there's no name specified:
quit}
     </i></font>Assign<font color="#000080">(</font>f<font color="#000080">, </font>GetDescriptFileName<font color="#000080">(</font>Name<font color="#000080">)); </font><font color="#008000"><i>{Open DESCRIPT.ION}
     </i></font>SetTextBuf<font color="#000080">(</font>f<font color="#000080">, </font>IOBuf<font color="#000080">);                 </font><font color="#008000"><i>{create a 2Kb buffer}
     </i></font>ReadInfo<font color="#000080">;                             </font><font color="#008000"><i>{Read the descriptions}
     </i></font>SetDescript <font color="#000080">:= </font>WriteInfo<font color="#000080">;             </font><font color="#008000"><i>{Write the descriptions}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
end</b></font><font color="#000080">.


</font><font color="#008000"><i>{   FOLLOWING IS THE WINDOWS SPECIFIC CODE FOR THIS UNIT !! }

{$A+,B-,D-,F-,G+,I+,K+,L-,N+,P-,Q+,R+,S+,T+,V+,W+,X+,Y-}

</i></font><font color="#FF0000"><b>Unit </b></font>W4Dos<font color="#000080">;
</font><font color="#008000"><i>{******************4DOS description functions****************
Written by: W. de Vries, dVELP Services
Target:     Windows, DPMI
Date:       March 1994
Purpose:    Reading and modifying the 4DOS file descriptions
************************************************************}

</i></font><font color="#FF0000"><b>Interface
         Function </b></font>GetDescript<font color="#000080">(</font>Name<font color="#000080">:</font>PChar<font color="#000080">):</font>PChar<font color="#000080">;
         </font><font color="#FF0000"><b>Function </b></font>SetDescript<font color="#000080">(</font>Name<font color="#000080">, </font>Descript<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Implementation
Uses </b></font>Windos<font color="#000080">, </font>Strings<font color="#000080">, </font>WinCrt<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>getDescriptFileName<font color="#000080">(</font>Name<font color="#000080">: </font>PChar<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#008000"><i>{Internal function that gives the complete path of DESCRIPT.ION}
</i></font><font color="#FF0000"><b>Var </b></font>D<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsDirectory<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>N<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsFileName<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>E<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsExtension<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>tmp<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>begin
     If </b></font>Name<font color="#000080">=</font><font color="#FF0000"><b>nil then
     begin
        </b></font>getDescriptFileName <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>GetMem<font color="#000080">(</font>tmp<font color="#000080">, </font><font color="#800000">256</font><font color="#000080">);
     </font>FileExpand<font color="#000080">(</font>tmp<font color="#000080">, </font>Name<font color="#000080">);
     </font>FileSplit<font color="#000080">(</font>tmp<font color="#000080">, </font>D<font color="#000080">, </font>N<font color="#000080">, </font>E<font color="#000080">);
     </font>StrCopy<font color="#000080">(</font>Tmp<font color="#000080">, </font>D<font color="#000080">);
     </font>StrCat<font color="#000080">(</font>Tmp<font color="#000080">, </font><font color="#800000">'DESCRIPT.ION'</font><font color="#000080">);
     </font>getDescriptFileName<font color="#000080">:= </font>StrNew<font color="#000080">(</font>Tmp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetName<font color="#000080">(</font>Name<font color="#000080">: </font>PChar<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#008000"><i>{Returns only the filename without the path}

</i></font><font color="#FF0000"><b>Var </b></font>D<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsDirectory<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>N<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsFileName<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>E<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>fsExtension<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>tmp<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     If </b></font>Name<font color="#000080">=</font><font color="#FF0000"><b>nil then
     begin
        </b></font>getName <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>GetMem<font color="#000080">(</font>tmp<font color="#000080">, </font><font color="#800000">256</font><font color="#000080">);
     </font>FileExpand<font color="#000080">(</font>tmp<font color="#000080">, </font>Name<font color="#000080">);
     </font>FileSplit<font color="#000080">(</font>tmp<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>N<font color="#000080">, </font>E<font color="#000080">);
     </font>StrCopy<font color="#000080">(</font>Tmp<font color="#000080">, </font>N<font color="#000080">);
     </font>StrCat<font color="#000080">(</font>tmp<font color="#000080">, </font>E<font color="#000080">);
     </font>getName<font color="#000080">:= </font>StrNew<font color="#000080">(</font>tmp<font color="#000080">);
     </font>StrDispose<font color="#000080">(</font>tmp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetDescript<font color="#000080">(</font>Name<font color="#000080">:</font>PChar<font color="#000080">):</font>PChar<font color="#000080">;
</font><font color="#008000"><i>{Input: The path/name of a file
output: The 4DOS file description
        or NIL if there is no description}

</i></font><font color="#FF0000"><b>Var
    </b></font>IOBuf<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{2 Kb read-buffer}
    </i></font>f<font color="#000080">: </font>text<font color="#000080">;
    </font>Regel<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>tmp<font color="#000080">: </font>PChar<font color="#000080">;
    </font>Found <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Found <font color="#000080">:= </font>False<font color="#000080">;
     </font>GetMem<font color="#000080">(</font>tmp<font color="#000080">, </font><font color="#800000">256</font><font color="#000080">);
     </font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>GetDescriptFileName<font color="#000080">(</font>Name<font color="#000080">));
     </font>SetTextBuf<font color="#000080">(</font>F<font color="#000080">, </font>IOBuf<font color="#000080">);
     </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>f<font color="#000080">);</font><font color="#008000"><i>{$I+}
     </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
        </b></font>GetDescript <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
        </font>StrDispose<font color="#000080">(</font>Tmp<font color="#000080">);
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Found<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>do
     begin
           </b></font>ReadLn<font color="#000080">(</font>f<font color="#000080">, </font>regel<font color="#000080">);
           </font>StrPCopy<font color="#000080">(</font>Tmp<font color="#000080">, </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>regel<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
           </font>Found <font color="#000080">:= </font>StrIComp<font color="#000080">(</font>tmp<font color="#000080">,</font>GetName<font color="#000080">(</font>Name<font color="#000080">))=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>Found <font color="#FF0000"><b>then
     begin
       </b></font>GetDescript <font color="#000080">:= </font>StrNew<font color="#000080">(</font>StrPCopy<font color="#000080">(</font>tmp<font color="#000080">, </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Regel<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Regel<font color="#000080">))));
     </font><font color="#FF0000"><b>end
     else
       </b></font>GetDescript <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>Close<font color="#000080">(</font>f<font color="#000080">);
     </font>StrDispose<font color="#000080">(</font>tmp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetDescript<font color="#000080">(</font>Name<font color="#000080">, </font>Descript<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Input: the path/name of a file, the description of the file. Enter NIL for
        the description to remove it.
Output: True if the description has been succesfully set, otherwise
        it is false.}


</i></font><font color="#FF0000"><b>Type </b></font>FileInfo<font color="#000080">=^</font>FileRec<font color="#000080">;
    </font>FileRec<font color="#000080">= </font><font color="#FF0000"><b>Record
              </b></font>FileName<font color="#000080">:</font>PChar<font color="#000080">;
              </font>Str<font color="#000080">: </font>PChar<font color="#000080">;
              </font>Next<font color="#000080">: </font>FileInfo<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>f<font color="#000080">: </font>Text<font color="#000080">;
    </font>IOBuf<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{2 Kb read-buffer}
    </i></font>BeginPtr<font color="#000080">, </font>UsePtr<font color="#000080">, </font>EndPtr<font color="#000080">: </font>FileInfo<font color="#000080">;
    </font>regel<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>tmp<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>FileFound<font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ReadInfo<font color="#000080">;
  </font><font color="#008000"><i>{Read all descriptions in a pointer-array}
  </i></font><font color="#FF0000"><b>Begin
      If </b></font>Descript <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
         If </b></font>StrIComp<font color="#000080">(</font>Descript<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            </b></font>Descript <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>FileFound <font color="#000080">:= </font>False<font color="#000080">;
      </font>BeginPtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>UsePtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>EndPtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
      </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>then
      begin </b></font><font color="#008000"><i>{The DESCRIPT.ION file does not exist: create a new one}
            {$I-} </i></font>Rewrite<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
            </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
               </b></font>Exit<font color="#000080">;
            </font>BeginPtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">);</font><font color="#008000"><i>{Create a new record}
            </i></font>BeginPtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>StrNew<font color="#000080">(</font>StrUpper<font color="#000080">(</font>GetName<font color="#000080">(</font>Name<font color="#000080">)));
            </font>BeginPtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>StrNew<font color="#000080">(</font>Descript<font color="#000080">);
            </font>BeginPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
            </font>EndPtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;
            </font>FileFound <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end else

        While not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
        begin
           </b></font>Readln<font color="#000080">(</font>f<font color="#000080">, </font>regel<font color="#000080">);
           </font>UsePtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">); </font><font color="#008000"><i>{just create a new record}
           </i></font>StrPCopy<font color="#000080">(</font>tmp<font color="#000080">, </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>regel<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
           </font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>StrNew<font color="#000080">(</font>GetName<font color="#000080">(</font>tmp<font color="#000080">));
           </font><font color="#FF0000"><b>If </b></font>StrIComp<font color="#000080">(</font>tmp<font color="#000080">, </font>GetName<font color="#000080">(</font>Name<font color="#000080">))=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           begin  </b></font><font color="#008000"><i>{File found in list, change it!}
              </i></font>FileFound <font color="#000080">:= </font>True<font color="#000080">;
              </font><font color="#FF0000"><b>If </b></font>Descript <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
              begin
                 </b></font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>StrNew<font color="#000080">(</font>Descript<font color="#000080">);
                 </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end else
              begin
                 </b></font>Dispose<font color="#000080">(</font>UsePtr<font color="#000080">); </font><font color="#008000"><i>{Description is NIL, remove the new record}
                 </i></font>UsePtr <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end else
           begin
              If </b></font>Regel <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
                  </b></font>StrPCopy<font color="#000080">(</font>tmp<font color="#000080">, </font>Copy<font color="#000080">(</font>Regel<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Regel<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>Regel<font color="#000080">)))
              </font><font color="#FF0000"><b>else
                  </b></font>tmp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#0</font><font color="#000080">;
              </font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>StrNew<font color="#000080">(</font>tmp<font color="#000080">);
              </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

           </font><font color="#FF0000"><b>If </b></font>BeginPtr<font color="#000080">=</font><font color="#FF0000"><b>nil then
           begin
              </b></font>BeginPtr <font color="#000080">:= </font>UsePtr<font color="#000080">; </font><font color="#008000"><i>{Created a new array}
              </i></font>EndPtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;      </font><font color="#008000"><i>{Point the endpointer to the begin}
           </i></font><font color="#FF0000"><b>end else
           begin
              </b></font>EndPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font>UsePtr<font color="#000080">; </font><font color="#008000"><i>{Stick the new record to the previous}
              </i></font><font color="#FF0000"><b>If </b></font>UsePtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
                 </b></font>EndPtr <font color="#000080">:= </font>UsePtr<font color="#000080">;  </font><font color="#008000"><i>{Point the EndPtr to the last record}
           </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>FileFound<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Descript <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
            </b></font>UsePtr <font color="#000080">:= </font>New<font color="#000080">(</font>FileInfo<font color="#000080">); </font><font color="#008000"><i>{Create a new record}
            </i></font>UsePtr<font color="#000080">^.</font>FileName <font color="#000080">:= </font>StrNew<font color="#000080">(</font>StrUpper<font color="#000080">(</font>getName<font color="#000080">(</font>Name<font color="#000080">)));
            </font>UsePtr<font color="#000080">^.</font>Str <font color="#000080">:= </font>StrNew<font color="#000080">(</font>Descript<font color="#000080">);
            </font>UsePtr<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
            </font>EndPtr<font color="#000080">^.</font>Next <font color="#000080">:= </font>UsePtr<font color="#000080">;
            </font>EndPtr <font color="#000080">:= </font>UsePtr<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Close<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{Close file}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>WriteInfo<font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
      </b></font>SetFAttr<font color="#000080">(</font>f<font color="#000080">, </font>faArchive<font color="#000080">); </font><font color="#008000"><i>{Unhide the file}
      </i></font>WriteInfo <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#008000"><i>{$I-} </i></font>Rewrite<font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
      </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
         </b></font>WriteInfo <font color="#000080">:= </font>False<font color="#000080">;
         </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>BeginPtr<font color="#000080">=</font><font color="#FF0000"><b>nil then
      begin
           </b></font>Close<font color="#000080">(</font>f<font color="#000080">);   </font><font color="#008000"><i>{No descriptions: delete file}
           </i></font>Erase<font color="#000080">(</font>f<font color="#000080">);
           </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font>BeginPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
      Begin
           </b></font>Writeln<font color="#000080">(</font>f<font color="#000080">, </font>BeginPtr<font color="#000080">^.</font>FileName<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>BeginPtr<font color="#000080">^.</font>Str<font color="#000080">);
           </font>UsePtr <font color="#000080">:= </font>BeginPtr<font color="#000080">;
           </font>BeginPtr <font color="#000080">:= </font>UsePtr<font color="#000080">^.</font>Next<font color="#000080">; </font><font color="#008000"><i>{Move the begin-pointer 1 up}
           </i></font>Dispose<font color="#000080">(</font>UsePtr<font color="#000080">);      </font><font color="#008000"><i>{Delete first record}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Close<font color="#000080">(</font>f<font color="#000080">);
      </font>SetFAttr<font color="#000080">(</font>f<font color="#000080">, </font>faHidden<font color="#000080">); </font><font color="#008000"><i>{Hide the DESCRIPT.ION file}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>SetDescript <font color="#000080">:= </font>False<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Name<font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>Name<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>Exit<font color="#000080">;                              </font><font color="#008000"><i>{If there's no name specified: quit}
     </i></font>Assign<font color="#000080">(</font>f<font color="#000080">, </font>GetDescriptFileName<font color="#000080">(</font>Name<font color="#000080">)); </font><font color="#008000"><i>{Open DESCRIPT.ION}
     </i></font>SetTextBuf<font color="#000080">(</font>f<font color="#000080">, </font>IOBuf<font color="#000080">);                 </font><font color="#008000"><i>{create a 2Kb buffer}
     </i></font>ReadInfo<font color="#000080">;                             </font><font color="#008000"><i>{Read the descriptions}
     </i></font>SetDescript <font color="#000080">:= </font>WriteInfo<font color="#000080">;             </font><font color="#008000"><i>{Write the descriptions}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0087.PAS">Original</a><b>]</b></p></body>
</html>
