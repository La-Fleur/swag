<html>
<head><title> "DOS Redirection of text" by ANDREW EIGUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 MH&gt; Could anyone know how to redirect a standard output (CRT) to a file using
 MH&gt; standard Write/WriteLn(Output,...) Pascal procedures ?

I was playing around with this about two hours and i still didn't figure out
how to construct my program so Crt standard write and writeln procedures would
write depending on which device you specified in the command line.

So i left idea to trouble myself more and wrote my own dependent write
procedures that will print only string-typed variables, but at least can be
redirected to any other device than CONsole device. :)

Now my code goes:

{---cut here---}

</i></font><font color="#FF0000"><b>Program </b></font>SupportingRedirectionWithCrt<font color="#000080">;
</font><font color="#008000"><i>{ Public Domain, by Andrew Eigus }

</i></font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DevWrite<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Device-dependent write procedure }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">push ds
  lds si,Str
  cld
  xor ax,ax
  lodsb
  mov cx,ax
  mov dx,si
  mov bx,1 </font><font color="#008000"><i>{ standard output device }
  </i></font><font color="#FF00FF">mov ah,40h
  int 21h
  pop ds
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ DevWrite }

</i></font><font color="#FF0000"><b>Procedure </b></font>DevWriteLn<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Device-dependent writeln procedure }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">les si,Str
  push es
  push si
  call DevWrite
  mov ah,02h
  mov dl,0Dh
  int 21h
  mov dl,0Ah
  int 21h
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ DevWriteLn }

</i></font><font color="#FF0000"><b>Begin
  </b></font>DevWriteLn<font color="#000080">(</font><font color="#800000">'Hello, world!'#13#10</font><font color="#000080">);
  </font>DevWriteLn<font color="#000080">(</font><font color="#800000">'This text might be freely redirected to any device from the'</font><font color="#000080">);
  </font>DevWriteLn<font color="#000080">(</font><font color="#800000">'command line.'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">#13#10'And this text may appear on screen only.'</font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
