<html>
<head><title> "Extended SearchRec" by STEVE ROGERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  OK, here's a problem. FExpand takes Newest.Name and appends it to the
  full CURRENT path, not the path you specified on the command line. You
  have to keep track of that path yourself. Or, here's a unit that might
  help. It's an Expanded Searchrec that returns a full filespec.
}

</i></font><font color="#FF0000"><b>unit </b></font>EXSRec<font color="#000080">;
</font><font color="#008000"><i>{ Written by Steve Rogers - 1994. Released to public domain }

</i></font><font color="#FF0000"><b>interface
uses
  </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>EXSearchRec <font color="#000080">= </font><font color="#FF0000"><b>record           </b></font><font color="#008000"><i>{ EXtended searchrec       }
    </i></font>name <font color="#000080">: </font>pathstr<font color="#000080">;              </font><font color="#008000"><i>{ fully specified filename }
    </i></font>dsub <font color="#000080">: </font>searchrec<font color="#000080">;            </font><font color="#008000"><i>{ dos.searchrec            }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ffirst<font color="#000080">(</font>path <font color="#000080">: </font>pathstr<font color="#000080">;</font>attr <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>dd <font color="#000080">: </font>EXSearchRec<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>fnext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>dd <font color="#000080">: </font>EXSearchRec<font color="#000080">);

</font><font color="#FF0000"><b>implementation

procedure </b></font>ffirst<font color="#000080">(</font>path <font color="#000080">: </font>pathstr<font color="#000080">;</font>attr <font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>dd <font color="#000080">: </font>EXSearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>findfirst<font color="#000080">(</font>path<font color="#000080">,</font>attr<font color="#000080">,</font>dd<font color="#000080">.</font>dsub<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>doserror<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then with </b></font>dd <font color="#FF0000"><b>do begin
    </b></font>name<font color="#000080">:= </font>path<font color="#000080">;
    </font><font color="#FF0000"><b>while not </b></font><font color="#000080">(</font>name<font color="#000080">[</font>length<font color="#000080">(</font>name<font color="#000080">)] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'\'</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">])
      </font><font color="#FF0000"><b>do </b></font>dec<font color="#000080">(</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font>name<font color="#000080">:= </font>name<font color="#000080">+</font>dsub<font color="#000080">.</font>name<font color="#000080">;
  </font><font color="#FF0000"><b>end else </b></font>dd<font color="#000080">.</font>name<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>fnext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>dd <font color="#000080">: </font>EXSearchRec<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>findnext<font color="#000080">(</font>dd<font color="#000080">.</font>dsub<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>doserror<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then with </b></font>dd <font color="#FF0000"><b>do begin
    while not </b></font><font color="#000080">(</font>dd<font color="#000080">.</font>name<font color="#000080">[</font>length<font color="#000080">(</font>dd<font color="#000080">.</font>name<font color="#000080">)] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'\'</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">])
      </font><font color="#FF0000"><b>do </b></font>dec<font color="#000080">(</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font>name<font color="#000080">:= </font>name<font color="#000080">+</font>dsub<font color="#000080">.</font>name<font color="#000080">;
  </font><font color="#FF0000"><b>end else </b></font>dd<font color="#000080">.</font>name<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{----------------------}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p></body>
</html>
