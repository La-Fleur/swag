<html>
<head><title> "Re: Detecting devices" by PETER LOUWEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 BP&gt; Is there some way I can use interrupts or whatever to detect whether
 BP&gt; the &quot;file name&quot; contained in the S string variable is a device name
 BP&gt; (such as &quot;CON&quot;, &quot;LPT1&quot;, &quot;AUX&quot;, etc) or not?

Yes: use the ubiquitious INT $21. }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsDevice<font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>Fname<font color="#000080">: </font>PathStr<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{ -- Returns TRUE if named file is actually a device.
  -- Example: IsDevice('CON') = TRUE, IsDevice(paramstr(0)) = FALSE.
  -- N.B.: returns FALSE if FName is a non-existent file. }
</i></font><font color="#FF0000"><b>VAR </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;
    </font>F   <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
    </font>FH  <font color="#000080">: </font>word <font color="#FF0000"><b>ABSOLUTE </b></font>F<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font>IsDevice <font color="#000080">:= </font>FALSE<font color="#000080">;
      </font>assign<font color="#000080">(</font>F<font color="#000080">, </font>Fname<font color="#000080">);
      </font>reset<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>IOresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>WITH </b></font>Regs
      <font color="#FF0000"><b>DO BEGIN </b></font><font color="#008000"><i>{ -- Get information about file: }
               </i></font>AX <font color="#000080">:= </font><font color="#800000">$4400</font><font color="#000080">;
               </font>BX <font color="#000080">:= </font>FH<font color="#000080">;
               </font>MsDos<font color="#000080">(</font>Regs<font color="#000080">);
               </font><font color="#FF0000"><b>IF NOT </b></font>odd<font color="#000080">(</font>Flags<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>DL <font color="#FF0000"><b>AND </b></font><font color="#800000">$80 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)
               </font><font color="#FF0000"><b>THEN </b></font>IsDevice <font color="#000080">:= </font>TRUE
         <font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>close<font color="#000080">(</font>F<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>IOresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p></body>
</html>
