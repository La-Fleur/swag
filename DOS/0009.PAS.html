<html>
<head><title> "National Language Support" by ANDRES CVITKOVICH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{&Auml; Fido Pascal Conference &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; PASCAL &Auml;
Msg  : 493 of 505
From : Andres Cvitkovich                   2:310/36.9           28 Apr 93  22:59
To   : Jon Leosson                         2:391/20.0
Subj : Reading the country info
&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
Hi Jon,

Wednesday, April 14 1993, Jon Leosson wrote to All:

 JL&gt; Does anybody know how one can read the country info which is set by
 JL&gt; COUNTRY.SYS in DOS 4.0 and 5.0?  Any help would be appreciated...

or DOS 6.0 or DOS 3.x or ...  ;-)

here we go:

---------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Unit </b></font>NLS<font color="#000080">;

</font><font color="#008000"><i>{ NLS.PAS - National Language Support }
{ &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml; }
{ (W)  Written 1992  by A. Cvitkovich }

</i></font><font color="#FF0000"><b>INTERFACE

CONST
      </b></font>DATE_USA    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>DATE_EUROPE <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
      </font>DATE_JAPAN  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
      </font>TIME_12HOUR <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>TIME_24HOUR <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
      </b></font>CountryInfo <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>ciDateFormat    <font color="#000080">: </font>Word<font color="#000080">;
        </font>ciCurrency      <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
        </font>ciThousands     <font color="#000080">: </font>Char<font color="#000080">;
        </font>ciASCIIZ_1      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciDecimal       <font color="#000080">: </font>Char<font color="#000080">;
        </font>ciASCIIZ_2      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciDateSep       <font color="#000080">: </font>Char<font color="#000080">;
        </font>ciASCIIZ_3      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciTimeSep       <font color="#000080">: </font>Char<font color="#000080">;
        </font>ciASCIIZ_4      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciBitField      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciCurrencyPlaces<font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciTimeFormat    <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciCaseMap       <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;
        </font>ciDataSep       <font color="#000080">: </font>Char<font color="#000080">;
        </font>ciASCIIZ_5      <font color="#000080">: </font>Byte<font color="#000080">;
        </font>ciReserved      <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte
      <font color="#FF0000"><b>End</b></font><font color="#000080">;

      </font>DateString <font color="#000080">= </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
      </font>TimeString <font color="#000080">= </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];

</font><font color="#FF0000"><b>VAR   </b></font>Country       <font color="#000080">: </font>CountryInfo<font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>GetCountryInfo <font color="#000080">(</font>Buf<font color="#000080">: </font>Pointer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>DateStr<font color="#000080">: </font>DateString<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>TimeStr<font color="#000080">: </font>TimeString<font color="#000080">;


</font><font color="#FF0000"><b>IMPLEMENTATION

USES </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetCountryInfo <font color="#000080">(</font>Buf<font color="#000080">: </font>Pointer<font color="#000080">): </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">mov  ax, 3800h
    push ds
    lds  dx, Buf
    int  21h
    mov  al, TRUE
    jnc  @@1
    xor  al, al
@@1:
    pop  ds
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>DateStr<font color="#000080">: </font>DateString<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>Year<font color="#000080">, </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>Weekday  <font color="#000080">: </font>Word<font color="#000080">;
      </font>dd<font color="#000080">, </font>mm                     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
      </font>yy                         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetDate <font color="#000080">(</font>Year<font color="#000080">, </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>WeekDay<font color="#000080">);
  </font>Str <font color="#000080">(</font>Day<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>dd<font color="#000080">);    </font><font color="#FF0000"><b>If </b></font>dd<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>dd<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str <font color="#000080">(</font>Month<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>mm<font color="#000080">);  </font><font color="#FF0000"><b>If </b></font>mm<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>mm<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str <font color="#000080">(</font>Year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">, </font>yy<font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>Country<font color="#000080">.</font>ciDateFormat <font color="#FF0000"><b>Of
    </b></font>DATE_USA<font color="#000080">:    </font>DateStr <font color="#000080">:= </font>mm <font color="#000080">+ </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>dd <font color="#000080">+
                            </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>yy<font color="#000080">;
    </font>DATE_EUROPE<font color="#000080">: </font>DateStr <font color="#000080">:= </font>dd <font color="#000080">+ </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>mm <font color="#000080">+
                            </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>yy<font color="#000080">;
    </font>DATE_JAPAN<font color="#000080">:  </font>DateStr <font color="#000080">:= </font>yy <font color="#000080">+ </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>mm <font color="#000080">+
                            </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">+ </font>dd<font color="#000080">;
    </font><font color="#FF0000"><b>Else         </b></font>DateStr <font color="#000080">:= </font><font color="#800000">''
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>TimeStr<font color="#000080">: </font>TimeString<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>Hour<font color="#000080">, </font>Min<font color="#000080">, </font>Sec<font color="#000080">, </font>Sec100  <font color="#000080">: </font>Word<font color="#000080">;
      </font>hh<font color="#000080">, </font>mm<font color="#000080">, </font>ss              <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
      </font>ampm                    <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GetTime <font color="#000080">(</font>Hour<font color="#000080">, </font>Min<font color="#000080">, </font>Sec<font color="#000080">, </font>Sec100<font color="#000080">);
  </font>Str <font color="#000080">(</font>Min<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>mm<font color="#000080">);    </font><font color="#FF0000"><b>If </b></font>mm<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>mm<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str <font color="#000080">(</font>Sec<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>ss<font color="#000080">);    </font><font color="#FF0000"><b>If </b></font>ss<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>ss<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>Country<font color="#000080">.</font>ciTimeFormat <font color="#FF0000"><b>Of
    </b></font>TIME_12HOUR<font color="#000080">: </font><font color="#FF0000"><b>Begin
                   If </b></font>Hour <font color="#000080">&lt; </font><font color="#800000">12 </font><font color="#FF0000"><b>Then </b></font>ampm <font color="#000080">:= </font><font color="#800000">'a' </font><font color="#FF0000"><b>Else </b></font>ampm <font color="#000080">:= </font><font color="#800000">'p'</font><font color="#000080">;
                   </font>Hour <font color="#000080">:= </font>Hour <font color="#FF0000"><b>MOD </b></font><font color="#800000">12</font><font color="#000080">;
                   </font><font color="#FF0000"><b>If </b></font>Hour <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Hour <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;  </font>Str <font color="#000080">(</font>Hour<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>hh<font color="#000080">);
                   </font>TimeStr <font color="#000080">:= </font>hh <font color="#000080">+ </font>Country<font color="#000080">.</font>ciTimeSep <font color="#000080">+ </font>mm <font color="#000080">+
                              </font>Country<font color="#000080">.</font>ciTimeSep <font color="#000080">+ </font>ss <font color="#000080">+ </font>ampm <font color="#000080">+ </font><font color="#800000">'m'
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>TIME_24HOUR<font color="#000080">: </font><font color="#FF0000"><b>Begin
                   </b></font>Str <font color="#000080">(</font>Hour<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>hh<font color="#000080">);
                   </font>TimeStr <font color="#000080">:= </font>hh <font color="#000080">+ </font>Country<font color="#000080">.</font>ciTimeSep <font color="#000080">+ </font>mm <font color="#000080">+
                              </font>Country<font color="#000080">.</font>ciTimeSep <font color="#000080">+ </font>ss
                 <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Else </b></font>TimeStr <font color="#000080">:= </font><font color="#800000">''
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
  If Not </b></font>GetCountryInfo <font color="#000080">(@</font>Country<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
     </b></font>Country<font color="#000080">.</font>ciDateFormat <font color="#000080">:= </font>DATE_USA<font color="#000080">;
     </font>Country<font color="#000080">.</font>ciDateSep <font color="#000080">:= </font><font color="#800000">'-'</font><font color="#000080">;
     </font>Country<font color="#000080">.</font>ciTimeFormat <font color="#000080">:= </font>TIME_12HOUR<font color="#000080">;
     </font>Country<font color="#000080">.</font>ciTimeSep <font color="#000080">:= </font><font color="#800000">':'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
