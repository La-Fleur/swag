<html>
<head><title> "Long Filename unit (updated)" by ARNE DE BRUIJN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
I've made a Windows 95 long filename DOS unit. The file opening part is
missing, maybe I will add it someday. A simple test program is after the end
of part 2. }

{ Long filename DOS unit, Arne de Bruijn, 19960402, Public Domain }
{ All functions return the errorcode, and store it in DosError in }
{ the Dos unit. }
{ The functions work only if Windows 95 is loaded! }

</i></font><font color="#FF0000"><b>unit </b></font>ldos<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses </b></font>dos<font color="#000080">;
</font><font color="#FF0000"><b>type
 </b></font>TLSearchRec<font color="#000080">=</font><font color="#FF0000"><b>record
  </b></font>Attr<font color="#000080">:</font>longint<font color="#000080">;
  </font>CreationTime<font color="#000080">,</font>LastAccessTime<font color="#000080">,</font>LastModTime<font color="#000080">:</font>comp<font color="#000080">; </font><font color="#008000"><i>{ See below for conversion }
  </i></font>HiSize<font color="#000080">,</font>LoSize<font color="#000080">:</font>longint<font color="#000080">;
  </font>Reserved<font color="#000080">:</font>comp<font color="#000080">;
  </font>Name<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">259</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>ShortName<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">; </font><font color="#008000"><i>{ Only if longname exists }
  </i></font>Handle<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LFindFirst<font color="#000080">(</font>FileSpec<font color="#000080">:</font>pchar<font color="#000080">; </font>Attr<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Search for files }

</i></font><font color="#FF0000"><b>function </b></font>LFindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Find next file }

</i></font><font color="#FF0000"><b>function </b></font>LFindClose<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Free search handle }

</i></font><font color="#FF0000"><b>function </b></font>LTruename<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Return complete path, if relative uppercased longnames added, }
{ in buffer Result (261 bytes) }

</i></font><font color="#FF0000"><b>function </b></font>LGetShortName<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Return complete short name/path for input file/path in buffer }
{ Result (79 bytes) }

</i></font><font color="#FF0000"><b>function </b></font>LGetLongName<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Return complete long name/path for input file/path in buffer }
{ Result (261 bytes) }

</i></font><font color="#FF0000"><b>function </b></font>LFileSystemInfo<font color="#000080">(</font>RootName<font color="#000080">:</font>pchar<font color="#000080">; </font>FSName<font color="#000080">:</font>pchar<font color="#000080">; </font>FSNameBufSize<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>Flags<font color="#000080">,</font>MaxFileNameLen<font color="#000080">,</font>MaxPathLen<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Return File System Information, for FSName 32 bytes should be sufficient }
{ Rootname is for example 'C:\' }
{ Flags: }
{ bit
{  0   searches are case sensitive }
{  1   preserves case in directory entries }
{  2   uses Unicode characters in file and directory names }
{ 3-13 reserved (0) }
{ 14   supports DOS long filename functions }
{ 15   volume is compressed }


</i></font><font color="#FF0000"><b>function </b></font>LErase<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Erase file }

</i></font><font color="#FF0000"><b>function </b></font>LMkDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Make directory }

</i></font><font color="#FF0000"><b>function </b></font>LRmDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Remove directory }

</i></font><font color="#FF0000"><b>function </b></font>LChDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Change current directory }

</i></font><font color="#FF0000"><b>function </b></font>LGetDir<font color="#000080">(</font>Drive<font color="#000080">:</font>byte<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Get current drive and directory. Drive: 0=current, 1=A: etc. }

</i></font><font color="#FF0000"><b>function </b></font>LGetAttr<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Attr<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Get file attributes}

</i></font><font color="#FF0000"><b>function </b></font>LSetAttr<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">; </font>Attr<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Set file attributes }

</i></font><font color="#FF0000"><b>function </b></font>LRename<font color="#000080">(</font>OldFilename<font color="#000080">,</font>NewFilename<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#008000"><i>{ Rename file }

</i></font><font color="#FF0000"><b>function </b></font>LTimeToDos<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>LTime<font color="#000080">:</font>comp<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#008000"><i>{ Convert 64-bit number of 100ns since 01-01-1601 UTC to local DOS format time
}{ (LTime is var to avoid putting it on the stack) }

</i></font><font color="#FF0000"><b>procedure </b></font>UnpackLTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>LTime<font color="#000080">:</font>comp<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>DT<font color="#000080">:</font>DateTime<font color="#000080">);
</font><font color="#008000"><i>{ Convert 64-bit time to date/time record }
</i></font><font color="#FF0000"><b>implementation
function </b></font>LFindFirst<font color="#000080">(</font>FileSpec<font color="#000080">:</font>pchar<font color="#000080">; </font>Attr<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Search for files }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,FileSpec
 les di,SRec
 mov cx,Attr
 xor si,si
 mov ax,714eh
 int 21h
 pop ds
 sbb bx,bx
 mov es:[di].TLSearchRec.Handle,ax
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LFindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Find next file }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">mov ax,714fh
 xor si,si
 les di,SRec
 mov bx,es:[di].TLSearchRec.Handle
 int 21h
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ corrects bug in LDOS .. }
</i></font><font color="#FF0000"><b>function </b></font>LFindClose<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Free search handle }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#008000"><i>{mov ax,714fh}
 </i></font><font color="#FF00FF">mov ax,71A1h
 mov bx,es:[di].TLSearchRec.Handle
 int 21h
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LTrueName<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return complete path, if relative uppercased longnames added, }
{ in buffer Result (261 bytes) }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 mov ax,7160h
 xor cx,cx
 lds si,FileName
 les di,Result
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LGetShortName<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return complete short name/path for input file/path in buffer }
{ Result (79 bytes) }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds si,FileName
 les di,Result
 mov ax,7160h
 mov cx,1
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>LGetLongName<font color="#000080">(</font>FileName<font color="#000080">:</font>pchar<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return complete long name/path for input file/path in buffer }
{ Result (261 bytes) }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds si,FileName
 les di,Result
 mov ax,7160h
 mov cx,2
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LFileSystemInfo<font color="#000080">(</font>RootName<font color="#000080">:</font>pchar<font color="#000080">; </font>FSName<font color="#000080">:</font>pchar<font color="#000080">; </font>FSNameBufSize<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>Flags<font color="#000080">,</font>MaxFileNameLen<font color="#000080">,</font>MaxPathLen<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return File System Information, for FSName 32 bytes should be sufficient }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,RootName
 les di,FSName
 mov cx,FSNameBufSize
 mov ax,71a0h
 int 21h
 pop ds
 les di,Flags
 mov es:[di],bx
 les di,MaxFileNameLen
 mov es:[di],cx
 les di,MaxPathLen
 mov es:[di],dx
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LTimeToDos<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>LTime<font color="#000080">:</font>comp<font color="#000080">):</font>longint<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Convert 64-bit number of 100ns since 01-01-1601 UTC to local DOS format time
}{ (LTime is var to avoid putting it on the stack) }
</i></font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds si,LTime
 xor bl,bl
 mov ax,71a7h
 int 21h
 pop ds
 mov ax,cx
 cmc
 sbb cx,cx
 and ax,cx
 and dx,cx
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>UnpackLTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>LTime<font color="#000080">:</font>comp<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>DT<font color="#000080">:</font>DateTime<font color="#000080">);
</font><font color="#008000"><i>{ Convert 64-bit time to date/time record }
</i></font><font color="#FF0000"><b>begin
 </b></font>UnpackTime<font color="#000080">(</font>LTimeToDos<font color="#000080">(</font>LTime<font color="#000080">),</font>DT<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LMkDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Directory
 mov ax,7139h
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LRmDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Directory
 mov ax,713ah
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LChDir<font color="#000080">(</font>Directory<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Directory
 mov ax,713bh
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LErase<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Filename
 mov ax,7141h
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LGetAttr<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Attr<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Filename
 mov ax,7143h
 xor bl,bl
 int 21h
 pop ds
 les di,Attr
 mov es:[di],cx
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LSetAttr<font color="#000080">(</font>Filename<font color="#000080">:</font>pchar<font color="#000080">; </font>Attr<font color="#000080">:</font>word<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,Filename
 mov ax,7143h
 mov bl,1
 mov cx,Attr
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LGetDir<font color="#000080">(</font>Drive<font color="#000080">:</font>byte<font color="#000080">; </font>Result<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">cld
 les di,Result
 mov al,Drive
 mov dl,al
 dec al
 jns @GotDrive
 mov ah,19h
 int 21h
@GotDrive:
 add al,41h
 mov ah,':'
 stosw
 mov ax,'\'
 stosw
 push ds
 push es
 pop ds
 mov si,di
 dec si
 mov ax,7147h
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LRename<font color="#000080">(</font>OldFilename<font color="#000080">,</font>NewFilename<font color="#000080">:</font>pchar<font color="#000080">):</font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds
 lds dx,OldFilename
 les di,NewFilename
 mov ax,7156h
 int 21h
 pop ds
 sbb bx,bx
 and ax,bx
 mov [DosError],ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


=== </font>LDOSTEST<font color="#000080">.</font>PAS
<font color="#008000"><i>{ Simple sample for LDOS unit, Arne de Bruijn, 19960402, Public Domain }
</i></font><font color="#FF0000"><b>uses </b></font>ldos<font color="#000080">,</font>strings<font color="#000080">,</font>dos<font color="#000080">;
</font><font color="#FF0000"><b>type </b></font>string2<font color="#000080">=</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
</font><font color="#FF0000"><b>function </b></font>Str0<font color="#000080">(</font>B<font color="#000080">:</font>byte<font color="#000080">):</font>string2<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>Str0<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#2</font><font color="#000080">; </font>Str0<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>char<font color="#000080">(</font>B <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">+</font><font color="#800000">48</font><font color="#000080">); </font>Str0<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>char<font color="#000080">(</font>B <font color="#FF0000"><b>mod </b></font><font color="#800000">10</font><font color="#000080">+</font><font color="#800000">48</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>Buf<font color="#000080">,</font>BufO<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">261</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
 </font>SRec<font color="#000080">:</font>TLSearchRec<font color="#000080">;
 </font>DT<font color="#000080">:</font>DateTime<font color="#000080">;
 </font>LN<font color="#000080">,</font>SN<font color="#000080">:</font>pchar<font color="#000080">;
 </font>W1<font color="#000080">,</font>W2<font color="#000080">,</font>W3<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Write<font color="#000080">(</font><font color="#800000">'Enter path:'</font><font color="#000080">); </font>ReadLn<font color="#000080">(</font>Buf<font color="#000080">);
 </font>WriteLn<font color="#000080">(</font><font color="#800000">'LFileSystemInfo:'</font><font color="#000080">,</font>LFileSystemInfo<font color="#000080">(</font>Buf<font color="#000080">,</font>BufO<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">,</font>W1<font color="#000080">,</font>W2<font color="#000080">,</font>W3<font color="#000080">),
  </font><font color="#800000">' = '</font><font color="#000080">,</font>BufO<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>W1<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>W2<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>W3<font color="#000080">);
 </font>WriteLn<font color="#000080">(</font><font color="#800000">'LTruename:'</font><font color="#000080">,</font>LTrueName<font color="#000080">(</font>Buf<font color="#000080">,</font>BufO<font color="#000080">),</font><font color="#800000">' = '</font><font color="#000080">,</font>BufO<font color="#000080">);
 </font>WriteLn<font color="#000080">(</font><font color="#800000">'LGetShortName:'</font><font color="#000080">,</font>LGetShortName<font color="#000080">(</font>Buf<font color="#000080">,</font>BufO<font color="#000080">),</font><font color="#800000">' = '</font><font color="#000080">,</font>BufO<font color="#000080">);
 </font>WriteLn<font color="#000080">(</font><font color="#800000">'LGetLongName:'</font><font color="#000080">,</font>LGetLongName<font color="#000080">(</font>Buf<font color="#000080">,</font>BufO<font color="#000080">),</font><font color="#800000">' = '</font><font color="#000080">,</font>BufO<font color="#000080">);
 </font>LFindFirst<font color="#000080">(</font>Buf<font color="#000080">,</font><font color="#800000">16</font><font color="#000080">,</font>SRec<font color="#000080">);
 </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
   </b></font>UnpackLTime<font color="#000080">(</font>SRec<font color="#000080">.</font>lastmodtime<font color="#000080">,</font>DT<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>SRec<font color="#000080">.</font>ShortName<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
    begin </b></font>SN<font color="#000080">:=@</font>SRec<font color="#000080">.</font>name<font color="#000080">; </font>ln<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">; </font><font color="#FF0000"><b>end
   else
    begin </b></font>SN<font color="#000080">:=@</font>SRec<font color="#000080">.</font>shortname<font color="#000080">; </font>ln<font color="#000080">:=@</font>SRec<font color="#000080">.</font>name<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>with </b></font>DT <font color="#FF0000"><b>do </b></font>WriteLn<font color="#000080">(</font>SN<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">:</font><font color="#800000">13</font><font color="#000080">-</font>StrLen<font color="#000080">(</font>SN<font color="#000080">),</font>SRec<font color="#000080">.</font>LoSize<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,
     </font><font color="#800000">' '</font><font color="#000080">,</font>Day<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font>Str0<font color="#000080">(</font>Month<font color="#000080">),</font><font color="#800000">'-'</font><font color="#000080">,</font>Year<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>Hour<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>Str0<font color="#000080">(</font>Min<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>LN<font color="#000080">);
   </font>LFindNext<font color="#000080">(</font>SRec<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>LFindClose<font color="#000080">(</font>SRec<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p></body>
</html>
