<html>
<head><title> "APPEND, ASSIGN & SHARE" by GREG VIGNEAULT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{===========================================================================
Date: 09-22-93 (08:41)
From: GREG VIGNEAULT
Subj: APPEND, ASSIGN, &amp; SHARE
---------------------------------------------------------------------------
JS&gt; How could I determine if DOS extension utilities (eg. Append,
  &gt; Assign, and Share) are installed, using Turbo Pascal? }

(* Turbo/Quick/StonyBrook Pascal: Determine if extensions installed *)
</i></font><font color="#FF0000"><b>PROGRAM </b></font>DosExt<font color="#000080">;               </font><font color="#008000"><i>{ DOSEXT.PAS: Greg Vigneault 93.10.02  }

</i></font><font color="#FF0000"><b>USES </b></font>Dos<font color="#000080">;                     </font><font color="#008000"><i>{ Import Intr(), MsDos(), Registers    }

</i></font><font color="#FF0000"><b>TYPE </b></font>Extension <font color="#000080">= (</font>Append<font color="#000080">, </font>Assign<font color="#000080">, </font>Share<font color="#000080">); </font><font color="#008000"><i>{ the PC/MS-DOS extensions }

</i></font><font color="#FF0000"><b>VAR  </b></font>Reg        <font color="#000080">: </font>Registers<font color="#000080">;  </font><font color="#008000"><i>{ to access Intel 80x86 CPU registers  }
     </i></font>Status     <font color="#000080">: </font>WORD<font color="#000080">;       </font><font color="#008000"><i>{ to return system extension status    }
     </i></font>Installed  <font color="#000080">: </font>Extension<font color="#000080">;  </font><font color="#008000"><i>{ DOS extension (Append|Assign|Share)  }
     </i></font>Okay       <font color="#000080">: </font>BOOLEAN<font color="#000080">;    </font><font color="#008000"><i>{ success or failure (TRUE|FALSE)      }
     </i></font>Func       <font color="#000080">: </font>BYTE<font color="#000080">;       </font><font color="#008000"><i>{ the multiplex function number        }

(*------------------------------------------------------------------*)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>DosVersion <font color="#000080">: </font>WORD<font color="#000080">;                 </font><font color="#008000"><i>{ to check DOS version   }
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$30</font><font color="#000080">;                          </font><font color="#008000"><i>{ function:get DOS ver   }
    </i></font>MsDos <font color="#000080">(</font>Reg<font color="#000080">);                            </font><font color="#008000"><i>{ call DOS services      }
    </i></font>DosVersion <font color="#000080">:= </font>Reg<font color="#000080">.</font>AL <font color="#000080">* </font><font color="#800000">100 </font><font color="#000080">+ </font>Reg<font color="#000080">.</font>AH<font color="#000080">;    </font><font color="#008000"><i>{ ...version times 100   }
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{DosVersion}</i></font><font color="#000080">;

</font><font color="#008000"><i>(*------------------------------------------------------------------*)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Multiplex <font color="#000080">(</font>Func <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Status <font color="#000080">: </font>WORD<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
      </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font>Func<font color="#000080">;                       </font><font color="#008000"><i>{ function number        }
      </i></font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                          </font><font color="#008000"><i>{ subfunction:get status }
      </i></font>Intr <font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">,</font>Reg<font color="#000080">);                       </font><font color="#008000"><i>{ do multiplex interrupt }
      </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Reg<font color="#000080">.</font>Flags <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN  </b></font><font color="#008000"><i>{ an error condition?    }
        </i></font>Status <font color="#000080">:= </font>Reg<font color="#000080">.</font>AX<font color="#000080">;                   </font><font color="#008000"><i>{ the DOS error code     }
        </i></font>Multiplex <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#FF0000"><b>END             </b></font><font color="#008000"><i>{ and flag the error     }
      </i></font><font color="#FF0000"><b>ELSE BEGIN
        </b></font>Status <font color="#000080">:= </font>WORD<font color="#000080">(</font>Reg<font color="#000080">.</font>AL<font color="#000080">);             </font><font color="#008000"><i>{ the function status    }
        </i></font>Multiplex <font color="#000080">:= </font>TRUE<font color="#000080">;                  </font><font color="#008000"><i>{ and flag success       }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Multiplex}</i></font><font color="#000080">;

</font><font color="#008000"><i>(*------------------------------------------------------------------*)
</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{DosExt}

  </i></font>WriteLn<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>DosVersion <font color="#000080">&lt; </font><font color="#800000">330 </font><font color="#FF0000"><b>THEN BEGIN
    </b></font>WriteLn <font color="#000080">(</font><font color="#800000">'PC/MS-DOS version is too low, sorry.'</font><font color="#000080">);
    </font>Halt <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FOR </b></font>Installed <font color="#000080">:= </font>Append <font color="#FF0000"><b>TO </b></font>Share <font color="#FF0000"><b>DO BEGIN
    CASE </b></font>Installed <font color="#FF0000"><b>OF
      </b></font>Append <font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font>Write <font color="#000080">(</font><font color="#800000">'APPEND '</font><font color="#000080">); </font>Func <font color="#000080">:= </font><font color="#800000">$B7</font><font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Assign <font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font>Write <font color="#000080">(</font><font color="#800000">'ASSIGN '</font><font color="#000080">); </font>Func <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Share  <font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font>Write <font color="#000080">(</font><font color="#800000">'SHARE  '</font><font color="#000080">); </font>Func <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{CASE}
    </i></font><font color="#FF0000"><b>IF NOT </b></font>Multiplex <font color="#000080">(</font>Func<font color="#000080">,</font>Status<font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>WriteLn <font color="#000080">(</font><font color="#800000">'status unknown (MS-DOS error #'</font><font color="#000080">,</font>Status<font color="#000080">,</font><font color="#800000">').'</font><font color="#000080">)
    </font><font color="#FF0000"><b>ELSE
      CASE </b></font>Status <font color="#FF0000"><b>OF
        </b></font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>Write <font color="#000080">(</font><font color="#800000">'not installed: '</font><font color="#000080">);
                </font><font color="#FF0000"><b>IF </b></font>Status <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>Write <font color="#000080">(</font><font color="#800000">'and NOT '</font><font color="#000080">);
                </font>WriteLn <font color="#000080">(</font><font color="#800000">'okay to install.'</font><font color="#000080">);
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">255 </font><font color="#000080">: </font>WriteLn <font color="#000080">(</font><font color="#800000">'is installed.'</font><font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{CASE &amp; IF}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{FOR}

</i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{DosExt}</i></font><font color="#000080">.
</font><font color="#008000"><i>(********************************************************************)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
