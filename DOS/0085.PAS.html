<html>
<head><title> "Detection of WILDCARDS" by ALLEN WALKER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0085.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's a little routine I wrote that checks to see if S1=S2, with wildcards (?
or *)...  IE, Wildcard('TURBO.PAS','T?R*.?AS') will return TRUE.

Let me know if you find it useful...

Released for SWAG...
}

</i></font><font color="#FF0000"><b>Function </b></font>Wildcard<font color="#000080">(</font>S1<font color="#000080">,</font>S2<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>STmp1 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
    </font>STmp2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
    </font>SS1<font color="#000080">, </font>SS2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
    </font>I <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>STmp1<font color="#000080">:=</font>Copy<font color="#000080">(</font>S1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S1<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">))+</font><font color="#800000">'????????'</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S1<font color="#000080">)&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>STmp2<font color="#000080">:=</font>Copy<font color="#000080">(</font>S1<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S1<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)+</font><font color="#800000">'???' </font><font color="#FF0000"><b>else
</b></font>STmp2<font color="#000080">:=</font><font color="#800000">'???'</font><font color="#000080">;  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do If </b></font>STmp1<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then For </b></font>I<font color="#000080">:=</font>I <font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do
</b></font>STmp1<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">'?'</font><font color="#000080">;  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do If </b></font>STmp2<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then For </b></font>I<font color="#000080">:=</font>I <font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
</b></font>STmp2<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">'?'</font><font color="#000080">;  </font>SS1<font color="#000080">:=</font>STmp1<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>STmp2<font color="#000080">;
  </font>STmp1<font color="#000080">:=</font>Copy<font color="#000080">(</font>S2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S2<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">))+</font><font color="#800000">'????????'</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S2<font color="#000080">)&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>STmp2<font color="#000080">:=</font>Copy<font color="#000080">(</font>S2<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>S2<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)+</font><font color="#800000">'???' </font><font color="#FF0000"><b>else
</b></font>STmp2<font color="#000080">:=</font><font color="#800000">'???'</font><font color="#000080">;  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do If </b></font>STmp1<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then For </b></font>I<font color="#000080">:=</font>I <font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do
</b></font>STmp1<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">'?'</font><font color="#000080">;  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do If </b></font>STmp2<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>then For </b></font>I<font color="#000080">:=</font>I <font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
</b></font>STmp2<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">'?'</font><font color="#000080">;  </font>SS2<font color="#000080">:=</font>STmp1<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>STmp2<font color="#000080">; </font>WildCard<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do If </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>SS1<font color="#000080">[</font>I<font color="#000080">])&lt;&gt;</font>UpCase<font color="#000080">(</font>SS2<font color="#000080">[</font>I<font color="#000080">])) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>SS2<font color="#000080">[</font>I<font color="#000080">]&lt;&gt;</font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then
</b></font>Exit<font color="#000080">;  </font>WildCard<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


--- </font>GoldED <font color="#800000">2.40
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>Crazy Train BBS <font color="#000080">(</font><font color="#800000">604</font><font color="#000080">)</font><font color="#800000">383</font><font color="#000080">-</font><font color="#800000">2201  </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">340</font><font color="#000080">/</font><font color="#800000">88</font><font color="#000080">)
</font>SEEN<font color="#000080">-</font>BY<font color="#000080">: </font><font color="#800000">340</font><font color="#000080">/</font><font color="#800000">1 49 60 67 88 211 396</font><font color="#000080">/</font><font color="#800000">1 3615</font><font color="#000080">/</font><font color="#800000">50 51
</font>PATH<font color="#000080">: </font><font color="#800000">340</font><font color="#000080">/</font><font color="#800000">88 1 3615</font><font color="#000080">/</font><font color="#800000">50
</font>                                                  
<font color="#008000"><i>{SWAG=???.SWG,JORGEN OLSSON,Wild cards}
</i></font>MSGID<font color="#000080">: </font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">205</font><font color="#000080">/</font><font color="#800000">201</font><font color="#000080">@</font>fidonet <font color="#800000">94931</font>c10
REPLY<font color="#000080">: </font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">249</font><font color="#000080">/</font><font color="#800000">153.0 2e</font>a83a7a
PID<font color="#000080">: </font>GE <font color="#800000">1.01</font><font color="#000080">+
</font>Hello<font color="#000080">, </font>John<font color="#000080">!

 &gt; </font>I<font color="#800000">'m looking for some sort of function to return that:
 </font><font color="#000080">&gt; </font>SOMEFILE<font color="#000080">.</font>TXT <font color="#000080">= </font>SOM<font color="#000080">*.</font>TX<font color="#000080">?

 &gt; </font><font color="#FF0000"><b>Function </b></font>WildCompare<font color="#000080">(</font>str1<font color="#000080">,</font>st2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>boolean<font color="#000080">;

</font>Hope you<font color="#800000">'ll find this one useful to you. Not very beautiful (this message
</font>editor <font color="#FF0000"><b>is </b></font>obviously <font color="#FF0000"><b>not </b></font>made <font color="#FF0000"><b>for </b></font>writing <font color="#FF0000"><b>pascal </b></font>source <font color="#000080">:)), </font>but it works<font color="#000080">.

---</font>cut<font color="#000080">---

</font><font color="#FF0000"><b>FUNCTION </b></font>WildComp<font color="#000080">(</font>wild<font color="#000080">,</font>name<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>WildComp<font color="#000080">:=</font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>name <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>CASE </b></font>wild<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'*' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              if </b></font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'.' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>wild<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>WildComp<font color="#000080">:=</font>TRUE<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>wild<font color="#000080">) &gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>wild<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>length<font color="#000080">(</font>name<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">)
              </font><font color="#FF0000"><b>then </b></font>WildComp<font color="#000080">:=</font>WildComp<font color="#000080">(</font>copy<font color="#000080">(</font>wild<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>length<font color="#000080">(</font>wild<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">),
                   </font>copy<font color="#000080">(</font>name<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>name<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>name<font color="#000080">)-</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>name<font color="#000080">)));
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

       </font><font color="#800000">'?'</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              if </b></font>ord<font color="#000080">(</font>wild<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])=</font><font color="#800000">1
                 </font><font color="#FF0000"><b>then </b></font>WildComp<font color="#000080">:=</font>TRUE
                 <font color="#FF0000"><b>else </b></font>WildComp<font color="#000080">:=</font>WildComp<font color="#000080">(</font>copy<font color="#000080">(</font>wild<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>length<font color="#000080">(</font>wild<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">),
                                         </font>copy<font color="#000080">(</font>name<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>length<font color="#000080">(</font>name<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>ELSE if </b></font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font>wild<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]
                 </font><font color="#FF0000"><b>then if </b></font>length<font color="#000080">(</font>wild<font color="#000080">) &gt; </font><font color="#800000">1
                      </font><font color="#FF0000"><b>then </b></font>WildComp<font color="#000080">:=</font>WildComp<font color="#000080">(</font>copy<font color="#000080">(</font>wild<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>length<font color="#000080">(</font>wild<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">),
                                              </font>copy<font color="#000080">(</font>name<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>length<font color="#000080">(</font>name<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">))
                      </font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>name<font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">)
                           </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>length<font color="#000080">(</font>wild<font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">)
                           </font><font color="#FF0000"><b>then </b></font>WildComp<font color="#000080">:=</font>TRUE
                 <font color="#FF0000"><b>else </b></font>WildComp<font color="#000080">:=</font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0085.PAS">Original</a><b>]</b></p></body>
</html>
