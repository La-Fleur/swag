<html>
<head><title> "Get the program Name" by JOSE ALMEIDA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Gets the program name.
  Part of the Heartware Toolkit v2.00 (HTfile.PAS) for Turbo Pascal.
  Author: Jose Almeida. P.O.Box 4185. 1504 Lisboa Codex. Portugal.
          I can also be reached at RIME network, site -&gt;TIB or #5314.
  Feel completely free to use this source code in any way you want, and, if
  you do, please don't forget to mention my name, and, give me and Swag the
  proper credits. }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Get_Prg_Name <font color="#000080">: </font>String8<font color="#000080">;

</font><font color="#008000"><i>{ DESCRIPTION:
    Gets the program name.
  SAMPLE CALL:
    St := Get_Prg_Name;
  RETURNS:
    The program name, e.g., '12345678'
                      or    '$$$$$$$$' if not available.
  NOTES:
    This function excludes the .EXE extension of the program. }

</i></font><font color="#FF0000"><b>var
  </b></font>St    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>F     <font color="#000080">: </font>byte<font color="#000080">;
  </font>Found <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ Get_Prg_Name }
  </i></font>St <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>Found <font color="#000080">:= </font>No<font color="#000080">;
  </font>F <font color="#000080">:= </font>Length<font color="#000080">(</font>St<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>F <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Found<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      if </b></font>St<font color="#000080">[</font>F<font color="#000080">] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
        </b></font>Found <font color="#000080">:= </font>Yes
      <font color="#FF0000"><b>else
        </b></font>Dec<font color="#000080">(</font>F<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>St <font color="#000080">:= </font>Copy<font color="#000080">(</font>St<font color="#000080">,</font>Succ<font color="#000080">(</font>F<font color="#000080">),</font><font color="#800000">255</font><font color="#000080">);
  </font>F<font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>St<font color="#000080">);
  </font>Delete<font color="#000080">(</font>St<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>St <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    </b></font>St <font color="#000080">:= </font><font color="#800000">'$$$$$$$$'</font><font color="#000080">;
  </font>Get_Prg_Name <font color="#000080">:= </font>St<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ Get_Prg_Name }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
