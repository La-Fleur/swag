<html>
<head><title> "Quickly Change DIRS" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
QCD (C) 1995 Scott Tunstall. All rights reserved.
-------------------------------------------------

Using a text file that you have created (called DIRS.TXT) this
routine can quickly CD into any directory without you having
to specify the full path.

(Mind and not overload the table with entries please... will
slow down the old CPU)



For example, in file DIRS.TXT

You could have:

DUNE2
C:\GAMES\DUNE2
...
...
...
...



So whenever this was typed at the command line
CDQ DUNE2

The directory becomes C:\GAMES\DUNE2


You can have as many entries as you like.


}

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">, </font>basics<font color="#000080">;





</font><font color="#FF0000"><b>procedure </b></font>usage<font color="#000080">;
</font><font color="#FF0000"><b>begin

     </b></font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Usage :'</font><font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'QCD &lt;Entry&gt;'</font><font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Where &lt;Entry&gt; is a key related to a specific path'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'contained on the disk (need not be the current disk)'</font><font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Ask Scott for details if still stuck :)'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'E-Mail address: INSC3SAT@RIVER.TAY.AC.UK'</font><font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;





</font><font color="#FF0000"><b>Function </b></font>StrCmp<font color="#000080">(</font>Str1<font color="#000080">, </font>Str2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Str1<font color="#000080">:=</font>upper<font color="#000080">(</font>Str1<font color="#000080">);
  </font>Str2<font color="#000080">:=</font>upper<font color="#000080">(</font>Str2<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Str1<font color="#000080">) = </font>Length<font color="#000080">(</font>Str2<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font>Str1<font color="#000080">, </font>Str2<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>StrCmp <font color="#000080">:= </font>True
  <font color="#FF0000"><b>else
    </b></font>StrCmp <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;






</font><font color="#FF0000"><b>procedure </b></font>change_dir<font color="#000080">(</font>entry <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>text<font color="#000080">;
    </font>currententry<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
    </font>associateddir<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#FF0000"><b>begin
     </b></font>assign<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'\DIRS.TXT'</font><font color="#000080">);
     </font>reset<font color="#000080">(</font>f<font color="#000080">);
     </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
     begin
          </b></font>readln<font color="#000080">(</font>f<font color="#000080">,</font>currententry<font color="#000080">);
          </font>readln<font color="#000080">(</font>f<font color="#000080">,</font>associateddir<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>strcmp<font color="#000080">(</font>entry<font color="#000080">, </font>currententry<font color="#000080">) = </font>True<font color="#000080">) </font><font color="#FF0000"><b>then
             begin
             </b></font>close<font color="#000080">(</font>f<font color="#000080">);
             </font><font color="#008000"><i>{$i-}
             </i></font>chdir<font color="#000080">(</font>associateddir<font color="#000080">);
             </font><font color="#FF0000"><b>if </b></font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                </b></font>writeln<font color="#000080">(</font><font color="#800000">'Directory '</font><font color="#000080">,</font>upper<font color="#000080">(</font>associateddir<font color="#000080">),</font><font color="#800000">' does not exist !!'</font><font color="#000080">);
                </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'No match for '</font><font color="#000080">,</font>upper<font color="#000080">(</font>entry<font color="#000080">),</font><font color="#800000">'!. '</font><font color="#000080">);
     </font>close<font color="#000080">(</font>f<font color="#000080">);
     </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;






</font><font color="#FF0000"><b>begin
     </b></font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Quick CD (C) 1995 Scott Tunstall. All rights reserved.'</font><font color="#000080">);

     </font><font color="#FF0000"><b>case </b></font>paramcount <font color="#FF0000"><b>of
     </b></font><font color="#800000">0 </font><font color="#000080">: </font>usage<font color="#000080">;
     </font><font color="#800000">1 </font><font color="#000080">: </font>change_dir<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
     </font><font color="#FF0000"><b>else
         begin
         </b></font>writeln<font color="#000080">(</font><font color="#800000">'An error occurred: Too many parameters !!'</font><font color="#000080">);
         </font>usage<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DOS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p></body>
</html>
