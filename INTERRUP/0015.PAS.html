<html>
<head><title> "Disable the pause key" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to INTERRUP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Updated KEYBOARD.SWG on January 27, 1994 }

</i></font><font color="#FF0000"><b>UNIT </b></font>NoPause<font color="#000080">;                </font><font color="#008000"><i>{  Unit to disable the pause key                }
                        {  Last Updated  Apr 26/93                      }
                        {  Copyright (C) Greg Estabrooks, 1993          }
</i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{***********************************************************************}
</i></font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">;                       </font><font color="#008000"><i>{ IMPORT SetIntVec,GetIntVec.           }
</i></font><font color="#FF0000"><b>VAR
     </b></font>OldExit   <font color="#000080">:</font>POINTER<font color="#000080">;        </font><font color="#008000"><i>{  To hold pointer to old exit proc     }
     </i></font>OldInt09  <font color="#000080">:</font>POINTER<font color="#000080">;        </font><font color="#008000"><i>{  To hold old int 9h handler           }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ForgetPauses<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>PausePressed <font color="#000080">:</font>WORD<font color="#000080">;    </font><font color="#008000"><i>{ Returns number of times pause was     }
                                { Since last time ForgetPauses was called.}
{***********************************************************************}
</i></font><font color="#FF0000"><b>IMPLEMENTATION
VAR
     </b></font>NumPauses <font color="#000080">:</font>WORD<font color="#000080">;           </font><font color="#008000"><i>{  To hold number of times pause        }
                                {  was pressed. Not Directly accessible }
                                {  by other processes.                  }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ForgetPauses<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                       </font><font color="#008000"><i>{  Routine to Clear Pause counter variable       }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov NumPauses,0               </font><font color="#008000"><i>{  Clear Pause Variable                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{ForgetPauses}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>PausePressed <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                      </font><font color="#008000"><i>{ Function to return number of times pause pressed}
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,NumPauses              </font><font color="#008000"><i>{  Load number of pauses into register  }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{PausePressed}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TrapPause<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Push DS
  Push AX
  Push ES
  Mov AX,Seg @Data              </font><font color="#008000"><i>{  Allow us to access numpauses.        }
  </i></font><font color="#FF00FF">Mov DS,AX
  Mov AX,$40                    </font><font color="#008000"><i>{  Point ES, to bios data area          }
  </i></font><font color="#FF00FF">Mov ES,AX
  Mov AH,ES:[$18]               </font><font color="#008000"><i>{  Put keyboard shift flags into AH     }
  </i></font><font color="#FF00FF">And AH,8                      </font><font color="#008000"><i>{  Clear all but potential pause flags  }
  </i></font><font color="#FF00FF">Or AH,0                       </font><font color="#008000"><i>{  Check for zero                       }
  </i></font><font color="#FF00FF">Jz @NormalKey                 </font><font color="#008000"><i>{  If it was zero pause wasn't pressed  }
  </i></font><font color="#FF00FF">Add NumPauses,1               </font><font color="#008000"><i>{  Add 1 to number of pauses pressed    }
  </i></font><font color="#FF00FF">Mov AH,ES:[$18]               </font><font color="#008000"><i>{  Load Flags again                     }
  </i></font><font color="#FF00FF">And AH,$F7                    </font><font color="#008000"><i>{  Clear pause flags                    }
  </i></font><font color="#FF00FF">Mov ES:[$18],AH               </font><font color="#008000"><i>{  Load new flags byte back into bios   }
</i></font><font color="#FF00FF">@NormalKey:
  PushF                         </font><font color="#008000"><i>{  Push flags onto stack                }
  </i></font><font color="#FF00FF">Call [OldInt09]               </font><font color="#008000"><i>{  Call old Int 9h handler              }
</i></font><font color="#FF00FF">@Exit:
  Sti                           </font><font color="#008000"><i>{  Allow Interrupts                     }
  </i></font><font color="#FF00FF">Pop ES                        </font><font color="#008000"><i>{  Restore registers that were used     }
  </i></font><font color="#FF00FF">Pop AX
  Pop DS
  IRet                          </font><font color="#008000"><i>{  Return from interrupt                }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{TrapPause}

{$F+}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Restore_Pause<font color="#000080">;
                       </font><font color="#008000"><i>{  Routine to restore int 9  and exit pointers   }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>SetIntVec<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,</font>OldInt09<font color="#000080">);        </font><font color="#008000"><i>{ Restore Int pointer to old pointer    }
  </i></font>ExitProc <font color="#000080">:= </font>OldExit<font color="#000080">;          </font><font color="#008000"><i>{ Restore Exit Pointer                  }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Restore_Pause}
{$F-}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitTrap<font color="#000080">;
                   </font><font color="#008000"><i>{  Routine to set Int pointers to TrapPause          }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GetIntVec<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,</font>OldInt09<font color="#000080">);        </font><font color="#008000"><i>{  Get pointer to Old Int 9h            }
  </i></font>SetIntVec<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,@</font>TrapPause<font color="#000080">);      </font><font color="#008000"><i>{  Point Int 9 to TrapPause             }
  </i></font>OldExit <font color="#000080">:= </font>ExitProc<font color="#000080">;          </font><font color="#008000"><i>{  Save Old Exit Pointer                }
  </i></font>ExitProc <font color="#000080">:= @</font>Restore_Pause<font color="#000080">;   </font><font color="#008000"><i>{  Set exit Pointer to new exit         }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{InitTrap}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>InitTrap<font color="#000080">;                        </font><font color="#008000"><i>{ Set up New Int 9h Handler             }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{***********************************************************************}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>ShowNoPause<font color="#000080">;            </font><font color="#008000"><i>{ Demo of NoPause Unit. Greg Estabrooks.}
</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">,                       </font><font color="#008000"><i>{ IMPORT Clrscr,KeyPressed,ReadKey.     }
     </i></font>NoPause<font color="#000080">;                   </font><font color="#008000"><i>{ Unit containing Pause routines.       }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Misc <font color="#000080">:</font>WORD<font color="#000080">;                  </font><font color="#008000"><i>{ Holds changing number to show the system}
                                { is not paused.                        }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Clrscr<font color="#000080">;                       </font><font color="#008000"><i>{ Clear screen clutter.                 }
  </i></font>ForgetPauses<font color="#000080">;                 </font><font color="#008000"><i>{ Clear the pauses number holder.       }
  </i></font>Misc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ Clear Counter.                        }
  </i></font><font color="#FF0000"><b>REPEAT                        </b></font><font color="#008000"><i>{ Loop Until a key other than Pause is  }
                                { pressed.                              }
    </i></font>GOTOXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                </font><font color="#008000"><i>{ Always show info at top corner.       }
    </i></font>Write<font color="#000080">(</font>Misc<font color="#000080">:</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">'...  You have pressed pause '</font><font color="#000080">,</font>PausePressed<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' times.'</font><font color="#000080">);
    </font>INC<font color="#000080">(</font>Misc<font color="#000080">);                  </font><font color="#008000"><i>{ Increase counter to show a change.    }
  </i></font><font color="#FF0000"><b>UNTIL </b></font>KeyPressed<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{ShowNoPause}</i></font><font color="#000080">;
</font><font color="#008000"><i>{***********************************************************************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to INTERRUP SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
