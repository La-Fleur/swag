<html>
<head><title> "Check for Printer Ready" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>The Beta Connection
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">08</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">20</font><font color="#000080">:</font><font color="#800000">02</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">819
</font>From<font color="#000080">: </font>JEFF PALEN                   Refer<font color="#800000">#</font><font color="#000080">: </font><font color="#800000">777
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>DAN SABIN                     Recvd<font color="#000080">: </font>YES 
Subj<font color="#000080">: </font>PRINTER CRASHING               Conf<font color="#000080">: (</font><font color="#800000">232</font><font color="#000080">) </font>T_Pascal_R
<font color="#000080">---------------------------------------------------------------------------
</font>DS<font color="#000080">&gt;</font>Does anyone know how you can check from Turbo <font color="#FF0000"><b>Pascal </b></font>that the
DS<font color="#000080">&gt;</font>printer <font color="#FF0000"><b>is </b></font>turned <font color="#FF0000"><b>on </b></font>so that you won<font color="#800000">'t get a device error that
</font>DS<font color="#000080">&gt;</font>will crash a <font color="#FF0000"><b>program</b></font><font color="#000080">?  </font>I can<font color="#800000">'t find anything about this.

</font><font color="#FF0000"><b>Program  </b></font>Printer_Status<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PrinterOnLine <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Const
    </b></font>PrnStatusInt  <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">$17</font><font color="#000080">;    </font><font color="#008000"><i>(*  Dos interrupt *)
    </i></font>StatusRequest <font color="#000080">: </font>Byte <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">;    </font><font color="#008000"><i>(*  Interrupt Function Call *)

    </i></font>PrinterNum    <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ 0 for LPT1, 1 for LPT2, etc. }
  </i></font><font color="#FF0000"><b>Var
    </b></font>Regs <font color="#000080">: </font>Registers <font color="#000080">;         </font><font color="#008000"><i>{ Type is defined in Dos Unit }

    </i></font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>(* PrinterOnLine*)
      </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font>StatusRequest<font color="#000080">;
      </font>Regs<font color="#000080">.</font>DX <font color="#000080">:= </font>PrinterNum<font color="#000080">;
      </font>Intr<font color="#000080">(</font>PrnStatusInt<font color="#000080">, </font>Regs<font color="#000080">);
      </font>PrinterOnLine <font color="#000080">:= (</font>Regs<font color="#000080">.</font>AH <font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$80</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>(* Main Program *)
  </i></font><font color="#FF0000"><b>If </b></font>PrinterOnLine <font color="#FF0000"><b>Then
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Ready To Print'</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Please check the printer!'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

---
 &thorn; </font>RM <font color="#800000">1.0  </font><font color="#000080">&thorn; </font>Eval Day <font color="#800000">4 </font><font color="#000080">&thorn; </font>Programmer<font color="#800000">'s do it with bytes and nybbles....
 </font><font color="#000080">* </font>Channel <font color="#800000">1</font><font color="#000080">(</font>R<font color="#000080">) * </font><font color="#800000">617</font><font color="#000080">-</font><font color="#800000">354</font><font color="#000080">-</font><font color="#800000">7077 </font><font color="#000080">* </font>Cambridge MA <font color="#000080">* </font><font color="#800000">85 </font>lines
 <font color="#000080">* </font>PostLink<font color="#000080">(</font>tm<font color="#000080">) </font>v1<font color="#000080">.</font><font color="#800000">06  </font>CHANNEL1 <font color="#000080">(</font><font color="#800000">#15</font><font color="#000080">) : </font>RelayNet<font color="#000080">(</font>tm<font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
