<html>
<head><title> "Graphics Dump to Laser" by JAN BARENDREGT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I wrote a computer Program that produces 8 bit 480 x 640 hi res images,
&gt; and I would like to know if anyone is familiar With a routine that can
&gt; print these images out on a Printer.
&gt; The preferable Printer For the task is a HP LaserJet II.
&gt;
&gt; I would like to be able to tell the LaserJet exactly which pixel dots
&gt; to print, and I don't mind if I have to give bit information to the
&gt; Printer line-by-line.
&gt;

Below is some (old) code to make a screendump in Graphics mode, for
both HP laser II and Epson. I haven't tested this For SVGA, but if
you give MaxX and MaxY the right values, I can't see where it would
go wrong.

Jan Barendregt
}
</i></font><font color="#FF0000"><b>Uses
  </b></font>Graph<font color="#000080">,
  </font>Dos<font color="#000080">,
  </font>Printer<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>d <font color="#000080">= </font><font color="#800000">'l'</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MaxX<font color="#000080">, </font>MaxY <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>dump<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>ymax<font color="#000080">,
  </font>bbyt<font color="#000080">,
  </font>b2   <font color="#000080">: </font>Byte<font color="#000080">;
  </font>psf  <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte<font color="#000080">;
  </font>regs <font color="#000080">: </font>Registers<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure out</b></font><font color="#000080">(</font>ch <font color="#000080">: </font>Char<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font>ord<font color="#000080">(</font>ch<font color="#000080">);
    </font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">, </font>regs<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>hplaser<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>b<font color="#000080">,
    </font>reg<font color="#000080">,
    </font>kol <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>assign<font color="#000080">(</font>psf<font color="#000080">, </font><font color="#800000">'lpt1'</font><font color="#000080">);
    </font>reWrite<font color="#000080">(</font>psf<font color="#000080">);
    </font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'E'</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'*t100R'</font><font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'*r0A'</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>reg <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxx <font color="#FF0000"><b>do
    begin
      </b></font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'*b'</font><font color="#000080">, (</font>maxy <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">'W'</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>kol <font color="#000080">:= ((</font>maxy <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
      begin
        </b></font>bbyt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>For </b></font>b <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
        begin
          if </b></font>getpixel<font color="#000080">(</font>reg<font color="#000080">, </font>kol <font color="#000080">* </font><font color="#800000">8 </font><font color="#000080">+ </font>b<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            </b></font>b2 <font color="#000080">:= </font><font color="#800000">0
          </font><font color="#FF0000"><b>else
            </b></font>b2 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>bbyt <font color="#000080">:= </font>bbyt <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>b2 <font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font>bbyt<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'*rB'</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">));
    </font>Write<font color="#000080">(</font>lst<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">), </font><font color="#800000">'E'</font><font color="#000080">);
    </font>close<font color="#000080">(</font>psf<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>epson<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>k<font color="#000080">, </font>j<font color="#000080">, </font>i <font color="#000080">: </font>Byte<font color="#000080">;

    </font><font color="#FF0000"><b>Function </b></font>xget<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">) : </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$0D</font><font color="#000080">;
      </font>regs<font color="#000080">.</font>cx <font color="#000080">:= </font>x<font color="#000080">;
      </font>regs<font color="#000080">.</font>dx <font color="#000080">:= </font>y<font color="#000080">;
      </font>intr<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">, </font>regs<font color="#000080">);
      </font>xget <font color="#000080">:= </font>regs<font color="#000080">.</font>al<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
    out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$1B</font><font color="#000080">));
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$33</font><font color="#000080">));
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$18</font><font color="#000080">));
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$0D</font><font color="#000080">));
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$0A</font><font color="#000080">));
    </font><font color="#FF0000"><b>For </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>maxy <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$1B</font><font color="#000080">));
      </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">$4C</font><font color="#000080">));
      </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">((</font>maxx <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">256</font><font color="#000080">));
      </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">((</font>maxx <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">256</font><font color="#000080">));
      </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>maxx <font color="#FF0000"><b>do
      begin
        </b></font>bbyt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>For </b></font>k <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
          if </b></font><font color="#000080">(</font>xget<font color="#000080">(</font>i<font color="#000080">, (</font>j <font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) + </font>k<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>bbyt <font color="#000080">:= </font>bbyt <font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#800000">128 </font><font color="#FF0000"><b>shr </b></font>k<font color="#000080">);
        </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font>bbyt<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">));
      </font><font color="#FF0000"><b>out</b></font><font color="#000080">(</font>chr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>MaxX <font color="#000080">:= </font>GetMaxX<font color="#000080">;
  </font>MaxY <font color="#000080">:= </font>GetMaxY<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>d <font color="#000080">= </font><font color="#800000">'l' </font><font color="#FF0000"><b>then
    </b></font>hplaser
  <font color="#FF0000"><b>else
    </b></font>epson<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Var
  </b></font>Gd<font color="#000080">, </font>Gm<font color="#000080">,
  </font>Radius <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Gd <font color="#000080">:= </font>Detect<font color="#000080">;
  </font>InitGraph<font color="#000080">(</font>Gd<font color="#000080">, </font>Gm<font color="#000080">, </font><font color="#800000">'e:\bp\bgi'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Radius <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    </b></font>Circle<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">, </font>Radius <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);
  </font>Readln<font color="#000080">;
  </font>Dump<font color="#000080">;
  </font>CloseGraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p></body>
</html>
