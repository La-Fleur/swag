<html>
<head><title> "Complete Print Screen Unit" by SALVATORE MESCHINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Hi Gayle, this is a complete Print Screen handling unit.
It can Enable/Disable that key (and get status) and/or install a new handler.
I'm looking forward for next SWAG releases!!!
}


</i></font><font color="#FF0000"><b>Unit </b></font>PrtScr<font color="#000080">;

</font><font color="#008000"><i>{This is a COMPLETE print screen unit.}
{(C) 1997 SALVATORE MESCHINI - smeschini@ermes.it -
 - http://www.ermes.it/pws/mesk - Feel free to write me!}
{This unit is copyrighted FREEWARE -}

{Getstatus return print screen handler status (see below)
 Setstatus enable (00) or disable (01) print screen (see below)
 NicePrtScr is my own print screen handler (you can modify it, to suit your
 needs.
 GetInt get interrupt vector for restoring (you can use it in your programs)
 SetInt as you can imagine by yourself, set interrupt vector to our routine
 (can be useful in other programs)}

</i></font><font color="#FF0000"><b>Interface

uses </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>oldint<font color="#000080">:</font>pointer<font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>GetStatus<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{00=Enabled 01=Disabled FFh=Error}
</i></font><font color="#FF0000"><b>Procedure </b></font>SetStatus<font color="#000080">(</font>mode<font color="#000080">:</font>word<font color="#000080">); </font><font color="#008000"><i>{This procedure Enable/Disable printscreen}
</i></font><font color="#FF0000"><b>Procedure </b></font>NicePrtScr<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Function </b></font>Getstatus<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">mov ax,0050h
 xor bx,bx
 mov es,ax
 mov ax,es:[bx]
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Setstatus<font color="#000080">(</font>mode<font color="#000080">:</font>word<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{00=Enabled 01=Disabled}
 </i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,mode
  mov ax,0050h
  xor bx,bx
  mov es,ax
  mov es:[bx],dx
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>PROCEDURE </b></font>JmpToInt<font color="#000080">(</font>OldIntVector<font color="#000080">: </font>pointer<font color="#000080">);
 </font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(
    </font><font color="#800000">$5B</font><font color="#000080">/   </font><font color="#008000"><i>{POP BX - Get Segment}
    </i></font><font color="#800000">$58</font><font color="#000080">/   </font><font color="#008000"><i>{POP AX - Get Offset}
    </i></font><font color="#800000">$89</font><font color="#000080">/   </font><font color="#008000"><i>{MOV SP,BP}
    </i></font><font color="#800000">$EC</font><font color="#000080">/
    </font><font color="#800000">$5D</font><font color="#000080">/   </font><font color="#008000"><i>{POP BP}
    </i></font><font color="#800000">$07</font><font color="#000080">/   </font><font color="#008000"><i>{POP ES}
    </i></font><font color="#800000">$1F</font><font color="#000080">/   </font><font color="#008000"><i>{POP DS}
    </i></font><font color="#800000">$5F</font><font color="#000080">/   </font><font color="#008000"><i>{POP DI}
    </i></font><font color="#800000">$5E</font><font color="#000080">/   </font><font color="#008000"><i>{POP SI}
    </i></font><font color="#800000">$5A</font><font color="#000080">/   </font><font color="#008000"><i>{POP DX}
    </i></font><font color="#800000">$59</font><font color="#000080">/   </font><font color="#008000"><i>{POP CX}
    </i></font><font color="#800000">$87</font><font color="#000080">/   </font><font color="#008000"><i>{XCHG SP,BP}
    </i></font><font color="#800000">$EC</font><font color="#000080">/
    </font><font color="#800000">$87</font><font color="#000080">/   </font><font color="#008000"><i>{XCHG [BP],BX}
    </i></font><font color="#800000">$5E</font><font color="#000080">/
    </font><font color="#800000">$00</font><font color="#000080">/
    </font><font color="#800000">$87</font><font color="#000080">/   </font><font color="#008000"><i>{XCHG [BP+2],AX}
    </i></font><font color="#800000">$46</font><font color="#000080">/
    </font><font color="#800000">$02</font><font color="#000080">/
    </font><font color="#800000">$87</font><font color="#000080">/   </font><font color="#008000"><i>{XCHG SP,BP}
    </i></font><font color="#800000">$EC</font><font color="#000080">/
    </font><font color="#800000">$CB</font><font color="#000080">);  </font><font color="#008000"><i>{RETF}

</i></font><font color="#FF0000"><b>function </b></font>GetKey<font color="#000080">: </font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>AsciiK<font color="#000080">: </font>byte<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    asm
     </b></font><font color="#FF00FF">xor ah,ah
     int 16h
     mov asciik,al
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>GetKey <font color="#000080">:= </font>chr<font color="#000080">(</font>asciik<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>MyInt<font color="#000080">(</font>Flags<font color="#000080">, </font>CS<font color="#000080">, </font>IP<font color="#000080">, </font>AX<font color="#000080">, </font>BX<font color="#000080">, </font>CX<font color="#000080">, </font>DX<font color="#000080">, </font>SI<font color="#000080">, </font>DI<font color="#000080">, </font>DS<font color="#000080">, </font>ES<font color="#000080">, </font>BP<font color="#000080">: </font>Word<font color="#000080">);
</font>interrupt<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{asm cli end;}
 </i></font>write<font color="#000080">(</font><font color="#800000">'Are you sure?'</font><font color="#000080">);  </font><font color="#008000"><i>{Here you can put your routines}
 </i></font>x<font color="#000080">:=</font>getkey<font color="#000080">;               </font><font color="#008000"><i>{Suggestions: You can make a TSR to print in
                           compressed font or write additional information
                           on paper (i.e. date/time, your name...) etc.}
 </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x <font color="#000080">= </font><font color="#800000">'Y'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x <font color="#000080">= </font><font color="#800000">'y'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>jmptoint<font color="#000080">(</font>oldint<font color="#000080">);
 </font><font color="#008000"><i>{asm sti end;}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NicePrtScr<font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>setintvec<font color="#000080">(</font><font color="#800000">05</font><font color="#000080">,@</font>MyInt<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>getintvec<font color="#000080">(</font><font color="#800000">05</font><font color="#000080">,</font>oldint<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.

 </font><font color="#008000"><i>{-----------------------------------------------------------------------}

 </i></font><font color="#FF0000"><b>Program </b></font>Demo<font color="#000080">; </font><font color="#008000"><i>{Just an idea}

 {$M 4096,0,0}

 </i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">,</font>PrtScr<font color="#000080">;

 </font><font color="#FF0000"><b>begin
 if </b></font>getstatus <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>setstatus<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{If disabled the enable printscreen}
 </i></font>niceprtscr<font color="#000080">;
 </font>keep<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p></body>
</html>
