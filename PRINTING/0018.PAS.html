<html>
<head><title> "Print Spooler Interface" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>SPOOLIT<font color="#000080">;

</font><font color="#008000"><i>{ Example program to demonstrate the PRINT spooler interface }

{ Define the data structure we need for spooling files }

</i></font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Type

  </b></font>SpoolRecType <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Priority <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Filename <font color="#000080">: </font>Pointer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var

  </b></font>SpoolFile   <font color="#000080">: </font>PathStr<font color="#000080">;
  </font>SpoolBuffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">70</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>SpoolRec    <font color="#000080">: </font>SpoolRecType<font color="#000080">;
  </font>Regs        <font color="#000080">: </font>Registers<font color="#000080">;
  </font>SpooledOk   <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin

  With </b></font>Regs <font color="#FF0000"><b>do begin
    </b></font>AX <font color="#000080">:= </font><font color="#800000">$100</font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">,</font>Regs<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>AL <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'PRINT is not loaded.'</font><font color="#000080">);
      </font>Halt
      <font color="#FF0000"><b>end
    end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Query user for the name of a file to spool }

  </i></font>Write<font color="#000080">(</font><font color="#800000">'Enter the filename to print: '</font><font color="#000080">);
  </font>ReadLn<font color="#000080">(</font>SpoolFile<font color="#000080">);

  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>SpoolFile<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Halt<font color="#000080">;  </font><font color="#008000"><i>{Nothing to do, so quit}

  </i></font>FillChar<font color="#000080">(</font>SpoolBuffer<font color="#000080">,</font>SizeOf<font color="#000080">(</font>SpoolBuffer<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);

  </font>Move<font color="#000080">(</font>SpoolFile<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SpoolBuffer<font color="#000080">,</font>Length<font color="#000080">(</font>SpoolFile<font color="#000080">));

  </font>SpoolRec<font color="#000080">.</font>Priority <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>SpoolRec<font color="#000080">.</font>Filename <font color="#000080">:= </font>Addr<font color="#000080">(</font>SpoolBuffer<font color="#000080">);

  </font><font color="#008000"><i>{ Send the file on its way }

  </i></font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>do Begin
    </b></font>AX <font color="#000080">:= </font><font color="#800000">$101</font><font color="#000080">;
    </font>DS <font color="#000080">:= </font>DSeg<font color="#000080">;
    </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>SpoolRec<font color="#000080">);
    </font>Intr<font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">,</font>Regs<font color="#000080">);

    </font><font color="#008000"><i>{ Isolate the status fo the spool operation }

    </i></font>SpooledOK <font color="#000080">:= </font><font color="#FF0000"><b>Not </b></font><font color="#000080">((</font>Flags <font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1</font><font color="#000080">);

    </font><font color="#FF0000"><b>If </b></font>SpooledOk <font color="#FF0000"><b>then
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Your file has been placed in the queue.'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Could not spool your file, error code is '</font><font color="#000080">,</font>AL<font color="#000080">)
    </font><font color="#FF0000"><b>end

End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
