<html>
<head><title> "HP Envelope Printing" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{In a following message, the Complete Turbo Pascal source code For DJENV.PAS
is presented For all who may be interested in what it does, or illustrates.

The Program prints the &quot;return&quot; and &quot;to:&quot; addresses on a long (&quot;#10&quot;)
business sized envelope in a HP DeskJet series Printer.

Along the way it illustrates:

  1) How to test For existence of a specific File

  2) How to Read from a structured-Type File

  3) How to Write to a structured-Type File

  4) How to do Text-Type output to any of: LPT1...LPT3, NUL, or a disk File
     With the same code.

  5) How to change fonts in PCL 3 (although this is not explained, it is
     done to give small print For the return address and larger print
     For the to: address.)

  6) How to use TechnoJock's Turbo toolkit For &quot;full-screen I/O&quot;.  There are
     three Procedures in the Program which REQUIRE the toolkit to Compile.
     These routines could be modified For non-Full-Screen action which
     would allow you to not use the TT toolkit.  if you don't want to make
     the modifications, and don't have the TT toolkit, you may File request

     DJENV.ZIP

     from my system at 1:106/100.  It has both the source code presented here
     and a Compiled .EXE File, ready to roll.

  if you'd like to play With it, but don't have a DJ or LASERJET-Compatible
Printer, then you may tell the Program to print to a disk File or even NUL
instead of LPT1, etc.

  Whatever addresses you enter, plus the name of the &quot;print device&quot; you
use, will be saved in the File DJENV.CFG .  With a little work, DJENV.CFG
could easily become a mini-database and allow you to retrieve from any
number of previous envelope setups, instead of just the last one you used.
I may eventually do this, but no time frame is currently anticipated For
it's Completion.

  You may print 1 to many copies of the setup after you have entered it's
info. The Program paUses beFore each envelope and gently nudges you to
prepare an envelope For printing and then to hit Return.  (Any key
returning a key code will do as well as Return.)

  Loading the envelopes is a Complete MANUAL operation.  While the DJ
has a software command to load envelopes, you must still manually
position the envelope For loading.  if the envelope doesn't load cleanly
(and in my experience, about 1 in every 10 or 15 will go in crooked...), I
felt it would be better to deal With that BEForE attempting to print.  After
the envelope is in position to load, then it is necessary to hit two of the
panel buttons together to have the DJ500 to pull the envelope into
position.  When that is acComplished correctly, then hit Return to print to
the envelope.

Hope some of you find this useful/interesting/maybe even helpful!
}

</i></font><font color="#FF0000"><b>Program </b></font>DJ_Envelopes<font color="#000080">;

</font><font color="#008000"><i>{  This Program illustrates how to Program For envelope printing
   With the HP DeskJet series of Printer.  It would possibly work
   For any PCL 3 (or better) Printer which can load envelopes.

   note:  Loading envelopes on the DJ Printers *IS* a bit tricky
          and requires cooperative envelopes.  Be sure to read the
          part in your manual about use of envelopes, selecting good
          Printer-use envelopes, and especially about LOADinG them
          manually.  I have used the following inexpensive envelopes
          With some degree of success.  They were purchased at a
          discount business/office supply store, BIZMART, but as the
          brand is national, you can probably find them most anywhere:

             MEAD Management Series, no. 75604
             Number 10 size, 4-1/8&quot; x 9-1/2&quot;
             BARCODE#   43100 75064

             (100 of them cost about $2.00)


   This Program is PUBLIC doMAin and may be freely distributed, modified,
   even SOLD. (if you can find somebody stupid enough to pay For a PD
   Program, MorE POWER to YOU! I would ask that you at least send me
   their names....)

   The author is: Justin Marquez FidoNet 1:106/100  Houston, TX  USA
}

</i></font><font color="#FF0000"><b>Uses
   </b></font>FASTTTT5<font color="#000080">, </font><font color="#008000"><i>{Requires TechnoJock's Turbo toolkit Ver 5 or higher }
   </i></font>WinTTT5<font color="#000080">,  </font><font color="#008000"><i>{Requires TechnoJock's Turbo toolkit Ver 5 or higher }
   </i></font>IOTTT5<font color="#000080">,   </font><font color="#008000"><i>{Requires TechnoJock's Turbo toolkit Ver 5 or higher }
   </i></font>Crt<font color="#000080">,      </font><font color="#008000"><i>{ Crt Unit For ClrScr }
   </i></font>Dos<font color="#000080">;      </font><font color="#008000"><i>{ Req'd to be able to use the EXIST Procedure as I wrote it }

</i></font><font color="#FF0000"><b>Const
    </b></font>Return_Size   <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'&amp;l0O'</font><font color="#000080">+ </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'(10U' </font><font color="#000080">+</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'(s1p6v0s41010bt2Q'</font><font color="#000080">;
    </font>Addressee_Size <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'&amp;l0O'</font><font color="#000080">+ </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'(10U' </font><font color="#000080">+</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'(s1p12v0s4103b1t2Q'</font><font color="#000080">;
    </font>Config_File <font color="#000080">= </font><font color="#800000">'DJENV.CFG'</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
    </b></font>Add_Strg <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">60</font><font color="#000080">];

    </font>Address_Data <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font><font color="#008000"><i>{ this is the Format of the &quot;config File&quot; }
      </i></font>Who_from<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Add_Strg<font color="#000080">;
      </font>Last_to <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Add_Strg<font color="#000080">;
      </font>PRN_DEV <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
    </b></font>Return_Address<font color="#000080">,
    </font>Address <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Add_Strg<font color="#000080">;

    </font>lst     <font color="#000080">: </font>Text<font color="#000080">;

    </font>Last_Data <font color="#000080">: </font>Address_Data<font color="#000080">;
    </font>CF_Data   <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Address_Data<font color="#000080">; </font><font color="#008000"><i>{ going to be the config File }

    </i></font>Print_to<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

    </font>n<font color="#000080">,
    </font>Counter<font color="#000080">,
    </font>How_Many <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>EXIST<font color="#000080">(</font>Filename <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{  Determines if a File exists or not.  NO WILDCARDS!
   Main Program or Unit MUST have &quot;Uses Dos;&quot; in it!
}
</i></font><font color="#FF0000"><b>Var
   </b></font>Attr <font color="#000080">: </font>Word<font color="#000080">;
   </font>f    <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>Filename<font color="#000080">);
  </font>GetFAttr<font color="#000080">(</font>f<font color="#000080">,</font>Attr<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Attr <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Exist <font color="#000080">:= </font>False <font color="#FF0000"><b>else
    </b></font>Exist <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ of exist Function }

</i></font><font color="#FF0000"><b>Procedure </b></font>DrawScreen1<font color="#000080">;
  </font><font color="#008000"><i>{Requires TechnoJock's toolkit, Used to set up For the full-screen I/O}
</i></font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>WriteCenter<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>Blue<font color="#000080">,</font>White<font color="#000080">,</font><font color="#800000">' Enter Address Info, and hit F10 when done ...'</font><font color="#000080">);
  </font>WriteCenter<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>Blue<font color="#000080">,</font>White<font color="#000080">,</font><font color="#800000">' (Use CURSor keys For up &amp; dn, RETURN For left &amp;
</font>right<font color="#000080">) </font><font color="#800000">');
  </font>WriteAt<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'RETURN ADDRESS inFO...'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #1 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #2 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #3 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #4 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #5 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'ADDRESSEE inFO ....   '</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #1 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #2 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #3 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #4 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'             Line #5 :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'Send Output to :'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'[ Ex: LPT1  or  LPT2 or NUL (For testing) ]'</font><font color="#000080">);
  </font>WriteAt<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">, </font>White<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">'Print How Many?:'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ of pvt Procedure drawscreen1 }

</i></font><font color="#FF0000"><b>Procedure </b></font>FS_IO<font color="#000080">;
</font><font color="#008000"><i>{ Requires TechnoJock's Turbo toolkit }
</i></font><font color="#FF0000"><b>Var
  </b></font>counter <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Create_Fields<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
  </font><font color="#008000"><i>{          #  U  D  L  R  x  y   }
  </i></font>Add_Field<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);
  </font>Add_Field<font color="#000080">( </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">);
  </font>Add_Field<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">);
  </font>Add_Field<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
  </font>Add_Field<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do

</b></font>String_Field<font color="#000080">(</font>n<font color="#000080">,</font>Return_Address<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">'**********************************************
</font><font color="#000080">****</font><font color="#800000">');
  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do

</b></font>String_Field<font color="#000080">(</font>n<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">,</font>Address<font color="#000080">[</font>n<font color="#000080">],</font><font color="#800000">'**************************************************'
</font><font color="#000080">);

</font>String_Field<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">,</font>Print_to<font color="#000080">,</font><font color="#800000">'**************************************************'</font><font color="#000080">);
  </font>Integer_Field<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">,</font>How_Many<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>PROCESS_inPUT<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>Dispose_Fields<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ of Procedure FS_IO }

</i></font><font color="#FF0000"><b>Procedure </b></font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">&lt; </font><font color="#800000">1
  </font><font color="#FF0000"><b>then
    </b></font>Print_to <font color="#000080">:= </font><font color="#800000">'LPT1'
  </font><font color="#FF0000"><b>else
    </b></font>Print_to <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Exist<font color="#000080">(</font>config_File<font color="#000080">)
  </font><font color="#FF0000"><b>then
    begin
      </b></font>Assign<font color="#000080">(</font>CF_Data<font color="#000080">,</font>ConFig_File<font color="#000080">);  </font><font color="#008000"><i>{ How to READ a Record from a File }
      </i></font>ReSet<font color="#000080">(</font>CF_Data<font color="#000080">);
      </font>Seek<font color="#000080">(</font>CF_Data<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
      </font>Read<font color="#000080">(</font>CF_DATA<font color="#000080">,</font>Last_Data<font color="#000080">);
      </font>Close<font color="#000080">(</font>CF_Data<font color="#000080">);
      </font><font color="#FF0000"><b>With </b></font>Last_Data <font color="#FF0000"><b>do
      begin
        For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
        begin
          </b></font>Return_Address<font color="#000080">[</font>n<font color="#000080">] := </font>Who_From<font color="#000080">[</font>n<font color="#000080">] ;
          </font>Address<font color="#000080">[</font>n<font color="#000080">]        := </font>Last_to<font color="#000080">[</font>n<font color="#000080">];
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Print_to <font color="#000080">:= </font>PRN_DEV<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>Return_Address<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
      </font>Return_Address<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
      </font>Return_Address<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
      </font>Return_Address<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
      </font>Return_Address<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
      </font>Address<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
      </font>Address<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
      </font>Address<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
      </font>Address<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
      </font>Address<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>How_Many <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>OutPut_to_DJ500<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>lst<font color="#000080">,</font>Print_to<font color="#000080">);
  </font>ReWrite<font color="#000080">(</font>lst<font color="#000080">);
  </font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'&amp;l8D'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font>lst<font color="#000080">,</font>Return_Size<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do
    </b></font>WriteLn<font color="#000080">(</font>lst<font color="#000080">,</font>Return_Address<font color="#000080">[</font>n<font color="#000080">]);
  </font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'&amp;l5D'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font>lst<font color="#000080">,</font>Addressee_Size<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>Do </b></font>Writeln<font color="#000080">(</font>lst<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do
    </b></font>WriteLn<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">'
        ',Address[n]);
  </font>WriteLn<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#12</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'E'</font><font color="#000080">);
  </font>close<font color="#000080">(</font>lst<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Save_Config_File<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>CF_Data<font color="#000080">,</font>ConFig_File<font color="#000080">);      </font><font color="#008000"><i>{ How to Write a Record to a File }
  </i></font>ReWrite<font color="#000080">(</font>CF_Data<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Last_Data <font color="#FF0000"><b>do
  begin
    For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    begin
      </b></font>Who_From<font color="#000080">[</font>n<font color="#000080">] := </font>Return_Address<font color="#000080">[</font>n<font color="#000080">];
      </font>Last_to<font color="#000080">[</font>n<font color="#000080">]  := </font>Address<font color="#000080">[</font>n<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>PRN_DEV <font color="#000080">:= </font>Print_to<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Seek<font color="#000080">(</font>CF_Data<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>Write<font color="#000080">(</font>CF_DATA<font color="#000080">,</font>Last_Data<font color="#000080">);
  </font>Close<font color="#000080">(</font>CF_Data<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Pause<font color="#000080">;
</font><font color="#008000"><i>{ Requires TechnoJock's Turbo toolkit }
</i></font><font color="#FF0000"><b>begin
  </b></font>TempMessageBOX<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font>Green<font color="#000080">,</font>Blue<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Load an envelope (manually) and Hit
</font>RETURN<font color="#000080">.</font><font color="#800000">');
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PRinT_ENVELOPES<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>GotoXY<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Printing Envelope #:'</font><font color="#000080">);
  </font>Counter <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>How_Many <font color="#000080">&gt; </font><font color="#800000">1
  </font><font color="#FF0000"><b>then
    begin
    For </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>How_Many <font color="#FF0000"><b>Do
      begin
        </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">,</font>Counter<font color="#000080">);
        </font>Pause<font color="#000080">;
        </font>OutPut_to_DJ500<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">,</font>Counter<font color="#000080">,</font><font color="#800000">' ( and only 1 ...)'</font><font color="#000080">);
      </font>Pause<font color="#000080">;
      </font>OutPut_to_DJ500<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Init<font color="#000080">;
  </font>DrawScreen1<font color="#000080">;
  </font>FS_IO<font color="#000080">;
  </font>PRinT_ENVELOPES<font color="#000080">;
  </font>Save_Config_File<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
