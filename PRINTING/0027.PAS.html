<html>
<head><title> "Printusing in PASCAL" by PHIL NICKELL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: PHIL NICKELL
Subj: Basic PrintUsing in PAS
Does anyone know of any shareware or freeware routines in Turbo Pascal
5.5, that will allow me to format numbers or strings like the PRINTUSING
statement in BASIC???
}

 </i></font><font color="#FF0000"><b>PROCEDURE </b></font>printusing <font color="#000080">(</font>mask<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>value<font color="#000080">:</font>real<font color="#000080">);
   </font><font color="#008000"><i>{ Calling syntax =     PRINTUSING(mask, number)
     mask can be a string label or a literal
     Example  printusing('#,###,###',45.63);
              printusing('######.###,value);   }
  </i></font><font color="#FF0000"><b>const
    </b></font>comma     <font color="#000080">: </font>char <font color="#000080">= </font><font color="#800000">','</font><font color="#000080">;
    </font>point     <font color="#000080">: </font>char <font color="#000080">= </font><font color="#800000">'.'</font><font color="#000080">;
    </font>minussign <font color="#000080">: </font>char <font color="#000080">= </font><font color="#800000">'-'</font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>fieldwidth<font color="#000080">, </font>integerlength<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>places<font color="#000080">, </font>pointposition<font color="#000080">: </font>integer<font color="#000080">;
    </font>usingcommas<font color="#000080">, </font>decimal<font color="#000080">, </font>negative <font color="#000080">: </font>boolean<font color="#000080">;
    </font>outstring<font color="#000080">, </font>integerstring <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
       </b></font>negative <font color="#000080">:= ( </font>value <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#000080">);
       </font>value <font color="#000080">:= </font>abs<font color="#000080">( </font>value <font color="#000080">);
       </font>places <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
       </font>fieldwidth <font color="#000080">:= </font>length<font color="#000080">( </font>mask <font color="#000080">);
       </font>usingcommas <font color="#000080">:= ( </font>pos <font color="#000080">( </font>comma<font color="#000080">, </font>mask <font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#000080">);
       </font>decimal <font color="#000080">:= ( </font>pos <font color="#000080">(</font>point<font color="#000080">,</font>mask<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>decimal <font color="#FF0000"><b>then
          begin
               </b></font>pointposition <font color="#000080">:= </font>pos<font color="#000080">(</font>point<font color="#000080">, </font>mask<font color="#000080">);
               </font>places <font color="#000080">:= </font>fieldwidth <font color="#000080">- </font>pointposition<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font>str <font color="#000080">( </font>value<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">:</font>places<font color="#000080">, </font>outstring <font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>usingcommas <font color="#FF0000"><b>then
          begin
               </b></font>J <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>integerstring <font color="#000080">:=
                     </font>copy <font color="#000080">(</font>outstring<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>outstring<font color="#000080">)-</font>places<font color="#000080">);
               </font>integerlength <font color="#000080">:= </font>length<font color="#000080">(</font>integerstring<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font>decimal <font color="#FF0000"><b>then
                  </b></font>integerlength <font color="#000080">:= </font>pred<font color="#000080">(</font>integerlength<font color="#000080">);
               </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>integerlength <font color="#FF0000"><b>downto </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
                   begin
                        </b></font>inc<font color="#000080">(</font>j<font color="#000080">);
                        </font><font color="#FF0000"><b>if </b></font>j <font color="#FF0000"><b>mod </b></font><font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                           </b></font>insert <font color="#000080">(</font>comma<font color="#000080">,</font>outstring<font color="#000080">,</font>i<font color="#000080">);
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>if </b></font>negative <font color="#FF0000"><b>then
               </b></font>outstring <font color="#000080">:= </font>minussign <font color="#000080">+ </font>outstring<font color="#000080">;
       </font>write<font color="#000080">( </font>outstring<font color="#000080">:</font>fieldwidth<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{PRINTUSING}

</i></font><font color="#FF0000"><b>BEGIN
</b></font>PrintUsing<font color="#000080">(</font><font color="#800000">'##,###,###.##'</font><font color="#000080">,</font><font color="#800000">123456.78</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
