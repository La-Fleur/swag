<html>
<head><title> "Send  graphics images to Epson" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
433: PRINTING GRAPHICS TO AN EPSON COMPATIBLE PRINTER
   Pascal   All       TI-09/30/94


Printing Graphics to a Epson compatible printer.  Printing your graphic
screens created with the BGI Graphics format to Epson compatible printers.

  PRODUCT  :  Pascal                                 NUMBER  :  433
  VERSION  :  All
       OS  :  DOS
     DATE  :  September 30, 1994                       PAGE  :  1/1

    TITLE  :  PRINTING GRAPHICS TO AN EPSON COMPATIBLE PRINTER
 }
{ The  following example routines are public domain programs }

{ that have  been uploaded to our Forum on CompuServe.  As a }
{ courtesy to our users that  do not have  immediate  access }
{ to  CompuServe,  Technical   Support   distributes   these }
{ routines free of charge.                                   }
{                                                            }
{ However, because these routines are public domain programs,}
{ not developed  by Borland International,  we are unable to }
{ provide any  Technical  Support or  assistance using these }

{ routines. If you need assistance  using  these   routines, }
{ or   are   experiencing difficulties,  we  recommend  that }
{ you log onto CompuServe  and request  assistance  from the }
{ Forum members that developed  these routines.              }

</i></font><font color="#FF0000"><b>Unit </b></font>GraphPRN<font color="#000080">;

</font><font color="#008000"><i>{ This  unit is  designed to send  graphics images  to Epson }
{ Compatible  and  late  model  IBM  ProPrinter  Dot  Matrix }
{ printers.  It takes the  image from  the currently  active }
{ Viewport, determined  by  a call  to  GetViewSettings, and }

{ transfers that image to the printer.                       }

</i></font><font color="#FF0000"><b>Interface

Uses </b></font>Dos<font color="#000080">, </font>Graph<font color="#000080">;     </font><font color="#008000"><i>{ Used to get the Image from the Screen }

</i></font><font color="#FF0000"><b>Var
   </b></font>LST <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HardCopy <font color="#000080">(</font>Gmode<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ Procedure HardCopy prints the current ViewPort    }
{   To an IBM or Epson compatible graphics printer. }
{                                                   }
{ Valid Gmode numbers are :                         }
{     -4 to -1 for Epson and IBM Graphic Printers   }

{      0 to 7  for Epson Printers                   }

</i></font><font color="#FF0000"><b>Implementation

Procedure </b></font>HardCopy <font color="#008000"><i>{Gmode: Integer}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
   </b></font>Bits <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);


</font><font color="#FF0000"><b>Var
    </b></font>X<font color="#000080">,</font>Y<font color="#000080">,</font>YOfs        <font color="#000080">: </font>Integer<font color="#000080">;   </font><font color="#008000"><i>{ Screen  location variables }
    </i></font>BitData<font color="#000080">,</font>MaxBits <font color="#000080">: </font>Byte<font color="#000080">;      </font><font color="#008000"><i>{ Number of Bits to transfer }
    </i></font>Vport           <font color="#000080">: </font>ViewPortType<font color="#000080">;</font><font color="#008000"><i>{Used to get view settings }
    </i></font>Height<font color="#000080">, </font>Width   <font color="#000080">: </font>Word<font color="#000080">;      </font><font color="#008000"><i>{ Size of image  to transfer }
    </i></font>HiBit<font color="#000080">, </font>LoBit    <font color="#000080">: </font>Char<font color="#000080">;      </font><font color="#008000"><i>{     Char size of image     }

    </i></font>LineSpacing<font color="#000080">,                 </font><font color="#008000"><i>{ Additional  Info for  dump }
    </i></font>GraphixPrefix   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];</font><font color="#008000"><i>{      &quot;        &quot;   &quot;     &quot;  }

</i></font><font color="#FF0000"><b>Begin
  </b></font>LineSpacing   <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'3'</font><font color="#000080">+</font><font color="#800000">#24</font><font color="#000080">; </font><font color="#008000"><i>{ 24/216 inch line spacing    }
  </i></font><font color="#FF0000"><b>Case </b></font>Gmode <font color="#FF0000"><b>Of
       </b></font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">: </font>GraphixPrefix <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'K'</font><font color="#000080">; </font><font color="#008000"><i>{ Std. Density           }
       </i></font><font color="#000080">-</font><font color="#800000">2</font><font color="#000080">: </font>GraphixPrefix <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'L'</font><font color="#000080">; </font><font color="#008000"><i>{ Double Density         }
       </i></font><font color="#000080">-</font><font color="#800000">3</font><font color="#000080">: </font>GraphixPrefix <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'Y'</font><font color="#000080">; </font><font color="#008000"><i>{ Dbl. Density Dbl. Speed}
       </i></font><font color="#000080">-</font><font color="#800000">4</font><font color="#000080">: </font>GraphixPrefix <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'Z'</font><font color="#000080">; </font><font color="#008000"><i>{ Quad. Density          }

     </i></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">: </font>GraphixPrefix <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'*'</font><font color="#000080">+</font>Chr<font color="#000080">(</font>Gmode<font color="#000080">);</font><font color="#008000"><i>{ 8-Pin Bit Img}
    </i></font><font color="#FF0000"><b>Else
     </b></font>Exit<font color="#000080">;                           </font><font color="#008000"><i>{ Invalid Mode Selection }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>GetViewSettings<font color="#000080">( </font>Vport <font color="#000080">);          </font><font color="#008000"><i>{ Get  size  of image to }
  </i></font>Height <font color="#000080">:= </font>Vport<font color="#000080">.</font>Y2 <font color="#000080">- </font>Vport<font color="#000080">.</font>Y1<font color="#000080">;     </font><font color="#008000"><i>{ be printed             }
  </i></font>Width  <font color="#000080">:= ( </font>Vport<font color="#000080">.</font>X2 <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">) - </font>Vport<font color="#000080">.</font>X1<font color="#000080">;
  </font>HiBit <font color="#000080">:= </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Width<font color="#000080">));           </font><font color="#008000"><i>{Translate sizes to char }
  </i></font>LoBit <font color="#000080">:= </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Width<font color="#000080">));           </font><font color="#008000"><i>{ for  output to printer }
  </i></font>Write<font color="#000080">( </font>LST<font color="#000080">, </font>LineSpacing <font color="#000080">);

  </font>Y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>Y <font color="#000080">&lt; </font>Height <font color="#FF0000"><b>Do
  Begin
     </b></font>Write<font color="#000080">( </font>LST<font color="#000080">,</font>GraphixPrefix<font color="#000080">,</font>LoBit<font color="#000080">,</font>HiBit <font color="#000080">);
     </font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Width<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>Do
     Begin
        </b></font>BitData <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>y <font color="#000080">+ </font><font color="#800000">7 </font><font color="#000080">&lt;= </font>Height
          <font color="#FF0000"><b>Then </b></font>MaxBits <font color="#000080">:= </font><font color="#800000">7
        </font><font color="#FF0000"><b>Else
          </b></font>MaxBits <font color="#000080">:= </font>Height <font color="#000080">- </font>Y<font color="#000080">;
        </font><font color="#FF0000"><b>For </b></font>YOfs <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxBits <font color="#FF0000"><b>do
        Begin
         If </b></font>GetPixel<font color="#000080">( </font>X<font color="#000080">, </font>YOfs<font color="#000080">+</font>Y <font color="#000080">) &gt; </font><font color="#800000">0
           </font><font color="#FF0000"><b>Then </b></font>BitData <font color="#000080">:= </font>BitData <font color="#FF0000"><b>or </b></font>Bits<font color="#000080">[</font>YOfs<font color="#000080">];
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Write<font color="#000080">( </font>LST<font color="#000080">, </font>Chr<font color="#000080">(</font>BitData<font color="#000080">) );
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>WriteLn <font color="#000080">( </font>LST <font color="#000080">);

     </font>Inc<font color="#000080">(</font>Y<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}

{      LSTNoFunction performs a NUL operation for a Reset or  }
{ Rewrite on LST (Just in case)                               }

</i></font><font color="#FF0000"><b>Function </b></font>LSTNoFunction<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">: </font>TextRec <font color="#000080">): </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>LSTNoFunction <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                    </font><font color="#008000"><i>{ No error           }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{      LSTOutputToPrinter sends the output to the Printer     }
{ port number stored in the first byte of the UserData area   }
{ of the Text Record.                                         }


</i></font><font color="#FF0000"><b>Function </b></font>LSTOutputToPrinter<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">: </font>TextRec <font color="#000080">): </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;
  </font>P <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>F <font color="#FF0000"><b>do
  Begin
    </b></font>P <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>P <font color="#000080">&lt; </font>BufPos<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>regs<font color="#000080">.</font>ah <font color="#FF0000"><b>and </b></font><font color="#800000">16</font><font color="#000080">) = </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>do
    Begin
      </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">:= </font>Ord<font color="#000080">(</font>BufPtr<font color="#000080">^[</font>P<font color="#000080">]);
      </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Regs<font color="#000080">.</font>DX <font color="#000080">:= </font>UserData<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
      </font>Intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>Regs<font color="#000080">);
      </font>Inc<font color="#000080">(</font>P<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>BufPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Regs<font color="#000080">.</font>AH <font color="#FF0000"><b>and </b></font><font color="#800000">16</font><font color="#000080">) = </font><font color="#800000">16 </font><font color="#FF0000"><b>then
    </b></font>LSTOutputToPrinter <font color="#000080">:= </font><font color="#800000">0              </font><font color="#008000"><i>{ No error           }

   </i></font><font color="#FF0000"><b>else
     if </b></font><font color="#000080">(</font>Regs<font color="#000080">.</font>AH <font color="#FF0000"><b>and </b></font><font color="#800000">32 </font><font color="#000080">) = </font><font color="#800000">32 </font><font color="#FF0000"><b>then
       </b></font>LSTOutputToPrinter <font color="#000080">:= </font><font color="#800000">159         </font><font color="#008000"><i>{ Out of Paper       }
   </i></font><font color="#FF0000"><b>else
       </b></font>LSTOutputToPrinter <font color="#000080">:= </font><font color="#800000">160</font><font color="#000080">;        </font><font color="#008000"><i>{ Device write Fault }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F-}

{      AssignLST both sets up the LST text file record as     }
{ would ASSIGN, and initializes it as would a RESET.  It also }
{ stores the Port number in the first Byte of the UserData    }
{ area.                                                       }

</i></font><font color="#FF0000"><b>Procedure </b></font>AssignLST<font color="#000080">( </font>Port<font color="#000080">:</font>Byte <font color="#000080">);

</font><font color="#FF0000"><b>Begin
  With </b></font>TextRec<font color="#000080">(</font>LST<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>Handle      <font color="#000080">:= </font><font color="#800000">$FFF0</font><font color="#000080">;
      </font>Mode        <font color="#000080">:= </font>fmOutput<font color="#000080">;
      </font>BufSize     <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>Buffer<font color="#000080">);
      </font>BufPtr      <font color="#000080">:= @</font>Buffer<font color="#000080">;
      </font>BufPos      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>OpenFunc    <font color="#000080">:= @</font>LSTNoFunction<font color="#000080">;
      </font>InOutFunc   <font color="#000080">:= @</font>LSTOutputToPrinter<font color="#000080">;
      </font>FlushFunc   <font color="#000080">:= @</font>LSTOutputToPrinter<font color="#000080">;
      </font>CloseFunc   <font color="#000080">:= @</font>LSTOutputToPrinter<font color="#000080">;
      </font>UserData<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Port <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ We subtract one because }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                          </font><font color="#008000"><i>{ Dos Counts from zero.   }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Begin
   </b></font>AssignLST<font color="#000080">( </font><font color="#800000">1 </font><font color="#000080">);           </font><font color="#008000"><i>{ Sets output printer to LPT1 by }
                             { default.  Change this value to }
                             { a 2 to select LPT2.            }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.                         </font><font color="#008000"><i>{ Note: BIOS only handles LPT1   }
                                            {      and      LPT2.
}


</i></font>DISCLAIMER<font color="#000080">: </font>You have the right <font color="#FF0000"><b>to </b></font>use this technical information
subject <font color="#FF0000"><b>to </b></font>the terms <font color="#FF0000"><b>of </b></font>the No<font color="#000080">-</font>Nonsense License Statement that

you received <font color="#FF0000"><b>with </b></font>the Borland product <font color="#FF0000"><b>to </b></font>which this information
pertains<font color="#000080">.
</font>PACHXA296<font color="#000080">:</font>PACHXA296


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
