<html>
<head><title> "Controlling PRNTSCRN" by STEVE ROGERS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
WK&gt;Hello everyone! I am sorta new at Pascal, and have been dabbling around,
  &gt;trying to make a few useful programs.  Right now i am working a program that
  &gt;will generate a calender for a given year and print it out to the screen and
  &gt;printer. I have successfully been able to print it on the screen, but i have
  &gt;no idea how to get it out to the printer! Specifically, in my procedure that
  &gt;prints the calender to the screen, I use GOTOXY to position the dates. This
  &gt;doesn't work with the printer tho. Does anyone have any suggestions? Oh,
  &gt;also, i am using asterics to create boxes around the dates. thanx for any
  &gt;help!

  Well, you could press the PrntScr key after you have your calendar on
  the screen. You can do the same in software:
}
    </i></font><font color="#FF0000"><b>procedure </b></font>PrintScreen<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      asm
        </b></font><font color="#FF00FF">int 5h
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font>you don<font color="#800000">'t want to print the whole screen, here'</font>s a little routine
  that will print lines y1 through y2<font color="#000080">.

</font><font color="#008000"><i>{-----------------------}
</i></font><font color="#FF0000"><b>procedure </b></font>prnt_scr<font color="#000080">(</font>y1<font color="#000080">,</font>y2 <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>c <font color="#000080">: </font>char<font color="#000080">;
  </font>regs <font color="#000080">: </font>registers<font color="#000080">;
  </font>x<font color="#000080">,</font>y <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  for </b></font>y<font color="#000080">:= </font>y1 <font color="#FF0000"><b>to </b></font>y2 <font color="#FF0000"><b>do begin
    for </b></font>x<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do with </b></font>regs <font color="#FF0000"><b>do begin
      </b></font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
      </font>ah<font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
      </font>bh<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">);

      </font><font color="#008000"><i>(*
      { uncomment to filter high ASCII chars }
      if (al&gt;=127) then
        al:= 32;
      *)

      </i></font>ah<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>dx<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>regs<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>writeln<font color="#000080">(</font>lst<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>write<font color="#000080">(</font>lst<font color="#000080">,</font>ff<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
