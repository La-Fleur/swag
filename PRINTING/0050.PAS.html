<html>
<head><title> "Printer Troubles" by JAN FEIJES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 SM&gt; #1.)  The printer's not on...
 SM&gt; #2.)  The printer's outta paper
 SM&gt; #3.)  The printer's fried, etc.


 Write data to the printer normally like : }

 </i></font>Assign <font color="#000080">(</font>uitvf<font color="#000080">,</font><font color="#800000">'LPT1'</font><font color="#000080">);
 </font>Rewrite <font color="#000080">(</font>Uitvf<font color="#000080">);
 </font><font color="#FF0000"><b>Repeat
</b></font><font color="#008000"><i>{$I-}
       </i></font>Write <font color="#000080">(</font>Uitvf<font color="#000080">,</font>PrinterData<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin
            </b></font>WriteLn <font color="#000080">(</font><font color="#800000">'Somthing''s wrong with the printer'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'PrinterError = '</font><font color="#000080">,</font>CheckPrinterStatus <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$I+}
 </i></font><font color="#FF0000"><b>until </b></font>AllWritten<font color="#000080">;


 </font>The funtion <font color="#FF0000"><b>to </b></font>determine the status <font color="#FF0000"><b>of </b></font>the printer <font color="#000080">:

 </font><font color="#FF0000"><b>Function </b></font>CheckPrinterStatus <font color="#000080">(</font>Port <font color="#000080">: </font>Word<font color="#000080">) : </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#008000"><i>{
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~ Status :    0 - time out            Returns the printer status
             1 - unused              ==========================
             2 - unused
             3 - I/O error
             4 - On line selected
             5 - Out of paper
             6 - Acknowledge
             7 - Not Busy

 2     : Printer not found
 3+4   : Printer not on line / selected
 3     : Printer not on line / selected
 4+5   : Cable not hooked up
 4+5+7 : Cable not hooked up
 3+6+7 : Printer off or unplugged

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~}

</i></font><font color="#FF0000"><b>ASM
                </b></font><font color="#FF00FF">MOV     DX,Port
                DEC     DX            </font><font color="#008000"><i>{DX := Lpt -1                   }
                </i></font><font color="#FF00FF">MOV     AX,$0200      </font><font color="#008000"><i>{AH := $02 : Read printer status}
                </i></font><font color="#FF00FF">INT     $17
                MOV     AL,AH         </font><font color="#008000"><i>{Zet status in AL}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p></body>
</html>
