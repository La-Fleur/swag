<html>
<head><title> "PRINTER3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Myprint<font color="#000080">;
</font><font color="#008000"><i>{$D-,I-,S-}
</i></font><font color="#FF0000"><b>Interface

Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Prt        <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Text<font color="#000080">;
  </font>Lst        <font color="#000080">: </font>Text <font color="#FF0000"><b>Absolute </b></font>Prt<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PrinterStatus<font color="#000080">(</font>p<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>PrinterReady<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>b <font color="#000080">: </font>Byte<font color="#000080">; </font>p<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>RawMode<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">);       </font><font color="#008000"><i>{ make sure that device is in raw mode }
  </i></font><font color="#FF0000"><b>Var
    </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    With </b></font>regs <font color="#FF0000"><b>do begin
      </b></font>bx   <font color="#000080">:= </font>TextRec<font color="#000080">(</font>L<font color="#000080">).</font>Handle<font color="#000080">;         </font><font color="#008000"><i>{ place the File handle in bx }
      </i></font>ax   <font color="#000080">:= </font><font color="#800000">$4400</font><font color="#000080">;           </font><font color="#008000"><i>{ setup For Function $44 sub-Function 0 }
      </i></font>MSDos<font color="#000080">(</font>regs<font color="#000080">);                              </font><font color="#008000"><i>{ execute Dos Function }
      </i></font>dl   <font color="#000080">:= </font>dl <font color="#FF0000"><b>or </b></font><font color="#800000">$20</font><font color="#000080">;                            </font><font color="#008000"><i>{ bit 5 = raw mode }
      </i></font>dh   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                      </font><font color="#008000"><i>{ set dh to zero }
      </i></font>ax   <font color="#000080">:= </font><font color="#800000">$4401</font><font color="#000080">;           </font><font color="#008000"><i>{ setup For Function $44 sub-Function 1 }
      </i></font>MSDos<font color="#000080">(</font>regs<font color="#000080">)                               </font><font color="#008000"><i>{ execute Dos Function }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ With }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ RawMode }

</i></font><font color="#FF0000"><b>Function </b></font>PrinterStatus<font color="#000080">(</font>p<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
   </font><font color="#008000"><i>{ Returns the Printer status. LPT1=p=1, LPT2=p=2 }
   </i></font><font color="#FF0000"><b>Var </b></font>regs   <font color="#000080">: </font>Registers<font color="#000080">; </font><font color="#008000"><i>{ from the Dos Unit                         }
   </i></font><font color="#FF0000"><b>begin
     With </b></font>regs <font color="#FF0000"><b>do begin
       </b></font>dx <font color="#000080">:= </font>p <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;        </font><font color="#008000"><i>{ The Printer number                        }
       </i></font>ax <font color="#000080">:= </font><font color="#800000">$0200</font><font color="#000080">;        </font><font color="#008000"><i>{ The Function code For service wanted      }
       </i></font>intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>regs<font color="#000080">);     </font><font color="#008000"><i>{ $17= ROM bios int to return Printer status}
       </i></font>PrinterStatus <font color="#000080">:= </font>ah<font color="#000080">;</font><font color="#008000"><i>{ Bit 0 set = timed out                     }
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                  </font><font color="#008000"><i>{     1     = unused                        }
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                    </font><font color="#008000"><i>{     2     = unused                        }
                           {     3     = I/O error                     }
                           {     4     = Printer selected              }
                           {     5     = out of paper                  }
                           {     6     = acknowledge                   }
                           {     7     = Printer not busy              }

</i></font><font color="#FF0000"><b>Function </b></font>PrinterReady<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>b <font color="#000080">: </font>Byte<font color="#000080">; </font>p<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>b <font color="#000080">:= </font>PrinterStatus<font color="#000080">(</font>p<font color="#000080">);
    </font>PrinterReady <font color="#000080">:= (</font>b <font color="#000080">= </font><font color="#800000">$90</font><font color="#000080">)         </font><font color="#008000"><i>{ This may Vary between Printers }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'LPT1'</font><font color="#000080">);
  </font>reWrite<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>RawMode<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font>assign<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'LPT2'</font><font color="#000080">);
  </font>reWrite<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
  </font>RawMode<font color="#000080">(</font>Prt<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
