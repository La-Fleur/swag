<html>
<head><title> "Printer Ready Function" by CHRIS PRIEDE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>The Beta Connection
Date<font color="#000080">: </font><font color="#800000">07</font><font color="#000080">-</font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">15</font><font color="#000080">:</font><font color="#800000">28</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">1525
</font>From<font color="#000080">: </font>CHRIS PRIEDE                 Refer<font color="#800000">#</font><font color="#000080">: </font><font color="#800000">1378
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>PETER KIRKWOOD                Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>Printer Ready<font color="#000080">?                 </font>Conf<font color="#000080">: (</font><font color="#800000">232</font><font color="#000080">) </font>T_Pascal_R
<font color="#000080">---------------------------------------------------------------------------
</font>PK<font color="#000080">&gt;    </font>Any suggestions <font color="#FF0000"><b>as to </b></font>how I can check <font color="#FF0000"><b>if </b></font>a printer <font color="#FF0000"><b>is </b></font>online
PK<font color="#000080">&gt;</font><font color="#FF0000"><b>and</b></font><font color="#000080">/</font><font color="#FF0000"><b>or </b></font>ready would be appreciated<font color="#000080">.

    </font>Interrupt <font color="#800000">17</font>h service <font color="#800000">02</font>h returns printer status flags<font color="#000080">. </font>We are
interested <font color="#FF0000"><b>in </b></font>three<font color="#000080">:

    </font>bit <font color="#800000">7 </font><font color="#000080">= </font><font color="#800000">1   </font>Ready
    bit <font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">1   </font><font color="#FF0000"><b>Out of </b></font>paper
    bit <font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">1   </font>I<font color="#000080">/</font>O error


    Bit <font color="#800000">7 </font>should be <font color="#800000">1 </font><font color="#FF0000"><b>and </b></font>bits <font color="#800000">5</font><font color="#000080">, </font><font color="#800000">3 </font><font color="#000080">-- </font><font color="#800000">0. </font>You can use the following
BASM routine <font color="#FF0000"><b>to </b></font>check it<font color="#000080">:

</font><font color="#FF0000"><b>const
  </b></font>pnLPT1    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>pnLPT2    <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>pnLPT3    <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PrinterReady<font color="#000080">(</font>PN<font color="#000080">: </font>word<font color="#000080">): </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov     dx, PN              </font><font color="#008000"><i>{printer number goes in DX}
    </i></font><font color="#FF00FF">mov     ah, 02h
    int     17h                 </font><font color="#008000"><i>{int. 17h service 02h}
    </i></font><font color="#FF00FF">xor     al, al              </font><font color="#008000"><i>{assume false}
    </i></font><font color="#FF00FF">and     ah, 10101000b       </font><font color="#008000"><i>{clear all other bits}
    </i></font><font color="#FF00FF">cmp     ah, 10000000b       </font><font color="#008000"><i>{ready &amp; not out of paper or error?}
    </i></font><font color="#FF00FF">jne     @Done               </font><font color="#008000"><i>{no -- leave result false}
    </i></font><font color="#FF00FF">inc     ax                  </font><font color="#008000"><i>{yes -- change to true}
</i></font><font color="#FF00FF">@Done:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
---
 * </font>D<font color="#000080">.</font>W<font color="#000080">.</font><font color="#800000">'s TOOLBOX, Atlanta GA, 404-471-6636
 </font><font color="#000080">* </font>PostLink<font color="#000080">(</font>tm<font color="#000080">) </font>v1<font color="#000080">.</font><font color="#800000">06  </font>DWTOOLBOX <font color="#000080">(</font><font color="#800000">#1035</font><font color="#000080">) : </font>RelayNet<font color="#000080">(</font>tm<font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
