<html>
<head><title> "Bar Code Matrix Printers" by MAYNARD PHILBROOK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: MAYNARD PHILBROOK
Subj: Re: bar codes
---------------------------------------------------------------------------
 HB&gt; I'm in need of bar code type code.   I want to print custom bar codes
 HB&gt; and be able to scan them into an application.  I also want to be able
 HB&gt; to do this directly from my application, not via a third party or a tsr
 HB&gt; program.
}

{$F-,D-,S-,R-,V-,I-}
{  Prints 3 Of 9 Bar Codes other wise known as Code 39 }
{  May only work on EPSON or IBM Dot Matrix Printer !! }
</i></font><font color="#FF0000"><b>Uses   </b></font>Printer<font color="#000080">;
</font><font color="#008000"><i>{$V-}
</i></font><font color="#FF0000"><b>Const           </b></font><font color="#008000"><i>{ Set up Defalt Settings }
       </i></font>Resolution<font color="#000080">:</font>Byte <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{ Vertical Grid Width per Line }
        </i></font>Hight    <font color="#000080">:</font>Byte <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;            </font><font color="#008000"><i>{ Number of rows to Print }
        </i></font>Passes    <font color="#000080">:</font>Byte <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;           </font><font color="#008000"><i>{ Number for Passing for Darkness }
        </i></font>Density   <font color="#000080">:</font>Byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;            </font><font color="#008000"><i>{ Printer Graphic Mode L or Z }
    </i></font>Graphic_Mode<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = (</font><font color="#800000">'L'</font><font color="#000080">,</font><font color="#800000">'Z'</font><font color="#000080">);
    </font>grid <font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">43</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">] =
  (</font><font color="#800000">'110100101011'</font><font color="#000080">,  </font><font color="#008000"><i>{1}
   </i></font><font color="#800000">'101100101011'</font><font color="#000080">,  </font><font color="#008000"><i>{2}
   </i></font><font color="#800000">'110110010101'</font><font color="#000080">,  </font><font color="#008000"><i>{3}
   </i></font><font color="#800000">'101001101011'</font><font color="#000080">,  </font><font color="#008000"><i>{4}
   </i></font><font color="#800000">'110100110101'</font><font color="#000080">,  </font><font color="#008000"><i>{5}
   </i></font><font color="#800000">'101100110101'</font><font color="#000080">,  </font><font color="#008000"><i>{6}
   </i></font><font color="#800000">'101001011011'</font><font color="#000080">,  </font><font color="#008000"><i>{7}
   </i></font><font color="#800000">'110100101101'</font><font color="#000080">,  </font><font color="#008000"><i>{8}
   </i></font><font color="#800000">'101100101101'</font><font color="#000080">,  </font><font color="#008000"><i>{9}
   </i></font><font color="#800000">'101001101101'</font><font color="#000080">,  </font><font color="#008000"><i>{0}
   </i></font><font color="#800000">'110101001011'</font><font color="#000080">,  </font><font color="#008000"><i>{A}
   </i></font><font color="#800000">'101101001011'</font><font color="#000080">,  </font><font color="#008000"><i>{B}
   </i></font><font color="#800000">'110110100101'</font><font color="#000080">,  </font><font color="#008000"><i>{C}
   </i></font><font color="#800000">'101011001011'</font><font color="#000080">,  </font><font color="#008000"><i>{D}
   </i></font><font color="#800000">'110101100101'</font><font color="#000080">,  </font><font color="#008000"><i>{E}
   </i></font><font color="#800000">'101101100101'</font><font color="#000080">,  </font><font color="#008000"><i>{F}
   </i></font><font color="#800000">'101010011011'</font><font color="#000080">,  </font><font color="#008000"><i>{G}
   </i></font><font color="#800000">'110101001101'</font><font color="#000080">,  </font><font color="#008000"><i>{H}
   </i></font><font color="#800000">'101101001101'</font><font color="#000080">,  </font><font color="#008000"><i>{I}
   </i></font><font color="#800000">'101011001101'</font><font color="#000080">,  </font><font color="#008000"><i>{J}
   </i></font><font color="#800000">'110101010011'</font><font color="#000080">,  </font><font color="#008000"><i>{K}
   </i></font><font color="#800000">'101101010011'</font><font color="#000080">,  </font><font color="#008000"><i>{L}
   </i></font><font color="#800000">'110110101001'</font><font color="#000080">,  </font><font color="#008000"><i>{M}
   </i></font><font color="#800000">'101011010011'</font><font color="#000080">,  </font><font color="#008000"><i>{N}
   </i></font><font color="#800000">'110101101001'</font><font color="#000080">,  </font><font color="#008000"><i>{O}
   </i></font><font color="#800000">'101101101001'</font><font color="#000080">,  </font><font color="#008000"><i>{P}
   </i></font><font color="#800000">'101010110011'</font><font color="#000080">,  </font><font color="#008000"><i>{Q}
   </i></font><font color="#800000">'110101011001'</font><font color="#000080">,  </font><font color="#008000"><i>{R}
   </i></font><font color="#800000">'101101011001'</font><font color="#000080">,  </font><font color="#008000"><i>{S}
   </i></font><font color="#800000">'101011011001'</font><font color="#000080">,  </font><font color="#008000"><i>{T}
   </i></font><font color="#800000">'110010101011'</font><font color="#000080">,  </font><font color="#008000"><i>{U}
   </i></font><font color="#800000">'100110101011'</font><font color="#000080">,  </font><font color="#008000"><i>{V}
   </i></font><font color="#800000">'110011010101'</font><font color="#000080">,  </font><font color="#008000"><i>{W}
   </i></font><font color="#800000">'100101101011'</font><font color="#000080">,  </font><font color="#008000"><i>{X}
   </i></font><font color="#800000">'110010110101'</font><font color="#000080">,  </font><font color="#008000"><i>{Y}
   </i></font><font color="#800000">'100110110101'</font><font color="#000080">,  </font><font color="#008000"><i>{Z}
   </i></font><font color="#800000">'100101011011'</font><font color="#000080">,  </font><font color="#008000"><i>{-}
   </i></font><font color="#800000">'110010101101'</font><font color="#000080">,  </font><font color="#008000"><i>{.}
   </i></font><font color="#800000">'100110101101'</font><font color="#000080">,  </font><font color="#008000"><i>{ }
   </i></font><font color="#800000">'100101101101'</font><font color="#000080">,  </font><font color="#008000"><i>{*}
   </i></font><font color="#800000">'100100100101'</font><font color="#000080">,  </font><font color="#008000"><i>{'$'}
   </i></font><font color="#800000">'100100101001'</font><font color="#000080">,  </font><font color="#008000"><i>{/}
   </i></font><font color="#800000">'100101001001'</font><font color="#000080">,  </font><font color="#008000"><i>{+}
   </i></font><font color="#800000">'101001001001'</font><font color="#000080">);  </font><font color="#008000"><i>{%}
</i></font><font color="#FF0000"><b>Function </b></font>Get_Grid<font color="#000080">(</font>Yup<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;   </font><font color="#008000"><i>{ Translations Function }
</i></font><font color="#FF0000"><b>Var
</b></font>PT     <font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
       </b></font>Get_Grid <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>Case </b></font>Yup <font color="#FF0000"><b>Of
        </b></font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[ </font>Ord<font color="#000080">( </font>Yup<font color="#000080">) -</font><font color="#800000">$31</font><font color="#000080">];
        </font><font color="#800000">'0'    </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">];
        </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">+</font>Ord<font color="#000080">(</font>Yup<font color="#000080">)-</font><font color="#800000">65</font><font color="#000080">];
         </font><font color="#800000">'-'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">36</font><font color="#000080">];
         </font><font color="#800000">'.'   </font><font color="#000080">:</font>Get_grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">37</font><font color="#000080">];
         </font><font color="#800000">' '   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">38</font><font color="#000080">];
         </font><font color="#800000">'*'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">39</font><font color="#000080">];
         </font><font color="#800000">'$'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];
         </font><font color="#800000">'/'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">41</font><font color="#000080">];
         </font><font color="#800000">'+'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">42</font><font color="#000080">];
         </font><font color="#800000">'%'   </font><font color="#000080">:</font>Get_Grid <font color="#000080">:= </font>Grid<font color="#000080">[</font><font color="#800000">43</font><font color="#000080">];
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Send_Char<font color="#000080">(</font>Yup <font color="#000080">:</font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Var
</b></font>Hold   <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font>L<font color="#000080">, </font>G   <font color="#000080">:</font>Word<font color="#000080">;
</font>Out_Bar <font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin

 </b></font>Hold <font color="#000080">:= </font>Get_Grid<font color="#000080">(</font>Upcase<font color="#000080">(</font>Yup<font color="#000080">));
 </font><font color="#FF0000"><b>If </b></font>Hold <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
  Begin
   </b></font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font>Graphic_Mode<font color="#000080">[ </font>Density <font color="#000080">]);         </font><font color="#008000"><i>{ Printer in Graph Mode }
   </i></font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font>Char<font color="#000080">((</font>Resolution <font color="#000080">* </font><font color="#800000">12</font><font color="#000080">)+</font>Resolution<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font><font color="#008000"><i>{ How many Bytes ?}
   </i></font><font color="#FF0000"><b>For </b></font>L <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">12 </font><font color="#FF0000"><b>Do   </b></font><font color="#008000"><i>{ All 12 Chars }
    </i></font><font color="#FF0000"><b>Begin
     If </b></font>Hold<font color="#000080">[</font>L<font color="#000080">] =</font><font color="#800000">'1' </font><font color="#FF0000"><b>Then </b></font>Out_bar <font color="#000080">:= </font><font color="#800000">255 </font><font color="#FF0000"><b>Else </b></font>Out_bar <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>G <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Resolution <font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font>Lst<font color="#000080">, </font>Char<font color="#000080">(</font>Out_Bar<font color="#000080">));
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>L <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Resolution <font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font>Lst<font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">); </font><font color="#008000"><i>{ Charactor Separator }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
 </b></font>Number_IN <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">];
 </font>L<font color="#000080">,</font>LC<font color="#000080">, </font>DS  <font color="#000080">:</font>Word<font color="#000080">;
 </font>T        <font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>T<font color="#000080">, </font>DS        <font color="#000080">);   </font><font color="#008000"><i>{ Adjust Parameters if Needed }
 </i></font><font color="#FF0000"><b>If </b></font>DS <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Resolution <font color="#000080">:= </font>T<font color="#000080">;    </font><font color="#008000"><i>{ Width Ratio }
 </i></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">), </font>T<font color="#000080">, </font>DS <font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>DS <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Hight <font color="#000080">:= </font>T<font color="#000080">;         </font><font color="#008000"><i>{ Vertical Size of Label }
 </i></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">), </font>T<font color="#000080">, </font>DS <font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>DS <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THen </b></font>Passes <font color="#000080">:= </font>T<font color="#000080">;        </font><font color="#008000"><i>{ For Darkness adjust }
 </i></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">), </font>T<font color="#000080">, </font>DS <font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DS <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and</b></font><font color="#000080">( </font>T <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>Then </b></font>Density <font color="#000080">:= </font>T<font color="#000080">;  </font><font color="#008000"><i>{ Printer Mode }
 </i></font><font color="#FF0000"><b>Repeat
  </b></font>ReadLn<font color="#000080">(</font>Number_IN<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>Number_IN <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    Begin
     </b></font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'1'</font><font color="#000080">);    </font><font color="#008000"><i>{ Set  7/72 Line Spacing }
      </i></font><font color="#FF0000"><b>For </b></font>LC <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Hight <font color="#FF0000"><b>Do   </b></font><font color="#008000"><i>{Hight Loop }
       </i></font><font color="#FF0000"><b>Begin
        For </b></font>DS <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Passes <font color="#FF0000"><b>Do   </b></font><font color="#008000"><i>{ Double Strike }
         </i></font><font color="#FF0000"><b>Begin
          </b></font>Send_Char<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">);     </font><font color="#008000"><i>{ Must Create a '*' @ start &amp; end }
          </i></font><font color="#FF0000"><b>For </b></font>L <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Byte<font color="#000080">(</font>Number_IN<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>Do </b></font>Send_Char<font color="#000080">(</font>Number_IN <font color="#000080">[ </font>L <font color="#000080">]);
          </font>Send_Char<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">);
          </font>Write<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>Lc <font color="#000080">&lt; </font>Hight <font color="#FF0000"><b>Then </b></font>WriteLn<font color="#000080">(</font>Lst<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>WriteLn<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">);
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#008000"><i>{ Print Number underneath Bars in center or close to it any ways }
     </i></font>WriteLn<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">:</font>Resolution<font color="#000080">,</font>Number_IN<font color="#000080">:((</font>Byte<font color="#000080">(</font>Number_IN<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])*(</font>Resolution <font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>Byte<font color="#000080">(</font>Number_In<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">))));
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Until </b></font>Number_In <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
