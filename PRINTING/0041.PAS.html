<html>
<head><title> "EAN-8 & EAN-13 Barcode printing" by ROHIT GUPTA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ This unit writes EAN-8 and EAN-13 barcodes to an Epson, IBM Pro or HP
  Laser compatible printers. It has been tested on a variety of printers
  and works well.  The barcodes generated were able to be read by at least
  one brand of bar code reader.

By Rohit Gupta

You may use this as you see fit.

}

{$R-,B+,S-,I+,N-,D-,L-,Y-}
{$M $4000,$4000,$8000}

</i></font><font color="#FF0000"><b>UNIT </b></font>BarCode<font color="#000080">;


</font><font color="#FF0000"><b>INTERFACE


CONST
     </b></font>PrnPosn <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;  </font><font color="#008000"><i>{ Print Offset Column }

</i></font><font color="#FF0000"><b>TYPE
    </b></font>EAN_13  <font color="#000080">= </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">13</font><font color="#000080">];

    </font>Printer_Type <font color="#000080">= (</font>Epson<font color="#000080">, </font>Ibm<font color="#000080">, </font>Laser<font color="#000080">);


</font><font color="#FF0000"><b>PROCEDURE </b></font>Print_BarCode
          <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Lst    <font color="#000080">: </font>TEXT<font color="#000080">;
               </font>Typ    <font color="#000080">: </font>Printer_Type<font color="#000080">;
               </font>Code   <font color="#000080">: </font>EAN_13<font color="#000080">;
               </font>NLines <font color="#000080">: </font>INTEGER<font color="#000080">);


</font><font color="#FF0000"><b>IMPLEMENTATION


FUNCTION </b></font>Num <font color="#000080">(</font>Arg <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>St <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
     </b></font>STR <font color="#000080">(</font>Arg<font color="#000080">,</font>St<font color="#000080">);
     </font>Num <font color="#000080">:= </font>St<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Print_BarCode <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Lst  <font color="#000080">: </font>TEXT<font color="#000080">;   </font>Typ    <font color="#000080">: </font>Printer_Type<font color="#000080">;
                             </font>Code <font color="#000080">: </font>EAN_13<font color="#000080">; </font>NLines <font color="#000080">: </font>INTEGER<font color="#000080">);

</font><font color="#FF0000"><b>CONST
     </b></font>Max_Code_Len <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">*</font><font color="#800000">3 </font><font color="#000080">+ </font><font color="#800000">5 </font><font color="#000080">+ </font><font color="#800000">7</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">;  </font><font color="#008000"><i>{ For 12 digit bar code }

     </i></font>ESC <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;


</font><font color="#FF0000"><b>TYPE
    </b></font>Bar_Position <font color="#000080">= (</font>Left<font color="#000080">,</font>Centre<font color="#000080">,</font>Right<font color="#000080">);
    </font>One_Dig      <font color="#000080">= </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">7</font><font color="#000080">];
    </font>Buffer       <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1024</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;


</font><font color="#FF0000"><b>VAR
   </b></font>LCode     <font color="#000080">: </font>EAN_13<font color="#000080">;   </font><font color="#008000"><i>{ Local Copy, padded &amp; checked }
   </i></font>Seg_Size<font color="#000080">,             </font><font color="#008000"><i>{ Left/Right Segment Size      }
   </i></font>Code_Len<font color="#000080">,             </font><font color="#008000"><i>{ Size of BarCode in digits    }
   </i></font>Bar_Len<font color="#000080">,              </font><font color="#008000"><i>{ Size of Barcode in bar units }
   </i></font>Bytes<font color="#000080">,                </font><font color="#008000"><i>{ Bytes per bar unit           }
   </i></font>Line_Len<font color="#000080">,             </font><font color="#008000"><i>{ Line Length in Gfx Mode      }
   </i></font>Mult      <font color="#000080">: </font>INTEGER<font color="#000080">;  </font><font color="#008000"><i>{ Number of Lines per char line}

   </i></font>Full_Code <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font>Max_Code_Len<font color="#000080">];

   </font>PBuffer   <font color="#000080">: ^</font>Buffer<font color="#000080">;
   </font>Posn      <font color="#000080">: </font>INTEGER<font color="#000080">;  </font><font color="#008000"><i>{ Buffer Position }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Rationalise_Code<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>LENGTH <font color="#000080">(</font>Code<font color="#000080">) &gt; </font><font color="#800000">8
     </font><font color="#FF0000"><b>THEN </b></font>Seg_Size <font color="#000080">:= </font><font color="#800000">6
     </font><font color="#FF0000"><b>ELSE </b></font>Seg_Size <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;

     </font>Code_Len <font color="#000080">:= </font>Seg_Size <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">;

     </font>LCode <font color="#000080">:= </font>Code<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>LENGTH<font color="#000080">(</font>LCode<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Code_Len<font color="#000080">-</font><font color="#800000">1  </font><font color="#008000"><i>{ Pad with Leading Zeros }
     </i></font><font color="#FF0000"><b>DO </b></font>LCode <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>LCode<font color="#000080">;

     </font>Bar_Len <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font><font color="#800000">3 </font><font color="#000080">+ </font><font color="#800000">5 </font><font color="#000080">+ </font><font color="#800000">7</font><font color="#000080">*</font>Code_Len<font color="#000080">;
             </font><font color="#008000"><i>{  LRG   CG  CODE }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Calc_Check_Digit<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">, </font>C1 <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>Code_Len <font color="#000080">&lt;&gt; </font>LENGTH<font color="#000080">(</font>LCode<font color="#000080">)+</font><font color="#800000">1  </font><font color="#008000"><i>{ If already there, assume ok }
     </i></font><font color="#FF0000"><b>THEN </b></font>EXIT<font color="#000080">;

     </font>C1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Seg_Size <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1
     </font><font color="#FF0000"><b>DO </b></font>INC <font color="#000080">(</font>C1<font color="#000080">,</font>ORD<font color="#000080">(</font>LCode<font color="#000080">[</font>I<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">])-</font><font color="#800000">$30</font><font color="#000080">);
     </font>C1 <font color="#000080">:= </font>C1 <font color="#000080">* </font><font color="#800000">3</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font>Seg_Size<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1
     </font><font color="#FF0000"><b>DO </b></font>INC <font color="#000080">(</font>C1<font color="#000080">,</font>ORD<font color="#000080">(</font>LCode<font color="#000080">[</font>I<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">])-</font><font color="#800000">$30</font><font color="#000080">);

     </font>LCode <font color="#000080">:= </font>LCode <font color="#000080">+ </font>CHR <font color="#000080">(((</font><font color="#800000">10</font><font color="#000080">-(</font>C1 <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">)) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">) +</font><font color="#800000">$30</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Guard <font color="#000080">(</font>Which <font color="#000080">: </font>Bar_Position<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Dig <font color="#000080">: </font>One_Dig<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     CASE </b></font>Which <font color="#FF0000"><b>OF
          </b></font>Centre <font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'01010'</font><font color="#000080">;
          </font><font color="#FF0000"><b>ELSE     </b></font>Dig <font color="#000080">:= </font><font color="#800000">'101'</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Full_Code <font color="#000080">:= </font>Full_Code <font color="#000080">+ </font>Dig<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>DigA <font color="#000080">(</font>Arg <font color="#000080">: </font>EAN_13<font color="#000080">) : </font>One_Dig<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>Dig <font color="#000080">: </font>One_Dig<font color="#000080">;
   </font>I   <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>Arg<font color="#000080">)
     </font><font color="#FF0000"><b>DO BEGIN
        CASE </b></font>Arg<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>OF
             </b></font><font color="#800000">'9' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0001011'</font><font color="#000080">;
             </font><font color="#800000">'8' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0110111'</font><font color="#000080">;
             </font><font color="#800000">'7' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0111011'</font><font color="#000080">;
             </font><font color="#800000">'6' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0101111'</font><font color="#000080">;
             </font><font color="#800000">'5' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0110001'</font><font color="#000080">;
             </font><font color="#800000">'4' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0100011'</font><font color="#000080">;
             </font><font color="#800000">'3' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0111101'</font><font color="#000080">;
             </font><font color="#800000">'2' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0010011'</font><font color="#000080">;
             </font><font color="#800000">'1' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0011001'</font><font color="#000080">;
             </font><font color="#FF0000"><b>ELSE  </b></font>Dig <font color="#000080">:= </font><font color="#800000">'0001101'</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>Full_Code <font color="#000080">:= </font>Full_Code <font color="#000080">+ </font>Dig<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>DigB <font color="#000080">(</font>Arg <font color="#000080">: </font>EAN_13<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Dig <font color="#000080">: </font>One_Dig<font color="#000080">;
   </font>I   <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>Arg<font color="#000080">)
     </font><font color="#FF0000"><b>DO BEGIN
        CASE </b></font>Arg<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>OF
             </b></font><font color="#800000">'9' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0010111'</font><font color="#000080">;
             </font><font color="#800000">'8' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0001001'</font><font color="#000080">;
             </font><font color="#800000">'7' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0010001'</font><font color="#000080">;
             </font><font color="#800000">'6' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0111001'</font><font color="#000080">;
             </font><font color="#800000">'5' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0111001'</font><font color="#000080">;
             </font><font color="#800000">'4' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0011101'</font><font color="#000080">;
             </font><font color="#800000">'3' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0100001'</font><font color="#000080">;
             </font><font color="#800000">'2' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0011011'</font><font color="#000080">;
             </font><font color="#800000">'1' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'0110011'</font><font color="#000080">;
             </font><font color="#FF0000"><b>ELSE  </b></font>Dig <font color="#000080">:= </font><font color="#800000">'0100111'</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>Full_Code <font color="#000080">:= </font>Full_Code <font color="#000080">+ </font>Dig<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>DigC <font color="#000080">(</font>Arg <font color="#000080">: </font>EAN_13<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Dig <font color="#000080">: </font>One_Dig<font color="#000080">;
   </font>I   <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>Arg<font color="#000080">)
     </font><font color="#FF0000"><b>DO BEGIN
        CASE </b></font>Arg<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>OF
             </b></font><font color="#800000">'9' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1110100'</font><font color="#000080">;
             </font><font color="#800000">'8' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1001000'</font><font color="#000080">;
             </font><font color="#800000">'7' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1000100'</font><font color="#000080">;
             </font><font color="#800000">'6' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1010000'</font><font color="#000080">;
             </font><font color="#800000">'5' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1001110'</font><font color="#000080">;
             </font><font color="#800000">'4' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1011100'</font><font color="#000080">;
             </font><font color="#800000">'3' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1000010'</font><font color="#000080">;
             </font><font color="#800000">'2' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1101100'</font><font color="#000080">;
             </font><font color="#800000">'1' </font><font color="#000080">: </font>Dig <font color="#000080">:= </font><font color="#800000">'1100110'</font><font color="#000080">;
             </font><font color="#FF0000"><b>ELSE  </b></font>Dig <font color="#000080">:= </font><font color="#800000">'1110010'</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>Full_Code <font color="#000080">:= </font>Full_Code <font color="#000080">+ </font>Dig<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Compose_Code<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Full_Code <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font>Guard <font color="#000080">(</font>Left<font color="#000080">);
     </font>DigA  <font color="#000080">(</font>COPY<font color="#000080">(</font>LCode<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Seg_Size<font color="#000080">));
     </font>Guard <font color="#000080">(</font>Centre<font color="#000080">);
     </font>DigC  <font color="#000080">(</font>COPY<font color="#000080">(</font>LCode<font color="#000080">,</font>Seg_Size<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Seg_Size<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">));
     </font>Guard <font color="#000080">(</font>Right<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Init_Buffer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>NEW <font color="#000080">(</font>PBuffer<font color="#000080">);
     </font>FILLCHAR <font color="#000080">(</font>PBUffer<font color="#000080">^,</font>SIZEOF<font color="#000080">(</font>PBuffer<font color="#000080">^),</font><font color="#800000">#0</font><font color="#000080">);
     </font>Posn <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

     </font><font color="#FF0000"><b>CASE </b></font>Typ <font color="#FF0000"><b>OF
          </b></font>Epson <font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                       </b></font>Bytes    <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">*</font><font color="#800000">3</font><font color="#000080">; </font><font color="#008000"><i>{ 3 pixels x 24 pins }
                       </i></font>Line_Len <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">*</font>Bar_Len<font color="#000080">;
                       </font>Mult     <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Ibm   <font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                       </b></font>Bytes    <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;     </font><font color="#008000"><i>{ 4 pixels X 8 pins }
                       </i></font>Line_Len <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">*</font>Bar_Len<font color="#000080">;
                       </font>Mult     <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>ELSE    BEGIN
                       </b></font>Bytes    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;     </font><font color="#008000"><i>{ 5 pixels }
                       </i></font>Line_Len <font color="#000080">:= (</font><font color="#800000">5</font><font color="#000080">*</font>Bar_Len <font color="#000080">+</font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">;
                       </font>Mult     <font color="#000080">:= </font><font color="#800000">37 </font><font color="#000080">* </font>NLines<font color="#000080">;
                       </font>NLines   <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Send_Preamble<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>St <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>NLines <font color="#000080">&lt;&gt; </font><font color="#800000">1
     </font><font color="#FF0000"><b>THEN BEGIN
          CASE </b></font>Typ <font color="#FF0000"><b>OF
               </b></font>Epson <font color="#000080">: </font>St <font color="#000080">:= </font>ESC<font color="#000080">+</font><font color="#800000">'0'</font><font color="#000080">;
               </font>Ibm   <font color="#000080">: </font>St <font color="#000080">:= </font>ESC<font color="#000080">+</font><font color="#800000">'3'#24</font><font color="#000080">;
               </font><font color="#FF0000"><b>ELSE    </b></font>St <font color="#000080">:= </font>ESC<font color="#000080">+</font><font color="#800000">'&amp;l8D'</font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>St<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Send_Postamble<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>NLines <font color="#000080">&lt;&gt; </font><font color="#800000">1
     </font><font color="#FF0000"><b>THEN IF </b></font>Typ <font color="#000080">= </font>Laser
          <font color="#FF0000"><b>THEN </b></font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'&amp;l6D'</font><font color="#000080">)
          </font><font color="#FF0000"><b>ELSE </b></font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Send_Buffer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     CASE </b></font>Typ <font color="#FF0000"><b>OF
          </b></font>Epson <font color="#000080">: </font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'*'#$27</font><font color="#000080">,</font>CHR<font color="#000080">(</font>Line_Len <font color="#FF0000"><b>MOD </b></font><font color="#800000">256</font><font color="#000080">),</font>CHR<font color="#000080">(</font>Line_Len <font color="#FF0000"><b>DIV </b></font><font color="#800000">256</font><font color="#000080">));
          </font>Ibm   <font color="#000080">: </font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'Z'</font><font color="#000080">,</font>CHR<font color="#000080">(</font>Line_Len <font color="#FF0000"><b>MOD </b></font><font color="#800000">256</font><font color="#000080">),</font>CHR<font color="#000080">(</font>Line_Len <font color="#FF0000"><b>DIV </b></font><font color="#800000">256</font><font color="#000080">));
          </font><font color="#FF0000"><b>ELSE    </b></font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'*t300R'</font><font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'*r1A'</font><font color="#000080">,</font>ESC<font color="#000080">,</font><font color="#800000">'*b'</font><font color="#000080">,</font>Line_Len<font color="#000080">,</font><font color="#800000">'W'</font><font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Posn
     <font color="#FF0000"><b>DO </b></font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font>PBuffer<font color="#000080">^[</font>I<font color="#000080">]);

     </font><font color="#FF0000"><b>CASE </b></font>Typ <font color="#FF0000"><b>OF
          </b></font>Laser <font color="#000080">: </font>WRITE <font color="#000080">(</font>Lst<font color="#000080">, </font>ESC<font color="#000080">, </font><font color="#800000">'*rB'</font><font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Compose_Buffer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I   <font color="#000080">: </font>INTEGER<font color="#000080">;
   </font>Bar <font color="#000080">: </font>CHAR<font color="#000080">;
   </font>Blk<font color="#000080">,
   </font>Spc <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];

</font><font color="#FF0000"><b>PROCEDURE </b></font>Add <font color="#000080">(</font>St <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>MOVE <font color="#000080">(</font>St<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>PBuffer<font color="#000080">^[</font>Posn<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>LENGTH <font color="#000080">(</font>St<font color="#000080">));
     </font>INC <font color="#000080">(</font>Posn<font color="#000080">,</font>LENGTH <font color="#000080">(</font>St<font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Frag<font color="#000080">, </font>Len <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Add_Frag <font color="#000080">(</font>B <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Frag <font color="#000080">:= (</font>Frag <font color="#FF0000"><b>SHL </b></font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>B <font color="#FF0000"><b>AND </b></font><font color="#800000">$1F</font><font color="#000080">);
     </font>INC <font color="#000080">(</font>Len<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Len <font color="#000080">&gt;= </font><font color="#800000">8
     </font><font color="#FF0000"><b>THEN BEGIN
          </b></font>Add <font color="#000080">(</font>CHR <font color="#000080">(</font>Frag <font color="#FF0000"><b>SHR </b></font><font color="#000080">(</font>Len<font color="#000080">-</font><font color="#800000">8</font><font color="#000080">)));
          </font>DEC <font color="#000080">(</font>Len<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Add_Bar <font color="#000080">(</font>Bar <font color="#000080">: </font>CHAR<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>Typ <font color="#000080">= </font>Laser        <font color="#008000"><i>{ 1-dot-line at a time }
     </i></font><font color="#FF0000"><b>THEN BEGIN
          IF </b></font>Bar <font color="#000080">= </font><font color="#800000">'0'
          </font><font color="#FF0000"><b>THEN </b></font>Add_Frag <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
          </font><font color="#FF0000"><b>ELSE </b></font>Add_Frag <font color="#000080">(</font><font color="#800000">$1F</font><font color="#000080">);
     </font><font color="#FF0000"><b>END
     ELSE BEGIN            </b></font><font color="#008000"><i>{ 8/24-dot-lines at a time }
          </i></font><font color="#FF0000"><b>IF </b></font>Bar <font color="#000080">= </font><font color="#800000">'0'
          </font><font color="#FF0000"><b>THEN </b></font>Add <font color="#000080">(</font>Spc<font color="#000080">)
          </font><font color="#FF0000"><b>ELSE </b></font>Add <font color="#000080">(</font>Blk<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>Frag <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>Len  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

     </font>Blk <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;             </font><font color="#008000"><i>{ Compose the unit stripes }
     </i></font>Spc <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Bytes
     <font color="#FF0000"><b>DO BEGIN
        </b></font>Blk <font color="#000080">:= </font>Blk <font color="#000080">+ </font><font color="#800000">#$FF</font><font color="#000080">;
        </font>Spc <font color="#000080">:= </font>Spc <font color="#000080">+ </font><font color="#800000">#$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>Full_Code<font color="#000080">)  </font><font color="#008000"><i>{ Compose Bars }
     </i></font><font color="#FF0000"><b>DO </b></font>Add_Bar <font color="#000080">(</font>Full_Code <font color="#000080">[</font>I<font color="#000080">]);

     </font><font color="#FF0000"><b>IF </b></font>Typ <font color="#000080">= </font>Laser
     <font color="#FF0000"><b>THEN WHILE </b></font>Posn <font color="#000080">&lt; </font>Line_Len
          <font color="#FF0000"><b>DO </b></font>Add_Bar <font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">,</font>J <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

     </b></font>Rationalise_Code<font color="#000080">;
     </font>Calc_Check_Digit<font color="#000080">;
     </font>Compose_Code<font color="#000080">;
     </font>Init_Buffer<font color="#000080">;
     </font>Compose_Buffer<font color="#000080">;

     </font>Send_Preamble<font color="#000080">;

     </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NLines
     <font color="#FF0000"><b>DO BEGIN
        </b></font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">:</font>PrnPosn<font color="#000080">);
        </font><font color="#FF0000"><b>FOR </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Mult
        <font color="#FF0000"><b>DO BEGIN
           </b></font>Send_Buffer<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>WRITELN <font color="#000080">(</font>Lst<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

     </font>Send_Postamble<font color="#000080">;
     </font>WRITELN <font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">:</font>PrnPosn<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>LCode<font color="#000080">); </font>WRITELN <font color="#000080">(</font>Lst<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------------    TEST PROGRAM  ---------------------------------- }

</i></font><font color="#FF0000"><b>USES
    </b></font>Crt<font color="#000080">, </font>Barcode<font color="#000080">, </font>Printer<font color="#000080">;


</font><font color="#FF0000"><b>VAR
</b></font><font color="#008000"><i>{  Lst : TEXT;}
   </i></font>Ch  <font color="#000080">: </font>CHAR<font color="#000080">;
   </font>Typ <font color="#000080">: </font>Printer_Type<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>WRITELN<font color="#000080">;
     </font>WRITELN <font color="#000080">(</font><font color="#800000">'Bar Code Test'</font><font color="#000080">);
     </font>WRITELN<font color="#000080">;

     </font>WRITE <font color="#000080">(</font><font color="#800000">'Select Printer Type (E=Epson, I=IbmPro, L=HPLaser) '</font><font color="#000080">);

     </font>Ch <font color="#000080">:= </font>UPCASE <font color="#000080">(</font>READKEY<font color="#000080">);

     </font><font color="#FF0000"><b>CASE </b></font>Ch <font color="#FF0000"><b>OF
          </b></font><font color="#800000">'L' </font><font color="#000080">: </font>Typ <font color="#000080">:= </font>Laser<font color="#000080">;
          </font><font color="#800000">'I' </font><font color="#000080">: </font>Typ <font color="#000080">:= </font>Ibm<font color="#000080">;
          </font><font color="#800000">'E' </font><font color="#000080">: </font>Typ <font color="#000080">:= </font>Epson<font color="#000080">;
          </font><font color="#FF0000"><b>ELSE </b></font>EXIT<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{    ASSIGN (Lst,'TEST');
     REWRITE (Lst);}

     </i></font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">,</font><font color="#800000">'1234567'</font><font color="#000080">,    </font><font color="#800000">1</font><font color="#000080">);
     </font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">, </font><font color="#800000">'9876543'</font><font color="#000080">,   </font><font color="#800000">1</font><font color="#000080">);
     </font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">,</font><font color="#800000">'12345678901'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

     </font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">,</font><font color="#800000">'1234567'</font><font color="#000080">,    </font><font color="#800000">2</font><font color="#000080">);
     </font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">, </font><font color="#800000">'9876543'</font><font color="#000080">,   </font><font color="#800000">2</font><font color="#000080">);
     </font>Print_BarCode <font color="#000080">(</font>Lst<font color="#000080">,</font>Typ<font color="#000080">,</font><font color="#800000">'12345678901'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);

     </font>WRITE <font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">#$0C</font><font color="#000080">);

</font><font color="#008000"><i>{    CLOSE (Lst);}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p></body>
</html>
