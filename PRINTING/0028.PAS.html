<html>
<head><title> "PRINTER Unit Replacement" by SWAG SUPPORT GROUP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Can be used as a TOTAL replacement for the PRINTER UNIT }
{ You'll need to replace the PRINTER unit in the TURBO.TPL to use this }
{$S-,R-,V-,I-,N-,B-,F-}

{$IFNDEF Ver40}
{$F+,O-,X+,A-}
{$ENDIF}

{$DEFINE AssignLstDevice}
{$DEFINE DoErrorChecking}   { undefine this to eliminate error checking }

</i></font><font color="#FF0000"><b>UNIT </b></font>Printer<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

</b></font><font color="#008000"><i>{$IFDEF DoErrorChecking}
</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>CONST

  </b></font>fmClosed <font color="#000080">= </font><font color="#800000">$D7B0</font><font color="#000080">;               </font><font color="#008000"><i>{ magic numbers for Turbo }
  </i></font>fmInput <font color="#000080">= </font><font color="#800000">$D7B1</font><font color="#000080">;
  </font>fmOutput <font color="#000080">= </font><font color="#800000">$D782</font><font color="#000080">;
  </font>fmInOut <font color="#000080">= </font><font color="#800000">$D7B3</font><font color="#000080">;

  </font>IO_Invalid <font color="#000080">= </font><font color="#800000">$FC</font><font color="#000080">;               </font><font color="#008000"><i>{ invalid operation eg. attempt to write }
  { to a file opened in fmInput mode       }

  </i></font>LPTNames <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF STRING </b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = (</font><font color="#800000">'LPT1'</font><font color="#000080">, </font><font color="#800000">'LPT2'</font><font color="#000080">, </font><font color="#800000">'LPT3'</font><font color="#000080">);

  </font>LPTPort <font color="#000080">: </font>BYTE <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>Lst <font color="#000080">: </font>TEXT<font color="#000080">;                     </font><font color="#008000"><i>{ for source compatability with TP3 }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetROMPrinterStatus <font color="#000080">(</font>LPTNo <font color="#000080">: </font>WORD<font color="#000080">) : </font>BYTE<font color="#000080">;
  </font><font color="#008000"><i>{ status of LPTNo via ROM BIOS int 17h func 2h }
  </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(
    </font><font color="#800000">$5A </font><font color="#000080">/                         </font><font color="#008000"><i>{  pop     DX    ; get printer number}
    </i></font><font color="#800000">$B4 </font><font color="#000080">/ </font><font color="#800000">$02 </font><font color="#000080">/                   </font><font color="#008000"><i>{  mov     AH,02 ; set AH for BIOS int 17h function 0}
    </i></font><font color="#800000">$CD </font><font color="#000080">/ </font><font color="#800000">$17 </font><font color="#000080">/                   </font><font color="#008000"><i>{  int     $17   ; do an int 17h}
    </i></font><font color="#800000">$86 </font><font color="#000080">/ </font><font color="#800000">$E0</font><font color="#000080">);                   </font><font color="#008000"><i>{  xchg    AL,AH ; put byte result in AL}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>DoInt17 <font color="#000080">(</font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>LPTNo <font color="#000080">: </font>WORD<font color="#000080">) : </font>BYTE<font color="#000080">;
  </font><font color="#008000"><i>{ send a character to LPTNo via ROM BIOS int 17h func 0h }
  </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(
    </font><font color="#800000">$5A </font><font color="#000080">/                         </font><font color="#008000"><i>{  pop     DX    ; get printer number}
    </i></font><font color="#800000">$58 </font><font color="#000080">/                         </font><font color="#008000"><i>{  pop     AX    ; get char}
    </i></font><font color="#800000">$B4 </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/                   </font><font color="#008000"><i>{  mov     AH,00 ; set AH for BIOS int 17h function 0}
    </i></font><font color="#800000">$CD </font><font color="#000080">/ </font><font color="#800000">$17 </font><font color="#000080">/                   </font><font color="#008000"><i>{  int     $17   ; do an int 17h}
    </i></font><font color="#800000">$86 </font><font color="#000080">/ </font><font color="#800000">$E0</font><font color="#000080">);                   </font><font color="#008000"><i>{  xchg    AL,AH ; put byte result in AL}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>AssignLst <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>F <font color="#000080">: </font>TEXT<font color="#000080">; </font>LPTNumber <font color="#000080">: </font>WORD<font color="#000080">);
  </font><font color="#008000"><i>{ like Turbo's assign, except associates Text variable with one of the LPTs }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>OutputToFile <font color="#000080">(</font>FName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
  </font><font color="#008000"><i>{redirect printer output to file }

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>PrinterStatus <font color="#000080">(</font>LPTNum <font color="#000080">: </font>BYTE<font color="#000080">) : </font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>Printer_OK <font color="#000080">: </font>BOOLEAN<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SelectPrinter <font color="#000080">(</font>LPTNum <font color="#000080">: </font>BYTE<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>ResetPrinter<font color="#000080">;           </font><font color="#008000"><i>{ only resets printer 0 }

</i></font><font color="#FF0000"><b>IMPLEMENTATION

TYPE
  </b></font>TextBuffer <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">127</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;

  </font>TextRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
              </b></font>Handle   <font color="#000080">: </font>WORD<font color="#000080">;
              </font>Mode     <font color="#000080">: </font>WORD<font color="#000080">;
              </font>BufSize  <font color="#000080">: </font>WORD<font color="#000080">;
              </font><font color="#FF0000"><b>Private  </b></font><font color="#000080">: </font>WORD<font color="#000080">;
              </font>BufPos   <font color="#000080">: </font>WORD<font color="#000080">;
              </font>BufEnd   <font color="#000080">: </font>WORD<font color="#000080">;
              </font>BufPtr   <font color="#000080">: ^</font>TextBuffer<font color="#000080">;
              </font>OpenFunc <font color="#000080">: </font>POINTER<font color="#000080">;
              </font>InOutFunc <font color="#000080">: </font>POINTER<font color="#000080">;
              </font>FlushFunc <font color="#000080">: </font>POINTER<font color="#000080">;
              </font>CloseFunc <font color="#000080">: </font>POINTER<font color="#000080">;
              </font><font color="#008000"><i>{ 16 byte user data area, I use 4 bytes }
              </i></font>PrintMode <font color="#000080">: </font>WORD<font color="#000080">;   </font><font color="#008000"><i>{ not currently used}
              </i></font>LPTNo <font color="#000080">: </font>WORD<font color="#000080">;       </font><font color="#008000"><i>{ LPT number in [0..2] }
              </i></font>UserData <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
              </font>Name <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
              </font>Buffer <font color="#000080">: </font>TextBuffer<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>LPTFileopen <font color="#000080">: </font>BOOLEAN <font color="#000080">= </font>FALSE<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>LPTExitSave <font color="#000080">: </font>POINTER<font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>Out_Char <font color="#000080">(</font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>LPTNo <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ErrorCode <font color="#000080">: </font>INTEGER<font color="#000080">);
    </font><font color="#008000"><i>{ call macro to send char to LPTNo.  If bit 4, the Printer Selected bit }
    { is not set upon return, it is assumed that an error has occurred.     }

  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>ErrorCode <font color="#000080">:= </font>DoInt17 <font color="#000080">(</font>Ch<font color="#000080">, </font>LPTNo<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ErrorCode <font color="#FF0000"><b>AND </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$10 </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ if bit 4 is set }
      </i></font>ErrorCode <font color="#000080">:= </font><font color="#800000">0              </font><font color="#008000"><i>{ no error }
      { if bit 4 is not set, error is passed untouched and placed in IOResult }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LstIgnore <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>F <font color="#000080">: </font>TextRec<font color="#000080">) : </font>INTEGER<font color="#000080">;
    </font><font color="#008000"><i>{ A do nothing, no error routine }
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>LstIgnore <font color="#000080">:= </font><font color="#800000">0                </font><font color="#008000"><i>{ return 0 for IOResult }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LstOutput <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>F <font color="#000080">: </font>TextRec<font color="#000080">) : </font>INTEGER<font color="#000080">;
    </font><font color="#008000"><i>{ Send whatever has accumulated in the Buffer to int 17h   }
    { If error occurs, return in IOResult.  See Inside Turbo   }
    { Pascal chapter of TP4 manual for more info on TFDD       }
  </i></font><font color="#FF0000"><b>VAR
    </b></font>I <font color="#000080">: </font>WORD<font color="#000080">;
    </font>ErrorCode <font color="#000080">: </font>INTEGER<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>LstOutput <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#008000"><i>{$IFDEF DOERRORCHECKING}
    </i></font><font color="#FF0000"><b>WHILE NOT </b></font>Printer_OK <font color="#FF0000"><b>DO
    BEGIN
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);</font>ClrEol<font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">'Please check Printer, and press any key when ready...'</font><font color="#000080">);
    </font>Readkey<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#008000"><i>{$ENDIF}

    </i></font><font color="#FF0000"><b>WITH </b></font>F <font color="#FF0000"><b>DO BEGIN
      FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>PRED <font color="#000080">(</font>BufPos<font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>Out_Char <font color="#000080">(</font>BufPtr<font color="#000080">^ [</font>I<font color="#000080">], </font>LPTNo<font color="#000080">, </font>ErrorCode<font color="#000080">); </font><font color="#008000"><i>{ send each char to printer }
        </i></font><font color="#FF0000"><b>IF </b></font>ErrorCode <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN </b></font><font color="#008000"><i>{ if error }
          </i></font>LstOutput <font color="#000080">:= </font>ErrorCode<font color="#000080">; </font><font color="#008000"><i>{ return errorcode in IOResult }
          </i></font>EXIT                    <font color="#008000"><i>{ return from function }
        </i></font><font color="#FF0000"><b>END
      END</b></font><font color="#000080">;
      </font>BufPos <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>AssignLst <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>F <font color="#000080">: </font>TEXT<font color="#000080">; </font>LPTNumber <font color="#000080">: </font>WORD<font color="#000080">);
    </font><font color="#008000"><i>{ like Turbo's assign, except associates Text variable with one of the LPTs }

  </i></font><font color="#FF0000"><b>BEGIN
    WITH </b></font>TextRec <font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>Mode <font color="#000080">:= </font>fmClosed<font color="#000080">;
        </font>BufSize <font color="#000080">:= </font>SIZEOF <font color="#000080">(</font>Buffer<font color="#000080">);
        </font>BufPtr <font color="#000080">:= @</font>Buffer<font color="#000080">;
        </font>OpenFunc <font color="#000080">:= @</font>LstIgnore<font color="#000080">;   </font><font color="#008000"><i>{ you don't open the BIOS printer functions }
        </i></font>CloseFunc <font color="#000080">:= @</font>LstIgnore<font color="#000080">;  </font><font color="#008000"><i>{ nor do you close them }
        </i></font>InOutFunc <font color="#000080">:= @</font>LstOutput<font color="#000080">;  </font><font color="#008000"><i>{ but you can Write to them }
        </i></font>FlushFunc <font color="#000080">:= @</font>LstOutput<font color="#000080">;  </font><font color="#008000"><i>{ and you can WriteLn to them }
        </i></font>LPTNo <font color="#000080">:= </font>LPTNumber<font color="#000080">;       </font><font color="#008000"><i>{ user selected printer num (in [0..2]) }
        </i></font>MOVE <font color="#000080">(</font>LPTNames <font color="#000080">[</font>LPTNumber<font color="#000080">], </font>Name<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">); </font><font color="#008000"><i>{ set name of device }
        </i></font>BufPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;              </font><font color="#008000"><i>{ reset BufPos }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>OutputToFile <font color="#000080">(</font>FName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>ASSIGN <font color="#000080">(</font>Lst<font color="#000080">, </font>FName<font color="#000080">);
    </font>REWRITE <font color="#000080">(</font>Lst<font color="#000080">);
    </font>LPTFileopen <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>PrinterStatus <font color="#000080">(</font>LPTNum <font color="#000080">: </font>BYTE<font color="#000080">) : </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Status <font color="#000080">: </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Status <font color="#000080">:= </font>GetROMPrinterStatus <font color="#000080">(</font>LPTNum<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">$B8</font><font color="#000080">) = </font><font color="#800000">$90 </font><font color="#FF0000"><b>THEN
      </b></font>PrinterStatus <font color="#000080">:= </font><font color="#800000">0          </font><font color="#008000"><i>{all's well}
    </i></font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">(</font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">$20</font><font color="#000080">) = </font><font color="#800000">$20 </font><font color="#FF0000"><b>THEN
      </b></font>PrinterStatus <font color="#000080">:= </font><font color="#800000">1          </font><font color="#008000"><i>{no Paper}
    </i></font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">(</font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$00 </font><font color="#FF0000"><b>THEN
      </b></font>PrinterStatus <font color="#000080">:= </font><font color="#800000">2          </font><font color="#008000"><i>{off line}
    </i></font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">(</font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$00 </font><font color="#FF0000"><b>THEN
      </b></font>PrinterStatus <font color="#000080">:= </font><font color="#800000">3          </font><font color="#008000"><i>{busy}
    </i></font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">(</font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">$08</font><font color="#000080">) = </font><font color="#800000">$08 </font><font color="#FF0000"><b>THEN
      </b></font>PrinterStatus <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;         </font><font color="#008000"><i>{undetermined error}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Printer_OK <font color="#000080">: </font>BOOLEAN<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Retry <font color="#000080">: </font>BYTE<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Retry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>PrinterStatus <font color="#000080">(</font>LPTPort<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Retry <font color="#000080">&lt; </font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>INC <font color="#000080">(</font>Retry<font color="#000080">);
    </font>Printer_OK <font color="#000080">:= (</font>PrinterStatus <font color="#000080">(</font>LPTPort<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                            </font><font color="#008000"><i>{PrinterReady}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SelectPrinter <font color="#000080">(</font>LPTNum <font color="#000080">: </font>BYTE<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    IF </b></font><font color="#000080">(</font>LPTNum <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>LPTNum <font color="#000080">&lt;= </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>LPTPort <font color="#000080">:= </font>LPTNum<font color="#000080">;
    </font>AssignLst <font color="#000080">(</font>Lst<font color="#000080">, </font>LPTPort<font color="#000080">);      </font><font color="#008000"><i>{ set up turbo 3 compatable Lst device }
    </i></font>REWRITE <font color="#000080">(</font>Lst<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>ResetPrinter<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>address <font color="#000080">: </font>INTEGER <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0040 </font><font color="#000080">: </font><font color="#800000">$0008</font><font color="#000080">;
    </font>portno<font color="#000080">, </font>DELAY <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>portno <font color="#000080">:= </font>address <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
    </font>Port <font color="#000080">[</font>portno<font color="#000080">] := </font><font color="#800000">232</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>DELAY <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">2000 </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{nothing} </i></font><font color="#000080">;
    </font>Port <font color="#000080">[</font>portno<font color="#000080">] := </font><font color="#800000">236</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                            </font><font color="#008000"><i>{ResetPrinter}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>LptExitHandler<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF </b></font>LPTFileopen <font color="#FF0000"><b>THEN </b></font>CLOSE <font color="#000080">(</font>Lst<font color="#000080">);
    </font>ExitProc <font color="#000080">:= </font>LPTExitSave<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

  </b></font>LPTExitSave <font color="#000080">:= </font>ExitProc<font color="#000080">;
  </font>ExitProc <font color="#000080">:= @</font>LptExitHandler<font color="#000080">;

  </font><font color="#008000"><i>{$IFDEF AssignLstDevice}

  </i></font>LPTPort <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>AssignLst <font color="#000080">(</font>Lst<font color="#000080">, </font>LPTPort<font color="#000080">);        </font><font color="#008000"><i>{ set up turbo 3 compatable Lst device }
  </i></font>REWRITE <font color="#000080">(</font>Lst<font color="#000080">);

  </font><font color="#008000"><i>{$ENDIF}

  {$IFDEF DOERRORCHECKING}
  </i></font><font color="#FF0000"><b>WHILE NOT </b></font>Printer_OK <font color="#FF0000"><b>DO
  BEGIN
  </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);</font>ClrEol<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Please check Printer, and press any key when ready...'</font><font color="#000080">);
  </font>Readkey<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0028.PAS">Original</a><b>]</b></p></body>
</html>
