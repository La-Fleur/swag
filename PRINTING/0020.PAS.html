<html>
<head><title> "Printer Check Routines" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>PRINTCHK<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">,</font>printer<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>lpt1<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
  </font>lpt2<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
  </font>lpt3<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;

  </font>PrnReady <font color="#000080">= </font><font color="#800000">$90</font><font color="#000080">;
  </font>OffLine <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">;
  </font>OffLine2 <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">;             </font><font color="#008000"><i>{NEW LINE}
  </i></font>PaperOut <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">;
  </font>PaperOut2 <font color="#000080">= </font><font color="#800000">$30</font><font color="#000080">;            </font><font color="#008000"><i>{NEW LINE}
  </i></font>HookedButOff <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">;         </font><font color="#008000"><i>{NEW LINE}
  </i></font>NoConnect <font color="#000080">= </font><font color="#800000">$B0</font><font color="#000080">;            </font><font color="#008000"><i>{MODIFIED LINE}

  {NOCONNECT = $30 FOR SOME COMPUTERS BY STU}

  </i></font><font color="#FF0000"><b>Function </b></font>ChkPrinter<font color="#000080">(</font>Printer<font color="#000080">:</font>Word<font color="#000080">) :</font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>Regs<font color="#000080">:</font>Registers<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Regs<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
    </font>Regs<font color="#000080">.</font>DX<font color="#000080">:=</font>Printer<font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>regs<font color="#000080">);
    </font>ChkPrinter<font color="#000080">:=</font>Regs<font color="#000080">.</font>AH
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>PrinterError<font color="#000080">(</font>ErrorCode<font color="#000080">:</font>BYTE<font color="#000080">);  ;</font>NEW


  <font color="#FF0000"><b>VAR
    </b></font>C <font color="#000080">: </font>BYTE<font color="#000080">;



  </font><font color="#FF0000"><b>Begin
   </b></font>ErrorCode <font color="#000080">:= </font>ErrorCode <font color="#FF0000"><b>and </b></font><font color="#800000">$B0</font><font color="#000080">;       </font><font color="#008000"><i>{NEW LINE}

   </i></font>C <font color="#000080">:= </font>ERRORCODE <font color="#FF0000"><b>SHL </b></font><font color="#800000">6   </font><font color="#008000"><i>{ALWAYS MEANS NOTHING CONNECTED}

   </i></font><font color="#FF0000"><b>IF </b></font>C <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>ERRORCODE <font color="#000080">= </font><font color="#800000">$B0</font><font color="#000080">; </font><font color="#008000"><i>{ELEMINATES NO LPT3 AND NOTHING CONNECTED}


   </i></font><font color="#FF0000"><b>Case </b></font>ErrorCode <font color="#FF0000"><b>of
    </b></font>NoConnect           <font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Printer not connected'</font><font color="#000080">);
    </font>Offline<font color="#000080">,</font>OffLine2    <font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Printer off line'</font><font color="#000080">);     </font><font color="#008000"><i>{Modified}
    </i></font>PaperOut<font color="#000080">,</font>PaperOut2  <font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Printer out of paper'</font><font color="#000080">); </font><font color="#008000"><i>{Modified}
    </i></font>HookedButOff        <font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Printer connected but turned off'</font><font color="#000080">); </font><font color="#008000"><i>{New}
   </i></font><font color="#FF0000"><b>else
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Printer error code: '</font><font color="#000080">,</font>ErrorCode<font color="#000080">);
   </font><font color="#FF0000"><b>end
  end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>TryPrinter<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{$I-}
   </i></font>WriteLn<font color="#000080">(</font>Lst<font color="#000080">,</font><font color="#800000">'Check Printer'</font><font color="#000080">+</font><font color="#800000">#12</font><font color="#000080">);
   </font><font color="#008000"><i>{$I+}
   </i></font>WriteLn<font color="#000080">(</font>IOResult<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
   </b></font>ClrScr<font color="#000080">;
   </font><font color="#008000"><i>{TryPrinter;}
   </i></font><font color="#FF0000"><b>If </b></font>ChkPrinter<font color="#000080">(</font>LPT1<font color="#000080">) = </font>PrnReady <font color="#FF0000"><b>then
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Printer is Ready'</font><font color="#000080">)
   </font><font color="#FF0000"><b>else
    </b></font>PrinterError<font color="#000080">(</font>ChkPrinter<font color="#000080">(</font>LPT1<font color="#000080">))
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
