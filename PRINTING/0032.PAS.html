<html>
<head><title> "HP Laser Jet Functions" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>HPUnit<font color="#000080">;
</font><font color="#008000"><i>{ Handles all aspects of HP LASER JET PRINTERS}

</i></font><font color="#FF0000"><b>INTERFACE

USES
 </b></font>Crt<font color="#000080">,
 </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>CONST
 </b></font>Esc       <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;
 </font>HPReset   <font color="#000080">= </font><font color="#800000">#27'E'</font><font color="#000080">;

</font><font color="#008000"><i>(* Page sizes... *)
 </i></font>Executive       <font color="#000080">= </font><font color="#800000">#27'&amp;l1A'</font><font color="#000080">;
 </font>Letter          <font color="#000080">= </font><font color="#800000">#27'&amp;l2A'</font><font color="#000080">;
 </font>Legal           <font color="#000080">= </font><font color="#800000">#27'&amp;l3A'</font><font color="#000080">;
 </font>A4              <font color="#000080">= </font><font color="#800000">#27'&amp;l26A'</font><font color="#000080">;
 </font>Monarch         <font color="#000080">= </font><font color="#800000">#27'&amp;l80A'</font><font color="#000080">;
 </font>Commercial10    <font color="#000080">= </font><font color="#800000">#27'&amp;l81A'</font><font color="#000080">;
 </font>InternationalDL <font color="#000080">= </font><font color="#800000">#27'&amp;l90A'</font><font color="#000080">;
 </font>InternationalCS <font color="#000080">= </font><font color="#800000">#27'&amp;l91A'</font><font color="#000080">;

 </font><font color="#008000"><i>(* orintation *)

 </i></font>Portrait  <font color="#000080">= </font><font color="#800000">#27'&amp;l0O'</font><font color="#000080">;
 </font>Landscape <font color="#000080">= </font><font color="#800000">#27'&amp;l1O'</font><font color="#000080">;

 </font><font color="#008000"><i>(* symbol set... *)

 </i></font>HpRoman8  <font color="#000080">= </font><font color="#800000">#27'(8U'</font><font color="#000080">;
 </font>PC8       <font color="#000080">= </font><font color="#800000">#27'(10U'</font><font color="#000080">;

 </font><font color="#008000"><i>(* spacQcing... *)

 </i></font>Fixed     <font color="#000080">= </font><font color="#800000">#27'(s0P'</font><font color="#000080">;
 </font>Proportional <font color="#000080">= </font><font color="#800000">#27'(s1P'</font><font color="#000080">;

 </font><font color="#008000"><i>(* style... *)

 </i></font>Upright   <font color="#000080">= </font><font color="#800000">#27'(s0S'</font><font color="#000080">;
 </font>Italic    <font color="#000080">= </font><font color="#800000">#27'(s1S'</font><font color="#000080">;

 </font><font color="#008000"><i>(* stroke... *)

 </i></font>Medium    <font color="#000080">= </font><font color="#800000">#27'(s0B'</font><font color="#000080">;
 </font>Bold      <font color="#000080">= </font><font color="#800000">#27'(s1B'</font><font color="#000080">;

 </font><font color="#008000"><i>(* typeface... *)

 </i></font>Lineprinter <font color="#000080">= </font><font color="#800000">#27'(s0T'</font><font color="#000080">;
 </font>Courier     <font color="#000080">= </font><font color="#800000">#27'(s3T'</font><font color="#000080">;
 </font>Helv        <font color="#000080">= </font><font color="#800000">#27'(s4T'</font><font color="#000080">;
 </font>TmsRoman    <font color="#000080">= </font><font color="#800000">#27'(s5T'</font><font color="#000080">;
 </font>LetterGothic <font color="#000080">= </font><font color="#800000">#27'(s6T'</font><font color="#000080">;
 </font>Prestige    <font color="#000080">= </font><font color="#800000">#27'(s8T'</font><font color="#000080">;
 </font>Presentations <font color="#000080">= </font><font color="#800000">#27'(s11T'</font><font color="#000080">;
 </font>Optima      <font color="#000080">= </font><font color="#800000">#27'(s17T'</font><font color="#000080">;
 </font>TCGaramond  <font color="#000080">= </font><font color="#800000">#27'(s18T'</font><font color="#000080">;
 </font>CooperBlack <font color="#000080">= </font><font color="#800000">#27'(s19T'</font><font color="#000080">;
 </font>CooperBold  <font color="#000080">= </font><font color="#800000">#27'(s20T'</font><font color="#000080">;
 </font>Broadway    <font color="#000080">= </font><font color="#800000">#27'(s21T'</font><font color="#000080">;
 </font>BauerBodoniBlackCondensed <font color="#000080">= </font><font color="#800000">#27'(s22T'</font><font color="#000080">;
 </font>CenturySchoolBook         <font color="#000080">= </font><font color="#800000">#27'(s23T'</font><font color="#000080">;
 </font>UniversityRoman           <font color="#000080">= </font><font color="#800000">#27'(s24T'</font><font color="#000080">;

 </font>StartUnderLine <font color="#000080">= </font><font color="#800000">#27'&amp;d0D'</font><font color="#000080">;
 </font>StopUnderLine <font color="#000080">= </font><font color="#800000">#27'&amp;d@'</font><font color="#000080">;

</font><font color="#008000"><i>(*  functions and procedures ...  *)

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Copies <font color="#000080">(</font>CopyCount <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>LinesPerPage <font color="#000080">(</font>LineCount <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>LinesPerInch <font color="#000080">(</font>LineCount <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>PrimaryPitch <font color="#000080">(</font>Pitch <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>PointSize <font color="#000080">(</font>Points <font color="#000080">: </font>REAL<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>PitchSize <font color="#000080">(</font>Pitch <font color="#000080">: </font>REAL<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>AbsHorizPos <font color="#000080">(</font>Inches <font color="#000080">: </font>REAL<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>AbsVertPos <font color="#000080">(</font>Inches <font color="#000080">: </font>REAL<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotXY <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">;</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>REAL<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotX <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">; </font>X <font color="#000080">: </font>REAL<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotY <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">;</font>Y <font color="#000080">: </font>REAL<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>FontId <font color="#000080">(</font>Id <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>FontStatus <font color="#000080">(</font>ID <font color="#000080">: </font>INTEGER<font color="#000080">; </font>Status <font color="#000080">: </font>CHAR<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>FontPrimORSec <font color="#000080">(</font>ID <font color="#000080">: </font>INTEGER<font color="#000080">; </font>Status <font color="#000080">: </font>CHAR<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>DownloadFont <font color="#000080">(</font>FontFileName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Id <font color="#000080">: </font>INTEGER<font color="#000080">; </font>Status <font color="#000080">: </font>CHAR<font color="#000080">;
                        </font>StatusX<font color="#000080">, </font>StatusY<font color="#000080">, </font>StatusFore<font color="#000080">, </font>StatusBack <font color="#000080">: </font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>EjectPage <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

CONST
 </b></font>BlockSize <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
 </b></font>BufferType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>BlockSize <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>St <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteAT <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>f<font color="#000080">, </font>b <font color="#000080">: </font>BYTE<font color="#000080">; </font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);

</font><font color="#FF0000"><b>VAR
  </b></font>cnter  <font color="#000080">: </font>WORD<font color="#000080">;
  </font>vidPtr <font color="#000080">: ^</font>WORD<font color="#000080">;
  </font>attrib <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>attrib <font color="#000080">:= </font>SWAP <font color="#000080">( (</font>b <font color="#FF0000"><b>SHL </b></font><font color="#800000">4</font><font color="#000080">) + </font>f<font color="#000080">);
  </font>vidptr <font color="#000080">:= </font>PTR <font color="#000080">(</font><font color="#800000">$B800</font><font color="#000080">, </font><font color="#800000">2 </font><font color="#000080">* (</font><font color="#800000">80 </font><font color="#000080">* </font>PRED <font color="#000080">(</font>y<font color="#000080">) + </font>PRED <font color="#000080">(</font>x<font color="#000080">) ) );
  </font><font color="#FF0000"><b>IF </b></font>lastmode <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>THEN
     </b></font>DEC <font color="#000080">(</font>LONGINT <font color="#000080">(</font>vidptr<font color="#000080">), </font><font color="#800000">$08000000</font><font color="#000080">);  </font><font color="#008000"><i>{ MONO ?? }
  </i></font><font color="#FF0000"><b>FOR </b></font>cnter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>vidptr<font color="#000080">^ := </font>attrib <font color="#FF0000"><b>OR </b></font>BYTE <font color="#000080">(</font>s <font color="#000080">[</font>cnter<font color="#000080">]);
    </font>INC <font color="#000080">(</font>vidptr<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Realstr <font color="#000080">(</font>Num <font color="#000080">: </font>REAL<font color="#000080">; </font>D <font color="#000080">: </font>BYTE<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Return a string value (width 'w')for the input real ('n') }
  </i></font><font color="#FF0000"><b>VAR
    </b></font>Stg <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>STR <font color="#000080">(</font>Num <font color="#000080">: </font><font color="#800000">10 </font><font color="#000080">: </font>D<font color="#000080">, </font>Stg<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>Stg <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#32 </font><font color="#FF0000"><b>DO </b></font>DELETE <font color="#000080">(</font>Stg<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>Realstr <font color="#000080">:= </font>Stg<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>IntStr <font color="#000080">(</font>Num <font color="#000080">: </font>LONGINT<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Stg <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>STR <font color="#000080">(</font>Num <font color="#000080">: </font><font color="#800000">10</font><font color="#000080">, </font>Stg<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font>Stg <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#32 </font><font color="#FF0000"><b>DO </b></font>DELETE <font color="#000080">(</font>Stg<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>IntStr <font color="#000080">:= </font>Stg<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Dta2Prn <font color="#000080">(</font>BufferAddr <font color="#000080">: </font>POINTER<font color="#000080">;
                   </font>BufferSize <font color="#000080">: </font>LONGINT<font color="#000080">); </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;

</font><font color="#008000"><i>{$L Dta2Prn.OBJ}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Copies<font color="#000080">;

</font><font color="#008000"><i>(* Get the string for the copycount...   *)

</i></font><font color="#FF0000"><b>BEGIN
 </b></font>STR <font color="#000080">(</font>CopyCount<font color="#000080">, </font>St<font color="#000080">);
 </font>Copies <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'&amp;l' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'X'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LinesPerPage<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>STR <font color="#000080">(</font>LineCount<font color="#000080">, </font>St<font color="#000080">);
 </font>LinesPerPage <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'&amp;l' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'F'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LinesPerInch<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>STR <font color="#000080">(</font>LineCount<font color="#000080">, </font>St<font color="#000080">);
 </font>LinesPerInch <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'&amp;l' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'D'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PrimaryPitch<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>STR <font color="#000080">(</font>Pitch<font color="#000080">, </font>St<font color="#000080">);
 </font>PrimaryPitch <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'(s' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'H'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PointSize<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>St <font color="#000080">:= </font>RealStr <font color="#000080">(</font>Points<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
 </font>PointSize <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'(s' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'V'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PitchSize<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>St <font color="#000080">:= </font>RealStr <font color="#000080">(</font>Pitch<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
 </font>PitchSize <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'(s' </font><font color="#000080">+ </font>St <font color="#000080">+ </font><font color="#800000">'H'
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>AbsHorizPos<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>Dots <font color="#000080">: </font>REAL<font color="#000080">;
 </font>DotSt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>Dots <font color="#000080">:= </font>Inches <font color="#000080">* </font><font color="#800000">300</font><font color="#000080">;
 </font>STR <font color="#000080">(</font>ROUND <font color="#000080">(</font>Dots<font color="#000080">), </font>DotSt<font color="#000080">);
 </font>AbsHorizPos <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'*p' </font><font color="#000080">+ </font>DotSt <font color="#000080">+ </font><font color="#800000">'X'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>AbsVertPos<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>Dots <font color="#000080">: </font>REAL<font color="#000080">;
 </font>DotSt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>Dots <font color="#000080">:= </font>Inches <font color="#000080">* </font><font color="#800000">300</font><font color="#000080">;
 </font>STR <font color="#000080">(</font>ROUND <font color="#000080">(</font>Dots<font color="#000080">), </font>DotSt<font color="#000080">);
 </font>AbsVertPos <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'*p' </font><font color="#000080">+ </font>DotSt <font color="#000080">+ </font><font color="#800000">'Y'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotXY <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">; </font>X<font color="#000080">, </font>Y <font color="#000080">: </font>REAL<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN
 </b></font>WRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font>AbsHorizPos <font color="#000080">(</font>X<font color="#000080">) );
 </font>WRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font>AbsVertPos <font color="#000080">(</font>Y<font color="#000080">) );
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotX <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">; </font>X <font color="#000080">: </font>REAL<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN
 </b></font>WRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font>AbsHorizPos <font color="#000080">(</font>X<font color="#000080">) );
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PlotY <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">; </font>Y <font color="#000080">: </font>REAL<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN
 </b></font>WRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font>AbsVertPos <font color="#000080">(</font>Y<font color="#000080">) );
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FontID<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>IdSt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>STR <font color="#000080">(</font>Id<font color="#000080">, </font>IdSt<font color="#000080">);
 </font>FontID <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'*c' </font><font color="#000080">+ </font>IdSt <font color="#000080">+ </font><font color="#800000">'D'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FontPrimORSec<font color="#000080">;

</font><font color="#008000"><i>(* Is the font you're about to send primary or secondary?  Send  *)
(*   the function 'P' or 'S'                                     *)

</i></font><font color="#FF0000"><b>VAR
 </b></font>IdSt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>Status <font color="#000080">:= </font>UPCASE <font color="#000080">(</font>Status<font color="#000080">);
 </font>STR <font color="#000080">(</font>Id<font color="#000080">, </font>IdSt<font color="#000080">);
 </font><font color="#FF0000"><b>CASE </b></font>Status <font color="#FF0000"><b>OF
  </b></font><font color="#800000">'P' </font><font color="#000080">: </font>FontPrimORSec <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'(' </font><font color="#000080">+ </font>IdSt <font color="#000080">+ </font><font color="#800000">'X'</font><font color="#000080">;
  </font><font color="#800000">'S' </font><font color="#000080">: </font>FontPrimORSec <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">')' </font><font color="#000080">+ </font>IdSt <font color="#000080">+ </font><font color="#800000">'X'
  </font><font color="#FF0000"><b>ELSE </b></font>FontPrimORSec <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>(* Case *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>FontStatus<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>IdSt <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>Status <font color="#000080">:= </font>UPCASE <font color="#000080">(</font>Status<font color="#000080">);
 </font>STR <font color="#000080">(</font>Id<font color="#000080">, </font>IdSt<font color="#000080">);
 </font><font color="#FF0000"><b>CASE </b></font>Status <font color="#FF0000"><b>OF
  </b></font><font color="#800000">'P' </font><font color="#000080">: </font>FontStatus <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'*c5' </font><font color="#000080">+ </font><font color="#800000">'F'</font><font color="#000080">;       </font><font color="#008000"><i>(* Permanent *)
  </i></font><font color="#800000">'T' </font><font color="#000080">: </font>FontStatus <font color="#000080">:= </font>Esc <font color="#000080">+ </font><font color="#800000">'*c4' </font><font color="#000080">+ </font><font color="#800000">'F'</font><font color="#000080">;       </font><font color="#008000"><i>(* Temp      *)
  </i></font><font color="#FF0000"><b>ELSE </b></font>FontStatus <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>(* Case *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DownloadFont<font color="#000080">;

</font><font color="#FF0000"><b>VAR
 </b></font>ListFile <font color="#000080">: </font>TEXT<font color="#000080">;
 </font>PrnFile<font color="#000080">,
 </font>FontFile <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
 </font>Buffer <font color="#000080">: </font>BufferType<font color="#000080">;
 </font>RecsRead <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>ASSIGN <font color="#000080">(</font>FontFile<font color="#000080">, </font>FontFileName<font color="#000080">);
 </font>RESET <font color="#000080">(</font>FontFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
 </font>ASSIGN <font color="#000080">(</font>PrnFile<font color="#000080">, </font><font color="#800000">'PRN'</font><font color="#000080">);
 </font>REWRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
 </font>ASSIGN <font color="#000080">(</font>ListFile<font color="#000080">, </font><font color="#800000">'PRN'</font><font color="#000080">);
 </font>REWRITE <font color="#000080">(</font>ListFile<font color="#000080">);
 </font>WRITE <font color="#000080">(</font>ListFile<font color="#000080">, </font>HPReset<font color="#000080">);
 </font>WRITE <font color="#000080">(</font>ListFile<font color="#000080">, </font>FontID <font color="#000080">(</font>Id<font color="#000080">) );
 </font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>EOF <font color="#000080">(</font>FontFile<font color="#000080">) ) </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>BLOCKREAD <font color="#000080">(</font>FontFile<font color="#000080">, </font>Buffer<font color="#000080">, </font>SIZEOF <font color="#000080">(</font>Buffer<font color="#000080">), </font>RecsRead<font color="#000080">);
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>StatusX <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>StatusY <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>WriteAt <font color="#000080">(</font>StatusX<font color="#000080">, </font>StatusY<font color="#000080">, </font>StatusFore<font color="#000080">, </font>StatusBack<font color="#000080">,
            </font>IntStr <font color="#000080">(</font>ROUND <font color="#000080">(</font>FILEPOS <font color="#000080">(</font>FontFile<font color="#000080">) / </font>FILESIZE <font color="#000080">(</font>FontFile<font color="#000080">) * </font><font color="#800000">100</font><font color="#000080">) ) +
            </font><font color="#800000">' % downloaded...'</font><font color="#000080">);
   </font>Dta2Prn <font color="#000080">(@</font>Buffer<font color="#000080">, </font>RecsRead<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>CLOSE <font color="#000080">(</font>FontFile<font color="#000080">);
 </font>WRITE <font color="#000080">(</font>ListFile<font color="#000080">, </font>FontStatus <font color="#000080">(</font>Id<font color="#000080">, </font>Status<font color="#000080">) );
 </font>WRITE <font color="#000080">(</font>ListFile<font color="#000080">, </font>FontPrimORSec <font color="#000080">(</font>Id<font color="#000080">, </font><font color="#800000">'P'</font><font color="#000080">) );
 </font>CLOSE <font color="#000080">(</font>PrnFile<font color="#000080">);
 </font>CLOSE <font color="#000080">(</font>ListFile<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>EjectPage <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>PrnFile <font color="#000080">: </font>TEXT<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN
 </b></font>WRITE <font color="#000080">(</font>PrnFile<font color="#000080">, </font>Esc <font color="#000080">+ </font><font color="#800000">'&amp;l0H'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>(* unit *)

{

CUT THIS OUT TO A SEPARATE FILE .. DTA2PRN.XX, and execute XX34 D filename
to create the OBJ file needed for this unit

*XX3402-000499-170789--72--85-40996-----DTA2PRN.OBJ--1-OF--1
U-Q+3IAuL3FEL2x0GZl2J22mI37C9Y3HHHe65k+++3FpQa7j623nQqJhMalZQW+UJaJmQqZj
PW+l9X0uW-o+ECYgHisG3IAuL3FEL2x0GZl2J22mI37C9Y3HHMa6+k-+uImK+U++O7M4++F1
HoF3FNU5+0UP++6-+FeE1U+++ER2J22mI37C++++LsU3+21V4E+tW+E+E86-YMU3+21e-+-3
W+U+ECAM++M+8UK60E-+slY++++Y++y60E-+slc++++Y+Eq6M+-+sY++++++++JDH2F0I+d+
+U+++++5IYJIEIF2IUd+-++++++6EZJ4FYJGIpc8E+M+++++0I7JFYN3IZB3Fkd+0++++++7
EZJ4FYJGHoNH0Y+8++++U+R3HYFBEJ7903O62E-+slg5HotHJ231Gkg+6+++t6US+21c+-J1
CZlII3lDEYdQF3F-AZ-GHWt-IoogHisGWNEr+++-4U+++-g++E+d++A+8U+3+0o+0++i++g+
A++B+16+1k+n+-2+B++H+1Q+3E+s+-Q+CE+M+2061E-+tURDHZBIEIB94kQ7W-2+ECM5F3F-
AZ-GHVY+++2++0K61U-+tUFCFJVI4E+++Eo+qe+T++2++3K9v1D7Wos2WrM6Ax6qf19YnFTW
y6jZLQ64+288+U++R+++
***** END OF BLOCK 1 *****


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
