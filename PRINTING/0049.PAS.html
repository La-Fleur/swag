<html>
<head><title> "Printing to a PostScript Printer" by CHRIS FRIZELLE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>PrintPS<font color="#000080">;
</font><font color="#008000"><i>{ Print text to a PostScript Printer, takes filename on command line
  Chris J G Frizelle    CompuServe 70630,717   October 1994
  Released into the public domain  }

</i></font><font color="#FF0000"><b>const
  </b></font>PageLen <font color="#000080">= </font><font color="#800000">61</font><font color="#000080">;         </font><font color="#008000"><i>{ length of a page, lines of text }
</i></font><font color="#FF0000"><b>var
  </b></font>Str<font color="#000080">, </font>pPort<font color="#000080">, </font>FName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>f<font color="#000080">, </font>tf        <font color="#000080">: </font>text<font color="#000080">;
  </font>cLine        <font color="#000080">: </font>byte<font color="#000080">;
  </font>cPage        <font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>StringFix<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font><font color="#008000"><i>{ replace \ by \\ and ( by (( and ) by )) and anything else you
      need to do to cope with pound (Sterling) signs, high ascii
      characters -- an exercise for you! }
    </i></font>StringFix <font color="#000080">:= </font>S<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ StringFix }

</i></font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ open the file to be printed, the file name is on the command line }
  </i></font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'PrintPS  Print text files on a PostScript Printer'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Chris J G Frizelle October 1994  CompuServe 70630,717'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Syntax:  PRINTPS  &lt;filename&gt;  &lt;port&gt;'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Example: PRINTPS  config.sys  lpt1'</font><font color="#000080">);
    </font>HALT<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FName <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                 </font><font color="#008000"><i>{ file to print }
  </i></font>pPort <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);                 </font><font color="#008000"><i>{ port or filename for output }
  </i></font>assign<font color="#000080">(</font>TF<font color="#000080">, </font>FName<font color="#000080">);
  </font>reset<font color="#000080">(</font>TF<font color="#000080">);

  </font>assign<font color="#000080">(</font>f<font color="#000080">, </font>pPort<font color="#000080">);                     </font><font color="#008000"><i>{ open the printer }
  </i></font>rewrite<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#008000"><i>{ set up counters }
  </i></font>cLine <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                           </font><font color="#008000"><i>{ line counter }
  </i></font>cPage <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                           </font><font color="#008000"><i>{ page counter }

  { do prolog -- subroutines for use by the PostScript program }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">#4</font><font color="#000080">);                       </font><font color="#008000"><i>{ Ctrl D character = new PS job }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'%!PS-Adobe-2.0'</font><font color="#000080">);         </font><font color="#008000"><i>{ this is a PS document... }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/Top 750 def'</font><font color="#000080">);           </font><font color="#008000"><i>{ location of top margin, points }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/Head 790 def'</font><font color="#000080">);          </font><font color="#008000"><i>{ location of header }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/LeftMarg 65 def'</font><font color="#000080">);       </font><font color="#008000"><i>{ amount of left margin }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/PnumPos 500 def'</font><font color="#000080">);       </font><font color="#008000"><i>{ position of page number }
  { subroutine to select our default font -- Courier }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/Deffont {/Courier findfont 10 scalefont setfont} def'</font><font color="#000080">);
  </font><font color="#008000"><i>{ subroutine to print a line of text }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/DoLine { %def'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'   show NewLine }def'</font><font color="#000080">);
  </font><font color="#008000"><i>{ subroutine to do a new line }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/NewLine { %def'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'   currentpoint 11 sub'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'   exch pop LeftMarg'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'   exch moveto }bind def'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'%%EndProlog'</font><font color="#000080">);

  </font><font color="#008000"><i>{ first page heading: file name and page number }
  </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'LeftMarg Head moveto'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/Courier-Bold findfont 10 scalefont setfont'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">+</font>FName<font color="#000080">+</font><font color="#800000">')DoLine'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'PnumPos Head moveto'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'(Page '</font><font color="#000080">, </font>cPage<font color="#000080">, </font><font color="#800000">')DoLine'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'Deffont'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'LeftMarg Top moveto'</font><font color="#000080">);

  </font><font color="#FF0000"><b>while not </b></font>EOF<font color="#000080">(</font>TF<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>ReadLn<font color="#000080">(</font>TF<font color="#000080">, </font>Str<font color="#000080">);            </font><font color="#008000"><i>{ read a line from input file }
    </i></font>Str <font color="#000080">:= </font>StringFix<font color="#000080">(</font>Str<font color="#000080">);      </font><font color="#008000"><i>{ fix up the line of text }
    </i></font>inc<font color="#000080">(</font>cLine<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>cLine <font color="#000080">= </font>PageLen <font color="#FF0000"><b>then begin
      </b></font><font color="#008000"><i>{ new page needed, print previous page and do header }
      </i></font>Inc<font color="#000080">(</font>cPage<font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'showpage'</font><font color="#000080">);                   </font><font color="#008000"><i>{ outputs existing page }
      </i></font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'LeftMarg Head moveto'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'/Courier-Bold findfont 10 scalefont setfont'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">+</font>FName<font color="#000080">+</font><font color="#800000">')DoLine'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'PnumPos Head moveto'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'(Page '</font><font color="#000080">, </font>cPage<font color="#000080">, </font><font color="#800000">')DoLine'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'Deffont'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'LeftMarg Top moveto'</font><font color="#000080">);
      </font>cLine <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">+</font>Str<font color="#000080">+</font><font color="#800000">')DoLine'</font><font color="#000080">);              </font><font color="#008000"><i>{ print line of text file }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'showpage '#4</font><font color="#000080">);  </font><font color="#008000"><i>{ output final page &amp; Ctrl D for end of job }

  </i></font>close<font color="#000080">(</font>TF<font color="#000080">);
  </font>close<font color="#000080">(</font>f<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PRINTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
