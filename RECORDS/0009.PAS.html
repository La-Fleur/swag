<html>
<head><title> "Delete Record Routine" by DANIEL HEFLEY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to RECORDS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
DANIEL HEFLEY

&gt; according to all references I've read, the only way to delete Records
&gt; in ANY File is to copy the good Records to a new File, skipping over
&gt; the ones you want deleted, delete the original File, and rename the new
&gt; one to the original name.  A long way of doing it, but I don't know of
&gt; any other.

 No.....You could:
}

</i></font><font color="#FF0000"><b>Procedure </b></font>DelRec<font color="#000080">(</font>RecIdx <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Count<font color="#000080">,
  </font>RecNo <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>IFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>ItemRec<font color="#000080">;
  </font>Item <font color="#000080">: </font>ItemRec<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>IFile<font color="#000080">,</font><font color="#800000">'Tmp.Dat'</font><font color="#000080">); </font>Reset<font color="#000080">(</font>f<font color="#000080">);   </font><font color="#008000"><i>{ assuming it exists }
  </i></font>Seek<font color="#000080">(</font>IFile<font color="#000080">,</font>idx<font color="#000080">);                     </font><font color="#008000"><i>{ assuming recidx exists }
  </i></font>RecNo <font color="#000080">:= </font>FileSize<font color="#000080">(</font>f<font color="#000080">) - </font>idx <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font>idx <font color="#FF0000"><b>to </b></font>RecNo <font color="#FF0000"><b>do
  begin
    </b></font>Seek<font color="#000080">(</font>IFile<font color="#000080">,</font>Count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font>Read<font color="#000080">(</font>IFile<font color="#000080">,</font>Item<font color="#000080">);        </font><font color="#008000"><i>{ read next rec }
    </i></font>Seek<font color="#000080">(</font>IFile<font color="#000080">,</font>Count<font color="#000080">);
    </font>Write<font color="#000080">(</font>IFile<font color="#000080">,</font>Item<font color="#000080">);       </font><font color="#008000"><i>{ overide prev rec }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Seek<font color="#000080">(</font>IFile<font color="#000080">,</font>RecNo<font color="#000080">);                       </font><font color="#008000"><i>{ seek to last Record }
  </i></font>Truncate<font color="#000080">(</font>IFile<font color="#000080">);                     </font><font color="#008000"><i>{ truncate rest of File }
  </i></font>Close<font color="#000080">(</font>IFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
&gt; Of course, you could cheat like I do...when I create a File With
&gt; Records, every one of them has one Boolean field called ACTIVE_REC,
&gt; which is forced to True when the Record is created.  if the user wants
&gt; to delete the Record, ACTIVE_REC becomes False and the Program ignores
&gt; the Record.  Eventually, you'll have to use the above
&gt; copy-delete-rename Procedure, but it sure saves time if you're just
&gt; deleting one Record!

When you initialize new Variables....find the Non Active Record and assign
your File index Variable to that record!
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to RECORDS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
