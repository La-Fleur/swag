<html>
<head><title> "Wolf3D mapedit" by BILL KIRBY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0166.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{Well, here it is, this is 1 of 2}

{
  MapEdit 4.1     Wolfenstein Map Editor

     Copyright (c) 1992  Bill Kirby
}

{$A+,B-,D+,E-,F-,G-,I+,L-,N-,O-,R-,S-,V-,X-}
{$M 16384,0,655360}
</i></font><font color="#FF0000"><b>program </b></font>mapedit<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">,</font>graph<font color="#000080">,</font>mouse<font color="#000080">; </font><font color="#008000"><i>{ mouse unit in MOUSE.SWG }

</i></font><font color="#FF0000"><b>const </b></font>MAP_X <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
      </font>MAP_Y <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
      </font>TEXTLOC <font color="#000080">= </font><font color="#800000">460</font><font color="#000080">;

      </font>GAMEPATH     <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'.\'</font><font color="#000080">;
      </font>HEADFILENAME <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'maphead'</font><font color="#000080">;
      </font>MAPFILENAME  <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'maptemp'</font><font color="#000080">;
      </font>LEVELS       <font color="#000080">: </font>word   <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
      </font>GAME_VERSION <font color="#000080">: </font>real   <font color="#000080">= </font><font color="#800000">1.0</font><font color="#000080">;

</font><font color="#FF0000"><b>type </b></font>data_block <font color="#000080">= </font><font color="#FF0000"><b>record
       </b></font>size <font color="#000080">: </font>word<font color="#000080">;
       </font>data <font color="#000080">: </font>pointer<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>level_type <font color="#000080">= </font><font color="#FF0000"><b>record
       </b></font>map<font color="#000080">,
       </font>objects<font color="#000080">,
       </font>other           <font color="#000080">: </font>data_block<font color="#000080">;
       </font>width<font color="#000080">,
       </font>height          <font color="#000080">: </font>word<font color="#000080">;
       </font>name            <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>grid <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

     </font>filltype <font color="#000080">= (</font>solid<font color="#000080">,</font>check<font color="#000080">);
     </font>doortype <font color="#000080">= (</font>horiz<font color="#000080">,</font>vert<font color="#000080">);


</font><font color="#FF0000"><b>var </b></font>levelmap<font color="#000080">,
    </font>objectmap    <font color="#000080">: </font>grid<font color="#000080">;
    </font>maps         <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>level_type<font color="#000080">;

    </font>show_objects<font color="#000080">,
    </font>show_floor   <font color="#000080">: </font>boolean<font color="#000080">;

    </font>mapgraph<font color="#000080">,
    </font>objgraph     <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">511</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>mapnames<font color="#000080">,
    </font>objnames     <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">511</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];

    </font>themouse  <font color="#000080">: </font>resetrec<font color="#000080">;
    </font>mouseloc  <font color="#000080">: </font>locrec<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>waitforkey<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  repeat until </b></font>keypressed<font color="#000080">;
  </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>key<font color="#000080">:= </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>getkey<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">: </font>char<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>control<font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>control<font color="#000080">:= </font>false<font color="#000080">;
  </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
    begin
      </b></font>control<font color="#000080">:= </font>true<font color="#000080">;
      </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>decorate<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c<font color="#000080">);
  </font>bar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>box<font color="#000080">(</font>fill<font color="#000080">: </font>filltype<font color="#000080">; </font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">: </font>integer<font color="#000080">; </font>dec<font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>fill<font color="#000080">=</font>solid <font color="#FF0000"><b>then
    </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,</font>c1<font color="#000080">);

  </font>bar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">+</font>MAP_Y<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>dec <font color="#FF0000"><b>then </b></font>decorate<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>outtext<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>color<font color="#000080">: </font>integer<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>setcolor<font color="#000080">(</font>color<font color="#000080">);
  </font>outtextxy<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">,</font>s<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>hex<font color="#000080">(</font>x<font color="#000080">: </font>word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>digit <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">] = </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>i    <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>temp<font color="#000080">:= </font><font color="#800000">'    '</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">4 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>temp<font color="#000080">[</font>i<font color="#000080">]:= </font>digit<font color="#000080">[(</font>x <font color="#FF0000"><b>and </b></font><font color="#800000">$000f</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">];
      </font>x<font color="#000080">:= </font>x <font color="#FF0000"><b>div </b></font><font color="#800000">16</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>hex<font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>hexbyte<font color="#000080">(</font>x<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>digit <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">] = </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>i    <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>temp<font color="#000080">:= </font><font color="#800000">'  '</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>temp<font color="#000080">[</font>i<font color="#000080">]:= </font>digit<font color="#000080">[(</font>x <font color="#FF0000"><b>and </b></font><font color="#800000">$000f</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">];
      </font>x<font color="#000080">:= </font>x <font color="#FF0000"><b>div </b></font><font color="#800000">16</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>hexbyte<font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>doline<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>line<font color="#000080">(</font>x<font color="#000080">+</font>MAP_X<font color="#000080">,</font>y<font color="#000080">+</font>MAP_Y<font color="#000080">,</font>x2<font color="#000080">+</font>MAP_X<font color="#000080">,</font>y2<font color="#000080">+</font>MAP_Y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>dobar<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>bar<font color="#000080">(</font>x<font color="#000080">+</font>MAP_Y<font color="#000080">,</font>y<font color="#000080">+</font>MAP_Y<font color="#000080">,</font>x2<font color="#000080">+</font>MAP_X<font color="#000080">,</font>y2<font color="#000080">+</font>MAP_Y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>circle<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>const </b></font>sprite <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">=
                   ((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
                    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
                    (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
                    (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
                    (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
                    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
                    (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">));
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>c<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>do
    for </b></font>j<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>do
      begin
        case </b></font>sprite<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">] </font><font color="#FF0000"><b>of
          </b></font><font color="#800000">0</font><font color="#000080">: </font>c<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#800000">1</font><font color="#000080">: </font>c<font color="#000080">:=</font>c1<font color="#000080">;
          </font><font color="#800000">2</font><font color="#000080">: </font>c<font color="#000080">:=</font>c2<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>putpixel<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font>i<font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font>j<font color="#000080">,</font>c<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>door<font color="#000080">(</font>dtype<font color="#000080">: </font>doortype<font color="#000080">; </font>x<font color="#000080">,</font>y<font color="#000080">,</font>color<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>dtype <font color="#FF0000"><b>of
    </b></font>vert<font color="#000080">: </font><font color="#FF0000"><b>begin
            </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>color<font color="#000080">);
            </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>horiz <font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>color<font color="#000080">);
              </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>hexnibble<font color="#000080">(</font>c<font color="#000080">: </font>char<font color="#000080">): </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>c <font color="#FF0000"><b>of
    </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">: </font>hexnibble<font color="#000080">:= </font>ord<font color="#000080">(</font>c<font color="#000080">)-</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
    </font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'f'</font><font color="#000080">: </font>hexnibble<font color="#000080">:= </font>ord<font color="#000080">(</font>c<font color="#000080">)-</font>ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'F'</font><font color="#000080">: </font>hexnibble<font color="#000080">:= </font>ord<font color="#000080">(</font>c<font color="#000080">)-</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>hexnibble<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>output<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">; </font>data<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>size  <font color="#000080">: </font>integer<font color="#000080">;
    </font>temp  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>c1<font color="#000080">,</font>c2 <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>data<font color="#000080">&lt;&gt;</font><font color="#800000">'0000' </font><font color="#FF0000"><b>then
    begin
      </b></font>temp<font color="#000080">:= </font>data<font color="#000080">;
      </font>c1<font color="#000080">:= </font>hexnibble<font color="#000080">(</font>temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font>c2<font color="#000080">:= </font>hexnibble<font color="#000080">(</font>temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
      </font><font color="#FF0000"><b>case </b></font>temp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of
        </b></font><font color="#800000">'0'</font><font color="#000080">: </font>outtext<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>temp<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
        </font><font color="#800000">'1'</font><font color="#000080">: </font>box<font color="#000080">(</font>solid<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>false<font color="#000080">);
        </font><font color="#800000">'2'</font><font color="#000080">: </font>box<font color="#000080">(</font>check<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>false<font color="#000080">);
        </font><font color="#800000">'3'</font><font color="#000080">: </font>box<font color="#000080">(</font>solid<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>true<font color="#000080">);
        </font><font color="#800000">'4'</font><font color="#000080">: </font>box<font color="#000080">(</font>check<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>true<font color="#000080">);
        </font><font color="#800000">'5'</font><font color="#000080">: </font>circle<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">);
        </font><font color="#800000">'6'</font><font color="#000080">: </font>door<font color="#000080">(</font>horiz<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">);
        </font><font color="#800000">'7'</font><font color="#000080">: </font>door<font color="#000080">(</font>vert<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>c1<font color="#000080">);
        </font><font color="#800000">'8'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
               </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">);
               </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
               </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c2<font color="#000080">);
               </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'9'</font><font color="#000080">: </font>putpixel<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>c1<font color="#000080">);
        </font><font color="#800000">'a'</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">); </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'b'</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">); </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">4</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'c'</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">); </font>dobar<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'d'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
               </b></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
               </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">);
               </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">5</font><font color="#000080">);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'e'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
               </b></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
               </font>rectangle<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'f'</font><font color="#000080">: </font><font color="#FF0000"><b>case </b></font>c2 <font color="#FF0000"><b>of
              </b></font><font color="#800000">2</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{east}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">0</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{north}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">6</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{west}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">4</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{south}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">1</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{northeast}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">7</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{northwest}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">3</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{southeast}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">5</font><font color="#000080">: </font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{southwest}
                   </i></font>setcolor<font color="#000080">(</font>c1<font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                   </font>doline<font color="#000080">(</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>x<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>y<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>display_map<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>j<font color="#000080">:= </font><font color="#800000">63</font><font color="#000080">;
  </font>i<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>dobar<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>i<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>show_floor <font color="#FF0000"><b>then
      </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>mapgraph<font color="#000080">[</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]])
    </font><font color="#FF0000"><b>else
      if not </b></font><font color="#000080">(</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">$6a</font><font color="#000080">..</font><font color="#800000">$8f</font><font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>mapgraph<font color="#000080">[</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]]);
    </font><font color="#FF0000"><b>if </b></font>show_objects <font color="#FF0000"><b>then
      </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>objgraph<font color="#000080">[</font>objectmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]]);
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">=</font><font color="#800000">64 </font><font color="#FF0000"><b>then
      begin
        </b></font>i<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>dec<font color="#000080">(</font>j<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>j<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>read_levels<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>headfile<font color="#000080">,
    </font>mapfile  <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
    </font>s<font color="#000080">,</font>o<font color="#000080">,
    </font>size     <font color="#000080">: </font>word<font color="#000080">;
    </font>idsig    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>level    <font color="#000080">: </font>integer<font color="#000080">;
    </font>levelptr <font color="#000080">: </font>longint<font color="#000080">;
    </font>tempstr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
    </font>map_pointer<font color="#000080">,
    </font>object_pointer<font color="#000080">,
    </font>other_pointer    <font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>idsig<font color="#000080">:= </font><font color="#800000">'    '</font><font color="#000080">;
  </font>tempstr<font color="#000080">:= </font><font color="#800000">'                '</font><font color="#000080">;
  </font>assign<font color="#000080">(</font>headfile<font color="#000080">,</font>GAMEPATH<font color="#000080">+</font>HEADFILENAME<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>reset<font color="#000080">(</font>headfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'error opening '</font><font color="#000080">,</font>HEADFILENAME<font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>assign<font color="#000080">(</font>mapfile<font color="#000080">,</font>GAMEPATH<font color="#000080">+</font>MAPFILENAME<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>reset<font color="#000080">(</font>mapfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'error opening '</font><font color="#000080">,</font>MAPFILENAME<font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>level<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LEVELS <font color="#FF0000"><b>do
    begin
      </b></font>seek<font color="#000080">(</font>headfile<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+(</font>level<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">4</font><font color="#000080">);
      </font>blockread<font color="#000080">(</font>headfile<font color="#000080">,</font>levelptr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
      </font>seek<font color="#000080">(</font>mapfile<font color="#000080">,</font>levelptr<font color="#000080">);
      </font><font color="#FF0000"><b>with </b></font>maps<font color="#000080">[</font>level<font color="#000080">] </font><font color="#FF0000"><b>do
        begin
          </b></font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>map_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>object_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>other_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>objects<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>other<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>width<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>height<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#16</font><font color="#000080">;
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">16</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>GAME_VERSION <font color="#000080">= </font><font color="#800000">1.1 </font><font color="#FF0000"><b>then
            </b></font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>idsig<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">);

          </font>seek<font color="#000080">(</font>mapfile<font color="#000080">,</font>map_pointer<font color="#000080">);
          </font>getmem<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">);
          </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
          </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>map<font color="#000080">.</font>size<font color="#000080">);

          </font>seek<font color="#000080">(</font>mapfile<font color="#000080">,</font>object_pointer<font color="#000080">);
          </font>getmem<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">,</font>objects<font color="#000080">.</font>size<font color="#000080">);
          </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
          </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>objects<font color="#000080">.</font>size<font color="#000080">);

          </font>seek<font color="#000080">(</font>mapfile<font color="#000080">,</font>other_pointer<font color="#000080">);
          </font>getmem<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">,</font>other<font color="#000080">.</font>size<font color="#000080">);
          </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
          </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
          </font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>other<font color="#000080">.</font>size<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>GAME_VERSION <font color="#000080">= </font><font color="#800000">1.0 </font><font color="#FF0000"><b>then
            </b></font>blockread<font color="#000080">(</font>mapfile<font color="#000080">,</font>idsig<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>mapfile<font color="#000080">);
  </font>close<font color="#000080">(</font>headfile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>write_levels<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>headfile<font color="#000080">,
    </font>mapfile    <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
    </font>abcd<font color="#000080">,
    </font>s<font color="#000080">,</font>o<font color="#000080">,
    </font>size     <font color="#000080">: </font>word<font color="#000080">;
    </font>idsig    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>level    <font color="#000080">: </font>integer<font color="#000080">;
    </font>levelptr <font color="#000080">: </font>longint<font color="#000080">;
    </font>tempstr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
    </font>map_pointer<font color="#000080">,
    </font>object_pointer<font color="#000080">,
    </font>other_pointer    <font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>abcd<font color="#000080">:= </font><font color="#800000">$abcd</font><font color="#000080">;
  </font>idsig<font color="#000080">:= </font><font color="#800000">'!ID!'</font><font color="#000080">;
  </font>tempstr<font color="#000080">:= </font><font color="#800000">'TED5v1.0'</font><font color="#000080">;
  </font>assign<font color="#000080">(</font>headfile<font color="#000080">,</font>GAMEPATH<font color="#000080">+</font>HEADFILENAME<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>headfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>assign<font color="#000080">(</font>mapfile<font color="#000080">,</font>GAMEPATH<font color="#000080">+</font>MAPFILENAME<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>mapfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

  </font>blockwrite<font color="#000080">(</font>headfile<font color="#000080">,</font>abcd<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>tempstr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">8</font><font color="#000080">);
  </font>levelptr<font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>level<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LEVELS <font color="#FF0000"><b>do
    begin
      with </b></font>maps<font color="#000080">[</font>level<font color="#000080">] </font><font color="#FF0000"><b>do
        begin
          if </b></font>GAME_VERSION <font color="#000080">= </font><font color="#800000">1.1 </font><font color="#FF0000"><b>then
            begin
              </b></font>map_pointer<font color="#000080">:= </font>levelptr<font color="#000080">;
              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>map<font color="#000080">.</font>size<font color="#000080">);
              </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">);

              </font>object_pointer<font color="#000080">:= </font>levelptr<font color="#000080">;
              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>objects<font color="#000080">.</font>size<font color="#000080">);
              </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font>objects<font color="#000080">.</font>size<font color="#000080">);

              </font>other_pointer<font color="#000080">:= </font>levelptr<font color="#000080">;
              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>other<font color="#000080">.</font>size<font color="#000080">);
              </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font>other<font color="#000080">.</font>size<font color="#000080">);

              </font>blockwrite<font color="#000080">(</font>headfile<font color="#000080">,</font>levelptr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);

              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>map_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>object_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>other_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>objects<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>other<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>width<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>height<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#16</font><font color="#000080">;
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">16</font><font color="#000080">);
              </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font><font color="#800000">38</font><font color="#000080">);
            </font><font color="#FF0000"><b>end
          else
            begin
              </b></font>blockwrite<font color="#000080">(</font>headfile<font color="#000080">,</font>levelptr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>map_pointer<font color="#000080">:= </font>levelptr<font color="#000080">+</font><font color="#800000">38</font><font color="#000080">;
              </font>object_pointer<font color="#000080">:= </font>map_pointer<font color="#000080">+</font>map<font color="#000080">.</font>size<font color="#000080">;
              </font>other_pointer<font color="#000080">:= </font>object_pointer<font color="#000080">+</font>objects<font color="#000080">.</font>size<font color="#000080">;

              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>map_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>object_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>other_pointer<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>objects<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>other<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>width<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>height<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#16</font><font color="#000080">;
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">16</font><font color="#000080">);

              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>map<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>map<font color="#000080">.</font>size<font color="#000080">);
              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>objects<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>objects<font color="#000080">.</font>size<font color="#000080">);
              </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
              </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>other<font color="#000080">.</font>data<font color="#000080">^);
              </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>other<font color="#000080">.</font>size<font color="#000080">);
              </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font>map<font color="#000080">.</font>size<font color="#000080">+</font>objects<font color="#000080">.</font>size<font color="#000080">+</font>other<font color="#000080">.</font>size<font color="#000080">+</font><font color="#800000">38</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>blockwrite<font color="#000080">(</font>mapfile<font color="#000080">,</font>idsig<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>levelptr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>mapfile<font color="#000080">);
  </font>close<font color="#000080">(</font>headfile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>a7a8_expand<font color="#000080">(</font>src<font color="#000080">: </font>data_block<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>dest<font color="#000080">: </font>data_block<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">,</font>o<font color="#000080">,
    </font>s2<font color="#000080">,</font>o2<font color="#000080">,
    </font>index<font color="#000080">,
    </font>index2<font color="#000080">,
    </font>size<font color="#000080">,
    </font>length<font color="#000080">,
    </font>data<font color="#000080">,
    </font>newsize  <font color="#000080">: </font>word<font color="#000080">;
    </font>goback1  <font color="#000080">: </font>byte<font color="#000080">;
    </font>goback2  <font color="#000080">: </font>word<font color="#000080">;
    </font>i        <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>s<font color="#000080">:=</font>seg<font color="#000080">(</font>src<font color="#000080">.</font>data<font color="#000080">^);
  </font>o<font color="#000080">:=</font>ofs<font color="#000080">(</font>src<font color="#000080">.</font>data<font color="#000080">^);
  </font>index<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>index<font color="#000080">],</font>dest<font color="#000080">.</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>index<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>getmem<font color="#000080">(</font>dest<font color="#000080">.</font>data<font color="#000080">,</font>dest<font color="#000080">.</font>size<font color="#000080">);
  </font>s2<font color="#000080">:=</font>seg<font color="#000080">(</font>dest<font color="#000080">.</font>data<font color="#000080">^);
  </font>o2<font color="#000080">:=</font>ofs<font color="#000080">(</font>dest<font color="#000080">.</font>data<font color="#000080">^);
  </font>index2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>repeat
    </b></font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>index<font color="#000080">],</font>data<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>index<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>case </b></font>hi<font color="#000080">(</font>data<font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">$a7</font><font color="#000080">: </font><font color="#FF0000"><b>begin
             </b></font>length<font color="#000080">:=</font>lo<font color="#000080">(</font>data<font color="#000080">);
             </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>index<font color="#000080">],</font>goback1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>inc<font color="#000080">(</font>index<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
             </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s2<font color="#000080">:</font>o2<font color="#000080">+</font>index2<font color="#000080">-</font>goback1<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">],</font>mem<font color="#000080">[</font>s2<font color="#000080">:</font>o2<font color="#000080">+</font>index2<font color="#000080">],</font>length<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
             </font>inc<font color="#000080">(</font>index2<font color="#000080">,</font>length<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">$a8</font><font color="#000080">: </font><font color="#FF0000"><b>begin
             </b></font>length<font color="#000080">:=</font>lo<font color="#000080">(</font>data<font color="#000080">);
             </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>index<font color="#000080">],</font>goback2<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>index<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
             </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s2<font color="#000080">:</font>o2<font color="#000080">+</font>goback2<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">],</font>mem<font color="#000080">[</font>s2<font color="#000080">:</font>o2<font color="#000080">+</font>index2<font color="#000080">],</font>length<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
             </font>inc<font color="#000080">(</font>index2<font color="#000080">,</font>length<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>else begin
             </b></font>move<font color="#000080">(</font>data<font color="#000080">,</font>mem<font color="#000080">[</font>s2<font color="#000080">:</font>o2<font color="#000080">+</font>index2<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
             </font>inc<font color="#000080">(</font>index2<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>index<font color="#000080">=</font>src<font color="#000080">.</font>size<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>expand<font color="#000080">(</font>d<font color="#000080">: </font>data_block<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>g<font color="#000080">: </font>grid<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>integer<font color="#000080">;
    </font>s<font color="#000080">,</font>o<font color="#000080">,
    </font>data<font color="#000080">,
    </font>count <font color="#000080">: </font>word<font color="#000080">;
    </font>temp  <font color="#000080">: </font>data_block<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GAME_VERSION <font color="#000080">= </font><font color="#800000">1.1 </font><font color="#FF0000"><b>then
    </b></font>a7a8_expand<font color="#000080">(</font>d<font color="#000080">,</font>temp<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>temp<font color="#000080">:=</font>d<font color="#000080">;

  </font>x<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>y<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>temp<font color="#000080">.</font>data<font color="#000080">^);
  </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>temp<font color="#000080">.</font>data<font color="#000080">^);
  </font>inc<font color="#000080">(</font>o<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>data<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>o<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>data<font color="#000080">=</font><font color="#800000">$abcd </font><font color="#FF0000"><b>then
        begin
          </b></font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>count<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>o<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>move<font color="#000080">(</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font>data<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">); </font>inc<font color="#000080">(</font>o<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>count <font color="#FF0000"><b>do
            begin
              </b></font>g<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:= </font>data<font color="#000080">;
              </font>inc<font color="#000080">(</font>x<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">=</font><font color="#800000">64 </font><font color="#FF0000"><b>then
                begin
                  </b></font>x<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                  </font>inc<font color="#000080">(</font>y<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>g<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:= </font>data<font color="#000080">;
          </font>inc<font color="#000080">(</font>x<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">=</font><font color="#800000">64 </font><font color="#FF0000"><b>then
            begin
              </b></font>x<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>inc<font color="#000080">(</font>y<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>GAME_VERSION<font color="#000080">=</font><font color="#800000">1.1 </font><font color="#FF0000"><b>then
    </b></font>freemem<font color="#000080">(</font>temp<font color="#000080">.</font>data<font color="#000080">,</font>temp<font color="#000080">.</font>size<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>compress<font color="#000080">(</font>g<font color="#000080">: </font>grid<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>d<font color="#000080">: </font>data_block<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>temp     <font color="#000080">: </font>pointer<font color="#000080">;
    </font>size<font color="#000080">: </font>word<font color="#000080">;
    </font>abcd<font color="#000080">,
    </font>s<font color="#000080">,</font>o<font color="#000080">,
    </font>olddata<font color="#000080">,
    </font>data<font color="#000080">,
    </font>nextdata<font color="#000080">,
    </font>count    <font color="#000080">: </font>word<font color="#000080">;
    </font>x<font color="#000080">,</font>y<font color="#000080">,</font>i    <font color="#000080">: </font>integer<font color="#000080">;
    </font>temp2    <font color="#000080">: </font>pointer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>abcd<font color="#000080">:= </font><font color="#800000">$abcd</font><font color="#000080">;
  </font>x<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>y<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>getmem<font color="#000080">(</font>temp<font color="#000080">,</font><font color="#800000">8194</font><font color="#000080">);
  </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>temp<font color="#000080">^);
  </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>temp<font color="#000080">^);
  </font>data<font color="#000080">:= </font><font color="#800000">$2000</font><font color="#000080">;
  </font>move<font color="#000080">(</font>data<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);

  </font>size<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>data<font color="#000080">:= </font>g<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">];
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>count<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>x<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">=</font><font color="#800000">64 </font><font color="#FF0000"><b>then
          begin
            </b></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
            </font>inc<font color="#000080">(</font>y<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>y<font color="#000080">&lt;</font><font color="#800000">64 </font><font color="#FF0000"><b>then
          </b></font>nextdata<font color="#000080">:= </font>g<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">];
        </font>inc<font color="#000080">(</font>count<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>nextdata<font color="#000080">&lt;&gt;</font>data<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y<font color="#000080">=</font><font color="#800000">64</font><font color="#000080">);
      </font>dec<font color="#000080">(</font>count<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>count<font color="#000080">&lt;</font><font color="#800000">3 </font><font color="#FF0000"><b>then
        begin
          for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>count <font color="#FF0000"><b>do
            begin
              </b></font>move<font color="#000080">(</font>data<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>size<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
              </font>inc<font color="#000080">(</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>move<font color="#000080">(</font>abcd<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>size<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>move<font color="#000080">(</font>count<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>size<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font>move<font color="#000080">(</font>data<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font>size<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>size<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>data<font color="#000080">:= </font>nextdata<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>getmem<font color="#000080">(</font>temp2<font color="#000080">,</font>size<font color="#000080">);
  </font>move<font color="#000080">(</font>temp<font color="#000080">^,</font>temp2<font color="#000080">^,</font>size<font color="#000080">);
  </font>freemem<font color="#000080">(</font>temp<font color="#000080">,</font><font color="#800000">8194</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>GAME_VERSION <font color="#000080">= </font><font color="#800000">1.1 </font><font color="#FF0000"><b>then
    begin
      </b></font>getmem<font color="#000080">(</font>temp<font color="#000080">,</font>size<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
      </font>s<font color="#000080">:= </font>seg<font color="#000080">(</font>temp<font color="#000080">^);
      </font>o<font color="#000080">:= </font>ofs<font color="#000080">(</font>temp<font color="#000080">^);
      </font>move<font color="#000080">(</font>size<font color="#000080">,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">],</font><font color="#800000">2</font><font color="#000080">);
      </font>move<font color="#000080">(</font>temp2<font color="#000080">^,</font>mem<font color="#000080">[</font>s<font color="#000080">:</font>o<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">],</font>size<font color="#000080">);
      </font>d<font color="#000080">.</font>data<font color="#000080">:=</font>temp<font color="#000080">;
      </font>d<font color="#000080">.</font>size<font color="#000080">:= </font>size<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
      </font>freemem<font color="#000080">(</font>temp2<font color="#000080">,</font>size<font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>d<font color="#000080">.</font>data<font color="#000080">:= </font>temp2<font color="#000080">;
      </font>d<font color="#000080">.</font>size<font color="#000080">:= </font>size<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>clear_level<font color="#000080">(</font>n<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>mhide<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
     for </b></font>y<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
       begin
         </b></font>levelmap<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:= </font><font color="#800000">$8c</font><font color="#000080">;
         </font>objectmap<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:= </font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
     begin
       </b></font>levelmap<font color="#000080">[</font>x<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">1</font><font color="#000080">;
       </font>levelmap<font color="#000080">[</font>x<font color="#000080">,</font><font color="#800000">63</font><font color="#000080">]:= </font><font color="#800000">1</font><font color="#000080">;
       </font>levelmap<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">,</font>x<font color="#000080">]:= </font><font color="#800000">1</font><font color="#000080">;
       </font>levelmap<font color="#000080">[</font><font color="#800000">63</font><font color="#000080">,</font>x<font color="#000080">]:= </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>display_map<font color="#000080">;
   </font>mshow<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>str_to_hex<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>word<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>temp <font color="#000080">: </font>word<font color="#000080">;
    </font>i    <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>temp<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>temp<font color="#000080">:= </font>temp <font color="#000080">* </font><font color="#800000">16</font><font color="#000080">;
      </font><font color="#FF0000"><b>case </b></font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
        </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>temp <font color="#000080">+ </font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
        </font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'f'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>temp <font color="#000080">+ </font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
        </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'F'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>temp <font color="#000080">+ </font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)+</font><font color="#800000">10</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>str_to_hex<font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>showlegend<font color="#000080">(</font>which<font color="#000080">,</font>start<font color="#000080">,</font>n<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">;
    </font>save<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>mhide<font color="#000080">;
  </font>save<font color="#000080">:= </font>show_objects<font color="#000080">;
  </font>show_objects<font color="#000080">:= </font>true<font color="#000080">;
  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">639</font><font color="#000080">-</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">30</font><font color="#000080">);
  </font>x<font color="#000080">:= </font><font color="#800000">66</font><font color="#000080">;
  </font>y<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font>start <font color="#FF0000"><b>to </b></font>start<font color="#000080">+</font>n<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      if </b></font>which<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
        begin
          </b></font>output<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>mapgraph<font color="#000080">[</font>i<font color="#000080">]);
          </font>outtext<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font>mapnames<font color="#000080">[</font>i<font color="#000080">]);
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>output<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>objgraph<font color="#000080">[</font>i<font color="#000080">]);
          </font>outtext<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>y<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font>objnames<font color="#000080">[</font>i<font color="#000080">]);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>inc<font color="#000080">(</font>y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>show_objects<font color="#000080">:= </font>save<font color="#000080">;
  </font>mshow<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>inside<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>inside<font color="#000080">:= (</font>x<font color="#000080">&gt;=</font>x1<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&lt;=</font>x2<font color="#000080">) </font><font color="#FF0000"><b>and
           </b></font><font color="#000080">(</font>y<font color="#000080">&gt;=</font>y1<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&lt;=</font>y2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>wait_for_mouserelease<font color="#000080">;
</font><font color="#FF0000"><b>begin
  repeat
    </b></font>mpos<font color="#000080">(</font>mouseloc<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font>mouseloc<font color="#000080">.</font>buttonstatus<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>bevel<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>c3<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>c1<font color="#000080">);
  </font>bar<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">);
  </font>setcolor<font color="#000080">(</font>c2<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y1<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>line<font color="#000080">(</font>x2<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">);
  </font>line<font color="#000080">(</font>x2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>setcolor<font color="#000080">(</font>c3<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>x1<font color="#000080">,</font>y2<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y1<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y2<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">,</font>y2<font color="#000080">,</font>x2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y2<font color="#000080">);
  </font>line<font color="#000080">(</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>x2<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>upper<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      </b></font>s<font color="#000080">[</font>i<font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">)+</font>ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">));
  </font>upper<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initialize<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
    </font>infile<font color="#000080">: </font>text<font color="#000080">;

    </font>path <font color="#000080">: </font>pathstr<font color="#000080">;
    </font>dir  <font color="#000080">: </font>dirstr<font color="#000080">;
    </font>name <font color="#000080">: </font>namestr<font color="#000080">;
    </font>ext  <font color="#000080">: </font>extstr<font color="#000080">;
    </font>filename  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>hexstr    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>graphstr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>name20    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
    </font>junk      <font color="#000080">: </font>char<font color="#000080">;
    </font>search    <font color="#000080">: </font>searchrec<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>filename<font color="#000080">:= </font>GAMEPATH <font color="#000080">+ </font>HEADFILENAME <font color="#000080">+ </font><font color="#800000">'.*'</font><font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'searching for '</font><font color="#000080">,</font>filename<font color="#000080">);
  </font>findfirst<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">$ff</font><font color="#000080">,</font>search<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Error opening '</font><font color="#000080">,</font>HEADFILENAME<font color="#000080">,</font><font color="#800000">' file.'</font><font color="#000080">);
      </font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">'Be sure that you installed MAPEDIT in the directory where'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Wolfenstein 3-D is installed.'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>filename<font color="#000080">:= </font>search<font color="#000080">.</font>name<font color="#000080">;
      </font>fsplit<font color="#000080">(</font>filename<font color="#000080">,</font>dir<font color="#000080">,</font>name<font color="#000080">,</font>ext<font color="#000080">);
      </font>HEADFILENAME<font color="#000080">:= </font>upper<font color="#000080">(</font>HEADFILENAME<font color="#000080">+</font>ext<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>upper<font color="#000080">(</font>ext<font color="#000080">)=</font><font color="#800000">'.WL1' </font><font color="#FF0000"><b>then
        begin
          </b></font>LEVELS<font color="#000080">:=</font><font color="#800000">10</font><font color="#000080">;
          </font>GAME_VERSION<font color="#000080">:=</font><font color="#800000">1.0</font><font color="#000080">;
          </font>MAPFILENAME<font color="#000080">:=</font><font color="#800000">'MAPTEMP'</font><font color="#000080">+</font>ext<font color="#000080">;
          </font>filename<font color="#000080">:=</font>GAMEPATH<font color="#000080">+</font><font color="#800000">'MAPTEMP'</font><font color="#000080">+</font>ext<font color="#000080">;
          </font>findfirst<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">$ff</font><font color="#000080">,</font>search<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
              </b></font>GAME_VERSION<font color="#000080">:=</font><font color="#800000">1.1</font><font color="#000080">;
              </font>MAPFILENAME<font color="#000080">:=</font><font color="#800000">'GAMEMAPS'</font><font color="#000080">+</font>ext<font color="#000080">;
              </font>filename<font color="#000080">:=</font>GAMEPATH<font color="#000080">+</font><font color="#800000">'GAMEMAPS'</font><font color="#000080">+</font>ext<font color="#000080">;
              </font>findfirst<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">$ff</font><font color="#000080">,</font>search<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Error opening GAMEMAPS or MAPTEMP file.'</font><font color="#000080">);
                  </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>upper<font color="#000080">(</font>ext<font color="#000080">)=</font><font color="#800000">'.WL3'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>upper<font color="#000080">(</font>ext<font color="#000080">)=</font><font color="#800000">'.WL6'</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>GAME_VERSION<font color="#000080">:=</font><font color="#800000">1.1</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>upper<font color="#000080">(</font>ext<font color="#000080">)=</font><font color="#800000">'.WL3' </font><font color="#FF0000"><b>then
            </b></font>LEVELS<font color="#000080">:= </font><font color="#800000">30
          </font><font color="#FF0000"><b>else
            </b></font>LEVELS<font color="#000080">:= </font><font color="#800000">60</font><font color="#000080">;
          </font>MAPFILENAME<font color="#000080">:=</font><font color="#800000">'GAMEMAPS'</font><font color="#000080">+</font>ext<font color="#000080">;
          </font>filename<font color="#000080">:=</font>GAMEPATH<font color="#000080">+</font><font color="#800000">'GAMEMAPS'</font><font color="#000080">+</font>ext<font color="#000080">;
          </font>findfirst<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">$ff</font><font color="#000080">,</font>search<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>doserror<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
              </b></font>writeln<font color="#000080">(</font><font color="#800000">'Error opening GAMEMAPS file.'</font><font color="#000080">);
              </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">511 </font><font color="#FF0000"><b>do
    begin
      </b></font>mapnames<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">'unknown '</font><font color="#000080">+</font>hex<font color="#000080">(</font>i<font color="#000080">);
      </font>objnames<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">'unknown '</font><font color="#000080">+</font>hex<font color="#000080">(</font>i<font color="#000080">);
      </font>mapgraph<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">'f010'</font><font color="#000080">;
      </font>objgraph<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">'f010'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>assign<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">'mapdata.def'</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>infile<font color="#000080">);
  </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>infile<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>readln<font color="#000080">(</font>infile<font color="#000080">,</font>hexstr<font color="#000080">,</font>junk<font color="#000080">,</font>graphstr<font color="#000080">,</font>junk<font color="#000080">,</font>name20<font color="#000080">);
      </font>mapnames<font color="#000080">[</font>str_to_hex<font color="#000080">(</font>hexstr<font color="#000080">)]:= </font>name20<font color="#000080">;
      </font>mapgraph<font color="#000080">[</font>str_to_hex<font color="#000080">(</font>hexstr<font color="#000080">)]:= </font>graphstr<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>infile<font color="#000080">);

  </font>assign<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">'objdata.def'</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>infile<font color="#000080">);
  </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>infile<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>readln<font color="#000080">(</font>infile<font color="#000080">,</font>hexstr<font color="#000080">,</font>junk<font color="#000080">,</font>graphstr<font color="#000080">,</font>junk<font color="#000080">,</font>name20<font color="#000080">);
      </font>objnames<font color="#000080">[</font>str_to_hex<font color="#000080">(</font>hexstr<font color="#000080">)]:= </font>name20<font color="#000080">;
      </font>objgraph<font color="#000080">[</font>str_to_hex<font color="#000080">(</font>hexstr<font color="#000080">)]:= </font>graphstr<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>infile<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>gd<font color="#000080">,</font>gm<font color="#000080">,
    </font>i<font color="#000080">,</font>j<font color="#000080">,</font>x<font color="#000080">,</font>y   <font color="#000080">: </font>integer<font color="#000080">;
    </font>infile    <font color="#000080">: </font>text<font color="#000080">;
    </font>level     <font color="#000080">: </font>word<font color="#000080">;
    </font>oldx<font color="#000080">,</font>oldy <font color="#000080">: </font>integer<font color="#000080">;
    </font>done      <font color="#000080">: </font>boolean<font color="#000080">;
    </font>outstr<font color="#000080">,
    </font>tempstr   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

    </font>legendpos <font color="#000080">: </font>integer<font color="#000080">;
    </font>legendtype<font color="#000080">: </font>integer<font color="#000080">;
    </font>newj        <font color="#000080">: </font>integer<font color="#000080">;
    </font>currenttype<font color="#000080">,
    </font>currentval<font color="#000080">: </font>integer<font color="#000080">;

    </font>oldj<font color="#000080">,</font>oldi <font color="#000080">: </font>integer<font color="#000080">;

    </font>key       <font color="#000080">: </font>char<font color="#000080">;
    </font>control   <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>clrscr<font color="#000080">;
  </font>initialize<font color="#000080">;
  </font>directvideo<font color="#000080">:=</font>false<font color="#000080">;
  </font>read_levels<font color="#000080">;

  </font>gd<font color="#000080">:= </font>vga<font color="#000080">;
  </font>gm<font color="#000080">:= </font>vgahi<font color="#000080">;
  </font>initgraph<font color="#000080">(</font>gd<font color="#000080">,</font>gm<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);

  </font>settextstyle<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>mreset<font color="#000080">(</font>themouse<font color="#000080">);

  </font>show_objects<font color="#000080">:= </font>true<font color="#000080">;
  </font>show_floor<font color="#000080">:= </font>false<font color="#000080">;

  </font>x<font color="#000080">:= </font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">];
  </font>port<font color="#000080">[</font><font color="#800000">$3c0</font><font color="#000080">]:= </font><font color="#800000">0</font><font color="#000080">;

  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">639</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">);
  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">28</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">);
  </font>setcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
  </font>outtextxy<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">' MAP  OBJ  UP  DOWN'</font><font color="#000080">);
  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">043</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">044</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">083</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">084</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">113</font><font color="#000080">,</font><font color="#800000">380</font><font color="#000080">-</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">+</font><font color="#800000">114</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">);

  </font>legendpos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>legendtype<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>currenttype<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>currentval<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

  </font>bar<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font><font color="#800000">60</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">61</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>currenttype<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>output<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font>mapgraph<font color="#000080">[</font>currentval<font color="#000080">]);
      </font>outtext<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">' - '</font><font color="#000080">+</font>mapnames<font color="#000080">[</font>currentval<font color="#000080">]);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>output<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font>objgraph<font color="#000080">[</font>currentval<font color="#000080">]);
      </font>outtext<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">' - '</font><font color="#000080">+</font>objnames<font color="#000080">[</font>currentval<font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);

  </font>x<font color="#000080">:= </font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">];
  </font>port<font color="#000080">[</font><font color="#800000">$3c0</font><font color="#000080">]:= </font><font color="#800000">32</font><font color="#000080">;
  </font>mshow<font color="#000080">;
  </font>level<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>done<font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>mhide<font color="#000080">;
    </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>bar<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font><font color="#800000">477</font><font color="#000080">);
    </font>setcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
    </font>outtextxy<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>name<font color="#000080">);
    </font>expand<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">,</font>levelmap<font color="#000080">);
    </font>expand<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">,</font>objectmap<font color="#000080">);
    </font>display_map<font color="#000080">;
    </font>mshow<font color="#000080">;
    </font>oldx<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>oldy<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>key<font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      repeat
        </b></font>mpos<font color="#000080">(</font>mouseloc<font color="#000080">);
        </font>x<font color="#000080">:= </font>mouseloc<font color="#000080">.</font>column<font color="#000080">;
        </font>y<font color="#000080">:= </font>mouseloc<font color="#000080">.</font>row<font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>oldx<font color="#000080">&lt;&gt;</font>x<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>oldy<font color="#000080">&lt;&gt;</font>y<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>keypressed <font color="#FF0000"><b>or
</b></font><font color="#000080">(</font>mouseloc<font color="#000080">.</font>buttonstatus<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);      </font>oldx<font color="#000080">:= </font>x<font color="#000080">;
      </font>oldy<font color="#000080">:= </font>y<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mouseloc<font color="#000080">.</font>buttonstatus<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          if </b></font>inside<font color="#000080">(</font>MAP_X<font color="#000080">,</font>MAP_Y<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>mhide<font color="#000080">;
              </font><font color="#FF0000"><b>repeat
                </b></font>i<font color="#000080">:= (</font>x <font color="#000080">- </font>MAP_X<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">;
                </font>j<font color="#000080">:= (</font>y <font color="#000080">- </font>MAP_Y<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">;
                </font><font color="#FF0000"><b>if </b></font>currenttype<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                  </b></font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:= </font>currentval
                <font color="#FF0000"><b>else
                  </b></font>objectmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:= </font>currentval<font color="#000080">;
                </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
                </font>dobar<font color="#000080">(</font>i<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">,</font>i<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">6</font><font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>show_floor <font color="#FF0000"><b>then
                  </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>mapgraph<font color="#000080">[</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]])
                </font><font color="#FF0000"><b>else
                  if not </b></font><font color="#000080">(</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">$6a</font><font color="#000080">..</font><font color="#800000">$8f</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                    </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>mapgraph<font color="#000080">[</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]]);
                </font><font color="#FF0000"><b>if </b></font>show_objects <font color="#FF0000"><b>then
                  </b></font>output<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">,</font>objgraph<font color="#000080">[</font>objectmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]]);
                </font>mpos<font color="#000080">(</font>mouseloc<font color="#000080">);
                </font>x<font color="#000080">:= </font>mouseloc<font color="#000080">.</font>column<font color="#000080">;
                </font>y<font color="#000080">:= </font>mouseloc<font color="#000080">.</font>row<font color="#000080">;
              </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>inside<font color="#000080">(</font>MAP_X<font color="#000080">,</font>MAP_Y<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">)) </font><font color="#FF0000"><b>or
                    </b></font><font color="#000080">(</font>mouseloc<font color="#000080">.</font>buttonstatus<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
              </font>mshow<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font><font color="#800000">464</font><font color="#000080">,</font><font color="#800000">355</font><font color="#000080">,</font><font color="#800000">506</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>wait_for_mouserelease<font color="#000080">;
              </font>legendpos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>legendtype<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font><font color="#800000">509</font><font color="#000080">,</font><font color="#800000">355</font><font color="#000080">,</font><font color="#800000">546</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>wait_for_mouserelease<font color="#000080">;
              </font>legendpos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>legendtype<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font><font color="#800000">549</font><font color="#000080">,</font><font color="#800000">355</font><font color="#000080">,</font><font color="#800000">576</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>wait_for_mouserelease<font color="#000080">;
              </font>dec<font color="#000080">(</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>legendpos<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>legendpos<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font><font color="#800000">579</font><font color="#000080">,</font><font color="#800000">355</font><font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">378</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>wait_for_mouserelease<font color="#000080">;
              </font>inc<font color="#000080">(</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>legendpos<font color="#000080">+</font><font color="#800000">25</font><font color="#000080">)&gt;</font><font color="#800000">255 </font><font color="#FF0000"><b>then </b></font>legendpos<font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">-</font><font color="#800000">25</font><font color="#000080">;
              </font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font><font color="#800000">464</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">350</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>mhide<font color="#000080">;
          </font>j<font color="#000080">:= (</font>y<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">14</font><font color="#000080">;
          </font>setcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
          </font>rectangle<font color="#000080">(</font><font color="#800000">465</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">14</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">636</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">14</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">12</font><font color="#000080">);
          </font><font color="#FF0000"><b>repeat
            </b></font>mpos<font color="#000080">(</font>mouseloc<font color="#000080">);
            </font>newj<font color="#000080">:= (</font>mouseloc<font color="#000080">.</font>row<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">14</font><font color="#000080">;
            </font><font color="#FF0000"><b>if </b></font>mouseloc<font color="#000080">.</font>buttonstatus<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
              begin
                </b></font>currenttype<font color="#000080">:= </font>legendtype<font color="#000080">;
                </font>currentval<font color="#000080">:= </font>legendpos<font color="#000080">+</font>j<font color="#000080">;
                </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
                </font>bar<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">,</font><font color="#800000">60</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">,</font><font color="#800000">637</font><font color="#000080">,</font><font color="#800000">61</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>currenttype<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                  begin
                    </b></font>output<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font>mapgraph<font color="#000080">[</font>currentval<font color="#000080">]);
                    </font>outtext<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">' - '</font><font color="#000080">+</font>mapnames<font color="#000080">[</font>currentval<font color="#000080">]);
                  </font><font color="#FF0000"><b>end
                else
                  begin
                    </b></font>output<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font>objgraph<font color="#000080">[</font>currentval<font color="#000080">]);
                    </font>outtext<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">' - '</font><font color="#000080">+</font>objnames<font color="#000080">[</font>currentval<font color="#000080">]);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>newj<font color="#000080">&lt;&gt;</font>j<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>mouseloc<font color="#000080">.</font>column<font color="#000080">&lt;</font><font color="#800000">464</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>keypressed<font color="#000080">;
          </font>setcolor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
          </font>rectangle<font color="#000080">(</font><font color="#800000">465</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">14</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">636</font><font color="#000080">,</font>j<font color="#000080">*</font><font color="#800000">14</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">12</font><font color="#000080">);
          </font>mshow<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>inside<font color="#000080">(</font>MAP_X<font color="#000080">,</font>MAP_Y<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>i<font color="#000080">:= (</font>x <font color="#000080">- </font>MAP_X<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">;
          </font>j<font color="#000080">:= (</font>y <font color="#000080">- </font>MAP_Y<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>oldj<font color="#000080">&lt;&gt;</font>j<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>oldi<font color="#000080">&lt;&gt;</font>i<font color="#000080">) </font><font color="#FF0000"><b>then
            begin
              </b></font>outstr<font color="#000080">:= </font><font color="#800000">'('</font><font color="#000080">;
              </font>str<font color="#000080">(</font>i<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>tempstr<font color="#000080">);
              </font>outstr<font color="#000080">:= </font>outstr<font color="#000080">+</font>tempstr<font color="#000080">+</font><font color="#800000">','</font><font color="#000080">;
              </font>str<font color="#000080">(</font>j<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>tempstr<font color="#000080">);
              </font>outstr<font color="#000080">:= </font>outstr<font color="#000080">+</font>tempstr<font color="#000080">+</font><font color="#800000">')    map: '</font><font color="#000080">+</font>hex<font color="#000080">(</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]);
              </font>outstr<font color="#000080">:= </font>outstr<font color="#000080">+</font><font color="#800000">' - '</font><font color="#000080">+</font>mapnames<font color="#000080">[</font>levelmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]];
              </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
              </font>setcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
              </font>bar<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">*</font><font color="#800000">7</font><font color="#000080">+</font>MAP_X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">479</font><font color="#000080">);
              </font>outtextxy<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font>outstr<font color="#000080">);
              </font>outstr<font color="#000080">:= </font><font color="#800000">'        object: '</font><font color="#000080">+</font>hex<font color="#000080">(</font>objectmap<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">])+</font><font color="#800000">' -
'+objnames[objectmap[i,j]];              outtextxy(100,TEXTLOC+10,outstr);
              </font>oldj<font color="#000080">:= </font>j<font color="#000080">;
              </font>oldi<font color="#000080">:= </font>i<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>mhide<font color="#000080">;
          </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
          </font>bar<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font><font color="#800000">360</font><font color="#000080">,</font><font color="#800000">479</font><font color="#000080">);
          </font>mshow<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then
        begin
          </b></font>control<font color="#000080">:= </font>false<font color="#000080">;
          </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
            begin
              </b></font>control<font color="#000080">:= </font>true<font color="#000080">;
              </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>control <font color="#FF0000"><b>then
            case </b></font>key <font color="#FF0000"><b>of
              </b></font><font color="#800000">'H'</font><font color="#000080">:
                </font><font color="#FF0000"><b>begin
                  </b></font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>size<font color="#000080">);
                  </font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>size<font color="#000080">);
                  </font>compress<font color="#000080">(</font>levelmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">);
                  </font>compress<font color="#000080">(</font>objectmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">);
                  </font>inc<font color="#000080">(</font>level<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">'P'</font><font color="#000080">:
                </font><font color="#FF0000"><b>begin
                  </b></font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>size<font color="#000080">);
                  </font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>size<font color="#000080">);
                  </font>compress<font color="#000080">(</font>levelmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">);
                  </font>compress<font color="#000080">(</font>objectmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">);
                  </font>dec<font color="#000080">(</font>level<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end
          else
            case </b></font>key <font color="#FF0000"><b>of
              </b></font><font color="#800000">'q'</font><font color="#000080">,</font><font color="#800000">'Q'</font><font color="#000080">:
                   </font><font color="#FF0000"><b>begin
                     </b></font>done<font color="#000080">:= </font>true<font color="#000080">;
                     </font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">.</font>size<font color="#000080">);

</font>freemem<font color="#000080">(</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>data<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">.</font>size<font color="#000080">);
</font>compress<font color="#000080">(</font>levelmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>map<font color="#000080">);
</font>compress<font color="#000080">(</font>objectmap<font color="#000080">,</font>maps<font color="#000080">[</font>level<font color="#000080">].</font>objects<font color="#000080">);                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">'c'</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">: </font>clear_level<font color="#000080">(</font>level<font color="#000080">);
              </font><font color="#800000">'o'</font><font color="#000080">,</font><font color="#800000">'O'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
                         </b></font>mhide<font color="#000080">;
                         </font>show_objects<font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>show_objects<font color="#000080">;
                         </font>display_map<font color="#000080">;
                         </font>mshow<font color="#000080">;
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#800000">'f'</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
                         </b></font>mhide<font color="#000080">;
                         </font>show_floor<font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>show_floor<font color="#000080">;
                         </font>display_map<font color="#000080">;
                         </font><font color="#FF0000"><b>if </b></font>legendtype<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                           </b></font>showlegend<font color="#000080">(</font>legendtype<font color="#000080">,</font>legendpos<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
                         </font>mshow<font color="#000080">;
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>done <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>key <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'P'</font><font color="#000080">,</font><font color="#800000">'H'</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>level<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>level<font color="#000080">:=</font>LEVELS<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>level<font color="#000080">=(</font>LEVELS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>level<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;

  </font>setfillstyle<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>bar<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font><font color="#800000">639</font><font color="#000080">,</font><font color="#800000">479</font><font color="#000080">);
  </font>setcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
  </font>outtextxy<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>TEXTLOC<font color="#000080">,</font><font color="#800000">' Save the current levels to disk? (Y/N) '</font><font color="#000080">);

  </font><font color="#FF0000"><b>repeat
    repeat until </b></font>keypressed<font color="#000080">;
    </font>key<font color="#000080">:= </font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
      begin
        </b></font>key<font color="#000080">:= </font>readkey<font color="#000080">;
        </font>key<font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>key <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'y'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'n'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">];

  </font><font color="#FF0000"><b>if </b></font>key <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'y'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>write_levels<font color="#000080">;
  </font>textmode<font color="#000080">(</font>co80<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'MapEdit 4.1                 Copyright (c) 1992  Bill Kirby'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'This program is intended to be for your personal use only.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Distribution of any modified maps may be construed as a '</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'copyright violation by Apogee/ID.'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0166.PAS">Original</a><b>]</b></p></body>
</html>
