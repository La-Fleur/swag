<html>
<head><title> "Accessing DBASE3 Files" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0086.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>dbaseiii<font color="#000080">;
</font><font color="#008000"><i>{ unit including procedures for accessing DBaseIII files}

</i></font><font color="#FF0000"><b>interface

uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>OpenDBFData<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>OpenDBFMemo<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ReadDBFRecord<font color="#000080">(</font>I <font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteDBFRecord<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ReadDBFMemo<font color="#000080">(</font>BlockNumber <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteDBFMemo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>BlockNumberString <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>CloseDBFData<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CloseDBFMemo<font color="#000080">;

</font><font color="#FF0000"><b>const
        </b></font>DBFMaxRecordLength <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">;
        </font>DBFMemoBlockLength <font color="#000080">=  </font><font color="#800000">512</font><font color="#000080">;
        </font>DBFMaxMemoLength   <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">;

</font><font color="#FF0000"><b>type
        </b></font>DBFHeaderRec <font color="#000080">= </font><font color="#FF0000"><b>Record
                </b></font>HeadType                <font color="#000080">: </font>byte<font color="#000080">;
                </font>Year                        <font color="#000080">: </font>byte<font color="#000080">;
                </font>Month                        <font color="#000080">: </font>byte<font color="#000080">;
                </font>Day                                <font color="#000080">: </font>byte<font color="#000080">;
                </font>RecordCount                <font color="#000080">: </font>longint<font color="#000080">;
                </font>HeaderLength        <font color="#000080">: </font>integer<font color="#000080">;
                </font>RecordSize          <font color="#000080">: </font>integer<font color="#000080">;
                </font>Garbage                         <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>type
        </b></font>DBFFieldRec <font color="#000080">= </font><font color="#FF0000"><b>Record
                </b></font>FieldName                <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                </font>FieldType                <font color="#000080">: </font>char<font color="#000080">;
                </font>Spare1<font color="#000080">,
                </font>Spare2                        <font color="#000080">: </font>integer<font color="#000080">;
                </font>Width                        <font color="#000080">: </font>byte<font color="#000080">;
                </font>Dec                                <font color="#000080">: </font>byte<font color="#000080">;
                </font>WorkSpace                <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">14</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>DBFFileName                         <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

        </font>DBFDataFile                                <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
        </font>DBFDataFileAvailable        <font color="#000080">: </font>boolean<font color="#000080">;
        </font>DBFBuffer                                <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>DBFMaxRecordLength<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

        </font>DBFHeading                                <font color="#000080">: </font>DBFHeaderRec<font color="#000080">;

        </font>DBFField                                <font color="#000080">: </font>DBFFieldRec<font color="#000080">;
        </font>DBFFieldCount                        <font color="#000080">: </font>integer<font color="#000080">;
        </font>DBFFieldContent                        <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">;

        </font>DBFNames                                <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
        </font>DBFLengths                                <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font>DBFTypes                                <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
        </font>DBFDecimals                                <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font>DBFContentStart                        <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;

        </font>DBFMemoFile                                <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
        </font>DBFMemoFileAvailable        <font color="#000080">: </font>boolean<font color="#000080">;
        </font>DBFMemoBuffer                        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>DBFMemoBlockLength<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font>DBFMemo                                        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>DBFMaxMemoLength<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

        </font>DBFMemoLength                        <font color="#000080">: </font>integer<font color="#000080">;
        </font>DBFMemoEnd                                <font color="#000080">: </font>boolean<font color="#000080">;
        </font>DBFMemoBlock                        <font color="#000080">: </font>integer<font color="#000080">;

        </font>DBFDeleteField                        <font color="#000080">: </font>char<font color="#000080">;
        </font>DBFFieldStart                        <font color="#000080">: </font>integer<font color="#000080">;

        </font>DBFRecordNumber                        <font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#008000"><i>(****************************************************************)

</i></font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>(****************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadDBFHeader<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>RecordsRead <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>BlockRead <font color="#000080">(</font>DBFDataFile<font color="#000080">, </font>DBFHeading<font color="#000080">, </font>SizeOf<font color="#000080">(</font>DBFHeading<font color="#000080">), </font>RecordsRead<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*****************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>ProcessField <font color="#000080">(</font>F <font color="#000080">: </font>DBFFieldRec<font color="#000080">;
                                                </font>I <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var
        </b></font>J <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        with </b></font>F <font color="#FF0000"><b>do
        begin
                </b></font>DBFNames <font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
                </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>J<font color="#000080">&lt;</font><font color="#800000">11</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FieldName<font color="#000080">[</font>J<font color="#000080">] &lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>do
                        begin
                                </b></font>DBFNames<font color="#000080">[</font>I<font color="#000080">] := </font>DBFNames<font color="#000080">[</font>I<font color="#000080">] + </font>FieldName <font color="#000080">[</font>J<font color="#000080">];
                                </font>J <font color="#000080">:= </font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font>DBFLengths <font color="#000080">[</font>I<font color="#000080">]                 := </font>Width<font color="#000080">;
                </font>DBFTypes <font color="#000080">[</font>I<font color="#000080">]                 := </font>FieldType<font color="#000080">;
                </font>DBFDecimals <font color="#000080">[</font>I<font color="#000080">]         := </font>Dec<font color="#000080">;
                </font>DBFContentStart <font color="#000080">[</font>I<font color="#000080">] := </font>DBFFieldStart<font color="#000080">;
                </font>DBFFieldStart                 <font color="#000080">:= </font>DBFFieldStart <font color="#000080">+ </font>Width<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(***************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadFields<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>I                         <font color="#000080">: </font>integer<font color="#000080">;
        </font>RecordsRead <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>Seek<font color="#000080">(</font>DBFDataFile<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">);
        </font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>DBFFieldStart <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
        </font>DBFField<font color="#000080">.</font>FieldName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
        </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>DBFField<font color="#000080">.</font>FieldName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>do
                begin
                        </b></font>BlockRead<font color="#000080">(</font>DBFDataFile<font color="#000080">,</font>DBFField<font color="#000080">.</font>FieldName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);
                        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>DBFField<font color="#000080">.</font>FieldName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                begin
                                        </b></font>BlockRead<font color="#000080">(</font>DBFDataFile<font color="#000080">, </font>DBFField<font color="#000080">.</font>FieldName<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>SizeOf<font color="#000080">(</font>DBFField<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">, </font>RecordsRead<font color="#000080">);
                                        </font>ProcessField <font color="#000080">(</font>DBFField<font color="#000080">, </font>I<font color="#000080">);
                                        </font>I <font color="#000080">:= </font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>DBFFieldCount <font color="#000080">:= </font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(***********************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>OpenDBFData<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>DBFDataFileAvailable <font color="#000080">:= </font>false<font color="#000080">;
        </font>Assign<font color="#000080">(</font>DBFDataFile<font color="#000080">, </font>DBFFileName<font color="#000080">+</font><font color="#800000">'.DBF'</font><font color="#000080">);

</font><font color="#008000"><i>{$I-}
        </i></font>Reset<font color="#000080">(</font>DBFDataFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font><font color="#008000"><i>{$I+}

        </i></font>DBFDataFileAvailable <font color="#000080">:= </font>true<font color="#000080">;
        </font>Seek<font color="#000080">(</font>DBFDataFile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
        </font>ReadDBFHeader<font color="#000080">;
        </font>ReadFields<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(******************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>CloseDBFData<font color="#000080">;

</font><font color="#FF0000"><b>begin
        if </b></font>DBFDataFileAvailable <font color="#FF0000"><b>then </b></font>Close<font color="#000080">(</font>DBFDataFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*******************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>OpenDBFMemo<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>DBFMemoFileAvailable <font color="#000080">:= </font>false<font color="#000080">;
        </font>Assign<font color="#000080">(</font>DBFMemoFile<font color="#000080">, </font>DBFFileName<font color="#000080">+</font><font color="#800000">'.DBT'</font><font color="#000080">);

</font><font color="#008000"><i>{$I-}
        </i></font>Reset<font color="#000080">(</font>DBFMemoFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font><font color="#008000"><i>{$I+}

        </i></font>DBFMemoFileAvailable <font color="#000080">:= </font>true<font color="#000080">;
        </font>Seek<font color="#000080">(</font>DBFMemoFile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*******************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>CloseDBFMemo<font color="#000080">;

</font><font color="#FF0000"><b>begin
        If </b></font>DBFMemoFileAvailable <font color="#FF0000"><b>then </b></font>close<font color="#000080">(</font>DBFMemoFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*******************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>GetDBFFields<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>I                         <font color="#000080">: </font>byte<font color="#000080">;
        </font>J                         <font color="#000080">: </font>integer<font color="#000080">;
        </font>Response         <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>DBFDeleteField <font color="#000080">:= </font>DBFBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
        </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DBFFieldCount <font color="#FF0000"><b>do
                begin
                        </b></font>DBFFieldContent<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
                        </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>DBFContentStart<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>to </b></font>DBFContentStart <font color="#000080">[</font>I<font color="#000080">] + </font>DBFLengths<font color="#000080">[</font>I<font color="#000080">] -</font><font color="#800000">1 </font><font color="#FF0000"><b>do
                                </b></font>DBFFieldContent<font color="#000080">[</font>I<font color="#000080">] := </font>DBFFieldContent<font color="#000080">[</font>I<font color="#000080">] + </font>DBFBuffer<font color="#000080">[</font>J<font color="#000080">];
                        </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DBFLengths<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
                                if </b></font>DBFFieldContent<font color="#000080">[</font>J<font color="#000080">]=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>DBFFieldContent<font color="#000080">[</font>J<font color="#000080">]:=</font><font color="#800000">#32</font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(***********************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadDBFRecord <font color="#000080">(</font>I <font color="#000080">: </font>Longint<font color="#000080">);

</font><font color="#FF0000"><b>var
        </b></font>RecordsRead <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>Seek<font color="#000080">(</font>DBFDataFile<font color="#000080">, </font>DBFHeading<font color="#000080">.</font>HeaderLength <font color="#000080">+ </font>DBFHeading<font color="#000080">.</font>RecordSize <font color="#000080">* (</font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">));
        </font>BlockRead <font color="#000080">(</font>DBFDataFile<font color="#000080">, </font>DBFBuffer<font color="#000080">, </font>DBFHeading<font color="#000080">.</font>RecordSize<font color="#000080">, </font>RecordsRead<font color="#000080">);
        </font>GetDBFFields<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(**********************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadDBFMemo<font color="#000080">(</font>BlockNumber <font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var
        </b></font>I                         <font color="#000080">: </font>integer<font color="#000080">;
        </font>RecordsRead        <font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>DBFMemoLength <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>DBFMemoEnd <font color="#000080">:= </font>false<font color="#000080">;
        </font><font color="#FF0000"><b>If not </b></font>DBFMemoFileAvailable <font color="#FF0000"><b>then
                begin
                        </b></font>DBFMemoEnd <font color="#000080">:= </font>true<font color="#000080">;
                        </font>exit<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>FillChar<font color="#000080">(</font>DBFMemo<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>DBFMaxMemoLength<font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);
        </font>Seek<font color="#000080">(</font>DBFMemoFile<font color="#000080">,</font>BlockNumber<font color="#000080">*</font>DBFMemoBlockLength<font color="#000080">);
        </font><font color="#FF0000"><b>repeat
                </b></font>BlockRead<font color="#000080">(</font>DBFMemoFile<font color="#000080">,</font>DBFMemoBuffer<font color="#000080">,</font>DBFMemoBlockLength<font color="#000080">,</font>RecordsRead<font color="#000080">);
                </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>RecordsRead  <font color="#FF0000"><b>do
                        begin
                                </b></font>DBFMemoLength <font color="#000080">:= </font>DBFMemoLength <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                </font>DBFMemo<font color="#000080">[</font>DBFMemoLength<font color="#000080">] := </font>chr<font color="#000080">(</font>DBFMemoBuffer<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7F</font><font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DBFMemoBuffer<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">$1A</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DBFMemoBuffer<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">$00</font><font color="#000080">) </font><font color="#FF0000"><b>then
                                        begin
                                                </b></font>DBFMemoEnd <font color="#000080">:= </font>true<font color="#000080">;
                                                </font>DBFMemoLength <font color="#000080">:= </font>DBFMemoLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                                                </font>exit<font color="#000080">;
                                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>until </b></font>DBFMemoEnd<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*********************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>WriteDBFMemo  <font color="#008000"><i>{(var BlockNumberString : string)}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>K <font color="#000080">: </font>integer<font color="#000080">;
        </font>ReturnCode <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        </b></font>Val<font color="#000080">(</font>BlockNumberString<font color="#000080">,</font>DBFMemoBlock<font color="#000080">,</font>ReturnCode<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>ReturnCode<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>DBFMemoBlock <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>DBFMemoBlock<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                begin
                        </b></font>Writeln<font color="#000080">;
                        </font>ReadDBFMemo<font color="#000080">(</font>DBFMemoBlock<font color="#000080">);
                        </font><font color="#FF0000"><b>If </b></font>DBFMemoLength<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
                        </font><font color="#FF0000"><b>For </b></font>K <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DBFMemoLength <font color="#FF0000"><b>do
                                </b></font>Write<font color="#000080">(</font>DBFMemo<font color="#000080">[</font>K<font color="#000080">]);
                        </font>WriteLn<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(****************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>WriteDBFRecord<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>J <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
        For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DBFFieldCount <font color="#FF0000"><b>do
                begin
                        </b></font>Write<font color="#000080">(</font>DBFNames<font color="#000080">[</font>J<font color="#000080">]);
                        </font>GoToXY<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">,</font>J<font color="#000080">);
                        </font>WriteLn<font color="#000080">(</font>DBFFieldContent<font color="#000080">[</font>J<font color="#000080">]);
                        </font><font color="#FF0000"><b>if </b></font>DBFTypes<font color="#000080">[</font>J<font color="#000080">]=</font><font color="#800000">'M' </font><font color="#FF0000"><b>then </b></font>WriteDBFMemo<font color="#000080">(</font>DBFFieldContent<font color="#000080">[</font>J<font color="#000080">]);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*******************************************************************)

</i></font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0086.PAS">Original</a><b>]</b></p></body>
</html>
