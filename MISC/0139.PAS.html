<html>
<head><title> "Reformat Your Pascal Code!" by CAMERON CLARK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0139.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The following 3 messages will include two units [files,freebuff] and one
driver program [CTP]. The purpose of CTP is to reformate you source code's
case use, Exampe:   change 'writeln' to 'WriteLn'. It includes all reserved
words.

FREEBUFF is where most of the speed increase comes from. It is a free
read buffer styled much like blockRead and BlockWrite. It does the job of a
disk cache by NOT writing until the write buffer is full, and NOT reading
until the read buffer is empty. It can be used for any program in place of
blockread&amp;write where small pieces of information need to be extracted.
    remeber memory is fast, drives are slow.

    CTP still needs some optimizing [and inclusion of the (* *) comments
Words in quotes '' or Comments {  WILL be skipped. If you can speed it up,
re-post the optimized version.
}

</i></font><font color="#FF0000"><b>UNIT </b></font>FILES<font color="#000080">;
</font><font color="#FF0000"><b>INTERFACE
USES </b></font>DOS<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>OpenFile<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>FileExistsWild<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

FUNCTION </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$I-}
  </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>F<font color="#000080">);
  </font>Close<font color="#000080">(</font>F<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font>FileExists<font color="#000080">:=(</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">)
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>OpenFile<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font>fileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   IF </b></font>fileExists<font color="#000080">(</font>FileName<font color="#000080">) </font><font color="#FF0000"><b>then BEGIN
      </b></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>filename<font color="#000080">);
      </font>Reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>Openfile<font color="#000080">:=</font>True<font color="#000080">;
   </font><font color="#FF0000"><b>END
   ELSE </b></font>OpenFile<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>FUNCTION </b></font>FileExistsWild<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR   </b></font>Fil<font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FindFirst<font color="#000080">(</font>FileName<font color="#000080">,</font>anyFile<font color="#000080">,</font>Fil<font color="#000080">);
  </font>FileExistsWild<font color="#000080">:=(</font>DosError<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }
 
</i></font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{UNIT FREEBUFF}
{12/7/94}
{v4.0 ... Changing into a unit }
</i></font><font color="#FF0000"><b>Unit </b></font>FreeBuff<font color="#000080">;
</font><font color="#FF0000"><b>INTERFACE
VAR </b></font>TrueFileEnd <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Read<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>userObject<font color="#000080">;
                  </font>ObjSize<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>bytesREAD<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Write<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>FW<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>userObject<font color="#000080">; </font>ObjSize<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Skip<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font>SkipSize<font color="#000080">: </font>Integer<font color="#000080">);
            </font><font color="#008000"><i>{user may skip any size}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitBuffers<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>FW <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FlushWRITEBuffer<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FW <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">);
</font><font color="#FF0000"><b>IMPLEMENTATION
CONST </b></font>rBufSize<font color="#000080">=</font><font color="#800000">8192</font><font color="#000080">;                        </font><font color="#008000"><i>{buffer size for B_read}
      </i></font>wBufSize<font color="#000080">=</font><font color="#800000">8192</font><font color="#000080">;                          </font><font color="#008000"><i>{buffer size for B_write}
</i></font><font color="#FF0000"><b>VAR </b></font>rBuffer<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>rBufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">; </font><font color="#008000"><i>{buffer for B_read}
    </i></font>rCurrent<font color="#000080">: </font>word<font color="#000080">;   </font><font color="#008000"><i>{8192 &lt; word max}   {current position in rBuffer}
    </i></font>rEnd<font color="#000080">: </font>Integer<font color="#000080">;                        </font><font color="#008000"><i>{Logical end of buffer}
    </i></font>FileEnd<font color="#000080">: </font>Boolean<font color="#000080">;                     </font><font color="#008000"><i>{Actual file end}
    </i></font>wBuffer<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>wBufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">; </font><font color="#008000"><i>{buffer for B_Write}
    </i></font>wCurrent<font color="#000080">: </font>word<font color="#000080">;                       </font><font color="#008000"><i>{current position in wBuffer}
</i></font><font color="#FF0000"><b>Function </b></font>WhatsLeft <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  If  </b></font>rEnd<font color="#000080">&gt; (</font>rCurrent <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>WhatsLeft<font color="#000080">:= </font>rEnd <font color="#000080">- (</font>rCurrent <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{last position - (Current-1)   }
  </i></font><font color="#FF0000"><b>END ELSE BEGIN
      </b></font>WhatsLeft<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>WhatsLeftinWRITE<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>WhatsLeftinWRITE<font color="#000080">:=</font>wBufSize <font color="#000080">- (</font>wCurrent <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE  </b></font>ReadBuffer<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>UserObject<font color="#000080">;
                      </font>ObjSize<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>BytesRead<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>BLockRead<font color="#000080">(</font>F<font color="#000080">,</font>UserObject<font color="#000080">,</font>ObjSize<font color="#000080">,</font>BytesRead<font color="#000080">);
   </font>rEnd<font color="#000080">:=(</font>rCurrent<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) + </font>BytesRead<font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>BytesRead <font color="#000080">&lt;&gt; </font>ObjSize<font color="#000080">) </font><font color="#FF0000"><b>Then BEGIN
      </b></font>FileEnd<font color="#000080">:=</font>True<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteBuffer<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FW<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>UserObject<font color="#000080">; </font>ObjSize<font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>wDummy<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>BlockWrite<font color="#000080">(</font>FW<font color="#000080">,</font>UserObject<font color="#000080">,</font>ObjSize<font color="#000080">,</font>wDummy<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>InitReadBuffer<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>Dummy<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>rCurrent<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>ReadBuffer<font color="#000080">(</font>F<font color="#000080">,</font>rBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>rBufSize<font color="#000080">,</font>Dummy<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>InitWRITEBuffer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>wCurrent<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE  </b></font>InitBuffers<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>FW <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>FileEnd<font color="#000080">:=</font>False<font color="#000080">;
   </font>TrueFileEnd<font color="#000080">:=</font>False<font color="#000080">;
   </font>InitReadBuffer<font color="#000080">(</font>F<font color="#000080">);
   </font>InitWriteBuffer<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>FlushWRITEBuffer<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FW <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
   </b></font>WriteBuffer<font color="#000080">(</font>FW<font color="#000080">, </font>wBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>wCurrent<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
   </font>initWriteBuffer<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Read<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>userObject<font color="#000080">;
                  </font>ObjSize<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>bytesREAD<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>LeftInBuf<font color="#000080">: </font>Word<font color="#000080">;  </font>Temp<font color="#000080">: </font>Word<font color="#000080">; </font>BytesMoved<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>LeftInBuf<font color="#000080">:= </font>WhatsLeft<font color="#000080">;
  </font><font color="#FF0000"><b>IF  </b></font>ObjSize <font color="#000080">&lt; </font>LeftInBuf <font color="#FF0000"><b>then BEGIN     </b></font><font color="#008000"><i>{Same case for if FileEnd}
      {CASE 1  MOST COMMON}
      </i></font>Move<font color="#000080">(</font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>UserObject<font color="#000080">, </font>ObjSize<font color="#000080">);
      </font>rCurrent<font color="#000080">:=</font>rCurrent<font color="#000080">+ </font>ObjSize<font color="#000080">;
      </font>BytesRead<font color="#000080">:=</font>ObjSize<font color="#000080">;
  </font><font color="#FF0000"><b>END ELSE IF  </b></font>ObjSize <font color="#000080">&gt; </font>LeftInBuf <font color="#FF0000"><b>then BEGIN
      </b></font><font color="#008000"><i>{CASE 2  SECOND MOST COMMON}
      </i></font><font color="#FF0000"><b>IF  </b></font>FileEnd <font color="#FF0000"><b>then BEGIN
          </b></font>LeftInBuf<font color="#000080">:=</font>WhatsLeft<font color="#000080">;
          </font>Move<font color="#000080">(</font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>UserObject<font color="#000080">, </font>LeftInBuf<font color="#000080">);
          </font>BytesRead<font color="#000080">:=</font>LeftInBuf<font color="#000080">;
          </font>TrueFileEnd<font color="#000080">:=</font>true<font color="#000080">;
      </font><font color="#FF0000"><b>END ELSE BEGIN
          </b></font>LeftInBuf<font color="#000080">:=</font>WhatsLeft<font color="#000080">;
          </font>BytesMoved<font color="#000080">:=</font>LeftInBuf<font color="#000080">;
          </font>Move<font color="#000080">(</font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>rBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>LeftInBuf<font color="#000080">);
          </font>rCurrent<font color="#000080">:=</font>LeftInBuf<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font>rEnd<font color="#000080">:= </font>rBufSize<font color="#000080">;
          </font>LeftInBuf<font color="#000080">:=</font>WhatsLeft<font color="#000080">;
          </font>ReadBuffer<font color="#000080">(</font>F<font color="#000080">, </font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>LeftInBuf<font color="#000080">, </font>BytesRead<font color="#000080">);
          </font><font color="#FF0000"><b>IF  </b></font>FIleEnd <font color="#FF0000"><b>Then BEGIN
              </b></font>BytesRead<font color="#000080">:=</font>BytesRead<font color="#000080">+</font>BytesMoved<font color="#000080">;
              </font><font color="#FF0000"><b>IF  </b></font>BytesRead <font color="#000080">&lt; </font>ObjSize <font color="#FF0000"><b>THEN BEGIN
                  </b></font>move<font color="#000080">(</font>rBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>UserObject<font color="#000080">, </font>BytesRead<font color="#000080">);
                  </font>TrueFileEnd<font color="#000080">:=</font>True<font color="#000080">;
              </font><font color="#FF0000"><b>END ELSE BEGIN
                  </b></font>move<font color="#000080">(</font>rBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>UserObject<font color="#000080">, </font>ObjSize<font color="#000080">);
                  </font>rCurrent<font color="#000080">:=</font>ObjSize<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                  </font>BytesRead<font color="#000080">:=</font>ObjSize<font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END ELSE BEGIN
              </b></font>move<font color="#000080">(</font>rBuffer<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>UserObject<font color="#000080">, </font>ObjSize<font color="#000080">);
              </font>BytesRead<font color="#000080">:=</font>ObjSize<font color="#000080">;
              </font>rCurrent<font color="#000080">:=</font>ObjSize<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END ELSE IF  </b></font>ObjSize <font color="#000080">= </font>LeftInBuf <font color="#FF0000"><b>then BEGIN
      </b></font><font color="#008000"><i>{CASE 3 MOST UNCOMMON}
      </i></font><font color="#FF0000"><b>IF  </b></font>FileEnd <font color="#FF0000"><b>then BEGIN
          </b></font>move<font color="#000080">(</font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>UserObject<font color="#000080">, </font>objSize<font color="#000080">);
          </font>BytesRead<font color="#000080">:=</font>ObjSize<font color="#000080">;
          </font>TrueFileEnd<font color="#000080">:=</font>True<font color="#000080">;
      </font><font color="#FF0000"><b>END ELSE BEGIN
          </b></font>move<font color="#000080">(</font>rBuffer<font color="#000080">[</font>rCurrent<font color="#000080">], </font>UserObject<font color="#000080">, </font>objSize<font color="#000080">);
          </font>InitReadBuffer<font color="#000080">(</font>f<font color="#000080">);
          </font>BytesREad<font color="#000080">:=</font>ObjSize<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Skip<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">; </font>SkipSize<font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#008000"><i>{user may skip any size}
</i></font><font color="#FF0000"><b>var </b></font>LeftInBuffer <font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>LeftInBuffer<font color="#000080">:= </font>WhatsLeft<font color="#000080">;
   </font><font color="#FF0000"><b>IF  </b></font>LeftInBuffer <font color="#000080">&gt; </font>SkipSize <font color="#FF0000"><b>THEN BEGIN
       </b></font>Seek<font color="#000080">(</font>F<font color="#000080">, </font>FilePos<font color="#000080">(</font>F<font color="#000080">) + ( </font>SkipSize <font color="#000080">- </font>LeftINBuffer<font color="#000080">));
       </font>InitREADBuffer<font color="#000080">(</font>F<font color="#000080">);
   </font><font color="#FF0000"><b>END ELSE BEGIN
       IF  </b></font>LeftINBuffer <font color="#000080">= </font>SkipSize <font color="#FF0000"><b>THEN BEGIN
           </b></font>InitREADBuffer<font color="#000080">(</font>F<font color="#000080">);
       </font><font color="#FF0000"><b>END ELSE BEGIN
           </b></font>rCurrent<font color="#000080">:=</font>rCurrent <font color="#000080">+ </font>SkipSize<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>B_Write<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>FW<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>userObject<font color="#000080">; </font>ObjSize<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>LeftINBuffer<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>LeftInBuffer<font color="#000080">:=</font>WhatsLeftinWRITE<font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>ObjSize <font color="#000080">&lt; </font>LeftInBuffer <font color="#FF0000"><b>THEN BEGIN
        </b></font>move<font color="#000080">(</font>UserObject<font color="#000080">, </font>wBuffer<font color="#000080">[</font>wCurrent<font color="#000080">], </font>ObjSize<font color="#000080">);
        </font>wCurrent<font color="#000080">:=</font>wCurrent<font color="#000080">+ </font>ObjSize<font color="#000080">;
     </font><font color="#FF0000"><b>END ELSE BEGIN
         IF  </b></font>ObjSize<font color="#000080">=</font>LeftInbuffer <font color="#FF0000"><b>THEN BEGIN
             </b></font>move<font color="#000080">(</font>UserObject<font color="#000080">, </font>wBuffer<font color="#000080">[</font>wCurrent<font color="#000080">], </font>ObjSize<font color="#000080">);
             </font>wCurrent <font color="#000080">:= </font>wCurrent <font color="#000080">+ </font>ObjSize<font color="#000080">;
             </font>FlushWriteBuffer<font color="#000080">(</font>FW<font color="#000080">);
         </font><font color="#FF0000"><b>END ELSE BEGIN
             </b></font>FlushWriteBuffer<font color="#000080">(</font>FW<font color="#000080">);
             </font>move<font color="#000080">(</font>UserObject<font color="#000080">, </font>wBuffer<font color="#000080">[</font>wCurrent<font color="#000080">], </font>ObjSize<font color="#000080">);
             </font>wCurrent<font color="#000080">:=</font>wCurrent<font color="#000080">+ </font>ObjSize<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{PROGRAM C-TP-format} {SLOWWWWWWWW}
{$A+,B-,D+,E-,F-,G-,I-,K-,L-,N-,P-,R+,S-,T-,V-,W-,X+,Y-}
{12/07/94 FIXED FreeBuff : and used it as a unit!!!!!!!!!!!!!!!}
{         Passes Dos's comp test for a 200k file }

</i></font><font color="#FF0000"><b>Uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">,</font>FREEbuff<font color="#000080">,</font>FILES<font color="#000080">;
</font><font color="#FF0000"><b>CONST </b></font>BufSize<font color="#000080">=</font><font color="#800000">8192</font><font color="#000080">;
      </font>ResSize<font color="#000080">=</font><font color="#800000">53</font><font color="#000080">;</font><font color="#008000"><i>{Words to Reformat}
      {Edit these to fit personal capital &amp; lowerCase mixture preferences}
</i></font><font color="#FF0000"><b>TYPE  </b></font>rWords <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>ResSize<font color="#000080">]  </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Crt,Graph,Graph3,Overlay,Printer,Strings,System,Turbo3,WinAPI,WinCrt
WinDOS,WinPrn,WinProcs,WinTypes ...}
{BOOCOOS of typing!!}
</i></font><font color="#FF0000"><b>CONST  </b></font>Reserved      <font color="#000080">: </font>rWords <font color="#000080">=(
</font><font color="#800000">'ABSOLUTE'</font><font color="#000080">,</font><font color="#800000">'AND'</font><font color="#000080">,</font><font color="#800000">'ASM'</font><font color="#000080">,</font><font color="#800000">'ARRAY'</font><font color="#000080">,</font><font color="#800000">'BEGIN'</font><font color="#000080">,</font><font color="#800000">'CASE'</font><font color="#000080">,</font><font color="#800000">'CONST'</font><font color="#000080">,</font><font color="#800000">'CONSTRUTOR'</font><font color="#000080">,
</font><font color="#800000">'DESTRUCTOR'</font><font color="#000080">,</font><font color="#800000">'DIV'</font><font color="#000080">,</font><font color="#800000">'DO'</font><font color="#000080">,</font><font color="#800000">'DOWNTO'</font><font color="#000080">,</font><font color="#800000">'ELSE'</font><font color="#000080">,</font><font color="#800000">'END'</font><font color="#000080">,</font><font color="#800000">'EXPORTS'</font><font color="#000080">,</font><font color="#800000">'FILE'</font><font color="#000080">,</font><font color="#800000">'FOR'</font><font color="#000080">,
</font><font color="#800000">'FUNCTION'</font><font color="#000080">,</font><font color="#800000">'GOTO'</font><font color="#000080">,</font><font color="#800000">'IF'</font><font color="#000080">,</font><font color="#800000">'IMPLEMENTATION'</font><font color="#000080">,</font><font color="#800000">'IN'</font><font color="#000080">,</font><font color="#800000">'INHERITED'</font><font color="#000080">,</font><font color="#800000">'INLINE'</font><font color="#000080">,
</font><font color="#800000">'INTERFACE'</font><font color="#000080">,</font><font color="#800000">'LABEL'</font><font color="#000080">,</font><font color="#800000">'LIBRARY'</font><font color="#000080">,</font><font color="#800000">'MOD'</font><font color="#000080">,</font><font color="#800000">'NIL'</font><font color="#000080">,</font><font color="#800000">'NOT'</font><font color="#000080">,</font><font color="#800000">'OBJECT'</font><font color="#000080">,</font><font color="#800000">'OF'</font><font color="#000080">,</font><font color="#800000">'OR'</font><font color="#000080">,</font><font color="#800000">'PACKED'</font><font color="#000080">,
</font><font color="#800000">'PROCEDURE'</font><font color="#000080">,</font><font color="#800000">'PROGRAM'</font><font color="#000080">,</font><font color="#800000">'RECORD'</font><font color="#000080">,</font><font color="#800000">'REPEAT'</font><font color="#000080">,</font><font color="#800000">'SET'</font><font color="#000080">,</font><font color="#800000">'SHL'</font><font color="#000080">,</font><font color="#800000">'SHR'</font><font color="#000080">,</font><font color="#800000">'STRING'</font><font color="#000080">,</font><font color="#800000">'THEN'</font><font color="#000080">,
</font><font color="#800000">'TO'</font><font color="#000080">,</font><font color="#800000">'TYPE'</font><font color="#000080">,</font><font color="#800000">'UNIT'</font><font color="#000080">,</font><font color="#800000">'UNTIL'</font><font color="#000080">,</font><font color="#800000">'USES'</font><font color="#000080">,</font><font color="#800000">'VAR'</font><font color="#000080">,</font><font color="#800000">'WHILE'</font><font color="#000080">,</font><font color="#800000">'WriteLN'</font><font color="#000080">,</font><font color="#800000">'WITH'</font><font color="#000080">,</font><font color="#800000">'XOR'</font><font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>F<font color="#000080">,</font>OUTf        <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
    </font>tB            <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CHAR<font color="#000080">;
    </font><font color="#008000"><i>{I, J          : integer;}
    </i></font>Quote         <font color="#000080">: </font>Boolean<font color="#000080">;   </font><font color="#008000"><i>{temp boolean use to skip quoted material}
    </i></font>Path<font color="#000080">,</font>Name<font color="#000080">,</font>Ext <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;    </font><font color="#008000"><i>{used for opening input file}
    </i></font>Look          <font color="#000080">: </font>SearchRec<font color="#000080">; </font><font color="#008000"><i>{used for opening input file}
    </i></font>Dummy         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;    </font><font color="#008000"><i>{Built string to search for}
    </i></font>TB1           <font color="#000080">: </font>Char<font color="#000080">;      </font><font color="#008000"><i>{Temp B_READ byte}
    </i></font>tb2           <font color="#000080">: </font>integer<font color="#000080">;   </font><font color="#008000"><i>{Counter}
    </i></font>BytesRead     <font color="#000080">: </font>Word<font color="#000080">;      </font><font color="#008000"><i>{Dummy: not used in logic}
    </i></font>INPUTsize<font color="#000080">,                 </font><font color="#008000"><i>{ used to compare final sizes}
    </i></font>OUTPUTsize    <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>Capitals      <font color="#000080">: </font>rWords<font color="#000080">;   </font><font color="#008000"><i>{used to capitalize all reserved words for}
                              {Speed efficient ONLY comparison }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Announce<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'C-TP-Format v1.0    coded by    &thorn;Mr. Krinkle&thorn;'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Property of Clark Enterprizes.    Sept 5 1994'</font><font color="#000080">);
  </font>WriteLN<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>NEEDhelp<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'Usage:    CTP [FileName.in] [FileName.out]'</font><font color="#000080">);
  </font>WriteLN<font color="#000080">(</font><font color="#800000">'Example:  CTP Onefile.pas NewOne.pas'</font><font color="#000080">);
  </font>HALT<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>INITcapitals<font color="#000080">;
</font><font color="#008000"><i>{Make a Capitalized array of reserved word}
</i></font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">,</font>J <font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ResSize <font color="#FF0000"><b>DO BEGIN
    </b></font>Capitals<font color="#000080">[</font>I<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]:=</font>Reserved<font color="#000080">[</font>i<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]; </font><font color="#008000"><i>{init lengths}
    </i></font><font color="#FF0000"><b>FOR </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ORD<font color="#000080">(</font>Reserved<font color="#000080">[</font>I<font color="#000080">][</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#008000"><i>{LENGTH} </i></font><font color="#FF0000"><b>DO
        </b></font>Capitals<font color="#000080">[</font>I<font color="#000080">][</font>j<font color="#000080">]:= </font>UPCASE<font color="#000080">(</font>Reserved<font color="#000080">[</font>I<font color="#000080">][</font>J<font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>FUNCTION </b></font>Sfind<font color="#000080">( </font>Name <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Dum<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>k <font color="#000080">: </font>integer<font color="#000080">; </font>ch<font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF  </b></font>Name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font>Dum<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>THEN BEGIN        </b></font><font color="#008000"><i>{Size Check :Speed Efficient}
      </i></font><font color="#FF0000"><b>FOR </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>ord<font color="#000080">(</font>Dum<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO BEGIN   </b></font><font color="#008000"><i>{CHar by CHar comparison}
          </i></font><font color="#FF0000"><b>IF not </b></font><font color="#000080">( </font>Name<font color="#000080">[</font>k<font color="#000080">] = </font>Dum<font color="#000080">[</font>k<font color="#000080">] ) </font><font color="#FF0000"><b>Then BEGIN
             </b></font>Sfind<font color="#000080">:=</font>False<font color="#000080">;               </font><font color="#008000"><i>{When FIRST FALSE CASE}
             </i></font>EXIT<font color="#000080">;                       </font><font color="#008000"><i>{Speed Efficient}
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END ELSE BEGIN
    </b></font>SFINd<font color="#000080">:=</font>FALSE<font color="#000080">;                        </font><font color="#008000"><i>{Failed Size Check}
    </i></font>EXIT<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>SFind<font color="#000080">:=</font>True<font color="#000080">;                           </font><font color="#008000"><i>{The Two are the Same}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>SCANandUPdate<font color="#000080">(</font>Dummy<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{needs to be changed to boyerMoore type search string tech}
</i></font><font color="#FF0000"><b>VAR </b></font>J <font color="#000080">: </font>integer<font color="#000080">;
    </font>Dummy2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>Dummy2<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Dummy<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]; </font><font color="#008000"><i>{length}
 </i></font><font color="#FF0000"><b>FOR </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>Dummy<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO </b></font>Dummy2<font color="#000080">[</font>J<font color="#000080">]:=</font>UpCase<font color="#000080">( </font>Dummy<font color="#000080">[</font>j<font color="#000080">] ); </font><font color="#008000"><i>{Capitalize}
 
 </i></font><font color="#FF0000"><b>FOR </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ResSize <font color="#FF0000"><b>DO BEGIN
     IF </b></font>Sfind<font color="#000080">(</font>Capitals<font color="#000080">[</font>j<font color="#000080">], </font>Dummy2<font color="#000080">) </font><font color="#FF0000"><b>then BEGIN    </b></font><font color="#008000"><i>{check with Capitals array}
        </i></font>SCANandUpdate<font color="#000080">:=</font>Reserved<font color="#000080">[</font>j<font color="#000080">];
        </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{IF}
 </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>SCANandUPdate<font color="#000080">:=</font>Dummy<font color="#000080">;     </font><font color="#008000"><i>{Return original if not found}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{MAIN SKELETION}
</i></font>Announce<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>NEEdhelp<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>NEEDhelp<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)=</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>NEEDhelp<font color="#000080">;
 </font>Fsplit<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>Path<font color="#000080">, </font>name<font color="#000080">, </font>ext<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>path<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>path<font color="#000080">:=</font>path<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;    </font><font color="#008000"><i>{writeln(path,' ',name,' ',ext);}
</i></font>FINDFIRST<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>AnyFile<font color="#000080">, </font>LOOK<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>dosError<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>NeedHelp<font color="#000080">;
  </font><font color="#FF0000"><b>IF not </b></font>OpenFile<font color="#000080">(</font>F<font color="#000080">,</font>path<font color="#000080">+</font>Look<font color="#000080">.</font>Name<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'Unable to open '</font><font color="#000080">,</font>Look<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">' : Halting.'</font><font color="#000080">); </font>HALT<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>INITcapitals<font color="#000080">;
   </font>Assign<font color="#000080">(</font>OUTf<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));                     </font><font color="#008000"><i>{open and write output}
   </i></font>ReWrite<font color="#000080">(</font>OUTf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                              </font><font color="#008000"><i>{NO preExistance check
done}
   </i></font>WRITeLN<font color="#000080">(</font><font color="#800000">'=&lt; C-TP-Formating '</font><font color="#000080">,</font>Look<font color="#000080">.</font>name<font color="#000080">,</font><font color="#800000">' &gt;='</font><font color="#000080">);
   </font>InitBuffers<font color="#000080">(</font>F<font color="#000080">,</font>OUTf<font color="#000080">); </font><font color="#008000"><i>{MUST Initialize the READ and WRITE buffers}
   </i></font>b_READ<font color="#000080">(</font>F<font color="#000080">,</font>TB1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);       </font><font color="#008000"><i>{initialize tb1}
   </i></font><font color="#FF0000"><b>REPEAT
   REPEAT
     IF  </b></font><font color="#000080">(</font>tb1<font color="#000080">=</font><font color="#800000">#39</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN               </b></font><font color="#008000"><i>{ignore initial quote}
         </i></font>Quote<font color="#000080">:=</font>FALSE<font color="#000080">;
         </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Quote<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>TrueFileEnd<font color="#000080">) </font><font color="#FF0000"><b>do BEGIN           
            </b></font>b_write<font color="#000080">(</font>OUTf<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);            </font><font color="#008000"><i>{NO need to check for reserved}
            </i></font>b_read<font color="#000080">(</font>f<font color="#000080">, </font>tb1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>tb1<font color="#000080">=</font><font color="#800000">#39 </font><font color="#FF0000"><b>THEN </b></font>Quote<font color="#000080">:=</font><font color="#FF0000"><b>Not </b></font>Quote<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>b_write<font color="#000080">(</font>OUTf<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                </font><font color="#008000"><i>{write the closing quote}
         </i></font>b_read<font color="#000080">(</font>f<font color="#000080">, </font>tb1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);                  </font><font color="#008000"><i>{re-init tb1}
     </i></font><font color="#FF0000"><b>END else IF  </b></font><font color="#000080">( </font>tb1 <font color="#000080">=</font><font color="#800000">'{'</font><font color="#000080">)  </font><font color="#FF0000"><b>THEN BEGIN
         WHILE </b></font><font color="#000080">(</font>tb1<font color="#000080">&lt;&gt; </font><font color="#800000">'}'</font><font color="#000080">)  </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>TrueFileEnd<font color="#000080">) </font><font color="#FF0000"><b>do BEGIN           </b></font><font color="#008000"><i>{spit
out info until nex comment}
            </i></font>b_write<font color="#000080">(</font>OUTf<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);            </font><font color="#008000"><i>{NO need to check for reserved}
            </i></font>b_read<font color="#000080">(</font>f<font color="#000080">, </font>tb1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>b_write<font color="#000080">(</font>OUTf<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                </font><font color="#008000"><i>{write the closing comment}
         </i></font>b_read<font color="#000080">(</font>f<font color="#000080">, </font>tb1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);                  </font><font color="#008000"><i>{re-init tb1}
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>tb1 <font color="#000080">&lt;&gt; </font><font color="#800000">#39</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TB1<font color="#000080">&lt;&gt; </font><font color="#800000">'{'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>TrueFileEnd<font color="#000080">;      </font><font color="#008000"><i>{tb1 might be
another Q or C}
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tb1 <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN BEGIN      </b></font><font color="#008000"><i>{build String}
           </i></font>Dummy<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
           </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>tb1 <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">])  </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>TrueFileEnd<font color="#000080">) </font><font color="#FF0000"><b>DO
BEGIN      
              </b></font>Dummy<font color="#000080">:=</font>Dummy<font color="#000080">+</font>tb1<font color="#000080">;
              </font>b_READ<font color="#000080">(</font>f<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font>Dummy<font color="#000080">:=</font>SCANandUPDATE<font color="#000080">(</font>DUMMY<font color="#000080">);               </font><font color="#008000"><i>{Scan for reserved}
          { gotoXY(1,25);
           CLReol;
           write(Dummy,' '); }
           </i></font>b_WRITE<font color="#000080">(</font>OUTf<font color="#000080">,</font>DUMMY<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>ord<font color="#000080">(</font>DUMMY<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));      
        </font><font color="#FF0000"><b>END ELSE BEGIN
             </b></font>b_write<font color="#000080">(</font>OUTf<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
             </font>b_read<font color="#000080">(</font>F<font color="#000080">,</font>tb1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>BytesREAD<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{IF}
    </i></font>INC<font color="#000080">(</font>tb2<font color="#000080">);
    </font><font color="#FF0000"><b>CASE </b></font>TB2 <font color="#FF0000"><b>of
     </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#800000">400 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#800000">700 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">#127</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#800000">1000 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">#30</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#800000">1300 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
         </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);</font>write<font color="#000080">(</font><font color="#800000">#254</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#800000">1600 </font><font color="#000080">: </font>tb2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>UNTIL </b></font>TrueFileEnd<font color="#000080">;
   </font>b_WRite<font color="#000080">(</font>OUTf<font color="#000080">,</font>TB1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{hopefully spit out the last char}
   </i></font>FLushWriteBuffer<font color="#000080">(</font>OUTf<font color="#000080">);
   </font>INPUTsize<font color="#000080">:= </font>FileSize<font color="#000080">(</font>F<font color="#000080">);
   </font>OUTPUTsize<font color="#000080">:= </font>FileSize<font color="#000080">(</font>OUTf<font color="#000080">);
   </font>Close<font color="#000080">(</font>OUTf<font color="#000080">);
   </font>Close<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>IF  </b></font>INPUTsize <font color="#000080">&lt;&gt; </font>OUTPUTsize <font color="#FF0000"><b>THEN BEGIN
    </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);
    </font>WriteLN<font color="#000080">(</font><font color="#800000">'ERROR (1): Finished file sizes do not match.'</font><font color="#000080">);
</font><font color="#FF0000"><b>END Else BEGIN
    </b></font>write<font color="#000080">(</font><font color="#800000">#8#8</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Done.'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>(*
    The previous sources are to format the Case of you TP code.
    It will skip all words within Quotes '' or Comments {}.

    The two units are FILES and FREEbuff.
    The FREEbuff unit is my attempt to uses disk cache logic in my programs.
    The logic is simple: don't read until read buffer empty
                         don't write until write buffer full.

    To use FREEbuff do the following

    INITbuffer( INfile, OUTfile) [must be opened]
    repeat
      b_read( INfile, buffer[1], sizeOF(buffer), bytesRead);
      b_write( OUTfile, buffer[1], BytesRead);
    until TrueFileEnd;
    FlushWriteBuffer(Outfile);

    set it all up
    Flush empties the write buffer before the file is closed.
    Syntax is very clock to BlockRead&amp;write.

    BytesRead is the amount of bytes actually moved to the Buffer [or object]

    Instead of using blockRead for one byte reading, B_Read will fill the
    buffer with 8192 bytes and then only give the object one byte. This
    is extremely efficient when you only need small part of a file.
*)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0139.PAS">Original</a><b>]</b></p></body>
</html>
