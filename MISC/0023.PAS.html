<html>
<head><title> "Get the active code page" by JOSE ALMEIDA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Gets the active (set by user) and system (at boot byte) code page.
  Part of the Heartware Toolkit v2.00 (HTelse.PAS) for Turbo Pascal.
  Author: Jose Almeida. P.O.Box 4185. 1504 Lisboa Codex. Portugal.
          I can also be reached at RIME network, site -&gt;TIB or #5314.
  Feel completely free to use this source code in any way you want, and, if
  you do, please don't forget to mention my name, and, give me and Swag the
  proper credits. }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Get_Code_Page<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Active_CP <font color="#000080">: </font>word<font color="#000080">;
                       </font><font color="#FF0000"><b>var </b></font>System_CP <font color="#000080">: </font>word<font color="#000080">;
                       </font><font color="#FF0000"><b>var </b></font>Error_Code <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ DESCRIPTION:
    Gets the active (set by user) and system (at boot byte) code page.
  SAMPLE CALL:
    Get_Code_Page(Active_CP,Default_CP,Error_Code);
  RETURNS:
    Active : active code page set by user
    System : system code page at boot time
    Error_Code
      0 : no error
      else : see The Programmers PC Source Book 3.191
  NOTES:
    Applies to all versions beginning with v3.3.
    See Get_Code_Page_Text() in order to get string text. }

</i></font><font color="#FF0000"><b>var
  </b></font>HTregs <font color="#000080">: </font>registers<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ Get_Code_Page }
  </i></font>HTregs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$6601</font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>HTregs<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>HTregs<font color="#000080">.</font>Flags <font color="#FF0000"><b>and </b></font>FCarry <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>Active_CP <font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;           </font><font color="#008000"><i>{ on error set to $FFFF }
      </i></font>System_CP <font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;           </font><font color="#008000"><i>{ on error set to $FFFF }
      </i></font>Error_Code <font color="#000080">:= </font>HTregs<font color="#000080">.</font>AL<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>Active_CP <font color="#000080">:= </font>HTregs<font color="#000080">.</font>BX<font color="#000080">;
      </font>System_CP <font color="#000080">:= </font>HTregs<font color="#000080">.</font>DX<font color="#000080">;
      </font>Error_Code <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ Get_Code_Page }



</i></font><font color="#FF0000"><b>FUNCTION </b></font>Get_Code_Page_Text<font color="#000080">(</font>CP <font color="#000080">: </font>word<font color="#000080">) : </font>String14<font color="#000080">;

</font><font color="#008000"><i>{ DESCRIPTION:
    Gets the current active code page in string form.
  SAMPLE CALL:
    St := Get_Code_Page_Text(860);
  RETURNS:
    e.g.: 'Portugal'
  NOTES:
    None. }

</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ Get_Code_Page_Text }
  </i></font><font color="#FF0000"><b>case </b></font>CP <font color="#FF0000"><b>of
    </b></font><font color="#800000">437 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'USA English'</font><font color="#000080">;
    </font><font color="#800000">850 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Multilingual'</font><font color="#000080">;
    </font><font color="#800000">852 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'CZ/SL/HU/PL/YU'</font><font color="#000080">;
          </font><font color="#008000"><i>{ CZ and SL = Czechoslovakia (Czech &amp; Slovak) }
          { HU        = Hungary                         }
          { PL        = Poland                          }
          { YU        = Yugoslavia                      }
    </i></font><font color="#800000">854 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Spain'</font><font color="#000080">;
    </font><font color="#800000">860 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Portugal'</font><font color="#000080">;
    </font><font color="#800000">863 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Canada-French'</font><font color="#000080">;
    </font><font color="#800000">865 </font><font color="#000080">: </font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Norway/Denmark'</font><font color="#000080">;
  </font><font color="#FF0000"><b>else
    </b></font>Get_Code_Page_Text <font color="#000080">:= </font><font color="#800000">'Unknown'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ Get_Code_Page_Text }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p></body>
</html>
