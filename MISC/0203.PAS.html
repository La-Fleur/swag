<html>
<head><title> "BASM Write Time Unit" by ROBERT AH PRINS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0203.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>(*
{***********************************************************************
* WRITE_TIME:                                                          *
*                                                                      *
* Very fast, can it be done any faster, routine to plonk the current   *
* system time into a variable and to write it out as header for any    *
* data that might follow...                                            *
*                                                                      *
* Note: Requires {$G+} directive                                       *
*                                                                      *
* (C) Copyright Robert AH Prins, 1995. All rights reserved.            *
*                                                                      *
* May be copied, used and distributed freely for non-profit purposes,  *
* including the inclusion in shareware, provided credit is given.      *
***********************************************************************}
*)

</i></font><font color="#FF0000"><b>procedure </b></font>write_time<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>wt_time<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">14</font><font color="#000080">] = </font><font color="#800000">'00:00:00.00 - '</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">mov   ax, $2c00
    int   $21
    mov   bx, &quot;00&quot;
    mov   al, ch                  </font><font color="#008000"><i>{hours}
    </i></font><font color="#FF00FF">aam
    rol   ax, 8
    or    ax, bx
    cmp   al, bl                  </font><font color="#008000"><i>{&lt;-  delete these four}
    </i></font><font color="#FF00FF">jne   @1                      </font><font color="#008000"><i>{&lt;-  lines if you want}
    </i></font><font color="#FF00FF">mov   al, &quot; &quot;                 </font><font color="#008000"><i>{&lt;-  leading zeroes in}
  </i></font><font color="#FF00FF">@1:                             </font><font color="#008000"><i>{&lt;-  the hours        }
    </i></font><font color="#FF00FF">mov   word ptr wt_time(1), ax
    mov   al, cl                  </font><font color="#008000"><i>{minutes}
    </i></font><font color="#FF00FF">aam
    rol   ax, 8
    or    ax, bx
    mov   word ptr wt_time[4], ax
    mov   al, dh                  </font><font color="#008000"><i>{seconds}
    </i></font><font color="#FF00FF">aam
    rol   ax, 8
    or    ax, bx
    mov   word ptr wt_time[7], ax
    mov   al, dl                  </font><font color="#008000"><i>{hundreds of seconds}
    </i></font><font color="#FF00FF">aam
    rol   ax, 8
    or    ax, bx
    mov   word ptr wt_time[10], ax
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>write<font color="#000080">(</font>wt_time<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{write_time}

</i></font>Regards<font color="#000080">,

</font>Robert AH Prins <font color="#000080">&lt;</font>nlklmpum<font color="#000080">@</font>ibmmail<font color="#000080">.</font>com<font color="#000080">&gt;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0203.PAS">Original</a><b>]</b></p></body>
</html>
