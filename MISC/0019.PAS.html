<html>
<head><title> "RANDOM NUMBER GENERATOR" by FLOOR NAAIJKENS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">==============================================================================
 </font>BBS<font color="#000080">: </font>The Sand Box BBS <font color="#000080">- </font>SourceNet Central HUB
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>JUD MCCRANIE                 Date<font color="#000080">: </font><font color="#800000">12</font><font color="#000080">-</font><font color="#800000">17</font><font color="#000080">&Auml;</font><font color="#800000">92 </font><font color="#000080">(</font><font color="#800000">16</font><font color="#000080">:</font><font color="#800000">42</font><font color="#000080">)
</font>From<font color="#000080">: </font>TREVOR CARLSEN             Number<font color="#000080">: </font><font color="#800000">531    </font><font color="#000080">[</font><font color="#800000">87</font><font color="#000080">] </font>FD<font color="#000080">-</font><font color="#FF0000"><b>Pascal
</b></font>Subj<font color="#000080">: </font>BP <font color="#800000">7 </font>DIFFERENCE            Status<font color="#000080">: </font><font color="#FF0000"><b>Public
</b></font><font color="#000080">------------------------------------------------------------------------------
 </font>JM<font color="#000080">&gt; </font>The behavior <font color="#FF0000"><b>of </b></font>RANDOM <font color="#000080">(</font><font color="#FF0000"><b>with </b></font>RandSeed <font color="#FF0000"><b>set</b></font><font color="#000080">) </font><font color="#FF0000"><b>is </b></font>different <font color="#FF0000"><b>in
 </b></font>JM<font color="#000080">&gt; </font>BP7 <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>presumably TP7<font color="#000080">) </font>from that <font color="#FF0000"><b>in </b></font>TP <font color="#800000">5.5.  </font><font color="#000080">(</font>I don<font color="#800000">'t know
 </font>JM<font color="#000080">&gt; </font>how TP <font color="#800000">6 </font>compares since I burned it off my disk<font color="#000080">).

 </font>JM<font color="#000080">&gt; </font>RandSeed <font color="#000080">:= </font><font color="#800000">123</font><font color="#000080">;
 </font>JM<font color="#000080">&gt; </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do </b></font>writeln<font color="#000080">( </font>random<font color="#000080">( </font><font color="#800000">1000</font><font color="#000080">));

 </font>JM<font color="#000080">&gt; </font>TP <font color="#800000">5.5</font><font color="#000080">: </font><font color="#800000">343 282 986 996 781 855 343  32
 </font>JM<font color="#000080">&gt; </font>BP <font color="#800000">7.0</font><font color="#000080">: </font><font color="#800000">859  80 869 854 317 257  20  46

 </font>JM<font color="#000080">&gt; ...</font>both are consistant<font color="#000080">, </font>but they are different sequences<font color="#000080">.
 </font>JM<font color="#000080">&gt; </font>This can have some dire consequences<font color="#000080">.  ...

</font>It certainly could <font color="#FF0000"><b>if </b></font>you did <font color="#FF0000"><b>not </b></font>know about it <font color="#FF0000"><b>and </b></font>unfortunately I can
find no reference <font color="#FF0000"><b>to </b></font>the changes <font color="#FF0000"><b>in </b></font>the documentation<font color="#000080">. (</font>Richard Nelson<font color="#000080">?)

</font>Here <font color="#FF0000"><b>is </b></font>a fix <font color="#000080">(</font>supplied <font color="#FF0000"><b>to </b></font>me via Netmail courtesy Joe Lamoine <font color="#000080">- </font>thanks Joe<font color="#000080">).

&gt;</font>Quote<font color="#000080">........

</font>I posted a <font color="#FF0000"><b>message on </b></font>Compuserve last nite <font color="#FF0000"><b>and </b></font>got the following
<font color="#FF0000"><b>unit in </b></font>a response<font color="#000080">.  </font>It seems <font color="#FF0000"><b>to </b></font>work fine<font color="#000080">!


</font><font color="#008000"><i>{ *  Turbo Pascal Runtime Library Version 6.0     * ;
  *  Random Number Generator                      * ;
  *                                               * ;
  *  Copyright (C) 1988,92 Borland International  * }

 </i></font><font color="#FF0000"><b>unit </b></font>TP6Rand<font color="#000080">;

 </font><font color="#FF0000"><b>interface

 function </b></font>Random<font color="#000080">(</font>Max<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;

 </font><font color="#FF0000"><b>implementation

 const
  </b></font><font color="#008000"><i>{ Scaling constant}
  </i></font>ConstM31 <font color="#000080">= </font>Longint<font color="#000080">(-</font><font color="#800000">31</font><font color="#000080">);
  </font><font color="#008000"><i>{ Multiplication factor}
  </i></font>Factor<font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">$8405</font><font color="#000080">;


 </font><font color="#FF0000"><b>function </b></font>NextRand<font color="#000080">: </font>Longint<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
 </font><font color="#008000"><i>{ Compute next random number
  New := 8088405H * Old + 1
  Out  DX:AX = Next random number
 }
 </i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">MOV  AX,RandSeed.Word[0]
  MOV  BX,RandSeed.Word[2]
  MOV  CX,AX
  MUL  Factor.Word[0]     </font><font color="#008000"><i>{ New = Old.w0 * 8405H }
  </i></font><font color="#FF00FF">SHL  CX,1               </font><font color="#008000"><i>{ New.w2 += Old.w0 * 808H }
  </i></font><font color="#FF00FF">SHL  CX,1
  SHL  CX,1
  ADD  CH,CL
  ADD  DX,CX
  ADD  DX,BX              </font><font color="#008000"><i>{ New.w2 += Old.w2 * 8405H }
  </i></font><font color="#FF00FF">SHL  BX,1
  SHL  BX,1
  ADD  DX,BX
  ADD  DH,BL
  MOV  CL,5
  SHL  BX,CL
  ADD  DH,BL
  ADD  AX,1      </font><font color="#008000"><i>{ New += 1 }
  </i></font><font color="#FF00FF">ADC  DX,0
  MOV  RandSeed.Word[0],AX
  MOV  RandSeed.Word[2],DX
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Random<font color="#000080">(</font>Max<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">CALL  NextRand
  XOR   AX,AX
  MOV   BX,Max.Word[0]
  OR    BX,BX
  JE    @@1
  XCHG  AX,DX
  DIV   BX
  XCHG  AX,DX
 @@1:
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

&gt;</font><font color="#FF0000"><b>End of </b></font>quote<font color="#000080">.


</font>TeeCee


<font color="#000080">--- </font>TC<font color="#000080">-</font>ED   v2<font color="#000080">.</font><font color="#800000">01
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>The Pilbara<font color="#800000">'s Pascal Centre (+61 91 732930) (3:690/644)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
