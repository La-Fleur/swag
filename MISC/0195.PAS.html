<html>
<head><title> "Progress Bar for TechnoJock Toolkit" by SERGEY PEREVOZNIK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0195.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
 Since I received the request I post the following TOT (TechnoJock)  snippet.
 The  object in the code below is a window with progress bar.
 The object is very simple so I didn't comment the source.
 I did include an example.

 Here we go :
}

 {==========================================================================}
 {= Unit name      : TotPro                                                =}
 {= Version        : 1.0                                                   =}
 {= Public Objects : ProcessOBJ                                            =}
 {===--------------------------------------------------------------------===}
 {= Programmer     : Sergey Perevoznik                                     =}
 {                   root@pcb.chernigov.ua                                  }
 {= Language       : Borland Pascal 7.0                                    =}
 {===--------------------------------------------------------------------===}

</i></font><font color="#FF0000"><b>Unit </b></font>TotPro<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
</b></font>TotStr<font color="#000080">,
</font>TotFast<font color="#000080">,
</font>TotWin<font color="#000080">;

</font><font color="#FF0000"><b>Type
       </b></font>ProcessOBJ <font color="#000080">= </font><font color="#FF0000"><b>object
          </b></font>vWinPtr        <font color="#000080">: </font>WinPtr<font color="#000080">;
          </font>ScaleSym       <font color="#000080">: </font>char<font color="#000080">;
          </font>DoneSym        <font color="#000080">: </font>char<font color="#000080">;
          </font>ScaleCol       <font color="#000080">: </font>byte<font color="#000080">;
          </font>DoneCol        <font color="#000080">: </font>byte<font color="#000080">;
          </font>OneStep        <font color="#000080">: </font>real<font color="#000080">;
          </font>CountCycle     <font color="#000080">: </font>longint<font color="#000080">;
          </font>ScaleLen       <font color="#000080">: </font>byte<font color="#000080">;
          </font>OldX           <font color="#000080">: </font>byte<font color="#000080">;
          </font>InitVal<font color="#000080">,
          </font>DoneVal        <font color="#000080">: </font>longInt<font color="#000080">;
          </font>Currentpercent <font color="#000080">: </font>byte<font color="#000080">;

          </font><font color="#FF0000"><b>Constructor </b></font>Init<font color="#000080">(</font>InitValue<font color="#000080">, </font>EndValue <font color="#000080">: </font>longint<font color="#000080">;
                           </font>Title <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
          </font><font color="#FF0000"><b>Procedure   </b></font>SetScale<font color="#000080">(</font>ScaleSymbol<font color="#000080">,
                               </font>DoneSymbol <font color="#000080">: </font>char<font color="#000080">;
                               </font>ScaleColor<font color="#000080">,
                               </font>DoneColor   <font color="#000080">: </font>byte<font color="#000080">);
          </font><font color="#FF0000"><b>Procedure  </b></font>Run<font color="#000080">;
          </font><font color="#FF0000"><b>Procedure  </b></font>UpDate<font color="#000080">;
          </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation


Function  </b></font>FillCh<font color="#000080">(</font>Sym<font color="#000080">:</font>Char<font color="#000080">;</font>L<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
 </b></font><font color="#FF00FF">PUSH DS
 LES   DI,@Result
 XOR  CX,CX
 MOV   CL,L
 CMP   CL,0
 MOV AL,CL
 STOSB
 MOV CL,AL
 JE  @@1
 MOV   AL,SYM
 CLD
 REP   STOSB
@@1:
 POP DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#FF0000"><b>Constructor </b></font>ProcessOBJ<font color="#000080">.</font>Init<font color="#000080">(</font>InitValue<font color="#000080">, </font>EndValue <font color="#000080">: </font>longint<font color="#000080">;
                           </font>Title <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
     </b></font>New<font color="#000080">(</font>vWinPtr<font color="#000080">,</font>Init<font color="#000080">);
     </font>vWinPtr<font color="#000080">^.</font>SetTitle<font color="#000080">(</font>Title<font color="#000080">);
     </font>vWinPtr<font color="#000080">^.</font>SetSize<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">65</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>vWinPtr<font color="#000080">^.</font>SetColors<font color="#000080">(</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">);
     </font>ScaleSym <font color="#000080">:= </font><font color="#800000">'&deg;'</font><font color="#000080">;
     </font>DoneSym  <font color="#000080">:= </font><font color="#800000">'&Ucirc;'</font><font color="#000080">;
     </font>ScaleCol <font color="#000080">:= </font><font color="#800000">$07</font><font color="#000080">;
     </font>DoneCol  <font color="#000080">:= </font><font color="#800000">$70</font><font color="#000080">;
     </font>OldX     <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
     </font>initVal  <font color="#000080">:= </font>InitValue<font color="#000080">;
     </font>DoneVal  <font color="#000080">:= </font>EndValue<font color="#000080">;
     </font>CurrentPercent <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>CountCycle <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Procedure </b></font>ProcessOBJ<font color="#000080">.</font>SetScale<font color="#000080">(</font>ScaleSymbol<font color="#000080">,
                     </font>DoneSymbol <font color="#000080">: </font>char<font color="#000080">;
                     </font>ScaleColor<font color="#000080">,
                     </font>DoneColor   <font color="#000080">: </font>byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>ScaleSym <font color="#000080">:= </font>ScaleSymbol<font color="#000080">;
    </font>DoneSym  <font color="#000080">:= </font>DoneSymbol<font color="#000080">;
    </font>ScaleCol <font color="#000080">:= </font>ScaleColor<font color="#000080">;
    </font>DoneCol  <font color="#000080">:= </font>DoneColor<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Procedure </b></font>ProcessOBJ<font color="#000080">.</font>Run<font color="#000080">;
    </font><font color="#FF0000"><b>begin

       </b></font>vWinPtr<font color="#000080">^.</font>Draw<font color="#000080">;
       </font>ScaleLen <font color="#000080">:= </font>vWinPtr<font color="#000080">^.</font>vBorder<font color="#000080">.</font>X2 <font color="#000080">- </font>vWinPtr<font color="#000080">^.</font>vBorder<font color="#000080">.</font>X1 <font color="#000080">- </font><font color="#800000">8</font><font color="#000080">;
       </font>Screen<font color="#000080">.</font>WriteAT<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>ScaleCol<font color="#000080">,</font>FillCh<font color="#000080">(</font>ScaleSym<font color="#000080">,</font>ScaleLen<font color="#000080">));
       </font>OneStep <font color="#000080">:= (</font>DoneVal <font color="#000080">- </font>Initval<font color="#000080">) / </font><font color="#800000">100</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ProcessOBJ<font color="#000080">.</font>Update<font color="#000080">;
    </font><font color="#FF0000"><b>var
    </b></font>Cp1 <font color="#000080">: </font>byte<font color="#000080">;
    </font><font color="#FF0000"><b>begin
       </b></font>Inc<font color="#000080">(</font>CountCycle<font color="#000080">);
       </font>Cp1 <font color="#000080">:= </font>Round<font color="#000080">(</font>CountCycle<font color="#000080">/</font>OneStep<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>Cp1 <font color="#000080">&gt; </font>CurrentPercent <font color="#FF0000"><b>then </b></font>CurrentPercent <font color="#000080">:= </font>Cp1<font color="#000080">;
       </font>Screen<font color="#000080">.</font>WriteAT<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>DoneCol<font color="#000080">,</font>FillCH<font color="#000080">(</font>DoneSym<font color="#000080">,</font>trunc<font color="#000080">(</font>CurrentPercent<font color="#000080">*</font>ScaleLen<font color="#000080">/</font><font color="#800000">100</font><font color="#000080">)));
       </font>Screen<font color="#000080">.</font>WriteAT<font color="#000080">(</font>vWinPtr<font color="#000080">^.</font>vBorder<font color="#000080">.</font>X2 <font color="#000080">- </font>vWinPtr<font color="#000080">^.</font>vBorder<font color="#000080">.</font>X1<font color="#000080">- </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,
       </font>DoneCol<font color="#000080">,</font>intTostr<font color="#000080">(</font>CurrentPercent<font color="#000080">) + </font><font color="#800000">'%'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Destructor </b></font>ProcessOBJ<font color="#000080">.</font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>Dispose<font color="#000080">(</font>vWinPtr<font color="#000080">,</font>done<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
Program Example;

Uses TotPro,
     TotFast,
     CRT;

Var
   Process : ProcessOBJ;
   I       : integer;
begin
  ClrScr;
  Screen.CursOFF;
  Process.Init(0,80,'TOT Process Example');
  Process.Run;
  For I := 1 to 80 do
    begin
      Process.Update;
      Delay(30);
    end;
  Process.Done;
  Screen.CursON;
end.

}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0195.PAS">Original</a><b>]</b></p></body>
</html>
