<html>
<head><title> "Convert C Header to Pascal" by PETER SAWATZKI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0186.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,B-,F-,G+,I-,P-,Q-,R-,S-,T-,V-,X+,Y+}
</i></font><font color="#FF0000"><b>Program </b></font>H2Pas<font color="#000080">;
</font><font color="#008000"><i>{ Program:   H2PAS
  Version:   1.21
  Purpose:   convert C header files to some kind of Pascal units

  Developer: Peter Sawatzki (ps) (c) 1993
             Buchenhof 3, 58091 Hagen, Germany
 CompuServe: 100031,3002

  revision history:
  date       version  author   modification
  11/03/93   1.00     ps       written
  05/10/94   1.10     ps       add EXEHDR import support
  06/29/94   1.2x     ps       minor modifications
}
</i></font><font color="#FF0000"><b>Uses
  </b></font>Objects<font color="#000080">,
  </font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Version <font color="#000080">= </font><font color="#800000">'H2Pas v.1.21'</font><font color="#000080">;
  </font>H2PasIni<font color="#000080">= </font><font color="#800000">'H2Pas.Ini'</font><font color="#000080">;
  </font>CRLF <font color="#000080">= </font><font color="#800000">#13#10</font><font color="#000080">;
  </font>StdUses<font color="#000080">: </font>pChar <font color="#000080">= </font><font color="#800000">'Uses'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                   </font><font color="#800000">'  WinTypes,'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                   </font><font color="#800000">'  WinProcs;'</font><font color="#000080">;
  </font>HasImports<font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;
  </font>WhichBlock<font color="#000080">: (</font>Undefd<font color="#000080">, </font>InConst<font color="#000080">, </font>InType<font color="#000080">, </font>InVar<font color="#000080">, </font>InFunc<font color="#000080">) = </font>Undefd<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>DstName<font color="#000080">,
  </font>Imports<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">67</font><font color="#000080">];

  </font><font color="#FF0000"><b>Function </b></font>WordCount<font color="#000080">(</font>aStr<font color="#000080">, </font>Delims<font color="#000080">: </font>pChar<font color="#000080">): </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Count<font color="#000080">: </font>Integer<font color="#000080">;
    </font>EndStr<font color="#000080">: </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aStr<font color="#000080">);
    </font>Count<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>aStr<font color="#000080">&lt;=</font>EndStr <font color="#FF0000"><b>Do Begin
      While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrScan<font color="#000080">(</font>Delims<font color="#000080">, </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>aStr<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>aStr<font color="#000080">&lt;=</font>EndStr <font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrScan<font color="#000080">(</font>Delims<font color="#000080">, </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>aStr<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>WordCount<font color="#000080">:= </font>Count
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>WordPosition <font color="#000080">(</font>aStr<font color="#000080">, </font>Delims<font color="#000080">: </font>pChar<font color="#000080">; </font>No<font color="#000080">: </font>Integer<font color="#000080">): </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Count<font color="#000080">: </font>Integer<font color="#000080">;
    </font>EndStr<font color="#000080">: </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aStr<font color="#000080">);
    </font>Count<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>WordPosition<font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Count<font color="#000080">&lt;&gt;</font>No<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
      While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrScan<font color="#000080">(</font>Delims<font color="#000080">, </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>aStr<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>aStr<font color="#000080">&lt;=</font>EndStr <font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Count<font color="#000080">&lt;&gt;</font>No <font color="#FF0000"><b>Then
        While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrScan<font color="#000080">(</font>Delims<font color="#000080">, </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>aStr<font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>WordPosition<font color="#000080">:= </font>aStr
    <font color="#FF0000"><b>End
  End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ExtractWord <font color="#000080">(</font>aDst<font color="#000080">, </font>aStr<font color="#000080">, </font>Delims<font color="#000080">: </font>pChar<font color="#000080">; </font>No<font color="#000080">: </font>Integer<font color="#000080">): </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>EndStr<font color="#000080">: </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>ExtractWord<font color="#000080">:= </font>aDst<font color="#000080">;
    </font>aStr<font color="#000080">:= </font>WordPosition<font color="#000080">(</font>aStr<font color="#000080">, </font>Delims<font color="#000080">, </font>No<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>aStr<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aStr<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>aStr<font color="#000080">&lt;=</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrScan<font color="#000080">(</font>Delims<font color="#000080">, </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
        </b></font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
        </font>Inc<font color="#000080">(</font>aStr<font color="#000080">);
        </font>Inc<font color="#000080">(</font>aDst<font color="#000080">)
      </font><font color="#FF0000"><b>End
    End</b></font><font color="#000080">;
    </font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>Trim <font color="#000080">(</font>aDst<font color="#000080">, </font>aSrc<font color="#000080">: </font>pChar<font color="#000080">): </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>EndStr<font color="#000080">: </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>Trim<font color="#000080">:= </font>aDst<font color="#000080">;
    </font><font color="#FF0000"><b>If Not </b></font>Assigned<font color="#000080">(</font>aSrc<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>aSrc<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0
    </font><font color="#FF0000"><b>Else Begin
      </b></font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aSrc<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>aSrc<font color="#000080">&lt;</font>EndStr<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>aSrc<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;=</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        </b></font>Inc<font color="#000080">(</font>aSrc<font color="#000080">);
      </font>StrCopy<font color="#000080">(</font>aDst<font color="#000080">, </font>aSrc<font color="#000080">);
      </font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aDst<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>EndStr<font color="#000080">&gt;</font>aDst<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>EndStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;=</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
        </b></font>EndStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
        </font>Dec<font color="#000080">(</font>EndStr<font color="#000080">)
      </font><font color="#FF0000"><b>End
    End
  End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>Pad <font color="#000080">(</font>aDst<font color="#000080">, </font>aSrc<font color="#000080">: </font>pChar<font color="#000080">; </font>Count<font color="#000080">: </font>Integer<font color="#000080">): </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>Pad<font color="#000080">:= </font>aDst<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>aDst<font color="#000080">&lt;&gt;</font>aSrc <font color="#FF0000"><b>Then
      </b></font>StrCopy<font color="#000080">(</font>aDst<font color="#000080">, </font>aSrc<font color="#000080">);
    </font>Count<font color="#000080">:= </font>Count<font color="#000080">-</font>StrLen<font color="#000080">(</font>aDst<font color="#000080">);
    </font>aDst<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aDst<font color="#000080">);
    </font><font color="#FF0000"><b>While </b></font>Count<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Do Begin
      </b></font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>aDst<font color="#000080">);
      </font>Dec<font color="#000080">(</font>Count<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrIPos<font color="#000080">(</font>Str1<font color="#000080">, </font>Str2<font color="#000080">: </font>PChar<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>EndStr<font color="#000080">: </font>pChar<font color="#000080">;
  </font>Len<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>StrIPos<font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>EndStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>Str1<font color="#000080">);
  </font>Len<font color="#000080">:= </font>StrLen<font color="#000080">(</font>Str2<font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>Str1<font color="#000080">:= </font>StrScan<font color="#000080">(</font>Str1<font color="#000080">, </font>Str2<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font><font color="#FF0000"><b>If </b></font>Str1<font color="#000080">=</font><font color="#FF0000"><b>Nil Then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>StrLIComp<font color="#000080">(</font>Str1<font color="#000080">, </font>Str2<font color="#000080">, </font>Len<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
      </b></font>StrIPos<font color="#000080">:= </font>Str1<font color="#000080">;
      </font>Exit
    <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>Str1<font color="#000080">)
  </font><font color="#FF0000"><b>Until </b></font>Str1<font color="#000080">&gt;</font>EndStr
<font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>JustFilename<font color="#000080">(</font>PathName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-Return just the filename of a pathname}
  </i></font><font color="#FF0000"><b>Var
    </b></font>I<font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>I<font color="#000080">:= </font>Succ<font color="#000080">(</font>Word<font color="#000080">(</font>Length<font color="#000080">(</font>PathName<font color="#000080">)));
    </font><font color="#FF0000"><b>Repeat
      </b></font>Dec<font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>PathName<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>in  </b></font><font color="#000080">[</font><font color="#800000">'\'</font><font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">]) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>I <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
    </font>JustFilename <font color="#000080">:= </font>Copy<font color="#000080">(</font>PathName<font color="#000080">, </font>Succ<font color="#000080">(</font>I<font color="#000080">), </font><font color="#800000">64</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>JustName<font color="#000080">(</font>PathName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#008000"><i>{-Return just the name (no extension, no path) of a pathname}
  </i></font><font color="#FF0000"><b>var
    </b></font>DotPos <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>PathName <font color="#000080">:= </font>JustFileName<font color="#000080">(</font>PathName<font color="#000080">);
    </font>DotPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>PathName<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>DotPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>PathName <font color="#000080">:= </font>Copy<font color="#000080">(</font>PathName<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>DotPos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>JustName <font color="#000080">:= </font>PathName<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>JustPath<font color="#000080">(</font>aName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-Return just the path of a filename}
  </i></font><font color="#FF0000"><b>Var
    </b></font>I<font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>I<font color="#000080">:= </font>Succ<font color="#000080">(</font>Word<font color="#000080">(</font>Length<font color="#000080">(</font>aName<font color="#000080">)));
    </font><font color="#FF0000"><b>Repeat
      </b></font>Dec<font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>aName<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>in  </b></font><font color="#000080">[</font><font color="#800000">'\'</font><font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">]) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>I <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
    </font>JustPath<font color="#000080">:= </font>Copy<font color="#000080">(</font>aName<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>I<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>Fatal <font color="#000080">(</font>aMsg<font color="#000080">: </font>pChar<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
    </b></font>WriteLn<font color="#000080">(</font>aMsg<font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>GetLine <font color="#000080">(</font>aDst<font color="#000080">: </font>pChar<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>aFile<font color="#000080">: </font>Text<font color="#000080">): </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>aString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>p<font color="#000080">,</font>i<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font><font color="#008000"><i>{$i-}
    </i></font>ReadLn<font color="#000080">(</font>aFile<font color="#000080">, </font>aString<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Fatal<font color="#000080">(</font><font color="#800000">'Read error.'</font><font color="#000080">);
    </font>p<font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'//'</font><font color="#000080">, </font>aString<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>p<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
      </b></font>aString<font color="#000080">[</font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:= </font><font color="#800000">'*'</font><font color="#000080">;
      </font>aString<font color="#000080">:= </font>aString<font color="#000080">+</font><font color="#800000">' */'
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>p<font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">#9</font><font color="#000080">, </font>aString<font color="#000080">);
    </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Do Begin
      </b></font>aString<font color="#000080">[</font>p<font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">7</font><font color="#000080">-((</font>p<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Mod </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        </b></font>Insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>aString<font color="#000080">, </font>p<font color="#000080">);
      </font>p<font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">#9</font><font color="#000080">, </font>aString<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>GetLine<font color="#000080">:= </font>StrPCopy<font color="#000080">(</font>aDst<font color="#000080">, </font>aString<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>OutLn <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>aFile<font color="#000080">: </font>Text<font color="#000080">; </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>oc<font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    While </b></font>OutStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Do Begin
      </b></font>oc<font color="#000080">:= </font>OutStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
      </font><font color="#FF0000"><b>Case </b></font>oc <font color="#FF0000"><b>Of
        </b></font><font color="#800000">'/'</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>OutStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>Then Begin
               </b></font>oc<font color="#000080">:= </font><font color="#800000">'{'</font><font color="#000080">;
               </font>Inc<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#800000">'*'</font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>OutStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'/' </font><font color="#FF0000"><b>Then Begin
               </b></font>oc<font color="#000080">:= </font><font color="#800000">'}'</font><font color="#000080">;
               </font>Inc<font color="#000080">(</font>OutStr<font color="#000080">)
             </font><font color="#FF0000"><b>End
      End</b></font><font color="#000080">;
      </font>Write<font color="#000080">(</font>aFile<font color="#000080">, </font>oc<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Fatal<font color="#000080">(</font><font color="#800000">'Write error.'</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Write<font color="#000080">(</font>aFile<font color="#000080">,</font>CRLF<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Fatal<font color="#000080">(</font><font color="#800000">'Write error.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HeaderInfo <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>aFile<font color="#000080">: </font>Text<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>aLine<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'{ Unit: '</font><font color="#000080">,</font>DstName<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  Version: 1.00'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  translated from file '</font><font color="#000080">,</font>DstName<font color="#000080">,</font><font color="#800000">'.H'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  raw translation using '</font><font color="#000080">+</font>Version<font color="#000080">+</font><font color="#800000">', (c) Peter Sawatzki'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  fine tuned by:'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'    (fill in)'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  revision history:'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  Date:    Ver: Author: Mod:'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'  xx/xx/94 1.00 &lt;name&gt;  &lt;modification&gt;'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'}'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'Unit '</font><font color="#000080">,</font>DstName<font color="#000080">,</font><font color="#800000">';'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font><font color="#800000">'Interface'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>StrLen<font color="#000080">(</font>StdUses<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>WriteLn<font color="#000080">(</font>aFile<font color="#000080">, </font>StdUses<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-the collection part}
</i></font><font color="#FF0000"><b>Type
  </b></font>pImportEntry <font color="#000080">= ^</font>tImportEntry<font color="#000080">;
  </font>tImportEntry <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>TheName<font color="#000080">,
    </font>TheDLL<font color="#000080">,
    </font>TheOrd<font color="#000080">: </font>pChar
  <font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>pImportCollection <font color="#000080">= ^</font>tImportCollection<font color="#000080">;
  </font>tImportCollection <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>tSortedCollection<font color="#000080">)
    </font><font color="#FF0000"><b>Function </b></font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>FreeItem<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>pTypeMap <font color="#000080">= ^</font>tTypeMap<font color="#000080">;
  </font>tTypeMap <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>F<font color="#000080">, </font>T<font color="#000080">: </font>pChar<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>pTypeMapCollection <font color="#000080">= ^</font>tTypeMapCollection<font color="#000080">;
  </font>tTypeMapCollection <font color="#000080">= </font><font color="#FF0000"><b>Object</b></font><font color="#000080">(</font>tSortedCollection<font color="#000080">)
    </font><font color="#FF0000"><b>Function </b></font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>FreeItem<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>tImportCollection<font color="#000080">.</font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>KeyOf<font color="#000080">:= </font>pImportEntry<font color="#000080">(</font>Item<font color="#000080">)^.</font>TheName
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>tImportCollection<font color="#000080">.</font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Compare<font color="#000080">:= </font>StrIComp<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TImportCollection<font color="#000080">.</font>FreeItem<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>StrDispose<font color="#000080">(</font>pImportEntry<font color="#000080">(</font>Item<font color="#000080">)^.</font>TheName<font color="#000080">);
  </font>StrDispose<font color="#000080">(</font>pImportEntry<font color="#000080">(</font>Item<font color="#000080">)^.</font>TheDLL<font color="#000080">);
  </font>StrDispose<font color="#000080">(</font>pImportEntry<font color="#000080">(</font>Item<font color="#000080">)^.</font>TheOrd<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>pImportEntry<font color="#000080">(</font>Item<font color="#000080">))
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>tTypeMapCollection<font color="#000080">.</font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>KeyOf<font color="#000080">:= </font>pTypeMap<font color="#000080">(</font>Item<font color="#000080">)^.</font>F
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>tTypeMapCollection<font color="#000080">.</font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">: </font>Pointer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Compare<font color="#000080">:= </font>StrIComp<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>tTypeMapCollection<font color="#000080">.</font>FreeItem<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>StrDispose<font color="#000080">(</font>pTypeMap<font color="#000080">(</font>Item<font color="#000080">)^.</font>F<font color="#000080">);
  </font>StrDispose<font color="#000080">(</font>pTypeMap<font color="#000080">(</font>Item<font color="#000080">)^.</font>T<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>pTypeMap<font color="#000080">(</font>Item<font color="#000080">))
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>TheImports<font color="#000080">: </font>pImportCollection <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>TheFuncs<font color="#000080">: </font>pStrCollection <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>TheStructs<font color="#000080">: </font>pStrCollection <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>TheTypeMap<font color="#000080">: </font>pTypeMapCollection <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>TheModMap<font color="#000080">: </font>pStrCollection <font color="#000080">= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CreateCollections<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TheImports<font color="#000080">:= </font>New<font color="#000080">(</font>pImportCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">50</font><font color="#000080">));
  </font>TheFuncs<font color="#000080">:= </font>New<font color="#000080">(</font>pStrCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">));
  </font>TheStructs<font color="#000080">:= </font>New<font color="#000080">(</font>pStrCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">));
  </font>TheTypeMap<font color="#000080">:= </font>New<font color="#000080">(</font>pTypeMapCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">));
  </font>TheModMap<font color="#000080">:= </font>New<font color="#000080">(</font>pStrCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DestroyCollections<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>Assigned<font color="#000080">(</font>TheImports<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dispose<font color="#000080">(</font>TheImports<font color="#000080">, </font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>TheFuncs<font color="#000080">)   </font><font color="#FF0000"><b>Then </b></font>Dispose<font color="#000080">(</font>TheFuncs<font color="#000080">,   </font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>TheStructs<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dispose<font color="#000080">(</font>TheStructs<font color="#000080">, </font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>TheTypeMap<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dispose<font color="#000080">(</font>TheTypeMap<font color="#000080">, </font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>TheModMap<font color="#000080">)  </font><font color="#FF0000"><b>Then </b></font>Dispose<font color="#000080">(</font>TheModMap<font color="#000080">,  </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddImport <font color="#000080">(</font>aName<font color="#000080">, </font>aDLL<font color="#000080">, </font>anOrd<font color="#000080">: </font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>anEntry<font color="#000080">: </font>pImportEntry<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>anEntry<font color="#000080">:= </font>New<font color="#000080">(</font>pImportEntry<font color="#000080">);
  </font>anEntry<font color="#000080">^.</font>TheName<font color="#000080">:= </font>StrNew<font color="#000080">(</font>aName<font color="#000080">);
  </font>anEntry<font color="#000080">^.</font>TheDLL<font color="#000080">:= </font>StrNew<font color="#000080">(</font>aDLL<font color="#000080">);
  </font>anEntry<font color="#000080">^.</font>TheOrd<font color="#000080">:=  </font>StrNew<font color="#000080">(</font>anOrd<font color="#000080">);
  </font>TheImports<font color="#000080">^.</font>Insert<font color="#000080">(</font>anEntry<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddFunc <font color="#000080">(</font>aName<font color="#000080">: </font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TheFuncs<font color="#000080">^.</font>Insert<font color="#000080">(</font>StrNew<font color="#000080">(</font>aName<font color="#000080">))
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddStruct <font color="#000080">(</font>aName<font color="#000080">: </font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TheStructs<font color="#000080">^.</font>Insert<font color="#000080">(</font>StrNew<font color="#000080">(</font>aName<font color="#000080">))
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddType <font color="#000080">(</font>aSrc<font color="#000080">, </font>aDst<font color="#000080">: </font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>anEntry<font color="#000080">: </font>pTypeMap<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>anEntry<font color="#000080">:= </font>New<font color="#000080">(</font>pTypeMap<font color="#000080">);
  </font>anEntry<font color="#000080">^.</font>F<font color="#000080">:= </font>StrNew<font color="#000080">(</font>aSrc<font color="#000080">);
  </font>anEntry<font color="#000080">^.</font>T<font color="#000080">:= </font>StrNew<font color="#000080">(</font>aDst<font color="#000080">);
  </font>TheTypeMap<font color="#000080">^.</font>Insert<font color="#000080">(</font>anEntry<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddMod <font color="#000080">(</font>aName<font color="#000080">: </font>pChar<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>TheModMap<font color="#000080">^.</font>Insert<font color="#000080">(</font>StrNew<font color="#000080">(</font>aName<font color="#000080">))
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetOrdDLL <font color="#000080">(</font>aName<font color="#000080">, </font>RetDLL<font color="#000080">, </font>RetOrd<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Index<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>TheImports<font color="#000080">^.</font>Search<font color="#000080">(</font>aName<font color="#000080">, </font>Index<font color="#000080">) </font><font color="#FF0000"><b>Then
    With </b></font>pImportEntry<font color="#000080">(</font>TheImports<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">))^ </font><font color="#FF0000"><b>Do Begin
      </b></font>GetOrdDLL<font color="#000080">:= </font>True<font color="#000080">;
      </font>StrCopy<font color="#000080">(</font>RetDLL<font color="#000080">, </font>TheDLL<font color="#000080">);
      </font>StrCopy<font color="#000080">(</font>RetOrd<font color="#000080">, </font>TheOrd<font color="#000080">)
    </font><font color="#FF0000"><b>End
  Else
    </b></font>GetOrdDLL<font color="#000080">:= </font>False
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadImports <font color="#000080">(</font>aFileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>aFile<font color="#000080">: </font>Text<font color="#000080">;
  </font>aLine<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">500</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>aName<font color="#000080">,
  </font>aDLL<font color="#000080">,
  </font>anOrd<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>aWord<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{$i-} </i></font>Assign<font color="#000080">(</font>aFile<font color="#000080">, </font>aFileName<font color="#000080">); </font>Reset<font color="#000080">(</font>aFile<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
  </font>HasImports<font color="#000080">:= </font>True<font color="#000080">;
  </font>StrCopy<font color="#000080">(</font>aDLL<font color="#000080">, </font><font color="#800000">'?'</font><font color="#000080">);
  </font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>aFile<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
    </b></font>GetLine<font color="#000080">(</font>aLine<font color="#000080">, </font>aFile<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>StrComp<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">'Library:'</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>ExtractWord<font color="#000080">(</font>aDLL<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
    </font><font color="#FF0000"><b>Else
    If </b></font>StrComp<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">),</font><font color="#800000">'exported,'</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
      </b></font>ExtractWord<font color="#000080">(</font>anOrd<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
      </font>ExtractWord<font color="#000080">(</font>aName<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
      </font>AddImport<font color="#000080">(</font>aName<font color="#000080">, </font>aDLL<font color="#000080">, </font>anOrd<font color="#000080">)
    </font><font color="#FF0000"><b>End
  End</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>aFile<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadIni<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>IniFile<font color="#000080">: </font>Text<font color="#000080">;
  </font>aStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>aLine<font color="#000080">, </font>Word1<font color="#000080">, </font>Word2<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>rm<font color="#000080">: (</font>rmNone<font color="#000080">, </font>rmTypeMap<font color="#000080">, </font>rmModMap<font color="#000080">);
  </font>p<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{$i-}
  </i></font>Assign<font color="#000080">(</font>IniFile<font color="#000080">, </font>H2PasIni<font color="#000080">); </font>Reset<font color="#000080">(</font>IniFile<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
    </b></font>Assign<font color="#000080">(</font>IniFile<font color="#000080">, </font>JustPath<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">))+</font><font color="#800000">'\'</font><font color="#000080">+</font>H2PasIni<font color="#000080">);
    </font>Reset<font color="#000080">(</font>IniFile<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>Exit
  <font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>rm<font color="#000080">:= </font>rmNone<font color="#000080">;
  </font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>IniFile<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
    </b></font>ReadLn<font color="#000080">(</font>IniFile<font color="#000080">, </font>aStr<font color="#000080">);
    </font>p<font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">';'</font><font color="#000080">, </font>aStr<font color="#000080">); </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>p<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>aStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font>Chr<font color="#000080">(</font>p<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>StrPCopy<font color="#000080">(</font>aLine<font color="#000080">, </font>aStr<font color="#000080">); </font>Trim<font color="#000080">(</font>aLine<font color="#000080">, </font>aLine<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>StrLen<font color="#000080">(</font>aLine<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>Continue<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>aLine<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'[' </font><font color="#FF0000"><b>Then Begin
      If </b></font>StrIComp<font color="#000080">(</font>aLine<font color="#000080">, </font><font color="#800000">'[TypeMap]'</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>rm<font color="#000080">:= </font>rmTypeMap <font color="#FF0000"><b>Else
      If </b></font>StrIComp<font color="#000080">(</font>aLine<font color="#000080">, </font><font color="#800000">'[ModMap]'</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>rm<font color="#000080">:= </font>rmModMap <font color="#FF0000"><b>Else
        </b></font>rm<font color="#000080">:= </font>rmNone<font color="#000080">;
      </font>Continue
    <font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>rm <font color="#FF0000"><b>Of
      </b></font>rmTypeMap<font color="#000080">: </font>AddType<font color="#000080">(</font>Trim<font color="#000080">(</font>Word1<font color="#000080">, </font>ExtractWord<font color="#000080">(</font>Word1<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">'='</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)),
                         </font>Trim<font color="#000080">(</font>Word2<font color="#000080">, </font>ExtractWord<font color="#000080">(</font>Word2<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">'='</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)));
      </font>rmModMap<font color="#000080">:  </font>AddMod<font color="#000080">(</font>aLine<font color="#000080">);
    </font><font color="#FF0000"><b>End
  End</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>IniFile<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Modifier <font color="#000080">(</font>aPart<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Index<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Modifier<font color="#000080">:= </font>TheModMap<font color="#000080">^.</font>Search<font color="#000080">(</font>aPart<font color="#000080">, </font>Index<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TypeConvert <font color="#000080">(</font>aDst<font color="#000080">, </font>aSrc<font color="#000080">: </font>pChar<font color="#000080">): </font>pChar<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>aWord<font color="#000080">, </font>ToParse<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>i<font color="#000080">, </font>anInt<font color="#000080">, </font>anError<font color="#000080">: </font>Integer<font color="#000080">;
  </font>aTemp<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>Index<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TypeConvert<font color="#000080">:= </font>aDst<font color="#000080">;
  </font>aDst<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
  </font>ExtractWord<font color="#000080">(</font>aTemp<font color="#000080">, </font>aSrc<font color="#000080">, </font><font color="#800000">'[]'</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>StrLen<font color="#000080">(</font>aTemp<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
    </b></font>Val<font color="#000080">(</font>aTemp<font color="#000080">, </font>anInt<font color="#000080">, </font>anError<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>anError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
      </b></font>Str<font color="#000080">(</font>anInt<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font>aTemp<font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aDst<font color="#000080">,</font><font color="#800000">'Array[0..'</font><font color="#000080">), </font>aTemp<font color="#000080">),</font><font color="#800000">'] Of '</font><font color="#000080">);
    </font><font color="#FF0000"><b>End Else
      </b></font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aDst<font color="#000080">,</font><font color="#800000">'?'</font><font color="#000080">), </font>aTemp<font color="#000080">),</font><font color="#800000">'?'</font><font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>ExtractWord<font color="#000080">(</font>ToParse<font color="#000080">, </font>aSrc<font color="#000080">, </font><font color="#800000">'[]'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>aTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>WordCount<font color="#000080">(</font>ToParse<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
    </b></font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>ToParse<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'*' </font><font color="#FF0000"><b>Then Begin
      </b></font>StrCat<font color="#000080">(</font>aTemp<font color="#000080">,</font><font color="#800000">'* '</font><font color="#000080">);
      </font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;
      </font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>And Not </b></font>Modifier<font color="#000080">(</font>aWord<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aTemp<font color="#000080">, </font>aWord<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>Trim<font color="#000080">(</font>aTemp<font color="#000080">, </font>aTemp<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>TheTypeMap<font color="#000080">^.</font>Search<font color="#000080">(@</font>aTemp<font color="#000080">, </font>Index<font color="#000080">) </font><font color="#FF0000"><b>Then
    With </b></font>pTypeMap<font color="#000080">(</font>TheTypeMap<font color="#000080">^.</font>At<font color="#000080">(</font>Index<font color="#000080">))^ </font><font color="#FF0000"><b>Do
      </b></font>StrCopy<font color="#000080">(</font>aTemp<font color="#000080">, </font>T<font color="#000080">);
  </font>StrCat<font color="#000080">(</font>aDst<font color="#000080">, </font>aTemp<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>IdMax <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>tIdTable <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>IdMax<font color="#000080">] </font><font color="#FF0000"><b>Of
    Record
      </b></font>TheId<font color="#000080">,
      </font>TheType<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
      </font>TheComment<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">300</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char
    <font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>IdCnt<font color="#000080">: </font>Integer<font color="#000080">;
  </font>IdTable<font color="#000080">: </font>tIdTable<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>InitId<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>IdCnt<font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>AddId <font color="#000080">(</font>anId<font color="#000080">, </font>aType<font color="#000080">, </font>aComment<font color="#000080">: </font>pChar<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
    If </b></font>IdCnt<font color="#000080">=</font>IdMax <font color="#FF0000"><b>Then Begin
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error: Id Table full. HALT.'</font><font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>IdCnt<font color="#000080">);
    </font><font color="#FF0000"><b>With </b></font>IdTable<font color="#000080">[</font>IdCnt<font color="#000080">] </font><font color="#FF0000"><b>Do Begin
      </b></font>Trim<font color="#000080">(</font>TheId<font color="#000080">, </font>anId<font color="#000080">);
      </font>TypeConvert<font color="#000080">(</font>TheType<font color="#000080">, </font>aType<font color="#000080">);
      </font>Trim<font color="#000080">(</font>TheComment<font color="#000080">, </font>aComment<font color="#000080">)
    </font><font color="#FF0000"><b>End
  End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ParseComment<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Inf<font color="#000080">: </font>Text<font color="#000080">; </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>aWord<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">40</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>ParseComment<font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>StrPos<font color="#000080">(</font>StrLCopy<font color="#000080">(</font>aWord<font color="#000080">, </font>InStr<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">),</font><font color="#800000">'/*'</font><font color="#000080">)=</font><font color="#FF0000"><b>Nil Then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>StrPos<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">'*/'</font><font color="#000080">)=</font><font color="#FF0000"><b>Nil Do Begin
      </b></font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>InStr<font color="#000080">);
      </font>GetLine<font color="#000080">(</font>InStr<font color="#000080">, </font>Inf<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>InStr<font color="#000080">);
    </font>ParseComment<font color="#000080">:= </font>True
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ParseDefine<font color="#000080">(</font>InStr<font color="#000080">, </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Const
    </b></font>DefineDelim <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>aWord<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">512</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font>Rest<font color="#000080">, </font>p<font color="#000080">: </font>pChar<font color="#000080">;
    </font>isConst<font color="#000080">: </font>Boolean<font color="#000080">;
    </font>i<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>ParseDefine<font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>WordCount<font color="#000080">(</font>InStr<font color="#000080">, </font>DefineDelim<font color="#000080">)&lt;</font><font color="#800000">3 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>If  </b></font><font color="#000080">(</font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>InStr<font color="#000080">, </font>DefineDelim<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
    </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">'#define'</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>isConst<font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>WhichBlock<font color="#000080">&lt;&gt;</font>InConst <font color="#FF0000"><b>Then
        </b></font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">,</font>CRLF<font color="#000080">+</font><font color="#800000">'Const'</font><font color="#000080">+</font>CRLF<font color="#000080">+</font><font color="#800000">'  '</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else
        </b></font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">);
      </font>ExtractWord<font color="#000080">(</font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">), </font>InStr<font color="#000080">, </font>DefineDelim<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>OutStr<font color="#000080">, </font>OutStr<font color="#000080">, </font><font color="#800000">35</font><font color="#000080">), </font><font color="#800000">'= '</font><font color="#000080">);
      </font>Rest<font color="#000080">:= </font>WordPosition<font color="#000080">(</font>InStr<font color="#000080">, </font>DefineDelim<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
      </font>StrCopy<font color="#000080">(</font>aWord<font color="#000080">, </font>Rest<font color="#000080">);
      </font>p<font color="#000080">:= </font>StrPos<font color="#000080">(</font>aWord<font color="#000080">,</font><font color="#800000">'/*'</font><font color="#000080">); </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>p<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>StrLen<font color="#000080">(</font>aWord<font color="#000080">)&gt;</font><font color="#800000">15 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
      </font>p<font color="#000080">:= </font>StrPos<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">'0x'</font><font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
        </b></font>isConst<font color="#000080">:= </font>True<font color="#000080">;
        </font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;
        </font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:= </font><font color="#800000">'$'</font><font color="#000080">;
        </font>p<font color="#000080">:= </font>StrPos<font color="#000080">(</font>p<font color="#000080">, </font><font color="#800000">'0x'</font><font color="#000080">)
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">'L'</font><font color="#000080">);  </font><font color="#008000"><i>{get rid of the f*cking 'L'}
      </i></font><font color="#FF0000"><b>While </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
        If </b></font><font color="#000080">(</font>p<font color="#000080">&gt;</font>aWord<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
          </b></font>Dec<font color="#000080">(</font>p<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>p<font color="#000080">^ </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'F'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'f'</font><font color="#000080">] </font><font color="#FF0000"><b>Then Begin
            </b></font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:= </font><font color="#800000">' '</font><font color="#000080">;
            </font>IsConst<font color="#000080">:= </font>True
          <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>Inc<font color="#000080">(</font>p<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">'L'</font><font color="#000080">)
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If Not </b></font>IsConst <font color="#FF0000"><b>Then
        For </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font>StrLen<font color="#000080">(</font>aWord<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>Do
          If </b></font>aWord<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">] </font><font color="#FF0000"><b>Then Begin
            </b></font>IsConst<font color="#000080">:= </font>True<font color="#000080">;
            </font>Break
          <font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If Not </b></font>IsConst <font color="#FF0000"><b>Then
        </b></font>Exit<font color="#000080">;
      </font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>aWord<font color="#000080">), </font><font color="#800000">';'</font><font color="#000080">);
      </font>p<font color="#000080">:= </font>StrPos<font color="#000080">(</font>Rest<font color="#000080">,</font><font color="#800000">'/*'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>OutStr<font color="#000080">,</font>OutStr<font color="#000080">, </font><font color="#800000">60</font><font color="#000080">), </font>p<font color="#000080">);
      </font>WhichBlock<font color="#000080">:= </font>InConst<font color="#000080">;
      </font>ParseDefine<font color="#000080">:= </font>True
    <font color="#FF0000"><b>End
  End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ParseStruct<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Inf<font color="#000080">: </font>Text<font color="#000080">; </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>aWord<font color="#000080">,
    </font>aComment<font color="#000080">,
    </font>RecComment<font color="#000080">,
    </font>RecName<font color="#000080">,
    </font>anId<font color="#000080">, </font>aType<font color="#000080">,
    </font>Rest<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">300</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font>possibleArray<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font>p<font color="#000080">, </font>cp<font color="#000080">: </font>pChar<font color="#000080">;
    </font>i<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>ParseStruct<font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>If  </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>Instr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">), </font><font color="#800000">'struct'</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>Instr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">), </font><font color="#800000">'struct'</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;
    </font>p<font color="#000080">:= </font>Instr<font color="#000080">;
    </font>Instr<font color="#000080">:= </font>StrScan<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">'{'</font><font color="#000080">);
    </font><font color="#FF0000"><b>If Not </b></font>Assigned<font color="#000080">(</font>InStr<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;

    </font><font color="#008000"><i>{-try to parse the structure}
    </i></font>InStr<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;
    </font>ExtractWord<font color="#000080">(</font>RecName<font color="#000080">, </font>p<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>WordCount<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">));
    </font>Inc<font color="#000080">(</font>InStr<font color="#000080">);
    </font>Trim<font color="#000080">(</font>InStr<font color="#000080">, </font>InStr<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>InStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>InStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>StrCopy<font color="#000080">(</font>RecComment<font color="#000080">, </font>InStr<font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>RecComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
    </font>InStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>InStr<font color="#000080">);
    </font>cp<font color="#000080">:= </font>InStr<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>GetLine<font color="#000080">(</font>cp<font color="#000080">, </font>Inf<font color="#000080">);
      </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>cp<font color="#000080">, </font><font color="#800000">'}'</font><font color="#000080">);
      </font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>cp<font color="#000080">);
      </font>cp<font color="#000080">^:= </font><font color="#800000">' '</font><font color="#000080">; </font>Inc<font color="#000080">(</font>cp<font color="#000080">); </font>cp<font color="#000080">^:= </font><font color="#800000">#0
    </font><font color="#FF0000"><b>Until </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>WordCount<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">' ;'</font><font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>ExtractWord<font color="#000080">(</font>RecName<font color="#000080">, </font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">' ;'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>pChar<font color="#000080">(</font>p<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)^:= </font><font color="#800000">#0</font><font color="#000080">;
    </font>InitId<font color="#000080">;
    </font>p<font color="#000080">:= </font>InStr<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>cp<font color="#000080">:= </font>p<font color="#000080">;
      </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>p<font color="#000080">, </font><font color="#800000">';'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
        </b></font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>ExtractWord<font color="#000080">(</font>aWord<font color="#000080">, </font>cp<font color="#000080">, </font><font color="#800000">';'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">));
        </font><font color="#008000"><i>{extract possible comment}
        </i></font>cp<font color="#000080">:= </font>StrPos<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">'/*'</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>cp<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
          </b></font>StrCopy<font color="#000080">(</font>aComment<font color="#000080">, </font>cp<font color="#000080">);
          </font>cp<font color="#000080">^:= </font><font color="#800000">#0
        </font><font color="#FF0000"><b>End Else
          </b></font>aComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
        </font><font color="#008000"><i>{-extract id and type}
        </i></font>cp<font color="#000080">:= </font>WordPosition<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">' *'</font><font color="#000080">, </font>WordCount<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">' *'</font><font color="#000080">)); </font><font color="#008000"><i>{last word}
        </i></font>StrCopy<font color="#000080">(</font>anId<font color="#000080">, </font>cp<font color="#000080">);
        </font>ExtractWord<font color="#000080">(</font>possibleArray<font color="#000080">, </font>anId<font color="#000080">,</font><font color="#800000">'[]'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font>ExtractWord<font color="#000080">(</font>anId<font color="#000080">, </font>anId<font color="#000080">, </font><font color="#800000">'[]'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>cp<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;
        </font>StrCopy<font color="#000080">(</font>aType<font color="#000080">, </font>aWord<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>StrLen<font color="#000080">(</font>possibleArray<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
          </b></font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aType<font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">),</font>possibleArray<font color="#000080">),</font><font color="#800000">']'</font><font color="#000080">);
        </font><font color="#008000"><i>{-extract comment if after ';'}
        </i></font>Inc<font color="#000080">(</font>p<font color="#000080">);
        </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>p<font color="#000080">);
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
          </b></font><font color="#008000"><i>{append comment}
          </i></font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aComment<font color="#000080">);
          </font><font color="#FF0000"><b>Repeat
            </b></font>cp<font color="#000080">^:= </font>p<font color="#000080">^;
            </font>Inc<font color="#000080">(</font>p<font color="#000080">);
            </font>Inc<font color="#000080">(</font>cp<font color="#000080">)
          </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">((</font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">));
          </font>cp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">; </font>StrCat<font color="#000080">(</font>Trim<font color="#000080">(</font>aComment<font color="#000080">, </font>aComment<font color="#000080">),</font><font color="#800000">' */'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>p<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
            </b></font>Inc<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>p<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>AddId<font color="#000080">(</font>anId<font color="#000080">, </font>aType<font color="#000080">, </font>aComment<font color="#000080">)
      </font><font color="#FF0000"><b>End
    Until Not </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">);

    </font><font color="#008000"><i>{-output the structure}
    </i></font><font color="#FF0000"><b>If </b></font>WhichBlock<font color="#000080">&lt;&gt;</font>InType <font color="#FF0000"><b>Then Begin
      </b></font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">,</font>CRLF<font color="#000080">+</font><font color="#800000">'Type'</font><font color="#000080">+</font>CRLF<font color="#000080">);
      </font>OutStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">);
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>RecName<font color="#000080">);
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">' = Record'</font><font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>RecComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
      </b></font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>OutStr<font color="#000080">, </font>OutStr<font color="#000080">, </font><font color="#800000">40</font><font color="#000080">), </font>RecComment<font color="#000080">);
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font>CRLF<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>IdCnt <font color="#FF0000"><b>Do Begin
      </b></font>OutStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">);
      </font><font color="#FF0000"><b>With </b></font>IdTable<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>Do Begin
        </b></font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">'    '</font><font color="#000080">);
        </font><font color="#008000"><i>{If StrIComp(TheId, TheType)=0 Then StrCat(OutStr, '_');} {it works as is}
        </i></font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>TheId<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>IdCnt<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>IdTable<font color="#000080">[</font>i<font color="#000080">].</font>TheType<font color="#000080">, </font>IdTable<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">].</font>TheType<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
          </b></font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">', '</font><font color="#000080">)
        </font><font color="#FF0000"><b>Else Begin
          </b></font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">': '</font><font color="#000080">),</font>TheType<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>i<font color="#000080">&lt;</font>IdCnt <font color="#FF0000"><b>Then
            </b></font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">'; '</font><font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>TheComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then Begin
          </b></font>Pad<font color="#000080">(</font>OutStr<font color="#000080">, </font>OutStr<font color="#000080">, </font><font color="#800000">40</font><font color="#000080">);
          </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>TheComment<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font>CRLF<font color="#000080">)
      </font><font color="#FF0000"><b>End
    End</b></font><font color="#000080">;
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">,</font><font color="#800000">'  End;'</font><font color="#000080">);
    </font>AddStruct<font color="#000080">(</font>RecName<font color="#000080">);
    </font>WhichBlock<font color="#000080">:= </font>InType<font color="#000080">;
    </font>ParseStruct<font color="#000080">:= </font>True
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>ParseAPI<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Inf<font color="#000080">: </font>Text<font color="#000080">; </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>FHead<font color="#000080">,
    </font>aWord<font color="#000080">,
    </font>Res<font color="#000080">,
    </font>FuncComment<font color="#000080">,
    </font>FuncName<font color="#000080">,
    </font>anId<font color="#000080">, </font>aType<font color="#000080">, </font>aComment<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font>p<font color="#000080">, </font>cp<font color="#000080">, </font>cp2<font color="#000080">, </font>pStart<font color="#000080">: </font>pChar<font color="#000080">;
    </font>i<font color="#000080">, </font>Indent<font color="#000080">: </font>Integer<font color="#000080">;
    </font>IsFunc<font color="#000080">: </font>Boolean<font color="#000080">;
    </font>Unknown<font color="#000080">: </font>Integer<font color="#000080">;

    </font><font color="#FF0000"><b>Function </b></font>ParseWordAndComment <font color="#000080">(</font>aComment<font color="#000080">, </font>aWord<font color="#000080">, </font>Src<font color="#000080">: </font>pChar<font color="#000080">; </font>Delim<font color="#000080">: </font>Char<font color="#000080">): </font>pChar<font color="#000080">;
    </font><font color="#008000"><i>{parse Src, search for delim. append comments to aComment, source to aWord}
    </i></font><font color="#FF0000"><b>Var
      </b></font>cp<font color="#000080">: </font>pChar<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      Repeat
        While </b></font>Src<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">);
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
          </b></font><font color="#008000"><i>{append comment}
          </i></font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aComment<font color="#000080">);
          </font><font color="#FF0000"><b>Repeat
            </b></font>cp<font color="#000080">^:= </font>Src<font color="#000080">^;
            </font>Inc<font color="#000080">(</font>Src<font color="#000080">);
            </font>Inc<font color="#000080">(</font>cp<font color="#000080">)
          </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">((</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">));
          </font>cp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">; </font>StrCat<font color="#000080">(</font>Trim<font color="#000080">(</font>aComment<font color="#000080">, </font>aComment<font color="#000080">),</font><font color="#800000">' */'</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
            </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>While </b></font>Src<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aWord<font color="#000080">);
        </font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>Src<font color="#000080">^ </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">]) </font><font color="#FF0000"><b>Do Begin
          </b></font>cp<font color="#000080">^:= </font>Src<font color="#000080">^; </font>Inc<font color="#000080">(</font>Src<font color="#000080">); </font>Inc<font color="#000080">(</font>cp<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>cp<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>Src<font color="#000080">^=</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then Begin
          </b></font>ParseWordAndComment<font color="#000080">:= </font>Src<font color="#000080">;
          </font>Exit
        <font color="#FF0000"><b>End
      Until </b></font>Src<font color="#000080">^=</font><font color="#800000">','</font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>Src<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font>Src<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>Do Begin
        </b></font><font color="#008000"><i>{append comment}
        </i></font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>aComment<font color="#000080">);
        </font><font color="#FF0000"><b>Repeat
          </b></font>cp<font color="#000080">^:= </font>Src<font color="#000080">^;
          </font>Inc<font color="#000080">(</font>Src<font color="#000080">);
          </font>Inc<font color="#000080">(</font>cp<font color="#000080">)
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">((</font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Src<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'/'</font><font color="#000080">));
        </font>cp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">; </font>StrCat<font color="#000080">(</font>Trim<font color="#000080">(</font>aComment<font color="#000080">, </font>aComment<font color="#000080">),</font><font color="#800000">' */'</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>Src<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
          </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>While </b></font>Src<font color="#000080">^=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>Src<font color="#000080">)
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>ParseWordAndComment<font color="#000080">:= </font>Src
    <font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>ParseAPI<font color="#000080">:= </font>False<font color="#000080">;
    </font>IsFunc<font color="#000080">:= </font>False<font color="#000080">;
    </font>FuncName<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
    </font>Res<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrPos<font color="#000080">(</font>InStr<font color="#000080">,</font><font color="#800000">'typedef'</font><font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>StrPos<font color="#000080">(</font>InStr<font color="#000080">,</font><font color="#800000">'#define'</font><font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>StrPos<font color="#000080">(</font>InStr<font color="#000080">,</font><font color="#800000">'#if'</font><font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>StrPos<font color="#000080">(</font>InStr<font color="#000080">,</font><font color="#800000">'#el'</font><font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
    </font>pStart<font color="#000080">:= </font>StrScan<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">);
    </font><font color="#FF0000"><b>If Not </b></font>Assigned<font color="#000080">(</font>pStart<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
    </font>pStart<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;
    </font>Trim<font color="#000080">(</font>FuncName<font color="#000080">, </font>ExtractWord<font color="#000080">(</font>FuncName<font color="#000080">, </font>InStr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>WordCount<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">)));
    </font>cp<font color="#000080">:= </font>WordPosition<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>WordCount<font color="#000080">(</font>InStr<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font>Assigned<font color="#000080">(</font>cp<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>cp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>Trim<font color="#000080">(</font>Res<font color="#000080">, </font>TypeConvert<font color="#000080">(</font>Res<font color="#000080">, </font>InStr<font color="#000080">))
    </font><font color="#FF0000"><b>End Else
      </b></font>StrCopy<font color="#000080">(</font>Res<font color="#000080">, </font><font color="#800000">'?????'</font><font color="#000080">);
    </font>InStr<font color="#000080">:= </font>pStart<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>cp<font color="#000080">:= </font>InStr<font color="#000080">;
    </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>cp<font color="#000080">, </font><font color="#800000">';'</font><font color="#000080">);
    </font><font color="#FF0000"><b>While Not </b></font>Assigned<font color="#000080">(</font>p<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
      </b></font>cp<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>cp<font color="#000080">);
      </font>cp<font color="#000080">^:= </font><font color="#800000">' '</font><font color="#000080">; </font>Inc<font color="#000080">(</font>cp<font color="#000080">);
      </font>GetLine<font color="#000080">(</font>cp<font color="#000080">, </font>Inf<font color="#000080">);
      </font>p<font color="#000080">:= </font>StrScan<font color="#000080">(</font>cp<font color="#000080">, </font><font color="#800000">';'</font><font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>StrCopy<font color="#000080">(</font>FuncComment<font color="#000080">, </font>p<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>Repeat
      </b></font>Dec<font color="#000080">(</font>p<font color="#000080">)
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>p<font color="#000080">&lt;=</font>InStr<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>p<font color="#000080">^=</font><font color="#800000">')'</font><font color="#000080">);
    </font>p<font color="#000080">^:= </font><font color="#800000">#0</font><font color="#000080">;

    </font>InitId<font color="#000080">;
    </font>Unknown<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>p<font color="#000080">:= </font>InStr<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>p<font color="#000080">^&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Do Begin
      </b></font>aComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>p<font color="#000080">:= </font>ParseWordAndComment<font color="#000080">(</font>aComment<font color="#000080">, </font>aWord<font color="#000080">, </font>p<font color="#000080">, </font><font color="#800000">','</font><font color="#000080">);
      </font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">);
      </font>TypeConvert<font color="#000080">(</font>aType<font color="#000080">, </font>aWord<font color="#000080">);
      </font>anId<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
      </font>cp<font color="#000080">:= </font>WordPosition<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">' *'</font><font color="#000080">, </font>WordCount<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">' *'</font><font color="#000080">)); </font><font color="#008000"><i>{last word}
      </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>WordCount<font color="#000080">(</font>aWord<font color="#000080">,</font><font color="#800000">' *'</font><font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Assigned<font color="#000080">(</font>cp<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>cp<font color="#000080">, </font>TypeConvert<font color="#000080">(</font>aType<font color="#000080">, </font>cp<font color="#000080">))&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>Then Begin
      </b></font><font color="#008000"><i>{non-Ansi declaration}
        </i></font>Inc<font color="#000080">(</font>Unknown<font color="#000080">);
        </font>Str<font color="#000080">(</font>Unknown<font color="#000080">, </font>anId<font color="#000080">);
        </font>Move<font color="#000080">(</font>anId<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>anId<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>StrLen<font color="#000080">(</font>anId<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
        </font>anId<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">'P'</font><font color="#000080">; </font>anId<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:= </font><font color="#800000">'a'</font><font color="#000080">; </font>anId<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:= </font><font color="#800000">'r'</font><font color="#000080">;
      </font><font color="#FF0000"><b>End Else Begin
        If </b></font>Assigned<font color="#000080">(</font>cp<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
          </b></font>StrCopy<font color="#000080">(</font>anId<font color="#000080">, </font>cp<font color="#000080">);
          </font>cp<font color="#000080">^:= </font><font color="#800000">#0
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>TypeConvert<font color="#000080">(</font>aType<font color="#000080">, </font>aWord<font color="#000080">)
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>AddId<font color="#000080">(</font>anId<font color="#000080">, </font>aType<font color="#000080">, </font>aComment<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">, </font><font color="#800000">'  Function '</font><font color="#000080">);
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>FuncName<font color="#000080">);
    </font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font><font color="#800000">' ('</font><font color="#000080">);
    </font>Indent<font color="#000080">:= </font>StrLen<font color="#000080">(</font>OutStr<font color="#000080">);
    </font>OutStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">);
    </font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>IdCnt <font color="#FF0000"><b>Do
      With </b></font>IdTable<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>Do Begin
        </b></font>StrCat<font color="#000080">(</font>aWord<font color="#000080">, </font>TheId<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>i<font color="#000080">&lt;</font>IdCnt<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>StrIComp<font color="#000080">(</font>IdTable<font color="#000080">[</font>i<font color="#000080">].</font>TheType<font color="#000080">, </font>IdTable<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">].</font>TheType<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
          </b></font>StrCat<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">', '</font><font color="#000080">)
        </font><font color="#FF0000"><b>Else Begin
          </b></font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">': '</font><font color="#000080">), </font>TheType<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>i<font color="#000080">&lt;</font>IdCnt <font color="#FF0000"><b>Then </b></font>StrCat<font color="#000080">(</font>aWord<font color="#000080">, </font><font color="#800000">'; '</font><font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Trim<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>TheComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>Then
          </b></font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>aWord<font color="#000080">, </font>aWord<font color="#000080">, </font><font color="#800000">60</font><font color="#000080">-</font>Indent<font color="#000080">), </font>TheComment<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Indent<font color="#000080">+</font>StrLen<font color="#000080">(</font>aWord<font color="#000080">)&gt;</font><font color="#800000">90</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>TheComment<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;&gt;</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then Begin
          </b></font>StrCopy<font color="#000080">(</font>OutStr<font color="#000080">, </font>aWord<font color="#000080">); </font>OutStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>i<font color="#000080">&lt;</font>IdCnt <font color="#FF0000"><b>Then Begin
            </b></font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>CRLF<font color="#000080">);
            </font>Pad<font color="#000080">(</font>OutStr<font color="#000080">, </font>OutStr<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Indent<font color="#000080">)
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>OutStr<font color="#000080">:= </font>StrEnd<font color="#000080">(</font>OutStr<font color="#000080">);
          </font>aWord<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0
        </font><font color="#FF0000"><b>End
      End</b></font><font color="#000080">;
    </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>OutStr<font color="#000080">, </font>aWord<font color="#000080">),</font><font color="#800000">'): '</font><font color="#000080">), </font>Res<font color="#000080">),</font><font color="#800000">';'</font><font color="#000080">), </font>FuncComment<font color="#000080">);
    </font>AddFunc<font color="#000080">(</font>FuncName<font color="#000080">);
    </font>WhichBlock<font color="#000080">:= </font>InFunc<font color="#000080">;
    </font>ParseAPI<font color="#000080">:= </font>True
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>GenerateReport <font color="#000080">(</font><font color="#FF0000"><b>Var Out</b></font><font color="#000080">: </font>Text<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>RepFunc <font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>aDLL<font color="#000080">, </font>anOrd<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
      </font>aLine<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>StrCopy<font color="#000080">(</font>aDLL<font color="#000080">,</font><font color="#800000">'?'</font><font color="#000080">);
      </font>StrCopy<font color="#000080">(</font>anOrd<font color="#000080">, </font><font color="#800000">'?'</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>HasImports <font color="#FF0000"><b>Then
        </b></font>GetOrdDLL<font color="#000080">(</font>Item<font color="#000080">, </font>aDLL<font color="#000080">, </font>anOrd<font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCopy<font color="#000080">(</font>aLine<font color="#000080">,</font><font color="#800000">'  Function '</font><font color="#000080">), </font>pChar<font color="#000080">(</font>Item<font color="#000080">)),</font><font color="#800000">';'</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>aLine<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">42</font><font color="#000080">),</font><font color="#800000">'External '''</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aLine<font color="#000080">, </font>aDLL<font color="#000080">), </font><font color="#800000">''''</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>aLine<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">62</font><font color="#000080">),</font><font color="#800000">'Index '</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>Pad<font color="#000080">(</font>aLine<font color="#000080">, </font>aLine<font color="#000080">, </font><font color="#800000">72</font><font color="#000080">-</font>StrLen<font color="#000080">(</font>anOrd<font color="#000080">)), </font>anOrd<font color="#000080">),</font><font color="#800000">';'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font>aLine<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>VeriPascal <font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>aLine<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
      </font>aName<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Pad<font color="#000080">(</font>aName<font color="#000080">, </font>Item<font color="#000080">, </font><font color="#800000">35</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCopy<font color="#000080">(</font>aLine<font color="#000080">,</font><font color="#800000">'  veri('''</font><font color="#000080">), </font>aName<font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aLine<font color="#000080">,</font><font color="#800000">''',sizeof('</font><font color="#000080">),</font>aName<font color="#000080">),</font><font color="#800000">'));'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font>aLine<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>VeriC <font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>aLine<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
      </font>aName<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">60</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Pad<font color="#000080">(</font>aName<font color="#000080">, </font>Item<font color="#000080">, </font><font color="#800000">35</font><font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCopy<font color="#000080">(</font>aLine<font color="#000080">,</font><font color="#800000">'  veri(&quot;'</font><font color="#000080">), </font>aName<font color="#000080">);
      </font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>StrCat<font color="#000080">(</font>aLine<font color="#000080">,</font><font color="#800000">'&quot;,sizeof('</font><font color="#000080">),</font>aName<font color="#000080">),</font><font color="#800000">'));'</font><font color="#000080">);
      </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font>aLine<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font><font color="#800000">'Implementation'</font><font color="#000080">);
    </font>TheFuncs<font color="#000080">^.</font>ForEach<font color="#000080">(@</font>RepFunc<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font><font color="#800000">'End.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font><font color="#800000">'--- snip --- snip --- snip ---'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font>CRLF<font color="#000080">+</font>CRLF<font color="#000080">+</font><font color="#800000">'{Pascal verification program for '</font><font color="#000080">+</font>Dstname<font color="#000080">+</font><font color="#800000">' }'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'Program VeriP;'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'Uses'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'  '</font><font color="#000080">+</font>DstName<font color="#000080">+</font><font color="#800000">';'</font><font color="#000080">+</font>CRLF<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'Procedure Veri (aStr: pChar; aSize: Integer);'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'Begin'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'  WriteLn(''Size of '',aStr,''= '',aSize:5);'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'End;'</font><font color="#000080">+</font>CRLF<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'Begin'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'  WriteLn(''verification of '</font><font color="#000080">+</font>DstName<font color="#000080">+</font><font color="#800000">' for Pascal:'');'</font><font color="#000080">);
    </font>TheStructs<font color="#000080">^.</font>ForEach<font color="#000080">(@</font>VeriPascal<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'End.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font>CRLF<font color="#000080">+</font>CRLF<font color="#000080">+</font><font color="#800000">'/* C verification program for '</font><font color="#000080">+</font>DstName<font color="#000080">+</font><font color="#800000">' */'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'#include &lt;stdio.h&gt;'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'#include &quot;'</font><font color="#000080">+</font>DstName<font color="#000080">+</font><font color="#800000">'.h&quot;'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'void veri (char *aStr, int aSize)'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'{ printf(&quot;Size of %s= %5i\n&quot;,aStr,aSize); }'</font><font color="#000080">+</font>CRLF<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'void main (void)'</font><font color="#000080">+</font>CRLF<font color="#000080">+
                </font><font color="#800000">'{ printf(&quot;verification of '</font><font color="#000080">+</font>DstName<font color="#000080">+</font><font color="#800000">' for C:\n&quot;);'</font><font color="#000080">);
    </font>TheStructs<font color="#000080">^.</font>ForEach<font color="#000080">(@</font>VeriC<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">'}'</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>LineBufSize <font color="#000080">= </font><font color="#800000">5000</font><font color="#000080">;
  </font>IoBufSize   <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">*</font><font color="#800000">1024</font><font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>IoBuf <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>IoBufSize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
  </font>pIoBuf <font color="#000080">= ^</font>IoBuf<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Inf<font color="#000080">, </font><font color="#FF0000"><b>Out</b></font><font color="#000080">: </font>Text<font color="#000080">;
  </font>InStr<font color="#000080">,
  </font>OutStr<font color="#000080">: </font>pChar<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>WriteLn<font color="#000080">(</font>Version<font color="#000080">,</font><font color="#800000">', written 1993 by P. Sawatzki'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>ParamCount <font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>Then Begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Usage: H2Pas InFile OutFile [ImportList]'</font><font color="#000080">);
    </font>Halt
  <font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>CreateCollections<font color="#000080">;
  </font>ReadIni<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>Then
    </b></font>Imports<font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Imports<font color="#000080">:= </font>JustName<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">))+</font><font color="#800000">'.Imp'</font><font color="#000080">;
  </font><font color="#008000"><i>{$i-}
  </i></font>Assign<font color="#000080">(</font>Inf<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)); </font>Reset<font color="#000080">(</font>Inf<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Fatal<font color="#000080">(</font><font color="#800000">'Input file not found'</font><font color="#000080">);
  </font>Assign<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)); </font>ReWrite<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>IoResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Fatal<font color="#000080">(</font><font color="#800000">'Unable to create output file'</font><font color="#000080">);
  </font>DstName<font color="#000080">:= </font>JustName<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
  </font>GetMem<font color="#000080">(</font>InStr<font color="#000080">,  </font>LineBufSize<font color="#000080">);
  </font>GetMem<font color="#000080">(</font>OutStr<font color="#000080">, </font>LineBufSize<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Processing files...'</font><font color="#000080">);
  </font>HeaderInfo<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>Inf<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
    </b></font>GetLine<font color="#000080">(</font>InStr<font color="#000080">, </font>Inf<font color="#000080">);
    </font>OutStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">#0</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>ParseComment<font color="#000080">(</font>Inf<font color="#000080">, </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font>ParseDefine<font color="#000080">(</font>InStr<font color="#000080">, </font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font>ParseStruct<font color="#000080">(</font>Inf<font color="#000080">, </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font>ParseAPI<font color="#000080">(</font>Inf<font color="#000080">, </font>InStr<font color="#000080">, </font>OutStr<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>OutLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>OutStr<font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>OutLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>InStr<font color="#000080">)
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Done.'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Reading import file '</font><font color="#000080">,</font>Imports<font color="#000080">,</font><font color="#800000">'...'</font><font color="#000080">);
  </font>ReadImports<font color="#000080">(</font>Imports<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>HasImports <font color="#FF0000"><b>Then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Done.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Not found.'</font><font color="#000080">+</font>CRLF<font color="#000080">+
            </font><font color="#800000">'(generate an import file using &quot;EXEHDR File.DLL &gt;'</font><font color="#000080">+</font>JustName<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">))+
            </font><font color="#800000">'.Imp&quot;)'</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Appending report...'</font><font color="#000080">);
  </font>GenerateReport<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Done.'</font><font color="#000080">);
  </font>DestroyCollections<font color="#000080">;
  </font>FreeMem<font color="#000080">(</font>InStr<font color="#000080">,  </font>LineBufSize<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>OutStr<font color="#000080">, </font>LineBufSize<font color="#000080">);
  </font>Close<font color="#000080">(</font>Inf<font color="#000080">);
  </font>Close<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -------------  INFO ON THIS PROGRAM ------------------ }

</i></font>ReadMe<font color="#000080">.</font>Txt <font color="#FF0000"><b>for </b></font>H2Pas
<font color="#000080">====================

</font>H2Pas <font color="#FF0000"><b>is </b></font>a quick <font color="#FF0000"><b>and </b></font>dirty hack <font color="#FF0000"><b>to </b></font>convert C<font color="#000080">-</font>Header files <font color="#FF0000"><b>to Pascal </b></font>units<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you make modifications<font color="#000080">, </font>please drop me a copy at
  Peter Sawatzki<font color="#000080">, </font>CompuServe <font color="#800000">100031</font><font color="#000080">,</font><font color="#800000">3002

</font><font color="#FF0000"><b>In </b></font>it<font color="#800000">'s current implementation (1.20) H2Pas does the following:

</font><font color="#000080">- </font>convert structs
<font color="#000080">- </font>convert constant defines
<font color="#000080">- </font>convert <font color="#FF0000"><b>procedure</b></font><font color="#000080">/</font><font color="#FF0000"><b>function </b></font>headers
<font color="#000080">- </font><font color="#800000">'convert' </font>comments <font color="#FF0000"><b>of </b></font>style <font color="#000080">/* </font>xxxx <font color="#000080">*/ </font><font color="#FF0000"><b>to </b></font><font color="#008000"><i>{ xxxx }
  </i></font><font color="#FF0000"><b>and </b></font>comments <font color="#FF0000"><b>of </b></font>style <font color="#008000"><i>// yyyy to { yyy }
</i></font><font color="#000080">- </font>make use <font color="#FF0000"><b>of </b></font>IMPort files <font color="#FF0000"><b>to </b></font>resolve DLL index entries
<font color="#000080">- </font>output C <font color="#FF0000"><b>and Pascal </b></font>code <font color="#FF0000"><b>to </b></font>verify correctness <font color="#FF0000"><b>of </b></font>C <font color="#FF0000"><b>and Pascal
  </b></font>structure sizes

How <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>and </b></font>generate import files<font color="#000080">:
-------------------------------------

</font><font color="#FF0000"><b>if </b></font>a EXEHDR <font color="#FF0000"><b>type </b></font><font color="#000080">.</font>IMP <font color="#FF0000"><b>file is </b></font>present <font color="#FF0000"><b>for </b></font>the DLL <font color="#FF0000"><b>with </b></font>information
about the entry points <font color="#FF0000"><b>of </b></font>a <font color="#FF0000"><b>function</b></font><font color="#000080">, </font>H2Pas outputs an <font color="#FF0000"><b>unit implementation
</b></font>section <font color="#FF0000"><b>with </b></font>entries <font color="#FF0000"><b>of </b></font>the form<font color="#000080">:

  </font><font color="#FF0000"><b>Function </b></font>Ctl3DEnabled<font color="#000080">;                  </font><font color="#FF0000"><b>External </b></font><font color="#800000">'CTL3D'    </font>Index    <font color="#800000">5</font><font color="#000080">;

</font>where the appropriate indices are resolved from information gathered
from the <font color="#000080">.</font>IMP <font color="#FF0000"><b>file</b></font><font color="#000080">.

</font><font color="#FF0000"><b>To </b></font>generate the <font color="#000080">.</font>IMP <font color="#FF0000"><b>file for </b></font>a DLL <font color="#000080">-</font>say CTL3D<font color="#000080">.</font>DLL<font color="#000080">- </font>one must <font color="#FF0000"><b>do </b></font>the following<font color="#000080">:

  </font>EXEHDR CTL3D<font color="#000080">.</font>DLL <font color="#000080">&gt;</font>CTL3D<font color="#000080">.</font>IMP


How <font color="#FF0000"><b>to </b></font>execute H2Pas
<font color="#000080">--------------------

</font>Usage<font color="#000080">:

</font>H2Pas Ctl3D<font color="#000080">.</font>H Ctl3D<font color="#000080">.</font>Pas <font color="#000080">[</font>Ctl3D<font color="#000080">.</font>Imp<font color="#000080">]

</font>where Ctl3D<font color="#000080">.</font>H <font color="#FF0000"><b>is </b></font>the source C header <font color="#FF0000"><b>file</b></font><font color="#000080">,
      </font>Ctl3D<font color="#000080">.</font>Pas <font color="#FF0000"><b>is </b></font>the destination <font color="#FF0000"><b>pascal unit to </b></font>be generated
  <font color="#FF0000"><b>and </b></font>Ctl3D<font color="#000080">.</font>Imp <font color="#FF0000"><b>is </b></font>an optional import <font color="#FF0000"><b>file </b></font>generated from EXEHDR

H2Pas<font color="#000080">.</font>Ini
<font color="#000080">---------

</font>currently H2Pas<font color="#000080">.</font>Ini has two areas <font color="#FF0000"><b>for </b></font>customization<font color="#000080">:

[</font>TypeMap<font color="#000080">]
</font>C<font color="#000080">-</font><font color="#FF0000"><b>Type </b></font><font color="#000080">= </font><font color="#FF0000"><b>Pascal</b></font><font color="#000080">-</font><font color="#FF0000"><b>Type

</b></font>maps a certain C<font color="#000080">-</font><font color="#FF0000"><b>type to </b></font>a <font color="#FF0000"><b>Pascal type </b></font><font color="#000080">(</font>see sample H2Pas<font color="#000080">.</font>Ini<font color="#000080">)

[</font>ModMap<font color="#000080">]
</font>modifier

a list <font color="#FF0000"><b>of </b></font>modifiers that H2Pas should ignore <font color="#000080">(</font>see sample H2Pas<font color="#000080">.</font>Ini<font color="#000080">)

</font>written by

  Peter Sawatzki
  Buchenhof <font color="#800000">3
  58091 </font>Hagen <font color="#000080">/ </font>Germany
  CompuServe<font color="#000080">: </font><font color="#800000">100031</font><font color="#000080">,</font><font color="#800000">3002





 </font><font color="#008000"><i>{ ------------------  SAMPLE INI FILE NEED FOR THIS UNIT ---------- }
 { CUT and Save as H2PAS.INI                                         }

</i></font><font color="#000080">[</font>TypeMap<font color="#000080">]
</font>unsigned        <font color="#000080">= </font>Word
unsigned int    <font color="#000080">= </font>Word
char            <font color="#000080">= </font>Char
unsigned long   <font color="#000080">= </font>LongInt
int             <font color="#000080">= </font>Integer
char <font color="#FF0000"><b>far </b></font><font color="#000080">*      = </font>pChar
unsigned char   <font color="#000080">= </font>Byte
byte            <font color="#000080">= </font>Byte
char <font color="#000080">*          = </font>pChar
long            <font color="#000080">= </font>LongInt
WORD            <font color="#000080">= </font>Word
DWORD           <font color="#000080">= </font>LongInt
ULONG           <font color="#000080">= </font>LongInt
BOOL            <font color="#000080">= </font>Bool
UINT            <font color="#000080">= </font>Word
void <font color="#000080">*          = </font>Pointer
<font color="#000080">; </font>Windows stuff
BITMAPINFO      <font color="#000080">= </font>tBitmapInfo
HANDLE          <font color="#000080">= </font>tHandle
HWINDOW         <font color="#000080">= </font>hWindow
COLORREF        <font color="#000080">= </font>tColorRef

<font color="#000080">[</font>ModMap<font color="#000080">]
</font>WINAPI
WINGAPI
APIENTRY
EXPENTRY
<font color="#FF0000"><b>EXPORT
</b></font>EXTERN
<font color="#FF0000"><b>PASCAL
FAR
</b></font>_FAR
<font color="#FF0000"><b>const

</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0186.PAS">Original</a><b>]</b></p></body>
</html>
