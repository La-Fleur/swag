<html>
<head><title> "RPG Thing for SWAG" by RAMON RODRIGO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0210.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>(* 30-8-97 : Solve 'Maze' With the Start and the End Position *)
(* By RRC2 (Ramon/Rodrigo Roman Castro) Soft, Malaga, Spain. *)
(*  - For: RPG programmers in every languages // Programadores de JDR.
    - Used in : BP 7.0.
    - Status : FreeWare, Can be Changed if You want.
    - Request : If you use it, please put our name in the credits.
    - Disclaimer : Code Full Tested. We aren't responsible of the damage
   that this code can do in your computer.
    - Sorry : We have a very bad English.
    - Comments :They're in English and Spanish. I'm Spanish, and Spanish is in
   the first five languages talken on the world, Did you know ?. Learn It!.
    - ATTENTION: I Don't Know if this Algorithm have been created before our
   discovery, but I don't see it on Anywhere. *)

(*  Imagine that you are making an RPG Game and you need a way
   enemies-&gt;objetives ( The Players ) in a maze structure.
    We have discovered an algorithm that can give a way to bad guys in
   a Rectangular map with or within Obstacles.
   This is.....

   THE MONIGOTES ALGORITHM
   =======================
   It's based in BackTracking Algorithm.
     Think that in every position of the terrain there's a byte that shows
   a direction:       1 North
                  4 West 2 East
                      3 South
     We start with the idea that my initial position in the terrain is a
   monigote (rag figure, I Think), and when it can, it expands himself wri-
   ting this directions in the terrain:
                 3                      1
               2 M 4 -&gt; We don't write 4 2 (We must find the way Obj-&gt;BG, see:
                 1                      3   Now, What we have?)
     It Can't expand if there's an wall or another direction written in the
   square we wanted to go.
   Now we start with a loop:
   -------------------------
     The directions previously created ( in the previous loop ) transforms
   into monigotes, and they expand themselves (see above).
     This loop ends when a monigote is beside the objective.
   Example:
   --------                    3          33         33
                    3         234        2344       2344     B = Bad Guy
         B W       2M4W       2M4W       2M4W       2M4W     O = Objective
      O    -&gt;    O  1  -&gt;   O  1   -&gt;  O  1   -&gt;  O  11      M = Monigote
                                                             W = Wall
    No Loop     1&brvbar; Loop         2&brvbar;    L   o   o   p.........

   Now, What we have?
   ------------------
     We have in the terrain the way Objective-&gt;Badguy written. So, starting
   in the position of the monigote that were beside the Obj., we find this
   way, put it into a vector, change the directions and put the vector
   in a new vector with interchanging beginning and end ( We want BadGuy-&gt;
   Objetive ! ).
   What returns algorithm
   ----------------------
     A vector with the way BadGuy-&gt;Objetive. You can't take a Wrong Way.
   Tehcnical Details
   -----------------
   --Who are the directions that I need to transform into monigotes?
     They're in a Linked List, PuntActuales, So we transform them into
   monigotes and next they're cleared.
   --And the directions created?
     They're also in another Linked List, SigPunteros. It will transform into
   PuntActuales in the start of the a loop.
   Praise( Ja,Ja ;) )
   ------------------
   It's a Finstro of algorithm !. (Finstro:Word that means nothing in English,
   and nothing in Spanish ! [ Viva Chiquito de la Calz  :) ])
   Disclaimer
   ----------
     This algorithm was created in 30-8-97, 11:00-&gt;4:00(night), so if it
   isn't optimal, sorry.
*)

</i></font><font color="#FF0000"><b>Program </b></font>AlgoritmoMonigotes<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>MAXMOV          <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">; </font><font color="#008000"><i>(* The maximum movements I Can do *)
      </i></font>MAXIMO          <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">; </font><font color="#008000"><i>(* Dimensions of the Terrain *)
      </i></font>INIX            <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>(* X Coordinate of the Bad Guy *)
      </i></font>INIY            <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">; </font><font color="#008000"><i>(* Y Coordinate of the Bad Guy *)
      </i></font>OBJX            <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;  </font><font color="#008000"><i>(* X Coordinate of the Objective *)
      </i></font>OBJY            <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">; </font><font color="#008000"><i>(* Y Coordinate of the Objective *)
      </i></font>DISTANCIAMAXIMA <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>(* Reserved *)


</i></font><font color="#FF0000"><b>Type  </b></font>TSolucion <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXMOV<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Integer<font color="#000080">; </font><font color="#008000"><i>(* Vector with Solution *)
      </i></font>TPantalla <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXIMO<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font>MAXIMO<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">; </font><font color="#008000"><i>(* Terrain *)
      </i></font>TPosicion <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font><font color="#008000"><i>(* Position in X and Y *)
                    </i></font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* Maze-Type Terrain *)
</i></font><font color="#FF0000"><b>Const </b></font>Pantalla<font color="#000080">:</font>TPantalla <font color="#000080">=
((</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">),
 (</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">));

</font><font color="#008000"><i>(* Terrain Within Obstacles *)
(* Const Pantalla:TPantalla =
((1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1),
 (1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1));*)

</i></font><font color="#FF0000"><b>Var   </b></font>Fondo        <font color="#000080">:</font>TPantalla<font color="#000080">;
      </font>Mov          <font color="#000080">:</font>Integer<font color="#000080">;
      </font>MovTotal     <font color="#000080">:</font>Integer<font color="#000080">;
      </font>Exito        <font color="#000080">:</font>Boolean<font color="#000080">;
      </font>Ini<font color="#000080">,</font>Obj      <font color="#000080">:</font>TPosicion<font color="#000080">;
      </font>i            <font color="#000080">:</font>Integer<font color="#000080">;
      </font>Solucion     <font color="#000080">:</font>TSolucion<font color="#000080">;

</font><font color="#008000"><i>(* This procedure create the terrain with the Const Pantalla *)
</i></font><font color="#FF0000"><b>Procedure </b></font>InicializarPantallas<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>Byte<font color="#000080">;
    </font>Pant<font color="#000080">:</font>TPantalla<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Fondo<font color="#000080">:=</font>Pantalla<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* This procedure Paints the Terrain onto the screen *)
</i></font><font color="#FF0000"><b>Procedure </b></font>PintarPantallas<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAXIMO <font color="#FF0000"><b>Do
      For </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAXIMO <font color="#FF0000"><b>Do
          Begin
            </b></font>GotoXy<font color="#000080">(</font>i<font color="#000080">,</font>j<font color="#000080">);
            </font><font color="#FF0000"><b>Case </b></font>Fondo<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">] </font><font color="#FF0000"><b>Of
               </b></font><font color="#800000">1</font><font color="#000080">:</font>Write<font color="#000080">(</font><font color="#800000">'&deg;'</font><font color="#000080">);
               </font><font color="#800000">9</font><font color="#000080">:</font><font color="#FF0000"><b>Begin
                   </b></font>TextColor<font color="#000080">(</font>RED<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'&Ucirc;'</font><font color="#000080">);
                   </font>TextColor<font color="#000080">(</font>LIGHTGRAY<font color="#000080">);
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>GotoXY<font color="#000080">(</font>OBJX<font color="#000080">,</font>OBJY<font color="#000080">);</font>Write<font color="#000080">(</font>CHR<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>GotoXY<font color="#000080">(</font>INIX<font color="#000080">,</font>INIY<font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Y'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* This procedure paints the solution given in the vector Solucion *)
</i></font><font color="#FF0000"><b>Procedure </b></font>PintarMovimientos<font color="#000080">(</font>Solucion<font color="#000080">:</font>TSolucion<font color="#000080">;</font>MovTotal<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Pos<font color="#000080">:</font>TPosicion<font color="#000080">;
    </font>i<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Pos<font color="#000080">:=</font>INI<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MovTotal <font color="#FF0000"><b>Do
      Begin
        Case </b></font>Solucion<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>Of
             </b></font><font color="#800000">1</font><font color="#000080">:</font>Dec<font color="#000080">(</font>Pos<font color="#000080">.</font>Y<font color="#000080">);
             </font><font color="#800000">2</font><font color="#000080">:</font>Inc<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">);
             </font><font color="#800000">3</font><font color="#000080">:</font>Inc<font color="#000080">(</font>Pos<font color="#000080">.</font>Y<font color="#000080">);
             </font><font color="#800000">4</font><font color="#000080">:</font>Dec<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>GotoXy<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>DarkGray<font color="#000080">);
        </font><font color="#FF0000"><b>Case </b></font>Fondo<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">] </font><font color="#FF0000"><b>Of
             </b></font><font color="#800000">1</font><font color="#000080">:</font>Write<font color="#000080">(</font><font color="#800000">'&deg;'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* This function says if I can Step On a Square *)
</i></font><font color="#FF0000"><b>Function </b></font>SiPisar<font color="#000080">(</font>ActualX<font color="#000080">,</font>ActualY<font color="#000080">:</font>ShortInt<font color="#000080">):</font>Boolean<font color="#000080">; </font><font color="#008000"><i>(* &uml; Puedo Pisar ? *)
</i></font><font color="#FF0000"><b>Begin
  </b></font>SiPisar<font color="#000080">:= (</font>ActualX<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>ActualX<font color="#000080">&lt;=</font>MAXIMO<font color="#000080">) </font><font color="#FF0000"><b>And
            </b></font><font color="#000080">(</font>ActualY<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>ActualY<font color="#000080">&lt;=</font>MAXIMO<font color="#000080">) </font><font color="#FF0000"><b>And
            </b></font><font color="#000080">(</font>Fondo<font color="#000080">[</font>ActualX<font color="#000080">,</font>ActualY<font color="#000080">] &lt;&gt; </font><font color="#800000">9</font><font color="#000080">); </font><font color="#008000"><i>(* 9-&gt; Wall // Muro *)
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>(*-----------------------------------------------------------------------*)
(*------------------ALGORITHM//ALGORITMO---------------------------------*)
(*-----------------------------------------------------------------------*)
(*   BusqMonigote: The Algorithm. Returns TRUE if there's a way
       \-----&gt; Devuelve si hay un camino
   Inicio: is the position of the Bad Guy, // Pos. Malo
   Objetivo: is the objective position, // Posicion objetivo
   PMov: is the squares you can move, // Casillas que puedo mover
   VAR Solucion: is the vector with the solution, // Array con la solucion
   VAR Movtotal: is the movements you have Done, // Movimientos realizados
   Fondo: is the Terrain // El terreno donde nos movemos
*)
</i></font><font color="#FF0000"><b>Function </b></font>BusqMonigote<font color="#000080">(</font>Inicio<font color="#000080">,</font>Objetivo<font color="#000080">:</font>TPosicion<font color="#000080">;</font>PMov<font color="#000080">:</font>Integer<font color="#000080">;
                      </font><font color="#FF0000"><b>Var </b></font>Solucion<font color="#000080">:</font>TSolucion<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>MovTotal<font color="#000080">:</font>Integer<font color="#000080">;
                      </font>Fondo<font color="#000080">:</font>TPantalla<font color="#000080">):</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>MAYOR <font color="#000080">= (</font>MAXIMO<font color="#000080">*</font>MAXIMO<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>PRegistro     <font color="#000080">= ^</font>TRegistro<font color="#000080">;
     </font>TLista        <font color="#000080">= </font>PRegistro<font color="#000080">;
     </font>TElemento     <font color="#000080">= </font>TPosicion<font color="#000080">;
     </font>TRegistro     <font color="#000080">= </font><font color="#FF0000"><b>Record
                      </b></font>Zona<font color="#000080">:</font>TElemento<font color="#000080">;
                      </font>Sig<font color="#000080">:</font>TLista<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>TAlgMonigote  <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXIMO<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font>MAXIMO<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;

     </font>TRejSolucion  <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAYOR<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Integer<font color="#000080">; </font><font color="#008000"><i>(* Guardo Solucion Total *)
     (* Saves the entire Way *)
   (* Asi encuentra hasta el camino mas raro *)
   (* With this vector it can find even the strangest Way *)

</i></font><font color="#FF0000"><b>Var </b></font>PuntActuales<font color="#000080">:</font>TLista<font color="#000080">;
    </font>SigPunteros<font color="#000080">:</font>TLista<font color="#000080">;
    </font>Actual<font color="#000080">:</font>TPosicion<font color="#000080">;
    </font>Indice<font color="#000080">:</font>TLista<font color="#000080">;
    </font>AlgMonigote<font color="#000080">:</font>TAlgMonigote<font color="#000080">;
    </font>PosVictoria<font color="#000080">:</font>TPosicion<font color="#000080">;
    </font>SolucionTmp<font color="#000080">:</font>TRejSolucion<font color="#000080">;
    </font>Contador<font color="#000080">:</font>Integer<font color="#000080">;
    </font>CBucle<font color="#000080">:</font>Integer<font color="#000080">;
    </font>Contador2<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#008000"><i>(* Distancia measure the distance | Mide distancia entre blanco y objetivo *)
    </i></font><font color="#FF0000"><b>Function </b></font>Distancia<font color="#000080">(</font>ActualX<font color="#000080">,</font>ActualY<font color="#000080">:</font>ShortInt<font color="#000080">;</font>Objetivo<font color="#000080">:</font>TPosicion<font color="#000080">):</font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Distancia<font color="#000080">:=</font>Abs<font color="#000080">(</font>ActualX<font color="#000080">-</font>Objetivo<font color="#000080">.</font>X<font color="#000080">)+</font>Abs<font color="#000080">(</font>ActualY<font color="#000080">-</font>Objetivo<font color="#000080">.</font>Y<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>(* Initiate vars and pointers *)
    </i></font><font color="#FF0000"><b>Procedure </b></font>InicializoListasYVariables<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
     </b></font>PuntActuales<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
     </font>SigPunteros<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
     </font>Indice<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
     </font>Actual<font color="#000080">:=</font>Inicio<font color="#000080">;
     </font>PosVictoria<font color="#000080">.</font>X<font color="#000080">:=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font>PosVictoria<font color="#000080">.</font>Y<font color="#000080">:=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>x<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>MAXIMO <font color="#FF0000"><b>Do
         </b></font>Solucion<font color="#000080">[</font>x<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>x<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>MAYOR <font color="#FF0000"><b>Do
         </b></font>SolucionTmp<font color="#000080">[</font>x<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>x<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>MAXIMO <font color="#FF0000"><b>Do
         For </b></font>y<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>MAXIMO <font color="#FF0000"><b>Do
          Begin
            </b></font>AlgMonigote<font color="#000080">[</font>x<font color="#000080">,</font>y<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>(* Here stars Procedures of Pointers and Linked Lists *)
    (* Insert_Begin // Inserta en el frente de una lista enlazada *)
    </i></font><font color="#FF0000"><b>Procedure </b></font>MeterFrente<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Lista<font color="#000080">:</font>TLista<font color="#000080">;</font>Ele<font color="#000080">:</font>TElemento<font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>Tmp<font color="#000080">:</font>TLista<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>New<font color="#000080">(</font>Tmp<font color="#000080">);
      </font>Tmp<font color="#000080">^.</font>Zona<font color="#000080">:=</font>Ele<font color="#000080">;
      </font>Tmp<font color="#000080">^.</font>Sig<font color="#000080">:=</font>Lista<font color="#000080">;
      </font>Lista<font color="#000080">:=</font>Tmp<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>(* Pop_Begin // Saca un elemento del inicio de la lista enlazada *)
    </i></font><font color="#FF0000"><b>Procedure </b></font>SacarFrente<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Lista<font color="#000080">:</font>TLista<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Ele<font color="#000080">:</font>TElemento<font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>Tmp<font color="#000080">:</font>TLista<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      If </b></font>Lista<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>NIL Then
         Begin
          </b></font>Tmp<font color="#000080">:=</font>Lista<font color="#000080">;
          </font>Lista<font color="#000080">:=</font>Tmp<font color="#000080">^.</font>Sig<font color="#000080">;
          </font>Ele<font color="#000080">:=</font>Tmp<font color="#000080">^.</font>Zona<font color="#000080">;
          </font>Dispose<font color="#000080">(</font>Tmp<font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>(* Eliminate List // Elimina la lista enlazada *)
    </i></font><font color="#FF0000"><b>Procedure </b></font>EliminoLista<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Lista<font color="#000080">:</font>TLista<font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>Tmp<font color="#000080">:</font>TLista<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      While </b></font>Lista<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>NIL Do
        Begin
            </b></font>Tmp<font color="#000080">:=</font>Lista<font color="#000080">;
            </font>Lista<font color="#000080">:=</font>Tmp<font color="#000080">^.</font>Sig<font color="#000080">;
            </font>Dispose<font color="#000080">(</font>Tmp<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>(* End of Linked List Procedures and Functions *)


    (* Procedure that writes the directions when monigotes are expanding *)
    </i></font><font color="#FF0000"><b>Procedure </b></font>ComprobarBordes<font color="#000080">(</font>Pos<font color="#000080">:</font>TPosicion<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>AlgMonigote<font color="#000080">:</font>TAlgMonigote<font color="#000080">;
                              </font><font color="#FF0000"><b>Var </b></font>PosVictoria<font color="#000080">:</font>TPosicion<font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>EleTmp<font color="#000080">:</font>TPosicion<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
         </b></font><font color="#008000"><i>(* Check Distance // Chequea la distancia al objetivo *)
         </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Distancia<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">,</font>Objetivo<font color="#000080">) &lt;= </font>DISTANCIAMAXIMA<font color="#000080">) </font><font color="#FF0000"><b>And
            </b></font><font color="#000080">(</font>Distancia<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">,</font>Objetivo<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            </b></font>PosVictoria<font color="#000080">:=</font>Pos
         <font color="#FF0000"><b>Else
         Begin
      </b></font><font color="#008000"><i>(*1*)</i></font><font color="#FF0000"><b>If </b></font>SiPisar<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And
              </b></font><font color="#000080">(</font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            Begin
              </b></font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">3</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>X<font color="#000080">:=</font>Pos<font color="#000080">.</font>X<font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>Y<font color="#000080">:=</font>Pos<font color="#000080">.</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
              </font>MeterFrente<font color="#000080">(</font>SigPunteros<font color="#000080">,</font>EleTmp<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#008000"><i>(*2*)</i></font><font color="#FF0000"><b>If </b></font>SiPisar<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">) </font><font color="#FF0000"><b>And
              </b></font><font color="#000080">(</font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            Begin
              </b></font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>X<font color="#000080">:=</font>Pos<font color="#000080">.</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>Y<font color="#000080">:=</font>Pos<font color="#000080">.</font>Y<font color="#000080">;
              </font>MeterFrente<font color="#000080">(</font>SigPunteros<font color="#000080">,</font>EleTmp<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#008000"><i>(*3*)</i></font><font color="#FF0000"><b>If </b></font>SiPisar<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And
              </b></font><font color="#000080">(</font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            Begin
              </b></font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>X<font color="#000080">:=</font>Pos<font color="#000080">.</font>X<font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>Y<font color="#000080">:=</font>Pos<font color="#000080">.</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font>MeterFrente<font color="#000080">(</font>SigPunteros<font color="#000080">,</font>EleTmp<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#008000"><i>(*4*)</i></font><font color="#FF0000"><b>If </b></font>SiPisar<font color="#000080">(</font>Pos<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">) </font><font color="#FF0000"><b>And
              </b></font><font color="#000080">(</font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
            Begin
              </b></font>AlgMonigote<font color="#000080">[</font>Pos<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">.</font>Y<font color="#000080">]:=</font><font color="#800000">2</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>X<font color="#000080">:=</font>Pos<font color="#000080">.</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
              </font>EleTmp<font color="#000080">.</font>Y<font color="#000080">:=</font>Pos<font color="#000080">.</font>Y<font color="#000080">;
              </font>MeterFrente<font color="#000080">(</font>SigPunteros<font color="#000080">,</font>EleTmp<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>InicializoListasYVariables<font color="#000080">;
  </font><font color="#008000"><i>(* Pongo las primeras direciones // Puts the First Directions *)
  </i></font>ComprobarBordes<font color="#000080">(</font>Inicio<font color="#000080">,</font>AlgMonigote<font color="#000080">,</font>PosVictoria<font color="#000080">);

</font><font color="#008000"><i>(* INICIO ALGORITMO // ALGORITHM STARTS *)
  (* Chequeo PosVictoria o fin del chequeo *)
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>PosVictoria<font color="#000080">.</font>X<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>PosVictoria<font color="#000080">.</font>Y<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>And
        </b></font><font color="#000080">(</font>SigPunteros<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>EliminoLista<font color="#000080">(</font>PuntActuales<font color="#000080">);
      </font>PuntActuales<font color="#000080">:=</font>SigPunteros<font color="#000080">;
      </font>SigPunteros<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
      </font><font color="#008000"><i>(* Salgo al encontrar el 1&sect; o ninguno *)
      </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PuntActuales<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>And
            </b></font><font color="#000080">((</font>PosVictoria<font color="#000080">.</font>X<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>PosVictoria<font color="#000080">.</font>Y<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
        Begin
          </b></font>SacarFrente<font color="#000080">(</font>PuntActuales<font color="#000080">,</font>Actual<font color="#000080">);
          </font>ComprobarBordes<font color="#000080">(</font>Actual<font color="#000080">,</font>AlgMonigote<font color="#000080">,</font>PosVictoria<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>(* Fin del Algoritmo en Si *)
  </i></font>EliminoLista<font color="#000080">(</font>PuntActuales<font color="#000080">);
  </font>EliminoLista<font color="#000080">(</font>SigPunteros<font color="#000080">);
</font><font color="#008000"><i>(* FIN DEL ALGORITMO // ALGORITHM ENDS *)

(*   Ahora paso la solucion al Array Solucion. Escribo el camino completo en
   SolucionTmp ( Invirtiendo las direcciones, ya que busco de principio a
   fin ) y luego escribo en Solucion &quot;Invirtiendo el vector&quot; *)
(*   Now I pass the Solution ( It's in the AlgMonigote Vector ) to Solucion,
   using SolucionTmp (-&gt; It Have the entire Way ) like a bridge *)

  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PosVictoria<font color="#000080">.</font>X<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>PosVictoria<font color="#000080">.</font>Y<font color="#000080">=</font>MAXIMO<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
     </b></font>BusqMonigote<font color="#000080">:=</font>False <font color="#008000"><i>(* No encontre camino // There's no way *)
  </i></font><font color="#FF0000"><b>Else Begin </b></font><font color="#008000"><i>(* Encontre camino // There's a way *)
         </i></font>Actual<font color="#000080">:=</font>PosVictoria<font color="#000080">;
         </font>Contador<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Actual<font color="#000080">.</font>X<font color="#000080">&lt;&gt;</font>Inicio<font color="#000080">.</font>X<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Actual<font color="#000080">.</font>Y<font color="#000080">&lt;&gt;</font>Inicio<font color="#000080">.</font>Y<font color="#000080">) </font><font color="#FF0000"><b>Do
         </b></font><font color="#008000"><i>(* Busco el camino del final al principio, transformando *)
           </i></font><font color="#FF0000"><b>Begin
             Case </b></font>AlgMonigote<font color="#000080">[</font>Actual<font color="#000080">.</font>X<font color="#000080">,</font>Actual<font color="#000080">.</font>Y<font color="#000080">] </font><font color="#FF0000"><b>Of </b></font><font color="#008000"><i>(* Cambio direcciones *)
                  </i></font><font color="#800000">1</font><font color="#000080">:</font>SolucionTmp<font color="#000080">[</font>Contador<font color="#000080">]:=</font><font color="#800000">3</font><font color="#000080">;
                  </font><font color="#800000">2</font><font color="#000080">:</font>SolucionTmp<font color="#000080">[</font>Contador<font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">;
                  </font><font color="#800000">3</font><font color="#000080">:</font>SolucionTmp<font color="#000080">[</font>Contador<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
                  </font><font color="#800000">4</font><font color="#000080">:</font>SolucionTmp<font color="#000080">[</font>Contador<font color="#000080">]:=</font><font color="#800000">2</font><font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
             </font>Inc<font color="#000080">(</font>Contador<font color="#000080">);
             </font><font color="#FF0000"><b>Case </b></font>AlgMonigote<font color="#000080">[</font>Actual<font color="#000080">.</font>X<font color="#000080">,</font>Actual<font color="#000080">.</font>Y<font color="#000080">] </font><font color="#FF0000"><b>Of
                  </b></font><font color="#800000">1</font><font color="#000080">:</font>Dec<font color="#000080">(</font>Actual<font color="#000080">.</font>Y<font color="#000080">);
                  </font><font color="#800000">2</font><font color="#000080">:</font>Inc<font color="#000080">(</font>Actual<font color="#000080">.</font>X<font color="#000080">);
                  </font><font color="#800000">3</font><font color="#000080">:</font>Inc<font color="#000080">(</font>Actual<font color="#000080">.</font>Y<font color="#000080">);
                  </font><font color="#800000">4</font><font color="#000080">:</font>Dec<font color="#000080">(</font>Actual<font color="#000080">.</font>X<font color="#000080">);
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>(* Del While *)(* Saco Contador con el Num. de Movs Total+1 *)

         </i></font>Contador2<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>For </b></font>CBucle<font color="#000080">:=</font>Contador<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">1 </font><font color="#FF0000"><b>Do
         </b></font><font color="#008000"><i>(* Ahora cambio direccion del camino de Fin-inicio a Inicio-Fin *)
         (* Meto solo el movimiento que tengo *)
           </i></font><font color="#FF0000"><b>Begin
             If </b></font><font color="#000080">(</font>Contador2 <font color="#000080">&lt;= </font>PMov<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>SolucionTmp<font color="#000080">[</font>CBucle<font color="#000080">]&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
               Begin
                 </b></font>Solucion<font color="#000080">[</font>Contador2<font color="#000080">]:=</font>SolucionTmp<font color="#000080">[</font>CBucle<font color="#000080">];
                 </font>Inc<font color="#000080">(</font>Contador2<font color="#000080">);
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>(* Del For *)
         </i></font>MovTotal<font color="#000080">:=</font>Contador2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>(* Mov Realizados *)
         </i></font>BusqMonigote<font color="#000080">:=</font>TRUE<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>Ini<font color="#000080">.</font>X<font color="#000080">:=</font>INIX<font color="#000080">;
  </font>Ini<font color="#000080">.</font>Y<font color="#000080">:=</font>INIY<font color="#000080">;
  </font>Obj<font color="#000080">.</font>X<font color="#000080">:=</font>OBJX<font color="#000080">;
  </font>Obj<font color="#000080">.</font>Y<font color="#000080">:=</font>OBJY<font color="#000080">;
  </font>ClrScr<font color="#000080">;
  </font>InicializarPantallas<font color="#000080">;
  </font>PintarPantallas<font color="#000080">;
  </font>Exito<font color="#000080">:=</font>BusqMonigote<font color="#000080">(</font>INI<font color="#000080">,</font>OBJ<font color="#000080">,</font>MAXMOV<font color="#000080">,</font>Solucion<font color="#000080">,</font>MovTotal<font color="#000080">,</font>Fondo<font color="#000080">);
  </font>GotoXy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">22</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Movtotal <font color="#FF0000"><b>Do
      </b></font>Write<font color="#000080">(</font>Solucion<font color="#000080">[</font>i<font color="#000080">]);
  </font>GotoXy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'Way finded//Hay camino: '</font><font color="#000080">,</font>Exito<font color="#000080">,</font><font color="#800000">'. Movements//Movimientos -&gt; '</font><font color="#000080">,</font>MovTotal<font color="#000080">);
  </font>ReadKey<font color="#000080">;
  </font>PintarMovimientos<font color="#000080">(</font>Solucion<font color="#000080">,</font>MAXMOV<font color="#000080">);
  </font>ReadKey<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font><font color="#008000"><i>(* There's no RPG programmers there?. Contact SWAG, leshe. *)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0210.PAS">Original</a><b>]</b></p></body>
</html>
