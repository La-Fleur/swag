<html>
<head><title> "OP Pick Lists" by ALTON PRILLAMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;I've been trying to create a simple pick list using Object Proffesional and
&gt;can't seem to get it to do what I want. I'm using the expick.pas example as
&gt;start for creating my pick list. Everything is pretty much the same except
&gt;that I want my pick list to exit with other keys insted of the enter key.
&gt;The manual doesn't go into detail about this.

Check out the docs for OpCmd.  The procedure that you're wanting is
&quot;AddCommand&quot;.   In my example below, I've set up a multiple choice list
that &quot;remaps&quot; the &lt;Enter&gt; key to toggle (like the &lt;SpaceBar&gt;) and use
&lt;F10&gt; to accept the choices.  Here's my example:

{DON'T FORGET TO &quot;USE&quot; OpCmd}

</i></font><font color="#FF0000"><b>uses
   </b></font>OpCmd<font color="#000080">; </font><font color="#008000"><i>{among others}

</i></font><font color="#FF0000"><b>procedure </b></font>GetPicks<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>PL                  <font color="#000080">:</font>PickList<font color="#000080">;
   </font>PickDone            <font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if not </b></font>PL<font color="#000080">.</font>InitDeluxe<font color="#000080">(</font>screenwidth <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">16</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,
                        </font>screenwidth <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">15</font><font color="#000080">,</font>screenheight<font color="#000080">-</font><font color="#800000">6</font><font color="#000080">,
                        </font>AltMenuCS<font color="#000080">,     </font><font color="#008000"><i>{color set}
                        </i></font>WinOpts<font color="#000080">,       </font><font color="#008000"><i>{window options}
                        </i></font><font color="#800000">33</font><font color="#000080">,            </font><font color="#008000"><i>{width of pick list strings}
                        </i></font>NumItems<font color="#000080">,      </font><font color="#008000"><i>{number of items}
                        </i></font>UserStrings<font color="#000080">,   </font><font color="#008000"><i>{user-string proc}
                        </i></font>PickVertical<font color="#000080">,  </font><font color="#008000"><i>{pick direction-type}
                        </i></font>MultipleChoice<font color="#000080">,</font><font color="#008000"><i>{single or multiple}
                        </i></font>pkStick<font color="#000080">)</font><font color="#FF0000"><b>then   </b></font><font color="#008000"><i>{stick at edges}
    </i></font><font color="#FF0000"><b>begin
        </b></font><font color="#008000"><i>{error message}
        </i></font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>PickCommands<font color="#000080">.</font>AddCommand<font color="#000080">(</font>ccToggle<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$1C0D</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{Enter=Toggle}
    </i></font>PickCommands<font color="#000080">.</font>AddCommand<font color="#000080">(</font>ccSelect<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$4400</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{F10=Accept}
    </i></font>PickDone<font color="#000080">:=</font>false<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
       </b></font>PL<font color="#000080">.</font>Process<font color="#000080">;
       </font><font color="#FF0000"><b>case </b></font>PL<font color="#000080">.</font>GetLastCommand <font color="#FF0000"><b>of
          </b></font>ccSelect<font color="#000080">:  </font><font color="#008000"><i>{F10}
             </i></font><font color="#FF0000"><b>begin
             end</b></font><font color="#000080">;

           </font>ccQuit<font color="#000080">:
              </font>PickDone<font color="#000080">:=</font>true<font color="#000080">;

           </font>ccError<font color="#000080">:
              </font><font color="#FF0000"><b>begin
                 </b></font>PickDone<font color="#000080">:=</font>true<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
     </i></font><font color="#FF0000"><b>until </b></font>PickDone<font color="#000080">;
     </font>HideMouse<font color="#000080">;

     </font><font color="#008000"><i>{NOTE THE FOLLOWING LINES:  They're needed to remap the &lt;Enter&gt;
      key to its original setting and gets rid of the &lt;F10&gt; key as
      the ccSelect.  If you want *ALL* of your pick lists throughout
      your program to behave this way, use the PickCommands.AddCommand
      at the beginning of your program.}

      </i></font>PickCommands<font color="#000080">.</font>AddCommand<font color="#000080">(</font>ccSelect<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$1C0D</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{Enter=Toggle}
      </i></font>PickCommands<font color="#000080">.</font>AddCommand<font color="#000080">(</font>ccNone<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$4400</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{F10=Accept}
      </i></font>PL<font color="#000080">.</font>Done<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
CHARLES SERFOSS

&gt;I've been trying to create a simple pick list using Object Proffesional and
&gt;can't seem to get it to do what I want. I'm using the expick.pas example as a
&gt;start for creating my pick list. Everything is pretty much the same except
&gt;that I want my pick list to exit with other keys insted of the enter key.
&gt;The manual doesn't go into detail about this.

You'll have to use the &quot;AddCommand&quot; method.  Here's an example.  This is
based on &quot;expick1.pas&quot; from Page 4-186 of Book #1.
}

</i></font><font color="#FF0000"><b>program </b></font>PickListExample<font color="#000080">;
</font><font color="#FF0000"><b>uses
        </b></font>OpCrt<font color="#000080">, </font>OpRoot<font color="#000080">, </font>OpCCmd<font color="#000080">, </font>OpFrame<font color="#000080">, </font>OpWindow<font color="#000080">, </font>OpPick<font color="#000080">;
</font><font color="#FF0000"><b>const
        </b></font>NumPizzaToppings <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>PizzaTop <font color="#000080">: </font>PickList<font color="#000080">;
        </font>PickWindowOptions <font color="#000080">: </font>Longint<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>PizzaTopping<font color="#000080">(</font>Item <font color="#000080">: </font>Word <font color="#008000"><i>{ etc... }</i></font><font color="#000080">) : </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ Main }
        </i></font><font color="#FF0000"><b>if not </b></font>PizzaTop<font color="#000080">.</font>InitCustom<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">45</font><font color="#000080">, </font><font color="#008000"><i>{ etc ... }</i></font><font color="#000080">) </font><font color="#FF0000"><b>then begin
                </b></font>halt<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>PizzaTop<font color="#000080">.</font>SetSearchMode<font color="#000080">(</font>PicckCharSearch<font color="#000080">);
        </font>PizzaTop<font color="#000080">.</font>EnableExplosion<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
        </font><font color="#FF0000"><b>with </b></font>PizzaTop<font color="#000080">.</font>wFrame <font color="#FF0000"><b>do begin
                </b></font>AddShadow<font color="#000080">...
                </font>AddHeader<font color="#000080">...
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#008000"><i>{ *************** Decide Which Keys In Addition To Defaults To Allow }
        { PickCommands is just mentioned at the end of page 4-207.  The      }
        { CommandProcessor Type allows you to use the functions in section   }
        { (E) OPCMD - Page 3-82.  See Page 3-95 for documentation on         }
        { the &quot;AddCommand&quot; method!                                           }
        { *******************************************************************}
        </i></font><font color="#FF0000"><b>with </b></font>PickCommands <font color="#FF0000"><b>do
        begin
                </b></font>AddCommand<font color="#000080">(</font>ccUser1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$5200</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{ $5200 = scan code for INS }
                </i></font>AddCommand<font color="#000080">(</font>ccUser2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$5300</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{ $5300 = scan code for DEL }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>PizzaTop<font color="#000080">.</font>Process<font color="#000080">;
        </font>PizzaTop<font color="#000080">.</font>Erase<font color="#000080">;
        </font><font color="#FF0000"><b>case </b></font>PizzaTop<font color="#000080">.</font>GetLastCommand <font color="#FF0000"><b>of
                </b></font>ccUser1 <font color="#000080">: ; </font><font color="#008000"><i>{ If User hits INS, this is executed }
                </i></font>ccUser2 <font color="#000080">: ; </font><font color="#008000"><i>{ If User hits DEL, this is executed }
                </i></font>ccSelect <font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'You chose : '</font><font color="#000080">,</font>PizzaTop<font color="#000080">.</font>GetLastChoiceString<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>PizzaTop<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>{ Main }

{
DAVID HOWORTH

&gt; I've been trying to create a simple pick list using Object Proffesional
&gt; can't seem to get it to do what I want. I'm using the expick.pas exampl
&gt; start for creating my pick list. Everything is pretty much the same exc
&gt; that I want my pick list to exit with other keys insted of the enter ke
&gt; The manual doesn't go into detail about this.

Nick--The manual does go into subtantial detail.  You just need to
know where to look.  As with much of OPro, the things you want to
do with a particular object may be implemented, not in the object
per se, but in one of its ancestors.  It always pays to look in the
manual at the ancestor's methods.

You need to read up on CommandWindow, from which PickList is
descended, and on CommandProcessor, in OpCmd.  Here's a relevant
piece of code from one of my programs.  The first AddCommand adds
an additional Quit; the others are for purposes specific to my
application, not for predefined commands such as ccQuit.
}
</i></font><font color="#FF0000"><b>with </b></font>DialPickList <font color="#008000"><i>{ a PickList descendent } </i></font><font color="#FF0000"><b>do

   with </b></font>PickCommands <font color="#FF0000"><b>do begin
     </b></font><font color="#008000"><i>{ Simulate WordPerfect's exit command }
     </i></font>AddCommand<font color="#000080">(</font>ccQuit<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$4100</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);       </font><font color="#008000"><i>{ F7 }

     { ccUser0 = Add a new phone entry }
     </i></font>AddCommand<font color="#000080">(</font>ccUser0<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$1E00</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Alt-A}
     </i></font>AddCommand<font color="#000080">(</font>ccUser0<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$5200</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Ins}

     { ccUser1 = Delete a phone entry }
     </i></font>AddCommand<font color="#000080">(</font>ccUser1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$2000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Alt-D}
     </i></font>AddCommand<font color="#000080">(</font>ccUser1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$5300</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Del}

     { ccUser2 = Edit a phone entry }
     </i></font>AddCommand<font color="#000080">(</font>ccUser2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$1200</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Alt-E}

     { ccUser3 = Reconfigure Comm Stuff }
     </i></font>AddCommand<font color="#000080">(</font>ccUser3<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$2E00</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Alt-C}

     { ccUser4 = View log (the printing and purging routines branch
       from the browsing routine }
     </i></font>AddCommand<font color="#000080">(</font>ccUser4<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">$2F00</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);      </font><font color="#008000"><i>{Alt-V}

  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ with PickCommands }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ with DialPickList }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p></body>
</html>
