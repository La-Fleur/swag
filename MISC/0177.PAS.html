<html>
<head><title> "Another Percentage bar" by NIKOLAJ PAGH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0177.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Someone asked for a percentagebar routine. Well, here's a little one I put
together. (Put it in SWAG if you like...)
There's a testprogram at the end...
}

</i></font><font color="#FF0000"><b>UNIT </b></font>PERC_BAR<font color="#000080">;
</font><font color="#FF0000"><b>INTERFACE

PROCEDURE </b></font>InitBar<font color="#000080">(</font>Xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>Size<font color="#000080">,</font>ForCol<font color="#000080">,</font>BackCol<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>UpdateBar<font color="#000080">(</font>Curr<font color="#000080">:</font>BYTE<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION
CONST
  </b></font>SCSEG          <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">;               </font><font color="#008000"><i>(* Segment for screen *)
  </i></font>SCWIDTH        <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">*</font><font color="#800000">2</font><font color="#000080">;                </font><font color="#008000"><i>(* Width of screen *)

</i></font><font color="#FF0000"><b>VAR </b></font><font color="#008000"><i>(* Local variables *)
  </i></font>BarOffs        <font color="#000080">: </font>WORD<font color="#000080">;
  </font>BarSize        <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>BarCol         <font color="#000080">: </font>BYTE<font color="#000080">;

</font><font color="#008000"><i>(*************************************************************************
(* Name    : InitBar(Xpos,Ypos,Size,ForCol,BackCol:BYTE)
(* Purpose : Initializes the percentage bar. Xpos,Ypos is absolute posi-
(*           tion on screen, Size is how wide the bar is and ForCol and
(*           BackCol are the colors to use
(* Returns : None
(*************************************************************************)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitBar<font color="#000080">(</font>Xpos<font color="#000080">,</font>Ypos<font color="#000080">,</font>Size<font color="#000080">,</font>ForCol<font color="#000080">,</font>BackCol<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>ix             <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>wValue         <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>BarOffs<font color="#000080">:=(</font>Xpos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">+(</font>Ypos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font>SCWIDTH<font color="#000080">;
  </font>BarSize<font color="#000080">:=</font>Size<font color="#000080">;
  </font>BarCol<font color="#000080">:=</font>BackCol<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">+</font>ForCol<font color="#000080">;
  </font>wValue<font color="#000080">:=</font>ORD<font color="#000080">(</font><font color="#800000">'&sup2;'</font><font color="#000080">)+</font>BarCol<font color="#000080">*</font><font color="#800000">256</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>ix<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BarSize<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    </b></font>MEMW<font color="#000080">[</font>SCSEG<font color="#000080">:</font>BarOffs<font color="#000080">+</font>ix<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">]:=</font>wValue<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>(* InitBar(Xpos,Ypos,Size,ForCol,BackCol:BYTE) *)

(***************************************************************************
(* Name    : UpdateBar(Curr:BYTE)
(* Purpose : Updates the bar with the current percentage. Curr is a percen-
(*           tage value between 0 and 100.
(* Returns : None
(***************************************************************************)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>UpdateBar<font color="#000080">(</font>Curr<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>ix             <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>pSize          <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>wValue         <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>pSize<font color="#000080">:=</font>TRUNC<font color="#000080">((</font>Curr<font color="#000080">/</font><font color="#800000">100</font><font color="#000080">)*</font>BarSize<font color="#000080">);
  </font>wValue<font color="#000080">:=</font>ORD<font color="#000080">(</font><font color="#800000">'&Ucirc;'</font><font color="#000080">)+</font>BarCol<font color="#000080">*</font><font color="#800000">256</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>ix<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>pSize<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    </b></font>MEMW<font color="#000080">[</font>SCSEG<font color="#000080">:</font>BarOffs<font color="#000080">+</font>ix<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">]:=</font>wValue<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>(* UpdateBar(Curr:BYTE) *)

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>(* Here is a little test program *)
</i></font><font color="#FF0000"><b>PROGRAM </b></font>PercTest<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>Perc_Bar<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>count          <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>InitBar<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>count<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">10000 </font><font color="#FF0000"><b>DO
    </b></font>UpdateBar<font color="#000080">(</font>TRUNC<font color="#000080">((</font>count<font color="#000080">/</font><font color="#800000">10000</font><font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0177.PAS">Original</a><b>]</b></p></body>
</html>
