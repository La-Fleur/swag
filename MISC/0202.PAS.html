<html>
<head><title> "TP example to Change Windows Wallpaper" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0202.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>ChgPic<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">, </font>Strings<font color="#000080">;
</font><font color="#FF0000"><b>Const
    </b></font>FindPath <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'C:\windows\*.bmp'</font><font color="#000080">;
    </font>WallPaper <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">'WALLPAPER'</font><font color="#000080">;
</font><font color="#FF0000"><b>Type
    </b></font>PicPtr  <font color="#000080">= ^</font>NameRec<font color="#000080">;
    </font>LinePtr <font color="#000080">= ^</font>LineRec<font color="#000080">;
    </font>NameRec <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>PicName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
        </font>Next    <font color="#000080">: </font>PicPtr<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>LineRec <font color="#000080">= </font><font color="#FF0000"><b>Record
        </b></font>ALine <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
        </font>NextLine <font color="#000080">: </font>LinePtr<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
</b></font>	DirInfo    <font color="#000080">: </font>SearchRec<font color="#000080">;
    </font>First<font color="#000080">, </font>hldptr <font color="#000080">: </font>PicPtr<font color="#000080">;
    </font>Current    <font color="#000080">: </font>PicPtr<font color="#000080">;
    </font>FirstLine<font color="#000080">, </font>CurrentLine<font color="#000080">,
    </font>TmpLine<font color="#000080">, </font>LastLIne <font color="#000080">: </font>LinePtr<font color="#000080">;
    </font>Count<font color="#000080">, </font>Ix<font color="#000080">,
    </font>Nbr        <font color="#000080">: </font>Integer<font color="#000080">;
    </font>FileIn<font color="#000080">, </font>FileOt <font color="#000080">: </font>Text<font color="#000080">;
    </font>WorkLine       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
    </font>CkWallPaper    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">];
    </font>HoldName       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
    </font>TestMode       <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
    If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
       </b></font>TestMode <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>First <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
    </font>Count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>	FindFirst<font color="#000080">(</font>FindPath<font color="#000080">, </font>AnyFile<font color="#000080">, </font>DirInfo<font color="#000080">);
    </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
    Begin
        </b></font>New <font color="#000080">(</font>Current<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>First <font color="#000080">= </font><font color="#FF0000"><b>Nil Then
        Begin
            </b></font>First <font color="#000080">:= </font>Current<font color="#000080">;
            </font>Current<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End
        Else
        Begin
            </b></font>Current<font color="#000080">^.</font>Next <font color="#000080">:= </font>First<font color="#000080">;
            </font>First <font color="#000080">:= </font>Current<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Current<font color="#000080">^.</font>PicName <font color="#000080">:= </font>DirInfo<font color="#000080">.</font>Name<font color="#000080">;
        </font>Inc<font color="#000080">(</font>Count<font color="#000080">);
        </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Randomize<font color="#000080">;
    </font>Nbr <font color="#000080">:= </font>Random<font color="#000080">(</font>Count<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
    </font>Current <font color="#000080">:= </font>First<font color="#000080">;
    </font>HoldName <font color="#000080">:= </font>Current<font color="#000080">^.</font>PicName<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>Ix <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Nbr <font color="#FF0000"><b>Do
    Begin
        </b></font>hldptr <font color="#000080">:= </font>Current<font color="#000080">;
        </font>Current <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next<font color="#000080">;
        </font>HoldName <font color="#000080">:= </font>Current<font color="#000080">^.</font>PicName<font color="#000080">;
        </font>Dispose <font color="#000080">(</font>hldptr<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>TestMode <font color="#FF0000"><b>Then
       </b></font>Writeln <font color="#000080">(</font>HoldName<font color="#000080">);
    </font><font color="#FF0000"><b>While </b></font>Current <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil Do
    Begin
         </b></font>HldPtr <font color="#000080">:= </font>Current<font color="#000080">;
         </font>Current <font color="#000080">:= </font>Current<font color="#000080">^.</font>Next<font color="#000080">;
         </font>Dispose <font color="#000080">(</font>hldptr<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>FirstLine <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
    </font>Assign <font color="#000080">(</font>FileIn<font color="#000080">, </font><font color="#800000">'c:\windows\win.ini'</font><font color="#000080">);
    </font>Reset <font color="#000080">(</font>FileIn<font color="#000080">);
    </font><font color="#FF0000"><b>While NOT </b></font>EOF<font color="#000080">(</font>FileIn<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
        </b></font>Readln<font color="#000080">(</font>Filein<font color="#000080">, </font>WorkLine<font color="#000080">);
        </font>CkWallPaper <font color="#000080">:= </font>Copy <font color="#000080">(</font>WorkLine<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
        </font><font color="#FF0000"><b>For </b></font>Ix <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>CkWallPaper<font color="#000080">) </font><font color="#FF0000"><b>Do
            </b></font>CkWallPaper<font color="#000080">[</font>Ix<font color="#000080">] := </font>UpCase<font color="#000080">(</font>CkWallPaper<font color="#000080">[</font>Ix<font color="#000080">]);
        </font>New <font color="#000080">(</font>CurrentLine<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CkWallPaper <font color="#000080">= </font>WallPaper<font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
           </b></font>CurrentLine<font color="#000080">^.</font>ALine <font color="#000080">:= </font><font color="#800000">'WallPaper=' </font><font color="#000080">+ </font>HoldName<font color="#000080">;
            </font><font color="#FF0000"><b>if </b></font>TestMode <font color="#FF0000"><b>Then
                </b></font>Writeln<font color="#000080">(</font>CurrentLine<font color="#000080">^.</font>ALine<font color="#000080">);
        </font><font color="#FF0000"><b>End
        Else
            </b></font>CurrentLIne<font color="#000080">^.</font>ALine <font color="#000080">:= </font>WorkLine<font color="#000080">;
        </font>CurrentLIne<font color="#000080">^.</font>NextLine <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>FirstLine <font color="#000080">= </font><font color="#FF0000"><b>NIL Then
            </b></font>FirstLine <font color="#000080">:= </font>CurrentLIne
        <font color="#FF0000"><b>Else
            </b></font>LastLIne<font color="#000080">^.</font>NextLIne <font color="#000080">:= </font>CurrentLine<font color="#000080">;
        </font>LastLine <font color="#000080">:= </font>CurrentLine<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Close <font color="#000080">(</font>FileIn<font color="#000080">);
    </font>Rewrite<font color="#000080">(</font>FileIn<font color="#000080">);
    </font>CurrentLine <font color="#000080">:= </font>FirstLine<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>CurrentLine <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL Do
    Begin
        </b></font>Writeln<font color="#000080">(</font>FileIn<font color="#000080">, </font>CurrentLine<font color="#000080">^.</font>ALine<font color="#000080">);
        </font>CurrentLIne <font color="#000080">:= </font>CurrentLIne<font color="#000080">^.</font>NextLine<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Close<font color="#000080">(</font>FileIn<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>TestMode <font color="#FF0000"><b>Then
       </b></font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0202.PAS">Original</a><b>]</b></p></body>
</html>
