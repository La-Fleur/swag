<html>
<head><title> "Maze Generator I" by BJ™RN FELTEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0144.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   In the meantime the readers might want to play around with the following
code, that I think I originally picked up in this invaluable conference some
years ago (or it may have been the SWAG -- don't remember really). I've
altered the original code so it can be compiled without any other special
units but my cursorUnit, that comes next.
}

</i></font><font color="#FF0000"><b>program </b></font>MazeSolver<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Crt<font color="#000080">, </font>cursorUnit<font color="#000080">;

</font><font color="#008000"><i>{$R-,S-,M 16384, 16384, 16384
  Program draws and solves a 23x78 maze.
  The algorithm used by Maze is adapted from one given in Chapter 4 of
  &quot;The Elements of Programming Style&quot; by B. Kernighan and P.J. Plauger
  (McGraw-Hill, 1978)

  This version for the IBM PC: Wilbert van Leijen
  Written:     16 Sept. 1987
  Revised:     19 March 1989
  Revised:     Jan 15th 1995 by Bj”rn Felten @ 2:203/208
}

</i></font><font color="#FF0000"><b>const
  </b></font>Title        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] = </font><font color="#800000">' Maze '</font><font color="#000080">;
  </font>Usage        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">38</font><font color="#000080">] = </font><font color="#800000">' F1&Auml;Full speed F2&Auml;Delay move Esc&Auml;Quit '</font><font color="#000080">;
  </font>MazeX        <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">;
  </font>MazeY        <font color="#000080">= </font><font color="#800000">22</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>MazeSquare   <font color="#000080">= (</font>Wall<font color="#000080">, </font>Path<font color="#000080">);
  </font>MazeArray    <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MazeX<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font>MazeY<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>MazeSquare<font color="#000080">;
  </font>Direction    <font color="#000080">= (</font>GoUp<font color="#000080">, </font>GoDown<font color="#000080">, </font>GoLeft<font color="#000080">, </font>GoRight<font color="#000080">);
  </font>ScrBuffer    <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">; </font><font color="#008000"><i>(* Screen Buffer *)

</i></font><font color="#FF0000"><b>var
  </b></font>FullSpeed    <font color="#000080">: </font>boolean<font color="#000080">;
  </font>ImageBuffer  <font color="#000080">: </font>pointer<font color="#000080">;
  </font>Maze         <font color="#000080">: </font>MazeArray<font color="#000080">;
  </font>X<font color="#000080">, </font>Y         <font color="#000080">: </font>integer<font color="#000080">;
  </font>Screen       <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ScrBuffer <font color="#FF0000"><b>absolute </b></font><font color="#800000">$B800</font><font color="#000080">: </font><font color="#800000">0000</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>WriteXY <font color="#000080">(</font>Page<font color="#000080">, </font>Attrib<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>word<font color="#000080">; </font>N<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

  </font><font color="#FF0000"><b>function </b></font>x80p<font color="#000080">(</font>Y<font color="#000080">, </font>X<font color="#000080">: </font>word<font color="#000080">): </font>word<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
      </b></font><font color="#FF00FF">MOV AX,Y
      MOV BX,AX
      MOV CL,4
      SHL BX,CL
      MOV CL,6
      SHL AX,CL
      ADD AX,BX
      ADD AX,X
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>I<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>N<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>then for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>N<font color="#000080">) </font><font color="#FF0000"><b>do
     </b></font>Screen<font color="#000080">[</font>Page<font color="#000080">][</font>X80p<font color="#000080">(</font>Y<font color="#000080">,</font>X<font color="#000080">+</font>pred<font color="#000080">(</font>I<font color="#000080">))]:=(</font>Attrib <font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>ord<font color="#000080">(</font>N<font color="#000080">[</font>I<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Set up a frame around the activities }

</i></font><font color="#FF0000"><b>procedure </b></font>Frame<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$1F</font><font color="#000080">, </font><font color="#800000">37</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font>Title<font color="#000080">);
  </font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$17</font><font color="#000080">, </font><font color="#800000">41</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font>Usage<font color="#000080">);
  </font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$31</font><font color="#000080">, </font><font color="#800000">42</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">'F1'</font><font color="#000080">);
  </font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$31</font><font color="#000080">, </font><font color="#800000">56</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">'F2'</font><font color="#000080">);
  </font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$31</font><font color="#000080">, </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">24</font><font color="#000080">, </font><font color="#800000">'Esc'</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ShowMaze<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>integer<font color="#000080">; </font>Show<font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$1B</font><font color="#000080">, </font>X<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>Show<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ ShowMaze }

{ Set up maze }

</i></font><font color="#FF0000"><b>procedure </b></font>CreateMaze<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>X<font color="#000080">, </font>Y         <font color="#000080">: </font>integer<font color="#000080">;
  </font>MazeAction   <font color="#000080">: </font>Direction<font color="#000080">;

  </font><font color="#008000"><i>{ Set a given maze element to be Path or Wall }

  </i></font><font color="#FF0000"><b>procedure </b></font>SetSquare<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>integer<font color="#000080">; </font>Val<font color="#000080">: </font>MazeSquare<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>Maze<font color="#000080">[</font>X<font color="#000080">, </font>Y<font color="#000080">] := </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>Val <font color="#FF0000"><b>of
      </b></font>Path <font color="#000080">: </font>ShowMaze<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
      </font>Wall <font color="#000080">: </font>WriteXY<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$0F</font><font color="#000080">, </font>X<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">'&Ucirc;'</font><font color="#000080">)
    </font><font color="#FF0000"><b>end
  end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ SetSquare }

  { Return a random value of direction }

  </i></font><font color="#FF0000"><b>function </b></font>RandomDirection <font color="#000080">: </font>Direction<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    case </b></font>Random<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">0 </font><font color="#000080">: </font>RandomDirection <font color="#000080">:= </font>GoUp<font color="#000080">;
      </font><font color="#800000">1 </font><font color="#000080">: </font>RandomDirection <font color="#000080">:= </font>GoDown<font color="#000080">;
      </font><font color="#800000">2 </font><font color="#000080">: </font>RandomDirection <font color="#000080">:= </font>GoLeft<font color="#000080">;
      </font><font color="#800000">3 </font><font color="#000080">: </font>RandomDirection <font color="#000080">:= </font>GoRight<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ RandomDirection }

  { Return a random element in the maze }

  </i></font><font color="#FF0000"><b>function </b></font>RandomDig<font color="#000080">(</font>max <font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>RandomDig <font color="#000080">:= </font><font color="#800000">2 </font><font color="#000080">* </font>Random<font color="#000080">(</font>max <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">1
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ RandomDig }

  { Check wether a legal path can be built }

  </i></font><font color="#FF0000"><b>Function </b></font>LegalPath<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>integer<font color="#000080">;
               </font>MazeAction <font color="#000080">: </font>Direction<font color="#000080">) : </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>LegalPath <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>MazeAction <font color="#FF0000"><b>of
      </b></font>GoUp    <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>y <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
                  </b></font>LegalPath <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">] = </font>Wall<font color="#000080">);
      </font>GoDown  <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>y <font color="#000080">&lt; </font>MazeY<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>then
                  </b></font>LegalPath <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">] = </font>Wall<font color="#000080">);
      </font>GoLeft  <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>x <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
                  </b></font>LegalPath <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">, </font>y<font color="#000080">] = </font>Wall<font color="#000080">);
      </font>GoRight <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>x <font color="#000080">&lt; </font>MazeX<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>then
                  </b></font>LegalPath <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>y<font color="#000080">] = </font>Wall<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ LegalPath }

  { Extend path in given direction }

  </i></font><font color="#FF0000"><b>Procedure </b></font>Buildpath<font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>integer<font color="#000080">;
                </font>MazeAction <font color="#000080">: </font>Direction<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>Unused     <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>Direction<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    case </b></font>MazeAction <font color="#FF0000"><b>of
      </b></font>GoUp    <font color="#000080">: </font><font color="#FF0000"><b>begin
                  </b></font>SetSquare<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>Path<font color="#000080">);
                  </font>SetSquare<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">, </font>Path<font color="#000080">);
                  </font>dec<font color="#000080">(</font>Y<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>GoDown  <font color="#000080">: </font><font color="#FF0000"><b>begin
                  </b></font>SetSquare<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>Path<font color="#000080">);
                  </font>SetSquare<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Path<font color="#000080">);
                  </font>inc<font color="#000080">(</font>Y<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>GoLeft  <font color="#000080">: </font><font color="#FF0000"><b>begin
                  </b></font>SetSquare<font color="#000080">(</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>Y<font color="#000080">, </font>Path<font color="#000080">);
                  </font>SetSquare<font color="#000080">(</font>X<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">, </font>Y<font color="#000080">, </font>Path<font color="#000080">);
                  </font>dec<font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>GoRight <font color="#000080">: </font><font color="#FF0000"><b>begin
                  </b></font>SetSquare<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>Y<font color="#000080">, </font>Path<font color="#000080">);
                  </font>SetSquare<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Y<font color="#000080">, </font>Path<font color="#000080">);
                  </font>inc<font color="#000080">(</font>X<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">)
                </font><font color="#FF0000"><b>end
    end</b></font><font color="#000080">;
    </font>Unused <font color="#000080">:= [</font>GoUp<font color="#000080">..</font>GoRight<font color="#000080">];
    </font><font color="#FF0000"><b>repeat                             </b></font><font color="#008000"><i>{ Check direction for legality }
      </i></font>MazeAction <font color="#000080">:= </font>RandomDirection<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>MazeAction <font color="#FF0000"><b>in </b></font>Unused <font color="#FF0000"><b>then     </b></font><font color="#008000"><i>{ If so, extend in that direction }
        </i></font><font color="#FF0000"><b>begin
          </b></font>Unused <font color="#000080">:= </font>Unused<font color="#000080">-[</font>MazeAction<font color="#000080">];
          </font><font color="#FF0000"><b>if </b></font>LegalPath<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>MazeAction<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>BuildPath<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>MazeAction<font color="#000080">)
        </font><font color="#FF0000"><b>end
    until </b></font>Unused <font color="#000080">= []                  </font><font color="#008000"><i>{ All legal moves are exhausted }
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ BuildPath }

  { CreateMaze initially draws a maze that is 'solid rock'.
    Then the maze will be 'excavated' by setting the elements of
    the maze to path. It keeps digging until all legal paths are
    exhausted and, finally, it digs an 'entrance' and 'exit' path
    on the boundaries of the maze }

</i></font><font color="#FF0000"><b>begin
  for </b></font>y <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MazeY <font color="#FF0000"><b>do               </b></font><font color="#008000"><i>{ Setup 'solid rock' }
    </i></font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MazeX <font color="#FF0000"><b>do
      </b></font>SetSquare<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>Wall<font color="#000080">);
  </font>y <font color="#000080">:= </font>RandomDig<font color="#000080">(</font>MazeY<font color="#000080">);               </font><font color="#008000"><i>{ Starting point }
  </i></font>x <font color="#000080">:= </font>RandomDig<font color="#000080">(</font>MazeX<font color="#000080">);
  </font>SetSquare<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>Path<font color="#000080">);
  </font><font color="#FF0000"><b>repeat                               </b></font><font color="#008000"><i>{ Dig path in maze }
    </i></font>MazeAction <font color="#000080">:= </font>RandomDirection
  <font color="#FF0000"><b>until </b></font>LegalPath<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>MazeAction<font color="#000080">);
  </font>BuildPath<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>MazeAction<font color="#000080">);
  </font>x <font color="#000080">:= </font>RandomDig<font color="#000080">(</font>MazeX<font color="#000080">);
  </font>SetSquare<font color="#000080">(</font>x<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Path<font color="#000080">);               </font><font color="#008000"><i>{ Dig entrance }
  </i></font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">#25</font><font color="#000080">);
  </font>x <font color="#000080">:= </font>RandomDig<font color="#000080">(</font>MazeX<font color="#000080">);
  </font>SetSquare<font color="#000080">(</font>x<font color="#000080">, </font>MazeY<font color="#000080">, </font>Path<font color="#000080">)            </font><font color="#008000"><i>{ Dig exit }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ CreateMaze }

{ Solve the maze }

</i></font><font color="#FF0000"><b>procedure </b></font>SolveMaze<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Solved       <font color="#000080">: </font>boolean<font color="#000080">;
  </font>x<font color="#000080">, </font>y         <font color="#000080">: </font>integer<font color="#000080">;
  </font>Tried        <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MazeX<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font>MazeY<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>boolean<font color="#000080">;

  </font><font color="#008000"><i>{ Attempt Maze solution from point in given direction }

  </i></font><font color="#FF0000"><b>function Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>integer<font color="#000080">;
         </font>MazeAction <font color="#000080">: </font>Direction<font color="#000080">) : </font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Ok         <font color="#000080">: </font>boolean<font color="#000080">;

    </font><font color="#008000"><i>{ Draw attempted move on screen }

    </i></font><font color="#FF0000"><b>procedure </b></font>MoveMaze<font color="#000080">(</font>MazeAction <font color="#000080">: </font>Direction<font color="#000080">);

    </font><font color="#FF0000"><b>begin
      if not </b></font>FullSpeed <font color="#FF0000"><b>then
        </b></font>Delay<font color="#000080">(</font><font color="#800000">80</font><font color="#000080">);
      </font><font color="#FF0000"><b>case </b></font>MazeAction <font color="#FF0000"><b>of
        </b></font>GoUp    <font color="#000080">: </font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">#24</font><font color="#000080">);
        </font>GoDown  <font color="#000080">: </font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">#25</font><font color="#000080">);
        </font>GoLeft  <font color="#000080">: </font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">#27</font><font color="#000080">);
        </font>GoRight <font color="#000080">: </font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">#26</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
    end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ MoveMaze }

  { Check whether there is a path to the boundary from a given
    point in a given direction. It returns True if there exists
    a path; otherwise, the Try is False }

  </i></font><font color="#FF0000"><b>begin
    </b></font>Ok <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">] = </font>Path<font color="#000080">);         </font><font color="#008000"><i>{ If Wall, no solution exist }
    </i></font><font color="#FF0000"><b>if </b></font>Ok <font color="#FF0000"><b>then begin
        </b></font>Tried<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">] := </font>True<font color="#000080">;           </font><font color="#008000"><i>{ Set Tried flag }
        </i></font><font color="#FF0000"><b>case </b></font>MazeAction <font color="#FF0000"><b>of
          </b></font>GoUp    <font color="#000080">: </font>Dec<font color="#000080">(</font>y<font color="#000080">);
          </font>GoDown  <font color="#000080">: </font>Inc<font color="#000080">(</font>y<font color="#000080">);
          </font>GoLeft  <font color="#000080">: </font>Dec<font color="#000080">(</font>x<font color="#000080">);
          </font>GoRight <font color="#000080">: </font>Inc<font color="#000080">(</font>x<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Ok <font color="#000080">:= (</font>Maze<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">] = </font>Path<font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>Tried<font color="#000080">[</font>x<font color="#000080">, </font>y<font color="#000080">];
        </font><font color="#FF0000"><b>if </b></font>Ok <font color="#FF0000"><b>then begin               </b></font><font color="#008000"><i>{ Consider neighbouring square }
            </i></font>MoveMaze<font color="#000080">(</font>MazeAction<font color="#000080">);
            </font>Ok <font color="#000080">:= (</font>y <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>y <font color="#000080">&gt;= </font>MazeY<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>x <font color="#000080">&gt;= </font>MazeX<font color="#000080">);
            </font><font color="#FF0000"><b>if not </b></font>Ok <font color="#FF0000"><b>then
              </b></font>Ok <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoLeft<font color="#000080">);
            </font><font color="#FF0000"><b>if not </b></font>Ok <font color="#FF0000"><b>then
              </b></font>Ok <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoDown<font color="#000080">);
            </font><font color="#FF0000"><b>if not </b></font>Ok <font color="#FF0000"><b>then
              </b></font>Ok <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoRight<font color="#000080">);
            </font><font color="#FF0000"><b>if not </b></font>Ok <font color="#FF0000"><b>then
              </b></font>Ok <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoUp<font color="#000080">);
            </font><font color="#FF0000"><b>if not </b></font>Ok <font color="#FF0000"><b>then
              </b></font>ShowMaze<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Try </b></font><font color="#000080">:= </font>Ok<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ Try }

{ SolveMaze looks for a continuous sequence of Path squares from one
  point on the boundary of the maze to another }

</i></font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Tried<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Tried<font color="#000080">), </font>False<font color="#000080">);
  </font>Solved <font color="#000080">:= </font>False<font color="#000080">;
  </font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>y <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>Solved <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y <font color="#000080">&lt; </font>MazeY<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Solved <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoRight<font color="#000080">);
    </font>inc<font color="#000080">(</font>y<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>x <font color="#000080">:= </font>MazeX<font color="#000080">;
  </font>y <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>Solved <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y <font color="#000080">&lt; </font>MazeY<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Solved <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoLeft<font color="#000080">);
    </font>inc<font color="#000080">(</font>y<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>Solved <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x <font color="#000080">&lt; </font>MazeX<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Solved <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoDown<font color="#000080">);
    </font>Inc<font color="#000080">(</font>x<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>y <font color="#000080">:= </font>MazeY<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>Solved <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x <font color="#000080">&lt; </font>MazeX<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Solved <font color="#000080">:= </font><font color="#FF0000"><b>Try</b></font><font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>GoUp<font color="#000080">);
    </font>Inc<font color="#000080">(</font>x<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Solved <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>repeat until </b></font>KeyPressed
<font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ SolveMaze }

</i></font><font color="#FF0000"><b>procedure </b></font>Mainline<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>F1           <font color="#000080">= </font><font color="#800000">#59</font><font color="#000080">;
  </font>F2           <font color="#000080">= </font><font color="#800000">#60</font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Ch           <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin
  repeat
    </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>Ch <font color="#FF0000"><b>of
      </b></font>F1 <font color="#000080">: </font><font color="#FF0000"><b>begin
             </b></font>CreateMaze<font color="#000080">;
             </font>FullSpeed <font color="#000080">:= </font>True<font color="#000080">;
             </font>SolveMaze
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>F2 <font color="#000080">: </font><font color="#FF0000"><b>begin
             </b></font>CreateMaze<font color="#000080">;
             </font>FullSpeed <font color="#000080">:= </font>False<font color="#000080">;
             </font>SolveMaze
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  until </b></font>Ch <font color="#000080">= </font><font color="#800000">#27
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ Mainline }

</i></font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>Frame<font color="#000080">;
  </font>cursorOff<font color="#000080">;
  </font>Randomize<font color="#000080">;
  </font>Mainline<font color="#000080">;
  </font>cursorOn
<font color="#FF0000"><b>end</b></font><font color="#000080">.  </font><font color="#008000"><i>{ MazeSolver }


{
  From: Lou Duchez                                   Read: Yes    Replied: No

Very nice!  My algorithm grows walls, but your algorithm digs corridors.
Your algorithm also seems to generate more complicated mazes than mine.
My only concern is that it relies so heavily on recursion; you risk
running out of stack space.  Of course, with my algorithm, you allocate
lots of arrays that take up data segment ...

Thanks for posting it!

As I comprehend it, the maze-generating algorithm is like this:

- Draw a field composed entirely of walls.

- Select a random spot in the field to be your very first corridor spot.

- Here is the maze-digging routine:
  
  - (This routine takes two value parameters: the X and Y coordinates of
    your current location.)

  - If you can randomly select a valid location two units away from those
    X / Y coordinates (where &quot;valid locations&quot; are those that currently
    are walls and not corridors):
  
    - &quot;Dig a corridor&quot; from the X / Y location to that randomly-
      selected location.
    
    - Recursively call this routine; as parameters, pass the X and Y
      coordinates of that randomly-selected location.  (On the first
      pass, use that randomly-selected first corridor spot as the X and
      Y coordinates.)

- When the recursion ends, the maze is done.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0144.PAS">Original</a><b>]</b></p></body>
</html>
