<html>
<head><title> "32-Bit ASM" by ALEX CHALFIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ Updated MISC.SWG on May 26, 1995 }

{
&gt; I've seen a message where some guys were talking about 32 bits
&gt; graphics programming. It was something like this
&gt; db $66
&gt; MOVSW
&gt; When you use this it will move four bytes instead of 2.
&gt; My problem is were to put those 4 bytes which should be stord.
&gt; I know the first 2 bytes should be put in AX but were should you put
&gt; the next 2. The trouble is that you can't use EAX because it's a 386
&gt; instruction. I hope you can help me with this

 Using db 66h; Movsw is the same as the ASM instruction Movsd. AX and EAX
 are not used in this operation. A double word at [ds:si] is moved to [es:di]
 and si and di are incremented. In the case of db 66h; Stosw (an ASM Stosd),
 you must have a value in EAX. If you are clearing a screen, you must place
 the color value in each byte.

 Here are some sample procedures that use these ideas:
}
</i></font><font color="#FF0000"><b>Procedure </b></font>ClearScreen<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Screen<font color="#000080">; </font>Color <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{$G+} { Enable 286 instructions }
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Les  di,Screen    </font><font color="#008000"><i>{ Load a the pointer to the screen into [es:di] }
  </i></font><font color="#FF00FF">Mov  al,Color
  Mov  ah,al
 db 66h; Shl ax,16
  Mov  al,Color
  Mov  ah,al
  Mov  cx,16000   </font><font color="#008000"><i>{ Store 16000 DWords }
 </i></font><font color="#FF00FF">db 66h Rep Stosw
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>In </b></font>this <font color="#FF0000"><b>case</b></font><font color="#000080">, </font><font color="#FF0000"><b>if </b></font>the color value was <font color="#800000">$34</font><font color="#000080">, </font>EAX would equal <font color="#800000">$34343434</font><font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>this would be stored <font color="#FF0000"><b>to </b></font>the screen<font color="#000080">.

</font><font color="#FF0000"><b>Procedure </b></font>CopyScreen<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Push  ds        </font><font color="#008000"><i>{ TP doesn't save DS }
  </i></font><font color="#FF00FF">Les   di,Dest
  Lds   si,Source
  Mov   cx,16000
 db 66h; Rep Movsw  </font><font color="#008000"><i>{ Move 16000 words at [ds:si] to [es:di] }
  </i></font><font color="#FF00FF">Pop   ds
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p></body>
</html>
