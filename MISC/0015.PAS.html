<html>
<head><title> "SUNDRY.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>sundry<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>Dos<font color="#000080">,
  </font>sCrt<font color="#000080">,
  </font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>LongWds <font color="#000080">= </font><font color="#FF0000"><b>Record
              </b></font>loWord<font color="#000080">,
              </font>hiWord <font color="#000080">: </font>Word<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ica_rec <font color="#000080">= </font><font color="#FF0000"><b>Record
              Case </b></font>Integer <font color="#FF0000"><b>of
                </b></font><font color="#800000">0</font><font color="#000080">: (</font>Bytes   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">);
                </font><font color="#800000">1</font><font color="#000080">: (</font>Words   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">);
                </font><font color="#800000">2</font><font color="#000080">: (</font>Integers<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">);
                </font><font color="#800000">3</font><font color="#000080">: (</font>strg    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">15</font><font color="#000080">]);
                </font><font color="#800000">4</font><font color="#000080">: (</font>longs   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>LongInt<font color="#000080">);
                </font><font color="#800000">5</font><font color="#000080">: (</font>dummy   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">13</font><font color="#000080">]; </font>chksum<font color="#000080">: </font>Integer<font color="#000080">);
                </font><font color="#800000">6</font><font color="#000080">: (</font>mix     <font color="#000080">: </font>Byte<font color="#000080">; </font>wds <font color="#000080">: </font>Word<font color="#000080">; </font>lng <font color="#000080">: </font>LongInt<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{-This simply creates a Variant Record which is mapped to 0000:04F0
  which is the intra-applications communications area in the bios area
  of memory. A Program may make use of any of the 16 Bytes in this area
  and be assured that Dos and the bios will not interfere With it. This
  means that it can be effectively used to pass values/inFormation
  between different Programs. It can conceivably be used to store
  inFormation from an application, then terminate from that application,
  run several other Programs, and then have another Program use the
  stored inFormation. As the area can be used by any Program, it is wise
  to incorporate a checksum to ensure that the intermediate applications
  have not altered any values. It is of most use when executing child
  processes or passing values between related Programs that are run
  consecutively.}

  </i></font>IOproc <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>derror<font color="#000080">:</font>Byte<font color="#000080">; </font>msg <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Const
  </b></font>ValidChars <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">] = </font><font color="#800000">' ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-'</font><font color="#000080">+</font><font color="#800000">#39</font><font color="#000080">;
  </font>HexChars <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>ica <font color="#000080">: </font>ica_rec <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$04f0</font><font color="#000080">;
  </font>FilePosition <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#008000"><i>(*  OldRecSize   : Word; *)
  </i></font>TempStr      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CheckIO<font color="#000080">(</font>Error_action <font color="#000080">: </font>IOproc<font color="#000080">; </font>msg <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>CompressStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-Will Compress 3 alpha-numeric Bytes into 2 Bytes}

</i></font><font color="#FF0000"><b>Function </b></font>DeCompress<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-DeCompresses a String Compressed by CompressStr}

</i></font><font color="#FF0000"><b>Function </b></font>NumbofElements<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>size <font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
  </font><font color="#008000"><i>{-returns the number of active elements in a set}

</i></font><font color="#FF0000"><b>Function </b></font>PrinterStatus <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#008000"><i>{-Gets the Printer status}

</i></font><font color="#FF0000"><b>Function </b></font>PrinterReady<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>b <font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TestBbit<font color="#000080">(</font>n<font color="#000080">,</font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>TestWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>TestLbit<font color="#000080">(</font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>Byte<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetLbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>ResetBbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>Byte<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ResetWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ResetLbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>right<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>left<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>shleft<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>nExtStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s1<font color="#000080">; </font>s2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WriteAtCr<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteLnAtCr<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteLNCenter<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>width<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteCenter<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>width<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>GotoCR<font color="#000080">(</font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);

  </font><font color="#008000"><i>{-These Functions and Procedures Unit provides the means to do random
    access reads on Text Files.  }

</i></font><font color="#FF0000"><b>Function </b></font>Exist<font color="#000080">(</font>fn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Asc2Str<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>max<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DisableBlink<font color="#000080">(</font>State<font color="#000080">:</font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>Byte2Hex<font color="#000080">(</font>numb <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Numb2Hex<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>numb<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Long2Hex<font color="#000080">(</font>long <font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Byte<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Word<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Integer<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Long<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>LongInt<font color="#000080">;

</font><font color="#008000"><i>{======================================================================}


</i></font><font color="#FF0000"><b>Implementation

Procedure </b></font>CheckIO<font color="#000080">(</font>error_action <font color="#000080">: </font>IOproc<font color="#000080">;</font>msg <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Var </b></font>c <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>c <font color="#000080">:= </font>Ioresult<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>error_action<font color="#000080">(</font>c<font color="#000080">,</font>msg<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{$F+}
</i></font><font color="#FF0000"><b>Procedure </b></font>ReportError<font color="#000080">(</font>c <font color="#000080">: </font>Byte<font color="#000080">; </font>st <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'I/O Error '</font><font color="#000080">,</font>c<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>st<font color="#000080">);
    </font>halt<font color="#000080">(</font>c<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}

</i></font><font color="#FF0000"><b>Function </b></font>StUpCase<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Count <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Str<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Str<font color="#000080">[</font>Count<font color="#000080">] := </font>UpCase<font color="#000080">(</font>Str<font color="#000080">[</font>Count<font color="#000080">]);
  </font>StUpCase <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Function </b></font>CompressStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>S      <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>n<font color="#000080">;
    </font>InStr  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>len    <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>InStr<font color="#000080">;
    </font>Compstr<font color="#000080">: </font><font color="#FF0000"><b>Record
              Case </b></font>Byte <font color="#FF0000"><b>of
                </b></font><font color="#800000">0</font><font color="#000080">: (</font>Outlen  <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>OutArray<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">84</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">);
                </font><font color="#800000">1</font><font color="#000080">: (</font><font color="#FF0000"><b>Out     </b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">170</font><font color="#000080">]);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>temp<font color="#000080">,
    </font>x<font color="#000080">,
    </font>count <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>FillChar<font color="#000080">(</font>InStr<font color="#000080">,</font><font color="#800000">256</font><font color="#000080">,</font><font color="#800000">32</font><font color="#000080">);
    </font>InStr <font color="#000080">:= </font>S<font color="#000080">;
    </font>len   <font color="#000080">:= (</font>len <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">3 </font><font color="#000080">* </font><font color="#800000">3</font><font color="#000080">;
    </font>FillChar<font color="#000080">(</font>CompStr<font color="#000080">.</font><font color="#FF0000"><b>Out</b></font><font color="#000080">,</font><font color="#800000">171</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font>InStr <font color="#000080">:= </font>StUpCase<font color="#000080">(</font>InStr<font color="#000080">);
    </font>x <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>x <font color="#000080">&lt;= </font>len <font color="#FF0000"><b>do begin
      </b></font>temp  <font color="#000080">:= </font>pos<font color="#000080">(</font>InStr<font color="#000080">[</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">],</font>ValidChars<font color="#000080">);
      </font>inc<font color="#000080">(</font>temp<font color="#000080">,</font>pos<font color="#000080">(</font>InStr<font color="#000080">[</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>ValidChars<font color="#000080">) * </font><font color="#800000">40</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>temp<font color="#000080">,</font>pos<font color="#000080">(</font>InStr<font color="#000080">[</font>x<font color="#000080">],</font>ValidChars<font color="#000080">) * </font><font color="#800000">1600</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>x<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
      </font>CompStr<font color="#000080">.</font>OutArray<font color="#000080">[</font>count<font color="#000080">] := </font>temp<font color="#000080">;
      </font>inc<font color="#000080">(</font>count<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>CompStr<font color="#000080">.</font>Outlen <font color="#000080">:= </font>count <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
    </font>CompressStr <font color="#000080">:= </font>CompStr<font color="#000080">.</font><font color="#FF0000"><b>Out</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{-CompressStr}

</i></font><font color="#FF0000"><b>Function </b></font>DeCompress<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>CompStr <font color="#000080">: </font><font color="#FF0000"><b>Record
                </b></font>clen <font color="#000080">: </font>Byte<font color="#000080">;
                </font>arry <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">84</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;
              </font><font color="#FF0000"><b>end Absolute </b></font>s<font color="#000080">;
    </font>x<font color="#000080">,
    </font>count<font color="#000080">,
    </font>temp    <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    With </b></font>CompStr <font color="#FF0000"><b>do begin
      </b></font>DeCompress<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Char<font color="#000080">((</font>clen <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">);
      </font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font>x <font color="#000080">&lt;= </font>clen <font color="#FF0000"><b>shr </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
        </b></font>temp <font color="#000080">:= </font>arry<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>div </b></font><font color="#800000">1600</font><font color="#000080">;
        </font>dec<font color="#000080">(</font>arry<font color="#000080">[</font>x<font color="#000080">],</font>temp<font color="#000080">*</font><font color="#800000">1600</font><font color="#000080">);
        </font>DeCompress<font color="#000080">[</font>count<font color="#000080">] := </font>ValidChars<font color="#000080">[</font>temp<font color="#000080">];
        </font>temp <font color="#000080">:= </font>arry<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>div </b></font><font color="#800000">40</font><font color="#000080">;
        </font>dec<font color="#000080">(</font>arry<font color="#000080">[</font>x<font color="#000080">],</font>temp<font color="#000080">*</font><font color="#800000">40</font><font color="#000080">);
        </font>DeCompress<font color="#000080">[</font>count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>ValidChars<font color="#000080">[</font>temp<font color="#000080">];
        </font>temp <font color="#000080">:= </font>arry<font color="#000080">[</font>x<font color="#000080">];
        </font>DeCompress<font color="#000080">[</font>count<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">] := </font>ValidChars<font color="#000080">[</font>temp<font color="#000080">];
        </font>inc<font color="#000080">(</font>count<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>x<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NumbofElements<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>size <font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
 </font><font color="#008000"><i>{-The Variable s can be any set Type and size is the Sizeof(s)}
  </i></font><font color="#FF0000"><b>Var
    </b></font>TheSet <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">32</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
    </font>count<font color="#000080">,</font>x<font color="#000080">,</font>y <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>size <font color="#FF0000"><b>do
      For </b></font>y <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
        </b></font>inc<font color="#000080">(</font>count<font color="#000080">, </font><font color="#800000">1 </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TheSet<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font>y<font color="#000080">));
    </font>NumbofElements <font color="#000080">:= </font>count<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PrinterStatus <font color="#000080">: </font>Byte<font color="#000080">;
   </font><font color="#FF0000"><b>Var </b></font>regs   <font color="#000080">: </font>Registers<font color="#000080">; </font><font color="#008000"><i>{-from the Dos Unit                         }
   </i></font><font color="#FF0000"><b>begin
     With </b></font>regs <font color="#FF0000"><b>do begin
       </b></font>dx <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;            </font><font color="#008000"><i>{-The Printer number   LPT2 = 1             }
       </i></font>ax <font color="#000080">:= </font><font color="#800000">$0200</font><font color="#000080">;        </font><font color="#008000"><i>{-The Function code For service wanted      }
       </i></font>intr<font color="#000080">(</font><font color="#800000">$17</font><font color="#000080">,</font>regs<font color="#000080">);     </font><font color="#008000"><i>{-$17= ROM bios int to return Printer status}
       </i></font>PrinterStatus <font color="#000080">:= </font>ah<font color="#000080">;</font><font color="#008000"><i>{-Bit 0 set = timed out                     }
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                  </font><font color="#008000"><i>{     1     = unused                        }
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                    </font><font color="#008000"><i>{     2     = unused                        }
                           {     3     = I/O error                     }
                           {     4     = Printer selected              }
                           {     5     = out of paper                  }
                           {     6     = acknowledge                   }
                           {     7     = Printer not busy              }

</i></font><font color="#FF0000"><b>Function </b></font>PrinterReady<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>b <font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>b <font color="#000080">:= </font>PrinterStatus<font color="#000080">;
    </font>PrinterReady <font color="#000080">:= (</font>b <font color="#000080">= </font><font color="#800000">$90</font><font color="#000080">) </font><font color="#008000"><i>{-This may Vary between Printers}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TestBbit<font color="#000080">(</font>n<font color="#000080">,</font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>TestBbit <font color="#000080">:= </font>odd<font color="#000080">(</font>n <font color="#FF0000"><b>shr </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TestWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>t<font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font>n<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">16 </font><font color="#FF0000"><b>then
      </b></font>TestWbit <font color="#000080">:= </font>odd<font color="#000080">(</font>t <font color="#FF0000"><b>shr </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TestLbit<font color="#000080">(</font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>then
      </b></font>TestLbit <font color="#000080">:= </font>odd<font color="#000080">(</font>n <font color="#FF0000"><b>shr </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>Byte<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>n <font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Var </b></font>t <font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font>n<font color="#000080">; </font><font color="#008000"><i>{-this allows either a Word or Integer}
  </i></font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">16 </font><font color="#FF0000"><b>then
      </b></font>t <font color="#000080">:= </font>t <font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetLbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>n <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>LongInt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ResetBbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>Byte<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>n <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ResetWbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Var </b></font>t<font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font>n<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">16 </font><font color="#FF0000"><b>then
      </b></font>t <font color="#000080">:= </font>t <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ResetLbit<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>n<font color="#000080">: </font>LongInt<font color="#000080">; </font>b<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>b <font color="#000080">&lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>n <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>LongInt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font>b<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>right<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>st <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>s<font color="#000080">;
    </font>len<font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>n <font color="#000080">&gt;= </font>len <font color="#FF0000"><b>then </b></font>right <font color="#000080">:= </font>st <font color="#FF0000"><b>else
    </b></font>right <font color="#000080">:= </font>copy<font color="#000080">(</font>st<font color="#000080">,</font>len<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">-</font>n<font color="#000080">,</font>n<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>shleft<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>st   <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>s<font color="#000080">;
    </font>stlen<font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
    </font>temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>len  <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>temp<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>n <font color="#000080">&lt; </font>stlen <font color="#FF0000"><b>then begin
      </b></font>move<font color="#000080">(</font>st<font color="#000080">[</font>n<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">255</font><font color="#000080">);
      </font>len <font color="#000080">:= </font>stlen <font color="#000080">- </font>n<font color="#000080">;
      </font>shleft <font color="#000080">:= </font>temp<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>left<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>st  <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>s<font color="#000080">;
    </font>temp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>len <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>temp<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>temp <font color="#000080">:= </font>st<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&lt; </font>len <font color="#FF0000"><b>then </b></font>len <font color="#000080">:= </font>n<font color="#000080">;
    </font>left <font color="#000080">:= </font>temp<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>nExtStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s1<font color="#000080">;</font>s2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>n <font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>main   <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>s1<font color="#000080">;
    </font>second <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>s2<font color="#000080">;
    </font>len    <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>s2<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>nExtStr <font color="#000080">:= </font>copy<font color="#000080">(</font>main<font color="#000080">,</font>pos<font color="#000080">(</font>second<font color="#000080">,</font>main<font color="#000080">)+</font>len<font color="#000080">,</font>n<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WriteAtCr<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>GotoXY<font color="#000080">(</font>col<font color="#000080">,</font>row<font color="#000080">);
    </font>Write<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>WriteLnAtCr<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>GotoXY<font color="#000080">(</font>col<font color="#000080">,</font>row<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Charstr<font color="#000080">(</font>ch <font color="#000080">: </font>Char<font color="#000080">; </font>by <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Count <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>by <font color="#FF0000"><b>do
    </b></font>Str <font color="#000080">:= </font>Str <font color="#000080">+ </font>ch<font color="#000080">;
  </font>CharStr <font color="#000080">:= </font>Str<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>WriteLnCenter<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>width<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>TempStr <font color="#000080">:= </font>CharStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,(</font>width <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">) - </font>succ<font color="#000080">((</font>length<font color="#000080">(</font>st<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)));
    </font>st      <font color="#000080">:= </font>TempStr <font color="#000080">+ </font>st<font color="#000080">;
    </font>Writeln<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WriteCenter<font color="#000080">(</font>st<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>width<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>TempStr <font color="#000080">:= </font>CharStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,(</font>width <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)-</font>succ<font color="#000080">((</font>length<font color="#000080">(</font>st<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)));
    </font>st      <font color="#000080">:= </font>TempStr <font color="#000080">+ </font>st<font color="#000080">;
    </font>Write<font color="#000080">(</font>st<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GotoCR<font color="#000080">(</font>col<font color="#000080">,</font>row<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>GotoXY<font color="#000080">(</font>col<font color="#000080">,</font>row<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Exist<font color="#000080">(</font>fn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>f         <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>OldMode   <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>OldMode <font color="#000080">:= </font>FileMode<font color="#000080">;
    </font>FileMode<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>assign<font color="#000080">(</font>f<font color="#000080">,</font>fn<font color="#000080">);
    </font><font color="#008000"><i>{$I-}  </i></font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>Ioresult <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>close<font color="#000080">(</font>f<font color="#000080">);
      </font>Exist <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>Exist <font color="#000080">:= </font>False<font color="#000080">;
    </font>FileMode<font color="#000080">:= </font>OldMode<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{-Exist}

</i></font><font color="#FF0000"><b>Function </b></font>Asc2Str<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">; </font>max<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>stArray <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
      </font>st      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>len     <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>st<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>move<font color="#000080">(</font>stArray<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>st<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">255</font><font color="#000080">);
    </font>len <font color="#000080">:= </font>max<font color="#000080">;
    </font>len <font color="#000080">:= (</font>max <font color="#000080">+ </font>Word<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) * </font>ord<font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>st<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) + </font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>st<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;
    </font>Asc2Str <font color="#000080">:= </font>st<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>DisableBlink<font color="#000080">(</font>state <font color="#000080">: </font>Boolean<font color="#000080">);
   </font><font color="#008000"><i>{ DisableBlink(True) allows use of upper eight colors as background }
   { colours. DisableBlink(False) restores the normal mode and should  }
   { be called beFore Program Exit                                     }
</i></font><font color="#FF0000"><b>Var
   </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>regs <font color="#FF0000"><b>do
  begin
    </b></font>ax <font color="#000080">:= </font><font color="#800000">$1003</font><font color="#000080">;
    </font>bl <font color="#000080">:= </font>ord<font color="#000080">(</font><font color="#FF0000"><b>not</b></font><font color="#000080">(</font>state<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ DisableBlink }

</i></font><font color="#FF0000"><b>Function </b></font>Byte2Hex<font color="#000080">(</font>numb <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Byte2Hex<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#2</font><font color="#000080">;
    </font>Byte2Hex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>HexChars<font color="#000080">[</font>numb <font color="#FF0000"><b>shr  </b></font><font color="#800000">4</font><font color="#000080">];
    </font>Byte2Hex<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>HexChars<font color="#000080">[</font>numb <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Numb2Hex<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>numb<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ converts an Integer or a Word to a String. Using an unTyped
    argument makes this possible. }
  </i></font><font color="#FF0000"><b>Var </b></font>n <font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font>numb<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Numb2Hex <font color="#000080">:= </font>Byte2Hex<font color="#000080">(</font>hi<font color="#000080">(</font>n<font color="#000080">))+</font>Byte2Hex<font color="#000080">(</font>lo<font color="#000080">(</font>n<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Long2Hex<font color="#000080">(</font>long <font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    With </b></font>LongWds<font color="#000080">(</font>long<font color="#000080">) </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{ Type casting makes the split up easy}
      </i></font>Long2Hex <font color="#000080">:= </font>Numb2Hex<font color="#000080">(</font>hiWord<font color="#000080">) + </font>Numb2Hex<font color="#000080">(</font>loWord<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Byte<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Hex2Byte <font color="#000080">:= </font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]),</font>HexChars<font color="#000080">)-</font><font color="#800000">1  </font><font color="#000080">+
               ((</font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font>HexChars<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl  </b></font><font color="#800000">4 </font><font color="#008000"><i>{ *  16}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Word<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Word<font color="#000080">;
  </font><font color="#008000"><i>{ This requires that the String passed is a True hex String  of 4
    Chars and not in a Format like $FDE0 }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Hex2Word <font color="#000080">:= </font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]),</font>HexChars<font color="#000080">)-</font><font color="#800000">1  </font><font color="#000080">+
               ((</font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]),</font>HexChars<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl  </b></font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#008000"><i>{ *  16}
               </i></font><font color="#000080">((</font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]),</font>HexChars<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl  </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#008000"><i>{ * 256}
               </i></font><font color="#000080">((</font>pos<font color="#000080">(</font>UpCase<font color="#000080">(</font>HexStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font>HexChars<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">12</font><font color="#000080">;  </font><font color="#008000"><i>{ *4096}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Integer<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Hex2Integer <font color="#000080">:= </font>Integer<font color="#000080">(</font>Hex2Word<font color="#000080">(</font>HexStr<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Long<font color="#000080">(</font>HexStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>Long <font color="#000080">: </font>LongWds<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Long<font color="#000080">.</font>hiWord <font color="#000080">:= </font>Hex2Word<font color="#000080">(</font>copy<font color="#000080">(</font>HexStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">));
    </font>Long<font color="#000080">.</font>loWord <font color="#000080">:= </font>Hex2Word<font color="#000080">(</font>copy<font color="#000080">(</font>HexStr<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">));
    </font>Hex2Long <font color="#000080">:= </font>LongInt<font color="#000080">(</font>Long<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>FilePosition <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
