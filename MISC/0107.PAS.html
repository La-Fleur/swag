<html>
<head><title> "Hand Scanner Code" by ROLAND SKINNER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>RJScan<font color="#000080">;

</font><font color="#008000"><i>{******************************}
{                              }
{            RJScan            }
{                              }
{             v1.1             }
{                              }
{                              }
{              by              }
{                              }
{        Roland Skinner        }
{                              }
{      Copyright (c) 1992      }
{                              }
{         RJS Software         }
{                              }
{    Released to the public    }
{         domain 1994.         }
{                              }
{******************************}


{ Implements scanning ability for the DFI HS-3000 PLUS HANDY SCANNER or }
{ other 100% compatible hand-scanners (including certain GeniScans).    }

{ NOTE - This unit may be overlayed.                                    }
{      - This unit requires Turbo Pascal 6 (or above).                  }

{$B-,D-,F+,G-,I-,L-,O+,R-,S-,V-,X-}

{=============================================================================}

</i></font><font color="#FF0000"><b>interface

</b></font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>const
    </b></font>AnyResolution <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>type
    </b></font>ScanError <font color="#000080">= (</font>scOK<font color="#000080">,</font>scNoScanner<font color="#000080">,</font>scInvalidResolution<font color="#000080">,</font>scIncorrectResolution<font color="#000080">,
                 </font>scInvalidImageWidth<font color="#000080">);

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>type
    </b></font>ScanLineBufferProc <font color="#000080">= </font><font color="#FF0000"><b>function</b></font><font color="#000080">(</font>LineNumber <font color="#000080">: </font>Integer<font color="#000080">) : </font>Pointer<font color="#000080">;
                         </font><font color="#008000"><i>{ NOTE - This function should return  the  address }
                         {        of the scan-buffer for the &quot;LineNumber&quot;th }
                         {        line. First line is number 0.             }
    </i></font>DisplayScannedLineProc <font color="#000080">= </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">(</font>LineNumber <font color="#000080">: </font>Integer<font color="#000080">);
                             </font><font color="#008000"><i>{ NOTE - This  procedure  should  display  (if }
                             {        necessary)  the  &quot;LineNumber&quot;th  line }
                             {        that was scanned in.  First  line  is }
                             {        number 0.                             }
    </i></font>StopScanningProc <font color="#000080">= </font><font color="#FF0000"><b>function </b></font><font color="#000080">: </font>Boolean<font color="#000080">;
                       </font><font color="#008000"><i>{ NOTE - This function should return &quot;False&quot;, unless }
                       {        some  event  has  occurred  which  requires }
                       {        scanning to stop.                           }

{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>ScanImage<font color="#000080">(</font>DesiredResolution<font color="#000080">,</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine <font color="#000080">: </font>Integer<font color="#000080">;
                      </font>ScanLineBuffer <font color="#000080">: </font>ScanLineBufferProc<font color="#000080">;
                      </font>DisplayScannedLine <font color="#000080">: </font>DisplayScannedLineProc<font color="#000080">;
                      </font>StopScanning <font color="#000080">: </font>StopScanningProc<font color="#000080">) : </font>ScanError<font color="#000080">;
    </font><font color="#008000"><i>{- This function will scan an image  with  width  8*&quot;BytesPerLine&quot;  and }
    {  height &quot;MaxLinesToScan&quot;. It is possible to specify the resolution at }
    {  which to scan the image  in  &quot;DesiredResolution&quot;  (100,200,300,400). }
    {  If the resolution set on the scanner is different to that specified, }
    {  then   the   &quot;scIncorrectResolution&quot;   error   will   be   returned. }
    {  If &quot;DesiredResolution&quot; is &quot;AnyResolution&quot;, then any resolution  will }
    {  be allowed. &quot;scInvalidResolution&quot; will be returned if  a  resolution }
    {  other than 100,200,300,400 or &quot;AnyResolution&quot; is specified.          }
    {  &quot;ScanLineBuffer&quot;,  &quot;DisplayScannedLine&quot;   and   &quot;StopScanning&quot;   are }
    {  procedures/functions whose functions are discussed above. These must }
    {  be FAR procedures/functions.                                         }
    {  If &quot;BytesPerLine&quot; is too  large  for  the  scanner-resolution,  then }
    {  &quot;scInvalidImageWidth&quot; will be returned.                              }
    {  If scanner is not installed then &quot;scNoScanner&quot; is returned.          }
    {  If successful, then &quot;scOK&quot; will be returned.                         }
    {  This function may not work with  certain hand-scanners (if  so,  use }
    {  &quot;GenericScanImage&quot;).                                                 }
  </i></font><font color="#FF0000"><b>function  </b></font>GenericScanImage<font color="#000080">(</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine <font color="#000080">: </font>Integer<font color="#000080">;
                             </font>ScanLineBuffer <font color="#000080">: </font>ScanLineBufferProc<font color="#000080">;
                             </font>DisplayScannedLine <font color="#000080">: </font>DisplayScannedLineProc<font color="#000080">;
                             </font>StopScanning <font color="#000080">: </font>StopScanningProc<font color="#000080">) : </font>ScanError<font color="#000080">;
    </font><font color="#008000"><i>{- This  function  will  scan  an  image  in  an  analogous  manner  as }
    {  &quot;ScanImage&quot;. However, it does not do any checks for valid resolution }
    {  or image-width. This is to allow compatibility for scanners which do }
    {  not allow for scan-resolution selection.                             }
    {  &quot;scOK&quot;, &quot;scNoScanner&quot; and &quot;scInvalidImageWidth&quot; may be  returned  by }
    {  this function. Refer to &quot;ScanImage&quot; for a discussion about these.    }
  </i></font><font color="#FF0000"><b>function  </b></font>ScannerIsInstalled <font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#008000"><i>{- Returns installed-status of scanner.                                 }
  </i></font><font color="#FF0000"><b>function  </b></font>ResolutionOfScanner <font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#008000"><i>{- Returns the resolution  set  on  the  scanner.  If  scanner  is  not }
    {  installed, then -1 will be returned.                                 }
    {  This function may not work with certain hand-scanners.               }

{=============================================================================}

</i></font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>const
    </b></font>MaxBytesPerLine <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">102</font><font color="#000080">,</font><font color="#800000">154</font><font color="#000080">,</font><font color="#800000">205</font><font color="#000080">);

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>var
    </b></font>ScannerInstalled        <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>ScannerResolution       <font color="#000080">: </font>Word<font color="#000080">;
    </font>ScannerResolution100    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMAChannel              <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMAPageRegister         <font color="#000080">: </font>Word<font color="#000080">;
    </font>DMACurAddrRegister      <font color="#000080">: </font>Word<font color="#000080">;
    </font>DMACurWordCountRegister <font color="#000080">: </font>Word<font color="#000080">;
    </font>DMAClearSingleMaskBit   <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMASetSingleMaskBit     <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMAModeRegisterSetting  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMAWriteRequest         <font color="#000080">: </font>Byte<font color="#000080">;
    </font>DMATerminalCountReached <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>DetermineScannerResolution<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Data <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">xor     ax,ax
    jmp     @Start
  @ResSettings:
    db      21h,41h,51h,71h
  @Start:
    mov     dx,27Bh
    mov     cx,300
  @1:
    in      al,dx
    and     al,10000000b
    jnz     @1
  @2:
    in      al,dx
    and     al,10000000b
    jz      @2
    loop    @1
  @3:
    in      al,dx
    and     al,10000000b
    jnz     @3
  @4:
    in      al,dx
    and     al,00100100b
    shr     al,1
    shr     al,1
    or      ah,al
    shr     al,1
    shr     al,1
    or      ah,al
    and     ah,00000011b
    xor     al,al
    xchg    al,ah
    mov     bl,4
    sub     bl,al
    mov     al,bl
    push    ax
    mov     bx,OFFSET (@ResSettings-1)
    add     bx,ax
    mov     al,[cs:bx]
    mov     dx,27Ah
    out     dx,al
    mov     Data,al
    pop     ax
    mov     ScannerResolution100,al
    mov     cx,100
    mul     cx
    mov     ScannerResolution,ax
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>DetermineScannerDMA<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov     dx,27Bh
    in      al,dx
    and     al,00001010b
    cmp     al,00001000b
    je      @UseDMA1
    cmp     al,00000010b
    je      @UseDMA3
    jmp     @NoDMA
  @UseDMA1:
    mov     DMAChannel,1
    mov     DMAPageRegister,        83h
    mov     DMACurAddrRegister,     02h
    mov     DMACurWordCountRegister,03h
    mov     DMAClearSingleMaskBit,  00000001b
    mov     DMASetSingleMaskBit,    00000101b
    mov     DMAModeRegisterSetting, 01000101b
    mov     DMAWriteRequest,        00000001b
    mov     DMATerminalCountReached,00000010b
    jmp     @Exit
  @UseDMA3:
    mov     DMAChannel,3
    mov     DMAPageRegister,        82h
    mov     DMACurAddrRegister,     06h
    mov     DMACurWordCountRegister,07h
    mov     DMAClearSingleMaskBit,  00000011b
    mov     DMASetSingleMaskBit,    00000111b
    mov     DMAModeRegisterSetting, 01000111b
    mov     DMAWriteRequest,        00000011b
    mov     DMATerminalCountReached,00001000b
    jmp     @Exit
  @NoDMA:
    mov     DMAChannel,0
  @Exit:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>TurnScannerOn<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov     dx,27Ah
    mov     al,01h
    out     dx,al
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>TurnScannerOff<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov     dx,27Ah
    mov     al,00h
    out     dx,al
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>DMADelay<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">nop
    nop
    nop
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>DoScan<font color="#000080">(</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine <font color="#000080">: </font>Integer<font color="#000080">;
                   </font>ScanLineBuffer <font color="#000080">: </font>ScanLineBufferProc<font color="#000080">;
                   </font>DisplayScannedLine <font color="#000080">: </font>DisplayScannedLineProc<font color="#000080">;
                   </font>StopScanning <font color="#000080">: </font>StopScanningProc<font color="#000080">) : </font>ScanError<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>LinesScanned <font color="#000080">: </font>Integer<font color="#000080">;
    </font>ScanBuffer   <font color="#000080">: </font>Pointer<font color="#000080">;
    </font>WidthToScan  <font color="#000080">: </font>Word <font color="#FF0000"><b>absolute </b></font>BytesPerLine<font color="#000080">;
    </font>QuitScanning <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>BytesPerLine<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>BytesPerLine<font color="#000080">&lt;=</font>MaxBytesPerLine<font color="#000080">[</font>ScannerResolution100<font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>LinesScanned <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>QuitScanning <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        </b></font>ScanBuffer <font color="#000080">:= </font>ScanLineBuffer<font color="#000080">(</font>LinesScanned<font color="#000080">);
        </font><font color="#FF0000"><b>asm
        </b></font><font color="#008000"><i>{-Disable DMA transfer }
          </i></font><font color="#FF00FF">mov     al,DMASetSingleMaskBit
          out     0Ah,al
          call    DMADelay;
          mov     al,DMAModeRegisterSetting
          out     0Bh,al
          call    DMADelay
        </font><font color="#008000"><i>{-Setup Buffer address }
          </i></font><font color="#FF00FF">les     di,ScanBuffer
          mov     dx,es
          mov     al,dh
          mov     cl,4
          shl     dx,cl
          shr     al,cl
          add     dx,di
          adc     al,0
          mov     cx,dx
          mov     dx,DMAPageRegister
          out     dx,al
          call    DMADelay
          out     0Ch,al
          call    DMADelay
          mov     dx,DMACurAddrRegister
          mov     al,cl
          out     dx,al
          call    DMADelay
          mov     al,ch
          out     dx,al
          call    DMADelay
        </font><font color="#008000"><i>{-Setup bytes to transfer }
          </i></font><font color="#FF00FF">out     0Ch,al
          call    DMADelay
          mov     ax,WidthToScan
          dec     ax
          mov     dx,DMACurWordCountRegister
          out     dx,al
          call    DMADelay
          mov     al,ah
          out     dx,al
        </font><font color="#008000"><i>{-Start DMA transfer }
          </i></font><font color="#FF00FF">mov     dx,27Bh
          out     dx,al
          dec     dx
          in      al,dx                 </font><font color="#008000"><i>{ DX = 027Ah }
          </i></font><font color="#FF00FF">mov     al,DMAWriteRequest
          out     09h,al
          call    DMADelay
          mov     al,DMAClearSingleMaskBit
          out     0Ah,al
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#008000"><i>{-Scan line }
        </i></font><font color="#FF0000"><b>asm
          </b></font><font color="#FF00FF">mov     bl,DMATerminalCountReached
        @1:
          in      al,08h
          and     al,bl
          cmp     al,bl
          je      @2
          push    bx
          call    StopScanning
          pop     bx
          or      al,al
          jz      @1
          mov     QuitScanning,True
        @2:
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>DisplayScannedLine<font color="#000080">(</font>LinesScanned<font color="#000080">);
        </font>Inc<font color="#000080">(</font>LinesScanned<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>LinesScanned<font color="#000080">=</font>MaxLinesToScan<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>QuitScanning<font color="#000080">;
      </font>DoScan <font color="#000080">:= </font>scOK<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>DoScan <font color="#000080">:= </font>scInvalidImageWidth<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>ScanImage<font color="#000080">(</font>DesiredResolution<font color="#000080">,</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine <font color="#000080">: </font>Integer<font color="#000080">;
                      </font>ScanLineBuffer <font color="#000080">: </font>ScanLineBufferProc<font color="#000080">;
                      </font>DisplayScannedLine <font color="#000080">: </font>DisplayScannedLineProc<font color="#000080">;
                      </font>StopScanning <font color="#000080">: </font>StopScanningProc<font color="#000080">) : </font>ScanError<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>ScannerInstalled <font color="#FF0000"><b>then
    begin
      if </b></font><font color="#000080">(</font>DesiredResolution<font color="#000080">=</font>AnyResolution<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>DesiredResolution <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">]) </font><font color="#FF0000"><b>then
      begin
        </b></font>TurnScannerOn<font color="#000080">;
        </font>DetermineScannerResolution<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>DesiredResolution<font color="#000080">=</font>AnyResolution<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DesiredResolution<font color="#000080">=</font>ScannerResolution<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>ScanImage <font color="#000080">:= </font>DoScan<font color="#000080">(</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine<font color="#000080">,
                              </font>ScanLineBuffer<font color="#000080">,</font>DisplayScannedLine<font color="#000080">,</font>StopScanning<font color="#000080">)
        </font><font color="#FF0000"><b>else
          </b></font>ScanImage <font color="#000080">:= </font>scIncorrectResolution<font color="#000080">;
        </font>TurnScannerOff<font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
        </b></font>ScanImage <font color="#000080">:= </font>scInvalidResolution<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>ScanImage <font color="#000080">:= </font>scNoScanner<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>GenericScanImage<font color="#000080">(</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine <font color="#000080">: </font>Integer<font color="#000080">;
                             </font>ScanLineBuffer <font color="#000080">: </font>ScanLineBufferProc<font color="#000080">;
                             </font>DisplayScannedLine <font color="#000080">: </font>DisplayScannedLineProc<font color="#000080">;
                             </font>StopScanning <font color="#000080">: </font>StopScanningProc<font color="#000080">) : </font>ScanError<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>ScannerInstalled <font color="#FF0000"><b>then
    begin
      </b></font>TurnScannerOn<font color="#000080">;
      </font>ScannerResolution100 <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
      </font>GenericScanImage <font color="#000080">:= </font>DoScan<font color="#000080">(</font>MaxLinesToScan<font color="#000080">,</font>BytesPerLine<font color="#000080">,
                          </font>ScanLineBuffer<font color="#000080">,</font>DisplayScannedLine<font color="#000080">,</font>StopScanning<font color="#000080">);
      </font>TurnScannerOff<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>GenericScanImage <font color="#000080">:= </font>scNoScanner<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>DetermineScannerPresence<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>TurnScannerOn<font color="#000080">;
    </font>DetermineScannerDMA<font color="#000080">;
    </font>TurnScannerOff<font color="#000080">;
    </font>ScannerInstalled <font color="#000080">:= (</font>DMAChannel<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>ScannerIsInstalled <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>ScannerIsInstalled <font color="#000080">:= </font>ScannerInstalled<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

  </i></font><font color="#FF0000"><b>function  </b></font>ResolutionOfScanner <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>ScannerInstalled <font color="#FF0000"><b>then
    begin
      </b></font>TurnScannerOn<font color="#000080">;
      </font>DetermineScannerResolution<font color="#000080">;
      </font>TurnScannerOff<font color="#000080">;
      </font>ResolutionOfScanner <font color="#000080">:= </font>ScannerResolution<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>ResolutionOfScanner <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>begin
  </b></font>DetermineScannerPresence<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{=============================================================================}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p></body>
</html>
