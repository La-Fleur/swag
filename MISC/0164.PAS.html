<html>
<head><title> "Percentage Bar" by BRAD ZAVITSKY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is my percentage bar unit, that (??Steve Rogers?? I can't quite remember
now--sorry ) suggested I try a whiles back (I just got around to it).  It has
been debugged for all of a hour.
{**

PBar   Percentage Bar Unit   copr.1995 Brad Zavitsky

All Rights Reserved
Commercial use not allowed
Use at your own risk

Formulae-
  Percentage    =&gt; Round(cur/max);
  PBar progress =&gt; Round((cur/max) * #spaces);

ReDraw-
  If set to true, the whole percentage bar is redrawn each time.
  If false, it will continue were last left off

**}

</i></font><font color="#FF0000"><b>unit </b></font>PBar<font color="#000080">;

</font><font color="#FF0000"><b>interface

type
  </b></font>BarObj <font color="#000080">= </font><font color="#FF0000"><b>object
    </b></font>ReDraw <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>Spaces <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Old<font color="#000080">,
    </font>Max    <font color="#000080">: </font>Longint<font color="#000080">;
    </font>Ch     <font color="#000080">: </font>Char<font color="#000080">;
    </font>X<font color="#000080">,
    </font>Y<font color="#000080">,
    </font>Color  <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>UpDate<font color="#000080">(</font>Cur<font color="#000080">: </font>Longint<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Init<font color="#000080">(</font>_Spaces<font color="#000080">: </font>Integer<font color="#000080">; </font>_Max<font color="#000080">: </font>Longint<font color="#000080">; </font>_Ch<font color="#000080">: </font>Char<font color="#000080">; </font>_X<font color="#000080">, </font>_Y<font color="#000080">,
                   </font>_Color<font color="#000080">: </font>Byte<font color="#000080">; </font>_ReDraw<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

var
  </b></font>VS<font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>VidSeg<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>VidM<font color="#000080">: ^</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{$iFDEF VER70}
  </i></font>VidM <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font><font color="#800000">$0049</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>VidM<font color="#000080">^ = </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>VidSeg <font color="#000080">:= </font>SegB000 <font color="#FF0000"><b>else </b></font>VidSeg <font color="#000080">:= </font>SegB800<font color="#000080">;
  </font><font color="#008000"><i>{$ELSE}
  </i></font>VidM <font color="#000080">:= </font>Ptr<font color="#000080">(</font><font color="#800000">$0040</font><font color="#000080">,</font><font color="#800000">$0049</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>VidM<font color="#000080">^ = </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>VidSeg <font color="#000080">:= </font><font color="#800000">$B000 </font><font color="#FF0000"><b>else </b></font>VidSeg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;
  </font><font color="#008000"><i>{$ENDiF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>WriteChar<font color="#000080">(</font>Ch<font color="#000080">: </font>char<font color="#000080">; </font>x<font color="#000080">, </font>y<font color="#000080">, </font>attr<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>where<font color="#000080">: </font>Word<font color="#000080">;
[</font>Abegin
  Where <font color="#000080">:= </font><font color="#800000">160</font><font color="#000080">*(</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">*(</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>Mem<font color="#000080">[</font>VS<font color="#000080">:</font>Where<font color="#000080">] := </font>Ord<font color="#000080">(</font>Ch<font color="#000080">);
  </font>Mem<font color="#000080">[</font>VS<font color="#000080">:</font>Where<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>Attr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>BarObj<font color="#000080">.</font>Init<font color="#000080">(</font>_Spaces<font color="#000080">: </font>Integer<font color="#000080">; </font>_Max<font color="#000080">: </font>Longint<font color="#000080">; </font>_Ch<font color="#000080">: </font>Char<font color="#000080">; </font>_X<font color="#000080">, </font>_Y<font color="#000080">,
                      </font>_Color<font color="#000080">: </font>Byte<font color="#000080">; </font>_ReDraw<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Old <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Spaces <font color="#000080">:= </font>_Spaces<font color="#000080">;
  </font>X <font color="#000080">:= </font>_X<font color="#000080">;
  </font>Y <font color="#000080">:= </font>_Y<font color="#000080">;
  </font>Color <font color="#000080">:= </font>_Color<font color="#000080">;
  </font>Ch <font color="#000080">:= </font>_Ch<font color="#000080">;
  </font>Max <font color="#000080">:= </font>_Max<font color="#000080">;
  </font>ReDraw <font color="#000080">:= </font>_ReDraw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>BarObj<font color="#000080">.</font>UpDate<font color="#000080">(</font>Cur<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Temp<font color="#000080">,
  </font>OldPos<font color="#000080">,
  </font>SpacePos<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SpacePos <font color="#000080">:= </font>Round<font color="#000080">((</font>Cur<font color="#000080">/</font>Max<font color="#000080">) * </font>Spaces<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ReDraw <font color="#FF0000"><b>then
  begin
    for </b></font>Temp <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>SpacePos<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>WriteChar<font color="#000080">(</font>Ch<font color="#000080">, </font>X<font color="#000080">+</font>Temp<font color="#000080">, </font>Y<font color="#000080">, </font>Color<font color="#000080">);
  </font><font color="#FF0000"><b>end else
  begin
    </b></font>Dec<font color="#000080">(</font>SpacePos<font color="#000080">, </font>Old<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>Temp <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>SpacePos<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>WriteChar<font color="#000080">(</font>Ch<font color="#000080">, </font>X<font color="#000080">+</font>Temp<font color="#000080">+</font>Old<font color="#000080">, </font>Y<font color="#000080">, </font>Color<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Old<font color="#000080">, </font>SpacePos<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>VS <font color="#000080">:= </font>VidSeg<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p></body>
</html>
