<html>
<head><title> "Re  Anti-debugging...??" by KLAUS WIEGAND</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0105.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&sup3; Now, just to bring this home, I want to make it take over the
&sup3; debugging interrupts.  (INT 3, is it?)  I am just wondering if this
&sup3; has been done and if anyone has some TP/TASM code already created for
&sup3; this purpose.

in case the debugger executes an int1 or int 3, all you will get is the
message &quot;OOPS&quot;. not really secure, but for most cases QUITE good enough.

}

</i></font><font color="#FF0000"><b>Unit </b></font>Nodebug<font color="#000080">;

</font><font color="#FF0000"><b>Interface

</b></font><font color="#008000"><i>{*************************************************}
{*                                               *}
{*  All actions will be handled by the           *}
{*  initialisation and the Exitprozedure         *}
{*  thus no exported declarations needed         *}
{*                                               *}
{*************************************************}

</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>Dos<font color="#000080">,</font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var
   </b></font>Oldint1<font color="#000080">,
   </font>Oldint3<font color="#000080">,
   </font>Exitsave   <font color="#000080">: </font>Pointer<font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Donotdebug<font color="#000080">; </font>Interrupt<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
       </b></font>Writeln <font color="#000080">(</font><font color="#800000">'OOPS??  pleeze no debuggung !!!!' </font><font color="#000080">);
       </font>Writeln<font color="#000080">;
       </font>Halt <font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}
    </i></font><font color="#FF0000"><b>Procedure </b></font>Resetnodebug<font color="#000080">;
</font><font color="#008000"><i>{$F-}
    </i></font><font color="#FF0000"><b>Begin
       </b></font>Setintvec <font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, </font>Oldint1 <font color="#000080">);
       </font>Setintvec <font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font>Oldint3 <font color="#000080">);
       </font>Exitproc  <font color="#000080">:= </font>Exitsave<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>Exitsave <font color="#000080">:= </font>Exitproc<font color="#000080">;
   </font>Exitproc <font color="#000080">:= @</font>Resetnodebug<font color="#000080">;
   </font>Getintvec <font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, </font>Oldint1 <font color="#000080">);
   </font>Getintvec <font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, </font>Oldint3 <font color="#000080">);
   </font>Setintvec <font color="#000080">( </font><font color="#800000">3</font><font color="#000080">, @</font>Donotdebug <font color="#000080">);
   </font>Setintvec <font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, @</font>Donotdebug <font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0105.PAS">Original</a><b>]</b></p></body>
</html>
