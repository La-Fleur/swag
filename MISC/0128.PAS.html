<html>
<head><title> "Percentage Status Bar" by CJ CLIFFE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0128.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{   I've seen a LOT of programs which Say they are doing something like
    Reading/Writing to files, and you wonder if they have crashed or what,
    I think it would be nice to have a nice Status Bar to show the progress
    of what is going on!  so here's my contribution to everyone:
    Statbar:  Highly Accurate Status Bar..  }

</i></font><font color="#FF0000"><b>Uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;  </font><font color="#FF0000"><b>Asm                 </b></font><font color="#008000"><i>{I forget where I got}
</i></font><font color="#FF00FF">MOV   ax,$0100;  MOV   cx,$2607;  INT   $10 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;    </font><font color="#008000"><i>{     these two      }

</i></font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>Asm
</b></font><font color="#FF00FF">MOV   ax,$0100;  MOV   cx,$0506;  INT   $10 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>Dupeit<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Num<font color="#000080">: </font>Integer<font color="#000080">);  </font><font color="#008000"><i>{Just a little Helper, dupes}
</i></font><font color="#FF0000"><b>var </b></font>Cnt<font color="#000080">: </font>integer<font color="#000080">;                             </font><font color="#008000"><i>{        lines              }
</i></font><font color="#FF0000"><b>begin
For </b></font>Cnt <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Num <font color="#FF0000"><b>do begin
</b></font>write<font color="#000080">(</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Statbar<font color="#000080">(</font>cnum<font color="#000080">,</font>enum<font color="#000080">,</font>xspot<font color="#000080">,</font>yspot<font color="#000080">,</font>fullcolor<font color="#000080">,</font>emptycolor<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>percentage<font color="#000080">: </font>Integer<font color="#000080">;              </font><font color="#008000"><i>{Uh-Oh, here comes the Mathematical}
</i></font><font color="#FF0000"><b>begin                                 </b></font><font color="#008000"><i>{                Crap!!            }
</i></font>Hidecursor<font color="#000080">;                                 </font><font color="#008000"><i>{Kill That Damned Cursor!}
</i></font>percentage <font color="#000080">:= </font>round<font color="#000080">(</font>cnum <font color="#000080">/ </font>enum <font color="#000080">* </font><font color="#800000">100 </font><font color="#000080">/ </font><font color="#800000">2</font><font color="#000080">);   </font><font color="#008000"><i>{/2 can be changed for}
  </i></font>Gotoxy<font color="#000080">(</font>xspot<font color="#000080">,</font>yspot<font color="#000080">);                          </font><font color="#008000"><i>{  Shorter Stat Bars  }
 </i></font>Textcolor<font color="#000080">(</font>fullcolor<font color="#000080">);
</font>dupeit<font color="#000080">(</font><font color="#800000">#219</font><font color="#000080">,</font>Percentage<font color="#000080">);                </font><font color="#008000"><i>{Can change the Char to whatever}
 </i></font>Textcolor<font color="#000080">(</font>emptycolor<font color="#000080">);
</font>dupeit<font color="#000080">(</font><font color="#800000">#177</font><font color="#000080">,</font><font color="#800000">50 </font><font color="#000080">- </font>Percentage<font color="#000080">);                    </font><font color="#008000"><i>{same as above}

  </i></font>write<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">,</font>percentage <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);         </font><font color="#008000"><i>{this is not needed, just an extra}
</i></font>Showcursor<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WriteXy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>Integer<font color="#000080">; </font>dstr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>tcolor<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
</b></font>Hidecursor<font color="#000080">;
</font>Gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);                      </font><font color="#008000"><i>{ Yeah, I now it's Cheap and cheezy}
</i></font>Textcolor<font color="#000080">(</font>tcolor<font color="#000080">);                 </font><font color="#008000"><i>{ but it gets the job done well! }
</i></font>write<font color="#000080">(</font>dstr<font color="#000080">);
</font>Showcursor<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>B1<font color="#000080">,</font>B2<font color="#000080">,</font>B3<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin

  </b></font>Clrscr<font color="#000080">;
  </font>WriteXy<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'Statbar By CJ Cliffe..'</font><font color="#000080">,</font>yellow<font color="#000080">);

</font><font color="#FF0000"><b>Repeat

 </b></font>Inc<font color="#000080">(</font>B1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>Inc<font color="#000080">(</font>B2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>Inc<font color="#000080">(</font>B3<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

</font><font color="#008000"><i>{ The Statbar procedure works like so:

Statbar(Current Number, Final Number, x location, y location,
                   Color of completed bars, color of empty bars);

Will process (as far as I know) Any pairs of numbers, as long as the Current
Number does not exceed the Final Number, everything should look fine.. }


   </i></font>Statbar<font color="#000080">(</font>B1<font color="#000080">,</font><font color="#800000">800</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font>Lightcyan<font color="#000080">,</font>Cyan<font color="#000080">);     </font><font color="#008000"><i>{800 Just makes em go nice 'n}
   </i></font>Statbar<font color="#000080">(</font>B2<font color="#000080">,</font><font color="#800000">800</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font>LightRed<font color="#000080">,</font>Red<font color="#000080">);       </font><font color="#008000"><i>{slow because they are FAST  }
   </i></font>Statbar<font color="#000080">(</font>B3<font color="#000080">,</font><font color="#800000">800</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>LightGreen<font color="#000080">,</font>Green<font color="#000080">);

</font><font color="#FF0000"><b>Until </b></font>B1 <font color="#000080">= </font><font color="#800000">800</font><font color="#000080">;

 </font>WriteXy<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">'Press any key to quit...'</font><font color="#000080">,</font>Lightblue<font color="#000080">);
 </font>Readkey<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0128.PAS">Original</a><b>]</b></p></body>
</html>
