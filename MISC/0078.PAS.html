<html>
<head><title> "Misc Utilities" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Utils<font color="#000080">;                </font><font color="#008000"><i>{  Misc Utilities Last Updates  Nov 01/93       }
                        {  Copyright (C) 1992,93 Greg Estabrooks        }

</i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{ *********************************************************************}
</i></font><font color="#FF0000"><b>USES
    </b></font>CRT<font color="#000080">,</font>KeyIO<font color="#000080">,</font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>CONST
      </b></font>FpuType <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF STRING</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] =(</font><font color="#800000">'None'</font><font color="#000080">,</font><font color="#800000">'8087'</font><font color="#000080">,</font><font color="#800000">'80287'</font><font color="#000080">,</font><font color="#800000">'80387'</font><font color="#000080">);
      </font>CPU     <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>Of STRING</b></font><font color="#000080">[</font><font color="#800000">13</font><font color="#000080">] =(</font><font color="#800000">'8088/V20'</font><font color="#000080">,</font><font color="#800000">'80286'</font><font color="#000080">,
                                          </font><font color="#800000">'80386/80486'</font><font color="#000080">,</font><font color="#800000">'80486'</font><font color="#000080">);
</font><font color="#FF0000"><b>CONST                                   </b></font><font color="#008000"><i>{  Define COM port Addresses    }
     </i></font>ComPort <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>WORD <font color="#000080">= (</font><font color="#800000">$3F8</font><font color="#000080">,</font><font color="#800000">$2F8</font><font color="#000080">,</font><font color="#800000">$3E8</font><font color="#000080">,</font><font color="#800000">$2E8</font><font color="#000080">);

</font><font color="#FF0000"><b>CONST
     </b></font>Warm <font color="#000080">:</font>WORD <font color="#000080">= </font><font color="#800000">0000</font><font color="#000080">;         </font><font color="#008000"><i>{ Predefined value for warm boot.       }
     </i></font>Cold <font color="#000080">:</font>WORD <font color="#000080">= </font><font color="#800000">0001</font><font color="#000080">;         </font><font color="#008000"><i>{ Predefined value for cold boot.       }

</i></font><font color="#FF0000"><b>VAR
    </b></font>BiosDate  <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CHAR <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$F000</font><font color="#000080">:</font><font color="#800000">$FFF5</font><font color="#000080">;
    </font>EquipFlag <font color="#000080">:</font>WORD <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0410</font><font color="#000080">;
    </font>CompID    <font color="#000080">:</font>BYTE <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$F000</font><font color="#000080">:</font><font color="#800000">$FFFE</font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>CoProcessorExist <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>NumPrinters <font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GameIOAttached <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>NumSerialPorts <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>NumDisketteDrives <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>InitialVideoMode <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Noise<font color="#000080">(</font>Pitch<font color="#000080">, </font>Duration <font color="#000080">:</font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>Time <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>WeekDate <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>DayOfWeek<font color="#000080">( </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>Year <font color="#000080">:</font>WORD <font color="#000080">) :</font>BYTE<font color="#000080">; </font><font color="#008000"><i>{  Returns 1-7 }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>PrinterOK <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>AdlibCard <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>TrueDosVer <font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPrtScr<font color="#000080">( </font>On_OFF <font color="#000080">:</font>BOOLEAN <font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>CpuType <font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>IdePause<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>RingDetect<font color="#000080">( </font>CPort <font color="#000080">:</font>WORD<font color="#000080">) :</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>DetectOs2<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>HiWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return high word of a LongInt.       }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>LoWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return low word of a LongInt.        }
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Running4DOS <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Reboot<font color="#000080">( </font>BootCode <font color="#000080">:</font>WORD <font color="#000080">);
                      </font><font color="#008000"><i>{ Routine to reboot system according to boot code.}


</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetChar<font color="#000080">( </font>X<font color="#000080">,</font>Y <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Attrib<font color="#000080">:</font>BYTE <font color="#000080">) :</font>CHAR<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{ *********************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CoProcessorExist <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CoProcessorExist <font color="#000080">:= (</font>EquipFlag <font color="#FF0000"><b>And </b></font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NumPrinters <font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>NumPrinters <font color="#000080">:= </font>EquipFlag <font color="#FF0000"><b>Shr </b></font><font color="#800000">14</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GameIOAttached <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GameIOAttached <font color="#000080">:= (</font>EquipFlag <font color="#FF0000"><b>And </b></font><font color="#800000">$1000</font><font color="#000080">) = </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NumSerialPorts <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>NumSerialPorts <font color="#000080">:= (</font>EquipFlag <font color="#FF0000"><b>Shr </b></font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#800000">$07</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NumDisketteDrives <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>NumDisketteDrives <font color="#000080">:= ((</font>EquipFlag <font color="#FF0000"><b>And </b></font><font color="#800000">1</font><font color="#000080">) * (</font><font color="#800000">1</font><font color="#000080">+(</font>EquipFlag <font color="#FF0000"><b>Shr </b></font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#800000">$03</font><font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>InitialVideoMode <font color="#000080">:</font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>InitialVideoMode <font color="#000080">:= (</font>EquipFlag <font color="#FF0000"><b>Shr </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#800000">$03</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Noise<font color="#000080">( </font>Pitch<font color="#000080">, </font>Duration <font color="#000080">:</font>INTEGER <font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>Sound<font color="#000080">(</font>Pitch<font color="#000080">);
  </font>Delay<font color="#000080">(</font>Duration<font color="#000080">);
  </font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Time <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>H<font color="#000080">,</font>M<font color="#000080">,</font>S<font color="#000080">,</font>T      <font color="#000080">:</font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
    </b></font>GetTime<font color="#000080">(</font>H<font color="#000080">,</font>M<font color="#000080">,</font>S<font color="#000080">,</font>T<font color="#000080">);
    </font>Str<font color="#000080">(</font>H<font color="#000080">,</font>Hour<font color="#000080">);
    </font>Str<font color="#000080">(</font>M<font color="#000080">,</font>Min<font color="#000080">);
    </font>Str<font color="#000080">(</font>S<font color="#000080">,</font>Sec<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
      </b></font>Sec <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>Sec<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>M <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
        </b></font>Min <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>Min<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>H <font color="#000080">&gt; </font><font color="#800000">12 </font><font color="#FF0000"><b>Then
    BEGIN
       </b></font>Str<font color="#000080">(</font>H <font color="#000080">- </font><font color="#800000">12</font><font color="#000080">, </font>Hour<font color="#000080">);
       </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Hour<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>Hour <font color="#000080">:= </font><font color="#800000">' ' </font><font color="#000080">+ </font>Hour<font color="#000080">;
          </font>Time <font color="#000080">:= </font>Hour <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>Min <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>Sec<font color="#000080">+</font><font color="#800000">' pm'
    </font><font color="#FF0000"><b>END
    ELSE
      BEGIN
       If </b></font>H <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
         </b></font>Time <font color="#000080">:=   </font><font color="#800000">'12:' </font><font color="#000080">+ </font>Min <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>Sec <font color="#000080">+ </font><font color="#800000">' am'
       </font><font color="#FF0000"><b>ELSE
         </b></font>Time <font color="#000080">:= </font>Hour <font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>Min<font color="#000080">+</font><font color="#800000">':'</font><font color="#000080">+</font>Sec<font color="#000080">+</font><font color="#800000">' am'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>H <font color="#000080">= </font><font color="#800000">12 </font><font color="#FF0000"><b>Then
       </b></font>Time <font color="#000080">:= </font>Hour <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>Min <font color="#000080">+ </font><font color="#800000">':' </font><font color="#000080">+ </font>Sec <font color="#000080">+ </font><font color="#800000">' pm'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>WeekDate <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>TYPE
  </b></font>WeekDays <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">]  </font><font color="#FF0000"><b>Of STRING</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">];
  </font>Months   <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>Of STRING</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">];

</font><font color="#FF0000"><b>CONST
    </b></font>DayNames   <font color="#000080">: </font>WeekDays  <font color="#000080">= (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'</font><font color="#000080">,
                              </font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);
    </font>MonthNames <font color="#000080">: </font>Months    <font color="#000080">= (</font><font color="#800000">'January'</font><font color="#000080">,</font><font color="#800000">'February'</font><font color="#000080">,</font><font color="#800000">'March'</font><font color="#000080">,</font><font color="#800000">'April'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,
                              </font><font color="#800000">'June'</font><font color="#000080">,</font><font color="#800000">'July'</font><font color="#000080">,</font><font color="#800000">'August'</font><font color="#000080">,</font><font color="#800000">'September'</font><font color="#000080">,
                              </font><font color="#800000">'October'</font><font color="#000080">,</font><font color="#800000">'November'</font><font color="#000080">,</font><font color="#800000">'December'</font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
         </b></font>Y<font color="#000080">,
         </font>M<font color="#000080">,
         </font>D<font color="#000080">,
         </font>DayOfWeek <font color="#000080">:</font>WORD<font color="#000080">;
         </font>Year      <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
         </font>Day       <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
    </b></font>GetDate<font color="#000080">(</font>Y<font color="#000080">,</font>M<font color="#000080">,</font>D<font color="#000080">,</font>DayofWeek<font color="#000080">);
    </font>Str<font color="#000080">(</font>Y<font color="#000080">,</font>Year<font color="#000080">);
    </font>Str<font color="#000080">(</font>D<font color="#000080">,</font>Day<font color="#000080">);
    </font>WeekDate <font color="#000080">:= </font>DayNames<font color="#000080">[</font>DayOfWeek<font color="#000080">] + </font><font color="#800000">' ' </font><font color="#000080">+ </font>MonthNames<font color="#000080">[</font>M<font color="#000080">] + </font><font color="#800000">' ' </font><font color="#000080">+ </font>Day<font color="#000080">+ </font><font color="#800000">', '
     </font><font color="#000080">+ </font>Year<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>DayOfWeek<font color="#000080">( </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>Year <font color="#000080">:</font>WORD <font color="#000080">) :</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>ivar1<font color="#000080">, </font>ivar2    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>Day <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Day <font color="#000080">&lt; </font><font color="#800000">32</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Month <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Month <font color="#000080">&lt; </font><font color="#800000">13</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>ivar1 <font color="#000080">:= ( </font>Year <font color="#FF0000"><b>MOD </b></font><font color="#800000">100 </font><font color="#000080">);
          </font>ivar2 <font color="#000080">:= </font>Day <font color="#000080">+ </font>ivar1 <font color="#000080">+ </font>ivar1 <font color="#FF0000"><b>DIV </b></font><font color="#800000">4</font><font color="#000080">;
          </font><font color="#FF0000"><b>CASE </b></font>Month <font color="#FF0000"><b>OF
              </b></font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">7    </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">10   </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#800000">5       </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
              </font><font color="#800000">8       </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
              </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">11  </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
              </font><font color="#800000">6       </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
              </font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">12    </font><font color="#000080">: </font>ivar1 <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
          </i></font>ivar2 <font color="#000080">:= ( </font>ivar1 <font color="#000080">+ </font>ivar2 <font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">7</font><font color="#000080">;
          </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( </font>ivar2 <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>ivar2 <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
          </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{IF}
    </i></font><font color="#FF0000"><b>ELSE
        </b></font>ivar2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>DayOfWeek <font color="#000080">:= </font>BYTE<font color="#000080">( </font>ivar2 <font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PrinterOK <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                </font><font color="#008000"><i>{  Determine whether printer is on or off line         }
</i></font><font color="#FF0000"><b>BEGIN
  If </b></font><font color="#000080">(</font>Port<font color="#000080">[</font><font color="#800000">$379</font><font color="#000080">]) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#800000">16</font><font color="#000080">) &lt;&gt; </font><font color="#800000">16 </font><font color="#FF0000"><b>Then
     </b></font>PrinterOK <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
     </b></font>PrinterOK <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>AdlibCard <font color="#000080">:</font>BOOLEAN<font color="#000080">;
        </font><font color="#008000"><i>{  Routine to determine if a Adlib compatible card is installed }
</i></font><font color="#FF0000"><b>VAR
        </b></font>Val1<font color="#000080">,</font>Val2 <font color="#000080">:</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;                </font><font color="#008000"><i>{  Write 60h to register 4              }
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);                        </font><font color="#008000"><i>{  Which resets timer 1 and 2           }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$60</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;                </font><font color="#008000"><i>{  Write 80h to register 4              }
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);                     </font><font color="#008000"><i>{  Which enables interrupts             }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$80</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Val1 <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">];                </font><font color="#008000"><i>{  Read status byte                     }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;                </font><font color="#008000"><i>{  Write ffh to register 2              }
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);                     </font><font color="#008000"><i>{  Which is also Timer 1                }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$FF</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;                </font><font color="#008000"><i>{  Write 21h to register 4              }
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);                        </font><font color="#008000"><i>{  Which will Start Timer 1             }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$21</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">85</font><font color="#000080">);                        </font><font color="#008000"><i>{  wait 85 microseconds                 }
  </i></font>Val2 <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">];                </font><font color="#008000"><i>{  read status byte                     }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;                </font><font color="#008000"><i>{  Repeat the first to steps            }
  </i></font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);                        </font><font color="#008000"><i>{  Which will reset both Timers         }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$60</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$388</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
  </font>Port<font color="#000080">[</font><font color="#800000">$389</font><font color="#000080">] := </font><font color="#800000">$80</font><font color="#000080">;                        </font><font color="#008000"><i>{  Now test the status bytes saved }
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Val1 <font color="#FF0000"><b>And </b></font><font color="#800000">$E0</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">((</font>Val2 <font color="#FF0000"><b>And </b></font><font color="#800000">$E0</font><font color="#000080">) = </font><font color="#800000">$C0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
     </b></font>AdlibCard <font color="#000080">:= </font>True                        <font color="#008000"><i>{  Card was found               }
  </i></font><font color="#FF0000"><b>Else
     </b></font>AdlibCard <font color="#000080">:= </font>False<font color="#000080">;                </font><font color="#008000"><i>{  No Card Installed            }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>TrueDosVer <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                </font><font color="#008000"><i>{  Returns true Dos Version. Not affected by Setver     }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,$3306                  </font><font color="#008000"><i>{  get true dos ver                     }
  </i></font><font color="#FF00FF">Int $21                        </font><font color="#008000"><i>{  Call Dos                             }
  </i></font><font color="#FF00FF">Mov AX,BX                     </font><font color="#008000"><i>{  Return proper results                }

        {  DL = Revision Number                                         }
        {  DH = V Flags, 8h = Dos in ROM,  10h Dos in HMA               }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{TrueDosVer}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetPrtScr<font color="#000080">( </font>On_OFF <font color="#000080">:</font>BOOLEAN <font color="#000080">);
                </font><font color="#008000"><i>{  Routine to Enable or disable Print screen key   }
</i></font><font color="#FF0000"><b>BEGIN
  If </b></font>On_OFF <font color="#FF0000"><b>Then                </b></font><font color="#008000"><i>{  Turn it on                      }
    </i></font>Mem<font color="#000080">[</font><font color="#800000">$0050</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">] := </font><font color="#800000">0
  </font><font color="#FF0000"><b>Else
    </b></font>Mem<font color="#000080">[</font><font color="#800000">$0050</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;        </font><font color="#008000"><i>{  Turn it off                     }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>CpuType <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                 </font><font color="#008000"><i>{  Returns a value depending on the type of CPU        }
                 {          0 = 8088/V20 or compatible                  }
                 {          1 = 80286    2 = 80386/80486+               }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Xor DX,DX                             </font><font color="#008000"><i>{  Clear DX                     }
  </i></font><font color="#FF00FF">Push DX
  PopF                                  </font><font color="#008000"><i>{  Clear Flags                  }
  </i></font><font color="#FF00FF">PushF
  Pop AX                                </font><font color="#008000"><i>{  Load Cleared Flags           }
  </i></font><font color="#FF00FF">And AX,$0F000                         </font><font color="#008000"><i>{  Check hi bits for F0h        }
  </i></font><font color="#FF00FF">Cmp AX,$0F000
  Je @Quit                              </font><font color="#008000"><i>{  Quit if 8088                 }
  </i></font><font color="#FF00FF">Inc DX
  Mov AX,$0F000                         </font><font color="#008000"><i>{  Now Check For 80286          }
  </i></font><font color="#FF00FF">Push AX
  PopF
  PushF
  Pop AX
  And AX,$0F000                         </font><font color="#008000"><i>{  If The top 4 bits aren't set }
  </i></font><font color="#FF00FF">Jz @Quit                              </font><font color="#008000"><i>{  Its a 80286+                 }
  </i></font><font color="#FF00FF">Inc DX                                </font><font color="#008000"><i>{  Else its a 80386 or better   }
</i></font><font color="#FF00FF">@Quit:
  Mov AX,DX                             </font><font color="#008000"><i>{  Return Result in AX          }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{CpuType}

</i></font><font color="#FF0000"><b>procedure </b></font>idepause<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'Press any key to return to IDE'</font><font color="#000080">);
  </font>pausekey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>RingDetect<font color="#000080">( </font>CPort <font color="#000080">:</font>WORD<font color="#000080">) :</font>BOOLEAN<font color="#000080">;
                             </font><font color="#008000"><i>{  Routine to detect whether or not the    }
                             {  phone is ringing by checking the comport}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>RingDetect <font color="#000080">:= </font>ODD<font color="#000080">( </font>PORT<font color="#000080">[</font>CPort<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">6 </font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DetectOs2<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ if you use Tpro, then write Hi(TpDos.DosVersion) }
  </i></font>DetectOs2 <font color="#000080">:= (</font>Lo<font color="#000080">(</font>Dos<font color="#000080">.</font>DosVersion<font color="#000080">) &gt; </font><font color="#800000">10</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>HiWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return high word of a LongInt.       }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,Long.WORD[2]              </font><font color="#008000"><i>{ Move High word into AX.            }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>LoWord<font color="#000080">( </font>Long <font color="#000080">:</font>LONGINT <font color="#000080">) :</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
                      </font><font color="#008000"><i>{ Routine to return low word of a LongInt.        }
</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">Mov AX,Long.WORD[0]              </font><font color="#008000"><i>{ Move low word into AX.             }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Running4DOS <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>Regs <font color="#FF0000"><b>do
     begin
       </b></font>ax <font color="#000080">:= </font><font color="#800000">$D44D</font><font color="#000080">;
       </font>bx <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">, </font>Regs<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">$44DD </font><font color="#FF0000"><b>then </b></font>Running4DOS <font color="#000080">:= </font>TRUE
     <font color="#FF0000"><b>else </b></font>Running4DOS <font color="#000080">:= </font>FALSE
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Reboot<font color="#000080">( </font>BootCode <font color="#000080">:</font>WORD <font color="#000080">);
                      </font><font color="#008000"><i>{ Routine to reboot system according to boot code.}
                      { Also flushes all DOS buffers.                   }
                      { NOTE: Doesn't update directory entries.         }
</i></font><font color="#FF0000"><b>BEGIN
  Inline</b></font><font color="#000080">(
          </font><font color="#800000">$BE</font><font color="#000080">/</font><font color="#800000">$0D</font><font color="#000080">/              </font><font color="#008000"><i>{ MOV   AH,0Dh                          }
          </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">/              </font><font color="#008000"><i>{ INT   21h                             }
          </i></font><font color="#800000">$FB</font><font color="#000080">/                  </font><font color="#008000"><i>{ STI                                   }
          </i></font><font color="#800000">$B8</font><font color="#000080">/</font>Bootcode<font color="#000080">/         </font><font color="#008000"><i>{ MOV   AX,BootCode                     }
          </i></font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$D8</font><font color="#000080">/              </font><font color="#008000"><i>{ MOV   DS,AX                           }
          </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$34</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/          </font><font color="#008000"><i>{ MOV   AX,1234h                        }
          </i></font><font color="#800000">$A3</font><font color="#000080">/</font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/          </font><font color="#008000"><i>{ MOV   [0472h],AX                      }
          </i></font><font color="#800000">$EA</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$FF</font><font color="#000080">); </font><font color="#008000"><i>{ JMP   FFFFh:0000h                     }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>GetChar<font color="#000080">( </font>X<font color="#000080">,</font>Y <font color="#000080">:</font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Attrib<font color="#000080">:</font>BYTE <font color="#000080">) :</font>CHAR<font color="#000080">;
                      </font><font color="#008000"><i>{ Retrieves the character and attribute of        }
                      { coordinates X,Y.                                }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Ofs <font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Ofs <font color="#000080">:= ((</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">160</font><font color="#000080">) + ((</font>X <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
  </font>Attrib <font color="#000080">:= </font>MEM<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Ofs<font color="#000080">];
  </font>GetChar <font color="#000080">:= </font>CHR<font color="#000080">( </font>MEM<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font>Ofs<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] );
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p></body>
</html>
