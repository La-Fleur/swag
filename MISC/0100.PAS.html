<html>
<head><title> "**APPENDING EXE**" by IAN LIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0100.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
There's a problem here. You can append the binary data but that won't make
code from both EXE files work. Either the first one will work, ignoring
the code from the second one, or the whole thing will turn into trash.

However, if you still want to try it, go ahead. Here are 3 untested by
compiling file copying programs that will only append IT2.EXE to the end of
IT.EXE. You'll be required to make or copy files called IT.EXE and IT2.EXE
for the use of this simple demonstration program.
}

</i></font><font color="#FF0000"><b>Program </b></font>BCopy1<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>objects<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>f<font color="#000080">,</font>f2<font color="#000080">:</font>tdosstream<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>f<font color="#000080">.</font>init <font color="#000080">(</font><font color="#800000">'IT.EXE'</font><font color="#000080">,</font>stopen<font color="#000080">);
 </font>f<font color="#000080">.</font>seek <font color="#000080">(</font>f<font color="#000080">.</font>getsize<font color="#000080">);
 </font>f2<font color="#000080">.</font>init <font color="#000080">(</font><font color="#800000">'IT2.EXE'</font><font color="#000080">,</font>stopen<font color="#000080">);
 </font>f<font color="#000080">.</font>copyfrom<font color="#000080">(</font>f2<font color="#000080">,</font>f2<font color="#000080">.</font>getsize<font color="#000080">);
 </font>f<font color="#000080">.</font>done<font color="#000080">;
 </font>f2<font color="#000080">.</font>done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>Program </b></font>BCopy2<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>f<font color="#000080">,</font>f2<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
 </font>blocks<font color="#000080">:</font>longint<font color="#000080">;
 </font>bytes<font color="#000080">:</font>word<font color="#000080">;
 </font>buffer<font color="#000080">:</font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'IT.EXE'</font><font color="#000080">);
 </font>assign<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'IT2.EXE'</font><font color="#000080">);
 </font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>reset<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>seek<font color="#000080">(</font>f<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">));
 </font>bytes<font color="#000080">:=</font>filesize<font color="#000080">(</font>f2<font color="#000080">);
 </font>blocks<font color="#000080">:=</font>bytes <font color="#FF0000"><b>div </b></font><font color="#800000">2048</font><font color="#000080">;
 </font>bytes<font color="#000080">:=</font>bytes <font color="#FF0000"><b>mod </b></font><font color="#800000">2048</font><font color="#000080">;
 </font><font color="#FF0000"><b>while </b></font>blocks<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
  </b></font>blockread<font color="#000080">(</font>f2<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">));
  </font>blockwrite<font color="#000080">(</font>f<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">));
  </font>dec<font color="#000080">(</font>blocks<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>bytes<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
  </b></font>blockread<font color="#000080">(</font>f2<font color="#000080">,</font>buffer<font color="#000080">,</font>bytes<font color="#000080">);
  </font>blockwrite<font color="#000080">(</font>f<font color="#000080">,</font>buffer<font color="#000080">,</font>bytes<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>close<font color="#000080">(</font>f<font color="#000080">);
 </font>close<font color="#000080">(</font>f2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>Program </b></font>BCopy3<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>swapvectors<font color="#000080">;
 </font>exec<font color="#000080">(</font>getenv<font color="#000080">(</font><font color="#800000">'comspec'</font><font color="#000080">),</font><font color="#800000">'/c copy /b it.exe+it2.exe it.exe'</font><font color="#000080">);
 </font>swapvectors<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0100.PAS">Original</a><b>]</b></p></body>
</html>
