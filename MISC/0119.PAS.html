<html>
<head><title> "Compilation Dates - Preprocessor" by MARK LEWIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0119.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
&gt; Is it possible to display date and time of compilation from
&gt; a program compiled under Borland Pascal?  If yes, how?

if you mean like C programs can do, yes it is possible. it takes an
external utility, a .BAT file, and a &quot;special&quot; line in your program's
CONST section. C programs have a preprocessor that looks for and
replaces tokens with certain information. we just create our own for
this special need/desire...

here's what the &quot;special&quot; line in the program source has to look like...
if it doesn't look just like this, it will NOT work correctly...

const
  progname      : string[6]  = 'PostIt';
  MergeCode     : string[57] = 'Product of Quartz Crystal Software';
&gt; {$I compiled}
  cfgfile       : string[10] = 'POSTIT.CFG';
  tearline      : string[4]  = '--- ';


the key to this is that you have to have the line in a section of
CONST's that are actually used. if none of the other four CONST's above
were used in the program, the time and date of the compile would not be
included in the final .EXE file. whether you display it on the screen or
not is your choice.


first, the .BAT file i use to compile programs with...

@echo off
rem **********************************************************
rem * COMPIT.BAT                                             *
rem *                                                        *
rem * uses a 4DOS specific option %&amp; to pass the rest of the *
rem * command line on to the TPC compiler                    *
rem *                                                        *
rem * TPPP is our Turbo Pascal PreProcessor utility &lt;&lt;smile&gt;&gt;*
rem **********************************************************
if exist compiled.pas del compiled.pas
if '%1' == '' goto error
tppp
tpc /ic:\tp /uc:\tp /tc:\tp /oc:\tp %&amp;
goto end
:error
echo 
echo What file to compile?
echo.
echo  ie: COMPIT thisfile.pas
echo.
:end


now the source to TPPP...
*)

</i></font><font color="#FF0000"><b>program </b></font>Turbo_Pascal_Pre_Processor<font color="#000080">;

</font><font color="#008000"><i>{ this program started out as a preprocessor but i've not had a }
{ chance to do more with it than to hard code only a time/date  }
{ string for an include file :(                                 }

</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>thefile <font color="#000080">: </font>text<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DATE <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>months <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] =
    (</font><font color="#800000">'Jan'</font><font color="#000080">,</font><font color="#800000">'Feb'</font><font color="#000080">,</font><font color="#800000">'Mar'</font><font color="#000080">,</font><font color="#800000">'Apr'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'Jun'</font><font color="#000080">,
     </font><font color="#800000">'Jul'</font><font color="#000080">,</font><font color="#800000">'Aug'</font><font color="#000080">,</font><font color="#800000">'Sep'</font><font color="#000080">,</font><font color="#800000">'Oct'</font><font color="#000080">,</font><font color="#800000">'Nov'</font><font color="#000080">,</font><font color="#800000">'Dec'</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>y<font color="#000080">, </font>m<font color="#000080">, </font>d<font color="#000080">, </font>dow <font color="#000080">: </font>Word<font color="#000080">;
  </font>daystr  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>yearstr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetDate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dow<font color="#000080">);
  </font>str<font color="#000080">(</font>d<font color="#000080">,</font>daystr<font color="#000080">);
  </font>str<font color="#000080">(</font>y<font color="#000080">,</font>yearstr<font color="#000080">);
  </font>DATE <font color="#000080">:= </font>daystr <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>months<font color="#000080">[</font>m<font color="#000080">] + </font><font color="#800000">' ' </font><font color="#000080">+ </font>yearstr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TIME <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hund <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>LeadingZero<font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Str<font color="#000080">(</font>w<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font>s<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
    </font>LeadingZero <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetTime<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">,</font>hund<font color="#000080">);
  </font>TIME <font color="#000080">:= </font>LeadingZero<font color="#000080">(</font>h<font color="#000080">) + </font><font color="#800000">':' </font><font color="#000080">+ </font>LeadingZero<font color="#000080">(</font>m<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>thefile<font color="#000080">,</font><font color="#800000">'COMPILED.PAS'</font><font color="#000080">);
  </font>rewrite<font color="#000080">(</font>thefile<font color="#000080">);
  </font>writeln<font color="#000080">(</font>thefile<font color="#000080">,
    </font><font color="#800000">'compiled : string[32] = ''Compiled on '</font><font color="#000080">,</font>DATE<font color="#000080">,</font><font color="#800000">' at '</font><font color="#000080">,</font>TIME<font color="#000080">,</font><font color="#800000">''';'</font><font color="#000080">);
  </font>close<font color="#000080">(</font>thefile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
TPPP was originally going to process source code files that comtained
tokens like C coders can use. something similar to the following...

  compiled : string[32] = 'Compiled on __DATE__ at __TIME__';

i've just not had the time to complete any more of the design and coding
needed... this suits my desires for now...
{

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0119.PAS">Original</a><b>]</b></p></body>
</html>
