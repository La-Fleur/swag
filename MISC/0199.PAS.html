<html>
<head><title> "Variety of Useful Routines" by TOBIN FRICKE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Usefull<font color="#000080">;

</font><font color="#008000"><i>{ Copyright (C) 1995 by Tobin T. Fricke, All Rights Reserved            }
{ Use this and have fun, but tell me first.  BBS 714-586-6142           }
{ Make sure to mention that you used this in your documentation of your }
{ program(s) if you do use it.  Thanks.                                 }
{ I didn't write all of the routines, but I wrote most of them.         }

{ If you use this, I'd appreciate it if you could send me a postcard    }
{ from where you live, or at least send me an email.  My email address  }
{ is tobin@mail.edm.net.  If that doesn't work, try using               }
{ fricke@roboben.engr.ucdavis.edu.  My postal address is:               }
{ 25001 El Cortijo Ln., Mission Viejo, CA 92691-5236, USA.  Thanks!     }

{ Updated May 1995 }

</i></font><font color="#FF0000"><b>Interface

</b></font><font color="#008000"><i>{$IFDEF WINDOWS}
</i></font><font color="#FF0000"><b>type
    </b></font><font color="#008000"><i>{ Date &amp; time recored used by PackTime }
    { and UnpackTime }
  </i></font>DateTime <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

 </i></font><font color="#FF0000"><b>Type </b></font>MIDRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>InfoLevel <font color="#000080">: </font>Word<font color="#000080">;
     </font>SerialNum <font color="#000080">: </font>LongInt<font color="#000080">;   </font><font color="#008000"><i>{This is the serial number...}
     </i></font>VolLabel  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>FatType   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFNDEF OS2} </i></font><font color="#FF0000"><b>Function </b></font>Label_Fat<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Mid <font color="#000080">: </font>MidRecord<font color="#000080">; </font>Drive <font color="#000080">: </font>Word<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>Function </b></font>LongToHex<font color="#000080">(</font>L<font color="#000080">:</font>Longint<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Center<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Center returns a S, centered with spaces, of length B }
</i></font><font color="#FF0000"><b>Function  </b></font>Left<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ returns a Left-Justied string, length B              }
</i></font><font color="#FF0000"><b>Function  </b></font>PadRight<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">; </font>C<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ returns S padded with B of C on the Right            }
</i></font><font color="#FF0000"><b>Function  </b></font>Right<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ same as Left, but right-justifies                    }
</i></font><font color="#FF0000"><b>function  </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ does Filename Exist?                                 }
</i></font><font color="#FF0000"><b>Function  </b></font>UpString<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns S in upper case                              }
</i></font><font color="#FF0000"><b>Function  </b></font>LoString<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns S in lower case                              }
</i></font><font color="#FF0000"><b>Function  </b></font>LoCase<font color="#000080">(</font>C<font color="#000080">:</font>Char<font color="#000080">):</font>Char<font color="#000080">;
</font><font color="#008000"><i>{ Returns C in lower case                              }
</i></font><font color="#FF0000"><b>Function  </b></font>Str<font color="#000080">(</font>X<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Converts X to a string                               }
</i></font><font color="#FF0000"><b>Function  </b></font>Strw<font color="#000080">(</font>X<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Convert a Word to a String                           }
</i></font><font color="#FF0000"><b>Function  </b></font>Strl<font color="#000080">(</font>X<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>StrR<font color="#000080">(</font>X<font color="#000080">:</font>Real<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>WhatDir<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Val<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ValW<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ValL<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Rep<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>TempFile<font color="#000080">( </font>Path<font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">): </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>SizeOfFile<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>NameCaps<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Capitalize The First Letter Of Each Word             }
</i></font><font color="#FF0000"><b>Function  </b></font>Del<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Index<font color="#000080">: </font>Integer<font color="#000080">; </font>Count<font color="#000080">:</font>Integer<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Delete, but as a function                            }
</i></font><font color="#FF0000"><b>Function  </b></font>Strip_<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Changes _'s to spaces                                }
</i></font><font color="#FF0000"><b>Function  </b></font>ActualFileSize<font color="#000080">:</font>LongInt<font color="#000080">;
</font><font color="#008000"><i>{ How big is your EXE?                                 }
</i></font><font color="#FF0000"><b>Procedure </b></font>Lines<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Lines50<font color="#000080">;              </font><font color="#008000"><i>{ Go into 50 lines-mode}
</i></font><font color="#FF0000"><b>Procedure </b></font>Lines25<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Lines35<font color="#000080">;
</font><font color="#008000"><i>{$IFNDEF OS2}
</i></font><font color="#FF0000"><b>Function  </b></font>NetworkDrive<font color="#000080">(</font>Drive<font color="#000080">:</font>Char<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>Function  </b></font>StrBool<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SwapStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Swaps A and B:  C=A; A=B; B=C; }
</i></font><font color="#FF0000"><b>Procedure </b></font>ConvertBase<font color="#000080">(</font>BaseN<font color="#000080">:</font>Byte<font color="#000080">; </font>BaseNNumber<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                                  </font>BaseZ<font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>BaseZNumber<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{ Converts base 2-36 to base 2-36                                  }
</i></font><font color="#FF0000"><b>Function </b></font>WordWrap<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Remainder<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Tobin's wonder-word-wrap.                                        }
</i></font><font color="#FF0000"><b>Function </b></font>AN<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ prepends &quot;a &quot; or &quot;an &quot; to S, based on the first letter }
</i></font><font color="#FF0000"><b>Function </b></font>LastDrive<font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>UError<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Implementation


</b></font><font color="#008000"><i>{$IFDEF WINDOWS}
</i></font><font color="#FF0000"><b>Uses </b></font>WinCRT<font color="#000080">, </font>WinDOS<font color="#000080">;
</font><font color="#008000"><i>{$ELSE}
</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">, </font>DOS<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{$IFNDEF OS2}
</i></font><font color="#FF0000"><b>Function </b></font>Label_Fat<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Mid <font color="#000080">: </font>MidRecord<font color="#000080">; </font>Drive <font color="#000080">: </font>Word<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Result <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Regs   <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>FillChar<font color="#000080">(</font>Mid<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Mid<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
     </font>FillChar<font color="#000080">(</font>Regs<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Regs<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>With </b></font>Regs <font color="#FF0000"><b>DO
     Begin
          </b></font>AX <font color="#000080">:= </font><font color="#800000">$440D</font><font color="#000080">;
          </font>BX <font color="#000080">:= </font>Drive<font color="#000080">;
          </font>CX <font color="#000080">:= </font><font color="#800000">$0866</font><font color="#000080">;
          </font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>Mid<font color="#000080">);
          </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>Mid<font color="#000080">);
          </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">,</font>Regs<font color="#000080">);
          </font><font color="#FF0000"><b>Case </b></font>AX <font color="#FF0000"><b>of
               </b></font><font color="#800000">$01 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
               </font><font color="#800000">$02 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
               </font><font color="#800000">$05 </font><font color="#000080">: </font>Label_Fat <font color="#000080">:= </font>False<font color="#000080">;
               </font><font color="#FF0000"><b>Else </b></font>Label_Fat <font color="#000080">:= </font>True<font color="#000080">;
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}
(*
Var Mid : MidRecord;
Begin
     ClrScr;
     If Label_Fat(Mid,0) Then
     With Mid DO
     Begin
          Writeln(SerialNum);
          Writeln(VolLabel);
          Writeln(FatType);
     End
     Else Writeln('Error Occured');
End.
*)

</i></font><font color="#FF0000"><b>Procedure </b></font>ConvertBase<font color="#000080">(</font>BaseN<font color="#000080">:</font>Byte<font color="#000080">; </font>BaseNNumber<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                                  </font>BaseZ<font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>BaseZNumber<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
  </font>Number<font color="#000080">,</font>Remainder<font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>Number <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length <font color="#000080">(</font>BaseNNumber<font color="#000080">) </font><font color="#FF0000"><b>do
  case </b></font>BaseNNumber<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>of
    </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">: </font>Number <font color="#000080">:= </font>Number <font color="#000080">* </font>BaseN <font color="#000080">+ </font>Ord <font color="#000080">(</font>BasenNumber<font color="#000080">[</font>I<font color="#000080">]) - </font>Ord <font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
    </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">: </font>Number <font color="#000080">:= </font>Number <font color="#000080">* </font>BaseN <font color="#000080">+ </font>Ord <font color="#000080">(</font>BasenNumber<font color="#000080">[</font>I<font color="#000080">]) -
      </font>Ord <font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">) + </font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">: </font>Number <font color="#000080">:= </font>Number <font color="#000080">* </font>BaseN <font color="#000080">+ </font>Ord <font color="#000080">(</font>BasenNumber<font color="#000080">[</font>I<font color="#000080">]) -
      </font>Ord <font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">) + </font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font>BaseZNumber <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font><font color="#FF0000"><b>while </b></font>Number <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
  </b></font>Remainder <font color="#000080">:= </font>Number <font color="#FF0000"><b>mod </b></font>BaseZ<font color="#000080">;
  </font>Number <font color="#000080">:= </font>Number <font color="#FF0000"><b>div </b></font>BaseZ<font color="#000080">;
  </font><font color="#FF0000"><b>case </b></font>Remainder <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">: </font>BaseZNumber <font color="#000080">:= </font>Char <font color="#000080">(</font>Remainder <font color="#000080">+ </font>Ord <font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">)) + </font>BaseZNumber<font color="#000080">;
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">36</font><font color="#000080">: </font>BaseZNumber <font color="#000080">:= </font>Char <font color="#000080">(</font>Remainder <font color="#000080">- </font><font color="#800000">10 </font><font color="#000080">+ </font>Ord <font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)) + </font>BaseZNumber<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SwapStr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>C<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>C<font color="#000080">:=</font>A<font color="#000080">;
 </font>A<font color="#000080">:=</font>B<font color="#000080">;
 </font>B<font color="#000080">:=</font>C<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$IFDEF XXX}
</i></font><font color="#FF0000"><b>Type </b></font>Registers <font color="#000080">= </font><font color="#FF0000"><b>record
                case </b></font>Integer <font color="#FF0000"><b>of
                  </b></font><font color="#800000">0</font><font color="#000080">: (</font>AX<font color="#000080">,</font>BX<font color="#000080">,</font>CX<font color="#000080">,</font>DX<font color="#000080">,</font>BP<font color="#000080">,</font>SI<font color="#000080">,</font>DI<font color="#000080">,</font>DS<font color="#000080">,</font>ES<font color="#000080">,</font>Flags<font color="#000080">: </font>Word<font color="#000080">);
                  </font><font color="#800000">1</font><font color="#000080">: (</font>AL<font color="#000080">,</font>AH<font color="#000080">,</font>BL<font color="#000080">,</font>BH<font color="#000080">,</font>CL<font color="#000080">,</font>CH<font color="#000080">,</font>DL<font color="#000080">,</font>DH<font color="#000080">: </font>Byte<font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{$IFNDEF OS2}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>NetworkDrive <font color="#000080">(</font>Drive<font color="#000080">:</font>CHAR<font color="#000080">):</font>BOOLEAN<font color="#000080">;
</font><font color="#008000"><i>{$Ifdef windows} </i></font><font color="#FF0000"><b>var </b></font>reg<font color="#000080">:</font>Tregisters<font color="#000080">; </font><font color="#008000"><i>{$else} </i></font><font color="#FF0000"><b>var </b></font>Reg<font color="#000080">:</font>Registers<font color="#000080">; </font><font color="#008000"><i>{$endif}
</i></font><font color="#FF0000"><b>var </b></font>DosErrorCode<font color="#000080">:</font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Drive <font color="#000080">:= </font>UpCase <font color="#000080">(</font>Drive<font color="#000080">);            </font><font color="#008000"><i>{ Drive _must_ be 'A'..'Z'  }
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Drive <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN BEGIN </b></font><font color="#008000"><i>{ make sure of 'A'..'Z'     }
      </i></font>Reg<font color="#000080">.</font>BL <font color="#000080">:= </font>ORD<font color="#000080">(</font>Drive<font color="#000080">) - </font><font color="#800000">64</font><font color="#000080">;      </font><font color="#008000"><i>{ 1 = A:, 2 = B:, 3 = C: etc. }
      </i></font>Reg<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">$4409</font><font color="#000080">;                </font><font color="#008000"><i>{ Dos fn: check if dev remote }
      </i></font>MsDos <font color="#000080">(</font>Reg<font color="#000080">);                    </font><font color="#008000"><i>{ call Dos' services          }
      </i></font><font color="#FF0000"><b>IF </b></font>ODD<font color="#000080">(</font>Reg<font color="#000080">.</font>FLAGS<font color="#000080">) </font><font color="#FF0000"><b>THEN          </b></font><font color="#008000"><i>{ Dos reports function error? }
        </i></font>DosErrorCode <font color="#000080">:= </font>Reg<font color="#000080">.</font>AX        <font color="#008000"><i>{ yes: return Dos' error code }
      </i></font><font color="#FF0000"><b>ELSE BEGIN                      </b></font><font color="#008000"><i>{   else ...                  }
        </i></font>DosErrorCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;            </font><font color="#008000"><i>{ 0 = no error was detected   }
        </i></font><font color="#FF0000"><b>IF </b></font>ODD<font color="#000080">(</font>Reg<font color="#000080">.</font>DX <font color="#FF0000"><b>SHR </b></font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>THEN    </b></font><font color="#008000"><i>{ is Drive remote?            }
          </i></font>NetworkDrive <font color="#000080">:= </font>TRUE        <font color="#008000"><i>{ yes: return TRUE            }
        </i></font><font color="#FF0000"><b>ELSE
          </b></font>NetworkDrive <font color="#000080">:= </font>FALSE<font color="#000080">;      </font><font color="#008000"><i>{ no: return FALSE            }
        {END IF ODD(Reg.DX...}
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{IF ODD(Reg.FLAGS)}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;    </font><font color="#008000"><i>{IF Drive}
</i></font><font color="#FF0000"><b>END    </b></font><font color="#008000"><i>{NetworkDrive}</i></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>Function </b></font>SizeofFile<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>S<font color="#000080">);
 </font>FileMode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>Reset<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>SizeOfFile<font color="#000080">:=</font>FileSize<font color="#000080">(</font>F<font color="#000080">);
 </font>Close<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ActualFileSize<font color="#000080">:</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>F<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>ActualFileSize<font color="#000080">:=</font>SizeOfFile<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Lines50<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV AH, 11H
  MOV AL, 12H
  MOV BL, 0
  INT 10H
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Lines25<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV AH, 11H
  MOV AL, 14H
  MOV BL, 0
  INT 10H
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Lines35<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV AH, 11H
  MOV AL, 11H
  MOV BL, 0
  INT 10H
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Lines<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
 If </b></font>Val<font color="#000080">(</font>S<font color="#000080">)=</font><font color="#800000">50 </font><font color="#FF0000"><b>then </b></font>Lines50<font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Val<font color="#000080">(</font>S<font color="#000080">)=</font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>Lines25<font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>Val<font color="#000080">(</font>S<font color="#000080">)=</font><font color="#800000">35 </font><font color="#FF0000"><b>then </b></font>Lines35<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Strip_<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>B<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 For </b></font>B<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do if </b></font>S<font color="#000080">[</font>B<font color="#000080">]=</font><font color="#800000">'_' </font><font color="#FF0000"><b>then </b></font>S<font color="#000080">[</font>B<font color="#000080">]:=</font><font color="#800000">' '</font><font color="#000080">;
 </font>Strip_<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Del<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Index<font color="#000080">:</font>Integer<font color="#000080">; </font>Count<font color="#000080">:</font>Integer<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,</font>Index<font color="#000080">,</font>Count<font color="#000080">);
 </font>Del<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WhatDir<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>s<font color="#000080">);
 </font>whatdir<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str<font color="#000080">(</font>X<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>System<font color="#000080">.</font>Str<font color="#000080">(</font>X<font color="#000080">,</font>S<font color="#000080">);
 </font>Str<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrL<font color="#000080">(</font>X<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>System<font color="#000080">.</font>Str<font color="#000080">(</font>X<font color="#000080">,</font>S<font color="#000080">);
 </font>StrL<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrW<font color="#000080">(</font>X<font color="#000080">:</font>word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>System<font color="#000080">.</font>Str<font color="#000080">(</font>X<font color="#000080">,</font>S<font color="#000080">);
 </font>StrW<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrR<font color="#000080">(</font>X<font color="#000080">:</font>Real<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>System<font color="#000080">.</font>Str<font color="#000080">(</font>X<font color="#000080">,</font>S<font color="#000080">);
 </font>StrR<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Val<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>System<font color="#000080">.</font>Val<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>B<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Val<font color="#000080">:=</font>A <font color="#FF0000"><b>else begin </b></font>Val<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>UError<font color="#000080">:=</font>B<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ValW<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>B<font color="#000080">:</font>Integer<font color="#000080">;
    </font>A<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>System<font color="#000080">.</font>Val<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>B<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>ValW<font color="#000080">:=</font>A <font color="#FF0000"><b>else begin </b></font>ValW<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>UError<font color="#000080">:=</font>B<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ValL<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>B<font color="#000080">:</font>integer<font color="#000080">;
    </font>A<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>System<font color="#000080">.</font>Val<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>B<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Vall<font color="#000080">:=</font>A <font color="#FF0000"><b>else begin </b></font>Vall<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>UError<font color="#000080">:=</font>B<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Upstring<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
    </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
 </font>Upstring<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LoCase<font color="#000080">(</font>C<font color="#000080">:</font>Char<font color="#000080">):</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
 If </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>C<font color="#000080">)&gt;</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>C<font color="#000080">)&lt;</font><font color="#800000">91</font><font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>LoCase<font color="#000080">:=</font>Char<font color="#000080">(</font>Ord<font color="#000080">(</font>C<font color="#000080">)+</font><font color="#800000">32</font><font color="#000080">)
    </font><font color="#FF0000"><b>else </b></font>LoCase<font color="#000080">:=</font>C<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LoString<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
    </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>LoCase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
 </font>Lostring<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>NameCaps<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>I<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>S<font color="#000080">:=</font>LoString<font color="#000080">(</font>S<font color="#000080">);
 </font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
   If </b></font>S<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then
     if </b></font>I<font color="#000080">&lt;</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>S<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
 </font>namecaps<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Boolean function that returns True if the file exists;otherwise,
 it returns False. Closes the file if it exists. }
</i></font><font color="#FF0000"><b>var
 </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$I-}
 </i></font>Filemode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
 </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{( Set file access to read only }
 </i></font>Reset<font color="#000080">(</font>F<font color="#000080">);
 </font>Close<font color="#000080">(</font>F<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font>FileExists <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }

</i></font><font color="#FF0000"><b>Function </b></font>Center<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Repeat
  </b></font>A<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>A<font color="#000080">&lt;(</font>B <font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>S<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">+</font>S<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)&gt;=((</font>B<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>S<font color="#000080">)&lt;</font>B <font color="#FF0000"><b>then </b></font>S<font color="#000080">:=</font>S<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
 </font>Center<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Left<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Repeat
  </b></font>A<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>A<font color="#000080">&lt;</font>B <font color="#FF0000"><b>then </b></font>S<font color="#000080">:=</font>S<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font>Length<font color="#000080">(</font>S<font color="#000080">)&gt;=((</font>B<font color="#000080">));
 </font><font color="#FF0000"><b>While </b></font>Length<font color="#000080">(</font>S<font color="#000080">)&gt;</font>B <font color="#FF0000"><b>do </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
 </font>Left<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>PadRight<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">; </font>C<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Repeat
  </b></font>A<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>A<font color="#000080">&lt;</font>B <font color="#FF0000"><b>then </b></font>S<font color="#000080">:=</font>C<font color="#000080">+</font>S<font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">)&gt;=(</font>B<font color="#000080">));
 </font>PadRight<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Right<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>B<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 </b></font>Right<font color="#000080">:=</font>PadRight<font color="#000080">(</font>S<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Rep<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>W<font color="#000080">:</font>Word<font color="#000080">;
    </font>T<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>T<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>W<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>C <font color="#FF0000"><b>do </b></font>T<font color="#000080">:=</font>T<font color="#000080">+</font>S<font color="#000080">;
 </font>Rep<font color="#000080">:=</font>T<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StrBool<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>S<font color="#000080">:=</font>UpString<font color="#000080">(</font>S<font color="#000080">);
 </font>StrBool<font color="#000080">:=(</font>Pos<font color="#000080">(</font><font color="#800000">'T'</font><font color="#000080">,</font>S<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>TempFile<font color="#000080">( </font>Path<font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">): </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
 </b></font><font color="#008000"><i>{$IFDEF WINDOWS}
   </i></font>DateStr  <font color="#000080">: </font>TDateTime<font color="#000080">;
 </font><font color="#008000"><i>{$ELSE}
   </i></font>DateStr  <font color="#000080">: </font>DateTime<font color="#000080">;
 </font><font color="#008000"><i>{$ENDIF}
   </i></font>Trash    <font color="#000080">: </font>WORD<font color="#000080">;
   </font>Time     <font color="#000080">: </font>LONGINT<font color="#000080">;
   </font>FileName <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 If </b></font><font color="#000080">(</font>Path<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Path<font color="#000080">[</font>length<font color="#000080">(</font>Path<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Path <font color="#000080">:= </font>Path <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
 </font><font color="#FF0000"><b>Repeat
  With </b></font>DateStr <font color="#FF0000"><b>Do
    Begin
     </b></font>GETDATE<font color="#000080">( </font>Year<font color="#000080">, </font>Month<font color="#000080">, </font>Day<font color="#000080">, </font>Trash <font color="#000080">);
     </font>GETTIME<font color="#000080">( </font>Hour<font color="#000080">, </font>Min<font color="#000080">, </font>Sec<font color="#000080">, </font>Trash <font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>PackTime<font color="#000080">( </font>DateStr<font color="#000080">, </font>Time <font color="#000080">);
  </font><font color="#008000"><i>{$R-,Q-}
  </i></font>System<font color="#000080">.</font>Str<font color="#000080">(</font>Time<font color="#000080">,</font>Filename<font color="#000080">);
  </font>FileName <font color="#000080">:= </font>Copy<font color="#000080">(</font>Filename<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font>FileName <font color="#000080">:= </font>Filename<font color="#000080">+</font><font color="#800000">'.$$$'</font><font color="#000080">;
  </font><font color="#008000"><i>{$R+,Q+}
 </i></font><font color="#FF0000"><b>Until Not </b></font>FileExists<font color="#000080">(</font>Path <font color="#000080">+ </font>FileName<font color="#000080">);
 </font>TempFile <font color="#000080">:= </font>Path <font color="#000080">+ </font>FileName<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WordWrap<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Remainder<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>W<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>I<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 If </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>delete<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>S<font color="#000080">)&lt;=</font>Len <font color="#FF0000"><b>then
  begin
   </b></font>WordWrap<font color="#000080">:=</font>S<font color="#000080">;
   </font>Remainder<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>Len <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
   If </b></font>S<font color="#000080">[</font>I<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then
    begin
     </b></font>WordWrap<font color="#000080">:=</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">);
     </font>Remainder<font color="#000080">:=</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font>I<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">)-</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
     </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>AN<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 While </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>do </b></font>delete<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>UPCASE<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">,</font><font color="#800000">'O'</font><font color="#000080">,</font><font color="#800000">'U'</font><font color="#000080">] </font><font color="#FF0000"><b>THEN </b></font>INSERT<font color="#000080">(</font><font color="#800000">'an '</font><font color="#000080">,</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE
                                               </b></font>INSERT<font color="#000080">(</font><font color="#800000">'a '</font><font color="#000080">,</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>AN<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LastDrive<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">mov   ah, 19h
  int   21h
  push  ax            </font><font color="#008000"><i>{ save default drive }
  </i></font><font color="#FF00FF">mov   ah, 0Eh
  mov   dl, 19h
  int   21h
  mov   cl, al
  dec   cx
@@CheckDrive:
  mov   ah, 0Eh       </font><font color="#008000"><i>{ check if drive valid }
  </i></font><font color="#FF00FF">mov   dl, cl
  int   21h
  mov   ah, 19h
  int   21h
  cmp   cl, al
  je    @@Valid
  dec   cl            </font><font color="#008000"><i>{ check next lovest drive number }
  </i></font><font color="#FF00FF">jmp   @@CheckDrive
@@Valid:
  pop   ax
  mov   dl, al
  mov   ah, 0Eh
  int   21h           </font><font color="#008000"><i>{ restore default drive }
  </i></font><font color="#FF00FF">mov   al, cl
  add   al, 'A'
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LongToHex<font color="#000080">(</font>L<font color="#000080">:</font>Longint<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>ConvertBase<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>StrL<font color="#000080">(</font>L<font color="#000080">),</font><font color="#800000">16</font><font color="#000080">,</font>S<font color="#000080">);
 </font>LongToHex<font color="#000080">:=</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p></body>
</html>
