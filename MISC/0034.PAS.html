<html>
<head><title> "Detect Float Error" by GERD KORTEMEYER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
GERD KORTEMEYER

here are two Units For trapping float-exceptions. In your Program you
will have to add

  Uses err387

and at the beginning of your main Program say For example

begin
   exception(overflow, masked);
   exception(underflow, dumpask);
   exception(invalid, dumpexit);
   autocorrect(zerodiv, 1.0);
   exception(precision, masked);

In this way you can choose For any kind of exception in which way it is
to be handeled. After the lines above the result of a division by zero
will be '1.0', in Case of an underflow there will be a dump of the copro
and the user will be asked For the result he wants the operation to have,
in Case of an overflow the largest available number will be chosen and
so on ...

Here are the Units

    err387 and dis387
}

{ ---------------------------------------------------------- }
{ Fehlerbehandlungsroutinen fuer den Intel 80387 bzw. 486 DX }
{ Geschrieben in Turbo Pascal 6.0                            }
{ von Gerd Kortemeyer, Hannover                              }
{ ---------------------------------------------------------- }

</i></font><font color="#FF0000"><b>Unit </b></font>err387<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses
  </b></font>dis387<font color="#000080">, </font>Dos<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>invalid   <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>denormal  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>zero_div  <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>overflow  <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>underflow <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
  </font>precision <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;
  </font>stackfault<font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;
  </font>con1      <font color="#000080">= </font><font color="#800000">512</font><font color="#000080">;

  </font>masked    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>runtime   <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>dump      <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>dumpexit  <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>dumpask   <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>autocorr  <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>exception<font color="#000080">(</font>which<font color="#000080">, </font>what <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>autocorrect<font color="#000080">(</font>which <font color="#000080">: </font>Word<font color="#000080">; </font>by <font color="#000080">: </font>Extended<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>handle_off<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>handle_on<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>restore_masks<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>clear_copro<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>status_Word <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>do_again <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Const
  </b></font>valid <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>zero  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>spec  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>empty <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;

  </font>topmask <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">14336</font><font color="#000080">;
  </font>topdiv  <font color="#000080">= </font><font color="#800000">2048</font><font color="#000080">;

  </font>anyerrors <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">63</font><font color="#000080">;

  </font>zweipot <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word <font color="#000080">=
    (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">256</font><font color="#000080">, </font><font color="#800000">512</font><font color="#000080">, </font><font color="#800000">1024</font><font color="#000080">,
     </font><font color="#800000">2048</font><font color="#000080">, </font><font color="#800000">4096</font><font color="#000080">, </font><font color="#800000">8192</font><font color="#000080">, </font><font color="#800000">16384</font><font color="#000080">, </font><font color="#800000">32768</font><font color="#000080">);

  </font>ex_nam <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">=
    (</font><font color="#800000">'Invalid   '</font><font color="#000080">,
     </font><font color="#800000">'Denormal  '</font><font color="#000080">,
     </font><font color="#800000">'Zero-Div  '</font><font color="#000080">,
     </font><font color="#800000">'Overflow  '</font><font color="#000080">,
     </font><font color="#800000">'Underflow '</font><font color="#000080">,
     </font><font color="#800000">'Precision '</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>setmasks <font color="#000080">: </font>Byte<font color="#000080">;
  </font>normal   <font color="#000080">: </font><font color="#FF0000"><b>Record
    Case </b></font>Boolean <font color="#FF0000"><b>OF
      </b></font>True <font color="#000080">: (</font>adr <font color="#000080">: </font>Pointer<font color="#000080">);
      </font>False<font color="#000080">: (</font>pro <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Exit_on<font color="#000080">,
  </font>dump_on<font color="#000080">,
  </font>ask_on<font color="#000080">,
  </font>auto_on<font color="#000080">,
  </font>standard <font color="#000080">: </font>Word<font color="#000080">;

  </font>auto_val <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Extended<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Mask<font color="#000080">(</font>which <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>cw <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">fstcw cw
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cw <font color="#000080">:= </font>cw <font color="#FF0000"><b>or </b></font>which<font color="#000080">;
  </font>setmasks <font color="#000080">:= </font>Lo<font color="#000080">(</font>cw<font color="#000080">);
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">fldcw cw
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Unmask<font color="#000080">(</font>which <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>cw <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">fclex
    fstcw cw
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>cw <font color="#000080">:= </font>cw <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>which<font color="#000080">);
  </font>setmasks <font color="#000080">:= </font>Lo<font color="#000080">(</font>cw<font color="#000080">);
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">fldcw cw
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>restore_masks<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>setm <font color="#000080">: </font>Word<font color="#000080">;
  </font>i    <font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>setm<font color="#000080">:=</font>setmasks<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    if </b></font><font color="#000080">(</font>setm <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Mask  <font color="#000080">(</font>zweipot<font color="#000080">[</font>i<font color="#000080">])
    </font><font color="#FF0000"><b>else
      </b></font>Unmask<font color="#000080">(</font>zweipot<font color="#000080">[</font>i<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>clear_copro<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>cw <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">fstcw cw
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>setmasks <font color="#000080">:= </font>Lo<font color="#000080">(</font>cw<font color="#000080">);
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">finit
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>status_Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">fstsw @result
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Bei welcher Exception soll was passieren? }
</i></font><font color="#FF0000"><b>Procedure </b></font>exception<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Case </b></font>what <font color="#FF0000"><b>OF

    </b></font>masked  <font color="#000080">: </font>Mask<font color="#000080">(</font>which<font color="#000080">);

    </font>runtime <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Unmask<font color="#000080">(</font>which<font color="#000080">);
        </font>standard <font color="#000080">:= </font>standard <font color="#FF0000"><b>or </b></font>which<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>dump <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Unmask<font color="#000080">(</font>which<font color="#000080">);
        </font>standard <font color="#000080">:= </font>standard <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>dump_on  <font color="#000080">:= </font>dump_on  <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
        </font>Exit_on  <font color="#000080">:= </font>Exit_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>ask_on   <font color="#000080">:= </font>ask_on   <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>auto_on  <font color="#000080">:= </font>auto_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>dumpexit <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Unmask<font color="#000080">(</font>which<font color="#000080">);
        </font>standard <font color="#000080">:= </font>standard <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>dump_on  <font color="#000080">:= </font>dump_on  <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
        </font>Exit_on  <font color="#000080">:= </font>Exit_on  <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
        </font>ask_on   <font color="#000080">:= </font>ask_on   <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>auto_on  <font color="#000080">:= </font>auto_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>dumpask <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Unmask<font color="#000080">(</font>which<font color="#000080">);
        </font>standard <font color="#000080">:= </font>standard <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>dump_on  <font color="#000080">:= </font>dump_on  <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
        </font>Exit_on  <font color="#000080">:= </font>Exit_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
        </font>ask_on   <font color="#000080">:= </font>ask_on   <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
        </font>auto_on  <font color="#000080">:= </font>auto_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ zum Setzen von Auto-Korrekt-Werten }

</i></font><font color="#FF0000"><b>Procedure </b></font>autocorrect<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Unmask<font color="#000080">(</font>which<font color="#000080">);
   </font>standard <font color="#000080">:= </font>standard <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
   </font>dump_on  <font color="#000080">:= </font>dump_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
   </font>Exit_on  <font color="#000080">:= </font>Exit_on  <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
   </font>ask_on   <font color="#000080">:= </font>ask_on   <font color="#FF0000"><b>and NOT</b></font><font color="#000080">(</font>which<font color="#000080">);
   </font>auto_on  <font color="#000080">:= </font>auto_on  <font color="#FF0000"><b>or  </b></font>which<font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
     if </b></font><font color="#000080">(</font>which <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       </b></font>auto_val<font color="#000080">[</font>i<font color="#000080">] := </font>by<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ------------- Die Interrupt-Routine selbst ------------- }

</i></font><font color="#FF0000"><b>Procedure </b></font>errorcon<font color="#000080">; </font>Interrupt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>copro <font color="#000080">: </font><font color="#FF0000"><b>Record
    </b></font>control_Word<font color="#000080">,
    </font>status_Word<font color="#000080">,
    </font>tag_Word<font color="#000080">, </font>op<font color="#000080">,
    </font>instruction_Pointer<font color="#000080">,
    </font>ip<font color="#000080">, </font>operand_Pointer<font color="#000080">, : </font>Word<font color="#000080">;
    </font>st                   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Extended<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>top <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ welches Register ist Stacktop? }

  </i></font>masked<font color="#000080">,            </font><font color="#008000"><i>{ welche Exceptions maskiert? }
  </i></font>occured <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ welche Exceptions aufgetreten? }

  </i></font>opcode  <font color="#000080">: </font>Word<font color="#000080">;

  </font>inst_seg<font color="#000080">,       </font><font color="#008000"><i>{ Instruction-Pointer, Segment }
  </i></font>inst_off<font color="#000080">,       </font><font color="#008000"><i>{ &quot;                  , Offset  }
  </i></font>oper_seg<font color="#000080">,       </font><font color="#008000"><i>{ Operand-Pointer    , Segment }
  </i></font>oper_off<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ &quot;                  , Offset  }

  </i></font>inst_point <font color="#000080">: ^</font>Word<font color="#000080">;                 </font><font color="#008000"><i>{ zum Adressieren des Opcodes }

  </i></font>oper_point <font color="#000080">: </font><font color="#FF0000"><b>Record
    Case </b></font>Integer <font color="#FF0000"><b>of </b></font><font color="#008000"><i>{ zum Adressieren des Operanden }
      </i></font><font color="#800000">1 </font><font color="#000080">: (</font>ex <font color="#000080">: ^</font>Extended<font color="#000080">);
      </font><font color="#800000">2 </font><font color="#000080">: (</font>db <font color="#000080">: ^</font>Double<font color="#000080">);
      </font><font color="#800000">3 </font><font color="#000080">: (</font>si <font color="#000080">: ^</font>Single<font color="#000080">);
      </font><font color="#800000">4 </font><font color="#000080">: (</font>co <font color="#000080">: ^</font>Comp<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>marker<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">; </font><font color="#008000"><i>{ Register-Marker nach Tag-Word }

  </i></font>opt_dump<font color="#000080">,               </font><font color="#008000"><i>{ soll ausgeben werden? }
  </i></font>opt_exit<font color="#000080">,               </font><font color="#008000"><i>{ soll aufgehoert werden? }
  </i></font>opt_ask<font color="#000080">,                </font><font color="#008000"><i>{ soll Ergebnis abgefragt werden? }
  </i></font>opt_auto  <font color="#000080">: </font>Boolean<font color="#000080">;    </font><font color="#008000"><i>{ soll Ergebnis automatisch korrigiert werden? }

  </i></font>i         <font color="#000080">: </font>Integer<font color="#000080">;

  </font>mem_access<font color="#000080">: </font>Boolean<font color="#000080">;    </font><font color="#008000"><i>{ gibt es Speicherzugriff? }

  </i></font>op_name   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;     </font><font color="#008000"><i>{ Mnemonik des Befehls }

{ Ersetze Stacktop durch abgefragten Wert }
</i></font><font color="#FF0000"><b>Procedure </b></font>ask_correct<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>res  <font color="#000080">: </font>Extended<font color="#000080">;
  </font>ch   <font color="#000080">: </font>Char<font color="#000080">;
  </font>t    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>code <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   Asm
     </b></font><font color="#FF00FF">fstp res
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>WriteLN<font color="#000080">;
   </font>Write<font color="#000080">(</font><font color="#800000">'The result would be '</font><font color="#000080">, </font>res<font color="#000080">, </font><font color="#800000">'. Change? (y/n) ' </font><font color="#000080">);
   </font><font color="#FF0000"><b>Repeat
     Repeat Until </b></font>KeyPressed<font color="#000080">;
     </font>ch <font color="#000080">:= </font>ReadKey<font color="#000080">;;
   </font><font color="#FF0000"><b>Until </b></font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'y'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">,</font><font color="#800000">'n'</font><font color="#000080">];
   </font>Writeln<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'y'</font><font color="#000080">] </font><font color="#FF0000"><b>then
   Repeat
     </b></font>Write<font color="#000080">(</font><font color="#800000">'New value : '</font><font color="#000080">);
     </font>READLN<font color="#000080">(</font>t<font color="#000080">);
     </font>VAL<font color="#000080">(</font>t<font color="#000080">, </font>res<font color="#000080">, </font>code<font color="#000080">);
   </font><font color="#FF0000"><b>Until </b></font>code <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>Asm
     </b></font><font color="#FF00FF">fld res
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>hex<font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{ Ausgabe als HeX-Zahl }
</i></font><font color="#FF0000"><b>Const
  </b></font>zif <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= (</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,</font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,</font><font color="#800000">'7'</font><font color="#000080">,</font><font color="#800000">'8'</font><font color="#000080">,</font><font color="#800000">'9'</font><font color="#000080">,
                                    </font><font color="#800000">'a'</font><font color="#000080">,</font><font color="#800000">'b'</font><font color="#000080">,</font><font color="#800000">'c'</font><font color="#000080">,</font><font color="#800000">'d'</font><font color="#000080">,</font><font color="#800000">'e'</font><font color="#000080">,</font><font color="#800000">'f'</font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>hex <font color="#000080">:= </font>zif<font color="#000080">[</font>w <font color="#FF0000"><b>div </b></font>zweipot<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]] +
         </font>zif<font color="#000080">[(</font>w <font color="#FF0000"><b>MOD </b></font>zweipot<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>zweipot<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]] +
         </font>zif<font color="#000080">[(</font>w <font color="#FF0000"><b>MOD </b></font>zweipot<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font>zweipot<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]] +
         </font>zif<font color="#000080">[</font>w <font color="#FF0000"><b>MOD </b></font>zweipot<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>choice<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>ch <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WriteLN<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'C)ontinue, A)bort '</font><font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    Repeat Until </b></font>KeyPressed<font color="#000080">;
    </font>ch<font color="#000080">:=</font>ReadKey<font color="#000080">;;
    </font><font color="#FF0000"><b>if </b></font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      </b></font>Halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'c'</font><font color="#000080">];
  </font>WriteLN<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>showcopro<font color="#000080">; </font><font color="#008000"><i>{ Ausgeben des FSAVE - Records }
</i></font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TextMode<font color="#000080">(</font>LastMode<font color="#000080">);
  </font>HighVideo<font color="#000080">;
  </font>WriteLN<font color="#000080">(</font><font color="#800000">'Floating point exception, last opcode: '</font><font color="#000080">,</font>hex<font color="#000080">(</font>opcode<font color="#000080">),
                                               </font><font color="#800000">' ('</font><font color="#000080">,</font>op_name<font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">);
  </font>NormVideo<font color="#000080">;
  </font>WriteLN<font color="#000080">(</font><font color="#800000">'Instruction Pointer : '</font><font color="#000080">,</font>hex<font color="#000080">(</font>inst_seg<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>hex<font color="#000080">(</font>inst_off<font color="#000080">),
          </font><font color="#800000">' ('</font><font color="#000080">,</font>hex<font color="#000080">(</font>inst_point<font color="#000080">^),</font><font color="#800000">')'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>mem_access <font color="#FF0000"><b>then
  begin
    </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'Operand Pointer     : '</font><font color="#000080">,</font>hex<font color="#000080">(</font>oper_seg<font color="#000080">),</font><font color="#800000">':'</font><font color="#000080">,</font>hex<font color="#000080">(</font>oper_off<font color="#000080">));
    </font>WriteLN<font color="#000080">(</font><font color="#800000">'( Extended: '</font><font color="#000080">,</font>oper_point<font color="#000080">.</font>ex<font color="#000080">^,</font><font color="#800000">', Double: '</font><font color="#000080">,</font>oper_point<font color="#000080">.</font>db<font color="#000080">^);
    </font>WriteLN<font color="#000080">(</font><font color="#800000">'  Single  : '</font><font color="#000080">,</font>oper_point<font color="#000080">.</font>si<font color="#000080">^,</font><font color="#800000">', Comp  : '</font><font color="#000080">,</font>oper_point<font color="#000080">.</font>co<font color="#000080">^,</font><font color="#800000">' )'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>WriteLN<font color="#000080">;
    </font>WriteLN <font color="#000080">(</font><font color="#800000">'No memory access'</font><font color="#000080">);
    </font>WriteLN<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>HighVideo<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>occured <font color="#FF0000"><b>and </b></font>stackfault<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'Exception '</font><font color="#000080">,</font><font color="#800000">'Masked'</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">'Occured'</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">'Should be masked'</font><font color="#000080">:</font><font color="#800000">18</font><font color="#000080">);
    </font>NormVideo<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
      </b></font>WriteLN<font color="#000080">(</font>ex_nam<font color="#000080">[</font>i<font color="#000080">], (</font>masked   <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">8</font><font color="#000080">,
                         (</font>occured  <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">8</font><font color="#000080">,
                         (</font>setmasks <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">18</font><font color="#000080">);
    </font>HighVideo<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'Invalid Operation:'</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>con1<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'                       -- Stack Overflow --'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>WriteLN<font color="#000080">(</font><font color="#800000">'                       -- Stack Underflow --'</font><font color="#000080">);
    </font>WriteLN<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WriteLN<font color="#000080">(</font><font color="#800000">'Reg  '</font><font color="#000080">,</font><font color="#800000">'Value'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">,</font><font color="#800000">'Marked'</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
  </font>Normvideo<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
  begin
    </b></font>Write<font color="#000080">(</font><font color="#800000">'st('</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">, </font>copro<font color="#000080">.</font>st<font color="#000080">[</font>i<font color="#000080">] : </font><font color="#800000">29</font><font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>marker<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>OF
       </b></font>valid <font color="#000080">: </font>WriteLN<font color="#000080">(</font><font color="#800000">'Valid'   </font><font color="#000080">: </font><font color="#800000">10</font><font color="#000080">);
       </font>spec  <font color="#000080">: </font>WriteLN<font color="#000080">(</font><font color="#800000">'Special' </font><font color="#000080">: </font><font color="#800000">10</font><font color="#000080">);
       </font>empty <font color="#000080">: </font>WriteLN<font color="#000080">(</font><font color="#800000">'Empty'   </font><font color="#000080">: </font><font color="#800000">10</font><font color="#000080">);
       </font>zero  <font color="#000080">: </font>WriteLN<font color="#000080">(</font><font color="#800000">'Zero'    </font><font color="#000080">: </font><font color="#800000">10</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Ersetze Stacktop durch Auto-Korrekt-Wert }

</i></font><font color="#FF0000"><b>Procedure </b></font>auto_corr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>res <font color="#000080">: </font>Extended<font color="#000080">;
  </font>i   <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">fstp res
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    if </b></font><font color="#000080">((</font>occured <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">((</font>auto_on <font color="#FF0000"><b>and </b></font>zweipot<font color="#000080">[</font>i<font color="#000080">]) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>res <font color="#000080">:= </font>auto_val<font color="#000080">[</font>i<font color="#000080">];
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">fld res
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>do_it_again<font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>codearr <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>sam <font color="#000080">: </font><font color="#FF0000"><b>Record
    Case </b></font>Boolean <font color="#FF0000"><b>OF
      </b></font>True <font color="#000080">: (</font>b<font color="#000080">: ^</font>codearr <font color="#000080">);
      </font>False<font color="#000080">: (</font>p<font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>op_point <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>x        <font color="#000080">: </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>sam<font color="#000080">.</font>b<font color="#000080">);
  </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]:=</font>Hi<font color="#000080">(</font>opcode<font color="#000080">);
  </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">]:=</font>Lo<font color="#000080">(</font>opcode<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>mem_access <font color="#FF0000"><b>then
  begin
  </b></font><font color="#008000"><i>{ --- mod r/m auf ds:[di] stellen (00ttt101) --- }
    </i></font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] := </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>zweipot<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
    </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] := </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>zweipot<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">$ca</font><font color="#000080">; </font><font color="#008000"><i>{ retf 0000 }
  </i></font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;
  </font>sam<font color="#000080">.</font>b<font color="#000080">^[</font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;
  </font>op_point  <font color="#000080">:= </font>oper_point<font color="#000080">.</font>ex<font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">push ds
    lds di, op_point
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>sam<font color="#000080">.</font>p<font color="#000080">;

  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">pop ds
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Dispose<font color="#000080">(</font>sam<font color="#000080">.</font>b<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">push   ax
    xor    al,al
    out    0f0h,al
    mov    al,020h
    out    0a0h,al
    out    020h,al
    pop    ax
    fsave  copro
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ === Pruefen, ob Bearbeitung durch ERRORCON erwuenscht === }
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>standard<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    Asm
      </b></font><font color="#FF00FF">frstor copro
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>normal<font color="#000080">.</font>pro<font color="#000080">; </font><font color="#008000"><i>{ Bye, bye ... }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ === Auswerten des FSAVE-Records ========================= }
  { --- Opcode wie im Copro gespeichert     --- }
  </i></font>opcode <font color="#000080">:= </font>zweipot<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">] +
            (</font>copro<font color="#000080">.</font>ip <font color="#FF0000"><b>MOD </b></font>zweipot<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">]);
  </font>op_name <font color="#000080">:= </font>dis<font color="#000080">(</font>opcode<font color="#000080">);
  </font>mem_access <font color="#000080">:= </font>op_name<font color="#000080">=</font><font color="#800000">'...'</font><font color="#000080">;
  </font><font color="#008000"><i>{ --- Was war maskiert, was ist passiert? --- }
  </i></font>masked  <font color="#000080">:= </font>Lo<font color="#000080">(</font>copro<font color="#000080">.</font>control_Word<font color="#000080">);
  </font>occured <font color="#000080">:= </font>Lo<font color="#000080">(</font>copro<font color="#000080">.</font>status_Word <font color="#000080">);
  </font><font color="#008000"><i>{ --- Der Instruction-Pointer             --- }
  </i></font>inst_seg <font color="#000080">:= </font>copro<font color="#000080">.</font>ip <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>zweipot<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">] +
                           </font>zweipot<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]);
  </font>inst_off <font color="#000080">:= </font>copro<font color="#000080">.</font>instruction_Pointer<font color="#000080">;
  </font>inst_point <font color="#000080">:= </font>Ptr<font color="#000080">(</font>inst_seg<font color="#000080">,</font>inst_off<font color="#000080">);
  </font><font color="#008000"><i>{ --- Der Operand-Pointer                 --- }
  </i></font>oper_seg <font color="#000080">:= </font>copro<font color="#000080">.</font>op <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>zweipot<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">] + </font>zweipot<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">] +
                            </font>zweipot<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]);
  </font>oper_off <font color="#000080">:= </font>copro<font color="#000080">.</font>operand_Pointer<font color="#000080">;
  </font>oper_point<font color="#000080">.</font>ex <font color="#000080">:= </font>Ptr<font color="#000080">(</font>oper_seg<font color="#000080">,</font>oper_off<font color="#000080">);
  </font><font color="#008000"><i>{ --- Wer ist gerade Stacktop? --- }
  </i></font>top <font color="#000080">:= (</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>topmask<font color="#000080">) </font><font color="#FF0000"><b>div </b></font>topdiv<font color="#000080">;
  </font><font color="#008000"><i>{ --- Einlesen der Marker aus Tag-Word --- }
  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
  begin
    </b></font>marker<font color="#000080">[(</font><font color="#800000">8 </font><font color="#000080">+ </font>i <font color="#000080">- </font>top<font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">8</font><font color="#000080">] := (</font>copro<font color="#000080">.</font>tag_Word <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>zweipot<font color="#000080">[</font>i <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">] +
                                    </font>zweipot<font color="#000080">[</font>i <font color="#000080">* </font><font color="#800000">2 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">])) </font><font color="#FF0000"><b>div </b></font>zweipot<font color="#000080">[</font>i <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ --- Welche Aktionen sollen ausgefuehrt werden? --- }
  </i></font>opt_dump <font color="#000080">:= (</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>dump_on<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>opt_exit <font color="#000080">:= (</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>Exit_on<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>opt_ask  <font color="#000080">:= (</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>ask_on <font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>opt_auto <font color="#000080">:= (</font>copro<font color="#000080">.</font>status_Word <font color="#FF0000"><b>and </b></font>auto_on<font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#008000"><i>{ === Aktionen ============================================ }
  </i></font><font color="#FF0000"><b>if </b></font>opt_dump <font color="#FF0000"><b>then
    </b></font>showcopro<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>opt_exit <font color="#FF0000"><b>then
  begin
    </b></font>WriteLN<font color="#000080">;
    </font>WriteLN<font color="#000080">(</font><font color="#800000">'Exit Program due to Programmers request'</font><font color="#000080">);
    </font>HALT<font color="#000080">; </font><font color="#008000"><i>{ Bye, bye ... }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>opt_dump <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>opt_ask<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>choice<font color="#000080">;

  </font>copro<font color="#000080">.</font>control_Word <font color="#000080">:= </font>copro<font color="#000080">.</font>control_Word <font color="#FF0000"><b>or </b></font>anyerrors<font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">frstor copro
    fclex
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ --- Befehl nochmals ausfuehren --- }
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>occured <font color="#FF0000"><b>and </b></font>do_again<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>do_it_again<font color="#000080">;
  </font><font color="#008000"><i>{ --- Noch was? --- }
  </i></font><font color="#FF0000"><b>if </b></font>opt_auto <font color="#FF0000"><b>then
    </b></font>auto_corr<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>opt_ask  <font color="#FF0000"><b>then
    </b></font>ask_correct<font color="#000080">;
  </font>restore_masks<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ------------- Ein- und Ausschalten ------------- }

</i></font><font color="#FF0000"><b>Procedure </b></font>handle_on<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Getintvec<font color="#000080">(</font><font color="#800000">$75</font><font color="#000080">, </font>normal<font color="#000080">.</font>adr<font color="#000080">);
  </font>Setintvec<font color="#000080">(</font><font color="#800000">$75</font><font color="#000080">, @</font>errorcon<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>handle_off<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Setintvec<font color="#000080">(</font><font color="#800000">$75</font><font color="#000080">, </font>normal<font color="#000080">.</font>adr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>handle_on<font color="#000080">;
  </font>dump_on <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Exit_on <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>ask_on  <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>auto_on <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>standard<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>do_again<font color="#000080">:=</font>invalid<font color="#000080">+</font>zero_div<font color="#000080">+</font>denormal<font color="#000080">;
  </font>clear_copro<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.






</font><font color="#FF0000"><b>Unit </b></font>dis387<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Function </b></font>dis<font color="#000080">(</font>opco <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Function </b></font>dis<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>d<font color="#000080">, </font>op <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>opcr<font color="#000080">(</font>st <font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>t <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>str<font color="#000080">(</font>st<font color="#000080">, </font>t<font color="#000080">);
    </font>op <font color="#000080">:= </font><font color="#800000">' st,st(' </font><font color="#000080">+ </font>t <font color="#000080">+ </font><font color="#800000">')'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>opc<font color="#000080">(</font>st <font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>t <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>str<font color="#000080">(</font>st<font color="#000080">, </font>t<font color="#000080">);
    </font>op <font color="#000080">:= </font><font color="#800000">' st(' </font><font color="#000080">+ </font>t <font color="#000080">+ </font><font color="#800000">'),st'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>op1<font color="#000080">(</font>st <font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>t <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>str<font color="#000080">(</font>st<font color="#000080">, </font>t<font color="#000080">);
    </font>op <font color="#000080">:= </font><font color="#800000">' st(' </font><font color="#000080">+ </font>t <font color="#000080">+ </font><font color="#800000">')'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>d  <font color="#000080">:= </font><font color="#800000">'...'</font><font color="#000080">;
  </font>op <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font><font color="#FF0000"><b>Case </b></font>Hi<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>OF
    </b></font><font color="#800000">$d8 </font><font color="#000080">:
      </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">16 </font><font color="#FF0000"><b>OF
        </b></font><font color="#800000">$c </font><font color="#000080">:
          </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fmul'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
          </font><font color="#FF0000"><b>end
          else
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fadd'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#800000">$e </font><font color="#000080">:
          </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fsubr'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
          </font><font color="#FF0000"><b>end
          else
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fsub'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#800000">$f </font><font color="#000080">:
          </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fdivr'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
          </font><font color="#FF0000"><b>end
          else
          begin
            </b></font>d <font color="#000080">:= </font><font color="#800000">'fdiv'</font><font color="#000080">;
            </font>opcr<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#800000">$d9 </font><font color="#000080">:
     </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">$d0 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fnop'</font><font color="#000080">;
       </font><font color="#800000">$e0 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fchs'</font><font color="#000080">;
       </font><font color="#800000">$e1 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fabs'</font><font color="#000080">;
       </font><font color="#800000">$e4 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'ftst'</font><font color="#000080">;
       </font><font color="#800000">$e5 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fxam'</font><font color="#000080">;
       </font><font color="#800000">$e8 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fld1'</font><font color="#000080">;
       </font><font color="#800000">$e9 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fld2t'</font><font color="#000080">;
       </font><font color="#800000">$ea </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fld2e'</font><font color="#000080">;
       </font><font color="#800000">$eb </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fldpi'</font><font color="#000080">;
       </font><font color="#800000">$ec </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fldlg2'</font><font color="#000080">;
       </font><font color="#800000">$ed </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fldln2'</font><font color="#000080">;
       </font><font color="#800000">$ee </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fldz'</font><font color="#000080">;
       </font><font color="#800000">$f0 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'f2xm1'</font><font color="#000080">;
       </font><font color="#800000">$f1 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fyl2x'</font><font color="#000080">;
       </font><font color="#800000">$f2 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fptan'</font><font color="#000080">;
       </font><font color="#800000">$f3 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fpatan'</font><font color="#000080">;
       </font><font color="#800000">$f4 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fxtract'</font><font color="#000080">;
       </font><font color="#800000">$f5 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fprem1'</font><font color="#000080">;
       </font><font color="#800000">$f6 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fdecstp'</font><font color="#000080">;
       </font><font color="#800000">$f7 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fincstp'</font><font color="#000080">;
       </font><font color="#800000">$f8 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fprem'</font><font color="#000080">;
       </font><font color="#800000">$f9 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fyl2xp1'</font><font color="#000080">;
       </font><font color="#800000">$fa </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fsqrt'</font><font color="#000080">;
       </font><font color="#800000">$fb </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fsincos'</font><font color="#000080">;
       </font><font color="#800000">$fc </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'frndint'</font><font color="#000080">;
       </font><font color="#800000">$fd </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fscale'</font><font color="#000080">;
       </font><font color="#800000">$fe </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fsin'</font><font color="#000080">;
       </font><font color="#800000">$ff </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fcos'</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#800000">$db </font><font color="#000080">:
     </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">$e2 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fclex'</font><font color="#000080">;
       </font><font color="#800000">$e3 </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'finit'</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#800000">$dc </font><font color="#000080">:
     </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">16 </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">$c </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fmul'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fadd'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#800000">$e </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fsub'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fsubr'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#800000">$f </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fdiv'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fdivr'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#800000">$dd </font><font color="#000080">:
     </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">16 </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">$c </font><font color="#000080">:
         </font><font color="#FF0000"><b>begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'ffree'</font><font color="#000080">;
           </font>op1<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#800000">$d </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fstp'</font><font color="#000080">;
           </font>op1<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fst'</font><font color="#000080">;
           </font>op1<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#800000">$e </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fucomp'</font><font color="#000080">;
           </font>op1<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fucom'</font><font color="#000080">;
           </font>op1<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#800000">$de </font><font color="#000080">:
     </font><font color="#FF0000"><b>Case </b></font>Lo<font color="#000080">(</font>opco<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">16 </font><font color="#FF0000"><b>OF
       </b></font><font color="#800000">$c </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fmulp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'faddp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#800000">$d </font><font color="#000080">: </font>d <font color="#000080">:= </font><font color="#800000">'fcompp'</font><font color="#000080">;

       </font><font color="#800000">$e </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fsubp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fsubrp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#800000">$f </font><font color="#000080">:
         </font><font color="#FF0000"><b>if </b></font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">&gt;= </font><font color="#800000">8 </font><font color="#FF0000"><b>then
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fdivp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">8</font><font color="#000080">);
         </font><font color="#FF0000"><b>end
         else
         begin
           </b></font>d <font color="#000080">:= </font><font color="#800000">'fdivrp'</font><font color="#000080">;
           </font>opc<font color="#000080">(</font>opco <font color="#FF0000"><b>MOD </b></font><font color="#800000">16</font><font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>dis <font color="#000080">:= </font>d <font color="#000080">+ </font>op<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
