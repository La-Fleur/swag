<html>
<head><title> "Credit Card check" by CAMERON CLARK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">  <font color="#008000"><i>{$F+,D+,L+}

</i></font><font color="#FF0000"><b>unit </b></font>Vericard<font color="#000080">;

</font><font color="#FF0000"><b>interface

  function </b></font>Vc<font color="#000080">(</font>c <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>char<font color="#000080">;

</font><font color="#FF0000"><b>implementation

  function </b></font>Vc<font color="#000080">(</font>c <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>char<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>card <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">21</font><font color="#000080">];
    </font>Vcard <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#FF0000"><b>absolute </b></font>card<font color="#000080">;
    </font>Xcard <font color="#000080">: </font>integer<font color="#000080">;
    </font>Cstr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">21</font><font color="#000080">];
    </font>y<font color="#000080">, </font>x <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Cstr <font color="#000080">:= </font><font color="#800000">'                '</font><font color="#000080">;
    </font>Cstr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>fillchar<font color="#000080">(</font>Vcard<font color="#000080">, </font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);
    </font>card <font color="#000080">:= </font>c<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">20 </font><font color="#FF0000"><b>do
      if </b></font><font color="#000080">(</font>Vcard<font color="#000080">[</font>x<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">48</font><font color="#000080">..</font><font color="#800000">57</font><font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>Cstr <font color="#000080">:= </font>Cstr <font color="#000080">+ </font>chr<font color="#000080">(</font>Vcard<font color="#000080">[</font>x<font color="#000080">]);
    </font>card <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>card <font color="#000080">:= </font>Cstr<font color="#000080">;
    </font>Xcard <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if NOT </b></font>odd<font color="#000080">(</font>length<font color="#000080">(</font>card<font color="#000080">)) </font><font color="#FF0000"><b>then
      for </b></font>x <font color="#000080">:= (</font>length<font color="#000080">(</font>card<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
          if </b></font>odd<font color="#000080">(</font>x<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>y <font color="#000080">:= ((</font>Vcard<font color="#000080">[</font>x<font color="#000080">] - </font><font color="#800000">48</font><font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">)
          </font><font color="#FF0000"><b>else
            </b></font>y <font color="#000080">:= (</font>Vcard<font color="#000080">[</font>x<font color="#000080">] - </font><font color="#800000">48</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y <font color="#000080">&gt;= </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>y <font color="#000080">:= ((</font>y <font color="#000080">- </font><font color="#800000">10</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
          </font>Xcard <font color="#000080">:= (</font>Xcard <font color="#000080">+ </font>y<font color="#000080">)
        </font><font color="#FF0000"><b>end
    else
      for </b></font>x <font color="#000080">:= (</font>length<font color="#000080">(</font>card<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
          if </b></font>odd<font color="#000080">(</font>x<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>y <font color="#000080">:= (</font>Vcard<font color="#000080">[</font>x<font color="#000080">] - </font><font color="#800000">48</font><font color="#000080">)
          </font><font color="#FF0000"><b>else
            </b></font>y <font color="#000080">:= ((</font>Vcard<font color="#000080">[</font>x<font color="#000080">] - </font><font color="#800000">48</font><font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>y <font color="#000080">&gt;= </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>y <font color="#000080">:= ((</font>y <font color="#000080">- </font><font color="#800000">10</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
          </font>Xcard <font color="#000080">:= (</font>Xcard <font color="#000080">+ </font>y<font color="#000080">)
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>x <font color="#000080">:= (</font><font color="#800000">10 </font><font color="#000080">- (</font>Xcard <font color="#FF0000"><b>mod </b></font><font color="#800000">10</font><font color="#000080">));
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x <font color="#000080">= (</font>Vcard<font color="#000080">[</font>length<font color="#000080">(</font>card<font color="#000080">)] - </font><font color="#800000">48</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Vc <font color="#000080">:= </font>Cstr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]
    </font><font color="#FF0000"><b>else
      </b></font>Vc <font color="#000080">:= </font><font color="#800000">#0
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ .....................DRIVER EXAMple........  }

{$A-,B+,D-,E-,F-,I+,L-,N-,O-,R+,S+,V+}
{$M 2048,0,4096}

</i></font><font color="#FF0000"><b>program </b></font>ValiCard<font color="#000080">;

  </font><font color="#008000"><i>{ Test routine for the Mod 10 Check Digit CC validator... }

</i></font><font color="#FF0000"><b>uses
  </b></font>dos<font color="#000080">,
  </font>crt<font color="#000080">,
  </font>VeriCard<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>card <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">22</font><font color="#000080">];
  </font>k <font color="#000080">: </font>char<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>Squawk<font color="#000080">(</font>Noise <font color="#000080">: </font>byte<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    case </b></font>Noise <font color="#FF0000"><b>of
      </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>begin
            </b></font>Sound<font color="#000080">(</font><font color="#800000">400</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
            </font>Nosound
          <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>begin
            </b></font>Sound<font color="#000080">(</font><font color="#800000">392</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">);
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">523</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">);
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">659</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">);
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">784</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">277</font><font color="#000080">);
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">659</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">);
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
            </font>Sound<font color="#000080">(</font><font color="#800000">784</font><font color="#000080">);
            </font>Delay<font color="#000080">(</font><font color="#800000">1200</font><font color="#000080">);
            </font>Nosound
          <font color="#FF0000"><b>end
    end                                </b></font><font color="#008000"><i>{ case }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>k <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
  </font>clrscr<font color="#000080">;
  </font>fillchar<font color="#000080">(</font>card<font color="#000080">, </font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'VC: Integer Modulo-10 Visa/Mastercard/Amex Check-Digit'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'    verification routine. (c) 1990 Daniel J. Karnes'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>write<font color="#000080">(</font><font color="#800000">'    Please enter a Credit Card number: '</font><font color="#000080">);
  </font>readln<font color="#000080">(</font>card<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>card<font color="#000080">) &gt; </font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>k <font color="#000080">:= </font>Vc<font color="#000080">(</font>card<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>k <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'3'</font><font color="#000080">, </font><font color="#800000">'4'</font><font color="#000080">, </font><font color="#800000">'5'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
    </b></font>Squawk<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>Squawk<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>k <font color="#FF0000"><b>of
    </b></font><font color="#800000">#0 </font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'    Could NOT verify this number with any card type.'</font><font color="#000080">)
    </font><font color="#800000">'3' </font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'    Card was verified as a valid Amex Card Number.'</font><font color="#000080">);
    </font><font color="#800000">'4' </font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'    Card was verified as a valid VISA Card Number.'</font><font color="#000080">);
    </font><font color="#800000">'5' </font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'    Card was verified as a valid Mastercard Number.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>end
END</b></font><font color="#000080">.

...................
</font>Hope that helps<font color="#000080">. </font>I<font color="#800000">'ve only tried it on one card number BUT it did work
</font><font color="#FF0000"><b>for </b></font>the one <font color="#FF0000"><b>and </b></font>the info was received from someone <font color="#FF0000"><b>in </b></font>the business<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0092.PAS">Original</a><b>]</b></p></body>
</html>
