<html>
<head><title> "Card Game of Spite & Malice" by BENJAMIN ARNOLDY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0194.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{_____________________________________________________________________________
|  Filename: CODE.PAS
|     Title: Spite &amp; Malice
|  Written By: Benjamin Arnoldy and Raechel Kula
|_____________________________________________________________________________
|  Contents:
|    The procedures: Deal, WhoseTurn, PickupCards, Decision, GetMove,
|                    CheckMove, MoveCard
|    Oject: Pile
|_____________________________________________________________________________
|  Synopsis:
|    This program allows the user to select either another person, or the
     computer as the opponent, then play the opponent in the card game
|    Spite &amp; Malice.  The interface is textual.
|_____________________________________________________________________________
|  Description:
|    No references at this time.
|_____________________________________________________________________________
|  Environment:
|    TurboPASCAL for the PC.
|_____________________________________________________________________________
|  Version History:
|
|  Version 5.1 -- May 8, 1996
|              Raechel Kula &amp; Benjamin Arnoldy
|              Improved interface and Decision.
|
|  Version 5.0 -- May 7, 1996
|              Raechel Kula &amp; Benjamin Arnoldy
|              Code is cleaned up and ready for presentation.
|
|  Version 4.3 -- May 6, 1996
|               Raechel Kula &amp; Benjamin Arnoldy
|               Additional testing, more tinkering with weights.
|
|  Version 4.2 -- May 5, 1996
|               Raechel Kula &amp; Benjamin Arnoldy
|               Added provisions in decision for jokers.
|
|  Version 4.1 -- May 4, 1996
|                Raechel Kula &amp; Benjamin Arnoldy
|                Testing and tinkering with weights to make
|                the computer a better opponent.
|
|  Version 4.0 -- May 3, 1996
|                Raechel Kula &amp; Benjamin Arnoldy
|                An &quot;operable&quot; Decision procedure is
|                in place.
|
|  Version 3.1 -- May 2, 1996
|                Raechel Kula &amp; Benjamin Arnoldy
|                Various Embellishments to make it an operable
|                2 player game (e.g. end of game stuff).
|
|  Version 3.0 -- May 1, 1996
|                 Raechel Kula &amp; Benjamin Arnoldy
|                 Ascii Graphical Interface is instituted.
|
|  Version 2.9 -- April 30, 1996
|                 Raechel Kula &amp; Benjamin Arnoldy
|                 Small display functions (CardString) coded.
|
|  Version 2.2 -- April 28, 1996
|                  Raechel Kula &amp; Benjamin Arnoldy
|                  CheckMove procedure ironed out.
|
|   Version 2.1 -- April 26, 1996
|                  Raechel Kula &amp; Benjamin Arnoldy
|                  Basic Main Program Procedures Modified to fit with new
|                  object structure.
|
|   Version 2.0 -- April 25, 1996
|                  Raechel Kula &amp; Benjamin Arnoldy
|                   Object Pile Coded.
|
|    MidApril -- Meeting with Prof Squier &amp; Subsequent Major Rethinking
|
|    Version 1.1 -- Apr. 7, 1996
|                   Raechel Kula &amp; Benjamin Arnoldy
|                     Pieces of Decision and CheckMove procedures are
|                     completed.
|
|    Version 1.0 -- Mar. 29, 1996
|                   Raechel Kula &amp; Benjamin Arnoldy
|                     WhoseTurn, PickupCards, MoveCard procedures are coded.
|                     The code successfully compiles.
|
|    Version 0.2 -- Mar. 12, 1996
|                   Raechel Kula &amp; Benjamin Arnoldy
|                     Deal and GetMove procedures are coded.
|
|    Version 0.2 -- Mar. 5, 1996
|                   Raechel Kula &amp; Benjamin Arnoldy
|                     GetValue and GetPlace procedures are coded.
|
|    Version 0.1 -- Feb. 30, 1996
|                   Raechel Kula &amp; Benjamin Arnoldy
|                     Main Program and Stubs
|    Version 0.0
|____________________________________________________________________________}

</i></font><font color="#FF0000"><b>program </b></font>SpiteMalice<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>CRT<font color="#000080">;

</font><font color="#008000"><i>{=============================================================================
                                   CONSTANTS
=============================================================================}

</i></font><font color="#FF0000"><b>const </b></font>DRAWPILE_MAX <font color="#000080">= </font><font color="#800000">108</font><font color="#000080">;
      </font>HAND_MAX <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
      </font>SCOREPILE_MAX <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
      </font>DISCARDPILE_MAX <font color="#000080">= </font><font color="#800000">108</font><font color="#000080">;
      </font>ACEPILE_MAX <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
      </font>TRASHPILE_MAX <font color="#000080">= </font><font color="#800000">108</font><font color="#000080">;
      </font>MAXSIZE <font color="#000080">= </font><font color="#800000">108</font><font color="#000080">;
      </font>NULL <font color="#000080">= -</font><font color="#800000">1</font><font color="#000080">;

</font><font color="#008000"><i>{=============================================================================
                                     TYPES
=============================================================================}

</i></font><font color="#FF0000"><b>type </b></font>CardVal_t <font color="#000080">= </font>integer<font color="#000080">;
     </font>Pos_t <font color="#000080">= </font>integer<font color="#000080">;
     </font>CardArray_t <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">108</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CardVal_t<font color="#000080">;
     </font>CardValTable_t <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>CardVal_t<font color="#000080">;
     </font>choiceTable_t <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;

</font><font color="#008000"><i>{=============================================================================
                              OBJECT DECLARATION
=============================================================================}

</i></font><font color="#FF0000"><b>type </b></font>Pile <font color="#000080">= </font><font color="#FF0000"><b>object
   </b></font><font color="#008000"><i>{public}
   </i></font><font color="#FF0000"><b>procedure </b></font>Init<font color="#000080">;
   </font><font color="#FF0000"><b>procedure </b></font>RandomShuffle<font color="#000080">;
   </font><font color="#FF0000"><b>procedure </b></font>PutOnTop <font color="#000080">(</font>CardtoPutOn<font color="#000080">: </font>CardVal_t<font color="#000080">);
   </font><font color="#FF0000"><b>function </b></font>RemoveFromTop<font color="#000080">: </font>CardVal_t<font color="#000080">;
   </font><font color="#FF0000"><b>function </b></font>SeeRandom <font color="#000080">(</font>Pos<font color="#000080">: </font>Pos_t<font color="#000080">): </font>CardVal_t<font color="#000080">;
   </font><font color="#FF0000"><b>function </b></font>DeleteByValue <font color="#000080">(</font>value <font color="#000080">: </font>CardVal_t<font color="#000080">): </font>CardVal_t<font color="#000080">;
   </font><font color="#FF0000"><b>function </b></font>IsPresent <font color="#000080">(</font>CardtoFind<font color="#000080">: </font>CardVal_t<font color="#000080">): </font>boolean<font color="#000080">;
   </font><font color="#FF0000"><b>function </b></font>NumCards<font color="#000080">: </font>integer<font color="#000080">;

   </font><font color="#FF0000"><b>private

   </b></font>data<font color="#000080">: </font>CardArray_t<font color="#000080">;
   </font>top<font color="#000080">: </font>Pos_t<font color="#000080">;  </font><font color="#008000"><i>{top = slot with top card in it.}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Object declaration}

{=============================================================================
                         OBJECT DEPENEDENT TYPES
=============================================================================}

</i></font><font color="#FF0000"><b>Type </b></font>pilepointer_t <font color="#000080">= ^</font>Pile<font color="#000080">;
     </font>stack_t <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pilepointer_t<font color="#000080">;

</font><font color="#008000"><i>{=============================================================================
                                GLOBAL VARIABLES
=============================================================================}

</i></font><font color="#FF0000"><b>var </b></font>DrawPile<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerHand<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerHand<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerScorePile<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerScorePile<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerDiscardPile1<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerDiscardPile2<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerDiscardPile3<font color="#000080">: </font>Pile<font color="#000080">;
    </font>PlayerDiscardPile4<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerDiscardPile1<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerDiscardPile2<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerDiscardPile3<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerDiscardPile4<font color="#000080">: </font>Pile<font color="#000080">;
    </font>AcePile1<font color="#000080">: </font>Pile<font color="#000080">;
    </font>AcePile2<font color="#000080">: </font>Pile<font color="#000080">;
    </font>AcePile3<font color="#000080">: </font>Pile<font color="#000080">;
    </font>AcePile4<font color="#000080">: </font>Pile<font color="#000080">;
    </font>TrashPile<font color="#000080">: </font>Pile<font color="#000080">;
    </font>ComputerTurn<font color="#000080">: </font>boolean<font color="#000080">;
    </font>Game<font color="#000080">: </font>boolean<font color="#000080">;
    </font>Valid<font color="#000080">, </font>Discard<font color="#000080">, </font>DecisionDiscard<font color="#000080">: </font>boolean<font color="#000080">;
    </font>From<font color="#000080">, </font>Tto<font color="#000080">: </font>integer<font color="#000080">;
    </font>PosTable <font color="#000080">: </font>stack_t<font color="#000080">;
    </font>TopCardTable<font color="#000080">: </font>CardValTable_t<font color="#000080">;
    </font>pos<font color="#000080">: </font>integer<font color="#000080">;
    </font>Winner<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ChoiceRate<font color="#000080">: </font>choiceTable_t<font color="#000080">;
    </font>AnotherGame<font color="#000080">: </font>boolean<font color="#000080">;
    </font>TwoPlayer<font color="#000080">: </font>boolean<font color="#000080">;
    </font>MustMove<font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#008000"><i>{=============================================================================
                       OBJECT PROCEDURES &amp; FUNCTIONS
=============================================================================}

{____________________________________________________________________
| Init
|       Initializes a pile's array (data) and pointer (top)
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Pile<font color="#000080">.</font>Init<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Count<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>top <font color="#000080">:= </font>MAXSIZE <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAXSIZE <font color="#FF0000"><b>do
      </b></font>Pile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>NULL<font color="#000080">);   </font><font color="#008000"><i>{Stores NULL values in entire array.}
   </i></font>top <font color="#000080">:= </font>MAXSIZE <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure Init}

{____________________________________________________________________
| RandomShuffle
|         Shuffles the cards in a pile.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Pile<font color="#000080">.</font>RandomShuffle<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>ShuffleArray<font color="#000080">: </font>Pile<font color="#000080">;  </font><font color="#008000"><i>{Temporary Storage Pile}
    </i></font>Counter<font color="#000080">: </font>Pos_t<font color="#000080">;
    </font>RandSlot<font color="#000080">: </font>integer<font color="#000080">;
    </font>DeckSize<font color="#000080">: </font>integer<font color="#000080">;
    </font>TopofDeck<font color="#000080">: </font>Pos_t<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>DeckSize <font color="#000080">:= </font>DrawPile<font color="#000080">.</font>NumCards<font color="#000080">;
   </font>TopofDeck <font color="#000080">:= (</font>MAXSIZE <font color="#000080">- </font>DeckSize<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>ShuffleArray<font color="#000080">.</font>Init<font color="#000080">;   </font><font color="#008000"><i>{Initializing ShuffleArray}
   </i></font>ShuffleArray<font color="#000080">.</font>top <font color="#000080">:= </font>TopofDeck<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DeckSize <font color="#FF0000"><b>do begin
      </b></font>RandSlot <font color="#000080">:= </font>Random <font color="#000080">(</font>DeckSize<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{'+1' due to Random range.}
      </i></font><font color="#FF0000"><b>While </b></font>ShuffleArray<font color="#000080">.</font>SeeRandom <font color="#000080">(</font>RandSlot<font color="#000080">) &lt;&gt; </font>NULL <font color="#FF0000"><b>do
         </b></font>RandSlot <font color="#000080">:= </font>Random <font color="#000080">(</font>DeckSize<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
      </font>ShuffleArray<font color="#000080">.</font>top <font color="#000080">:= </font>TopofDeck <font color="#000080">+ </font>Randslot<font color="#000080">;
         </font><font color="#008000"><i>{Set ShuffleArray's &quot;top&quot; pointer to slot beneath empty slot, so
          that PutOnTop will put the card in the empty slot.}
      </i></font>ShuffleArray<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
      </font>ShuffleArray<font color="#000080">.</font>top <font color="#000080">:= </font>TopofDeck<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font>ShuffleArray<font color="#000080">.</font>top <font color="#000080">:= </font>TopofDeck<font color="#000080">;
      </font><font color="#008000"><i>{Set ShuffleArray's &quot;top&quot; pointer to the top of the stack.}
   </i></font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>DeckSize <font color="#FF0000"><b>do
      </b></font>DrawPile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>ShuffleArray<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font><font color="#008000"><i>{Transfered shuffled ShuffleArray to DrawPile.}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Procedure RandomShuffle}

{____________________________________________________________________
| PutOnTop
|      Places a card value on the top of the pile.
|
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Pile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>CardtoPutOn<font color="#000080">: </font>CardVal_t<font color="#000080">);

</font><font color="#FF0000"><b>begin
   </b></font>top <font color="#000080">:= </font>top <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{Advance the top pointer to the empty slot above it.}
   </i></font><font color="#FF0000"><b>If </b></font>top <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>writeln <font color="#000080">(</font><font color="#800000">'ERROR. Array Overflow.'</font><font color="#000080">);
      </font>HALT<font color="#000080">;
      </font><font color="#008000"><i>{Program is stopped if program attempts to a put a card on top of what
       should be a full pile.  This should never never happen given that the
       size of the pile arrays are the same size as the number of cards.}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>data <font color="#000080">[</font>top<font color="#000080">] := </font>CardtoPutOn<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure PutOnTop}

{____________________________________________________________________
| RemoveFromTop
|      Removes the top card from a pile and return the value of
|      of the card.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Pile<font color="#000080">.</font>RemoveFromTop<font color="#000080">: </font>CardVal_t<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>RemoveFromTop <font color="#000080">:= </font>data <font color="#000080">[</font>top<font color="#000080">];
   </font>data <font color="#000080">[</font>top<font color="#000080">] := </font>NULL<font color="#000080">;
   </font>top <font color="#000080">:= </font>top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{Adjusts the top pointer so it points at the top card.}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Procedure RemoveFromTop}

{____________________________________________________________________
| SeeRandom
|      Allows the program to view the card value in any given
|      position in a stack.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Pile<font color="#000080">.</font>SeeRandom <font color="#000080">(</font>pos<font color="#000080">: </font>Pos_t<font color="#000080">): </font>CardVal_t<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>SeeRandom <font color="#000080">:= </font>data <font color="#000080">[</font>top <font color="#000080">+ </font>pos <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">];
      </font><font color="#008000"><i>{The &quot;- 1&quot; in the equation defines position 1 as the top card.}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>top <font color="#000080">+ </font>pos <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) &gt; </font>MAXSIZE <font color="#FF0000"><b>then
      </b></font>SeeRandom <font color="#000080">:= </font>NULL<font color="#000080">;
   </font><font color="#008000"><i>{if the seek excedes the boundaries, a null value is returned.}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Procedure SeeRandom}

{____________________________________________________________________
|  DeleteByValue
|       Searches through a pile for a designated value, and &quot;pulls&quot;
|       the card out, returning the card's value.  After the card is
|       removed, the gap in the stack is filled in by readjusting the
|       cards.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Pile<font color="#000080">.</font>DeleteByValue <font color="#000080">(</font>value <font color="#000080">: </font>CardVal_t<font color="#000080">): </font>CardVal_t<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>count<font color="#000080">:</font>integer<font color="#000080">; </font>hold <font color="#000080">: </font>CardVal_t<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
      </b></font>count <font color="#000080">:=</font>count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>data<font color="#000080">[</font>count<font color="#000080">] = </font>value<font color="#000080">);
   </font>hold <font color="#000080">:= </font>data<font color="#000080">[</font>top<font color="#000080">];
   </font>data<font color="#000080">[</font>top<font color="#000080">] := </font>value<font color="#000080">;
   </font>data<font color="#000080">[</font>count<font color="#000080">] := </font>hold<font color="#000080">;
   </font>hold <font color="#000080">:= </font>Pile<font color="#000080">.</font>RemoveFromTop<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Procedure DeleteByValue}

{____________________________________________________________________
| IsPresent
|      Searches through a pile, looking to see if a designated card
|      value is present.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Pile<font color="#000080">.</font>IsPresent <font color="#000080">(</font>CardtoFind<font color="#000080">: </font>CardVal_t<font color="#000080">): </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>ValuePresent<font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>ValuePresent <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>ValuePresent <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>top <font color="#000080">&gt; </font>MAXSIZE<font color="#000080">)) </font><font color="#FF0000"><b>do begin
      </b></font>top <font color="#000080">:= </font>top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>data <font color="#000080">[</font>top<font color="#000080">] = </font>CardtoFind <font color="#FF0000"><b>then
         </b></font>ValuePresent <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}
      </i></font><font color="#FF0000"><b>If </b></font>ValuePresent <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
         </b></font>IsPresent <font color="#000080">:= </font>FALSE
      <font color="#FF0000"><b>else
         </b></font>IsPresent <font color="#000080">:= </font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Function IsPresent}

{____________________________________________________________________
|  NumCards
|      Returns the number of cards in a pile.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Pile<font color="#000080">.</font>NumCards<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>NumCards <font color="#000080">:= (</font>MAXSIZE <font color="#000080">- </font>top<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#008000"><i>{The &quot;+ 1&quot; in the equation takes into account that the position of top
       contains a card.}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function NumCards}

{============================================================================
                               GENERAL FUNCTIONS
============================================================================}

{____________________________________________________________________
|  CardValue
|     Converts card value (4..111) to orderinal value.
|     (0 = Joker, 1,2,3,...10,11 = JACK,...)
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>CardValue <font color="#000080">(</font>Card<font color="#000080">: </font>CardVal_t<font color="#000080">): </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font>Card <font color="#000080">= </font>NULL <font color="#FF0000"><b>then
      </b></font>CardValue <font color="#000080">:= </font>NULL
   <font color="#FF0000"><b>else
      </b></font>CardValue <font color="#000080">:= </font>Card <font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function CardValue}

{____________________________________________________________________
|  CardString
|     Converts a card value to a string, for representation on the
|     screen.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>CardString <font color="#000080">(</font>Card<font color="#000080">: </font>CardVal_t<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Number<font color="#000080">: </font>integer<font color="#000080">;
   </font>Output<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Number <font color="#000080">:= </font>Card <font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>Card <font color="#000080">= </font>NULL <font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'JO' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'AC' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'02' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'03' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">4 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'04' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">5 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'05' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'06' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'07' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'08' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'09' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">10 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'10' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">11 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'JA' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">12 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'QU' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">13 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'KI' </font><font color="#FF0000"><b>else
   </b></font>Output <font color="#000080">:= </font><font color="#800000">'ERROR'</font><font color="#000080">;

   </font>Number <font color="#000080">:= </font>Card <font color="#FF0000"><b>MOD </b></font><font color="#800000">4</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>Card <font color="#000080">= </font>NULL <font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font><font color="#800000">'' </font><font color="#FF0000"><b>else
   if </b></font><font color="#000080">(</font>Card <font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font>Output <font color="#000080">+ </font><font color="#800000">'!' </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font>Output <font color="#000080">+ </font>chr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font>Output <font color="#000080">+ </font>chr<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font>Output <font color="#000080">+ </font>chr<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>else
   if </b></font>Number <font color="#000080">= </font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>Output <font color="#000080">:= </font>Output <font color="#000080">+ </font>chr<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>else
   </b></font>Output <font color="#000080">:= </font><font color="#800000">'ERROR'</font><font color="#000080">;

   </font>CardString <font color="#000080">:= </font>Output<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function CardSuit}

{___________________________________________________________________
|  AceTopCard
|     Due to the possibility of a joker on an ace pile, this
|     function returns the ordinal value of the card on the top of
|     an ace pile -- if there's a joker it is converted to its
|     ordinal value within the pile.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>AceTopCard <font color="#000080">(</font>Number<font color="#000080">: </font>integer<font color="#000080">): </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>position<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>position <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>PosTable <font color="#000080">[</font>Number<font color="#000080">]^.</font>SeeRandom <font color="#000080">(</font>position<font color="#000080">)) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>position <font color="#000080">:= </font>position <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font>AceTopCard <font color="#000080">:= </font>CardValue <font color="#000080">(</font>PosTable <font color="#000080">[</font>Number<font color="#000080">]^.</font>SeeRandom <font color="#000080">(</font>position<font color="#000080">)) +
                 </font>position <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function AceTopCard}

{============================================================================
                             MAIN PROGRAM PROCEDURES
                   (Grouped with corresponding sub-procedures)
============================================================================}

{___________________________________________________________________
|  Initialize
|      Does all the Non-Object initialization.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Initialize<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>count<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Randomize<font color="#000080">;
   </font>DrawPile<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerHand<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerHand<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerScorePile<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerScorePile<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerDiscardPile1<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerDiscardPile2<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerDiscardPile3<font color="#000080">.</font>Init<font color="#000080">;
   </font>PlayerDiscardPile4<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerDiscardPile1<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerDiscardPile2<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerDiscardPile3<font color="#000080">.</font>Init<font color="#000080">;
   </font>ComputerDiscardPile4<font color="#000080">.</font>Init<font color="#000080">;
   </font>AcePile1<font color="#000080">.</font>Init<font color="#000080">;
   </font>AcePile2<font color="#000080">.</font>Init<font color="#000080">;
   </font>AcePile3<font color="#000080">.</font>Init<font color="#000080">;
   </font>AcePile4<font color="#000080">.</font>Init<font color="#000080">;
   </font>TrashPile<font color="#000080">.</font>Init<font color="#000080">;
   </font>Game <font color="#000080">:= </font>TRUE<font color="#000080">;

   </font><font color="#008000"><i>{Set up Position Table}

   </i></font>PosTable<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] := @</font>PlayerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] := @</font>PlayerScorePile<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">] := @</font>PlayerDiscardPile1<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] := @</font>PlayerDiscardPile2<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] := @</font>PlayerDiscardPile3<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">] := @</font>PlayerDiscardPile4<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">] := @</font>AcePile1<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">] := @</font>AcePile2<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">] := @</font>AcePile3<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] := @</font>AcePile4<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">16</font><font color="#000080">] := @</font>ComputerDiscardPile1<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">17</font><font color="#000080">] := @</font>ComputerDiscardPile2<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">18</font><font color="#000080">] := @</font>ComputerDiscardPile3<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">19</font><font color="#000080">] := @</font>ComputerDiscardPile4<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">20</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">22</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">23</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">24</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">25</font><font color="#000080">] := @</font>ComputerHand<font color="#000080">;
   </font>PosTable<font color="#000080">[</font><font color="#800000">26</font><font color="#000080">] := @</font>ComputerScorePile<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure Initialize}

{___________________________________________________________________
|  InitTable
|     Refreshes the values for the TopCardTable, which stores the
|     values of the top card in all 26 positions.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>InitTable<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>count<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   for </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">6 </font><font color="#FF0000"><b>Do
      </b></font>TopCardTable<font color="#000080">[</font>count<font color="#000080">] := </font>PosTable<font color="#000080">[</font>count<font color="#000080">]^.</font>SeeRandom <font color="#000080">(</font>count<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">7 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>Do
      </b></font>TopCardTable<font color="#000080">[</font>count<font color="#000080">] := </font>PosTable<font color="#000080">[</font>count<font color="#000080">]^.</font>SeeRandom <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>count <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>Do
      </b></font>TopCardTable<font color="#000080">[</font>count<font color="#000080">] := </font>PosTable<font color="#000080">[</font>count<font color="#000080">]^.</font>SeeRandom<font color="#000080">(</font>count<font color="#000080">-</font><font color="#800000">19</font><font color="#000080">);
   </font>TopCardTable<font color="#000080">[</font><font color="#800000">26</font><font color="#000080">] := </font>PosTable<font color="#000080">[</font><font color="#800000">26</font><font color="#000080">]^.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure InitTable}

{___________________________________________________________________
|  Deal
|    Deals the cards at the beginning of each game and decides,
|    based on the outcome of the deal, who will go first.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Deal<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Card<font color="#000080">: </font>CardVal_t<font color="#000080">;
    </font>Counter<font color="#000080">: </font>integer<font color="#000080">;
    </font>PlayerScoreTop<font color="#000080">: </font>CardVal_t<font color="#000080">;
    </font>ComputerScoreTop<font color="#000080">: </font>CardVal_t<font color="#000080">;

</font><font color="#FF0000"><b>begin
   for </b></font>Card <font color="#000080">:= (</font><font color="#800000">1 </font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>MAXSIZE <font color="#000080">+</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font><font color="#008000"><i>{Put 2 decks of cards in draw pile, +3 is necessary for the div and mod
       to operate correctly.}
      </i></font>DrawPile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>Card<font color="#000080">);
   </font>DrawPile<font color="#000080">.</font>RandomShuffle<font color="#000080">;  </font><font color="#008000"><i>{Shuffle the draw pile.}
   </i></font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do begin </b></font><font color="#008000"><i>{Deal the hands}
      </i></font>PlayerHand<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
      </font>ComputerHand<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">14 </font><font color="#FF0000"><b>do begin </b></font><font color="#008000"><i>{Deal the score piles}
      </i></font>PlayerScorePile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
      </font>ComputerScorePile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font>PlayerDiscardPile1<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>PlayerDiscardPile2<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>PlayerDiscardPile3<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>PlayerDiscardPile4<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>ComputerDiscardPile1<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>ComputerDiscardPile2<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>ComputerDiscardPile3<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font>ComputerDiscardPile4<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
        </font><font color="#008000"><i>{Decide whose turn it is.  ComputerTurn set to opposite, because
         it will be reversed in upcoming WhoseTurn procedure.}
   </i></font>PlayerScoreTop <font color="#000080">:= </font>CardValue <font color="#000080">(</font>PlayerScorePile<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
   </font>ComputerScoreTop <font color="#000080">:= </font>CardValue <font color="#000080">(</font>ComputerScorePile<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));

   </font><font color="#FF0000"><b>if </b></font>PlayerScoreTop <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>ComputerTurn <font color="#000080">:= </font>FALSE
   <font color="#FF0000"><b>else if </b></font>ComputerScoreTop <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>ComputerTurn <font color="#000080">:= </font>TRUE
   <font color="#FF0000"><b>else if </b></font>PlayerScoreTop <font color="#000080">= </font>ComputerScoreTop <font color="#FF0000"><b>then
      </b></font>ComputerTurn <font color="#000080">:= </font>FALSE
   <font color="#FF0000"><b>else if </b></font>PlayerScoreTop <font color="#000080">&gt; </font>ComputerScoreTop <font color="#FF0000"><b>then
      </b></font>ComputerTurn <font color="#000080">:= </font>TRUE
   <font color="#FF0000"><b>else
      </b></font>ComputerTurn <font color="#000080">:= </font>FALSE<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Deal}

{___________________________________________________________________
|  OutString
|     One of the procedures involving the interface.
|     This procedure receives x,y coordinates for a screen position
|     and outputs a string starting at that position.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>OutString <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">: </font>integer<font color="#000080">; </font>toPrint<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>begin
   </b></font>GotoXY <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
   </font>write <font color="#000080">(</font>toPrint<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure OutString}

{____________________________________________________________________
|  ColorDim
|     One of the procedures involving the interface.
|     Sets colors for displaying things involving the player whose
|     turn it is not (hence, they are dimmed.)
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>ColorDim<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>TextColor <font color="#000080">(</font>LIGHTgray<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure ColorDim}

{___________________________________________________________________
|  ColorCard
|     One of the procedures involving the interface.
|     Sets colors for displaying a card of the player whose turn it
|     is.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>ColorCard<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>TextColor <font color="#000080">(</font>YELLOW<font color="#000080">);
   </font>TextBackGround <font color="#000080">(</font>BLUE<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure ColorCard}

{____________________________________________________________________
|  ColorFrame
|     One of the procedures involving the interface.
|     Sets colors for highlighting the section of the frame
|     involving the player whose turn it is.
|___________________________________________________________________}


</i></font><font color="#FF0000"><b>procedure </b></font>ColorFrame<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>TextColor <font color="#000080">(</font>YELLOW<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure ColorFrame}

{____________________________________________________________________
|  ColorNormalText
|     One of the procedures involving the interface.
|     Sets colors for normal text and is also the colors which the
|     game returns to upon exiting.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>ColorNormalText<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>TextColor <font color="#000080">(</font>WHITE<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure ColorNormalText}

{___________________________________________________________________
|  ColorPosition
|     One of the procedures involving the interface.
|     Sets colors for the display of position indicators.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>ColorPosition<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>TextColor <font color="#000080">(</font>WHITE<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>RED<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure ColorPosition}

{___________________________________________________________________
|  TitleScreen
|     Displays a title screen and asks whether the user would like
|     a one-player or a two-player game.  Accompanying procedures are
|     called by TitleScreen
|__________________________________________________________________}



</i></font><font color="#FF0000"><b>procedure </b></font>Heart<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>TextColor <font color="#000080">(</font>red<font color="#000080">);
</font>TextBackground <font color="#000080">(</font>LightGray<font color="#000080">);
</font>write <font color="#000080">(</font>char<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Club<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>TextColor <font color="#000080">(</font>black<font color="#000080">);
</font>TextBackground <font color="#000080">(</font>LightGray<font color="#000080">);
</font>write <font color="#000080">(</font>char<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Diamond<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>TextColor <font color="#000080">(</font>red<font color="#000080">);
</font>TextBackground <font color="#000080">(</font>lightgray<font color="#000080">);
</font>write <font color="#000080">(</font>char<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Spade<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>TextColor <font color="#000080">(</font>black<font color="#000080">);
</font>TextBackground <font color="#000080">(</font>lightgray<font color="#000080">);
</font>write <font color="#000080">(</font>char<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SuitsCol <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>count<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c <font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>count <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do begin
 </b></font>GotoXY <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">+</font>c<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">);
 </font>Heart<font color="#000080">;
 </font>GotoXY <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">+</font>c<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
 </font>Club<font color="#000080">;
 </font>GotoXY <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">+</font>c<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
 </font>Diamond<font color="#000080">;
 </font>GotoXY <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">+</font>c<font color="#000080">*</font><font color="#800000">4</font><font color="#000080">+</font><font color="#800000">3</font><font color="#000080">);
 </font>Spade<font color="#000080">;
 </font>c <font color="#000080">:= </font>c <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
 </font>count <font color="#000080">:= </font>count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
 </font>TextBackGround <font color="#000080">(</font>black<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{while loop}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{SuitsCol}

</i></font><font color="#FF0000"><b>procedure </b></font>SuitsRow <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>count<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c <font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>count <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do begin
 </b></font>GotoXY <font color="#000080">(</font>x <font color="#000080">+ (</font><font color="#800000">4</font><font color="#000080">*</font>c<font color="#000080">), </font>y<font color="#000080">);
 </font>Heart<font color="#000080">;
 </font>Club<font color="#000080">;
 </font>Diamond<font color="#000080">;
 </font>Spade<font color="#000080">;
 </font>c <font color="#000080">:= </font>c <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
 </font>count <font color="#000080">:= </font>count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
 </font>TextBackground <font color="#000080">(</font>black<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{while loop}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{SuitsRow}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawTitleBox<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>SuitsCol <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
</font>SuitsRow <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
</font>SuitsRow <font color="#000080">(</font><font color="#800000">25</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
</font>SuitsCol <font color="#000080">(</font><font color="#800000">57</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
</font>GotoXY <font color="#000080">(</font><font color="#800000">57</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
</font>Heart<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{DrawTitleBox}

</i></font><font color="#FF0000"><b>procedure </b></font>Title<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  </b></font>TextColor <font color="#000080">(</font>white<font color="#000080">);
  </font>TextBackground <font color="#000080">(</font>black<font color="#000080">);
  </font>OutString <font color="#000080">(</font><font color="#800000">28</font><font color="#000080">, </font><font color="#800000">9</font><font color="#000080">, </font><font color="#800000">'Welcome to Spite &amp; Malice!'</font><font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Info <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>TwoPlayer <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>response <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
repeat
 </b></font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">'How many players?'</font><font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">37</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>lightred<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">'1 '</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>white<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">'or '</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>lightred<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>white<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font><font color="#800000">13</font><font color="#000080">,  </font><font color="#800000">')'</font><font color="#000080">);
 </font>GotoXY <font color="#000080">(</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">14</font><font color="#000080">);
 </font>readln <font color="#000080">(</font>response<font color="#000080">);
 </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>response <font color="#000080">= </font><font color="#800000">'1'</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>response <font color="#000080">= </font><font color="#800000">'2'</font><font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>response <font color="#000080">= </font><font color="#800000">'1' </font><font color="#FF0000"><b>then
      </b></font>TwoPlayer <font color="#000080">:= </font>FALSE
   <font color="#FF0000"><b>else
      </b></font>TwoPlayer <font color="#000080">:= </font>TRUE<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TitleScreen <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>TwoPlayer<font color="#000080">:</font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>response<font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>TextBackground <font color="#000080">(</font>black<font color="#000080">);
</font>clrscr<font color="#000080">;
</font>TextBackground <font color="#000080">(</font>black<font color="#000080">);
</font>DrawTitleBox<font color="#000080">;
</font>Title<font color="#000080">;
</font>Info <font color="#000080">(</font>TwoPlayer<font color="#000080">);
</font>TextBackground <font color="#000080">(</font>black<font color="#000080">);
</font>TextColor <font color="#000080">(</font>white<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure TitleScreen}

{___________________________________________________________________
|  DrawFrame
|     One of the procedures involving the interface.
|     This procedure draws the ascii graphical skeleton of the
|     screen.  It also takes into account the turn in its choice of
|     colors.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawFrame <font color="#000080">(</font>ComputerTurn<font color="#000080">: </font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Row<font color="#000080">: </font>integer<font color="#000080">;
    </font>Column<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font><font color="#008000"><i>{Clear screen with Black background.}
   </i></font>TextBackGround <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>TextColor <font color="#000080">(</font>BLACK<font color="#000080">);
   </font><font color="#FF0000"><b>For </b></font>Row<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do
      For </b></font>Column <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do begin
         if NOT </b></font><font color="#000080">((</font>Row <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Column <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">)) </font><font color="#FF0000"><b>then
            </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">, </font>Row<font color="#000080">, </font>chr<font color="#000080">(</font><font color="#800000">219</font><font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for column}
   </i></font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorFrame<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">201</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">203</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">202</font><font color="#000080">));
   </font><font color="#FF0000"><b>for </b></font>Column <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">30 </font><font color="#FF0000"><b>do begin
      </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font><font color="#FF0000"><b>For </b></font>Row <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">23 </font><font color="#FF0000"><b>do begin
      </b></font>OutString <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font>Outstring <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">204</font><font color="#000080">));
   </font>Outstring <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">185</font><font color="#000080">));
   </font><font color="#FF0000"><b>For </b></font>Row <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">30 </font><font color="#FF0000"><b>do
      </b></font>OutString <font color="#000080">(</font>Row<font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">204</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">204</font><font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorFrame
   <font color="#FF0000"><b>else
      </b></font>ColorDim<font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>Column <font color="#000080">:= </font><font color="#800000">51 </font><font color="#FF0000"><b>to </b></font><font color="#800000">79 </font><font color="#FF0000"><b>do begin
      </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font><font color="#FF0000"><b>For </b></font>Row <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">23 </font><font color="#FF0000"><b>do begin
      </b></font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font><font color="#800000">80</font><font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">186</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">203</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">202</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">185</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">185</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">204</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">187</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">188</font><font color="#000080">));
   </font>ColorFrame<font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>Column <font color="#000080">:= </font><font color="#800000">32 </font><font color="#FF0000"><b>to </b></font><font color="#800000">49 </font><font color="#FF0000"><b>do begin
      </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">13</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
      </font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">205</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}

   </i></font>TextColor <font color="#000080">(</font>BLUE<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>Row <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
      for </b></font>Column <font color="#000080">:= </font><font color="#800000">32 </font><font color="#FF0000"><b>to </b></font><font color="#800000">49 </font><font color="#FF0000"><b>do
         </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">219</font><font color="#000080">));
   </font>TextColor <font color="#000080">(</font>WHITE<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLUE<font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Spite &amp; Malice'</font><font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'By Ben Arnoldy'</font><font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'&amp; Raechel Kula'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure DrawFrame}

{___________________________________________________________________
|  DrawDiscards
|     One of the procedures involved with the interface.
|     This procedure sets up the discard portions of the screen.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawDiscards <font color="#000080">(</font>ComputerTurn<font color="#000080">:</font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Counter<font color="#000080">: </font>Pos_t<font color="#000080">;

</font><font color="#FF0000"><b>begin

   if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Player Discard'</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorNormalText
   <font color="#FF0000"><b>else
      </b></font>ColorDim<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>OutString <font color="#000080">(</font><font color="#800000">58</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Computer Discard'</font><font color="#000080">)
   </font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>OutString <font color="#000080">(</font><font color="#800000">58</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Opponent Discard'</font><font color="#000080">);
   </font>ColorPosition<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'H'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'J'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'K'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'P'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">59</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'Q'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">66</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'R'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">73</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'S'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">14 </font><font color="#FF0000"><b>do begin
      if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
         </b></font>ColorDim
      <font color="#FF0000"><b>else
         </b></font>ColorCard<font color="#000080">;
      </font>OutString<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>PlayerDiscardPile1<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>PlayerDiscardPile2<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>PlayerDiscardPile3<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>PlayerDiscardPile4<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
         </b></font>ColorDim
      <font color="#FF0000"><b>else
         </b></font>ColorCard<font color="#000080">;
      </font>OutString<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>ComputerDiscardPile1<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">62</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>ComputerDiscardPile2<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">69</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>ComputerDiscardPile3<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">76</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">+</font>Counter<font color="#000080">,
         </font>CardString <font color="#000080">(</font>ComputerDiscardPile4<font color="#000080">.</font>SeeRandom<font color="#000080">(</font>Counter<font color="#000080">)));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   {if there are too many cards in a discard pile to display...}
   </i></font>TextColor <font color="#000080">(</font>LIGHTred<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do begin
      if </b></font>PosTable <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">14 </font><font color="#FF0000"><b>then
         </b></font>OutString <font color="#000080">((-</font><font color="#800000">2 </font><font color="#000080">+ (</font>Counter<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">)),</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">'more'</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>PosTable <font color="#000080">[</font><font color="#800000">15</font><font color="#000080">+</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">14 </font><font color="#FF0000"><b>then
         </b></font>OutString <font color="#000080">((</font><font color="#800000">44 </font><font color="#000080">+ (</font>Counter<font color="#000080">*</font><font color="#800000">7</font><font color="#000080">)),</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">'more'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure DrawDiscards}

{___________________________________________________________________
|  DrawHands
|     One of the procedures involved with the interface.
|     This procedure displays the hands and scorepiles.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawHands <font color="#000080">(</font>ComputerTurn<font color="#000080">:</font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>CardFace<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin

   if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorNormalText<font color="#000080">;
   </font>GotoXY <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">);
   </font>write <font color="#000080">(</font><font color="#800000">'Player''s Hand:'</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorNormalText<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">51</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Computer''s Hand:'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end
   else if </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">51</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Opponent''s Hand:'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>ColorPosition<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">23</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'T'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">57</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'U'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'V'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'W'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">72</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'X'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">77</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorCard<font color="#000080">;
   </font>OutString<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)));
   </font>OutString<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)));
   </font>OutString<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)));
   </font>OutString<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)));
   </font>OutString<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)));
   </font>OutString<font color="#000080">(</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>PlayerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">)));
   </font><font color="#FF0000"><b>If </b></font>ComputerTurn <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorCard<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TwoPlayer <font color="#FF0000"><b>then begin
      </b></font>OutString<font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">57</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">72</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">)));
      </font>OutString<font color="#000080">(</font><font color="#800000">77</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardString <font color="#000080">(</font>ComputerHand<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">)));
   </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{if}
   </i></font><font color="#FF0000"><b>else begin
      </b></font>CardFace <font color="#000080">:= </font>chr<font color="#000080">(</font><font color="#800000">168</font><font color="#000080">) + </font>chr<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">57</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">62</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">4 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">72</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">5 </font><font color="#FF0000"><b>then
         </b></font>OutString<font color="#000080">(</font><font color="#800000">77</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font>CardFace<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if-else}
   </i></font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorNormalText<font color="#000080">;
   </font>GotoXY <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);
   </font>write <font color="#000080">(</font><font color="#800000">'Score Pile: '</font><font color="#000080">, </font>PlayerScorePile<font color="#000080">.</font>NumCards<font color="#000080">,
      </font><font color="#800000">' cards&gt; '</font><font color="#000080">);
   </font>ColorPosition<font color="#000080">;
   </font>write<font color="#000080">(</font><font color="#800000">'G'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>TextColor <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>TRUE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorCard<font color="#000080">;
   </font>write <font color="#000080">(</font>CardString <font color="#000080">(</font>PlayerScorePile<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)));
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorNormalText<font color="#000080">;
   </font>GotoXY <font color="#000080">(</font><font color="#800000">51</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);
   </font>write <font color="#000080">(</font><font color="#800000">'Score Pile: '</font><font color="#000080">, </font>ComputerScorePile<font color="#000080">.</font>NumCards<font color="#000080">,
      </font><font color="#800000">' cards&gt; '</font><font color="#000080">);
   </font>ColorPosition<font color="#000080">;
   </font>write<font color="#000080">(</font><font color="#800000">'Z'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>TextColor <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#000080">= </font>FALSE <font color="#FF0000"><b>then
      </b></font>ColorDim
   <font color="#FF0000"><b>else
      </b></font>ColorCard<font color="#000080">;
   </font>write <font color="#000080">(</font>CardString <font color="#000080">(</font>ComputerScorePile<font color="#000080">.</font>SeeRandom<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure DrawHands}

{___________________________________________________________________
|  DrawAcePiles
|     One of the procedures involved with the interface.
|     This procedure draws the AcePile portion of the screen.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawAcePiles<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Counter<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

   </b></font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">'Ace Piles:'</font><font color="#000080">);
   </font>ColorPosition<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">'L'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">'M'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'O'</font><font color="#000080">+</font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">));
   </font>ColorCard<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do begin
      </b></font>OutString<font color="#000080">(</font><font color="#800000">41</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font>CardString <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">] ));
      </font><font color="#FF0000"><b>if </b></font>CardValue<font color="#000080">( </font>TopCardTable <font color="#000080">[</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">] )=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
         if </b></font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) &lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
            </b></font>OutString<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font>chr<font color="#000080">(</font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) + </font><font color="#800000">48</font><font color="#000080">))
         </font><font color="#FF0000"><b>else if </b></font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) = </font><font color="#800000">10 </font><font color="#FF0000"><b>then
            </b></font>OutString<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font><font color="#800000">'10'</font><font color="#000080">)
         </font><font color="#FF0000"><b>else if </b></font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) = </font><font color="#800000">11 </font><font color="#FF0000"><b>then
            </b></font>OutString<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font><font color="#800000">'JA'</font><font color="#000080">)
         </font><font color="#FF0000"><b>else if </b></font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) = </font><font color="#800000">12 </font><font color="#FF0000"><b>then
            </b></font>OutString<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font><font color="#800000">'QU'</font><font color="#000080">)
         </font><font color="#FF0000"><b>else if </b></font>AceTopCard <font color="#000080">(</font><font color="#800000">11</font><font color="#000080">+</font>Counter<font color="#000080">) = </font><font color="#800000">13 </font><font color="#FF0000"><b>then
            </b></font>OutString<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">+</font>Counter<font color="#000080">,</font><font color="#800000">'KI'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Display}

{___________________________________________________________________
|  DrawMessageBox
|     One of the procedures involved with the interface.
|     This procedure clears the message portion of the screen and
|     prints a message displaying the turn.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>DrawMessageBox <font color="#000080">(</font>ComputerTurn<font color="#000080">: </font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>var
   </b></font>Column<font color="#000080">: </font>integer<font color="#000080">;
   </font>Row<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

   </b></font>TextColor <font color="#000080">(</font>BLACK<font color="#000080">);
   </font>TextBackground <font color="#000080">(</font>BLACK<font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>Column <font color="#000080">:= </font><font color="#800000">32 </font><font color="#FF0000"><b>to </b></font><font color="#800000">49 </font><font color="#FF0000"><b>do
      for </b></font>Row <font color="#000080">:= </font><font color="#800000">14 </font><font color="#FF0000"><b>to </b></font><font color="#800000">23 </font><font color="#FF0000"><b>do
         </b></font>OutString <font color="#000080">(</font>Column<font color="#000080">,</font>Row<font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">219</font><font color="#000080">));
   </font>ColorNormalText<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ComputerTurn <font color="#000080">= </font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>FALSE<font color="#000080">)) </font><font color="#FF0000"><b>then begin
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Computer''s Turn'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end
   else if </b></font><font color="#000080">((</font>ComputerTurn <font color="#000080">= </font>TRUE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>TwoPlayer <font color="#000080">= </font>TRUE<font color="#000080">)) </font><font color="#FF0000"><b>then begin
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Opponent''s Turn'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end
   else begin
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Player''s Turn'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure DrawMessageBox}

{___________________________________________________________________
|  Display
|     This procedure directs the interface procedures for a complete
|     redrawing of the screen.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>Display<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>clrscr<font color="#000080">;
   </font>DrawFrame <font color="#000080">(</font>ComputerTurn<font color="#000080">);
   </font>DrawDiscards <font color="#000080">(</font>ComputerTurn<font color="#000080">);
   </font>DrawHands <font color="#000080">(</font>ComputerTurn<font color="#000080">);
   </font>DrawAcePiles<font color="#000080">;
   </font>DrawMessageBox <font color="#000080">(</font>ComputerTurn<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Display}

{___________________________________________________________________
|  PickUpHand
|     Picks up the required number of cards from the draw pile and
|     places them in the hand of the person whose turn it is.
|     This procedure also checks to see if the draw pile has run out
|     of cards.  If so the trash pile is placed in the draw pile and
|     the draw pile is subsequently reshuffled.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>PickupHand <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Hand <font color="#000080">: </font>pile<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>numToGet<font color="#000080">, </font>count<font color="#000080">, </font>Counter <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

   If </b></font><font color="#000080">(</font>Hand<font color="#000080">.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">3</font><font color="#000080">)</font><font color="#FF0000"><b>Then
      </b></font>numToGet <font color="#000080">:= </font><font color="#800000">1
   </font><font color="#FF0000"><b>Else
      </b></font>numToGet <font color="#000080">:= (</font><font color="#800000">5 </font><font color="#000080">- </font>Hand<font color="#000080">.</font>NumCards<font color="#000080">);

   </font><font color="#FF0000"><b>For </b></font>count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numToGet <font color="#FF0000"><b>Do begin
      If </b></font>DrawPile<font color="#000080">.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{Draw pile out of card, replenish}
         </i></font><font color="#FF0000"><b>For </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TrashPile<font color="#000080">.</font>NumCards <font color="#FF0000"><b>do
            </b></font>DrawPile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>TrashPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
         </font>DrawPile<font color="#000080">.</font>RandomShuffle<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
      </i></font>Hand<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>DrawPile<font color="#000080">.</font>RemoveFromTop<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure PickupHand}

{____________________________________________________________________
|  PickUpCards
|     Sends correct hand to the PickupHand procedure according to
|     whose turn it is.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>PickupCards<font color="#000080">;

</font><font color="#FF0000"><b>begin
   If </b></font>ComputerTurn <font color="#FF0000"><b>Then
      </b></font>PickupHand <font color="#000080">(</font>ComputerHand<font color="#000080">)
   </font><font color="#FF0000"><b>Else
      </b></font>PickupHand <font color="#000080">(</font>PlayerHand<font color="#000080">);

   </font>InitTable<font color="#000080">; </font><font color="#008000"><i>{Refresh the Top Card Table}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{PickupCards}

{____________________________________________________________________
|  HouseKeeping
|     Performs some checks after a card has been moved.
|     These checks include: removing completed ace piles,
|        checking for completed game, and checking for
|        insufficient cards to discard.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>HouseKeeping<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Counter<font color="#000080">: </font>integer<font color="#000080">;
    </font>Counter2<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

   </b></font>InitTable<font color="#000080">; </font><font color="#008000"><i>{Keep current top card information updated.}

   {Clean up any full ace piles.}

   </i></font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do
      if </b></font>PosTable <font color="#000080">[</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">13 </font><font color="#FF0000"><b>then
         for </b></font>Counter2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">13 </font><font color="#FF0000"><b>do
            </b></font>TrashPile<font color="#000080">.</font>PutOnTop <font color="#000080">(</font>PosTable <font color="#000080">[</font>Counter<font color="#000080">]^.</font>RemoveFromTop<font color="#000080">);

   </font><font color="#008000"><i>{Check for Game over.}

   </i></font><font color="#FF0000"><b>if </b></font>ComputerScorePile<font color="#000080">.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
         </b></font>Game <font color="#000080">:= </font>FALSE<font color="#000080">;
         </font>Discard <font color="#000080">:= </font>TRUE<font color="#000080">;
         </font>Winner <font color="#000080">:= </font><font color="#800000">'Computer'</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

   </i></font><font color="#FF0000"><b>if </b></font>PlayerScorePile<font color="#000080">.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
         </b></font>Game <font color="#000080">:= </font>FALSE<font color="#000080">;
         </font>Discard <font color="#000080">:= </font>TRUE<font color="#000080">;
         </font>Winner <font color="#000080">:= </font><font color="#800000">'Player'</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

   {Run out of cards before discard.}

   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Discard <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>ComputerTurn <font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>PickUpCards<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Discard <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font>PlayerHand<font color="#000080">.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>PickUpCards<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure HouseKeeping}

{____________________________________________________________________
|  MoveCard
|     Moves a card from one pile to another as specified.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>MoveCard <font color="#000080">(</font>From<font color="#000080">, </font>Tto <font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>frompile <font color="#000080">: </font>pilepointer_t<font color="#000080">;  </font>value<font color="#000080">: </font>CardVal_t<font color="#000080">;
    </font>dummy<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">((</font>From <font color="#000080">&lt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">((</font>From <font color="#000080">&gt; </font><font color="#800000">19</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">26</font><font color="#000080">))) </font><font color="#FF0000"><b>then begin
     </b></font>frompile <font color="#000080">:=</font>PosTable<font color="#000080">[</font>From<font color="#000080">];
     </font>value <font color="#000080">:= </font>TopCardTable<font color="#000080">[</font>From<font color="#000080">];
     </font>dummy <font color="#000080">:= </font>frompile<font color="#000080">^.</font>DeleteByValue<font color="#000080">(</font>value<font color="#000080">);
     </font>PosTable<font color="#000080">[</font>Tto<font color="#000080">]^.</font>PutOnTop<font color="#000080">(</font>value<font color="#000080">);
     </font><font color="#FF0000"><b>end
  else
     </b></font>PosTable<font color="#000080">[</font>Tto<font color="#000080">]^.</font>PutOnTop <font color="#000080">(</font>PosTable<font color="#000080">[</font>From<font color="#000080">]^.</font>RemoveFromTop<font color="#000080">);

  </font>HouseKeeping<font color="#000080">; </font><font color="#008000"><i>{Calls the HouseKeeping procedure}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{procedure MoveCard}

{____________________________________________________________________
|  WhoseTurn
|     This procedure changes the turns.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>WhoseTurn <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>ComputerTurn <font color="#000080">: </font>boolean<font color="#000080">);

</font><font color="#FF0000"><b>begin
   If </b></font>ComputerTurn <font color="#FF0000"><b>Then
      </b></font>ComputerTurn <font color="#000080">:= </font>False
   <font color="#FF0000"><b>Else
      </b></font>ComputerTurn <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{WhoseTurn}

{____________________________________________________________________
|  CheckMove
|     Checks to see if the move proposed is a) valid, and
|       b) a discard.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>CheckMove<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>From<font color="#000080">, </font>Tto<font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var
   </b></font>TopCard<font color="#000080">: </font>integer<font color="#000080">;
   </font>position<font color="#000080">: </font>Pos_t<font color="#000080">;
   </font>Counter<font color="#000080">: </font>Pos_t<font color="#000080">;
   </font>EmptyAcePile<font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>InitTable<font color="#000080">;
   </font>Valid <font color="#000080">:= </font>TRUE<font color="#000080">;
   </font>Discard <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font>MustMove <font color="#000080">:= </font>FALSE<font color="#000080">;
 

   </font><font color="#FF0000"><b>If </b></font>TopCardTable <font color="#000080">[</font>From<font color="#000080">] = </font>NULL <font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{Invalid if moving from empty space.}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Valid <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&lt; </font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Tto <font color="#000080">&gt; </font><font color="#800000">19</font><font color="#000080">))) </font><font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;</font><font color="#008000"><i>{Invalid if proposed to move card to ScorePiles or Hands}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Valid <font color="#FF0000"><b>AND </b></font>ComputerTurn <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&lt; </font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">12</font><font color="#000080">))) </font><font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{Invalid if computer proposed to or from player's side.}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>VALID <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&gt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">15</font><font color="#000080">))) </font><font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{Invalid if player proposed to or from computer's side.}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>VALID <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>From <font color="#000080">&gt; </font><font color="#800000">11</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">16</font><font color="#000080">))) </font><font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{Invalid if to Acepile from Acepile.}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>VALID <font color="#FF0000"><b>AND </b></font><font color="#000080">(((</font>Tto <font color="#000080">&gt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tto <font color="#000080">&lt; </font><font color="#800000">12</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>Tto <font color="#000080">&gt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tto <font color="#000080">&lt; </font><font color="#800000">20</font><font color="#000080">)))
      </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(((</font>From <font color="#000080">&lt; </font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">6</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>From <font color="#000080">= </font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>OR
      </b></font><font color="#000080">((</font>From <font color="#000080">&gt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">20</font><font color="#000080">))))) </font><font color="#FF0000"><b>then
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{Invalid if to discard from a discard or score pile.}

   {Ace on top of Discard Pile must be played first.}

   </i></font>EmptyAcePile <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
      if </b></font>PosTable <font color="#000080">[</font>Counter <font color="#000080">+ </font><font color="#800000">11</font><font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
         </b></font>EmptyAcePile <font color="#000080">:= </font>TRUE<font color="#000080">;

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>EmptyAcePile <font color="#FF0000"><b>AND </b></font>Valid<font color="#000080">) </font><font color="#FF0000"><b>then
      for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do begin
         if </b></font><font color="#000080">((</font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>Counter <font color="#000080">+ </font><font color="#800000">15</font><font color="#000080">]) = </font><font color="#800000">1</font><font color="#000080">)
           </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt;&gt; (</font>Counter <font color="#000080">+ </font><font color="#800000">15</font><font color="#000080">))
           </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font>CardValue<font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">])=</font><font color="#800000">1</font><font color="#000080">))) </font><font color="#FF0000"><b>then
            </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font><font color="#FF0000"><b>NOT </b></font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable<font color="#000080">[</font>Counter<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">]) = </font><font color="#800000">1</font><font color="#000080">)
           </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt;&gt; (</font>Counter <font color="#000080">+ </font><font color="#800000">7</font><font color="#000080">))
           </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font>CardValue<font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">])=</font><font color="#800000">1</font><font color="#000080">))) </font><font color="#FF0000"><b>then
           </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}

   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>EmptyAcePile <font color="#FF0000"><b>AND </b></font>Valid<font color="#000080">) </font><font color="#FF0000"><b>then
      for </b></font>Counter <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do begin
         if </b></font><font color="#000080">((</font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>Counter <font color="#000080">+ </font><font color="#800000">15</font><font color="#000080">]) = </font><font color="#800000">1</font><font color="#000080">)
           </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">= (</font>Counter <font color="#000080">+ </font><font color="#800000">15</font><font color="#000080">))
           </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>CardValue<font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">])=</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
            </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
            </font>MustMove <font color="#000080">:= </font>True<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for} {forces computer to play ace when
                   To/From scores below threshold}


   {Ace Piles Check}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>VALID <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&gt; </font><font color="#800000">11</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tto <font color="#000080">&lt; </font><font color="#800000">16</font><font color="#000080">))) </font><font color="#FF0000"><b>then begin
      </b></font>TopCard <font color="#000080">:= </font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>TopCard <font color="#000080">= </font>NULL<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) &lt;&gt; </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then
         </b></font>Valid <font color="#000080">:= </font>FALSE <font color="#008000"><i>{If placing non-ace on empty ace pile.}
      </i></font><font color="#FF0000"><b>else if </b></font>TopCard <font color="#000080">= </font>NULL <font color="#FF0000"><b>then
         </b></font>Valid <font color="#000080">:= </font>TRUE
      <font color="#FF0000"><b>else if </b></font>CardValue<font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
         </b></font>Valid <font color="#000080">:= </font>TRUE <font color="#008000"><i>{In all cases but as ace, joker is valid.}
      </i></font><font color="#FF0000"><b>else if </b></font><font color="#000080">((</font>TopCard <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) &lt;&gt; </font>CardValue <font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">])) </font><font color="#FF0000"><b>then
         </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{If it is not next card in series.}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

   {Discard Check}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Valid <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>ComputerTurn <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&lt; </font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tto <font color="#000080">&gt; </font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">19</font><font color="#000080">)
      </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">26</font><font color="#000080">))) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>ComputerTurn <font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tto <font color="#000080">&lt; </font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Tto <font color="#000080">&gt; </font><font color="#800000">7</font><font color="#000080">)
      </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">))))) </font><font color="#FF0000"><b>then
      if </b></font>PosTable <font color="#000080">[</font>Tto<font color="#000080">]^.</font>NumCards <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
         </b></font>Discard <font color="#000080">:= </font>TRUE<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>ComputerTurn <font color="#FF0000"><b>then
            For </b></font>Counter <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>do
               if </b></font>PosTable <font color="#000080">[</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
                  </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>Discard <font color="#000080">:= </font>FALSE<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
         </i></font><font color="#FF0000"><b>if NOT </b></font>ComputerTurn <font color="#FF0000"><b>then
            For </b></font>Counter <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>to </b></font><font color="#800000">11 </font><font color="#FF0000"><b>do
               if </b></font>PosTable <font color="#000080">[</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
                  </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>Discard <font color="#000080">:= </font>FALSE<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{CheckMove}

{____________________________________________________________________
|  GetMove
|     Requested a proposal for a move from the player.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetMove <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>From<font color="#000080">, </font>Tto<font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>FromChar<font color="#000080">, </font>ToChar<font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Display<font color="#000080">;
   </font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">'Enter positions'</font><font color="#000080">);
   </font>ColorDim<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">'(@ to Quit)'</font><font color="#000080">);
   </font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">,</font><font color="#800000">'Move a card'</font><font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">'from: '</font><font color="#000080">);
   </font>readln <font color="#000080">(</font>FromChar<font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">'to: '</font><font color="#000080">);
   </font>readln <font color="#000080">(</font>ToChar<font color="#000080">);
   </font>From <font color="#000080">:= </font>ord<font color="#000080">(</font>UpCase<font color="#000080">(</font>FromChar<font color="#000080">)) - </font><font color="#800000">64</font><font color="#000080">;
   </font>Tto <font color="#000080">:= </font>ord<font color="#000080">(</font>UpCase<font color="#000080">(</font>ToChar<font color="#000080">)) - </font><font color="#800000">64</font><font color="#000080">;

   </font><font color="#008000"><i>{-64 to adjust for alphabet's position in ASCII table.}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>From <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Tto <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{quit}
      </i></font>ColorNormalText<font color="#000080">;
      </font>clrscr<font color="#000080">;
      </font>HALT<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>From <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Tto <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>From <font color="#000080">&gt; </font><font color="#800000">26</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
      </b></font>From <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>Tto <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{GetMove}

{____________________________________________________________________
|  ResultsofCheck
|     Displays a message regarding the results of the check in
|     CheckMove.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>procedure </b></font>ResultsofCheck<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>DrawMessageBox <font color="#000080">(</font>ComputerTurn<font color="#000080">);    </font><font color="#008000"><i>{Calls the DrawMessageBox procedure}
   </i></font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">17</font><font color="#000080">,</font><font color="#800000">'Proposed Move:'</font><font color="#000080">);
   </font>GotoXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">);
   </font>write <font color="#000080">(</font><font color="#800000">'From: '</font><font color="#000080">,</font>chr<font color="#000080">(</font>From <font color="#000080">+ </font><font color="#800000">64</font><font color="#000080">));
   </font>GotoXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">19</font><font color="#000080">);
   </font>write <font color="#000080">(</font><font color="#800000">'To: '</font><font color="#000080">,</font>chr<font color="#000080">(</font>Tto <font color="#000080">+ </font><font color="#800000">64</font><font color="#000080">));
   </font>GotoXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">);
   </font><font color="#FF0000"><b>if NOT </b></font>Valid <font color="#FF0000"><b>then begin
      </b></font>TextColor <font color="#000080">(</font>WHITE<font color="#000080">+</font>BLINK<font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Is NOT Valid!!'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end
   else begin
      </b></font>TextColor <font color="#000080">(</font>WHITE<font color="#000080">);
      </font>write <font color="#000080">(</font><font color="#800000">'Is Valid.'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if else}
   </i></font>TextColor <font color="#000080">(</font>RED<font color="#000080">+</font>BLINK<font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">,</font><font color="#800000">'Press &lt;Enter&gt;...'</font><font color="#000080">);
   </font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ResultsofCheck}

{_____________________________________________________________________
|    PlayAgainBox
|     Displays Box and asks player if he/she wants to play again
|_____________________________________________________________________}
</i></font><font color="#FF0000"><b>procedure </b></font>PlayAgainBox<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 </b></font>ColorNormalText<font color="#000080">;
 </font>clrscr<font color="#000080">;
 </font>DrawTitleBox<font color="#000080">;
 </font>ColorNormalText<font color="#000080">;
 </font>OutString <font color="#000080">(</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">'Would you like to play again?'</font><font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">37</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>LightRed<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">38</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">'Y '</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>white<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">40</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">'or '</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>lightRed<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">);
 </font>TextColor <font color="#000080">(</font>white<font color="#000080">);
 </font>OutString <font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{____________________________________________________________________
|  GameOverDisplay
|     Notifies player that the game is over, displays who won, and
|     asks the player if he/she would like to play again.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>GameOverDisplay <font color="#000080">(</font>Winner<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Response<font color="#000080">: </font>char<font color="#000080">;
    </font>Valid<font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>ColorNormalText<font color="#000080">;
   </font>clrscr<font color="#000080">;
   </font>DrawTitleBox<font color="#000080">;
   </font>ColorNormalText<font color="#000080">;
   </font>OutString <font color="#000080">(</font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">'Game Over!!'</font><font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">'The '</font><font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font>Winner<font color="#000080">);
   </font>OutString <font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">,  </font><font color="#800000">' wins!'</font><font color="#000080">);
   </font>readln<font color="#000080">;
   </font><font color="#008000"><i>{Play Again?}
   </i></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
      </b></font>PlayAgainBox<font color="#000080">;
      </font>readln <font color="#000080">(</font>Response<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Upcase <font color="#000080">(</font>Response<font color="#000080">) = </font><font color="#800000">'Y'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>AnotherGame <font color="#000080">:= </font>TRUE<font color="#000080">;
         </font>Valid <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
      if </b></font><font color="#000080">(</font>Upcase <font color="#000080">(</font>Response<font color="#000080">) = </font><font color="#800000">'N'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>AnotherGame <font color="#000080">:= </font>FALSE<font color="#000080">;
         </font>Valid <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font><font color="#FF0000"><b>end
      else
      </b></font>Valid <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font>Valid<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function AnotherGame}

{___________________________________________________________________
|  SetUp
|     One of Decision's evaluative functions.
|     This function adds a negative weight if a play will result in
|     setting up the player to play from his/her score pile.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>Function </b></font>SetUp<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const
   </b></font>WEIGHT <font color="#000080">= -</font><font color="#800000">20</font><font color="#000080">;
   </font>SWEIGHT <font color="#000080">=-</font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>position<font color="#000080">: </font>integer<font color="#000080">;
   </font>Points<font color="#000080">: </font>integer<font color="#000080">;
   </font>CardCanPlay<font color="#000080">: </font>integer<font color="#000080">;
   </font>ScoreCard<font color="#000080">: </font>integer<font color="#000080">;
   </font>CardPlayed<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>ScoreCard <font color="#000080">:= </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]);
   </font>CardPlayed <font color="#000080">:= </font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>CardCanPlay <font color="#000080">:= </font>CardPlayed <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>CardCanPlay  <font color="#000080">= </font>ScoreCard <font color="#FF0000"><b>then begin
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>position <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do begin
         if </b></font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>position<font color="#000080">]) = </font>ScoreCard <font color="#FF0000"><b>then
            </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>position <font color="#000080">= </font>From <font color="#FF0000"><b>then
            if </b></font>CardValue <font color="#000080">(</font>PosTable <font color="#000080">[</font>position<font color="#000080">]^.</font>SeeRandom<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)) = </font>ScoreCard <font color="#FF0000"><b>then
               </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Points <font color="#000080">= </font>WEIGHT<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">= </font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Points <font color="#000080">:= </font>SWEIGHT<font color="#000080">;

   </font>SetUp <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function SetUp}

{___________________________________________________________________
|  Block
|    One of Decision's evaluative functions.
|    This function adds a positive weight if the play results in
|    preventing the player from playing from his score pile.
|__________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Block<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const
   </b></font>WEIGHT <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>Points<font color="#000080">: </font>integer<font color="#000080">;
   </font>ScoreCard<font color="#000080">: </font>integer<font color="#000080">;
   </font>CardPlayed<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>ScoreCard <font color="#000080">:= </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]);
   </font>CardPlayed <font color="#000080">:= </font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>CardPlayed <font color="#000080">= </font>ScoreCard <font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
   </font>Block <font color="#000080">:= </font>points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Block}

{___________________________________________________________________
|  PlayMore
|    One of Decision's evaluative functions.
|    This function adds a positive weight if a play results in the
|    computer being able to play more cards.
|    It also adds a positive weight if a play allows the computer to
|    move a card.
|___________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>PlayMore<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const
   </b></font>WEIGHT <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;  </font><font color="#008000"><i>{If move allows the computer to move more cards.}
   </i></font>WEIGHT2 <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">; </font><font color="#008000"><i>{If Computer can move a card.}
</i></font><font color="#FF0000"><b>var
   </b></font>position<font color="#000080">: </font>integer<font color="#000080">;
   </font>Points<font color="#000080">: </font>integer<font color="#000080">;
   </font>CardCanPlay<font color="#000080">: </font>integer<font color="#000080">;
   </font>CardPlayed<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font>WEIGHT2<font color="#000080">; </font><font color="#008000"><i>{Just for being able to play a card.}
   </i></font>CardPlayed <font color="#000080">:= </font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>CardCanPlay <font color="#000080">:= </font>CardPlayed <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

   </font>position <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Position <font color="#000080">&lt; </font><font color="#800000">27</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      if </b></font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>position<font color="#000080">]) = </font>CardCanPlay <font color="#FF0000"><b>then
         </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>position <font color="#000080">= </font>From <font color="#FF0000"><b>then
         if </b></font>CardValue<font color="#000080">(</font>PosTable <font color="#000080">[</font>position<font color="#000080">]^.</font>SeeRandom <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)) = </font>CardCanPlay <font color="#FF0000"><b>then
            </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
      </font>position <font color="#000080">:= </font>position <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}

        {Special case for Jokers}
   </i></font><font color="#FF0000"><b>If </b></font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>Points <font color="#000080">- </font>WEIGHT<font color="#000080">;
   </font>PlayMore <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function PlayMore}

{____________________________________________________________________
|  MoreCards
|     One of Decision's evaluative functions
|     This function adds weight to a play that will result in the
|     computer being able to pick up more cards at the beginning of
|     its next turn.  Additional weight is given to a play that will
|     result in the computer being able to pick up 5 more cards this
|     turn.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>MoreCards<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>WEIGHT <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
      </font>WEIGHT2 <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>HolestoFill<font color="#000080">: </font>integer<font color="#000080">;
    </font>Counter<font color="#000080">: </font>integer<font color="#000080">;
    </font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

               </font><font color="#008000"><i>{creates empty discard pile, ie a hole to fill}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>From <font color="#000080">&gt;</font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt;</font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>PosTable <font color="#000080">[</font>From<font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>CardValue<font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;

             </font><font color="#008000"><i>{takes into account the holes}
   </i></font>HolestoFill <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>From <font color="#000080">&gt; </font><font color="#800000">19</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>From <font color="#000080">&lt; </font><font color="#800000">26 </font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>Counter <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>do begin
         If </b></font>PosTable <font color="#000080">[</font>Counter<font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            </b></font>HolestoFill <font color="#000080">:= </font>HolestoFill <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
      </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ComputerHand<font color="#000080">.</font>NumCards <font color="#000080">- </font>HolestoFill<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          </b></font>Points <font color="#000080">:= </font>WEIGHT2<font color="#000080">;

                 </font><font color="#008000"><i>{special case for Jokers}
      </i></font><font color="#FF0000"><b>If </b></font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          </b></font>Points <font color="#000080">:= </font>Points <font color="#000080">- </font>WEIGHT<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
   </i></font>MoreCards <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{MoreCards}

{_____________________________________________________________________
|  HelpScore
|     One of Decision's evaluative functions
|     This function will add positive weight to a play that results
|     in the computer being able to play from its score pile.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>HelpScore<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>WEIGHT <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>ScoreCard<font color="#000080">: </font>integer<font color="#000080">;
    </font>CardPlayed<font color="#000080">: </font>integer<font color="#000080">;
    </font>CardCanPlay<font color="#000080">: </font>integer<font color="#000080">;
    </font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>ScoreCard <font color="#000080">:= </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">26</font><font color="#000080">]);
   </font>CardPlayed <font color="#000080">:= </font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>CardCanPlay <font color="#000080">:= </font>CardPlayed <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>CardCanPlay  <font color="#000080">= </font>ScoreCard <font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
   </font>HelpScore <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function HelpScore}

{_____________________________________________________________________
|  Score
|     One of Decision's evaluative functions.
|     This function adds positive weight to a score pile play.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Score<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>WEIGHT <font color="#000080">= </font><font color="#800000">60</font><font color="#000080">;
      </font>WEIGHT2 <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>ScoreCard<font color="#000080">: </font>integer<font color="#000080">;
    </font>position<font color="#000080">: </font>integer<font color="#000080">;
    </font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>From <font color="#000080">= </font><font color="#800000">26 </font><font color="#FF0000"><b>then begin
   </b></font>ScoreCard <font color="#000080">:= </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">26</font><font color="#000080">]);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(((</font>AceTopCard <font color="#000080">(</font>Tto<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) = </font>ScoreCard<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>ScoreCard <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
         </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ScoreCard <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) = </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">])) </font><font color="#FF0000"><b>then begin
            </b></font>Points <font color="#000080">:= </font>WEIGHT2<font color="#000080">;
            </font>position <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
            </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>position <font color="#000080">&lt; </font><font color="#800000">26</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
               </b></font>position <font color="#000080">:= </font>position <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>TopCardTable <font color="#000080">[</font>position<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)  </font><font color="#FF0000"><b>OR
                   </b></font><font color="#000080">(</font>TopCardTable <font color="#000080">[</font>position<font color="#000080">] = (</font>ScoreCard <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">))) </font><font color="#FF0000"><b>then
                   </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{While}
         </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
 </i></font>Score <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function Score}

{_____________________________________________________________________
|  SameScore
|     One of DiscardDecision's evaluative functions
|     This function adds a negative weight to a discard
|     of a card that is the same value as the computer's score
|     pile.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>SameScore<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>WEIGHT <font color="#000080">= -</font><font color="#800000">5</font><font color="#000080">;
      </font>JWEIGHT <font color="#000080">= -</font><font color="#800000">20</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>CardValue<font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">]) = </font>CardValue <font color="#000080">(</font>TopCardTable<font color="#000080">[</font><font color="#800000">26</font><font color="#000080">])) </font><font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>WEIGHT<font color="#000080">;

             </font><font color="#008000"><i>{special case for Jokers}
   </i></font><font color="#FF0000"><b>If </b></font>CardValue <font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>JWEIGHT<font color="#000080">;

   </font>SameScore <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function SameScore}

{_____________________________________________________________________
|  Order
|     One of DecisionDiscard's evaluative functions
|     This function uses weights to prioritize a discard to the closest
|     possible lower value in relation to the top cards of the discard
|     piles.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>Order<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>WEIGHT1 <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;
      </font>WEIGHT2 <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
      </font>WEIGHT3 <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
      </font>WEIGHT4 <font color="#000080">= -</font><font color="#800000">5</font><font color="#000080">;
      </font>JWEIGHT <font color="#000080">= -</font><font color="#800000">20</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>next<font color="#000080">: </font>CardVal_t<font color="#000080">;
    </font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin

   </b></font>next <font color="#000080">:= </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>Tto<font color="#000080">]) - </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) = </font>next<font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Points <font color="#000080">:= </font>WEIGHT1<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) + </font><font color="#800000">1</font><font color="#000080">) = </font>next<font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Points <font color="#000080">:= </font>WEIGHT2<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>CardValue <font color="#000080">(</font>TopCardTable<font color="#000080">[</font>From<font color="#000080">]) + </font><font color="#800000">1</font><font color="#000080">) &lt; </font>next<font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Points <font color="#000080">:= </font>WEIGHT3<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) &gt; </font>next<font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Points <font color="#000080">:= </font>WEIGHT4<font color="#000080">;

      </font><font color="#008000"><i>{special case for Jokers}
   </i></font><font color="#FF0000"><b>if </b></font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Points <font color="#000080">:= </font>JWEIGHT<font color="#000080">;

   </font>Order <font color="#000080">:= </font>Points<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Order}

{_____________________________________________________________________
|  HighCard
|     One of DecisionDiscard's evaluative functions.
|        This function weights the possible cards to fill in a space
|        in the discard piles.  It adds most weight to the highest
|        valued card.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>function </b></font>HighCard<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>count<font color="#000080">, </font>Points<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Points <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>PosTable <font color="#000080">[</font><font color="#800000">16</font><font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>PosTable <font color="#000080">[</font><font color="#800000">17</font><font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
      </b></font><font color="#000080">(</font>PosTable <font color="#000080">[</font><font color="#800000">18</font><font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>PosTable <font color="#000080">[</font><font color="#800000">19</font><font color="#000080">]^.</font>NumCards <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      for </b></font>count <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do
         if </b></font><font color="#000080">(</font>CardValue<font color="#000080">(</font>TopCardTable <font color="#000080">[</font>From<font color="#000080">]) &gt;
            </font>CardValue <font color="#000080">(</font>TopCardTable <font color="#000080">[</font>count<font color="#000080">])) </font><font color="#FF0000"><b>then
            </b></font>Points <font color="#000080">:= </font>Points <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font>HighCard <font color="#000080">:= </font>Points <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{function HighCard}

{_____________________________________________________________________
|  DiscardDecision
|     This procedure is responsible for applying the various weights
|     on to the decision surrounding the computer's discard.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>DiscardDecision <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>From<font color="#000080">, </font>Tto<font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>max<font color="#000080">: </font>integer<font color="#000080">;
    </font>f<font color="#000080">, </font>t<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin

   For </b></font>f <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>Do
      For </b></font>t <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>Do begin
         </b></font>From <font color="#000080">:= </font>f<font color="#000080">;
         </font>Tto <font color="#000080">:= </font>t<font color="#000080">;
      </font>CheckMove <font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);
      </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>Valid<font color="#000080">) </font><font color="#FF0000"><b>Then
         </b></font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] := -</font><font color="#800000">10000
      </font><font color="#FF0000"><b>Else
         </b></font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] := ((</font>HighCard<font color="#000080">) + (</font>Order<font color="#000080">) + (</font>SameScore<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}

   </i></font>From <font color="#000080">:= </font><font color="#800000">20</font><font color="#000080">;
   </font>Tto <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
   </font>max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>f <font color="#000080">:= </font><font color="#800000">20 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>Do
      For </b></font>t <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>Do  begin
         If </b></font><font color="#000080">(</font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] &gt; </font>ChoiceRate<font color="#000080">[</font>From<font color="#000080">, </font>Tto<font color="#000080">]) </font><font color="#FF0000"><b>Then  begin
            </b></font>max <font color="#000080">:= </font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">];
            </font>From <font color="#000080">:= </font>f<font color="#000080">;
            </font>Tto <font color="#000080">:= </font>t<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{DiscardDecision}

{_____________________________________________________________________
|  Decision
|     This procedure is responsible for applying the weights to the
|     decision surrounding the computer's choice of moves.
|____________________________________________________________________}

</i></font><font color="#FF0000"><b>Procedure </b></font>Decision <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>From<font color="#000080">, </font>Tto<font color="#000080">: </font>integer<font color="#000080">);

</font><font color="#FF0000"><b>const </b></font>Threshold <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Max<font color="#000080">: </font>integer<font color="#000080">;
    </font>f<font color="#000080">, </font>t<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Display<font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>f <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do
      For </b></font>t <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">19 </font><font color="#FF0000"><b>do
         </b></font>ChoiceRate <font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;

   </font><font color="#FF0000"><b>For </b></font>f <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>Do
      For </b></font>t <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>Do begin
         </b></font>From <font color="#000080">:= </font>f<font color="#000080">;
         </font>Tto <font color="#000080">:= </font>t<font color="#000080">;
         </font>CheckMove<font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);
         </font><font color="#FF0000"><b>If Not </b></font><font color="#000080">(</font>Valid<font color="#000080">) </font><font color="#FF0000"><b>Then
            </b></font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] := -</font><font color="#800000">10000
         </font><font color="#FF0000"><b>Else
            </b></font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] := ((</font>SetUp<font color="#000080">) + (</font>Block<font color="#000080">) +
            (</font>PlayMore<font color="#000080">) + (</font>MoreCards<font color="#000080">) + (</font>HelpScore<font color="#000080">) + (</font>Score<font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}

   {Tests Threshold}
   </i></font>From <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
   </font>Tto <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
   </font>max <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>f <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>Do
      For </b></font>t <font color="#000080">:= </font><font color="#800000">12 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>Do  begin
         If </b></font><font color="#000080">(</font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">] &gt; </font>ChoiceRate<font color="#000080">[</font>From<font color="#000080">, </font>Tto<font color="#000080">]) </font><font color="#FF0000"><b>Then  begin
            </b></font>max <font color="#000080">:= </font>ChoiceRate<font color="#000080">[</font>f<font color="#000080">, </font>t<font color="#000080">];
            </font>From <font color="#000080">:= </font>f<font color="#000080">;
            </font>Tto <font color="#000080">:= </font>t<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for}
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Max <font color="#000080">&lt; </font>Threshold<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font>MustMove<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>DiscardDecision <font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{Decision}

{============================================================================
                                 MAIN PROGRAM
============================================================================}


</i></font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Main Program}
   </i></font><font color="#FF0000"><b>Repeat
      </b></font>TitleScreen <font color="#000080">(</font>TwoPlayer<font color="#000080">);
      </font>Initialize<font color="#000080">;
      </font>Deal<font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Game<font color="#000080">) </font><font color="#FF0000"><b>Do begin
            </b></font>WhoseTurn <font color="#000080">(</font>ComputerTurn<font color="#000080">);
            </font>PickupCards<font color="#000080">;
            </font><font color="#FF0000"><b>Repeat
                  If </b></font><font color="#000080">((</font>ComputerTurn<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>TwoPlayer<font color="#000080">)) </font><font color="#FF0000"><b>Then
                      </b></font>Decision <font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">)
                  </font><font color="#FF0000"><b>Else
                      </b></font>GetMove <font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);
                  </font>CheckMove<font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);
                  </font>ResultsofCheck<font color="#000080">;
                  </font><font color="#FF0000"><b>If </b></font>Valid <font color="#FF0000"><b>then
                     </b></font>MoveCard <font color="#000080">(</font>From<font color="#000080">, </font>Tto<font color="#000080">);
            </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Discard<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{While Loop}
      </i></font>GameOverDisplay <font color="#000080">(</font>Winner<font color="#000080">);
   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>AnotherGame<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{Main Program}


</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0194.PAS">Original</a><b>]</b></p></body>
</html>
