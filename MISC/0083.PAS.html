<html>
<head><title> "Checkbook Number" by WAYNE MOSES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: WAYNE MOSES
Subj: Spell a Number
---------------------------------------------------------------------------
 *&gt; Quoting Chris Serino to All on 01-04-94  17:28
 *&gt; Re: Help Looking for a Number

 Hello Chris:

 CS&gt; I'm in the process of writing a Checkbook program for my Job and I
 CS&gt; was  wondering if anyone out there has a routine to convert a check
 CS&gt; amount written  in numerical to text.  Here's an example of what I
 CS&gt; need. Input Variable :  142.50
 CS&gt; Needed Output  : One Hundred Foury Two 50/100--------------------

 Weeeelllll ... since I am not really interested in releasing my personal
 check writing program to the world, I'll upload what I wrote last month.

 ------- 8&lt; ------------[ CUT LINE ]-------------- &gt;8 -------
}
</i></font><font color="#FF0000"><b>Function </b></font>Translate<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>DollarAmt <font color="#000080">: </font>real<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>(*
   This is a module that converts the numerical dollar amount to a string,
   for example it converts $156.15 to :

               'One Hundred and Fifty Six dollars ------------15/xx'.

   The field length of the translated amount is limited to 53 characters.

   Amounts up to and including $99,999.99 are supported.  I rarely write
   cheques larger than that, so they can be written by hand. ;-)

   ======================================================================
   Dedicated to the PUBLIC DOMAIN, this software code has been tested and
   used under TP 6.0/DOS and MS-DOS 6.2.
   ======================================================================
*)

</i></font><font color="#FF0000"><b>const
     </b></font>SingleSpelled <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (</font><font color="#800000">'One '</font><font color="#000080">,</font><font color="#800000">'Two '</font><font color="#000080">,</font><font color="#800000">'Three '</font><font color="#000080">,</font><font color="#800000">'Four '</font><font color="#000080">,
                                              </font><font color="#800000">'Five '</font><font color="#000080">,</font><font color="#800000">'Six '</font><font color="#000080">,</font><font color="#800000">'Seven '</font><font color="#000080">,</font><font color="#800000">'Eight '</font><font color="#000080">,
                                              </font><font color="#800000">'Nine '</font><font color="#000080">);

     </font>TeenSpelled <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (</font><font color="#800000">'Eleven '</font><font color="#000080">,</font><font color="#800000">'Twelve '</font><font color="#000080">,</font><font color="#800000">'Thirteen '</font><font color="#000080">,
                                            </font><font color="#800000">'Fourteen '</font><font color="#000080">,</font><font color="#800000">'Fifteen '</font><font color="#000080">,</font><font color="#800000">'Sixteen '</font><font color="#000080">,
                                            </font><font color="#800000">'Seventeen '</font><font color="#000080">,</font><font color="#800000">'Eighteen '</font><font color="#000080">,</font><font color="#800000">'Nineteen'</font><font color="#000080">);

     </font>TenSpelled <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of string </b></font><font color="#000080">= (</font><font color="#800000">'Ten '</font><font color="#000080">,</font><font color="#800000">'Twenty '</font><font color="#000080">,</font><font color="#800000">'Thirty '</font><font color="#000080">,</font><font color="#800000">'Forty '</font><font color="#000080">,
                                           </font><font color="#800000">'Fifty '</font><font color="#000080">,</font><font color="#800000">'Sixty '</font><font color="#000080">,</font><font color="#800000">'Seventy '</font><font color="#000080">,</font><font color="#800000">'Eighty'</font><font color="#000080">,
                                           </font><font color="#800000">'Ninety '</font><font color="#000080">);

</font><font color="#FF0000"><b>var
   </b></font>Dollars<font color="#000080">, </font>Cents<font color="#000080">,
   </font>SingleStr<font color="#000080">, </font>TenStr<font color="#000080">, </font>HundredStr<font color="#000080">, </font>ThousandStr   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>Singles<font color="#000080">, </font>Tens<font color="#000080">, </font>Hundreds<font color="#000080">, </font>Thousands<font color="#000080">, </font>k<font color="#000080">, </font>l     <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
     if </b></font>DollarAmt <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then         </b></font><font color="#008000"><i>(* The amount to be translated is 0.00 *)
     </i></font><font color="#FF0000"><b>begin                         </b></font><font color="#008000"><i>(* so the Dollars and Cents must be    *)
          </i></font>Dollars <font color="#000080">:= </font><font color="#800000">'Zero '</font><font color="#000080">;      </font><font color="#008000"><i>(* to reflect this.                    *)
          </i></font>Cents   <font color="#000080">:= </font><font color="#800000">'00'</font><font color="#000080">;
     </font><font color="#FF0000"><b>end

     else
     begin                         </b></font><font color="#008000"><i>(* Non trivial value for DollarAmt     *)

     </i></font>SingleStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>TenStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>HundredStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>ThousandStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

     </font><font color="#008000"><i>{ Parse the Cents out of DollarAmt }

     </i></font>Str<font color="#000080">(</font>frac<font color="#000080">(</font>DollarAmt<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font>Cents<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>frac<font color="#000080">(</font>DollarAmt<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Cents <font color="#000080">:= </font>copy<font color="#000080">(</font>Cents<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Cents<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)
     </font><font color="#FF0000"><b>else
         </b></font>Cents <font color="#000080">:= </font><font color="#800000">'00'</font><font color="#000080">;

     </font><font color="#008000"><i>{ Next parse the Dollars out of DollarAmt }

     </i></font>Str<font color="#000080">(</font>int<font color="#000080">(</font>DollarAmt<font color="#000080">):</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">, </font>Dollars<font color="#000080">);

     </font><font color="#008000"><i>{ Now, define the number of Singles, Tens, Hundreds, and Thousands }

     </i></font>Thousands   <font color="#000080">:= </font>trunc<font color="#000080">(</font>DollarAmt<font color="#000080">/</font><font color="#800000">1000</font><font color="#000080">);

     </font>Hundreds    <font color="#000080">:= </font>trunc<font color="#000080">(</font>DollarAmt<font color="#000080">/</font><font color="#800000">100</font><font color="#000080">)-</font>Thousands<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">;
     </font>HundredStr  <font color="#000080">:= </font>SingleSpelled<font color="#000080">[</font>Hundreds<font color="#000080">];

     </font>Tens        <font color="#000080">:= </font>trunc<font color="#000080">(</font>DollarAmt<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)-(</font>Thousands<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">+</font>Hundreds<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">);

     </font>Singles     <font color="#000080">:= </font>trunc<font color="#000080">(</font>DollarAmt<font color="#000080">)-(</font>Thousands<font color="#000080">*</font><font color="#800000">1000</font><font color="#000080">+</font>Hundreds<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">+</font>Tens<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">);
     </font>SingleStr   <font color="#000080">:= </font>SingleSpelled<font color="#000080">[</font>Singles<font color="#000080">];

     </font><font color="#FF0000"><b>case </b></font>Tens <font color="#FF0000"><b>of
     </b></font><font color="#800000">1    </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                 </b></font>TenStr <font color="#000080">:= </font>TeenSpelled<font color="#000080">[</font>Singles<font color="#000080">];
                 </font>SingleStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#800000">2</font><font color="#000080">..</font><font color="#800000">9 </font><font color="#000080">: </font>TenStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>Tens<font color="#000080">];
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>case </b></font>Thousands <font color="#FF0000"><b>of
     </b></font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,
     </font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">,
     </font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">70</font><font color="#000080">,
     </font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">90  </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)];
     </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">];
     </font><font color="#800000">11</font><font color="#000080">..</font><font color="#800000">19 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TeenSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">10</font><font color="#000080">];

     </font><font color="#800000">21</font><font color="#000080">..</font><font color="#800000">29 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">20</font><font color="#000080">];
     </font><font color="#800000">31</font><font color="#000080">..</font><font color="#800000">39 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">30</font><font color="#000080">];
     </font><font color="#800000">41</font><font color="#000080">..</font><font color="#800000">49 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">40</font><font color="#000080">];
     </font><font color="#800000">51</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">50</font><font color="#000080">];
     </font><font color="#800000">61</font><font color="#000080">..</font><font color="#800000">69 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">60</font><font color="#000080">];
     </font><font color="#800000">71</font><font color="#000080">..</font><font color="#800000">79 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">70</font><font color="#000080">];
     </font><font color="#800000">81</font><font color="#000080">..</font><font color="#800000">89 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">80</font><font color="#000080">];
     </font><font color="#800000">91</font><font color="#000080">..</font><font color="#800000">99 </font><font color="#000080">: </font>ThousandStr <font color="#000080">:= </font>TenSpelled<font color="#000080">[</font>trunc<font color="#000080">(</font>Thousands<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)]+
                             </font>SingleSpelled<font color="#000080">[</font>Thousands<font color="#000080">-</font><font color="#800000">90</font><font color="#000080">];
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>if </b></font>Thousands <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Dollars <font color="#000080">:= </font>ThousandStr<font color="#000080">+</font><font color="#800000">'Thousand '</font><font color="#000080">+</font>HundredStr<font color="#000080">+</font><font color="#800000">'Hundred &amp; '
                   </font><font color="#000080">+ </font>TenStr <font color="#000080">+ </font>SingleStr
     <font color="#FF0000"><b>else
     if </b></font><font color="#000080">(</font>Hundreds <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Thousands <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>Dollars <font color="#000080">:= </font>HundredStr<font color="#000080">+</font><font color="#800000">'Hundred and '</font><font color="#000080">+ </font>TenStr <font color="#000080">+ </font>SingleStr
     <font color="#FF0000"><b>else
         </b></font>Dollars <font color="#000080">:= </font>TenStr <font color="#000080">+ </font>SingleStr<font color="#000080">;

     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                              </font><font color="#008000"><i>(* End of block for non-trivial    *)
                                       (* value for DollarAmt             *)
     </i></font>l <font color="#000080">:= </font>length<font color="#000080">(</font>Dollars<font color="#000080">);

     </font><font color="#FF0000"><b>for </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">60</font><font color="#000080">-(</font><font color="#800000">10</font><font color="#000080">+</font>l<font color="#000080">+</font>length<font color="#000080">(</font>Cents<font color="#000080">)) </font><font color="#FF0000"><b>do
         </b></font>Dollars <font color="#000080">:= </font>Dollars<font color="#000080">+</font><font color="#800000">'-'</font><font color="#000080">;

     </font><font color="#FF0000"><b>If </b></font>Thousands <font color="#000080">&lt; </font><font color="#800000">100 </font><font color="#FF0000"><b>then
        </b></font>Translate <font color="#000080">:= </font>Dollars<font color="#000080">+</font>Cents<font color="#000080">+</font><font color="#800000">'/xx'
     </font><font color="#FF0000"><b>else
         begin
         </b></font>TextColor<font color="#000080">(</font>Yellow<font color="#000080">+</font>Blink<font color="#000080">);
         </font>Translate <font color="#000080">:= </font><font color="#800000">'******** INVALID!  THIS AMOUNT NOT SUPPORTED ********'</font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0083.PAS">Original</a><b>]</b></p></body>
</html>
