<html>
<head><title> "EJect a CD-ROM" by TIMO SALMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>function </b></font>MSCDEXFN <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>f <font color="#000080">: </font>text<font color="#000080">;
    </font>i <font color="#000080">: </font>byte<font color="#000080">;
    </font>fmSave <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>mscdexfn <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                  </font><font color="#008000"><i>{ To indicate not found }
  </i></font>fmSave <font color="#000080">:= </font>FileMode<font color="#000080">;              </font><font color="#008000"><i>{ Store the original file mode }
  </i></font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                   </font><font color="#008000"><i>{ Also if read-only }
  </i></font>Assign <font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'r:\autoexec.bat'</font><font color="#000080">);   </font><font color="#008000"><i>{ Browse the AUTOEXEC.BAT }
  {$I-} </i></font>Reset <font color="#000080">(</font>f<font color="#000080">); </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;      </font><font color="#008000"><i>{ AUTOEXEC.BAT not found }
  </i></font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do begin        </b></font><font color="#008000"><i>{ Line by line }
    </i></font>readln <font color="#000080">(</font>f<font color="#000080">, </font>s<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>Upcase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>Pos<font color="#000080">(</font><font color="#800000">'MSCDEX'</font><font color="#000080">, </font>s<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin      </b></font><font color="#008000"><i>{ Is this the line }
      </i></font><font color="#FF0000"><b>if </b></font>Pos <font color="#000080">(</font><font color="#800000">'REM'</font><font color="#000080">, </font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>continue<font color="#000080">;  </font><font color="#008000"><i>{ Skip rem lines }
      </i></font>Close <font color="#000080">(</font>f<font color="#000080">);
      </font>FileMode <font color="#000080">:= </font>fmSave<font color="#000080">;          </font><font color="#008000"><i>{ Restore the original mode }
      </i></font>i <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'/D:'</font><font color="#000080">, </font>s<font color="#000080">);          </font><font color="#008000"><i>{ Look for the switch }
      </i></font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;          </font><font color="#008000"><i>{ Nah! }
      </i></font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">;                  </font><font color="#008000"><i>{ Where the name should start }
      </i></font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&gt; </font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;  </font><font color="#008000"><i>{ Nothing there! }
      </i></font>s <font color="#000080">:= </font>Copy <font color="#000080">(</font>s<font color="#000080">, </font>i<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);       </font><font color="#008000"><i>{ Rest of the line after /D: }
      </i></font>mscdexfn <font color="#000080">:= </font>s<font color="#000080">;
      </font>i <font color="#000080">:= </font>Pos <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>s<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
      </font>mscdexfn <font color="#000080">:= </font>Copy <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>exit<font color="#000080">;                        </font><font color="#008000"><i>{ Don't close twice }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{if}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{while}
  </i></font>Close <font color="#000080">(</font>f<font color="#000080">);
  </font>FileMode <font color="#000080">:= </font>fmSave<font color="#000080">;              </font><font color="#008000"><i>{ Restore the original mode }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>(* mscdexfn *)

   </i></font>All the best<font color="#000080">, </font>Timo

<font color="#000080">....................................................................
</font>Prof<font color="#000080">. </font>Timo Salmi   Co<font color="#000080">-</font>moderator <font color="#FF0000"><b>of </b></font>news<font color="#000080">:</font>comp<font color="#000080">.</font>archives<font color="#000080">.</font>msdos<font color="#000080">.</font>announce
Moderating at ftp<font color="#000080">:</font><font color="#008000"><i>// &amp; http://garbo.uwasa.fi archives  193.166.120.5
</i></font>Department <font color="#FF0000"><b>of </b></font>Accounting <font color="#FF0000"><b>and </b></font>Business Finance  <font color="#000080">; </font>University <font color="#FF0000"><b>of </b></font>Vaasa
ts<font color="#000080">@</font>uwasa<font color="#000080">.</font>fi http<font color="#000080">:</font><font color="#008000"><i>//uwasa.fi/~ts BBS 961-3170972; FIN-65101,  Finland

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p></body>
</html>
