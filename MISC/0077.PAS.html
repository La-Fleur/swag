<html>
<head><title> "String Timing Demo" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{$A+,B-,D-,E-,F-,I+,N-,O-,R-,S-,V+}

</i></font><font color="#FF0000"><b>program </b></font>TestStringComp<font color="#000080">;
</font><font color="#FF0000"><b>uses
  </b></font>TpTimer<font color="#000080">;         </font><font color="#008000"><i>(* TurboPower's public domain TpTimer unit.              *)

                   (* Run-Length-Encoded string compression.                *)
  </i></font><font color="#FF0000"><b>function </b></font>fustRLEcomp<font color="#000080">(</font>stIn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>byCount<font color="#000080">,
    </font>byStInSize<font color="#000080">,
    </font>byStTempPos <font color="#000080">: </font>byte<font color="#000080">;
    </font>woStInPos <font color="#000080">: </font>word<font color="#000080">;
    </font>stTemp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>stTemp<font color="#000080">, </font>sizeof<font color="#000080">(</font>stTemp<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
    </font>byCount  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>byStTempPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>woStInPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>byStInSize <font color="#000080">:= </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font><font color="#FF0000"><b>repeat
      if </b></font><font color="#000080">(</font>woStInPos <font color="#000080">&lt; </font>byStInSize<font color="#000080">)
      </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>stIn<font color="#000080">[</font>woStInPos<font color="#000080">] = </font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>woStInPos<font color="#000080">)])
      </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>byCount <font color="#000080">&lt; </font><font color="#800000">$7F</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>byCount<font color="#000080">)
      </font><font color="#FF0000"><b>else
        if </b></font><font color="#000080">(</font>byCount <font color="#000080">&gt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            </b></font>stTemp<font color="#000080">[</font>byStTempPos<font color="#000080">]       := </font><font color="#800000">#0</font><font color="#000080">;
            </font>stTemp<font color="#000080">[(</font>byStTempPos <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)] := </font>chr<font color="#000080">(</font>byCount<font color="#000080">);
            </font>stTemp<font color="#000080">[(</font>byStTempPos <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">)] := </font>stIn<font color="#000080">[</font>woStInPos<font color="#000080">];
            </font>inc<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">3</font><font color="#000080">);
            </font>inc<font color="#000080">(</font>byStTempPos<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
            </font>byCount <font color="#000080">:= </font><font color="#800000">1
          </font><font color="#FF0000"><b>end
        else
          begin
            </b></font>move<font color="#000080">(</font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>woStInPos <font color="#000080">- </font>byCount<font color="#000080">)],
                 </font>stTemp<font color="#000080">[</font>byStTempPos<font color="#000080">], </font>byCount<font color="#000080">);
            </font>inc<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>byCount<font color="#000080">);
            </font>inc<font color="#000080">(</font>byStTempPos<font color="#000080">, </font>byCount<font color="#000080">);
            </font>byCount <font color="#000080">:= </font><font color="#800000">1
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>inc<font color="#000080">(</font>woStInPos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>woStInPos <font color="#000080">&gt; </font>byStInSize<font color="#000080">);
    </font>fustRLEcomp <font color="#000080">:= </font>stTemp
  <font color="#FF0000"><b>end</b></font><font color="#000080">;


                   </font><font color="#008000"><i>(* Run-Length-Encoded string expansion.                  *)
  </i></font><font color="#FF0000"><b>function </b></font>fustRLEexp<font color="#000080">(</font>stIn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>byStInSize<font color="#000080">,
    </font>byStTempPos <font color="#000080">: </font>byte<font color="#000080">;
    </font>woStInPos <font color="#000080">: </font>word<font color="#000080">;
    </font>stTemp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>stTemp<font color="#000080">, </font>sizeof<font color="#000080">(</font>stTemp<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
    </font>byStInSize <font color="#000080">:= </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
    </font>byStTempPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>woStInPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      if </b></font><font color="#000080">(</font>stIn<font color="#000080">[</font>woStInPos<font color="#000080">] &lt;&gt; </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>stTemp<font color="#000080">[</font>byStTempPos<font color="#000080">] := </font>stIn<font color="#000080">[</font>woStInPos<font color="#000080">];
          </font>inc<font color="#000080">(</font>woStInPos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>byStTempPos<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">1</font><font color="#000080">)
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>fillchar<font color="#000080">(</font>stTemp<font color="#000080">[</font>byStTempPos<font color="#000080">], </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>woStInPos<font color="#000080">)]),
                   </font>stIn<font color="#000080">[(</font>woStInPos <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">)]);
          </font>inc<font color="#000080">(</font>byStTempPos<font color="#000080">, </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>woStInPos<font color="#000080">)]));
          </font>inc<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>woStInPos<font color="#000080">)]));
          </font>inc<font color="#000080">(</font>woStInPos<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">)
        </font><font color="#FF0000"><b>end
    until </b></font><font color="#000080">(</font>woStInPos <font color="#000080">&gt; </font>byStInSize<font color="#000080">);
    </font>fustRLEexp <font color="#000080">:= </font>stTemp
  <font color="#FF0000"><b>end</b></font><font color="#000080">;


                   </font><font color="#008000"><i>(* 8 bit into 7 bit string compression.                  *)
  </i></font><font color="#FF0000"><b>function </b></font>fustComp87<font color="#000080">(</font>stIn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>stTemp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>byLoop<font color="#000080">, </font>byTempSize<font color="#000080">, </font>byOffset <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt; </font><font color="#800000">#255</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>stIn<font color="#000080">[</font>succ<font color="#000080">(</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]))] := </font><font color="#800000">#0</font><font color="#000080">;
    </font>fillchar<font color="#000080">(</font>stTemp<font color="#000080">, </font>sizeof<font color="#000080">(</font>stTemp<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
    </font>byTempSize <font color="#000080">:= </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>byTempsize<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>byOffset <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>byLoop <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>byTempSize <font color="#FF0000"><b>do
      begin
        </b></font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$40</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">6</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$60</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">5</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$1F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$70</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$78</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$07</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7C</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$03</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">) +
               ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7E</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">) );
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>byOffset <font color="#000080">&lt; </font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">] :=
            </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">7</font><font color="#000080">) +
                 ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">8</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7F</font><font color="#000080">) )
        </font><font color="#FF0000"><b>else
          </b></font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">] :=
            </font>chr<font color="#000080">( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">7</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>byOffset<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(((</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">) * </font><font color="#800000">7</font><font color="#000080">) + (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">) );
    </font>fustComp87 <font color="#000080">:= </font>stTemp
  <font color="#FF0000"><b>end</b></font><font color="#000080">;


                   </font><font color="#008000"><i>(* 7 bit into 8 bit string expansion.                    *)
  </i></font><font color="#FF0000"><b>function </b></font>fustExp78<font color="#000080">(</font>stIn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>stTemp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>byOffset<font color="#000080">, </font>byTempSize<font color="#000080">, </font>byLoop <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>stTemp<font color="#000080">, </font>sizeof<font color="#000080">(</font>stTemp<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
    </font>byTempSize <font color="#000080">:= </font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>byTempSize<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>byOffset <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>byLoop <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>byTempSize <font color="#FF0000"><b>do
      begin
        </b></font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">] :=
          </font>chr<font color="#000080">( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">);
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>and  </b></font><font color="#800000">$01</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">) +
               ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$FC</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$03</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5</font><font color="#000080">) +
               ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$07</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) +
               ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) +
               ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">5</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">5</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$1F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">) +
               ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">6</font><font color="#000080">) );
        </font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">] :=
          </font>chr<font color="#000080">( ( ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">6</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3F</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) +
               ( </font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">7</font><font color="#000080">) );
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>byOffset <font color="#000080">&lt; </font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>stTemp<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">8</font><font color="#000080">) + </font><font color="#800000">8</font><font color="#000080">] :=
            </font>chr<font color="#000080">( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[(</font>byOffset <font color="#000080">* </font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">7</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7F</font><font color="#000080">) );
        </font>inc<font color="#000080">(</font>byOffset<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] :=
      </font>chr<font color="#000080">( ( (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">) * </font><font color="#800000">8</font><font color="#000080">) + (</font>ord<font color="#000080">(</font>stIn<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7</font><font color="#000080">) );
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>stTemp<font color="#000080">[</font>ord<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])] = </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>dec<font color="#000080">(</font>stTemp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">1</font><font color="#000080">);
    </font>fustExp78 <font color="#000080">:= </font>stTemp
  <font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>var
  </b></font>loStart<font color="#000080">, </font>loStop <font color="#000080">: </font>longint<font color="#000080">;

  </font>stMy1<font color="#000080">,
  </font>stMy2<font color="#000080">,
  </font>stMy3 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

                   </font><font color="#008000"><i>(* Main program execution block.                         *)
</i></font><font color="#FF0000"><b>BEGIN

                   </b></font><font color="#008000"><i>(* Test string 1.                                        *)
  </i></font>stMy1 <font color="#000080">:= </font><font color="#800000">'12345678901111111111123456789022222222221234567890' </font><font color="#000080">+
           </font><font color="#800000">'33333333331234567890444444444412345678905555555555' </font><font color="#000080">+
           </font><font color="#800000">'12345678906666666666123456789077777777771234567890' </font><font color="#000080">+
           </font><font color="#800000">'88888888881234567890999999999912345678900000000000' </font><font color="#000080">+
           </font><font color="#800000">'1234567890AAAAAAAAAA1234567890BBBBBBBBBB1234567890' </font><font color="#000080">+
           </font><font color="#800000">'CCCCC'</font><font color="#000080">;

                   </font><font color="#008000"><i>(* Test string 2.                                        *)
{ stMy1 := '12345678901234567890123456789012345678901234567890' +
           '12345678901234567890123456789012345678901234567890' +
           '12345678901234567890123456789012345678901234567890' +
           '12345678901234567890123456789012345678901234567890' +
           '12345678901234567890123456789012345678901234567890' +
           '12345'; }

                   (* Test string 3.                                        *)
{ stMy1 := '11111111111111111111111111111111111111111111111111' +
           '11111111111111111111111111111111111111111111111111' +
           '11111111111111111111111111111111111111111111111111' +
           '11111111111111111111111111111111111111111111111111' +
           '11111111111111111111111111111111111111111111111111' +
           '11111'; }

  </i></font>loStart <font color="#000080">:= </font>ReadTimer<font color="#000080">;
  </font>stMy2 <font color="#000080">:= </font>fustComp87<font color="#000080">(</font>fustRLEcomp<font color="#000080">(</font>stMy1<font color="#000080">));
  </font>loStop <font color="#000080">:= </font>ReadTimer<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">' Time to compress = '</font><font color="#000080">, </font>ElapsedTimeString<font color="#000080">(</font>loStart<font color="#000080">, </font>loStop<font color="#000080">), </font><font color="#800000">' ms'</font><font color="#000080">);
  </font>loStart <font color="#000080">:= </font>ReadTimer<font color="#000080">;
  </font>stMy3 <font color="#000080">:= </font>fustRLEexp<font color="#000080">(</font>fustExp78<font color="#000080">(</font>stMy2<font color="#000080">));
  </font>loStop <font color="#000080">:= </font>ReadTimer<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">' Time to expand   = '</font><font color="#000080">, </font>ElapsedTimeString<font color="#000080">(</font>loStart<font color="#000080">, </font>loStop<font color="#000080">), </font><font color="#800000">' ms'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font>stMy1<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font>stMy2<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font>stMy3<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>stMy1 <font color="#000080">&lt;&gt; </font>stMy3<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>writeln<font color="#000080">(</font><font color="#800000">' Conversion Error'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>writeln<font color="#000080">(</font><font color="#800000">' Conversion Match'</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
