<html>
<head><title> "BBS Tagline Manager" by MIKE COPELAND</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0181.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 GC&gt; Does anyone know how to make a Pascal program to sort a file and
 GC&gt; then remove the duplicates and choose a random line ??  I need this for
 GC&gt; my tagline file and need some type of program to do this.  Thanks!

   Here's a start for you:
}
</i></font><font color="#FF0000"><b>program </b></font>TagLines_Manager<font color="#000080">;               </font><font color="#008000"><i>{ TagLines Manager  MRCopeland 950906}
{$M 32768,0,655000}
</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">,</font>DOS<font color="#000080">,</font>FastTTT5<font color="#000080">,</font>WinTTT5<font color="#000080">,</font>RPU1<font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>VERSION <font color="#000080">= </font><font color="#800000">'1.2.4'</font><font color="#000080">;
     </font>TLIM    <font color="#000080">= </font><font color="#800000">10000</font><font color="#000080">;                                        </font><font color="#008000"><i>{ TagLines Limit
}     </i></font>CLIM    <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;                                   </font><font color="#008000"><i>{ Comment records Limit
}</i></font><font color="#FF0000"><b>type
     </b></font>S80     <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
     </font>LLPTR   <font color="#000080">= ^</font>S80<font color="#000080">;
</font><font color="#FF0000"><b>var
    </b></font>I<font color="#000080">, </font>J<font color="#000080">, </font>K  <font color="#000080">: </font>integer<font color="#000080">;
    </font>TX<font color="#000080">,</font>CT<font color="#000080">,</font>XT <font color="#000080">: </font>integer<font color="#000080">;                            </font><font color="#008000"><i>{ Areas, i/p record counts
}    </i></font>PAX<font color="#000080">,</font>CRX  <font color="#000080">: </font>integer<font color="#000080">;                                 </font><font color="#008000"><i>{ Pointer Array indeX
}    </i></font>STATUS   <font color="#000080">: </font>integer<font color="#000080">;
    </font>HRF      <font color="#000080">: </font>boolean<font color="#000080">;                                  </font><font color="#008000"><i>{ Header Record Flag
}    </i></font>DTIME    <font color="#000080">: </font>LongInt<font color="#000080">;                             </font><font color="#008000"><i>{ Original File Date/Time
}    </i></font>DT       <font color="#000080">: </font>DateTime<font color="#000080">;
    </font>DS       <font color="#000080">: </font>DirStr<font color="#000080">;
    </font>NS       <font color="#000080">: </font>NameStr<font color="#000080">;
    </font>ES       <font color="#000080">: </font>ExtStr<font color="#000080">;
    </font>PRIOR<font color="#000080">,</font>T  <font color="#000080">: </font>S80<font color="#000080">;
    </font>PA       <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>TLIM<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>LLPTR<font color="#000080">;   </font><font color="#008000"><i>{ Pointer Array for stored TagLines
}    </i></font>CRECS    <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>CLIM<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>LLPTR<font color="#000080">;                     </font><font color="#008000"><i>{ Comment Records
}
</i></font><font color="#FF0000"><b>procedure </b></font>HEADER<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>WriteCenter <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>LightGray<font color="#000080">,</font>Black<font color="#000080">,</font><font color="#800000">'**** TagLines Manager - Ver '</font><font color="#000080">+</font>VERSION<font color="#000080">+</font><font color="#800000">'
</font><font color="#000080">****</font><font color="#800000">')end;  { HEADER }

</font><font color="#FF0000"><b>procedure </b></font>INITIALIZE<font color="#000080">;                         </font><font color="#008000"><i>{ initialize system &amp; variables
}</i></font><font color="#FF0000"><b>begin
  </b></font>HEADER<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>F3 <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    begin
      </b></font>WPROM <font color="#000080">(</font>LONORM<font color="#000080">,</font><font color="#800000">'Enter TagLines filename: '</font><font color="#000080">); </font>readln <font color="#000080">(</font>F3<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>EXISTS <font color="#000080">(</font>F3<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FATAL <font color="#000080">(</font><font color="#800000">'Cannot Open '</font><font color="#000080">+</font>F3<font color="#000080">+</font><font color="#800000">' as input file'</font><font color="#000080">);
  </font>FastWrite <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font>LONORM<font color="#000080">,</font>FSI<font color="#000080">(</font>MemAvail<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' Bytes @ start '</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TLIM <font color="#FF0000"><b>do </b></font>PA<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>CLIM <font color="#FF0000"><b>do </b></font>CRECS<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font>BBOPEN <font color="#000080">(</font>FV3<font color="#000080">,</font>F3<font color="#000080">,</font><font color="#800000">'r'</font><font color="#000080">,</font>BUFFIN<font color="#000080">);
  </font>GetFTime <font color="#000080">(</font>FV3<font color="#000080">,</font>DTIME<font color="#000080">); </font>UnPackTime <font color="#000080">(</font>DTIME<font color="#000080">,</font>DT<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ INITIALIZE }

</i></font><font color="#FF0000"><b>procedure </b></font>SORT_TAGS <font color="#000080">(</font>LEFT<font color="#000080">,</font>RIGHT <font color="#000080">: </font>word<font color="#000080">);                   </font><font color="#008000"><i>{ Lo-Hi QuickSort }
</i></font><font color="#FF0000"><b>var </b></font>LOWER<font color="#000080">,</font>UPPER<font color="#000080">,</font>MIDDLE <font color="#000080">: </font>word<font color="#000080">;
    </font>PIVOT              <font color="#000080">: </font>S80<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LOWER <font color="#000080">:= </font>LEFT<font color="#000080">; </font>UPPER <font color="#000080">:= </font>RIGHT<font color="#000080">; </font>MIDDLE <font color="#000080">:= (</font>LEFT<font color="#000080">+</font>RIGHT<font color="#000080">) </font><font color="#FF0000"><b>Shr </b></font><font color="#800000">1</font><font color="#000080">;
  </font>PIVOT <font color="#000080">:= </font>PA<font color="#000080">[</font>MIDDLE<font color="#000080">]^;
  </font><font color="#FF0000"><b>repeat
    while </b></font>PA<font color="#000080">[</font>LOWER<font color="#000080">]^ &lt; </font>PIVOT <font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>LOWER<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font>PIVOT <font color="#000080">&lt; </font>PA<font color="#000080">[</font>UPPER<font color="#000080">]^ </font><font color="#FF0000"><b>do </b></font>Dec<font color="#000080">(</font>UPPER<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>LOWER <font color="#000080">&lt;= </font>UPPER <font color="#FF0000"><b>then
      begin
        </b></font>T <font color="#000080">:= </font>PA<font color="#000080">[</font>LOWER<font color="#000080">]^; </font>PA<font color="#000080">[</font>LOWER<font color="#000080">]^ := </font>PA<font color="#000080">[</font>UPPER<font color="#000080">]^;
        </font>PA<font color="#000080">[</font>UPPER<font color="#000080">]^ := </font>T<font color="#000080">; </font>Inc <font color="#000080">(</font>LOWER<font color="#000080">); </font>Dec <font color="#000080">(</font>UPPER<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>LOWER <font color="#000080">&gt; </font>UPPER<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>LEFT <font color="#000080">&lt; </font>UPPER <font color="#FF0000"><b>then </b></font>SORT_TAGS <font color="#000080">(</font>LEFT<font color="#000080">, </font>UPPER<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>LOWER <font color="#000080">&lt; </font>RIGHT <font color="#FF0000"><b>then </b></font>SORT_TAGS <font color="#000080">(</font>LOWER<font color="#000080">, </font>RIGHT<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                                              </font><font color="#008000"><i>{ SORT_TAGS
}
</i></font><font color="#FF0000"><b>procedure </b></font>READ_TAGS<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>P <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>CT <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>TX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>XT <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>PAX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>CRX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>EOF <font color="#000080">(</font>FV3<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>readln <font color="#000080">(</font>FV3<font color="#000080">,</font>S1<font color="#000080">); </font>Inc <font color="#000080">(</font>CT<font color="#000080">); </font>FastWrite <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>DSLINE<font color="#000080">,</font>LONORM<font color="#000080">,</font>FSI<font color="#000080">(</font>CT<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">));
      </font>CH <font color="#000080">:= </font>S1<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]; </font>S2 <font color="#000080">:= </font>TTB<font color="#000080">(</font>S1<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>CH <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">';'</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">,</font><font color="#800000">'@'</font><font color="#000080">] </font><font color="#FF0000"><b>then                           </b></font><font color="#008000"><i>{ Comment Records }
        </i></font><font color="#FF0000"><b>begin
          </b></font>Inc <font color="#000080">(</font>CRX<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>CRX <font color="#000080">&lt;= </font>CLIM <font color="#FF0000"><b>then
            begin
              </b></font>New <font color="#000080">(</font>CRECS<font color="#000080">[</font>CRX<font color="#000080">]); </font>CRECS<font color="#000080">[</font>CRX<font color="#000080">]^ := </font>S2<font color="#000080">; </font>Inc <font color="#000080">(</font>XT<font color="#000080">);
              </font>FastWrite <font color="#000080">(</font><font color="#800000">13</font><font color="#000080">,</font>DSLINE<font color="#000080">,</font>HINORM<font color="#000080">,</font>FSI<font color="#000080">(</font>CRX<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">))
            </font><font color="#FF0000"><b>end
        end
      else
        begin                                                      </b></font><font color="#008000"><i>{ TagLines }
          </i></font><font color="#FF0000"><b>if </b></font>Copy<font color="#000080">(</font>S2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">) = </font><font color="#800000">'... ' </font><font color="#FF0000"><b>then </b></font>Delete <font color="#000080">(</font>S2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);       </font><font color="#008000"><i>{ flush header}
          </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">' -- '</font><font color="#000080">,</font>S2<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do              </b></font><font color="#008000"><i>{ change &quot; -- ' to &quot; - &quot; }
            </i></font><font color="#FF0000"><b>begin
              </b></font>P <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">' -- '</font><font color="#000080">,</font>S2<font color="#000080">); </font>Delete <font color="#000080">(</font>S2<font color="#000080">,</font>P<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S2<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>S2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Delete <font color="#000080">(</font>S2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>S2<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
              </b></font>Inc <font color="#000080">(</font>PAX<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>PAX <font color="#000080">&lt;= </font>TLIM <font color="#FF0000"><b>then
                begin
                  </b></font>New <font color="#000080">(</font>PA<font color="#000080">[</font>PAX<font color="#000080">]); </font>PA<font color="#000080">[</font>PAX<font color="#000080">]^ := </font>S2<font color="#000080">; </font>Inc <font color="#000080">(</font>TX<font color="#000080">);
                  </font>FastWrite <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">,</font>DSLINE<font color="#000080">,</font>LONORM<font color="#000080">,</font>FSI<font color="#000080">(</font>PAX<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">))
                </font><font color="#FF0000"><b>end
            end  </b></font><font color="#008000"><i>{ if }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FastWrite <font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font>LONORM<font color="#000080">,</font>FSI<font color="#000080">(</font>MemAvail<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' Bytes with data loaded'</font><font color="#000080">);
  </font>Close <font color="#000080">(</font>FV3<font color="#000080">); </font>Dispose <font color="#000080">(</font>BUFFIN<font color="#000080">);
  </font>SORT_TAGS <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>PAX<font color="#000080">);
  </font>FSplit<font color="#000080">(</font>F3<font color="#000080">,</font>DS<font color="#000080">,</font>NS<font color="#000080">,</font>ES<font color="#000080">); </font>F1 <font color="#000080">:= </font>DS<font color="#000080">+</font>NS<font color="#000080">+</font><font color="#800000">'.BAK'</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>EXISTS <font color="#000080">(</font>F1<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Assign <font color="#000080">(</font>FV1<font color="#000080">,</font>F1<font color="#000080">); </font>Erase<font color="#000080">(</font>FV1<font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ReName <font color="#000080">(</font>FV3<font color="#000080">,</font>F1<font color="#000080">); </font>BBOPEN <font color="#000080">(</font>FV3<font color="#000080">,</font>F3<font color="#000080">,</font><font color="#800000">'w'</font><font color="#000080">,</font>BUFFOUT<font color="#000080">); </font>PRIOR <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>CT <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>CRX <font color="#FF0000"><b>do                              </b></font><font color="#008000"><i>{ write out comment lines
}    </i></font>writeln <font color="#000080">(</font>FV3<font color="#000080">,</font>CRECS<font color="#000080">[</font>I<font color="#000080">]^);
  </font>XT <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>PAX <font color="#FF0000"><b>do                            </b></font><font color="#008000"><i>{ write out sorted TagLines
}    </i></font><font color="#FF0000"><b>begin
      </b></font>Inc <font color="#000080">(</font>CT<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>PA<font color="#000080">[</font>I<font color="#000080">]^ &lt;&gt; </font>PRIOR <font color="#FF0000"><b>then
        begin
          </b></font>PRIOR <font color="#000080">:= </font>PA<font color="#000080">[</font>I<font color="#000080">]^; </font>writeln <font color="#000080">(</font>FV3<font color="#000080">,</font>PRIOR<font color="#000080">); </font>Inc <font color="#000080">(</font>XT<font color="#000080">)
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>FastWrite <font color="#000080">(</font><font color="#800000">20</font><font color="#000080">,</font>DSLINE<font color="#000080">,</font>LONORM<font color="#000080">,</font>FSI<font color="#000080">(</font>CT<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">)+</font>FSI<font color="#000080">(</font>XT<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">))
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close <font color="#000080">(</font>FV3<font color="#000080">); </font>Dispose <font color="#000080">(</font>BUFFOUT<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ READ_TAGS }

</i></font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ MAIN LINE }
  </i></font>STATUS <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>INITIALIZE<font color="#000080">;                                 </font><font color="#008000"><i>{ initialize system &amp; variables}
  </i></font>READ_TAGS<font color="#000080">;                        </font><font color="#008000"><i>{ read &amp; store selected records, reformat}
  </i></font>WriteCenter <font color="#000080">(</font>ERLINE<font color="#000080">,</font>LightGray<font color="#000080">,</font>Black<font color="#000080">,</font><font color="#800000">'Finis...'</font><font color="#000080">); </font>PAUSE
<font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0181.PAS">Original</a><b>]</b></p></body>
</html>
