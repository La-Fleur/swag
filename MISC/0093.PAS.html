<html>
<head><title> "Various Cool Routines" by CHRIS LAUTENBACH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 After looking around through some of my routines, I found a few that were
 generic enough that they might be of use to the rest of ya.

 My only request is that if you modify them and make them any cooler than
 they already are -- send me back a copy.  Oh -- yeah -- and if you use
 them in your programs give me credit, or at least a registered copy. :)

 Here's a brief rundown of these routines:

 proc SeqRen -        renames a file, keep a certain number of backups.
                      EG: When you download a file, and one already exists,
                      it renames them. Only thing is, that this keeps them
                      in age order. :)

 func Filetype -      determines the type of a file.  Right now, it only
                      knows about ZIP, ARJ, LHA, EXE and GIF files.  If you
                      can expand on this, feel free - and make sure you
                      mail me back a copy of the new ones!  :)

 func FileExistWild - takes a wildcard filename and determines if any files
                      matching that spec are present.  (Eg: *.EXE)  The
                      filename doesn't even have to be a wildcard, so you
                      could use this as a generic function to see if a file
                      exists or not.

 func SizeFile -      takes a filename as input, and if the file exists, it
                      returns the size of the file.  Returns -1 if file
                      does not exist.

 funct SwtVal -       returns the value of a command line switch.  For
                      example, on a 'comms' (I hate that) program you might
                      want to be able to specify an alternate COM: port on
                      the command line. With this routine you could do that
                      easily, just check for SwtVal('/COM:').  If the
                      result is anything other than an empty string, then
                      that is the value.  You can specify multiple words
                      per command line parameter by replacing the spaces
                      with underscores ('_').

 func StatusBar -     You've all seen those programs which display those
                      nifty progress bars as they do things.  Now you can
                      do it too! Simply call this with the total number of
                      items (eg: the file size say 10 records for example)
                      and the current item (eg: record 4 out of 10 records)
                      and StatusBar will return a demi-hi-res progress bar
                      as a string. :)

 func EraseFiles -    Erases all the files in with a filespec matching the
                      one it is passed.  Example: EraseFiles('*.BAK') would
                      delete all files with the .BAK extension in the
                      current directory.
}

</i></font><font color="#FF0000"><b>procedure </b></font>SeqRen<font color="#000080">(</font>Fn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>Max <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{ Sequentially rename file Fn, keeping Max number of files }
</i></font><font color="#FF0000"><b>var </b></font>idx<font color="#000080">, </font>rn <font color="#000080">: </font>byte<font color="#000080">;
    </font>sfn<font color="#000080">, </font>efn<font color="#000080">, </font>ofn <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>Rend<font color="#000080">, </font>whole <font color="#000080">: </font>boolean<font color="#000080">;
    </font>f <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>Merge<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>ln<font color="#000080">:</font>longint<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>tmp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>tmp<font color="#000080">:=</font>Long2Str<font color="#000080">(</font>ln<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>tmp<font color="#000080">)&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
    begin
      </b></font>st<font color="#000080">[</font>length<font color="#000080">(</font>st<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">]:=</font>tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
      </font>st<font color="#000080">[</font>length<font color="#000080">(</font>st<font color="#000080">)]:=</font>tmp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font><font color="#FF0000"><b>end
      else
    </b></font>st<font color="#000080">[</font>length<font color="#000080">(</font>st<font color="#000080">)]:=</font>tmp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
    </font>Merge<font color="#000080">:=</font>St<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Rend<font color="#000080">:=</font>false<font color="#000080">;</font>whole<font color="#000080">:=</font>false<font color="#000080">;</font>idx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;    </font><font color="#008000"><i>{ Set up variables             }

  </i></font><font color="#FF0000"><b>If </b></font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>fn<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then               </b></font><font color="#008000"><i>{ Disect the filename          }
  </i></font><font color="#FF0000"><b>begin
    </b></font>sfn<font color="#000080">:=</font>copy<font color="#000080">(</font>fn<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>fn<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
    </font>efn<font color="#000080">:=</font>copy<font color="#000080">(</font>fn<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>fn<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>fn<font color="#000080">));
  </font><font color="#FF0000"><b>end
    ELSE
  </b></font>whole<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>Inc<font color="#000080">(</font>idx<font color="#000080">);
    </font><font color="#FF0000"><b>if not </b></font>ExistFile<font color="#000080">(</font>sfn<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>Merge<font color="#000080">(</font>efn<font color="#000080">, </font>idx<font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>rend<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>idx<font color="#000080">=</font>max<font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Rend<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>idx<font color="#000080">=</font>max<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>rend<font color="#000080">=</font>false<font color="#000080">) </font><font color="#FF0000"><b>then      </b></font><font color="#008000"><i>{ Nope?  Okay, no problem.     }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>sfn<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>Merge<font color="#000080">(</font>efn<font color="#000080">, </font>max<font color="#000080">));    </font><font color="#008000"><i>{ Rename all oldies and make   }
    </i></font>Erase<font color="#000080">(</font>f<font color="#000080">);                             </font><font color="#008000"><i>{ room for it as number 1      }
    </i></font><font color="#FF0000"><b>for </b></font>idx<font color="#000080">:=(</font>max<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>sfn<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>Merge<font color="#000080">(</font>efn<font color="#000080">, </font>idx<font color="#000080">));
      </font>Rename<font color="#000080">(</font>f<font color="#000080">,</font>sfn<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>Merge<font color="#000080">(</font>efn<font color="#000080">, </font>idx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rn<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>rend <font color="#FF0000"><b>then </b></font>rn<font color="#000080">:=</font>idx<font color="#000080">;

  </font>Assign<font color="#000080">(</font>f<font color="#000080">,</font>fn<font color="#000080">);                       </font><font color="#008000"><i>{ Rename the requested file!   }
  </i></font>Rename<font color="#000080">(</font>f<font color="#000080">,</font>sfn<font color="#000080">+</font><font color="#800000">'.'</font><font color="#000080">+</font>Merge<font color="#000080">(</font>efn<font color="#000080">, </font>rn<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>FileIDType <font color="#000080">= (</font>fEXE<font color="#000080">, </font>fZIP<font color="#000080">, </font>fARJ<font color="#000080">, </font>fLHA<font color="#000080">, </font>fGIF87<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>FileType<font color="#000080">(</font>Filename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>FileIDType<font color="#000080">;
</font><font color="#008000"><i>{ This function attempts to identify what type of a file Filename is }
</i></font><font color="#FF0000"><b>var </b></font>Infile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
    </font>IdBytes <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>SubId <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FileType <font color="#000080">:= </font>fUnknown<font color="#000080">;
  </font><font color="#FF0000"><b>If NOT </b></font>ExistFile<font color="#000080">(</font>FileName<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font>Assign<font color="#000080">(</font>Infile<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>Infile<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>FileSize<font color="#000080">(</font>Infile<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Close<font color="#000080">(</font>Infile<font color="#000080">);
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>BlockRead<font color="#000080">(</font>Infile<font color="#000080">, </font>IDBytes<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">);
  </font>Close<font color="#000080">(</font>Infile<font color="#000080">);
  </font>SubId <font color="#000080">:= </font>Copy<font color="#000080">(</font>IDBytes<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>SubID <font color="#000080">= </font><font color="#800000">'MZ'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fEXE
    <font color="#FF0000"><b>ELSE
  If </b></font><font color="#000080">(</font>SubID <font color="#000080">= </font><font color="#800000">'PK'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fZIP
    <font color="#FF0000"><b>ELSE
  if </b></font><font color="#000080">(</font>SubID <font color="#000080">= </font><font color="#800000">#96 </font><font color="#000080">+ </font><font color="#800000">#234</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fARJ
    <font color="#FF0000"><b>ELSE
  If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>IDBytes<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">) = </font><font color="#800000">'-lh5-'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fLHA
    <font color="#FF0000"><b>ELSE
  If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>IDBytes<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">) = </font><font color="#800000">'-lh1-'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fLHA
    <font color="#FF0000"><b>ELSE
  if </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>IDbytes<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">) = </font><font color="#800000">'GIF89a'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FileType <font color="#000080">:= </font>fGIF87<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>FileExistWild<font color="#000080">(</font>Mask <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;      </font><font color="#008000"><i>{ Does X*.* exist? :) }
</i></font><font color="#FF0000"><b>var </b></font>sr <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FindFirst<font color="#000080">(</font>Mask<font color="#000080">, </font>AnyFile<font color="#000080">, </font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">18 </font><font color="#FF0000"><b>then
    </b></font>FileExistWild <font color="#000080">:= </font>TRUE
      <font color="#FF0000"><b>ELSE
    </b></font>FileExistWild <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SizeFile<font color="#000080">(</font>Fname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var  </b></font>sr <font color="#000080">: </font>SearchRec<font color="#000080">;
     </font>idx <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SizeFile <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Findfirst<font color="#000080">(</font>Fname<font color="#000080">, </font>Anyfile<font color="#000080">, </font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>SizeFile <font color="#000080">:= </font>SR<font color="#000080">.</font>Size <font color="#FF0000"><b>ELSE </b></font>SizeFile <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SwtVal<font color="#000080">(</font>Swt <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns the value of a command line switch. Eg: for /COM:2, call
  SwtVal('/COM2:') and it will return 2. }
</i></font><font color="#FF0000"><b>var </b></font>ndx<font color="#000080">, </font>found <font color="#000080">: </font>byte<font color="#000080">;
    </font>st <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Found <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>ndx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>do
  begin
    if </b></font>StUpCase<font color="#000080">(</font>copy<font color="#000080">(</font>paramstr<font color="#000080">(</font>ndx<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>swt<font color="#000080">))) = </font>StUpCase<font color="#000080">(</font>swt<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Found <font color="#000080">:= </font>ndx<font color="#000080">;
      </font>Break<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Found <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>swtval <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>st <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>st <font color="#000080">:= </font>StUpCase<font color="#000080">(</font>Copy<font color="#000080">(</font>ParamStr<font color="#000080">(</font>Found<font color="#000080">), </font>Length<font color="#000080">(</font>Swt<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">,
                 </font>Length<font color="#000080">(</font>ParamStr<font color="#000080">(</font>Found<font color="#000080">)) - </font>Length<font color="#000080">(</font>Swt<font color="#000080">)));
  </font><font color="#FF0000"><b>For </b></font>ndx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>St<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font><font color="#000080">(</font>St<font color="#000080">[</font>ndx<font color="#000080">] = </font><font color="#800000">'_'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>St<font color="#000080">[</font>ndx<font color="#000080">] := </font><font color="#800000">#32</font><font color="#000080">;
  </font>SwtVal <font color="#000080">:= </font>st<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StatusBar<font color="#000080">(</font>total<font color="#000080">, </font>amt <font color="#000080">: </font>longint<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>BarLength <font color="#000080">= </font><font color="#800000">40</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">, </font>b<font color="#000080">, </font>c<font color="#000080">, </font>d <font color="#000080">: </font>longint<font color="#000080">;
    </font>percent <font color="#000080">: </font>real<font color="#000080">;
    </font>st <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font><font color="#000080">(</font>total <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>amt <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>StatusBar <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Amt <font color="#000080">&gt; </font>Total<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>amt <font color="#000080">:= </font>total<font color="#000080">;
  </font>Percent <font color="#000080">:= </font>Amt <font color="#000080">/ </font>Total <font color="#000080">* (</font>Barlength <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">);
  </font>a <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
  </font>b <font color="#000080">:= </font>a <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">;
  </font>c <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>percent <font color="#000080">:= </font>amt <font color="#000080">/ </font>total <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">;
  </font>d <font color="#000080">:= </font>trunc<font color="#000080">(</font>percent<font color="#000080">);
  </font>st <font color="#000080">:= </font><font color="#800000">' (' </font><font color="#000080">+ </font>int_to_str<font color="#000080">(</font>d<font color="#000080">) + </font><font color="#800000">'%)'</font><font color="#000080">;
  </font>StatusBar <font color="#000080">:= </font>CharStr<font color="#000080">(</font>b <font color="#000080">* </font>c<font color="#000080">, </font><font color="#800000">#219</font><font color="#000080">) + </font>CharStr<font color="#000080">(</font>Barlength <font color="#000080">- (</font>b <font color="#000080">* </font>c<font color="#000080">), </font><font color="#800000">#176</font><font color="#000080">) + </font>st<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>EraseFiles<font color="#000080">(</font>Path<font color="#000080">, </font>Mask <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>S <font color="#000080">: </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FindFirst<font color="#000080">(</font>Path <font color="#000080">+ </font>Mask<font color="#000080">, </font>Anyfile <font color="#000080">- </font>Directory<font color="#000080">, </font>s<font color="#000080">);      </font><font color="#008000"><i>{ Find the first file }
  </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;                          </font><font color="#008000"><i>{ No files to erase }
  </i></font>KillFile<font color="#000080">(</font>Path <font color="#000080">+ </font>s<font color="#000080">.</font>name<font color="#000080">);                            </font><font color="#008000"><i>{ Erase the first file }
  </i></font><font color="#FF0000"><b>repeat
    </b></font>Findnext<font color="#000080">(</font>s<font color="#000080">);                                        </font><font color="#008000"><i>{ Find the next file }
    </i></font><font color="#FF0000"><b>If NOT </b></font><font color="#000080">(</font>DOSError<font color="#000080">=</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>KillFile<font color="#000080">(</font>Path <font color="#000080">+ </font>s<font color="#000080">.</font>name<font color="#000080">);      </font><font color="#008000"><i>{ Erase the file }
  </i></font><font color="#FF0000"><b>until </b></font>Doserror<font color="#000080">=</font><font color="#800000">18</font><font color="#000080">;                                         </font><font color="#008000"><i>{ no more files }
  </i></font>EraseFiles <font color="#000080">:= </font>IOResult<font color="#000080">;                             </font><font color="#008000"><i>{ Return the IO result }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p></body>
</html>
