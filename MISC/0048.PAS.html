<html>
<head><title> "Export data from OBJ file" by WILBERT VAN LEIJEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
WILBERT VAN LEIJEN

&gt; I want to pass its address to an external .obj procedure so I can set
&gt; DS:SI to it... how do I do this?  I know how to do this sort of think if I
&gt; use the tp60 built in asmm thingy, and I know that I can pass values using
&gt; arg like

You cannot export data from an .OBJ file to a Pascal program.  The linker
cannot handle with public identifiers other than in a segment of class CODE,
alas.

Store the data in a File of Byte (DORK.BIN), convert it with BINOBJ to DORK.OBJ
(suggested identifier: Procedure DorkData), link it to your program.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>DorkData<font color="#000080">; </font><font color="#FF0000"><b>External</b></font><font color="#000080">;
</font><font color="#008000"><i>{$L DORK.OBJ }

</i></font><font color="#FF0000"><b>Type
  </b></font>TDork <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>PDork <font color="#000080">= ^</font>TDork<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Dork <font color="#000080">: </font>PDork<font color="#000080">;
  </font>i    <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Dork <font color="#000080">:= @</font>DorkData<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>Low<font color="#000080">(</font>TDork<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>High<font color="#000080">(</font>TDork<font color="#000080">) </font><font color="#FF0000"><b>Do
    </b></font>Write<font color="#000080">(</font>Dork<font color="#000080">^[</font>i<font color="#000080">] : </font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ If you want to use assembler to access DorkData: }

</i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">CLD
  PUSH   DS
  PUSH   CS            </font><font color="#008000"><i>{ Using &quot;LDS SI, DorkData&quot; will not work! }
  </i></font><font color="#FF00FF">POP    DS
  LEA    SI, DorkData            </font><font color="#008000"><i>{ DS:SI points to DorkData }
  </i></font><font color="#FF00FF">MOV    CX, Type(TDork)         </font><font color="#008000"><i>{ = 256 }
 </i></font><font color="#FF00FF">@1:     LODSB                </font><font color="#008000"><i>{ TDork(DorkData[256-CX]) is now in AL }
  { other code }
  </i></font><font color="#FF00FF">LOOP   @1
  POP    DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p></body>
</html>
