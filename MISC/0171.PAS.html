<html>
<head><title> "Create BBS Bulletins" by ROBERT L. EDWARDS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0171.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ ***** FIRST OFF!  The credits and such *****                               }
{  Written in Turbo Pascal (TM) v6.0 on 10 May 1991 ( yes, one day) by       }
{  Robert L. Edwards.  The idea was to make it a little simpler to generate  }
{  both ANSI and ASCI bulletins for DOOR programs.  I was in the final stages}
{  of a DOOR developement and needed this tool.  The idea is to set up a     }
{  string with the text you want saved weaved in with your ANSI calls.  I    }
{  got this idea from the Pheonix Software Group PSG (tm) collection of DOOR }
{  routines named PSGIO(tm).  In that collection a routine is called PRINT   }
{  and PRINTLN that handle calls from a routine ANSIColor to set the         }
{  attributes.  This function was not flexible enough for me to use in file  }
{  writes (or I am just too stupid?!?).                                      }
{                                                                            }
{  !!! THIS CODE IS CONSIDERED PUBLIC DOMAIN !!!                             }
{  -  Please, if you improve on it, upload a copy to my board.  I used only  }
{     one afternoon to produce this and the code is quite shakey.            }
{                                                                            }
{  If you find this program usefull (no, I am not going to ask for money     }
{  Please call me and let me know (VIA BBS).  If enough support and interest }
{  is shown, I will further clean and enhance this program.  As it is now    }
{  it fits my needs.  Any recomendations are greatly appreciated.            }
{     Respectfully,                                                          }
{                                                                            }
{                  Robert L. Edwards                                         }
{                  RaJE Computer Emirates (RJE)                              }
{                  Box 6725 NSGA                                             }
{                  Winter Harbor, ME 04693                                   }
{                                                                            }
{     Call The Force! Demon-Sion BBS @ 1(207)963-2683  USR HST 14400         }
{          or Voice @ 1(207)963-7056                                         }

</i></font><font color="#FF0000"><b>Unit </b></font>Bulletin<font color="#000080">;
</font><font color="#FF0000"><b>Interface
Uses </b></font>tpCRT<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>A_St<font color="#000080">(</font>FG<font color="#000080">, </font>BG <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ - DESCRIPTION:  This function takes the WORDs input and translates them    }
{                 if possible, to ANSI escape sequences.  The global         }
{                 variable ANS (Record type) is checked for repeat requests  }
{                 and will not duplicate ANSI code.  IE:  A call to set      }
{                 colors to YELLOW foreground and BLUE background when       }
{                 the background (ANS.BG) is already blue will produce       }
{                 only the YELLOW escapes sequences.  If the global ANS.ON   }
{                 is FALSE, the function will return a NUL string.           }
{ - CALLING:  YourString := A_St(Yellow + Bold + Blink, Blue);               }
{                                                                            }
{             Will yield the escape sequence for a bold blinking yellow      }
{             foreground on a blue background.  Global variable are set for  }
{             the allowable ANSI colors.  This variables are Mnemonics and   }
{             are in no way related to their ANSI escape sequences.  For ease}
{             non-conflict the values are duplicate of the TURBO PASCAL      }
{             UNIT CRT global declarations.                                  }
{ - RESULTS:  This function returns a string of characters equal to the      }
{             escape sequences need to reproduce the called foreground       }
{             and background collors.  If global ANS.ON is FALSE, a NUL      }
{             string will be returned.                                       }
{ - CALLED FROM:  Your routines.                                             }
{ - VARIABLES:                                                               }
{     Type                                                                   }
{       CAns = Record                                                        }
{         Att : Word;     Current Attribute                                  }
{                         Valid values:                                      }
{                            OFF                                             }
{                            Blink                                           }
{                            Bold                                            }
{                            Blink + Bold                                    }
{         FG  : Word;     Current ForeGround                                 }
{                         Valid Values                                       }
{                         Black,   [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Red,     [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Green,   [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Yellow,  [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Blue,    [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Magenta, [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         Cyan,    [+ Blink], [+ Bold], [+ Blink + Bold]     }
{                         White,   [+ Blink], [+ Bold], [+ Blink + Bold]     }
{         BG  : WOrd;     Current BackGround                                 }
{                         Valid Values:                                      }
{                          Black                                             }
{                          Red                                               }
{                          Green                                             }
{                          Yellow                                            }
{                          Blue                                              }
{                          Magenta                                           }
{                          Cyan                                              }
{                          White                                             }
{         ON  : Boolean;  Generate ANSI codes?                               }
{                         Valid Values:                                      }
{                           True                                             }
{                           False                                            }
{       End;                                                                 }
{                                                                            }
{   var                                                                      }
{     Ans : CAns;         Holds current attributes, described above          }
{   Const                                                                    }
{     Esc      = #27 + '[';     Escape sequence                              }
{     Off      =  50;           Off Mnemonic                                 }
{     Bold     =  51;           Bold Mnemonic                                }
{     Black    =   0;           Black Mnemonic, CRT Constant                 }
{     Red      =   4;           Red Mnemonic, CRT Constant                   }
{     Green    =   2;           Green Mnemonic, CRT Constant                 }
{     Yellow   =  14;           Yellow Mnemonic, CRT Constant                }
{     Blue     =   1;           Blue Mnemonic, CRT Constant                  }
{     Magenta  =   5;           Magenta Mnemonic, CRT Constant               }
{     Cyan     =   3;           Cyan Mnemonic, CRT Constant                  }
{     White    =  15;           White Mnemonic, CRT Constant                 }
{     Blink    = 128;           Blink Mnemonic, CRT Constant                 }

</i></font><font color="#FF0000"><b>Type
  </b></font>CAns <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Att <font color="#000080">: </font>Word<font color="#000080">;
    </font>FG  <font color="#000080">: </font>Word<font color="#000080">;
    </font>BG  <font color="#000080">: </font>WOrd<font color="#000080">;
    </font><font color="#FF0000"><b>ON  </b></font><font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Ans <font color="#000080">: </font>CAns<font color="#000080">;              </font><font color="#008000"><i>{ Holds Current Information on      }
                           { Attribute ( Off, Bold, Blink, ETC }
                           { ForeGround Color                  }
                           { BackGround Color                  }
</i></font><font color="#FF0000"><b>Const
  </b></font>Esc      <font color="#000080">= </font><font color="#800000">#27 </font><font color="#000080">+ </font><font color="#800000">'['</font><font color="#000080">;    </font><font color="#008000"><i>{ Escape sequence                }
  </i></font>Off      <font color="#000080">=  </font><font color="#800000">50</font><font color="#000080">;          </font><font color="#008000"><i>{ Off Mnemonic                   }
  </i></font>Bold     <font color="#000080">=  </font><font color="#800000">51</font><font color="#000080">;          </font><font color="#008000"><i>{ Bold Mnemonic                  }
  </i></font>Black    <font color="#000080">=   </font><font color="#800000">0</font><font color="#000080">;          </font><font color="#008000"><i>{ Black Mnemonic, CRT Constant   }
  </i></font>Red      <font color="#000080">=   </font><font color="#800000">4</font><font color="#000080">;          </font><font color="#008000"><i>{ Red Mnemonic, CRT Constant     }
  </i></font>Green    <font color="#000080">=   </font><font color="#800000">2</font><font color="#000080">;          </font><font color="#008000"><i>{ Green Mnemonic, CRT Constant   }
  </i></font>Yellow   <font color="#000080">=  </font><font color="#800000">14</font><font color="#000080">;          </font><font color="#008000"><i>{ Yellow Mnemonic, CRT Constant  }
  </i></font>Blue     <font color="#000080">=   </font><font color="#800000">1</font><font color="#000080">;          </font><font color="#008000"><i>{ Blue Mnemonic, CRT Constant    }
  </i></font>Magenta  <font color="#000080">=   </font><font color="#800000">5</font><font color="#000080">;          </font><font color="#008000"><i>{ Magenta Mnemonic, CRT Constant }
  </i></font>Cyan     <font color="#000080">=   </font><font color="#800000">3</font><font color="#000080">;          </font><font color="#008000"><i>{ Cyan Mnemonic, CRT Constant    }
  </i></font>White    <font color="#000080">=  </font><font color="#800000">15</font><font color="#000080">;          </font><font color="#008000"><i>{ White Mnemonic, CRT Constant   }
  </i></font>Blink    <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;          </font><font color="#008000"><i>{ Blink Mnemonic, CRT Constant   }
  </i></font>Nul      <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;          </font><font color="#008000"><i>{ No Change Mnemonic             }
</i></font><font color="#FF0000"><b>Implementation

Function </b></font>SetATT<font color="#000080">(</font>A <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>A <font color="#FF0000"><b>of
      </b></font>Off <font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Ans<font color="#000080">.</font>ATT <font color="#000080">&lt;&gt; </font>Off <font color="#FF0000"><b>then
              Begin
                </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
                </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Off<font color="#000080">;
                </font>Ans<font color="#000080">.</font>FG  <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;
                </font>Ans<font color="#000080">.</font>BG  <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Bold  <font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>Ans<font color="#000080">.</font>Att <font color="#FF0000"><b>of
                </b></font>Off<font color="#000080">,
                </font>Blink <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetATT <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
                          </font>Inc<font color="#000080">(</font>Ans<font color="#000080">.</font>Att<font color="#000080">,</font>Bold<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Bold<font color="#000080">, </font>Bold <font color="#000080">+
                </font>Blink  <font color="#000080">: </font><font color="#FF0000"><b>Begin
                         End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>Else Begin
                       </b></font>SetATT <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
                       </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Bold<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Blink <font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>Ans<font color="#000080">.</font>Att <font color="#FF0000"><b>of
                </b></font>Off   <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'5'</font><font color="#000080">;
                           </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Blink<font color="#000080">;
                         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Bold  <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'5'</font><font color="#000080">;
                          </font>Inc<font color="#000080">(</font>Ans<font color="#000080">.</font>Att<font color="#000080">,</font>Blink<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Blink<font color="#000080">,
                </font>Bold <font color="#000080">+
                </font>Blink <font color="#000080">: </font><font color="#FF0000"><b>Begin
                        End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>Else Begin
                       </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'5'</font><font color="#000080">;
                       </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Blink<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Blink <font color="#000080">+
      </font>Bold  <font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>Ans<font color="#000080">.</font>ATT <font color="#FF0000"><b>of
                </b></font>Off   <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'1;5'</font><font color="#000080">;
                          </font>Ans<font color="#000080">.</font>ATT <font color="#000080">:= </font>Blink <font color="#000080">+ </font>Bold<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Blink <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
                          </font>Ans<font color="#000080">.</font>ATT <font color="#000080">:= </font>Blink <font color="#000080">+ </font>Bold<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                 </font>Bold <font color="#000080">: </font><font color="#FF0000"><b>Begin
                          </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'5'</font><font color="#000080">;
                          </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Blink <font color="#000080">+ </font>Bold<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Blink <font color="#000080">+
                </font>Bold   <font color="#000080">: </font><font color="#FF0000"><b>Begin
                         End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>Else Begin
                       </b></font>SetAtt <font color="#000080">:= </font><font color="#800000">'1;5'</font><font color="#000080">;
                       </font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font>Blink <font color="#000080">+ </font>Bold<font color="#000080">;
                     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Ans.ATT }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case A }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{ SetATT }

</i></font><font color="#FF0000"><b>Function </b></font>SetFG<font color="#000080">(</font>f <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>SetFg <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Ans<font color="#000080">.</font>FG <font color="#000080">= </font>F <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>F <font color="#FF0000"><b>of
      </b></font>Black  <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'30'</font><font color="#000080">;
      </font>Red    <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'31'</font><font color="#000080">;
      </font>Green  <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'32'</font><font color="#000080">;
      </font>Yellow <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'33'</font><font color="#000080">;
      </font>Blue   <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'34'</font><font color="#000080">;
      </font>Magenta<font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'35'</font><font color="#000080">;
      </font>Cyan   <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'36'</font><font color="#000080">;
      </font>White  <font color="#000080">:  </font>SetFG <font color="#000080">:= </font><font color="#800000">'37'</font><font color="#000080">;
      </font><font color="#FF0000"><b>Else </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Ans<font color="#000080">.</font>FG <font color="#000080">:= </font>F<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetBG<font color="#000080">(</font>f <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>SetBg <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Ans<font color="#000080">.</font>BG <font color="#000080">= </font>F <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>F <font color="#FF0000"><b>of
      </b></font>Black  <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'40'</font><font color="#000080">;
      </font>Red    <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'41'</font><font color="#000080">;
      </font>Green  <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'42'</font><font color="#000080">;
      </font>Yellow <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'43'</font><font color="#000080">;
      </font>Blue   <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'44'</font><font color="#000080">;
      </font>Magenta<font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'45'</font><font color="#000080">;
      </font>Cyan   <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'46'</font><font color="#000080">;
      </font>White  <font color="#000080">:  </font>SetBG <font color="#000080">:= </font><font color="#800000">'47'</font><font color="#000080">;
      </font><font color="#FF0000"><b>Else </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Ans<font color="#000080">.</font>BG <font color="#000080">:= </font>F<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>A_St<font color="#000080">(</font>FG<font color="#000080">, </font>BG <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>T  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>T2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>T3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    </b></font>A_ST <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>If NOT </b></font>ANS<font color="#000080">.</font><font color="#FF0000"><b>ON then </b></font>Exit<font color="#000080">;
    </font>t    <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>t2   <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>T3   <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>FG <font color="#FF0000"><b>of
      </b></font><font color="#800000">100   </font><font color="#000080">: </font><font color="#FF0000"><b>Begin</b></font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;           </font><font color="#008000"><i>{ No Change to FG go on to BG }
      </i></font>Off<font color="#000080">, </font>Bold<font color="#000080">, </font>Blink<font color="#000080">, </font>Bold <font color="#000080">+
      </font>Blink <font color="#000080">: </font>T <font color="#000080">:= </font>SetAtt<font color="#000080">(</font>FG<font color="#000080">);
      </font>Black<font color="#000080">, </font>Bold <font color="#000080">+ </font>Black<font color="#000080">, </font>Blink <font color="#000080">+ </font>Black<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Black <font color="#000080">: </font><font color="#FF0000"><b>Begin
                </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Black<font color="#000080">);
                </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Black<font color="#000080">);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Red<font color="#000080">, </font>Bold <font color="#000080">+ </font>Red<font color="#000080">, </font>Blink <font color="#000080">+ </font>Red<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Red <font color="#000080">: </font><font color="#FF0000"><b>Begin
              </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Red<font color="#000080">);
              </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Red<font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Green<font color="#000080">, </font>Bold <font color="#000080">+ </font>Green<font color="#000080">, </font>Blink <font color="#000080">+ </font>Green<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Green <font color="#000080">: </font><font color="#FF0000"><b>Begin
                </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Green<font color="#000080">);
                </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Green<font color="#000080">);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Yellow<font color="#000080">, </font>Bold <font color="#000080">+ </font>Yellow<font color="#000080">, </font>Blink <font color="#000080">+ </font>Yellow<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Yellow <font color="#000080">: </font><font color="#FF0000"><b>Begin
                 </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Yellow<font color="#000080">);
                 </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Yellow<font color="#000080">);
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Blue<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blue<font color="#000080">, </font>Blink <font color="#000080">+ </font>Blue<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Blue <font color="#000080">: </font><font color="#FF0000"><b>Begin
               </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Blue<font color="#000080">);
               </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Blue<font color="#000080">);
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Magenta<font color="#000080">, </font>Bold <font color="#000080">+ </font>Magenta<font color="#000080">, </font>Blink <font color="#000080">+ </font>Magenta<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Magenta <font color="#000080">: </font><font color="#FF0000"><b>Begin
                  </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Magenta<font color="#000080">);
                  </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Magenta<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Cyan<font color="#000080">, </font>Bold <font color="#000080">+ </font>Cyan<font color="#000080">, </font>Blink <font color="#000080">+ </font>Cyan<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>Cyan <font color="#000080">: </font><font color="#FF0000"><b>Begin
               </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>Cyan<font color="#000080">);
               </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>Cyan<font color="#000080">);
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>White<font color="#000080">, </font>Bold <font color="#000080">+ </font>White<font color="#000080">, </font>Blink <font color="#000080">+ </font>White<font color="#000080">, </font>Bold <font color="#000080">+ </font>Blink <font color="#000080">+
      </font>White <font color="#000080">: </font><font color="#FF0000"><b>Begin
                </b></font>T <font color="#000080">:= </font>SetATT<font color="#000080">(</font>FG <font color="#000080">- </font>White<font color="#000080">);
                </font>T2 <font color="#000080">:= </font>SetFG<font color="#000080">(</font>White<font color="#000080">);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Case </b></font>BG <font color="#FF0000"><b>of
      </b></font><font color="#800000">100     </font><font color="#000080">: </font>T3 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>Black   <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Black<font color="#000080">);
      </font>Red     <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Red<font color="#000080">);
      </font>Green   <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Green<font color="#000080">);
      </font>Yellow  <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Yellow<font color="#000080">);
      </font>Blue    <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Blue<font color="#000080">);
      </font>Magenta <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Magenta<font color="#000080">);
      </font>Cyan    <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>Cyan<font color="#000080">);
      </font>White   <font color="#000080">: </font>T3 <font color="#000080">:= </font>SetBG<font color="#000080">(</font>White<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>If </b></font>T <font color="#000080">+ </font>T2 <font color="#000080">+ </font>T3 <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>T <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
      Begin
        If </b></font>T2 <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>T <font color="#000080">:= </font>T <font color="#000080">+ </font><font color="#800000">';' </font><font color="#000080">+ </font>T2<font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>T3 <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>T <font color="#000080">:= </font>T <font color="#000080">+ </font><font color="#800000">';' </font><font color="#000080">+ </font>T3<font color="#000080">;
      </font><font color="#FF0000"><b>End Else
        Begin
          If </b></font>T2 <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
            Begin
              </b></font>T <font color="#000080">:= </font>T2<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>T3 <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>T <font color="#000080">:= </font>T <font color="#000080">+ </font><font color="#800000">';' </font><font color="#000080">+ </font>T3<font color="#000080">;
            </font><font color="#FF0000"><b>End Else
            </b></font>T <font color="#000080">:= </font>T3<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>A_ST <font color="#000080">:= </font>Esc <font color="#000080">+ </font>T <font color="#000080">+</font><font color="#800000">'m'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Ans<font color="#000080">.</font>Att <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;  </font><font color="#008000"><i>{ These Values set invalidly on purpose.  When the first  }
  </i></font>Ans<font color="#000080">.</font>FG  <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;  </font><font color="#008000"><i>{ call is made, this will FORCE! (pun for Jim and Guy)    }
  </i></font>Ans<font color="#000080">.</font>BG  <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;  </font><font color="#008000"><i>{ them to be set.  If I set them at say 0, and the user   }
  </i></font>Ans<font color="#000080">.</font><font color="#FF0000"><b>ON  </b></font><font color="#000080">:= </font>True<font color="#000080">; </font><font color="#008000"><i>{ Called wanting a black backgroun, the function would not}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.               </font><font color="#008000"><i>{ Return the 40m required because it would think it was   }
                   { already in black background                             }</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0171.PAS">Original</a><b>]</b></p></body>
</html>
