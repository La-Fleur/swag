<html>
<head><title> "UU Encode files" by PAUL ROBINSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   Pascal program to UUDECODE files which were processed
   with UUENCODE.  Or it will DECODE files which were
   processed by ENCODE

   Paul Robinson  TDARCOS@MCIMAIL.COM
   Tansin A. Darcos &amp; Company
   June 26, 1993
}

</i></font><font color="#FF0000"><b>var </b></font>inf<font color="#000080">,</font>outf<font color="#000080">:</font>text<font color="#000080">;
    </font>open<font color="#000080">:</font>boolean<font color="#000080">;
    </font>ch<font color="#000080">:</font>char<font color="#000080">;
    </font>buflen<font color="#000080">,</font>tag<font color="#000080">:</font>char<font color="#000080">;
    </font>tagfiller<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>buf<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">]  </font><font color="#FF0000"><b>absolute </b></font>buflen<font color="#000080">;
    </font>tag3<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#FF0000"><b>absolute </b></font>tag<font color="#000080">;
    </font>tag6<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#FF0000"><b>absolute </b></font>tag<font color="#000080">;
    </font>outfn<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
    </font>bp<font color="#000080">,</font>n<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dec<font color="#000080">(</font>c<font color="#000080">:</font>char<font color="#000080">):</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>dec <font color="#000080">:= (</font>ord<font color="#000080">(</font>c<font color="#000080">) - </font>ord<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#800000">63
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>short<font color="#000080">(</font>msg<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>writeln<font color="#000080">(</font>msg<font color="#000080">);
   </font>close<font color="#000080">(</font>inf<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>open <font color="#FF0000"><b>then
      </b></font>close<font color="#000080">(</font>outf<font color="#000080">);
   </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>skip<font color="#000080">;
</font><font color="#FF0000"><b>begin
   while </b></font>buf<font color="#000080">[</font>bp<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
     begin
        </b></font>bp <font color="#000080">:= </font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>bp<font color="#000080">&gt;=</font>length<font color="#000080">(</font>buf<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>short<font color="#000080">(</font><font color="#800000">'Error 01 Bad begin line'</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font>buf<font color="#000080">[</font>bp<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
     begin
        </b></font>bp <font color="#000080">:= </font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>bp<font color="#000080">&gt;=</font>length<font color="#000080">(</font>buf<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>short<font color="#000080">(</font><font color="#800000">'Error 02 Bad begin line'</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font>buf<font color="#000080">[</font>bp<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>do
     begin
        </b></font>bp <font color="#000080">:= </font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>bp<font color="#000080">&gt;=</font>length<font color="#000080">(</font>buf<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>short<font color="#000080">(</font><font color="#800000">'Error 03 Bad begin line'</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do
     begin
        </b></font>outfn <font color="#000080">:= </font>outfn<font color="#000080">+</font>buf<font color="#000080">[</font>bp<font color="#000080">];
        </font>bp <font color="#000080">:= </font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>{  output a group of 3 bytes (4 input characters).
   the input chars are pointed to by bp.
   n is used to tell us not to output all of them
   at the end of the file.
}

</i></font><font color="#FF0000"><b>procedure </b></font>outdec<font color="#000080">(</font>bp<font color="#000080">,</font>n<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>c1<font color="#000080">,</font>c2<font color="#000080">,</font>c3<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>c1 <font color="#000080">:= (</font>DEC<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">]) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">)  </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>dec<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">);
   </font>c2 <font color="#000080">:= (</font>dec<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>dec<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">);
   </font>c3 <font color="#000080">:= (</font>dec<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>dec<font color="#000080">(</font>buf<font color="#000080">[</font>bp<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]);
   </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
     </b></font>write<font color="#000080">(</font>outf<font color="#000080">,</font>chr<font color="#000080">(</font>c1<font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt;= </font><font color="#800000">2 </font><font color="#FF0000"><b>then
     </b></font>write<font color="#000080">(</font>outf<font color="#000080">,</font>chr<font color="#000080">(</font>c2<font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt;= </font><font color="#800000">3 </font><font color="#FF0000"><b>then
     </b></font>write<font color="#000080">(</font>outf<font color="#000080">,</font>chr<font color="#000080">(</font>c3<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>decode<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if </b></font>eof<font color="#000080">(</font>inf<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>short<font color="#000080">(</font><font color="#800000">'Premature EOF'</font><font color="#000080">);
   </font><font color="#FF0000"><b>repeat
   </b></font>readln<font color="#000080">(</font>inf<font color="#000080">,</font>buf<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>buf<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
       </b></font>n <font color="#000080">:= </font>dec<font color="#000080">(</font>buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
       </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
         begin
            </b></font>bp <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
            </font><font color="#FF0000"><b>while </b></font>n<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do
            begin
               </b></font>outdec<font color="#000080">(</font>bp<font color="#000080">, </font>n<font color="#000080">);
               </font>bp <font color="#000080">:= </font>bp<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
               </font>n <font color="#000080">:= </font>n<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>length<font color="#000080">(</font>buf<font color="#000080">)&lt;</font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">(</font>paramcount <font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>paramcount <font color="#000080">&gt;=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'/?'</font><font color="#000080">))  </font><font color="#FF0000"><b>then
     begin
        </b></font>writeln<font color="#000080">(</font><font color="#800000">'Pascal UUDECODER by Paul Robinson - TDARCOS@MCIMAIL.COM'</font><font color="#000080">);
        </font>writeln<font color="#000080">(</font><font color="#800000">'Usage: DECODE filename'</font><font color="#000080">);
        </font>halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>assign<font color="#000080">(</font>inf<font color="#000080">,</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
   </font>open <font color="#000080">:= </font>false<font color="#000080">;

   </font><font color="#008000"><i>{$I-} </i></font>reset<font color="#000080">(</font>inf<font color="#000080">); </font><font color="#008000"><i>{$I+}
   </i></font><font color="#FF0000"><b>if </b></font>IORESULT <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
     </b></font>short<font color="#000080">(</font><font color="#800000">'File '</font><font color="#000080">+</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' cannot be opened.'</font><font color="#000080">);
   </font><font color="#FF0000"><b>if not </b></font>eof<font color="#000080">(</font>inf<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>readln<font color="#000080">(</font>inf<font color="#000080">,</font>buf<font color="#000080">)
   </font><font color="#FF0000"><b>else
      </b></font>short<font color="#000080">(</font><font color="#800000">'Empty file'</font><font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>tag6 <font color="#000080">&lt;&gt; </font><font color="#800000">'begin ' </font><font color="#FF0000"><b>do
      if not </b></font>eof<font color="#000080">(</font>inf<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>readln<font color="#000080">(</font>inf<font color="#000080">,</font>buf<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>short<font color="#000080">(</font><font color="#800000">'No begin line'</font><font color="#000080">);
    </font>bp <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
    </font>buf <font color="#000080">:= </font>buf<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;

</font><font color="#008000"><i>{
    format is 'begin nnn filename'
    skip spaces before the nnn
    skip the nnn
    skip spaces after the nnn
}
    </i></font>skip<font color="#000080">;
    </font>assign<font color="#000080">(</font>outf<font color="#000080">,</font>outfn<font color="#000080">);
</font><font color="#008000"><i>{$I-}     </i></font>rewrite<font color="#000080">(</font>outf<font color="#000080">);  </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font>IORESULT <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       </b></font>open <font color="#000080">:= </font>true
    <font color="#FF0000"><b>else
       </b></font>short<font color="#000080">(</font><font color="#800000">'Cannot create file '</font><font color="#000080">+</font>outfn<font color="#000080">);

    </font>decode<font color="#000080">;
    </font>readln<font color="#000080">(</font>inf<font color="#000080">,</font>buf<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>tag3 <font color="#000080">&lt;&gt; </font><font color="#800000">'end' </font><font color="#FF0000"><b>then
      </b></font>short<font color="#000080">(</font><font color="#800000">'Warning: no end line'</font><font color="#000080">);
    </font>close<font color="#000080">(</font>inf<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>open <font color="#FF0000"><b>then
      </b></font>close<font color="#000080">(</font>outf<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p></body>
</html>
