<html>
<head><title> "General Useful Routines" by WILLIAM BARATH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0142.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Goodies<font color="#000080">; </font><font color="#008000"><i>{Collection of things I wish were in the System Unit}

</i></font><font color="#FF0000"><b>Interface
Type </b></font>Fixed<font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>F<font color="#000080">:</font>Word<font color="#000080">;</font>W<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>r<font color="#000080">,</font>r2<font color="#000080">,</font>r3<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Greater<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Lesser<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Perturb<font color="#000080">:</font>Word<font color="#000080">;  </font><font color="#008000"><i>{Peturbation algorhythm (C) 1982 BarathSoft}
</i></font><font color="#FF0000"><b>Function </b></font>QRandWord<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>QRand<font color="#000080">(</font>n<font color="#000080">:</font>Word<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SQRoot<font color="#000080">(</font>N<font color="#000080">:</font>LongInt<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SGN<font color="#000080">(</font>n<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Function </b></font>Greater<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">Mov  ax,a
  Mov  bx,b
  Cmp  ax,bx
  Jnc  @done
  Xchg ax,bx
@Done:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Lesser<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">Mov  ax,a
  Mov  bx,b
  Cmp  ax,bx
  Jc   @done
  Xchg ax,bx
@Done:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Perturb<font color="#000080">:</font>Word<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;  </font><font color="#008000"><i>{Peturbation algorhythm (C) 1982 
BarathSoft}
{Delta 2904 yields 65534 length pseudorandom sequence}
</i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">Mov ax,r; Xor ax,$a5a5; add ax,ax; adc ax,2904; Mov r,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>QRandWord<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">Call Perturb; Add ax,r2;Mov r2,ax;Xor ax,r3;Mov r3,ax;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>QRand<font color="#000080">(</font>n<font color="#000080">:</font>Word<font color="#000080">):</font>word<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">Call QRandWord; Mul n; Mov ax,dx; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SQRoot<font color="#000080">(</font>N<font color="#000080">:</font>LongInt<font color="#000080">):</font>Word<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">Mov si,-1
  Mov cx,n+2.word
  Test ch,$80
  JNZ @Error
  Mov bx,n.word
  Mov di,32768
  Xor si,si
@DoSqrt:
  Mov ax,si
  Or  ax,di
  Mul ax
  Cmp dx,cx
  Ja  @NoSet
  Jnz @Set
  Cmp ax,bx
  Ja  @Noset
@Set:
  Or  si,di
@Noset:
  Shr di,1
  Jnz @DoSqrt
@Error:
  Mov ax,si
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SGN<font color="#000080">(</font>n<font color="#000080">:</font>Integer<font color="#000080">):</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">Xor ax,ax
  Cmp n,ax
  Js  @neg
  Inc ax
  Jmp @</font><font color="#FF0000"><b>end
</b></font><font color="#000080">@</font>neg<font color="#000080">:
  </font>Dec ax
<font color="#000080">@</font><font color="#FF0000"><b>end</b></font><font color="#000080">:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0142.PAS">Original</a><b>]</b></p></body>
</html>
