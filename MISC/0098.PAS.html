<html>
<head><title> "Amortization Routine" by RICHARD ODOM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>amort<font color="#000080">;

</font><font color="#008000"><i>{ This program does a good job of loan amortization. The original
  author is unknown. I added a procedure to exit the program without
  showing all years for amortization. Richard Odom..VA Beach        }

</i></font><font color="#FF0000"><b>const
  </b></font>MonthTab <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">; </font><font color="#008000"><i>{month column}
  </i></font>PayTab <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;  </font><font color="#008000"><i>{payment column}
  </i></font>PrinTab <font color="#000080">= </font><font color="#800000">28</font><font color="#000080">; </font><font color="#008000"><i>{principle column}
  </i></font>IntTab <font color="#000080">= </font><font color="#800000">41</font><font color="#000080">;  </font><font color="#008000"><i>{interest column}
  </i></font>BalTab <font color="#000080">= </font><font color="#800000">53</font><font color="#000080">;  </font><font color="#008000"><i>{balance column}


</i></font><font color="#FF0000"><b>var
  </b></font>balance<font color="#000080">, </font>payment<font color="#000080">, </font>interest<font color="#000080">, </font>rate<font color="#000080">, </font>years<font color="#000080">,
  </font>i1<font color="#000080">, </font>i2<font color="#000080">, </font>CurrInt<font color="#000080">, </font>CurrPrin<font color="#000080">, </font>ypay<font color="#000080">, </font>yint<font color="#000080">, </font>yprin<font color="#000080">,
  </font>GTPay<font color="#000080">, </font>GTInt<font color="#000080">, </font>GTPrin<font color="#000080">:                            </font>real<font color="#000080">;
  </font>year<font color="#000080">, </font>month<font color="#000080">, </font>line<font color="#000080">:                            </font>integer<font color="#000080">;
  </font>borrower<font color="#000080">:                                  </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">32</font><font color="#000080">];
  </font>response<font color="#000080">:                                        </font>char<font color="#000080">;




</font><font color="#FF0000"><b>begin
  repeat

    </b></font>ClrScr<font color="#000080">;
    </font>write <font color="#000080">(</font><font color="#800000">'Name of borrower: '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>borrower<font color="#000080">);
    </font>write <font color="#000080">(</font><font color="#800000">'Amount of loan: '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>balance<font color="#000080">);
    </font>write <font color="#000080">(</font><font color="#800000">'Interest rate: '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>interest<font color="#000080">);
    </font>i1 <font color="#000080">:= </font>interest<font color="#000080">/</font><font color="#800000">1200 </font><font color="#008000"><i>{monthly interest}</i></font><font color="#000080">;
    </font>write <font color="#000080">(</font><font color="#800000">'Do you know the monthly payments? '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>response<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>UpCase<font color="#000080">(</font>response<font color="#000080">) = </font><font color="#800000">'Y'
      </font><font color="#FF0000"><b>then begin
        </b></font>write <font color="#000080">(</font><font color="#800000">'Payment amount: '</font><font color="#000080">);
        </font>readln <font color="#000080">(</font>payment<font color="#000080">);
      </font><font color="#FF0000"><b>end
      else begin
        </b></font>write <font color="#000080">(</font><font color="#800000">'Number of years: '</font><font color="#000080">);
        </font>readln <font color="#000080">(</font>years<font color="#000080">);
        </font>i2 <font color="#000080">:= </font>exp<font color="#000080">(</font>ln<font color="#000080">(</font>i1 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) * (</font><font color="#800000">12 </font><font color="#000080">* </font>years<font color="#000080">));
        </font>payment <font color="#000080">:= </font>balance <font color="#000080">* </font>i1 <font color="#000080">* </font>i2 <font color="#000080">/ (</font>i2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
        </font>payment <font color="#000080">:= </font>int<font color="#000080">(</font>payment <font color="#000080">* </font><font color="#800000">100 </font><font color="#000080">+ </font><font color="#800000">0.5</font><font color="#000080">) / </font><font color="#800000">100</font><font color="#000080">;
        </font>writeln <font color="#000080">(</font><font color="#800000">'The monthly payment is $'</font><font color="#000080">,</font>payment<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>write <font color="#000080">(</font><font color="#800000">'Starting year for loan: '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>year<font color="#000080">);
    </font>write <font color="#000080">(</font><font color="#800000">'Starting month for loan: '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>month<font color="#000080">);
    </font>write <font color="#000080">(</font><font color="#800000">'Press &lt;RETURN&gt; to see monthly totals.'</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>response<font color="#000080">);
    </font>ClrScr<font color="#000080">; </font>line <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
    </font>writeln <font color="#000080">(</font><font color="#800000">'Loan for '</font><font color="#000080">,</font>borrower<font color="#000080">);
    </font>writeln <font color="#000080">(</font><font color="#800000">' Loan of $'</font><font color="#000080">,</font>balance<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">' at '</font><font color="#000080">,</font>interest<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'% interest.'</font><font color="#000080">);
    </font>writeln <font color="#000080">(</font><font color="#800000">' Fixed monthly payments of $'</font><font color="#000080">,</font>payment<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">);
    </font>writeln<font color="#000080">;
    </font>writeln <font color="#000080">(</font>year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'  Month     Payment     Principle     Interest       Balance'</font><font color="#000080">);
    </font>ypay <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>yprin <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>yint <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>GTPay <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>GTInt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>GTPrin <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{initialize totals}

    </i></font><font color="#FF0000"><b>while </b></font>balance<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
      </b></font>CurrInt <font color="#000080">:= </font>int<font color="#000080">(</font><font color="#800000">100 </font><font color="#000080">* </font>i1 <font color="#000080">* </font>balance <font color="#000080">+</font><font color="#800000">0.5</font><font color="#000080">) / </font><font color="#800000">100</font><font color="#000080">;
      </font>CurrPrin <font color="#000080">:= </font>payment <font color="#000080">- </font>CurrInt<font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font>CurrPrin<font color="#000080">&gt;</font>balance <font color="#FF0000"><b>then begin
        </b></font>CurrPrin <font color="#000080">:= </font>balance<font color="#000080">;
        </font>payment <font color="#000080">:= </font>CurrInt <font color="#000080">+ </font>CurrPrin<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>balance <font color="#000080">:= </font>balance <font color="#000080">- </font>CurrPrin<font color="#000080">;
      </font>ypay <font color="#000080">:= </font>ypay <font color="#000080">+ </font>payment<font color="#000080">; </font>yint <font color="#000080">:= </font>yint <font color="#000080">+ </font>CurrInt<font color="#000080">; </font>yprin <font color="#000080">:= </font>yprin <font color="#000080">+ </font>CurrPrin<font color="#000080">;
      </font>GTPay <font color="#000080">:= </font>GTPay <font color="#000080">+ </font>payment<font color="#000080">; </font>GTInt <font color="#000080">:= </font>GTInt <font color="#000080">+ </font>CurrInt<font color="#000080">; </font>GTPrin <font color="#000080">:= </font>GTPrin <font color="#000080">+ </font>CurrPrin<font color="#000080">;
      </font>line <font color="#000080">:= </font>line <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font>GotoXY<font color="#000080">(</font>MonthTab<font color="#000080">,</font>line<font color="#000080">);
      </font>write <font color="#000080">(</font>month<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PayTab<font color="#000080">,</font>line<font color="#000080">);
      </font>write <font color="#000080">(</font>payment<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PrinTab<font color="#000080">,</font>line<font color="#000080">);
      </font>write <font color="#000080">(</font>CurrPrin<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>IntTab<font color="#000080">,</font>line<font color="#000080">);
      </font>write <font color="#000080">(</font>CurrInt<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>BalTab<font color="#000080">,</font>line<font color="#000080">);
      </font>writeln <font color="#000080">(</font>balance<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
      </font>month <font color="#000080">:= </font>month <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>month<font color="#000080">&gt;</font><font color="#800000">12</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>balance<font color="#000080">=</font><font color="#800000">0.0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>writeln<font color="#000080">; </font>line <font color="#000080">:= </font>line <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
        </font>write <font color="#000080">(</font>year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Total'</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PayTab<font color="#000080">,</font>line<font color="#000080">);
        </font>write <font color="#000080">(</font>ypay<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PrinTab<font color="#000080">,</font>line<font color="#000080">);
        </font>write <font color="#000080">(</font>yprin<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>IntTab<font color="#000080">,</font>line<font color="#000080">);
        </font>write <font color="#000080">(</font>yint<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>BalTab<font color="#000080">,</font>line<font color="#000080">);
        </font>writeln <font color="#000080">(</font>balance<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
        </font>year <font color="#000080">:= </font>year <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font>month <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>ypay <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>yprin <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>yint <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

        </font><font color="#FF0000"><b>if </b></font>balance<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
          </b></font>writeln<font color="#000080">;
          </font>writeln <font color="#000080">(</font><font color="#800000">'Press &lt;RETURN&gt; to see '</font><font color="#000080">,</font>year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">);
          </font>write<font color="#000080">(</font><font color="#800000">'Enter Q to end program  '</font><font color="#000080">);
          </font>readln <font color="#000080">(</font>response<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>upcase<font color="#000080">(</font>response<font color="#000080">)=</font><font color="#800000">'Q' </font><font color="#FF0000"><b>then
           </b></font>halt<font color="#000080">;
          </font>ClrScr<font color="#000080">; </font>line <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">; </font>writeln <font color="#000080">(</font>year<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">'  Month     Payment     Principle     Interest       Balance'</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{while}

    </i></font>writeln<font color="#000080">; </font>line <font color="#000080">:= </font>line <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
    </font>write <font color="#000080">(</font><font color="#800000">'Grand Total'</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PayTab<font color="#000080">,</font>line<font color="#000080">);
    </font>write <font color="#000080">(</font>GTPay<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>PrinTab<font color="#000080">,</font>line<font color="#000080">);
    </font>write <font color="#000080">(</font>GTPrin<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>IntTab<font color="#000080">,</font>line<font color="#000080">);
    </font>write <font color="#000080">(</font>GTInt<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">); </font>GotoXY<font color="#000080">(</font>BalTab<font color="#000080">,</font>line<font color="#000080">);
    </font>writeln <font color="#000080">(</font>balance<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
    </font>writeln<font color="#000080">;
    </font>write <font color="#000080">(</font><font color="#800000">'Do you wish to start over? '</font><font color="#000080">);
    </font>readln <font color="#000080">(</font>response<font color="#000080">);

  </font><font color="#FF0000"><b>until </b></font>UpCase<font color="#000080">(</font>response<font color="#000080">)=</font><font color="#800000">'N'</font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0098.PAS">Original</a><b>]</b></p></body>
</html>
