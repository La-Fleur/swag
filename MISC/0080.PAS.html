<html>
<head><title> "English Number Strings" by GAYLE DAVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$S-,R-,V-,I-,N-,B-,F-}

{
   Converts REAL number to ENGLISH strings
   GAYLE DAVIS 1/21/94
   Amounts up to and including $19,999,999.99 are supported.
   If you write amounts larger than that, you don't need a computer !!
   ======================================================================
   Dedicated to the PUBLIC DOMAIN, this software code has been tested and
   used under BP 7.0/DOS and MS-DOS 6.2.
}

{$IFNDEF Ver40}
  {Allow overlays}
  {$F+,O-,X+,A-}
{$ENDIF}

</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>CONST
     </b></font>Dot <font color="#000080">: </font>CHAR <font color="#000080">= </font><font color="#800000">#42</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
    </b></font>SS <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
    </font>AA <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>EnglishNumber <font color="#000080">(</font>Amt <font color="#000080">: </font>REAL<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>Mword <font color="#000080">= </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
  </font>Amstw <font color="#000080">= </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];  </font><font color="#008000"><i>{for function TenUnitToWord output}

</i></font><font color="#FF0000"><b>CONST
  </b></font>NumStr <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">27</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Mword <font color="#000080">=
         (</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">'ONE '</font><font color="#000080">, </font><font color="#800000">'TWO '</font><font color="#000080">, </font><font color="#800000">'THREE '</font><font color="#000080">, </font><font color="#800000">'FOUR '</font><font color="#000080">, </font><font color="#800000">'FIVE '</font><font color="#000080">, </font><font color="#800000">'SIX '</font><font color="#000080">, </font><font color="#800000">'SEVEN '</font><font color="#000080">,
          </font><font color="#800000">'EIGHT '</font><font color="#000080">,</font><font color="#800000">'NINE '</font><font color="#000080">, </font><font color="#800000">'TEN '</font><font color="#000080">, </font><font color="#800000">'ELEVEN '</font><font color="#000080">, </font><font color="#800000">'TWELVE '</font><font color="#000080">, </font><font color="#800000">'THIRTEEN '</font><font color="#000080">,
          </font><font color="#800000">'FOURTEEN '</font><font color="#000080">, </font><font color="#800000">'FIFTEEN '</font><font color="#000080">, </font><font color="#800000">'SIXTEEN '</font><font color="#000080">, </font><font color="#800000">'SEVENTEEN '</font><font color="#000080">, </font><font color="#800000">'EIGHTEEN '</font><font color="#000080">,
          </font><font color="#800000">'NINETEEN '</font><font color="#000080">, </font><font color="#800000">'TWENTY '</font><font color="#000080">, </font><font color="#800000">'THIRTY '</font><font color="#000080">, </font><font color="#800000">'FORTY '</font><font color="#000080">, </font><font color="#800000">'FIFTY '</font><font color="#000080">, </font><font color="#800000">'SIXTY '</font><font color="#000080">,
          </font><font color="#800000">'SEVENTY '</font><font color="#000080">, </font><font color="#800000">'EIGHTY '</font><font color="#000080">, </font><font color="#800000">'NINETY '</font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>S               <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font>Temp            <font color="#000080">: </font>REAL<font color="#000080">;
  </font>DigitA<font color="#000080">, </font>DigitB  <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>Ams             <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font>Ac              <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];

</font><font color="#FF0000"><b>FUNCTION </b></font>TenUnitToWord <font color="#000080">(</font>TeUn <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>Amstw<font color="#000080">;
         </font><font color="#008000"><i>{ convert tens and units to words }
  </i></font><font color="#FF0000"><b>BEGIN
    IF </b></font>TeUn <font color="#000080">&lt; </font><font color="#800000">21 </font><font color="#FF0000"><b>THEN </b></font>TenUnitToWord <font color="#000080">:= </font>NumStr <font color="#000080">[</font>TeUn<font color="#000080">]
      </font><font color="#FF0000"><b>ELSE </b></font>TenUnitToWord <font color="#000080">:= </font>NumStr <font color="#000080">[</font>TeUn <font color="#FF0000"><b>DIV </b></font><font color="#800000">10 </font><font color="#000080">+ </font><font color="#800000">18</font><font color="#000080">] + </font>NumStr <font color="#000080">[</font>TeUn <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{function TenUnitToWord}

</i></font><font color="#FF0000"><b>BEGIN

  </b></font><font color="#008000"><i>{ Nothing bigger than 20 million }
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Amt <font color="#000080">&gt; </font><font color="#800000">20000000.0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Amt <font color="#000080">&lt;= </font><font color="#800000">0.0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>EnglishNumber <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;  </font><font color="#008000"><i>{null string if out of range}
      </i></font>EXIT<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Convert 1,000,000 decade }
  </i></font>Ams <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>DigitA <font color="#000080">:= </font>TRUNC <font color="#000080">(</font>Amt <font color="#000080">/ </font><font color="#800000">1E6</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>DigitA <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>NumStr <font color="#000080">[</font>DigitA<font color="#000080">] + </font><font color="#800000">'MILLION '</font><font color="#000080">;
  </font>Temp <font color="#000080">:= </font>Amt <font color="#000080">- </font>DigitA <font color="#000080">* </font><font color="#800000">1E6</font><font color="#000080">;

  </font><font color="#008000"><i>{ Convert 100,000, 10,000, 1,000 decades }

  </i></font>DigitA <font color="#000080">:= </font>TRUNC <font color="#000080">(</font>Temp <font color="#000080">/ </font><font color="#800000">1E5</font><font color="#000080">);         </font><font color="#008000"><i>{extract 100,000 decade}
  </i></font><font color="#FF0000"><b>IF </b></font>DigitA <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>NumStr <font color="#000080">[</font>DigitA<font color="#000080">] + </font><font color="#800000">'HUNDRED '</font><font color="#000080">;
  </font>Temp <font color="#000080">:= </font>Temp <font color="#000080">- </font>DigitA <font color="#000080">* </font><font color="#800000">1E5</font><font color="#000080">;
  </font>DigitB <font color="#000080">:= </font>TRUNC <font color="#000080">(</font>Temp <font color="#000080">/ </font><font color="#800000">1000</font><font color="#000080">);        </font><font color="#008000"><i>{extract sum of 10,000 and 1,000 decades}
  </i></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>TenUnitToWord <font color="#000080">(</font>DigitB<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>DigitA <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>DigitB <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font><font color="#800000">'THOUSAND '</font><font color="#000080">;

  </font><font color="#008000"><i>{Convert 100, 10, unit decades}

  </i></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">- </font>DigitB <font color="#000080">* </font><font color="#800000">1000.0</font><font color="#000080">;
  </font>DigitA <font color="#000080">:= </font>TRUNC <font color="#000080">(</font>Temp <font color="#000080">/ </font><font color="#800000">100</font><font color="#000080">);          </font><font color="#008000"><i>{extract 100 decade}
  </i></font><font color="#FF0000"><b>IF </b></font>DigitA <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>NumStr <font color="#000080">[</font>DigitA<font color="#000080">] + </font><font color="#800000">'HUNDRED '</font><font color="#000080">;
  </font>DigitB <font color="#000080">:= </font>TRUNC <font color="#000080">(</font>Temp <font color="#000080">- </font>DigitA <font color="#000080">* </font><font color="#800000">100.0</font><font color="#000080">);  </font><font color="#008000"><i>{extract sum of 10 and unit decades}
  </i></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>TenUnitToWord <font color="#000080">(</font>DigitB<font color="#000080">);

  </font><font color="#008000"><i>{Convert cents to form XX/100}

  </i></font><font color="#FF0000"><b>IF </b></font>INT <font color="#000080">(</font>Amt<font color="#000080">) &gt; </font><font color="#800000">0.0 </font><font color="#FF0000"><b>THEN </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font><font color="#800000">'AND '</font><font color="#000080">;
  </font>DigitA <font color="#000080">:= </font>ROUND <font color="#000080">( (</font>FRAC <font color="#000080">(</font>Amt<font color="#000080">) * </font><font color="#800000">100</font><font color="#000080">) );
  </font><font color="#FF0000"><b>IF </b></font>DigitA <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>STR <font color="#000080">(</font>DigitA <font color="#000080">: </font><font color="#800000">2</font><font color="#000080">, </font>Ac<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>Ac <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>THEN </b></font>Ac <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
      </font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font>Ac <font color="#000080">+ </font><font color="#800000">'/100'
    </font><font color="#FF0000"><b>END
  ELSE </b></font>Ams <font color="#000080">:= </font>Ams <font color="#000080">+ </font><font color="#800000">'NO/100'</font><font color="#000080">;

  </font>EnglishNumber <font color="#000080">:= </font>Ams <font color="#000080">+ </font><font color="#800000">' Dollars'</font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font>ClrScr<font color="#000080">;
</font>WriteLn<font color="#000080">(</font>EnglishNumber <font color="#000080">(</font><font color="#800000">1234.55</font><font color="#000080">));
</font>WriteLn<font color="#000080">(</font>EnglishNumber <font color="#000080">(</font><font color="#800000">991234.55</font><font color="#000080">));
</font>WriteLn<font color="#000080">(</font>EnglishNumber <font color="#000080">(</font><font color="#800000">19891234.55</font><font color="#000080">));
</font>Readkey<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p></body>
</html>
