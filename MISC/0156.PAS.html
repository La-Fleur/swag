<html>
<head><title> "National language support" by FERNAND LEMOINE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0156.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>UNIT </b></font>nlcs<font color="#000080">;


 </font><font color="#008000"><i>(*  DESCRIPTION :
    National language and country support
      - 18 countries with ISO and DOS convention
      - 6 languages  English Franáais Deutsch Nederland Espa&curren;ol Italiano
        for language name, month name, day name,
            yes/no name, true/false name, compare name
      - 18  currencies  with ISO and DOS convention
      - code page
      - local and universal time for every country  in the world
          new type TIMESTAMP
          summer time supported
          time zone indicated by city name e.g. PARIS,LONDON,NEW-YORK
                                 convention     EST,TU
      - local country , local currency and local time zone autodetection

     RELEASE     :  1.0
     DATE        :  30/09/94
     AUTHOR      :  Fernand LEMOINE
                    rue du Colläge 34
                    B-6200 CHATELET
                    BELGIQUE
     All code granted to the public domain
     Questions and comments are welcome
     REQUIREMENT :  Turbo Pascal 5.0 or later
                    Opdate, Opstring, Opabsfld from Object Professional
     NOT Compatible with Borland Pascal protected mode !!
  *)


</i></font><font color="#FF0000"><b>INTERFACE
USES </b></font>opdate<font color="#000080">, </font>opstring<font color="#000080">, </font>opabsfld<font color="#000080">;
</font><font color="#FF0000"><b>TYPE
  </b></font>Str3 <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>LanguageType <font color="#000080">= (</font>nolang<font color="#000080">, </font>english<font color="#000080">, </font>francais<font color="#000080">, </font>deutch<font color="#000080">,
                  </font>nederland<font color="#000080">, </font>espanol<font color="#000080">, </font>italiano<font color="#000080">);

  </font>Currency_Iso <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                   </b></font>code <font color="#000080">: </font>Str3<font color="#000080">;
                   </font>mon <font color="#000080">: </font>Str3<font color="#000080">;
                   </font>country <font color="#000080">: </font>Str3<font color="#000080">;
                   </font>tzname <font color="#000080">: </font>Char<font color="#000080">;
                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>World_TimeStr <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                    </b></font>abrev <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                    </font>tzone <font color="#000080">: </font>Char<font color="#000080">;
                    </font>offset <font color="#000080">: </font>Real<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Timestamp <font color="#000080">=
    </font><font color="#FF0000"><b>RECORD
      </b></font>D <font color="#000080">: </font>Date<font color="#000080">;
      </font>T <font color="#000080">: </font>Time<font color="#000080">;
      </font>Indic <font color="#000080">: </font>Char<font color="#000080">;
      </font>MilliTM <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>Wday <font color="#000080">: </font>DayType<font color="#000080">;
      </font>YDay <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>YWeek <font color="#000080">: </font>Byte<font color="#000080">;
      </font>IsDST <font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>Currentcountry <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">;
  </font>Nb_Of_Currency <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">;
  </font>Nb_of_WorldTime <font color="#000080">= </font><font color="#800000">27</font><font color="#000080">;
  </font>MaxLanguage <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;

  </font>Table_Currency_iso <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Nb_Of_Currency<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Currency_Iso <font color="#000080">=
  ((</font>code <font color="#000080">: </font><font color="#800000">'1'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'USD'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'US'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'R'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'2'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'CAD'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'CA'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'R'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'31'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'NLG'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'NL'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'32'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'BEF'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'BE'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'33'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'FRF'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'FR'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'34'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'ESP'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'ES'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'39'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'ITL'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'IT'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'41'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'CHF'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'CH'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'44'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'GBP'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'GB'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'Z'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'45'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'DKK'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'DK'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'46'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'SEK'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'SE'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'47'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'NOK'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'NO'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'49'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'DEM'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'DE'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'61'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'AUD'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'AU'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'K'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'81'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'JPY'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'JP'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'I'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'351'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'PTE'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'PT'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'Z'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'358'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'FIM'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'FI'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'B'</font><font color="#000080">),
   (</font>code <font color="#000080">: </font><font color="#800000">'972'</font><font color="#000080">; </font>mon <font color="#000080">: </font><font color="#800000">'ILS'</font><font color="#000080">; </font>country <font color="#000080">: </font><font color="#800000">'IL'</font><font color="#000080">; </font>tzname <font color="#000080">: </font><font color="#800000">'B'</font><font color="#000080">)
   );

  </font>Table_WorldTime <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Nb_of_WorldTime<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>World_TimeStr <font color="#000080">=
  ((</font>abrev <font color="#000080">: </font><font color="#800000">'Z/LONDON/UT/GMT'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'Z'</font><font color="#000080">; </font>offset <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'A/PARIS/CET'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'A'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">1</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'B/CAIRO'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'B'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">2</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'C/MOSCOW/BAGDAD'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'C'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">3</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'D/DUBAI'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'D'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">4</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'E/KARACHI'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'E'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">5</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'F/DACCA'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'F'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">6</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'G/BANGKOK'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'G'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">7</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'H/HONG KONG/PERTH'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'H'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">8</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'I/TOKYO'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'I'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">9</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'K/SYDNEY'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'K'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">10</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'L/NOUMEA'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'L'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">11</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'M/WELLINGTON'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'M'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">12</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'N/AZORCS'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'N'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">1</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'O/FERNANDO'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'O'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">2</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'P/RIO'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'P'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">3</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'Q/CARACAS/IST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'Q'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">4</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'R/NEW YORK/EST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'R'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">5</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'S/CHICAGO/CST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'S'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">6</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'T/DENVER/MST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'T'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">7</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'U/LOS ANGELES/PST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'U'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">8</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'V/ANCHORAGE/AST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'V'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">9</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'W/HONOLULU'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'W'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">10</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'X/MIDWAY'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'X'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">11</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'TERRE NEUVE/NST'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'Y'</font><font color="#000080">; </font>offset <font color="#000080">: - </font><font color="#800000">3.30</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'TEHERAN'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'Y'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">3.30</font><font color="#000080">),
   (</font>abrev <font color="#000080">: </font><font color="#800000">'NEW DELHI'</font><font color="#000080">; </font>tzone <font color="#000080">: </font><font color="#800000">'Y'</font><font color="#000080">; </font>offset <font color="#000080">: + </font><font color="#800000">5.30</font><font color="#000080">));

  </font>LanguageNames <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font>LanguageType<font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] =
  (</font><font color="#800000">'NoLanguage'</font><font color="#000080">, </font><font color="#800000">'English'</font><font color="#000080">, </font><font color="#800000">'Franáais'</font><font color="#000080">, </font><font color="#800000">'Deutsch'</font><font color="#000080">, </font><font color="#800000">'Nederland'</font><font color="#000080">,
   </font><font color="#800000">'Espa&curren;ol'</font><font color="#000080">, </font><font color="#800000">'Italiano'</font><font color="#000080">);


  </font>InternationalMonthString <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLanguage<font color="#000080">]
  </font><font color="#FF0000"><b>OF ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] =

  ((</font><font color="#800000">'January'</font><font color="#000080">, </font><font color="#800000">'February'</font><font color="#000080">, </font><font color="#800000">'March'</font><font color="#000080">, </font><font color="#800000">'April'</font><font color="#000080">, </font><font color="#800000">'May'</font><font color="#000080">, </font><font color="#800000">'June'</font><font color="#000080">, </font><font color="#800000">'July'</font><font color="#000080">,
    </font><font color="#800000">'August'</font><font color="#000080">, </font><font color="#800000">'September'</font><font color="#000080">, </font><font color="#800000">'October'</font><font color="#000080">, </font><font color="#800000">'November'</font><font color="#000080">, </font><font color="#800000">'December'</font><font color="#000080">),
   (</font><font color="#800000">'janvier'</font><font color="#000080">, </font><font color="#800000">'fÇvrier'</font><font color="#000080">, </font><font color="#800000">'mars'</font><font color="#000080">, </font><font color="#800000">'avril'</font><font color="#000080">, </font><font color="#800000">'mai'</font><font color="#000080">, </font><font color="#800000">'juin'</font><font color="#000080">, </font><font color="#800000">'juillet'</font><font color="#000080">,
    </font><font color="#800000">'aoñt'</font><font color="#000080">, </font><font color="#800000">'septembre'</font><font color="#000080">, </font><font color="#800000">'octobre'</font><font color="#000080">, </font><font color="#800000">'novembre'</font><font color="#000080">, </font><font color="#800000">'dÇcembre'</font><font color="#000080">),
   (</font><font color="#800000">'Januar'</font><font color="#000080">, </font><font color="#800000">'Februar'</font><font color="#000080">, </font><font color="#800000">'Marz'</font><font color="#000080">, </font><font color="#800000">'April'</font><font color="#000080">, </font><font color="#800000">'Mai'</font><font color="#000080">, </font><font color="#800000">'Juni'</font><font color="#000080">, </font><font color="#800000">'Juli'</font><font color="#000080">,
    </font><font color="#800000">'August'</font><font color="#000080">, </font><font color="#800000">'September'</font><font color="#000080">, </font><font color="#800000">'Oktober'</font><font color="#000080">, </font><font color="#800000">'November'</font><font color="#000080">, </font><font color="#800000">'Dezember'</font><font color="#000080">),
   (</font><font color="#800000">'Januari'</font><font color="#000080">, </font><font color="#800000">'Februari'</font><font color="#000080">, </font><font color="#800000">'Maart'</font><font color="#000080">, </font><font color="#800000">'April'</font><font color="#000080">, </font><font color="#800000">'Mei'</font><font color="#000080">, </font><font color="#800000">'Juni'</font><font color="#000080">, </font><font color="#800000">'Juli'</font><font color="#000080">,
    </font><font color="#800000">'Augustus'</font><font color="#000080">, </font><font color="#800000">'September'</font><font color="#000080">, </font><font color="#800000">'October'</font><font color="#000080">, </font><font color="#800000">'November'</font><font color="#000080">, </font><font color="#800000">'December'</font><font color="#000080">),
   (</font><font color="#800000">'Enero'</font><font color="#000080">, </font><font color="#800000">'Febrero'</font><font color="#000080">, </font><font color="#800000">'Marzo'</font><font color="#000080">, </font><font color="#800000">'Abril'</font><font color="#000080">, </font><font color="#800000">'Mayo'</font><font color="#000080">, </font><font color="#800000">'Junio'</font><font color="#000080">, </font><font color="#800000">'Julio'</font><font color="#000080">,
    </font><font color="#800000">'Agosto'</font><font color="#000080">, </font><font color="#800000">'Septiembre'</font><font color="#000080">, </font><font color="#800000">'Octubre'</font><font color="#000080">, </font><font color="#800000">'Noviembre'</font><font color="#000080">, </font><font color="#800000">'Diciembre'</font><font color="#000080">),
   (</font><font color="#800000">'Gennaio'</font><font color="#000080">, </font><font color="#800000">'Febbraio'</font><font color="#000080">, </font><font color="#800000">'Marzo'</font><font color="#000080">, </font><font color="#800000">'Aprile'</font><font color="#000080">, </font><font color="#800000">'Maggio'</font><font color="#000080">, </font><font color="#800000">'Giugno'</font><font color="#000080">, </font><font color="#800000">'Luglio'</font><font color="#000080">,
    </font><font color="#800000">'Agusto'</font><font color="#000080">, </font><font color="#800000">'Settembre'</font><font color="#000080">, </font><font color="#800000">'Ottobre'</font><font color="#000080">, </font><font color="#800000">'Novembre'</font><font color="#000080">, </font><font color="#800000">'Dicembre'</font><font color="#000080">));

  </font>InternationalDayString <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLanguage<font color="#000080">, </font>DayType<font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] =

  ((</font><font color="#800000">'Sunday'</font><font color="#000080">, </font><font color="#800000">'Monday'</font><font color="#000080">, </font><font color="#800000">'Tuesday'</font><font color="#000080">, </font><font color="#800000">'Wednesday'</font><font color="#000080">, </font><font color="#800000">'Thursday'</font><font color="#000080">, </font><font color="#800000">'Friday'</font><font color="#000080">, </font><font color="#800000">'Saturday'</font><font color="#000080">),
   (</font><font color="#800000">'dimanche'</font><font color="#000080">, </font><font color="#800000">'lundi'</font><font color="#000080">, </font><font color="#800000">'mardi'</font><font color="#000080">, </font><font color="#800000">'mercredi'</font><font color="#000080">, </font><font color="#800000">'jeudi'</font><font color="#000080">, </font><font color="#800000">'vendredi'</font><font color="#000080">, </font><font color="#800000">'samedi'</font><font color="#000080">),
   (</font><font color="#800000">'Sonntag'</font><font color="#000080">, </font><font color="#800000">'Montag'</font><font color="#000080">, </font><font color="#800000">'Dienstag'</font><font color="#000080">, </font><font color="#800000">'Mittwoch'</font><font color="#000080">, </font><font color="#800000">'Donnerstag'</font><font color="#000080">, </font><font color="#800000">'Freitag'</font><font color="#000080">, </font><font color="#800000">'Samstag'</font><font color="#000080">),
   (</font><font color="#800000">'Zondag'</font><font color="#000080">, </font><font color="#800000">'Maandag'</font><font color="#000080">, </font><font color="#800000">'Dinsdag'</font><font color="#000080">, </font><font color="#800000">'Woensdag'</font><font color="#000080">, </font><font color="#800000">'Donderdag'</font><font color="#000080">, </font><font color="#800000">'Vrijdag'</font><font color="#000080">, </font><font color="#800000">'Zaterdag'</font><font color="#000080">),
   (</font><font color="#800000">'Dominguo'</font><font color="#000080">, </font><font color="#800000">'Lunes'</font><font color="#000080">, </font><font color="#800000">'Martes'</font><font color="#000080">, </font><font color="#800000">'Miercoles'</font><font color="#000080">, </font><font color="#800000">'Jueves'</font><font color="#000080">, </font><font color="#800000">'Viernes'</font><font color="#000080">, </font><font color="#800000">'Sabado'</font><font color="#000080">),
   (</font><font color="#800000">'Domenica'</font><font color="#000080">, </font><font color="#800000">'Lunedi'</font><font color="#000080">, </font><font color="#800000">'Martedi'</font><font color="#000080">, </font><font color="#800000">'Mercoledi'</font><font color="#000080">, </font><font color="#800000">'Giovedi'</font><font color="#000080">, </font><font color="#800000">'Venerdi'</font><font color="#000080">, </font><font color="#800000">'Sabato'</font><font color="#000080">));

  </font>InternationalTrueFalse <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLanguage<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char <font color="#000080">=
  ((</font><font color="#800000">'Y'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">), (</font><font color="#800000">'O'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">), (</font><font color="#800000">'J'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">), (</font><font color="#800000">'J'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">), (</font><font color="#800000">'S'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">), (</font><font color="#800000">'S'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">));

  </font>InternationalYesNo <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLanguage<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char <font color="#000080">=
  ((</font><font color="#800000">'T'</font><font color="#000080">, </font><font color="#800000">'F'</font><font color="#000080">), (</font><font color="#800000">'V'</font><font color="#000080">, </font><font color="#800000">'F'</font><font color="#000080">), (</font><font color="#800000">'W'</font><font color="#000080">, </font><font color="#800000">'F'</font><font color="#000080">), (</font><font color="#800000">'W'</font><font color="#000080">, </font><font color="#800000">'V'</font><font color="#000080">), (</font><font color="#800000">'V'</font><font color="#000080">, </font><font color="#800000">'F'</font><font color="#000080">), (</font><font color="#800000">'V'</font><font color="#000080">, </font><font color="#800000">'F'</font><font color="#000080">));

  </font>InternationalCompareString <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxLanguage<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">] =
  ((</font><font color="#800000">'Less'</font><font color="#000080">, </font><font color="#800000">'Equal'</font><font color="#000080">, </font><font color="#800000">'Greater'</font><font color="#000080">),
   (</font><font color="#800000">'Moins'</font><font color="#000080">, </font><font color="#800000">'êgal'</font><font color="#000080">, </font><font color="#800000">'Plus'</font><font color="#000080">),
   (</font><font color="#800000">'Minder'</font><font color="#000080">, </font><font color="#800000">'Gleich'</font><font color="#000080">, </font><font color="#800000">'Mehr'</font><font color="#000080">),
   (</font><font color="#800000">'Minder'</font><font color="#000080">, </font><font color="#800000">'Gelijk'</font><font color="#000080">, </font><font color="#800000">'Meer'</font><font color="#000080">),
   (</font><font color="#800000">'Menos '</font><font color="#000080">, </font><font color="#800000">'Igual '</font><font color="#000080">, </font><font color="#800000">'M†s'</font><font color="#000080">),
   (</font><font color="#800000">'Meno  '</font><font color="#000080">, </font><font color="#800000">'Eguale'</font><font color="#000080">, </font><font color="#800000">'Pió'</font><font color="#000080">));

</font><font color="#FF0000"><b>VAR
  </b></font>Language <font color="#000080">: </font>LanguageType<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>GetCodePage <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetCodePage<font color="#000080">(</font>valeur <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#008000"><i>(* Return number  *)
</i></font><font color="#FF0000"><b>FUNCTION  </b></font>GetCountry <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#008000"><i>(* Return ISO convention  *)
</i></font><font color="#FF0000"><b>FUNCTION  </b></font>GetCountryStr <font color="#000080">: </font>Str3<font color="#000080">;

</font><font color="#008000"><i>(* value can be ISO convention e.g. BE
                 or number in alphabetic form   e.g. '32'     *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetCountry<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetLanguage<font color="#000080">(</font>Val <font color="#000080">: </font>LanguageType<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>GetLanguage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;


</font><font color="#008000"><i>(* Give correct alphabetic order with current code page  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompIntString<font color="#000080">(</font>S1<font color="#000080">, </font>S2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>CompareType<font color="#000080">;


</font><font color="#008000"><i>(* Value can be ISO convention e.g. BE
                 or number in alphabetic form   e.g. '32'     *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>ConvertToCountry<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#008000"><i>(* Return ISO convention for currency *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CurrencyIso<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">);

</font><font color="#FF0000"><b>FUNCTION </b></font>DayOfYear<font color="#000080">(</font>Julian <font color="#000080">: </font>Date<font color="#000080">) : </font>Word<font color="#000080">;

  </font><font color="#008000"><i>(* Week 1 is the first week that contains a Thursay   *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>WeekOfYear<font color="#000080">(</font>Julian <font color="#000080">: </font>Date<font color="#000080">) : </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CurrentDateTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);

</font><font color="#008000"><i>(* tzname can be a city name or an abbreviation
   daylight must be modified for summer time *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetLocalTime<font color="#000080">(</font>tzname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>daylight <font color="#000080">: </font>Byte<font color="#000080">;
                       </font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetUniversalTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);

</font><font color="#008000"><i>(* To bypass  autodetection  *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetTimeZone<font color="#000080">(</font>tzname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>daylight <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>tz <font color="#000080">: </font>Char<font color="#000080">);


</font><font color="#FF0000"><b>IMPLEMENTATION
USES </b></font>dos<font color="#000080">, </font>opdos<font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>Delims <font color="#000080">: </font><font color="#FF0000"><b>SET OF </b></font>Char <font color="#000080">= [</font><font color="#800000">','</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">];
</font><font color="#FF0000"><b>TYPE
  </b></font>PCollating <font color="#000080">= ^</font>TCollating<font color="#000080">;
  </font>TCollating <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                 </b></font>len <font color="#000080">: </font>Word<font color="#000080">;
                 </font>table <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>TimeZone <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>CollatingSequence <font color="#000080">: </font>PCollating<font color="#000080">;
  </font>TimeZoneName <font color="#000080">: </font>Char<font color="#000080">;


  </font><font color="#FF0000"><b>FUNCTION </b></font>GetCodePage <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>reg <font color="#000080">: </font>registers<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    WITH </b></font>reg <font color="#FF0000"><b>DO
    BEGIN
      </b></font>AH <font color="#000080">:= </font><font color="#800000">$66</font><font color="#000080">;
      </font>AL <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
      </font>MsDos<font color="#000080">(</font>reg<font color="#000080">);
      </font>GetCodePage <font color="#000080">:= </font>BX<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>SetCodePage<font color="#000080">(</font>valeur <font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>reg <font color="#000080">: </font>registers<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    WITH </b></font>reg <font color="#FF0000"><b>DO
    BEGIN
      </b></font>AH <font color="#000080">:= </font><font color="#800000">$66</font><font color="#000080">;
      </font>AL <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;
      </font>BX <font color="#000080">:= </font>valeur<font color="#000080">;
      </font>MsDos<font color="#000080">(</font>reg<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)


  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>InternationalCollating<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>CollatingSeq <font color="#000080">: </font>PCollating<font color="#000080">);
  </font><font color="#FF0000"><b>TYPE
    </b></font>Tinfo <font color="#000080">= </font><font color="#FF0000"><b>RECORD
              </b></font>id <font color="#000080">: </font>Byte<font color="#000080">;
              </font>P <font color="#000080">: </font>Pointer<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;
    </font>info <font color="#000080">: </font>Tinfo<font color="#000080">;
    </font>i <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    WITH </b></font>regs <font color="#FF0000"><b>DO
    BEGIN
      </b></font>AH <font color="#000080">:= </font><font color="#800000">$65</font><font color="#000080">;
      </font>AL <font color="#000080">:= </font><font color="#800000">$06</font><font color="#000080">;
      </font>BX <font color="#000080">:= </font>GetCodePage<font color="#000080">;
      </font>CX <font color="#000080">:= </font><font color="#800000">$5</font><font color="#000080">;
      </font>DX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>info<font color="#000080">);
      </font>DI <font color="#000080">:= </font>Ofs<font color="#000080">(</font>info<font color="#000080">);
      </font>MsDos<font color="#000080">(</font>regs<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>CollatingSeq <font color="#000080">:= </font>info<font color="#000080">.</font>P<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>CompIntString<font color="#000080">(</font>S1<font color="#000080">, </font>S2 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>CompareType<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>S1<font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>S1<font color="#000080">[</font>i<font color="#000080">] := (</font>CollatingSequence<font color="#000080">^.</font>table<font color="#000080">[</font>Ord<font color="#000080">(</font>S1<font color="#000080">[</font>i<font color="#000080">])]);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>S2<font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>S2<font color="#000080">[</font>i<font color="#000080">] := </font>CollatingSequence<font color="#000080">^.</font>table<font color="#000080">[</font>Ord<font color="#000080">(</font>S2<font color="#000080">[</font>i<font color="#000080">])];
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>CompIntString <font color="#000080">:= </font>CompString<font color="#000080">(</font>S1<font color="#000080">, </font>S2<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>DayOfYear<font color="#000080">(</font>Julian <font color="#000080">: </font>Date<font color="#000080">) : </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Days <font color="#000080">: </font>Word<font color="#000080">;
    </font>FirstDay <font color="#000080">: </font>Date<font color="#000080">;
    </font>Secs <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>DT1<font color="#000080">, </font>DT2 <font color="#000080">: </font>DateTimeRec<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>DateToDMY<font color="#000080">(</font>Julian<font color="#000080">, </font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year<font color="#000080">);

    </font>FirstDay <font color="#000080">:= </font>DMYToDate<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font>Year<font color="#000080">);
    </font>DT1<font color="#000080">.</font>D <font color="#000080">:= </font>Julian<font color="#000080">;
    </font>DT1<font color="#000080">.</font>T <font color="#000080">:= </font>CurrentTime<font color="#000080">;
    </font>DT2<font color="#000080">.</font>D <font color="#000080">:= </font>FirstDay<font color="#000080">;
    </font>DT2<font color="#000080">.</font>T <font color="#000080">:= </font>CurrentTime<font color="#000080">;
    </font>DateTimeDiff<font color="#000080">(</font>DT1<font color="#000080">, </font>DT2<font color="#000080">, </font>Days<font color="#000080">, </font>Secs<font color="#000080">);
    </font>DayOfYear <font color="#000080">:= </font>Days <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>WeekOfYear<font color="#000080">(</font>Julian <font color="#000080">: </font>Date<font color="#000080">) : </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year <font color="#000080">: </font>Integer<font color="#000080">;
    </font>FirstDay <font color="#000080">: </font>Date<font color="#000080">;
    </font>Tmp<font color="#000080">, </font>tmp2 <font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>DateToDMY<font color="#000080">(</font>Julian<font color="#000080">, </font>Day<font color="#000080">, </font>Month<font color="#000080">, </font>Year<font color="#000080">);
    </font>FirstDay <font color="#000080">:= </font>DMYToDate<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, </font>Year<font color="#000080">);
    </font><font color="#FF0000"><b>CASE </b></font>DayOfWeek<font color="#000080">(</font>FirstDay<font color="#000080">) </font><font color="#FF0000"><b>OF
      </b></font>Sunday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
      </font>Monday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
      </font>Tuesday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
      </font>Wednesday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
      </font>Thursday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
      </font>Friday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
      </font>Saturday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>tmp2 <font color="#000080">:= (</font>DayOfYear<font color="#000080">(</font>Julian<font color="#000080">) + </font>Tmp<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tmp2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">((</font>Tmp <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Tmp <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Tmp <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>FirstDay <font color="#000080">:= </font>DMYToDate<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">, </font><font color="#800000">01</font><font color="#000080">, (</font>Year <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">));
      </font><font color="#FF0000"><b>CASE </b></font>DayOfWeek<font color="#000080">(</font>FirstDay<font color="#000080">) </font><font color="#FF0000"><b>OF
        </b></font>Sunday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
        </font>Monday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
        </font>Tuesday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
        </font>Wednesday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
        </font>Thursday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
        </font>Friday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
        </font>Saturday <font color="#000080">: </font>Tmp <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>tmp2 <font color="#000080">:= (</font>DayOfYear<font color="#000080">(</font>DMYToDate<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font>Year <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) + </font>Tmp<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>WeekOfYear <font color="#000080">:= </font>tmp2<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>(* ---------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetInternationalMonthDay<font color="#000080">(</font>Val <font color="#000080">: </font>LanguageType<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>value<font color="#000080">, </font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>j <font color="#000080">: </font>DayType<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>value <font color="#000080">:= </font>Ord<font color="#000080">(</font>Val<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">12 </font><font color="#FF0000"><b>DO
      </b></font>MonthString<font color="#000080">[</font>i<font color="#000080">] := </font>InternationalMonthString<font color="#000080">[</font>value<font color="#000080">, </font>i<font color="#000080">];
    </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font>Sunday <font color="#FF0000"><b>TO </b></font>Saturday <font color="#FF0000"><b>DO
      </b></font>DayString<font color="#000080">[</font>j<font color="#000080">] := </font>InternationalDayString<font color="#000080">[</font>value<font color="#000080">, </font>j<font color="#000080">];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*---------------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetDateTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);

  </font><font color="#FF0000"><b>BEGIN

    </b></font>TS<font color="#000080">.</font>Wday <font color="#000080">:= </font>DayOfWeek<font color="#000080">(</font>TS<font color="#000080">.</font>D<font color="#000080">);
    </font>TS<font color="#000080">.</font>YDay <font color="#000080">:= </font>DayOfYear<font color="#000080">(</font>TS<font color="#000080">.</font>D<font color="#000080">);
    </font>TS<font color="#000080">.</font>YWeek <font color="#000080">:= </font>WeekOfYear<font color="#000080">(</font>TS<font color="#000080">.</font>D<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Match<font color="#000080">(</font>S<font color="#000080">, </font>P <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Ind<font color="#000080">, </font>j<font color="#000080">, </font>N<font color="#000080">, </font>Nprime <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Prov <font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>Prov <font color="#000080">:= </font>False<font color="#000080">; </font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Ind <font color="#000080">:= </font>WordCount<font color="#000080">(</font>P<font color="#000080">, </font>Delims<font color="#000080">);
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&lt;= </font>Ind<font color="#000080">) </font><font color="#FF0000"><b>AND NOT </b></font>Prov <font color="#FF0000"><b>DO
    BEGIN
      </b></font>N <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>j<font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>j <font color="#000080">&lt; </font>Ind <font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Nprime <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
        </font>Prov <font color="#000080">:= </font>S <font color="#000080">= </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, </font>Nprime <font color="#000080">- </font>N <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>END
      ELSE
        </b></font>Prov <font color="#000080">:= </font>S <font color="#000080">= </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, (</font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
      </font>Inc<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Match <font color="#000080">:= </font>Prov<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*---------------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CurrentDateTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>TS<font color="#000080">.</font>MilliTM <font color="#000080">:= </font>TimeMS<font color="#000080">;
    </font>TS<font color="#000080">.</font>IsDST <font color="#000080">:= </font>False<font color="#000080">;
    </font>TS<font color="#000080">.</font>T <font color="#000080">:= </font>CurrentTime<font color="#000080">;
    </font>TS<font color="#000080">.</font>D <font color="#000080">:= </font>Today<font color="#000080">;
    </font>SetDateTime<font color="#000080">(</font>TS<font color="#000080">);
    </font>TS<font color="#000080">.</font>Indic <font color="#000080">:= </font>TimeZoneName<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*---------------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetLocalTime<font color="#000080">(</font>tzname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>daylight <font color="#000080">: </font>Byte<font color="#000080">;
                         </font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);

  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>off <font color="#000080">: </font>Real<font color="#000080">;
    </font>DT <font color="#000080">: </font>DateTimeRec<font color="#000080">;
    </font>found <font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>SetDateTime<font color="#000080">(</font>TS<font color="#000080">);
    </font>TS<font color="#000080">.</font>IsDST <font color="#000080">:= </font>daylight <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>IF NOT</b></font><font color="#000080">(</font>TS<font color="#000080">.</font>Indic <font color="#000080">= </font><font color="#800000">'Z'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>SetUniversalTime<font color="#000080">(</font>TS<font color="#000080">);
    </font>SetTimeZone<font color="#000080">(</font>tzname<font color="#000080">, </font>daylight<font color="#000080">, </font>TS<font color="#000080">.</font>Indic<font color="#000080">);
    </font>DT<font color="#000080">.</font>D <font color="#000080">:= </font>TS<font color="#000080">.</font>D<font color="#000080">; </font>DT<font color="#000080">.</font>T <font color="#000080">:= </font>TS<font color="#000080">.</font>T<font color="#000080">;
    </font>IncDateTime<font color="#000080">(</font>DT<font color="#000080">, </font>DT<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>TimeZone<font color="#000080">);
    </font>TS<font color="#000080">.</font>D <font color="#000080">:= </font>DT<font color="#000080">.</font>D<font color="#000080">; </font>TS<font color="#000080">.</font>T <font color="#000080">:= </font>DT<font color="#000080">.</font>T<font color="#000080">;

  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>(*---------------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetUniversalTime<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>TS <font color="#000080">: </font>Timestamp<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>DT <font color="#000080">: </font>DateTimeRec<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>SetDateTime<font color="#000080">(</font>TS<font color="#000080">);
    </font>DT<font color="#000080">.</font>D <font color="#000080">:= </font>TS<font color="#000080">.</font>D<font color="#000080">; </font>DT<font color="#000080">.</font>T <font color="#000080">:= </font>TS<font color="#000080">.</font>T<font color="#000080">;
    </font>IncDateTime<font color="#000080">(</font>DT<font color="#000080">, </font>DT<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, (</font>TimeZone <font color="#000080">* - </font><font color="#800000">1</font><font color="#000080">));
    </font>TS<font color="#000080">.</font>D <font color="#000080">:= </font>DT<font color="#000080">.</font>D<font color="#000080">; </font>TS<font color="#000080">.</font>T <font color="#000080">:= </font>DT<font color="#000080">.</font>T<font color="#000080">;
    </font>TS<font color="#000080">.</font>IsDST <font color="#000080">:= </font>False<font color="#000080">;
    </font>TS<font color="#000080">.</font>Indic <font color="#000080">:= </font><font color="#800000">'Z'</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*---------------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetTimeZone<font color="#000080">(</font>tzname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>daylight <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>tz <font color="#000080">: </font>Char<font color="#000080">);

  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>off <font color="#000080">: </font>Real<font color="#000080">;
    </font>found <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>found <font color="#000080">:= </font>False<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Nb_of_WorldTime<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>found<font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      IF </b></font>Match<font color="#000080">(</font>StUpCase<font color="#000080">(</font>tzname<font color="#000080">), </font>Table_WorldTime<font color="#000080">[</font>i<font color="#000080">].</font>abrev<font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>off <font color="#000080">:= </font>Table_WorldTime<font color="#000080">[</font>i<font color="#000080">].</font>offset<font color="#000080">;
        </font>tz <font color="#000080">:= </font>Table_WorldTime<font color="#000080">[</font>i<font color="#000080">].</font>tzone<font color="#000080">;
        </font>found <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>off <font color="#000080">:= </font>off <font color="#000080">+ </font>daylight<font color="#000080">;
    </font>TimeZone <font color="#000080">:= </font>Trunc<font color="#000080">(</font>Int<font color="#000080">(</font>off<font color="#000080">) * </font>SecondsInHour
                      <font color="#000080">+ (</font>Frac<font color="#000080">(</font>off<font color="#000080">) * </font><font color="#800000">100 </font><font color="#000080">* </font>SecondsInMinute<font color="#000080">));
    
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CurrencyTimeZone<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nb_Of_Currency <font color="#FF0000"><b>DO

      IF </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country <font color="#000080">= </font>value<font color="#000080">)

      </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>CurrencyLtStr <font color="#000080">:= </font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>mon<font color="#000080">;
        </font>CurrencyRtStr <font color="#000080">:= </font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>mon<font color="#000080">;
        </font>SetTimeZone<font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>tzname<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>TimeZoneName<font color="#000080">);

      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetCountry<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;
    </font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>valeur <font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nb_Of_Currency <font color="#FF0000"><b>DO
      IF </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
        IF </b></font>Str2word<font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code<font color="#000080">, </font>valeur<font color="#000080">) </font><font color="#FF0000"><b>THEN
        BEGIN
          WITH </b></font>regs <font color="#FF0000"><b>DO BEGIN
            </b></font><font color="#008000"><i>{get pointer to country information table}
            </i></font>AX <font color="#000080">:= </font><font color="#800000">$3800</font><font color="#000080">;
            </font>DX <font color="#000080">:= </font><font color="#800000">$0FFFF</font><font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font>valeur <font color="#000080">&lt; </font><font color="#800000">255 </font><font color="#FF0000"><b>THEN
              </b></font>AL <font color="#000080">:= </font>valeur
            <font color="#FF0000"><b>ELSE
            BEGIN
              </b></font>AL <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;
              </font>BX <font color="#000080">:= </font>valeur<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>regs<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#008000"><i>(*          CurrencyTimeZone(GetCountryStr);*)
          </i></font>InternationalCollating<font color="#000080">(</font>CollatingSequence<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>GetCountry <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>info <font color="#000080">: </font>CountryInfo<font color="#000080">;
    </font>regs <font color="#000080">: </font>registers<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    WITH </b></font>regs <font color="#FF0000"><b>DO BEGIN
      </b></font>AX <font color="#000080">:= </font><font color="#800000">$3800</font><font color="#000080">;
      </font>DS <font color="#000080">:= </font>Seg<font color="#000080">(</font>info<font color="#000080">);
      </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>info<font color="#000080">);
      </font>AL <font color="#000080">:= </font><font color="#800000">$0</font><font color="#000080">;
      </font>Intr<font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>regs<font color="#000080">);
      </font>GetCountry <font color="#000080">:= </font>BX<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>GetCountryStr <font color="#000080">: </font>Str3<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>value <font color="#000080">: </font>Str3<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>value <font color="#000080">:= </font>Long2Str<font color="#000080">(</font>GetCountry<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nb_Of_Currency <font color="#FF0000"><b>DO

      IF </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
        </b></font>GetCountryStr <font color="#000080">:= </font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>PROCEDURE </b></font>CurrencyIso<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nb_Of_Currency <font color="#FF0000"><b>DO

      IF </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country <font color="#000080">= </font>value<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>CurrencyLtStr <font color="#000080">:= </font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>mon<font color="#000080">;
        </font>CurrencyRtStr <font color="#000080">:= </font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>mon<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>(* --------------------------------------------------------------*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>ConvertToCountry<font color="#000080">(</font>value <font color="#000080">: </font>Str3<font color="#000080">) : </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>wrk <font color="#000080">: </font>Word<font color="#000080">;
    </font>error <font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>wrk <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Nb_Of_Currency <font color="#FF0000"><b>DO
      IF </b></font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>country <font color="#000080">= </font>StUpCase<font color="#000080">(</font>value<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
        </b></font>Val<font color="#000080">(</font>Table_Currency_iso<font color="#000080">[</font>i<font color="#000080">].</font>code<font color="#000080">, </font>wrk<font color="#000080">, </font>error<font color="#000080">);
    </font>ConvertToCountry <font color="#000080">:= </font>wrk<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*-----------------------------------------------------------------*)

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetInternationalTrueYes<font color="#000080">(</font>Val <font color="#000080">: </font>LanguageType<font color="#000080">);
  </font><font color="#FF0000"><b>VAR
    </b></font>value <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN

    </b></font>value <font color="#000080">:= </font>Ord<font color="#000080">(</font>Val<font color="#000080">);
    </font>TrueChar <font color="#000080">:= </font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">];
    </font>FalseChar <font color="#000080">:= </font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">];
    </font>YesChar <font color="#000080">:= </font>InternationalYesNo<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">];
    </font>NoChar <font color="#000080">:= </font>InternationalYesNo<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">];
    </font>BooleanSet <font color="#000080">:= [</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">],
    </font>LoCase<font color="#000080">(</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">]),
    </font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">],
    </font>LoCase<font color="#000080">(</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">])];

    </font>YesNoSet <font color="#000080">:= [</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">],
    </font>LoCase<font color="#000080">(</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">]),
    </font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">],
    </font>LoCase<font color="#000080">(</font>InternationalTrueFalse<font color="#000080">[</font>value<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">])];

  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(* --------------------------------------------------------------- *)

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetLanguage<font color="#000080">(</font>Val <font color="#000080">: </font>LanguageType<font color="#000080">);

  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN

    </b></font>Language <font color="#000080">:= </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>Language <font color="#FF0000"><b>OF
      </b></font>english<font color="#000080">, </font>nederland<font color="#000080">, </font>italiano <font color="#000080">: </font>SetCodePage<font color="#000080">(</font><font color="#800000">437</font><font color="#000080">);
      </font>francais<font color="#000080">, </font>deutch<font color="#000080">, </font>espanol <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>SetCodePage<font color="#000080">(</font><font color="#800000">850</font><font color="#000080">);
          </font>SetInternationalUpcase<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>SetInternationalMonthDay<font color="#000080">(</font>Val<font color="#000080">);
    </font>SetInternationalTrueYes<font color="#000080">(</font>Val<font color="#000080">);
    </font>New<font color="#000080">(</font>CollatingSequence<font color="#000080">);
    </font>InternationalCollating<font color="#000080">(</font>CollatingSequence<font color="#000080">);

  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(* --------------------------------------------------------------- *)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>GetLanguage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>GetLanguage <font color="#000080">:= </font>LanguageNames<font color="#000080">[</font>LanguageType<font color="#000080">(</font>Language<font color="#000080">)];
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Currentcountry <font color="#000080">:= </font>GetCountryStr<font color="#000080">;
  </font>CurrencyTimeZone<font color="#000080">(</font>GetCountryStr<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------   DEMO PROGRAM ------------------- }

</i></font><font color="#FF0000"><b>program </b></font>demonlcs<font color="#000080">;
</font><font color="#008000"><i>(* Demonstration program for use of nlcs unit *)

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>opdate<font color="#000080">,</font>nlcs<font color="#000080">,</font>opabsfld<font color="#000080">,</font>opstring<font color="#000080">,
     </font>editform<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>TS<font color="#000080">,</font>r <font color="#000080">: </font>timestamp<font color="#000080">;
   </font>S1<font color="#000080">,</font>S2 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>found<font color="#000080">: </font>boolean<font color="#000080">;
   </font>i <font color="#000080">: </font>word<font color="#000080">;

   </font><font color="#FF0000"><b>begin
      </b></font>clrscr<font color="#000080">;
      </font>writeln <font color="#000080">(</font><font color="#800000">'DEMO NLCS'</font><font color="#000080">);</font>writeln<font color="#000080">;
      </font>S1 <font color="#000080">:= </font><font color="#800000">'zone'</font><font color="#000080">; </font>S2 <font color="#000080">:= </font><font color="#800000">'ÇtÇ'</font><font color="#000080">;
      </font>SetLanguage<font color="#000080">(</font>francais<font color="#000080">);
      </font>writeln<font color="#000080">(</font>STUpcase<font color="#000080">(</font>S1<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>StUpcase<font color="#000080">(</font>S2<font color="#000080">));
      </font>writeln <font color="#000080">(</font><font color="#800000">' Comparaison  correcte avec CompIntString '</font><font color="#000080">);

    </font><font color="#FF0000"><b>case </b></font>CompIntString<font color="#000080">(</font>S1<font color="#000080">,</font>S2<font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font>less <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 &lt; S2'</font><font color="#000080">);
      </font>equal <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 = S2'</font><font color="#000080">);
      </font>greater <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 &gt; S2'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>writeln<font color="#000080">( </font><font color="#800000">'Comparaison incorrecte avec CompString'</font><font color="#000080">);
      </font><font color="#FF0000"><b>case </b></font>CompString<font color="#000080">(</font>S1<font color="#000080">,</font>S2<font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font>less <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 &lt; S2'</font><font color="#000080">);
      </font>equal <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 = S2'</font><font color="#000080">);
      </font>greater <font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'S1 &gt; S2'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


      </font>CurrentDateTime<font color="#000080">(</font>TS<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Heure locale      : '</font><font color="#000080">,</font>TimeStampForm<font color="#000080">(</font><font color="#800000">'DTWZS'</font><font color="#000080">,</font>TS<font color="#000080">));
      </font>SetUniversalTime<font color="#000080">(</font>TS<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Heure universelle : '</font><font color="#000080">,</font>TimeStampForm<font color="#000080">(</font><font color="#800000">'DTWZS'</font><font color="#000080">,</font>TS<font color="#000080">));
      </font>SetLocalTime<font color="#000080">(</font><font color="#800000">'EST'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>TS<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Heure Los Angeles : '</font><font color="#000080">,</font>TimeStampForm<font color="#000080">(</font><font color="#800000">'DTWZS'</font><font color="#000080">,</font>TS<font color="#000080">));
      </font>delay<font color="#000080">(</font><font color="#800000">3500</font><font color="#000080">);
      </font>CurrentDateTime<font color="#000080">(</font>r<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Temps ÇcoulÇ en ms: '</font><font color="#000080">,
          </font>RealForm<font color="#000080">(</font><font color="#800000">'##.#'</font><font color="#000080">,(</font>R<font color="#000080">.</font>MilliTm <font color="#000080">- </font>TS<font color="#000080">.</font>MilliTM<font color="#000080">)/</font><font color="#800000">1000.0</font><font color="#000080">));

      </font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">'Langage          : '</font><font color="#000080">, </font>GetLanguage<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Code Page        : '</font><font color="#000080">, </font>GetCodePage<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Pays  local      : '</font><font color="#000080">, </font>GetCountryStr<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Symbole monÇtaire: '</font><font color="#000080">, </font>CurrencyLtStr<font color="#000080">);
      </font>delay<font color="#000080">(</font><font color="#800000">5500</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0156.PAS">Original</a><b>]</b></p></body>
</html>
