<html>
<head><title> "Info on DBASE3 Files" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>dbfinfo<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses
        </b></font>crt<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>dbfile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
        </font>currentrec <font color="#000080">: </font>longint<font color="#000080">;
        </font>dbfilename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
        </font>dbfileok <font color="#000080">: </font>boolean<font color="#000080">;
        </font>dberr <font color="#000080">: </font>integer<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>dbwrthd<font color="#000080">;      </font><font color="#008000"><i>{writes the header info}
</i></font><font color="#FF0000"><b>procedure </b></font>disprec<font color="#000080">;      </font><font color="#008000"><i>{displays the record data}
</i></font><font color="#FF0000"><b>procedure </b></font>dbhdrd<font color="#000080">;       </font><font color="#008000"><i>{reads the header info}
</i></font><font color="#FF0000"><b>procedure </b></font>waitforkey<font color="#000080">;   </font><font color="#008000"><i>{waits for key to be hit}

</i></font><font color="#FF0000"><b>implementation
const
     </b></font>dbmaxflds <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;   </font><font color="#008000"><i>{max. number of fields }
     </i></font>dbmaxrecsize <font color="#000080">= </font><font color="#800000">4000</font><font color="#000080">; </font><font color="#008000"><i>{max. size of a record }


</i></font><font color="#FF0000"><b>Type

    </b></font>DBfileinfo <font color="#000080">= </font><font color="#FF0000"><b>record      </b></font><font color="#008000"><i>{ first 32 bytes of DBF }
        </i></font>version <font color="#000080">: </font>byte<font color="#000080">;
                </font>year <font color="#000080">: </font>byte<font color="#000080">;
        </font>month <font color="#000080">: </font>byte<font color="#000080">;
                </font>day <font color="#000080">: </font>byte<font color="#000080">;
                </font>norecord <font color="#000080">: </font>longint<font color="#000080">;
                </font>headlen <font color="#000080">: </font>integer<font color="#000080">;
                </font>reclen <font color="#000080">: </font>integer<font color="#000080">;
                </font>res <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>DBfieldinfo <font color="#000080">= </font><font color="#FF0000"><b>record            </b></font><font color="#008000"><i>{ 32 byte field info }
                </i></font>name  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                </font>ftype <font color="#000080">: </font>byte<font color="#000080">;
                </font>addr  <font color="#000080">: </font>longint<font color="#000080">;
                </font>len   <font color="#000080">: </font>byte<font color="#000080">;
                </font>dcnt  <font color="#000080">: </font>byte<font color="#000080">;
                </font>res   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">14</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>dbfldar <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>dbmaxflds<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>dbfieldinfo<font color="#000080">;
        </font>dbrecar <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>dbmaxrecsize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>dbhead <font color="#000080">: </font>dbfileinfo<font color="#000080">;
        </font>dbfield <font color="#000080">: </font>dbfldar<font color="#000080">;
        </font>dbnofld <font color="#000080">: </font>integer<font color="#000080">;
        </font>dbrecord <font color="#000080">: </font>dbrecar<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>waitforkey<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>junk <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>writeln<font color="#000080">;
        </font>write<font color="#000080">(</font><font color="#800000">'Hit any key to continue'</font><font color="#000080">);
        </font>junk <font color="#000080">:= </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ read rdbase III  header info }
{ blockread error - dberr = h = 0, l = number of records read}
{ bad header - dberr - h = 1, l = version }
</i></font><font color="#FF0000"><b>procedure </b></font>dbhdrd<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
        </b></font>blockread<font color="#000080">(</font>dbfile<font color="#000080">,</font>dbhead<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">,</font>dberr<font color="#000080">);
        </font>dbfileok <font color="#000080">:= (</font>dberr <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">);
        </font>dbnofld <font color="#000080">:= (</font>dbhead<font color="#000080">.</font>headlen <font color="#000080">- </font><font color="#800000">33</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
        </font><font color="#FF0000"><b>if not </b></font>dbfileok <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

        </font><font color="#FF0000"><b>if not </b></font><font color="#000080">((</font>dbhead<font color="#000080">.</font>version <font color="#000080">= </font><font color="#800000">$83</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>dbhead<font color="#000080">.</font>version <font color="#000080">= </font><font color="#800000">$03</font><font color="#000080">)) </font><font color="#FF0000"><b>then
        begin
                </b></font>dbfileok <font color="#000080">:= </font>false<font color="#000080">;
                </font>dberr <font color="#000080">:= </font>dbhead<font color="#000080">.</font>version <font color="#FF0000"><b>or </b></font><font color="#800000">$100</font><font color="#000080">;
                </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>dbnofld <font color="#FF0000"><b>do
        begin
                </b></font>blockread<font color="#000080">(</font>dbfile<font color="#000080">,</font>dbfield<font color="#000080">[</font>i<font color="#000080">],</font><font color="#800000">32</font><font color="#000080">,</font>dberr<font color="#000080">);
                </font>dbfileok <font color="#000080">:= (</font>dberr <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">);
        </font><font color="#FF0000"><b>if not </b></font>dbfileok <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ writes field titles on screen }
</i></font><font color="#FF0000"><b>procedure </b></font>dbwrfldtit<font color="#000080">(</font>line <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
        </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>line<font color="#000080">);
        </font>write<font color="#000080">(</font><font color="#800000">'Field Name   Type  Len  Dec'</font><font color="#000080">);
    </font>gotoxy<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font>line<font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Field Name   Type Len  Dec'</font><font color="#000080">);
        </font>write<font color="#000080">(</font><font color="#800000">'-----------------------------------------------------------------'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ writes all header info to the screen }
</i></font><font color="#FF0000"><b>procedure </b></font>dbwrthd<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>line<font color="#000080">,</font>j<font color="#000080">,</font>i <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
    </b></font>clrscr<font color="#000080">;
    </font>gotoxy<font color="#000080">(</font><font color="#800000">29</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>write<font color="#000080">(</font><font color="#800000">'DBase file '</font><font color="#000080">,</font>dbfilename<font color="#000080">);
    </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
    </font><font color="#FF0000"><b>with </b></font>dbhead <font color="#FF0000"><b>do
    begin
        </b></font>write<font color="#000080">(</font><font color="#800000">'Last Time File Updated  - '</font><font color="#000080">,</font>month<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">,</font>day<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">,</font>year<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
                </font>gotoxy<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
                </font>write<font color="#000080">(</font><font color="#800000">'Number of records in file - '</font><font color="#000080">,</font>norecord<font color="#000080">);
                </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
                </font>write<font color="#000080">(</font><font color="#800000">'Length of each record   - '</font><font color="#000080">,</font>reclen<font color="#000080">);
                </font>gotoxy<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>write<font color="#000080">(</font><font color="#800000">'Number of fields          - '</font><font color="#000080">,</font>dbnofld<font color="#000080">);
        </font>dbwrfldtit<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
        </font>line <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>dbnofld <font color="#FF0000"><b>do
        begin
        if </b></font>odd<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>line<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>gotoxy<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font>line<font color="#000080">);
                </font><font color="#FF0000"><b>with </b></font>dbfield<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
                begin
                        for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">11 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font>name<font color="#000080">[</font>j<font color="#000080">]);
                        </font>write<font color="#000080">(</font><font color="#800000">'    '</font><font color="#000080">,</font>chr<font color="#000080">(</font>ftype<font color="#000080">),</font><font color="#800000">'   '</font><font color="#000080">,</font>len<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>dcnt<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if not </b></font>odd<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
            </b></font>line <font color="#000080">:= </font>succ<font color="#000080">(</font>line<font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font>line <font color="#000080">= </font><font color="#800000">24 </font><font color="#FF0000"><b>then
            begin
                 if </b></font>i <font color="#000080">&lt; </font>dbnofld <font color="#FF0000"><b>then
                 begin
                      </b></font>line <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                      </font>writeln<font color="#000080">;
                      </font>write<font color="#000080">(</font><font color="#800000">'More ....'</font><font color="#000080">);
                      </font>waitforkey<font color="#000080">;
                      </font>clrscr<font color="#000080">;
                      </font>dbwrfldtit<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>waitforkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ read and display a DBase III record }
{ if field data is larger than one line if will be truncated }

</i></font><font color="#FF0000"><b>procedure </b></font>dbreadrec<font color="#000080">(</font>rec <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>const
        </b></font>maxchar <font color="#000080">= </font><font color="#800000">65</font><font color="#000080">;   </font><font color="#008000"><i>{maximum characters to display from record}
</i></font><font color="#FF0000"><b>var
    </b></font>temp <font color="#000080">: </font>longint<font color="#000080">;
        </font>i<font color="#000080">,</font>j<font color="#000080">,</font>stoppos<font color="#000080">,</font>startpos<font color="#000080">,</font>maxlen <font color="#000080">: </font>integer<font color="#000080">;
        </font>linecnt <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        with </b></font>dbhead <font color="#FF0000"><b>do
        begin
             if </b></font><font color="#000080">(</font>rec <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>rec <font color="#000080">&gt; </font>norecord<font color="#000080">) </font><font color="#FF0000"><b>then
             begin
                  </b></font>dberr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                  </font>dbfileok <font color="#000080">:= </font>false<font color="#000080">;
                  </font>exit<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font>temp <font color="#000080">:= </font>rec<font color="#000080">;
             </font>rec <font color="#000080">:= (</font>rec <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font>reclen <font color="#000080">+ </font>headlen<font color="#000080">;
             </font>seek<font color="#000080">(</font>dbfile<font color="#000080">,</font>rec<font color="#000080">);
             </font>blockread<font color="#000080">(</font>dbfile<font color="#000080">,</font>dbrecord<font color="#000080">,</font>reclen<font color="#000080">,</font>dberr<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>clrscr<font color="#000080">;
        </font>write<font color="#000080">(</font><font color="#800000">'DBASE file '</font><font color="#000080">,</font>dbfilename<font color="#000080">,</font><font color="#800000">'   Record No. '</font><font color="#000080">,</font>temp<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>dbrecord<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">(</font><font color="#800000">'    DELETED'</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>writeln<font color="#000080">;
        </font>writeln<font color="#000080">;
        </font>startpos <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
        </font>linecnt <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>dbnofld <font color="#FF0000"><b>do
        begin
             with </b></font>dbfield<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
             begin
                  for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">11 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font>name<font color="#000080">[</font>j<font color="#000080">]);
                  </font>write<font color="#000080">(</font><font color="#800000">' -- '</font><font color="#000080">);
                  </font><font color="#FF0000"><b>if </b></font>len <font color="#000080">&gt; </font>maxchar <font color="#FF0000"><b>then </b></font>maxlen <font color="#000080">:= </font>maxchar
                  <font color="#FF0000"><b>else </b></font>maxlen <font color="#000080">:= </font>len<font color="#000080">;
                  </font>stoppos <font color="#000080">:= </font>startpos <font color="#000080">+ </font>maxlen<font color="#000080">;
                  </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font>startpos <font color="#FF0000"><b>to </b></font>stoppos <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font>dbrecord<font color="#000080">[</font>j<font color="#000080">]);
                  </font>startpos <font color="#000080">:= </font>startpos <font color="#000080">+ </font>len<font color="#000080">;
                  </font>writeln<font color="#000080">;
                  </font>linecnt <font color="#000080">:= </font>succ<font color="#000080">(</font>linecnt<font color="#000080">);
                  </font><font color="#FF0000"><b>if </b></font>linecnt <font color="#000080">= </font><font color="#800000">22 </font><font color="#FF0000"><b>then
                  begin
                       if </b></font>i <font color="#000080">&lt; </font>dbnofld <font color="#FF0000"><b>then
                       begin
                            </b></font>linecnt <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                            </font>write<font color="#000080">(</font><font color="#800000">'More ....'</font><font color="#000080">);
                            </font>waitforkey<font color="#000080">;
                            </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do
                            begin
                                 </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>j<font color="#000080">);
                                 </font>clreol<font color="#000080">;
                            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                            </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>waitforkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>disprec<font color="#000080">;
</font><font color="#FF0000"><b>var
        </b></font>rec <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
        </font>treal <font color="#000080">: </font>real<font color="#000080">;
        </font>error <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
        repeat
              </b></font>clrscr<font color="#000080">;
              </font>writeln<font color="#000080">(</font><font color="#800000">'DBASE file -- '</font><font color="#000080">,</font>dbfilename<font color="#000080">);
              </font>writeln<font color="#000080">;
              </font>write<font color="#000080">(</font><font color="#800000">'Total records = '</font><font color="#000080">,</font>dbhead<font color="#000080">.</font>norecord<font color="#000080">);
              </font>writeln<font color="#000080">(</font><font color="#800000">'   Current Record = '</font><font color="#000080">,</font>currentrec<font color="#000080">);
              </font>writeln<font color="#000080">;
              </font>write<font color="#000080">(</font><font color="#800000">'Enter record to display (0 = exit, cr = next, - = previous)? '</font><font color="#000080">);
              </font>readln<font color="#000080">(</font>rec<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>rec <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>rec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>then
              begin
                   if </b></font>rec <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>currentrec <font color="#000080">:= </font>succ<font color="#000080">(</font>currentrec<font color="#000080">)
                   </font><font color="#FF0000"><b>else
                   </b></font>currentrec <font color="#000080">:= </font>pred<font color="#000080">(</font>currentrec<font color="#000080">);
              </font><font color="#FF0000"><b>end
              else
              begin
                   </b></font>val<font color="#000080">(</font>rec<font color="#000080">,</font>treal<font color="#000080">,</font>error<font color="#000080">);
                   </font><font color="#FF0000"><b>if </b></font>error <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>treal <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
                   </font>currentrec <font color="#000080">:= </font>trunc<font color="#000080">(</font>treal<font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>currentrec <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>currentrec <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>currentrec <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>currentrec <font color="#000080">&gt; </font>dbhead<font color="#000080">.</font>norecord <font color="#FF0000"><b>then </b></font>currentrec <font color="#000080">:= </font>dbhead<font color="#000080">.</font>norecord<font color="#000080">;
              </font>dbreadrec<font color="#000080">(</font>currentrec<font color="#000080">);
        </font><font color="#FF0000"><b>until </b></font>false

<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.

                       </font>Dbase III DBF <font color="#FF0000"><b>File </b></font>Structure


Header
<font color="#000080">------


        
</font>BYTE <font color="#800000">#                </font><font color="#FF0000"><b>Type                </b></font>Example           Description
<font color="#000080">------                ----            -------           -----------
        
</font><font color="#800000">0                </font>Byte                   <font color="#800000">1              </font>DBASE Version
                                                  <font color="#000080">(</font><font color="#800000">83</font>H <font color="#FF0000"><b>with </b></font>DBT <font color="#FF0000"><b>file</b></font><font color="#000080">)
                                                  (</font><font color="#800000">03</font>H without DBT <font color="#FF0000"><b>file</b></font><font color="#000080">)

</font><font color="#800000">1                </font>Byte                   <font color="#800000">2                  </font>Year <font color="#000080">- </font>Binary

<font color="#800000">2                </font>Byte                   <font color="#800000">3                  </font>Month <font color="#000080">- </font>Binary

<font color="#800000">3               </font>Byte                   <font color="#800000">4                  </font>Day <font color="#000080">- </font>Binary

<font color="#800000">4</font><font color="#000080">-</font><font color="#800000">7                32 </font>bit integer     <font color="#800000">5              </font>Number <font color="#FF0000"><b>of </b></font>records <font color="#FF0000"><b>in file

</b></font><font color="#800000">8</font><font color="#000080">-</font><font color="#800000">9                16 </font>bit integer           <font color="#800000">6                  </font>Length <font color="#FF0000"><b>of </b></font>header

<font color="#800000">10</font><font color="#000080">-</font><font color="#800000">11                16 </font>bit integer     <font color="#800000">7                  </font>Length <font color="#FF0000"><b>of record

</b></font><font color="#800000">12</font><font color="#000080">-</font><font color="#800000">31                20 </font>Bytes           <font color="#800000">8              </font>Reserved

<font color="#800000">32</font><font color="#000080">-</font>n                <font color="#800000">32 </font>Bytes                          Field Descriptor
                                                  <font color="#000080">(</font>See below<font color="#000080">)
                                        
</font>n<font color="#000080">+</font><font color="#800000">1                </font>Byte               <font color="#800000">9              0</font>Dh field terminator

N<font color="#000080">+</font><font color="#800000">2                  </font>Byte              <font color="#800000">10              00</font>h <font color="#FF0000"><b>In </b></font>some older versions
                                                  <font color="#000080">(</font>The length <font color="#FF0000"><b>of </b></font>header byte
                                                  reflects this <font color="#FF0000"><b>if </b></font>present<font color="#000080">)
.</font>pa

Field Descriptor
<font color="#000080">----------------

</font>BYTE <font color="#800000">#                </font><font color="#FF0000"><b>Type                </b></font>Example           Description
<font color="#000080">------                ----            -------           -----------

</font><font color="#800000">0</font><font color="#000080">-</font><font color="#800000">10                </font>byte                   <font color="#800000">11             </font>Field name 
                                                  <font color="#000080">(</font>Zero filled<font color="#000080">)

</font><font color="#800000">11                </font>Byte                   <font color="#800000">12                  </font>Field <font color="#FF0000"><b>Type
                                                  </b></font><font color="#000080">(</font>N D L C M<font color="#000080">)

</font><font color="#800000">12</font><font color="#000080">-</font><font color="#800000">15                32 </font>bit integer           <font color="#800000">13                  </font>Field data address
                                                  <font color="#000080">(</font>Internal use<font color="#000080">)

</font><font color="#800000">16                </font>Byte                   <font color="#800000">14                  </font>Field length <font color="#000080">- </font>Binary

<font color="#800000">17                </font>Byte                   <font color="#800000">15                  </font>Field decimal count <font color="#000080">- </font>Binary

<font color="#800000">18</font><font color="#000080">-</font><font color="#800000">31                14 </font>bytes           <font color="#800000">16                  </font>Reserved



Field Types
<font color="#000080">-----------


</font>N        Numeric <font color="#000080">- </font><font color="#800000">0 1 2 3 4 5 6 7 8 </font><font color="#000080">. -


</font>D        Date <font color="#000080">- </font><font color="#800000">8 </font>Bytes <font color="#000080">(</font>YYYYMMDD<font color="#000080">)


</font>L        Logical <font color="#000080">- </font>Y y N n T t F f <font color="#000080">? (? = </font><font color="#FF0000"><b>Not </b></font>initialized<font color="#000080">)


</font>C        Character <font color="#000080">- </font>Any Ascii Character


M        Memo <font color="#000080">- </font><font color="#800000">10 </font>digits <font color="#000080">(</font>DBT block Number<font color="#000080">)



</font>Data Records
<font color="#000080">------------


        </font>All data <font color="#FF0000"><b>is in </b></font>Ascii<font color="#000080">.


        </font>There <font color="#FF0000"><b>is </b></font>no field seperators <font color="#FF0000"><b>or record </b></font>terminators<font color="#000080">.

        </font>The first byte <font color="#FF0000"><b>is </b></font>a space <font color="#000080">(</font><font color="#800000">20</font>h<font color="#000080">) </font><font color="#FF0000"><b>if record not </b></font>deleted <font color="#FF0000"><b>and </b></font>an
        asterick <font color="#000080">(</font><font color="#800000">2</font>AH<font color="#000080">) </font><font color="#FF0000"><b>if </b></font>deleted<font color="#000080">.



</font>DBASE Limitations
<font color="#000080">-----------------

</font>Fields <font color="#000080">- </font><font color="#800000">128 </font>Max<font color="#000080">.

</font><font color="#FF0000"><b>Record </b></font><font color="#000080">- </font><font color="#800000">4000 </font>bytes Max<font color="#000080">.

</font>Header <font color="#000080">- </font><font color="#800000">4130 </font>bytes Max<font color="#000080">.

          (</font><font color="#800000">128 </font>Fields <font color="#000080">* </font><font color="#800000">32 </font>bytes<font color="#000080">) + </font><font color="#800000">32 </font>bytes <font color="#000080">+ </font><font color="#800000">1 </font>terminator <font color="#000080">+ (</font><font color="#800000">1 </font>null<font color="#000080">)

</font>Number <font color="#000080">- </font><font color="#800000">19 </font>digits




Example <font color="#FF0000"><b>File
</b></font><font color="#000080">------------


         </font><font color="#800000">1  2  3  4     5         6     7          8
        </font><font color="#000080">|| || || || |---------| |---| |---| |---------- 
</font><font color="#800000">000000  83 55 0</font>B <font color="#800000">0E 31 00 00 00</font><font color="#000080">-</font><font color="#800000">81 01 89 00 00 00 00 00  </font><font color="#000080">.</font>U<font color="#000080">..</font><font color="#800000">1</font><font color="#000080">...........

        ----------------------------------------------|
</font><font color="#800000">000010  00 00 00 00 00 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

                      </font><font color="#800000">11                 12     13
        </font><font color="#000080">|------------------------------| || |---------| 
</font><font color="#800000">000020  46 49 52 53 54 4E 41 4</font>D<font color="#000080">-</font><font color="#800000">45 00 00 43 13 01 9</font>D <font color="#800000">41  </font>FIRSTNAME<font color="#000080">..</font>C<font color="#000080">...</font>A

        <font color="#800000">14 15                     16
        </font><font color="#000080">|| || |---------------------------------------|
</font><font color="#800000">000030  14 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000040  4</font>C <font color="#800000">41 53 54 4E 41 4</font>D <font color="#800000">45</font><font color="#000080">-</font><font color="#800000">00 00 00 43 27 01 9</font>D <font color="#800000">41  </font>LASTNAME<font color="#000080">...</font>C<font color="#800000">'..A

000050  14 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000060  50 48 4</font>F <font color="#800000">4E 45 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 43 3</font>B <font color="#800000">01 9</font>D <font color="#800000">41  </font>PHONE<font color="#000080">......</font>C<font color="#000080">;..</font>A

<font color="#800000">000070  0</font>D <font color="#800000">00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000080  54 52 41 56 45 4</font>C <font color="#800000">43 4</font>F<font color="#000080">-</font><font color="#800000">44 45 00 43 48 01 9</font>D <font color="#800000">41  </font>TRAVELCODE<font color="#000080">.</font>CH<font color="#000080">..</font>A

<font color="#800000">000090  04 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">0000</font>A0  <font color="#800000">54 52 41 56 45 4</font>C <font color="#800000">50 4</font>C<font color="#000080">-</font><font color="#800000">41 4E 00 43 4</font>C <font color="#800000">01 9</font>D <font color="#800000">41  </font>TRAVELPLAN<font color="#000080">.</font>CL<font color="#000080">..</font>A

<font color="#800000">0000</font>B0  <font color="#800000">28 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">(...............

</font><font color="#800000">0000</font>C0  <font color="#800000">44 45 50 41 52 54 55 52</font><font color="#000080">-</font><font color="#800000">45 00 00 44 74 01 9</font>D <font color="#800000">41  </font>DEPARTURE<font color="#000080">..</font>Dt<font color="#000080">..</font>A

<font color="#800000">0000</font>D0  <font color="#800000">08 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">0000E0  43 4</font>F <font color="#800000">53 54 00 50 41 49</font><font color="#000080">-</font><font color="#800000">44 00 00 4E 7</font>C <font color="#800000">01 9</font>D <font color="#800000">41  </font>COST<font color="#000080">.</font>PAID<font color="#000080">..</font>N<font color="#000080">|..</font>A

<font color="#800000">0000</font>F0  <font color="#800000">0</font>A <font color="#800000">02 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000100  50 41 49 44 00 4</font>F <font color="#800000">54 45</font><font color="#000080">-</font><font color="#800000">53 00 00 4</font>C <font color="#800000">86 01 9</font>D <font color="#800000">41  </font>PAID<font color="#000080">.</font>OTES<font color="#000080">..</font>L<font color="#000080">...</font>A

<font color="#800000">000110  01 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000120  41 47 45 4E 54 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 43 87 01 9</font>D <font color="#800000">41  </font>AGENT<font color="#000080">......</font>C<font color="#000080">...</font>A

<font color="#800000">000130  02 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000140  52 45 53 45 52 56 44 41</font><font color="#000080">-</font><font color="#800000">54 45 00 44 89 01 9</font>D <font color="#800000">41  </font>RESERVDATE<font color="#000080">.</font>D<font color="#000080">...</font>A

<font color="#800000">000150  08 00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

</font><font color="#800000">000160  4E 4</font>F <font color="#800000">54 45 53 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 4</font>D <font color="#800000">91 01 9</font>D <font color="#800000">41  </font>NOTES<font color="#000080">......</font>M<font color="#000080">...</font>A

<font color="#800000">000170  0</font>A <font color="#800000">00 00 00 01 00 00 00</font><font color="#000080">-</font><font color="#800000">00 00 00 00 00 00 00 00  </font><font color="#000080">................

                </font>Firstname
           <font color="#000080">|| |----------------------------------------
</font><font color="#800000">000180  0</font>D <font color="#800000">20 43 6</font>C <font color="#800000">61 69 72 65</font><font color="#000080">-</font><font color="#800000">20 20 20 20 20 20 20 20  </font><font color="#000080">. </font>Claire        
                           
                            Lastname
        <font color="#000080">----------------| |----------------------------
</font><font color="#800000">000190  20 20 20 20 20 20 42 75</font><font color="#000080">-</font><font color="#800000">63 6</font>B <font color="#800000">6</font>D <font color="#800000">61 6E 20 20 20        </font>Buckman   

                                        Phone
        <font color="#000080">----------------------------| |----------------
</font><font color="#800000">0001</font>A0  <font color="#800000">20 20 20 20 20 20 20 20</font><font color="#000080">-</font><font color="#800000">20 20 28 35 35 35 29 34            </font><font color="#000080">(</font><font color="#800000">555</font><font color="#000080">)</font><font color="#800000">4

                               </font>T <font color="#000080">- </font>code     T <font color="#000080">- </font>plan
        <font color="#000080">-------------------| |---------| |-------------
</font><font color="#800000">0001</font>B0  <font color="#800000">35 36 2</font>D <font color="#800000">39 30 35 39 43</font><font color="#000080">-</font><font color="#800000">49 31 30 31 30 2</font>D <font color="#800000">6E 69  56</font><font color="#000080">-</font><font color="#800000">9059</font>CI1010<font color="#000080">-</font>ni

        <font color="#000080">-----------------------------------------------
</font><font color="#800000">0001</font>C0  <font color="#800000">67 68 74 20 43 61 72 69</font><font color="#000080">-</font><font color="#800000">62 62 65 61 6E 20 49 73  </font>ght Caribbean <font color="#FF0000"><b>Is

        </b></font><font color="#000080">-----------------------------------------------
</font><font color="#800000">0001</font>D0  <font color="#800000">6</font>C <font color="#800000">61 6E 64 20 43 72 75</font><font color="#000080">-</font><font color="#800000">69 73 65 20 20 20 20 20  </font>land Cruise     

                   Departure Date          Cost
        <font color="#000080">-------| |---------------------| |-------------                  
</font><font color="#800000">0001E0  20 20 20 31 39 38 35 31</font><font color="#000080">-</font><font color="#800000">30 32 34 20 20 20 31 31     19851024   11

                       </font>PD  Age    Res<font color="#000080">. </font>Date
        <font color="#000080">-------------| || |---| |---------------------|
</font><font color="#800000">0001</font>F0  <font color="#800000">39 39 2E 30 30 54 4</font>D <font color="#800000">4</font>D<font color="#000080">-</font><font color="#800000">31 39 38 35 30 37 31 35  99.00</font>TMM19850715

<font color="#000080">.</font>pa
            Notes
        <font color="#000080">|---------------------------|
</font><font color="#800000">000200  20 20 20 20 20 20 20 20</font><font color="#000080">-</font><font color="#800000">20 31 20 52 69 63 6</font>B <font color="#800000">20           1 </font>Rick 

<font color="#800000">000210  20 20 20 20 20 20 20 20</font><font color="#000080">-</font><font color="#800000">20 20 20 20 20 20 20 4</font>C                 L

<font color="#800000">000220  69 73 62 6</font>F <font color="#800000">6E 6E 20 20</font><font color="#000080">-</font><font color="#800000">20 20 20 20 20 20 20 20  </font>isbonn          

<font color="#800000">000230  20 20 20 28 35 35 35 29</font><font color="#000080">-</font><font color="#800000">34 35 35 2</font>D <font color="#800000">33 33 34 34     </font><font color="#000080">(</font><font color="#800000">555</font><font color="#000080">)</font><font color="#800000">455</font><font color="#000080">-</font><font color="#800000">3344

000240  41 56 31 30 39 2</font>D <font color="#800000">6E 69</font><font color="#000080">-</font><font color="#800000">67 68 74 20 41 6</font>C <font color="#800000">61 73  </font>AV109<font color="#000080">-</font>night Alas

<font color="#800000">000250  6</font>B <font color="#800000">61 2</font>F <font color="#800000">56 61 6E 63 6</font>F<font color="#000080">-</font><font color="#800000">75 76 65 72 20 43 72 75  </font>ka<font color="#000080">/</font>Vancouver Cru

<font color="#800000">000260  69 73 65 20 20 20 20 20</font><font color="#000080">-</font><font color="#800000">20 20 20 20 31 39 38 35  </font>ise         <font color="#800000">1985

000270  30 38 30 35 20 20 20 31</font><font color="#000080">-</font><font color="#800000">33 37 38 2E 30 30 54 4</font>A  <font color="#800000">0805   1378.00</font>TJ

<font color="#800000">000280  54 31 39 38 35 30 37 31</font><font color="#000080">-</font><font color="#800000">35 20 20 20 20 20 20 20  </font>T19850715       

<font color="#800000">000290  20 20 32 20 48 61 6E 6</font>B<font color="#000080">-</font><font color="#800000">20 20 20 20 20 20 20 20    2 </font>Hank


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p></body>
</html>
