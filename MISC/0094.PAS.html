<html>
<head><title> "hall of fame - my try" by RODNEY JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0094.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Unit </b></font>HighScr<font color="#000080">;
</font><font color="#FF0000"><b>Interface
Procedure </b></font>HS_Init<font color="#000080">(</font>iNum<font color="#000080">: </font>byte<font color="#000080">; </font>ifn<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>icode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#008000"><i>{Initializes the highscore manager}
{  iNum: byte -  The number of scores to keep track of.  Setting iNum to 0}
{                makes the program use however many scores it finds in the}
{                list file}
{  ifn: string - The filename of the list file.  If the file exists, it is
                 opened; otherwise, a new file is created.  If iNum if set to
                 more names than are in ifn, extra spaces are left blank.  If
                 ifn has too many, the extras are ignored.
                 NOTE:  do not make inum=0 if you are creating a new list
                 file}
{  icode: byte - encoding number, where 0=no encoding.  The higher the
                 number, the less recognizable the output file}

</i></font><font color="#FF0000"><b>Function </b></font>HS_CheckScore<font color="#000080">(</font>score<font color="#000080">: </font>longint<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Checks to see if a score would make the highscore list}
{  score: longint - the score to check}
{Returns TRUE if the score made the list}

</i></font><font color="#FF0000"><b>Function </b></font>HS_NewScore<font color="#000080">(</font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>score<font color="#000080">: </font>longint<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{Adds a new score to the list if it belongs}
{  name: string -   the name of the player}
{  score: longint - the player's score}
{Returns TRUE if the score made the list}

</i></font><font color="#FF0000"><b>Procedure </b></font>HS_Clear<font color="#000080">;
</font><font color="#008000"><i>{Clears the highscore list, setting all names to dashes, all scores to 0}

</i></font><font color="#FF0000"><b>Function </b></font>HS_Name<font color="#000080">(</font>i<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#008000"><i>{Returns the name from the Ith place of the list}
{  i: byte - the rank to check}

</i></font><font color="#FF0000"><b>Function </b></font>HS_Score<font color="#000080">(</font>i<font color="#000080">: </font>byte<font color="#000080">): </font>longint<font color="#000080">;
</font><font color="#008000"><i>{Returns the score from the Ith place of the list}
{  i: byte - the rank to check}

</i></font><font color="#FF0000"><b>Procedure </b></font>HS_Done<font color="#000080">;
</font><font color="#008000"><i>{Disposes of the highscore manager and saves the highscore list}

</i></font><font color="#FF0000"><b>Implementation
Uses
  </b></font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>Type
  </b></font>PHSItem <font color="#000080">= ^</font>THSItem<font color="#000080">;
  </font>THSItem <font color="#000080">= </font><font color="#FF0000"><b>record
              </b></font>name<font color="#000080">:                     </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">25</font><font color="#000080">];
              </font>score<font color="#000080">:                    </font>longint<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>PHSItemList <font color="#000080">= ^</font>THSItemList<font color="#000080">;
  </font>THSItemList <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>THSItem<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>numitems<font color="#000080">, </font>code<font color="#000080">:                       </font>byte<font color="#000080">;
  </font>item<font color="#000080">:                                 </font>PHSItemList<font color="#000080">;
  </font>fn<font color="#000080">:                                   </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">50</font><font color="#000080">];
</font><font color="#FF0000"><b>Procedure </b></font>FlipBit<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Buf<font color="#000080">; </font>len<font color="#000080">, </font>code<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Type
  </b></font>TBuf <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:                                    </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>len<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>TBuf<font color="#000080">(</font>Buf<font color="#000080">)[</font>i<font color="#000080">]:=</font>TBuf<font color="#000080">(</font>Buf<font color="#000080">)[</font>i<font color="#000080">] </font><font color="#FF0000"><b>XOR </b></font>Code<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetStr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>s<font color="#000080">:                                    </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">1</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));
  </font>GetStr<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Exist<font color="#000080">(</font>fn<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>SRec<font color="#000080">:                                 </font>SearchRec<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FindFirst<font color="#000080">(</font>fn<font color="#000080">, </font><font color="#800000">$3F</font><font color="#000080">, </font>SRec<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>DosError<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exist<font color="#000080">:=</font>False <font color="#FF0000"><b>else </b></font>Exist<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HS_Init<font color="#000080">(</font>iNum<font color="#000080">: </font>byte<font color="#000080">; </font>ifn<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>icode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>f<font color="#000080">:                                    </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>i<font color="#000080">, </font>found<font color="#000080">:                             </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fn<font color="#000080">:=</font>ifn<font color="#000080">;
  </font>code<font color="#000080">:=</font>icode<font color="#000080">;
  </font>numitems<font color="#000080">:=</font>iNum<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>item<font color="#000080">, </font><font color="#800000">30</font><font color="#000080">*</font>numitems<font color="#000080">);
  </font>HS_Clear<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>exist<font color="#000080">(</font>fn<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Assign<font color="#000080">(</font>f<font color="#000080">, </font>fn<font color="#000080">);
    </font>Reset<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>found<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>numitems<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>numitems<font color="#000080">:=</font>found<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>found<font color="#000080">&gt;</font>numitems <font color="#FF0000"><b>then </b></font>found<font color="#000080">:=</font>numitems<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>found <font color="#FF0000"><b>do
    begin
      </b></font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">:=</font>GetStr<font color="#000080">(</font>f<font color="#000080">);
      </font>FlipBit<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>ord<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]), </font>code<font color="#000080">);
      </font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
      </font>FlipBit<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font>code<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>numitems<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>numitems<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>HS_CheckScore<font color="#000080">(</font>score<font color="#000080">: </font>longint<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>score<font color="#000080">&gt;</font>item<font color="#000080">^[</font>numitems<font color="#000080">].</font>score <font color="#FF0000"><b>then </b></font>HS_CheckScore<font color="#000080">:=</font>TRUE <font color="#FF0000"><b>else </b></font>HS_CheckScore<font color="#000080">:=</font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>HS_NewScore<font color="#000080">(</font>name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>score<font color="#000080">: </font>longint<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">:                                 </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>on</b></font><font color="#000080">:                                   </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>HS_NewScore<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numitems <font color="#FF0000"><b>do
    if </b></font>score<font color="#000080">&gt;</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score <font color="#FF0000"><b>then
    begin
      for </b></font>j<font color="#000080">:=</font>numitems <font color="#FF0000"><b>downto </b></font>i<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        </b></font>item<font color="#000080">^[</font>j<font color="#000080">]:=</font>item<font color="#000080">^[</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
      </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">:=</font>name<font color="#000080">;
      </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">:=</font>score<font color="#000080">;
      </font>score<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>i<font color="#000080">:=</font>numitems<font color="#000080">;
      </font>HS_NewScore<font color="#000080">:=</font>TRUE<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HS_Clear<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:                                    </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numitems <font color="#FF0000"><b>do
  begin
    </b></font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">:=</font><font color="#800000">'-------------------------'</font><font color="#000080">;
    </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>HS_Name<font color="#000080">(</font>i<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>HS_Name<font color="#000080">:=</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>HS_Score<font color="#000080">(</font>i<font color="#000080">: </font>byte<font color="#000080">): </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>HS_Score<font color="#000080">:=</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HS_Done<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>f<font color="#000080">:                                    </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>i<font color="#000080">:                                    </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>f<font color="#000080">, </font>fn<font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>BlockWrite<font color="#000080">(</font>f<font color="#000080">, </font>numitems<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numitems <font color="#FF0000"><b>do
  begin
    </b></font>FlipBit<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>ord<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]), </font>code<font color="#000080">);
    </font>BlockWrite<font color="#000080">(</font>f<font color="#000080">, </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">, </font>ord<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>name<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">);
    </font>FlipBit<font color="#000080">(</font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font>code<font color="#000080">);
    </font>BlockWrite<font color="#000080">(</font>f<font color="#000080">, </font>item<font color="#000080">^[</font>i<font color="#000080">].</font>score<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FreeMem<font color="#000080">(</font>item<font color="#000080">, </font><font color="#800000">30</font><font color="#000080">*</font>numitems<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0094.PAS">Original</a><b>]</b></p></body>
</html>
