<html>
<head><title> "RANDOM Numbers" by SWAG SUPPORT GROUP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>interface

procedure </b></font>InitRandomGenerator<font color="#000080">(</font>InitValue <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>Random<font color="#000080">:</font>real<font color="#000080">;

</font><font color="#FF0000"><b>implementation
type
  </b></font>Lint <font color="#000080">= </font><font color="#FF0000"><b>record
           </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">,</font>d <font color="#000080">: </font>word<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>yWertZufall <font color="#000080">: </font>Lint<font color="#000080">;
  </font>Modul       <font color="#000080">: </font>Lint<font color="#000080">;
  </font>Faktor      <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>LintMUL<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>p1<font color="#000080">: </font>Lint<font color="#000080">; </font>p2<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  asm
         </b></font><font color="#FF00FF">mov cx,4
         les di,p1
         xor bx,bx
         cld
  @mull: mov ax,es:[di]
         mov dx,p2
         mul dx
         add ax,bx
         adc dx,0
         mov bx,dx
         stosw
         loop @mull
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>LintSub<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>p1<font color="#000080">, </font>p2<font color="#000080">: </font>Lint<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>result <font color="#000080">: </font>longint<font color="#000080">;
  </font>carry <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>p1<font color="#000080">.</font>a<font color="#000080">;
  </font>dec<font color="#000080">(</font>result<font color="#000080">, </font>p2<font color="#000080">.</font>a<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>result <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>carry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>inc<font color="#000080">(</font>result<font color="#000080">, </font><font color="#800000">65536</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>carry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>p1<font color="#000080">.</font>a <font color="#000080">:= </font>result<font color="#000080">;
  </font>result <font color="#000080">:= </font>p1<font color="#000080">.</font>b<font color="#000080">;
  </font>dec<font color="#000080">(</font>result<font color="#000080">, </font>carry<font color="#000080">);
  </font>dec<font color="#000080">(</font>result<font color="#000080">, </font>p2<font color="#000080">.</font>b<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>result <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>carry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>inc<font color="#000080">(</font>result<font color="#000080">, </font><font color="#800000">65536</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>carry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>p1<font color="#000080">.</font>b <font color="#000080">:= </font>result<font color="#000080">;
  </font>result <font color="#000080">:= </font>p1<font color="#000080">.</font>c<font color="#000080">;
  </font>dec<font color="#000080">(</font>result<font color="#000080">, </font>carry<font color="#000080">);
  </font>dec<font color="#000080">(</font>result<font color="#000080">, </font>p2<font color="#000080">.</font>c<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>result <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>carry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>inc<font color="#000080">(</font>result<font color="#000080">, </font><font color="#800000">65536</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>carry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>p1<font color="#000080">.</font>c <font color="#000080">:= </font>result<font color="#000080">;
  </font>dec<font color="#000080">(</font>p1<font color="#000080">.</font>d<font color="#000080">, </font>carry<font color="#000080">);
  </font>dec<font color="#000080">(</font>p1<font color="#000080">.</font>d<font color="#000080">, </font>p2<font color="#000080">.</font>d<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitRandomGenerator<font color="#000080">(</font>InitValue <font color="#000080">: </font>longint<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>yWertZufall <font color="#FF0000"><b>do
  begin
    </b></font>b <font color="#000080">:= </font>InitWert <font color="#FF0000"><b>div </b></font><font color="#800000">65536</font><font color="#000080">;
    </font>a <font color="#000080">:= </font>InitWert <font color="#000080">- </font>b<font color="#000080">*</font><font color="#800000">65536</font><font color="#000080">;
    </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>d <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>(* InitRandomGenerator *)

</i></font><font color="#FF0000"><b>function </b></font>Random<font color="#000080">:</font>real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Wert <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LintMul<font color="#000080">(</font>yWertZufall <font color="#000080">, </font>Faktor<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>yWertZufall<font color="#000080">.</font>b <font color="#000080">&gt;</font><font color="#800000">32767 </font><font color="#FF0000"><b>then
    </b></font>LintSub<font color="#000080">(</font>yWertZufall<font color="#000080">,</font>Modul<font color="#000080">);

  </font>Wert <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font>yWertZufall<font color="#000080">.</font>c <font color="#000080">+ </font><font color="#800000">65536</font><font color="#000080">*</font>yWertZufall<font color="#000080">.</font>b<font color="#000080">+</font>yWertZufall<font color="#000080">.</font>a<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>yWertZufall <font color="#FF0000"><b>do  begin
    </b></font>d <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>b <font color="#000080">:= </font>Wert <font color="#FF0000"><b>shr </b></font><font color="#800000">16</font><font color="#000080">;
    </font>a <font color="#000080">:= </font>Wert <font color="#000080">- (</font>b<font color="#000080">*</font><font color="#800000">65536</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Zufall <font color="#000080">:= </font>Wert <font color="#000080">/ </font><font color="#800000">2147483647</font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>(* Zufall *)
</i></font><font color="#FF0000"><b>begin
  with </b></font>yWertZufall <font color="#FF0000"><b>do
  begin
    </b></font>a <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>b <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>d <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Faktor <font color="#000080">:= </font><font color="#800000">16807</font><font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>Modul <font color="#FF0000"><b>do
  begin
    </b></font>a <font color="#000080">:= </font><font color="#800000">65535</font><font color="#000080">;
    </font>b <font color="#000080">:= </font><font color="#800000">32767</font><font color="#000080">;
    </font>c <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>d <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>(* _Zufall *)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0062.PAS">Original</a><b>]</b></p></body>
</html>
