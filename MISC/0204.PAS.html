<html>
<head><title> "Various Useful Routines" by ZAK SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0204.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ Unit for Common Interface Routines }

</i></font><font color="#FF0000"><b>Unit </b></font>ETC<font color="#000080">;
</font><font color="#008000"><i>{$O+}

(************) </i></font><font color="#FF0000"><b>interface </b></font><font color="#008000"><i>(*************)

</i></font><font color="#FF0000"><b>type </b></font>carriertype <font color="#000080">= </font><font color="#FF0000"><b>function</b></font><font color="#000080">:</font>boolean<font color="#000080">;

 </font><font color="#FF0000"><b>var
    </b></font>ANSI       <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>useinsert  <font color="#000080">: </font>boolean<font color="#000080">;
    </font>CapsOn     <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>PortCheck  <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>carrierfunc<font color="#000080">: </font>carriertype<font color="#000080">;




</font><font color="#FF0000"><b>Type </b></font>pwtype <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

</font><font color="#FF0000"><b>type </b></font>dofiletype <font color="#000080">= </font><font color="#FF0000"><b>function</b></font><font color="#000080">(</font>fn<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;

</font>attribtype <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">;
</font>attribset <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>attribtype<font color="#000080">;    </font><font color="#008000"><i>{ access attribute set A-X }

</i></font><font color="#FF0000"><b>function </b></font>trimch<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>c<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>sizeoffilespec<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>longint<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CopyFile<font color="#000080">(</font>s<font color="#000080">,</font>d<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>Rows<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>columns<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ungetch<font color="#000080">(</font>key<font color="#000080">:</font>word<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>xpos<font color="#000080">(</font>sub<font color="#000080">:</font>char<font color="#000080">;</font>main<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>x<font color="#000080">:</font>byte<font color="#000080">):</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>StripSpaces<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>printscreen<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AttribStr<font color="#000080">(</font>a<font color="#000080">:</font>attribset<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>rjustify<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>l<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#008000"><i>{Function HexStr(n:longint):string;}

</i></font><font color="#FF0000"><b>Procedure </b></font>KillFileSpec<font color="#000080">(</font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>Byte2Hex<font color="#000080">(</font>numb <font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;       </font><font color="#008000"><i>{ Converts byte to hex string }
</i></font><font color="#FF0000"><b>function </b></font>Word2Hex<font color="#000080">(</font>numb<font color="#000080">: </font>word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;        </font><font color="#008000"><i>{ Converts word to hex string.}
</i></font><font color="#FF0000"><b>function </b></font>Long2Hex<font color="#000080">(</font>L<font color="#000080">: </font>longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;     </font><font color="#008000"><i>{ Converts longint to hex string }

</i></font><font color="#FF0000"><b>function </b></font>base36<font color="#000080">(</font>n<font color="#000080">:</font>longint<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SplitFilePath<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SplitFileExt <font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SplitFileName<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Longhash<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>r<font color="#000080">:</font>pwtype<font color="#000080">);

</font><font color="#FF0000"><b>function  </b></font>numtowords<font color="#000080">(</font>n<font color="#000080">:</font>word<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>prunedir<font color="#000080">(</font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>DtTmStamp<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>tostr2<font color="#000080">(</font>s<font color="#000080">:</font>longint<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>movefile<font color="#000080">(</font>fp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>td<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>ToStr<font color="#000080">(</font>s<font color="#000080">: </font>longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>tostrb<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>CurTimestr<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>PR<font color="#000080">(</font>t<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>Newline<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>ColorFG<font color="#000080">(</font>c<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>ColorBG<font color="#000080">(</font>c<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>PhoneEditor<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AnswerForMain<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>prestring<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>Editor<font color="#000080">(</font>maxlen<font color="#000080">: </font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Answerformain<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>prestring<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>Setup_Output<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>ShowMC<font color="#000080">(</font>Ch<font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>GetChoice<font color="#000080">(</font>numofchoices<font color="#000080">: </font>byte<font color="#000080">; </font>Choices<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">,</font>oc<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Reply<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>ClearScreen<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Key<font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>lowcase<font color="#000080">(</font>ch<font color="#000080">: </font>char<font color="#000080">): </font>char<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>casestr<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Ltab<font color="#000080">(</font>n<font color="#000080">: </font>integer<font color="#000080">;</font>m<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Ltabc<font color="#000080">(</font>n<font color="#000080">,</font>m<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>UpcaseStr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>lowcasestr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>ExistFile<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>flags<font color="#000080">:</font>word<font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>compare<font color="#000080">(</font>s1<font color="#000080">,</font>s2<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Rtrim<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>ltrim<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">(</font>Hz<font color="#000080">,</font>Ms<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#008000"><i>{function  carrier_on:boolean;}
</i></font><font color="#FF0000"><b>procedure </b></font>CurTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>h<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>SecondsSinceMidnight<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">:</font>word<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>nowsecondssincemidnight<font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ShortPath<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>nowmins<font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>toint<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>word<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>tolong<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>longint<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CRC32Array<font color="#000080">(</font>p<font color="#000080">:</font>pointer<font color="#000080">;</font>l<font color="#000080">:</font>longint<font color="#000080">):</font>longint<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>UpdCrc<font color="#000080">(</font>cp<font color="#000080">: </font>BYTE<font color="#000080">; </font>crc<font color="#000080">: </font>WORD<font color="#000080">): </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>UpdC32<font color="#000080">(</font>octet<font color="#000080">: </font>BYTE<font color="#000080">; </font>crc<font color="#000080">: </font>LONGINT<font color="#000080">) : </font>LONGINT<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVLoaded<font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Hex2Byte<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>int2comma<font color="#000080">(</font>l<font color="#000080">:</font>longint<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>wordCrypt<font color="#000080">(</font>P<font color="#000080">: </font>pointer<font color="#000080">;</font>l<font color="#000080">:</font>word<font color="#000080">;</font>progcode<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>throughfiles<font color="#000080">(</font>filespec<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>df<font color="#000080">:</font>dofiletype<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>FindStrInarRay<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>buf<font color="#000080">;</font>l<font color="#000080">:</font>word<font color="#000080">;</font>fs<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Power<font color="#000080">(</font>b<font color="#000080">,</font>e<font color="#000080">:</font>longint<font color="#000080">):</font>longint<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>C2Pas<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>nthoc<font color="#000080">(</font>c<font color="#000080">:</font>char<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">;</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetFlag<font color="#000080">(</font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">);

</font><font color="#FF0000"><b>function </b></font>readflag<font color="#000080">(</font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">):</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>barepasswdinput<font color="#000080">(</font>m<font color="#000080">:</font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;


</font><font color="#008000"><i>(************) </i></font><font color="#FF0000"><b>Implementation </b></font><font color="#008000"><i>(***************)

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>barepasswdinput<font color="#000080">(</font>m<font color="#000080">:</font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>c<font color="#000080">:</font>char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;

  </font><font color="#FF0000"><b>repeat
    begin
    repeat
      if </b></font>portcheck <font color="#FF0000"><b>then
        if not </b></font>carrierfunc <font color="#FF0000"><b>then
         begin
         </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end
    until </b></font>keypressed<font color="#000080">;
    </font>c<font color="#000080">:=</font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>c <font color="#FF0000"><b>of
      </b></font><font color="#800000">#8</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
            </b></font>write<font color="#000080">(</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">);
            </font>dec<font color="#000080">(</font>byte<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">' '</font><font color="#000080">..</font><font color="#800000">'~'</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>s<font color="#000080">)&lt;</font>m <font color="#FF0000"><b>then
                  begin
                  </b></font>s<font color="#000080">:=</font>s<font color="#000080">+</font>c<font color="#000080">;
                  </font>write<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    end
  until </b></font>c<font color="#000080">=</font><font color="#800000">#13</font><font color="#000080">;
  </font>barepasswdinput<font color="#000080">:=</font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>SetFlag<font color="#000080">(</font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ i is bit to be set }
</i></font>i<font color="#000080">:=</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ 1st bit is offset 0 }
</i></font>temp <font color="#000080">:= </font>i <font color="#FF0000"><b>DIV </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">* </font><font color="#800000">8</font><font color="#000080">);
</font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>a<font color="#000080">):</font>ofs<font color="#000080">(</font>a<font color="#000080">)+</font>temp<font color="#000080">] := </font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>a<font color="#000080">):</font>ofs<font color="#000080">(</font>a<font color="#000080">)+</font>temp<font color="#000080">] </font><font color="#FF0000"><b>OR </b></font>Power<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>i<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>readflag<font color="#000080">(</font>i<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">):</font>boolean<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ i is bit to be set }
</i></font>i<font color="#000080">:=</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ 1st bit is offset 0 }
</i></font>temp <font color="#000080">:= </font>i <font color="#FF0000"><b>DIV </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">* </font><font color="#800000">8</font><font color="#000080">);
</font>readflag <font color="#000080">:= (</font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>a<font color="#000080">):</font>ofs<font color="#000080">(</font>a<font color="#000080">)+</font>temp<font color="#000080">]) </font><font color="#FF0000"><b>AND </b></font>Power<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>i<font color="#000080">) = </font>power<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>i<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;






</font><font color="#FF0000"><b>function </b></font>nthoc<font color="#000080">(</font>c<font color="#000080">:</font>char<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">;</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
     </font>cnt<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>cnt<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
   begin
   if </b></font>s<font color="#000080">[</font>i<font color="#000080">]=</font>c <font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>cnt<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>cnt<font color="#000080">=</font>b <font color="#FF0000"><b>then
     begin
     </b></font>nthoc<font color="#000080">:=</font>i<font color="#000080">;
     </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CopyFile<font color="#000080">(</font>s<font color="#000080">,</font>d<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>const </b></font>bs<font color="#000080">=</font><font color="#800000">16384</font><font color="#000080">;
 </font><font color="#FF0000"><b>type </b></font>bt<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>bs<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>sf<font color="#000080">,</font>df<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
     </font>b<font color="#000080">:^</font>bt<font color="#000080">;
     </font>i<font color="#000080">:</font>word<font color="#000080">;
     </font>fs<font color="#000080">:</font>longint<font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>new<font color="#000080">(</font>b<font color="#000080">);
 </font>assign<font color="#000080">(</font>sf<font color="#000080">,</font>s<font color="#000080">);
 </font>reset<font color="#000080">(</font>sf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>assign<font color="#000080">(</font>df<font color="#000080">,</font>d<font color="#000080">);
 </font>rewrite<font color="#000080">(</font>df<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

 </font>fs<font color="#000080">:=</font>filesize<font color="#000080">(</font>sf<font color="#000080">);

 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>fs <font color="#FF0000"><b>div </b></font>bs<font color="#000080">) </font><font color="#FF0000"><b>do
   begin
   </b></font>blockread<font color="#000080">(</font>sf<font color="#000080">,</font>b<font color="#000080">^,</font>bs<font color="#000080">);
   </font>blockwrite<font color="#000080">(</font>df<font color="#000080">,</font>b<font color="#000080">^,</font>bs<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>blockread<font color="#000080">(</font>sf<font color="#000080">,</font>b<font color="#000080">^,</font>fs <font color="#FF0000"><b>mod </b></font>bs<font color="#000080">);
 </font>blockwrite<font color="#000080">(</font>df<font color="#000080">,</font>b<font color="#000080">^,</font>fs <font color="#FF0000"><b>mod </b></font>bs<font color="#000080">);

 </font>dispose<font color="#000080">(</font>b<font color="#000080">);

 </font>close<font color="#000080">(</font>sf<font color="#000080">);
 </font>close<font color="#000080">(</font>df<font color="#000080">);

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>c2pas<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>b <font color="#000080">:^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>b<font color="#000080">:= </font>ptr<font color="#000080">(</font>seg<font color="#000080">(</font>s<font color="#000080">),</font>ofs<font color="#000080">(</font>s<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
 </font>b<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#255</font><font color="#000080">;
 </font>b<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]:=</font>char<font color="#000080">(</font>pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font>b<font color="#000080">^));
 </font>c2pas<font color="#000080">:=</font>b<font color="#000080">^;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>Function </b></font>Power<font color="#000080">(</font>b<font color="#000080">,</font>e<font color="#000080">:</font>longint<font color="#000080">):</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>t<font color="#000080">,</font>c<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   </b></font>t<font color="#000080">:=</font>b<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>e<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font>power<font color="#000080">:=</font><font color="#800000">1 </font><font color="#000080">; </font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>e<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>t<font color="#000080">:=</font>t<font color="#000080">*</font>b<font color="#000080">;
   </font>power<font color="#000080">:=</font>t<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FindStrInarRay<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>buf<font color="#000080">;</font>l<font color="#000080">:</font>word<font color="#000080">;</font>fs<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>type </b></font>bigbuft <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>buffer<font color="#000080">: </font>bigbuft <font color="#FF0000"><b>absolute </b></font>buf<font color="#000080">;
     </font>p<font color="#000080">:</font>word<font color="#000080">;
     </font>sscrc<font color="#000080">:</font>longint<font color="#000080">;

 </font><font color="#FF0000"><b>procedure </b></font>loop<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>word<font color="#000080">;
      </font>ts<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin

  </b></font>ts<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>fs<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];

  </font><font color="#FF0000"><b>for </b></font>c<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l<font color="#000080">-</font>length<font color="#000080">(</font>fs<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
    </b></font>move<font color="#000080">(</font>buffer<font color="#000080">[</font>c<font color="#000080">],</font>ts<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>length<font color="#000080">(</font>fs<font color="#000080">));
    </font><font color="#FF0000"><b>if </b></font>ts<font color="#000080">=</font>fs <font color="#FF0000"><b>then
     begin
     </b></font>p<font color="#000080">:=</font>c<font color="#000080">;
     </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#008000"><i>{if sscrc=crc32array(@buffer[c],length(fs)) then
      begin
      p:=c;
      exit;
      end;
    }




    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#FF0000"><b>begin

 if </b></font>l<font color="#000080">&lt;</font>length<font color="#000080">(</font>fs<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
  </b></font>findstrinarray<font color="#000080">:=</font><font color="#800000">$ffff</font><font color="#000080">;
  </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ sscrc:=Crc32Array(@fs[1],length(fs));}

 </i></font>p<font color="#000080">:=</font><font color="#800000">$FFFF</font><font color="#000080">;

 </font>loop<font color="#000080">;

 </font>FindStrInArray<font color="#000080">:=</font>p<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>throughfiles<font color="#000080">(</font>filespec<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>df<font color="#000080">:</font>dofiletype<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">;
     </font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>p<font color="#000080">:=</font>splitfilepath<font color="#000080">(</font>filespec<font color="#000080">);

 </font>FindFirst<font color="#000080">(</font>FileSpec<font color="#000080">,</font>AnyFile <font color="#FF0000"><b>XOR </b></font>Directory <font color="#FF0000"><b>XOR </b></font>SysFile <font color="#FF0000"><b>XOR </b></font>ReadOnly<font color="#000080">,</font>S<font color="#000080">);

 </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
   begin
   if not </b></font>df<font color="#000080">(</font>p<font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
   </font>findnext<font color="#000080">(</font>S<font color="#000080">)
   </font><font color="#FF0000"><b>end

 end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>sizeoffilespec<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>searchrec<font color="#000080">;
       </font>t<font color="#000080">:</font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>t<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

  </font>FindFirst<font color="#000080">(</font>s<font color="#000080">,</font>AnyFile<font color="#000080">,</font>sr<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
   begin
   if </b></font>sr<font color="#000080">.</font>name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">'.' </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>t<font color="#000080">,</font>sr<font color="#000080">.</font>size<font color="#000080">);

   </font>findnext<font color="#000080">(</font>Sr<font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>sizeoffilespec<font color="#000080">:=</font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>rows<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>type </b></font>BiosType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$A1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>Bios<font color="#000080">: </font>BiosType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>Rows <font color="#000080">:= </font>Bios<font color="#000080">[</font><font color="#800000">$84</font><font color="#000080">] + </font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>columns<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>type </b></font>BiosType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$A1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>Bios<font color="#000080">: </font>BiosType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>columns <font color="#000080">:= </font>Bios<font color="#000080">[</font><font color="#800000">$4A</font><font color="#000080">];
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{procedure ungetch(c:char);
 begin
  memw[$40:$1a]:=$1e;
  memw[$40:$1c]:=$1e+2;
  memw[$40:$1c+2]:=ord(c);
 end;}

{procedure ungetch(c:char);
 var nread: word absolute $40:$1a;
     npush: word absolute $40:$1c;
 begin
  if (npush-nread)&lt;30 then
    begin
    memw[$40:npush]:=ord(c);
    inc(npush,2);
    end
 end;}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ungetch<font color="#000080">( </font>Key <font color="#000080">: </font>WORD <font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah, $05
  mov cx, Key
  int $16
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>wordCrypt<font color="#000080">(</font>P<font color="#000080">: </font>pointer<font color="#000080">;</font>l<font color="#000080">:</font>word<font color="#000080">;</font>progcode<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>l<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
  </b></font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>p<font color="#000080">^):</font>ofs<font color="#000080">(</font>p<font color="#000080">^)+</font>i<font color="#000080">]:=</font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>p<font color="#000080">^):</font>ofs<font color="#000080">(</font>p<font color="#000080">^)+</font>i<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font>Byte<font color="#000080">(</font>ProgCode<font color="#000080">[</font>i <font color="#FF0000"><b>mod </b></font>ord <font color="#000080">(</font>ProgCode <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">])
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>trimch<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>c<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>trimch<font color="#000080">:=</font>ltrim<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">,</font>pos<font color="#000080">(</font>c<font color="#000080">,</font>s<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>s<font color="#000080">)-</font>pos<font color="#000080">(</font>c<font color="#000080">,</font>s<font color="#000080">)));
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>StripSpaces<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>a<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>while </b></font>a<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
   </b></font>delete<font color="#000080">(</font>s<font color="#000080">,</font>a<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>a<font color="#000080">:=</font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>StripSpaces<font color="#000080">:=</font>s<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>xpos<font color="#000080">(</font>sub<font color="#000080">:</font>char<font color="#000080">;</font>main<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>x<font color="#000080">:</font>byte<font color="#000080">):</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
     </font>n<font color="#000080">:</font>byte<font color="#000080">;
     </font>p<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>n<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>x <font color="#FF0000"><b>do
   begin
   </b></font>p<font color="#000080">:=</font>pos<font color="#000080">(</font>sub<font color="#000080">,</font>main<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>p<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>xpos<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end
   else
    begin
    </b></font>delete<font color="#000080">(</font>main<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>p<font color="#000080">);
    </font>n<font color="#000080">:=</font>p<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>xpos<font color="#000080">:=</font>n<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Byte2Hex<font color="#000080">(</font>numb <font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;       </font><font color="#008000"><i>{ Converts byte to hex string }
  </i></font><font color="#FF0000"><b>const
    </b></font>HexChars <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Byte2Hex<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#2</font><font color="#000080">;
    </font>Byte2Hex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>HexChars<font color="#000080">[</font>numb <font color="#FF0000"><b>shr  </b></font><font color="#800000">4</font><font color="#000080">];
    </font>Byte2Hex<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>HexChars<font color="#000080">[</font>numb <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Byte2Hex }

</i></font><font color="#FF0000"><b>function </b></font>Word2Hex<font color="#000080">(</font>numb<font color="#000080">: </font>word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;        </font><font color="#008000"><i>{ Converts word to hex string.}
  </i></font><font color="#FF0000"><b>begin
    </b></font>Word2Hex <font color="#000080">:= </font>Byte2Hex<font color="#000080">(</font>hi<font color="#000080">(</font>numb<font color="#000080">))+</font>Byte2Hex<font color="#000080">(</font>lo<font color="#000080">(</font>numb<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Numb2Hex }

</i></font><font color="#FF0000"><b>function </b></font>Long2Hex<font color="#000080">(</font>L<font color="#000080">: </font>longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;     </font><font color="#008000"><i>{ Converts longint to hex string }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Long2Hex <font color="#000080">:=</font>Word2Hex<font color="#000080">(</font>L <font color="#FF0000"><b>shr </b></font><font color="#800000">16</font><font color="#000080">)+ </font>Word2Hex<font color="#000080">(</font>word<font color="#000080">(</font>L<font color="#000080">)) ;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Long2Hex }

</i></font><font color="#FF0000"><b>Function </b></font>AttribStr<font color="#000080">(</font>a<font color="#000080">:</font>attribset<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;
     </font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">24 </font><font color="#FF0000"><b>do
   if </b></font>i <font color="#FF0000"><b>in </b></font>a <font color="#FF0000"><b>then
     begin
     </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">);
     </font>s<font color="#000080">[</font>i<font color="#000080">]:=</font>chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">+</font>i<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ for i:=1 to ord(s[0]) do
   begin



   end;}
 </i></font>attribstr<font color="#000080">:=</font>s<font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>rjustify<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>l<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
     </font>a<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>a<font color="#000080">:=</font>s<font color="#000080">;
 </font><font color="#FF0000"><b>while </b></font>length<font color="#000080">(</font>a<font color="#000080">)&lt;</font>l <font color="#FF0000"><b>do </b></font>insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>a<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>rjustify<font color="#000080">:=</font>a<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>movefile<font color="#000080">(</font>fp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>td<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>begin
 </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>fp<font color="#000080">);
 </font>rename<font color="#000080">(</font>f<font color="#000080">,</font>td<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>SplitFileName<font color="#000080">(</font>fp<font color="#000080">));

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>int2comma<font color="#000080">(</font>l<font color="#000080">:</font>longint<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
     </font>i<font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin

 </b></font>str<font color="#000080">(</font>l<font color="#000080">:</font>b<font color="#000080">,</font>s<font color="#000080">);

 </font>i<font color="#000080">:=</font>length<font color="#000080">(</font>s<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
 </font><font color="#FF0000"><b>while </b></font>i<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin

   if </b></font>s<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]&lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>insert<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>s<font color="#000080">,</font>i<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>insert<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">,</font>i<font color="#000080">);

   </font>dec<font color="#000080">(</font>i<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>int2comma<font color="#000080">:=</font>s<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DVloaded<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>in_dv<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>in_dv<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">mov cx,'DE'
    mov dx,'SQ'
    mov ax,$2b01
    int $21
    cmp al,$ff
    je @No_Desqview
    mov In_DV,true
    @No_Desqview:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>dvloaded<font color="#000080">:= </font>in_dv<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Hex2Byte<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>val<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
    </font>t<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  if </b></font>length<font color="#000080">(</font>s<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>s<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>s<font color="#000080">;
  </font>s<font color="#000080">:=</font>upcasestr<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>val<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">:=</font>i<font color="#000080">*</font><font color="#800000">$10</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do if </b></font>s<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font>val<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>t<font color="#000080">,</font>i<font color="#000080">);
  </font>Hex2Byte<font color="#000080">:=</font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>base36<font color="#000080">(</font>n<font color="#000080">:</font>longint<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>t<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>i<font color="#000080">:</font>byte<font color="#000080">;

 </font><font color="#FF0000"><b>const </b></font>d36<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">=</font><font color="#800000">' 123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'</font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
  
  </b></font>t<font color="#000080">:=</font>d36<font color="#000080">[    </font>n <font color="#FF0000"><b>div </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)]+
     </font>d36<font color="#000080">[   (</font>n <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)]+
     </font>d36<font color="#000080">[  ((</font>n <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)]+
     </font>d36<font color="#000080">[ (((</font>n <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)]+
     </font>d36<font color="#000080">[((((</font>n <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">36</font><font color="#000080">]+
     </font>d36<font color="#000080">[((((</font>n <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">36</font><font color="#000080">*</font><font color="#800000">36</font><font color="#000080">)) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">36</font><font color="#000080">];

  </font>t<font color="#000080">:=</font>ltrim<font color="#000080">(</font>t<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>t<font color="#000080">) </font><font color="#FF0000"><b>do if </b></font>t<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
  </font>base36<font color="#000080">:=</font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>HexStr<font color="#000080">(</font>n<font color="#000080">:</font>longint<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>t<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>i<font color="#000080">:</font>byte<font color="#000080">;

 </font><font color="#FF0000"><b>const </b></font>d16<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">=</font><font color="#800000">' 123456789ABCDEF'</font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
  </b></font>t<font color="#000080">:=</font>d16<font color="#000080">[      </font>n <font color="#FF0000"><b>div </b></font><font color="#800000">$1000000</font><font color="#000080">]+
     </font>d16<font color="#000080">[     (</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">$100000</font><font color="#000080">]+
     </font>d16<font color="#000080">[    ((</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100000</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">$10000</font><font color="#000080">]+
     </font>d16<font color="#000080">[   (((</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$10000</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">$1000</font><font color="#000080">]+
     </font>d16<font color="#000080">[  ((((</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$10000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$1000</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">$100</font><font color="#000080">]+
     </font>d16<font color="#000080">[ (((((</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$10000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$1000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">$10</font><font color="#000080">]+
     </font>d16<font color="#000080">[ (((((</font>n <font color="#FF0000"><b>mod </b></font><font color="#800000">$1000000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$10000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$1000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$100</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">$10</font><font color="#000080">];

  </font>t<font color="#000080">:=</font>ltrim<font color="#000080">(</font>t<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>t<font color="#000080">) </font><font color="#FF0000"><b>do if </b></font>t<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
  </font>hexstr<font color="#000080">:=</font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>CRC32Array<font color="#000080">(</font>p<font color="#000080">:</font>pointer<font color="#000080">;</font>l<font color="#000080">:</font>longint<font color="#000080">):</font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i   <font color="#000080">:</font>longint<font color="#000080">;</font>crc <font color="#000080">:</font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>CRC<font color="#000080">:=</font><font color="#800000">$FfFfFfFf</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l <font color="#FF0000"><b>do </b></font>CRC<font color="#000080">:=</font>UpDC32<font color="#000080">(</font>mem<font color="#000080">[</font>seg<font color="#000080">(</font>p<font color="#000080">^):</font>ofs<font color="#000080">(</font>p<font color="#000080">^)+</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">],</font>crc<font color="#000080">);
 </font>CRC32ARRAY<font color="#000080">:=</font>crc<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(* crctab calculated by Mark G. Mendel, Network Systems Corporation *)
</i></font><font color="#FF0000"><b>CONST </b></font>crctab<font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD <font color="#000080">= (
    </font><font color="#800000">$0000</font><font color="#000080">,  </font><font color="#800000">$1021</font><font color="#000080">,  </font><font color="#800000">$2042</font><font color="#000080">,  </font><font color="#800000">$3063</font><font color="#000080">,  </font><font color="#800000">$4084</font><font color="#000080">,  </font><font color="#800000">$50a5</font><font color="#000080">,  </font><font color="#800000">$60c6</font><font color="#000080">,  </font><font color="#800000">$70e7</font><font color="#000080">,
    </font><font color="#800000">$8108</font><font color="#000080">,  </font><font color="#800000">$9129</font><font color="#000080">,  </font><font color="#800000">$a14a</font><font color="#000080">,  </font><font color="#800000">$b16b</font><font color="#000080">,  </font><font color="#800000">$c18c</font><font color="#000080">,  </font><font color="#800000">$d1ad</font><font color="#000080">,  </font><font color="#800000">$e1ce</font><font color="#000080">,  </font><font color="#800000">$f1ef</font><font color="#000080">,
    </font><font color="#800000">$1231</font><font color="#000080">,  </font><font color="#800000">$0210</font><font color="#000080">,  </font><font color="#800000">$3273</font><font color="#000080">,  </font><font color="#800000">$2252</font><font color="#000080">,  </font><font color="#800000">$52b5</font><font color="#000080">,  </font><font color="#800000">$4294</font><font color="#000080">,  </font><font color="#800000">$72f7</font><font color="#000080">,  </font><font color="#800000">$62d6</font><font color="#000080">,
    </font><font color="#800000">$9339</font><font color="#000080">,  </font><font color="#800000">$8318</font><font color="#000080">,  </font><font color="#800000">$b37b</font><font color="#000080">,  </font><font color="#800000">$a35a</font><font color="#000080">,  </font><font color="#800000">$d3bd</font><font color="#000080">,  </font><font color="#800000">$c39c</font><font color="#000080">,  </font><font color="#800000">$f3ff</font><font color="#000080">,  </font><font color="#800000">$e3de</font><font color="#000080">,
    </font><font color="#800000">$2462</font><font color="#000080">,  </font><font color="#800000">$3443</font><font color="#000080">,  </font><font color="#800000">$0420</font><font color="#000080">,  </font><font color="#800000">$1401</font><font color="#000080">,  </font><font color="#800000">$64e6</font><font color="#000080">,  </font><font color="#800000">$74c7</font><font color="#000080">,  </font><font color="#800000">$44a4</font><font color="#000080">,  </font><font color="#800000">$5485</font><font color="#000080">,
    </font><font color="#800000">$a56a</font><font color="#000080">,  </font><font color="#800000">$b54b</font><font color="#000080">,  </font><font color="#800000">$8528</font><font color="#000080">,  </font><font color="#800000">$9509</font><font color="#000080">,  </font><font color="#800000">$e5ee</font><font color="#000080">,  </font><font color="#800000">$f5cf</font><font color="#000080">,  </font><font color="#800000">$c5ac</font><font color="#000080">,  </font><font color="#800000">$d58d</font><font color="#000080">,
    </font><font color="#800000">$3653</font><font color="#000080">,  </font><font color="#800000">$2672</font><font color="#000080">,  </font><font color="#800000">$1611</font><font color="#000080">,  </font><font color="#800000">$0630</font><font color="#000080">,  </font><font color="#800000">$76d7</font><font color="#000080">,  </font><font color="#800000">$66f6</font><font color="#000080">,  </font><font color="#800000">$5695</font><font color="#000080">,  </font><font color="#800000">$46b4</font><font color="#000080">,
    </font><font color="#800000">$b75b</font><font color="#000080">,  </font><font color="#800000">$a77a</font><font color="#000080">,  </font><font color="#800000">$9719</font><font color="#000080">,  </font><font color="#800000">$8738</font><font color="#000080">,  </font><font color="#800000">$f7df</font><font color="#000080">,  </font><font color="#800000">$e7fe</font><font color="#000080">,  </font><font color="#800000">$d79d</font><font color="#000080">,  </font><font color="#800000">$c7bc</font><font color="#000080">,
    </font><font color="#800000">$48c4</font><font color="#000080">,  </font><font color="#800000">$58e5</font><font color="#000080">,  </font><font color="#800000">$6886</font><font color="#000080">,  </font><font color="#800000">$78a7</font><font color="#000080">,  </font><font color="#800000">$0840</font><font color="#000080">,  </font><font color="#800000">$1861</font><font color="#000080">,  </font><font color="#800000">$2802</font><font color="#000080">,  </font><font color="#800000">$3823</font><font color="#000080">,
    </font><font color="#800000">$c9cc</font><font color="#000080">,  </font><font color="#800000">$d9ed</font><font color="#000080">,  </font><font color="#800000">$e98e</font><font color="#000080">,  </font><font color="#800000">$f9af</font><font color="#000080">,  </font><font color="#800000">$8948</font><font color="#000080">,  </font><font color="#800000">$9969</font><font color="#000080">,  </font><font color="#800000">$a90a</font><font color="#000080">,  </font><font color="#800000">$b92b</font><font color="#000080">,
    </font><font color="#800000">$5af5</font><font color="#000080">,  </font><font color="#800000">$4ad4</font><font color="#000080">,  </font><font color="#800000">$7ab7</font><font color="#000080">,  </font><font color="#800000">$6a96</font><font color="#000080">,  </font><font color="#800000">$1a71</font><font color="#000080">,  </font><font color="#800000">$0a50</font><font color="#000080">,  </font><font color="#800000">$3a33</font><font color="#000080">,  </font><font color="#800000">$2a12</font><font color="#000080">,
    </font><font color="#800000">$dbfd</font><font color="#000080">,  </font><font color="#800000">$cbdc</font><font color="#000080">,  </font><font color="#800000">$fbbf</font><font color="#000080">,  </font><font color="#800000">$eb9e</font><font color="#000080">,  </font><font color="#800000">$9b79</font><font color="#000080">,  </font><font color="#800000">$8b58</font><font color="#000080">,  </font><font color="#800000">$bb3b</font><font color="#000080">,  </font><font color="#800000">$ab1a</font><font color="#000080">,
    </font><font color="#800000">$6ca6</font><font color="#000080">,  </font><font color="#800000">$7c87</font><font color="#000080">,  </font><font color="#800000">$4ce4</font><font color="#000080">,  </font><font color="#800000">$5cc5</font><font color="#000080">,  </font><font color="#800000">$2c22</font><font color="#000080">,  </font><font color="#800000">$3c03</font><font color="#000080">,  </font><font color="#800000">$0c60</font><font color="#000080">,  </font><font color="#800000">$1c41</font><font color="#000080">,
    </font><font color="#800000">$edae</font><font color="#000080">,  </font><font color="#800000">$fd8f</font><font color="#000080">,  </font><font color="#800000">$cdec</font><font color="#000080">,  </font><font color="#800000">$ddcd</font><font color="#000080">,  </font><font color="#800000">$ad2a</font><font color="#000080">,  </font><font color="#800000">$bd0b</font><font color="#000080">,  </font><font color="#800000">$8d68</font><font color="#000080">,  </font><font color="#800000">$9d49</font><font color="#000080">,
    </font><font color="#800000">$7e97</font><font color="#000080">,  </font><font color="#800000">$6eb6</font><font color="#000080">,  </font><font color="#800000">$5ed5</font><font color="#000080">,  </font><font color="#800000">$4ef4</font><font color="#000080">,  </font><font color="#800000">$3e13</font><font color="#000080">,  </font><font color="#800000">$2e32</font><font color="#000080">,  </font><font color="#800000">$1e51</font><font color="#000080">,  </font><font color="#800000">$0e70</font><font color="#000080">,
    </font><font color="#800000">$ff9f</font><font color="#000080">,  </font><font color="#800000">$efbe</font><font color="#000080">,  </font><font color="#800000">$dfdd</font><font color="#000080">,  </font><font color="#800000">$cffc</font><font color="#000080">,  </font><font color="#800000">$bf1b</font><font color="#000080">,  </font><font color="#800000">$af3a</font><font color="#000080">,  </font><font color="#800000">$9f59</font><font color="#000080">,  </font><font color="#800000">$8f78</font><font color="#000080">,
    </font><font color="#800000">$9188</font><font color="#000080">,  </font><font color="#800000">$81a9</font><font color="#000080">,  </font><font color="#800000">$b1ca</font><font color="#000080">,  </font><font color="#800000">$a1eb</font><font color="#000080">,  </font><font color="#800000">$d10c</font><font color="#000080">,  </font><font color="#800000">$c12d</font><font color="#000080">,  </font><font color="#800000">$f14e</font><font color="#000080">,  </font><font color="#800000">$e16f</font><font color="#000080">,
    </font><font color="#800000">$1080</font><font color="#000080">,  </font><font color="#800000">$00a1</font><font color="#000080">,  </font><font color="#800000">$30c2</font><font color="#000080">,  </font><font color="#800000">$20e3</font><font color="#000080">,  </font><font color="#800000">$5004</font><font color="#000080">,  </font><font color="#800000">$4025</font><font color="#000080">,  </font><font color="#800000">$7046</font><font color="#000080">,  </font><font color="#800000">$6067</font><font color="#000080">,
    </font><font color="#800000">$83b9</font><font color="#000080">,  </font><font color="#800000">$9398</font><font color="#000080">,  </font><font color="#800000">$a3fb</font><font color="#000080">,  </font><font color="#800000">$b3da</font><font color="#000080">,  </font><font color="#800000">$c33d</font><font color="#000080">,  </font><font color="#800000">$d31c</font><font color="#000080">,  </font><font color="#800000">$e37f</font><font color="#000080">,  </font><font color="#800000">$f35e</font><font color="#000080">,
    </font><font color="#800000">$02b1</font><font color="#000080">,  </font><font color="#800000">$1290</font><font color="#000080">,  </font><font color="#800000">$22f3</font><font color="#000080">,  </font><font color="#800000">$32d2</font><font color="#000080">,  </font><font color="#800000">$4235</font><font color="#000080">,  </font><font color="#800000">$5214</font><font color="#000080">,  </font><font color="#800000">$6277</font><font color="#000080">,  </font><font color="#800000">$7256</font><font color="#000080">,
    </font><font color="#800000">$b5ea</font><font color="#000080">,  </font><font color="#800000">$a5cb</font><font color="#000080">,  </font><font color="#800000">$95a8</font><font color="#000080">,  </font><font color="#800000">$8589</font><font color="#000080">,  </font><font color="#800000">$f56e</font><font color="#000080">,  </font><font color="#800000">$e54f</font><font color="#000080">,  </font><font color="#800000">$d52c</font><font color="#000080">,  </font><font color="#800000">$c50d</font><font color="#000080">,
    </font><font color="#800000">$34e2</font><font color="#000080">,  </font><font color="#800000">$24c3</font><font color="#000080">,  </font><font color="#800000">$14a0</font><font color="#000080">,  </font><font color="#800000">$0481</font><font color="#000080">,  </font><font color="#800000">$7466</font><font color="#000080">,  </font><font color="#800000">$6447</font><font color="#000080">,  </font><font color="#800000">$5424</font><font color="#000080">,  </font><font color="#800000">$4405</font><font color="#000080">,
    </font><font color="#800000">$a7db</font><font color="#000080">,  </font><font color="#800000">$b7fa</font><font color="#000080">,  </font><font color="#800000">$8799</font><font color="#000080">,  </font><font color="#800000">$97b8</font><font color="#000080">,  </font><font color="#800000">$e75f</font><font color="#000080">,  </font><font color="#800000">$f77e</font><font color="#000080">,  </font><font color="#800000">$c71d</font><font color="#000080">,  </font><font color="#800000">$d73c</font><font color="#000080">,
    </font><font color="#800000">$26d3</font><font color="#000080">,  </font><font color="#800000">$36f2</font><font color="#000080">,  </font><font color="#800000">$0691</font><font color="#000080">,  </font><font color="#800000">$16b0</font><font color="#000080">,  </font><font color="#800000">$6657</font><font color="#000080">,  </font><font color="#800000">$7676</font><font color="#000080">,  </font><font color="#800000">$4615</font><font color="#000080">,  </font><font color="#800000">$5634</font><font color="#000080">,
    </font><font color="#800000">$d94c</font><font color="#000080">,  </font><font color="#800000">$c96d</font><font color="#000080">,  </font><font color="#800000">$f90e</font><font color="#000080">,  </font><font color="#800000">$e92f</font><font color="#000080">,  </font><font color="#800000">$99c8</font><font color="#000080">,  </font><font color="#800000">$89e9</font><font color="#000080">,  </font><font color="#800000">$b98a</font><font color="#000080">,  </font><font color="#800000">$a9ab</font><font color="#000080">,
    </font><font color="#800000">$5844</font><font color="#000080">,  </font><font color="#800000">$4865</font><font color="#000080">,  </font><font color="#800000">$7806</font><font color="#000080">,  </font><font color="#800000">$6827</font><font color="#000080">,  </font><font color="#800000">$18c0</font><font color="#000080">,  </font><font color="#800000">$08e1</font><font color="#000080">,  </font><font color="#800000">$3882</font><font color="#000080">,  </font><font color="#800000">$28a3</font><font color="#000080">,
    </font><font color="#800000">$cb7d</font><font color="#000080">,  </font><font color="#800000">$db5c</font><font color="#000080">,  </font><font color="#800000">$eb3f</font><font color="#000080">,  </font><font color="#800000">$fb1e</font><font color="#000080">,  </font><font color="#800000">$8bf9</font><font color="#000080">,  </font><font color="#800000">$9bd8</font><font color="#000080">,  </font><font color="#800000">$abbb</font><font color="#000080">,  </font><font color="#800000">$bb9a</font><font color="#000080">,
    </font><font color="#800000">$4a75</font><font color="#000080">,  </font><font color="#800000">$5a54</font><font color="#000080">,  </font><font color="#800000">$6a37</font><font color="#000080">,  </font><font color="#800000">$7a16</font><font color="#000080">,  </font><font color="#800000">$0af1</font><font color="#000080">,  </font><font color="#800000">$1ad0</font><font color="#000080">,  </font><font color="#800000">$2ab3</font><font color="#000080">,  </font><font color="#800000">$3a92</font><font color="#000080">,
    </font><font color="#800000">$fd2e</font><font color="#000080">,  </font><font color="#800000">$ed0f</font><font color="#000080">,  </font><font color="#800000">$dd6c</font><font color="#000080">,  </font><font color="#800000">$cd4d</font><font color="#000080">,  </font><font color="#800000">$bdaa</font><font color="#000080">,  </font><font color="#800000">$ad8b</font><font color="#000080">,  </font><font color="#800000">$9de8</font><font color="#000080">,  </font><font color="#800000">$8dc9</font><font color="#000080">,
    </font><font color="#800000">$7c26</font><font color="#000080">,  </font><font color="#800000">$6c07</font><font color="#000080">,  </font><font color="#800000">$5c64</font><font color="#000080">,  </font><font color="#800000">$4c45</font><font color="#000080">,  </font><font color="#800000">$3ca2</font><font color="#000080">,  </font><font color="#800000">$2c83</font><font color="#000080">,  </font><font color="#800000">$1ce0</font><font color="#000080">,  </font><font color="#800000">$0cc1</font><font color="#000080">,
    </font><font color="#800000">$ef1f</font><font color="#000080">,  </font><font color="#800000">$ff3e</font><font color="#000080">,  </font><font color="#800000">$cf5d</font><font color="#000080">,  </font><font color="#800000">$df7c</font><font color="#000080">,  </font><font color="#800000">$af9b</font><font color="#000080">,  </font><font color="#800000">$bfba</font><font color="#000080">,  </font><font color="#800000">$8fd9</font><font color="#000080">,  </font><font color="#800000">$9ff8</font><font color="#000080">,
    </font><font color="#800000">$6e17</font><font color="#000080">,  </font><font color="#800000">$7e36</font><font color="#000080">,  </font><font color="#800000">$4e55</font><font color="#000080">,  </font><font color="#800000">$5e74</font><font color="#000080">,  </font><font color="#800000">$2e93</font><font color="#000080">,  </font><font color="#800000">$3eb2</font><font color="#000080">,  </font><font color="#800000">$0ed1</font><font color="#000080">,  </font><font color="#800000">$1ef0
</font><font color="#000080">);

</font><font color="#FF0000"><b>FUNCTION </b></font>UpdCrc<font color="#000080">(</font>cp<font color="#000080">: </font>BYTE<font color="#000080">; </font>crc<font color="#000080">: </font>WORD<font color="#000080">): </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ UpdCrc }
   </i></font>UpdCrc <font color="#000080">:= </font>crctab<font color="#000080">[((</font>crc <font color="#FF0000"><b>SHR </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">255</font><font color="#000080">)] </font><font color="#FF0000"><b>XOR </b></font><font color="#000080">(</font>crc <font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>XOR </b></font>cp
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>crc_32_tab<font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>LONGINT <font color="#000080">= (
</font><font color="#800000">$00000000</font><font color="#000080">, </font><font color="#800000">$77073096</font><font color="#000080">, </font><font color="#800000">$ee0e612c</font><font color="#000080">, </font><font color="#800000">$990951ba</font><font color="#000080">, </font><font color="#800000">$076dc419</font><font color="#000080">, </font><font color="#800000">$706af48f</font><font color="#000080">, </font><font color="#800000">$e963a535</font><font color="#000080">, </font><font color="#800000">$9e6495a3</font><font color="#000080">,
</font><font color="#800000">$0edb8832</font><font color="#000080">, </font><font color="#800000">$79dcb8a4</font><font color="#000080">, </font><font color="#800000">$e0d5e91e</font><font color="#000080">, </font><font color="#800000">$97d2d988</font><font color="#000080">, </font><font color="#800000">$09b64c2b</font><font color="#000080">, </font><font color="#800000">$7eb17cbd</font><font color="#000080">, </font><font color="#800000">$e7b82d07</font><font color="#000080">, </font><font color="#800000">$90bf1d91</font><font color="#000080">,
</font><font color="#800000">$1db71064</font><font color="#000080">, </font><font color="#800000">$6ab020f2</font><font color="#000080">, </font><font color="#800000">$f3b97148</font><font color="#000080">, </font><font color="#800000">$84be41de</font><font color="#000080">, </font><font color="#800000">$1adad47d</font><font color="#000080">, </font><font color="#800000">$6ddde4eb</font><font color="#000080">, </font><font color="#800000">$f4d4b551</font><font color="#000080">, </font><font color="#800000">$83d385c7</font><font color="#000080">,
</font><font color="#800000">$136c9856</font><font color="#000080">, </font><font color="#800000">$646ba8c0</font><font color="#000080">, </font><font color="#800000">$fd62f97a</font><font color="#000080">, </font><font color="#800000">$8a65c9ec</font><font color="#000080">, </font><font color="#800000">$14015c4f</font><font color="#000080">, </font><font color="#800000">$63066cd9</font><font color="#000080">, </font><font color="#800000">$fa0f3d63</font><font color="#000080">, </font><font color="#800000">$8d080df5</font><font color="#000080">,
</font><font color="#800000">$3b6e20c8</font><font color="#000080">, </font><font color="#800000">$4c69105e</font><font color="#000080">, </font><font color="#800000">$d56041e4</font><font color="#000080">, </font><font color="#800000">$a2677172</font><font color="#000080">, </font><font color="#800000">$3c03e4d1</font><font color="#000080">, </font><font color="#800000">$4b04d447</font><font color="#000080">, </font><font color="#800000">$d20d85fd</font><font color="#000080">, </font><font color="#800000">$a50ab56b</font><font color="#000080">,
</font><font color="#800000">$35b5a8fa</font><font color="#000080">, </font><font color="#800000">$42b2986c</font><font color="#000080">, </font><font color="#800000">$dbbbc9d6</font><font color="#000080">, </font><font color="#800000">$acbcf940</font><font color="#000080">, </font><font color="#800000">$32d86ce3</font><font color="#000080">, </font><font color="#800000">$45df5c75</font><font color="#000080">, </font><font color="#800000">$dcd60dcf</font><font color="#000080">, </font><font color="#800000">$abd13d59</font><font color="#000080">,
</font><font color="#800000">$26d930ac</font><font color="#000080">, </font><font color="#800000">$51de003a</font><font color="#000080">, </font><font color="#800000">$c8d75180</font><font color="#000080">, </font><font color="#800000">$bfd06116</font><font color="#000080">, </font><font color="#800000">$21b4f4b5</font><font color="#000080">, </font><font color="#800000">$56b3c423</font><font color="#000080">, </font><font color="#800000">$cfba9599</font><font color="#000080">, </font><font color="#800000">$b8bda50f</font><font color="#000080">,
</font><font color="#800000">$2802b89e</font><font color="#000080">, </font><font color="#800000">$5f058808</font><font color="#000080">, </font><font color="#800000">$c60cd9b2</font><font color="#000080">, </font><font color="#800000">$b10be924</font><font color="#000080">, </font><font color="#800000">$2f6f7c87</font><font color="#000080">, </font><font color="#800000">$58684c11</font><font color="#000080">, </font><font color="#800000">$c1611dab</font><font color="#000080">, </font><font color="#800000">$b6662d3d</font><font color="#000080">,
</font><font color="#800000">$76dc4190</font><font color="#000080">, </font><font color="#800000">$01db7106</font><font color="#000080">, </font><font color="#800000">$98d220bc</font><font color="#000080">, </font><font color="#800000">$efd5102a</font><font color="#000080">, </font><font color="#800000">$71b18589</font><font color="#000080">, </font><font color="#800000">$06b6b51f</font><font color="#000080">, </font><font color="#800000">$9fbfe4a5</font><font color="#000080">, </font><font color="#800000">$e8b8d433</font><font color="#000080">,
</font><font color="#800000">$7807c9a2</font><font color="#000080">, </font><font color="#800000">$0f00f934</font><font color="#000080">, </font><font color="#800000">$9609a88e</font><font color="#000080">, </font><font color="#800000">$e10e9818</font><font color="#000080">, </font><font color="#800000">$7f6a0dbb</font><font color="#000080">, </font><font color="#800000">$086d3d2d</font><font color="#000080">, </font><font color="#800000">$91646c97</font><font color="#000080">, </font><font color="#800000">$e6635c01</font><font color="#000080">,
</font><font color="#800000">$6b6b51f4</font><font color="#000080">, </font><font color="#800000">$1c6c6162</font><font color="#000080">, </font><font color="#800000">$856530d8</font><font color="#000080">, </font><font color="#800000">$f262004e</font><font color="#000080">, </font><font color="#800000">$6c0695ed</font><font color="#000080">, </font><font color="#800000">$1b01a57b</font><font color="#000080">, </font><font color="#800000">$8208f4c1</font><font color="#000080">, </font><font color="#800000">$f50fc457</font><font color="#000080">,
</font><font color="#800000">$65b0d9c6</font><font color="#000080">, </font><font color="#800000">$12b7e950</font><font color="#000080">, </font><font color="#800000">$8bbeb8ea</font><font color="#000080">, </font><font color="#800000">$fcb9887c</font><font color="#000080">, </font><font color="#800000">$62dd1ddf</font><font color="#000080">, </font><font color="#800000">$15da2d49</font><font color="#000080">, </font><font color="#800000">$8cd37cf3</font><font color="#000080">, </font><font color="#800000">$fbd44c65</font><font color="#000080">,
</font><font color="#800000">$4db26158</font><font color="#000080">, </font><font color="#800000">$3ab551ce</font><font color="#000080">, </font><font color="#800000">$a3bc0074</font><font color="#000080">, </font><font color="#800000">$d4bb30e2</font><font color="#000080">, </font><font color="#800000">$4adfa541</font><font color="#000080">, </font><font color="#800000">$3dd895d7</font><font color="#000080">, </font><font color="#800000">$a4d1c46d</font><font color="#000080">, </font><font color="#800000">$d3d6f4fb</font><font color="#000080">,
</font><font color="#800000">$4369e96a</font><font color="#000080">, </font><font color="#800000">$346ed9fc</font><font color="#000080">, </font><font color="#800000">$ad678846</font><font color="#000080">, </font><font color="#800000">$da60b8d0</font><font color="#000080">, </font><font color="#800000">$44042d73</font><font color="#000080">, </font><font color="#800000">$33031de5</font><font color="#000080">, </font><font color="#800000">$aa0a4c5f</font><font color="#000080">, </font><font color="#800000">$dd0d7cc9</font><font color="#000080">,
</font><font color="#800000">$5005713c</font><font color="#000080">, </font><font color="#800000">$270241aa</font><font color="#000080">, </font><font color="#800000">$be0b1010</font><font color="#000080">, </font><font color="#800000">$c90c2086</font><font color="#000080">, </font><font color="#800000">$5768b525</font><font color="#000080">, </font><font color="#800000">$206f85b3</font><font color="#000080">, </font><font color="#800000">$b966d409</font><font color="#000080">, </font><font color="#800000">$ce61e49f</font><font color="#000080">,
</font><font color="#800000">$5edef90e</font><font color="#000080">, </font><font color="#800000">$29d9c998</font><font color="#000080">, </font><font color="#800000">$b0d09822</font><font color="#000080">, </font><font color="#800000">$c7d7a8b4</font><font color="#000080">, </font><font color="#800000">$59b33d17</font><font color="#000080">, </font><font color="#800000">$2eb40d81</font><font color="#000080">, </font><font color="#800000">$b7bd5c3b</font><font color="#000080">, </font><font color="#800000">$c0ba6cad</font><font color="#000080">,
</font><font color="#800000">$edb88320</font><font color="#000080">, </font><font color="#800000">$9abfb3b6</font><font color="#000080">, </font><font color="#800000">$03b6e20c</font><font color="#000080">, </font><font color="#800000">$74b1d29a</font><font color="#000080">, </font><font color="#800000">$ead54739</font><font color="#000080">, </font><font color="#800000">$9dd277af</font><font color="#000080">, </font><font color="#800000">$04db2615</font><font color="#000080">, </font><font color="#800000">$73dc1683</font><font color="#000080">,
</font><font color="#800000">$e3630b12</font><font color="#000080">, </font><font color="#800000">$94643b84</font><font color="#000080">, </font><font color="#800000">$0d6d6a3e</font><font color="#000080">, </font><font color="#800000">$7a6a5aa8</font><font color="#000080">, </font><font color="#800000">$e40ecf0b</font><font color="#000080">, </font><font color="#800000">$9309ff9d</font><font color="#000080">, </font><font color="#800000">$0a00ae27</font><font color="#000080">, </font><font color="#800000">$7d079eb1</font><font color="#000080">,
</font><font color="#800000">$f00f9344</font><font color="#000080">, </font><font color="#800000">$8708a3d2</font><font color="#000080">, </font><font color="#800000">$1e01f268</font><font color="#000080">, </font><font color="#800000">$6906c2fe</font><font color="#000080">, </font><font color="#800000">$f762575d</font><font color="#000080">, </font><font color="#800000">$806567cb</font><font color="#000080">, </font><font color="#800000">$196c3671</font><font color="#000080">, </font><font color="#800000">$6e6b06e7</font><font color="#000080">,
</font><font color="#800000">$fed41b76</font><font color="#000080">, </font><font color="#800000">$89d32be0</font><font color="#000080">, </font><font color="#800000">$10da7a5a</font><font color="#000080">, </font><font color="#800000">$67dd4acc</font><font color="#000080">, </font><font color="#800000">$f9b9df6f</font><font color="#000080">, </font><font color="#800000">$8ebeeff9</font><font color="#000080">, </font><font color="#800000">$17b7be43</font><font color="#000080">, </font><font color="#800000">$60b08ed5</font><font color="#000080">,
</font><font color="#800000">$d6d6a3e8</font><font color="#000080">, </font><font color="#800000">$a1d1937e</font><font color="#000080">, </font><font color="#800000">$38d8c2c4</font><font color="#000080">, </font><font color="#800000">$4fdff252</font><font color="#000080">, </font><font color="#800000">$d1bb67f1</font><font color="#000080">, </font><font color="#800000">$a6bc5767</font><font color="#000080">, </font><font color="#800000">$3fb506dd</font><font color="#000080">, </font><font color="#800000">$48b2364b</font><font color="#000080">,
</font><font color="#800000">$d80d2bda</font><font color="#000080">, </font><font color="#800000">$af0a1b4c</font><font color="#000080">, </font><font color="#800000">$36034af6</font><font color="#000080">, </font><font color="#800000">$41047a60</font><font color="#000080">, </font><font color="#800000">$df60efc3</font><font color="#000080">, </font><font color="#800000">$a867df55</font><font color="#000080">, </font><font color="#800000">$316e8eef</font><font color="#000080">, </font><font color="#800000">$4669be79</font><font color="#000080">,
</font><font color="#800000">$cb61b38c</font><font color="#000080">, </font><font color="#800000">$bc66831a</font><font color="#000080">, </font><font color="#800000">$256fd2a0</font><font color="#000080">, </font><font color="#800000">$5268e236</font><font color="#000080">, </font><font color="#800000">$cc0c7795</font><font color="#000080">, </font><font color="#800000">$bb0b4703</font><font color="#000080">, </font><font color="#800000">$220216b9</font><font color="#000080">, </font><font color="#800000">$5505262f</font><font color="#000080">,
</font><font color="#800000">$c5ba3bbe</font><font color="#000080">, </font><font color="#800000">$b2bd0b28</font><font color="#000080">, </font><font color="#800000">$2bb45a92</font><font color="#000080">, </font><font color="#800000">$5cb36a04</font><font color="#000080">, </font><font color="#800000">$c2d7ffa7</font><font color="#000080">, </font><font color="#800000">$b5d0cf31</font><font color="#000080">, </font><font color="#800000">$2cd99e8b</font><font color="#000080">, </font><font color="#800000">$5bdeae1d</font><font color="#000080">,
</font><font color="#800000">$9b64c2b0</font><font color="#000080">, </font><font color="#800000">$ec63f226</font><font color="#000080">, </font><font color="#800000">$756aa39c</font><font color="#000080">, </font><font color="#800000">$026d930a</font><font color="#000080">, </font><font color="#800000">$9c0906a9</font><font color="#000080">, </font><font color="#800000">$eb0e363f</font><font color="#000080">, </font><font color="#800000">$72076785</font><font color="#000080">, </font><font color="#800000">$05005713</font><font color="#000080">,
</font><font color="#800000">$95bf4a82</font><font color="#000080">, </font><font color="#800000">$e2b87a14</font><font color="#000080">, </font><font color="#800000">$7bb12bae</font><font color="#000080">, </font><font color="#800000">$0cb61b38</font><font color="#000080">, </font><font color="#800000">$92d28e9b</font><font color="#000080">, </font><font color="#800000">$e5d5be0d</font><font color="#000080">, </font><font color="#800000">$7cdcefb7</font><font color="#000080">, </font><font color="#800000">$0bdbdf21</font><font color="#000080">,
</font><font color="#800000">$86d3d2d4</font><font color="#000080">, </font><font color="#800000">$f1d4e242</font><font color="#000080">, </font><font color="#800000">$68ddb3f8</font><font color="#000080">, </font><font color="#800000">$1fda836e</font><font color="#000080">, </font><font color="#800000">$81be16cd</font><font color="#000080">, </font><font color="#800000">$f6b9265b</font><font color="#000080">, </font><font color="#800000">$6fb077e1</font><font color="#000080">, </font><font color="#800000">$18b74777</font><font color="#000080">,
</font><font color="#800000">$88085ae6</font><font color="#000080">, </font><font color="#800000">$ff0f6a70</font><font color="#000080">, </font><font color="#800000">$66063bca</font><font color="#000080">, </font><font color="#800000">$11010b5c</font><font color="#000080">, </font><font color="#800000">$8f659eff</font><font color="#000080">, </font><font color="#800000">$f862ae69</font><font color="#000080">, </font><font color="#800000">$616bffd3</font><font color="#000080">, </font><font color="#800000">$166ccf45</font><font color="#000080">,
</font><font color="#800000">$a00ae278</font><font color="#000080">, </font><font color="#800000">$d70dd2ee</font><font color="#000080">, </font><font color="#800000">$4e048354</font><font color="#000080">, </font><font color="#800000">$3903b3c2</font><font color="#000080">, </font><font color="#800000">$a7672661</font><font color="#000080">, </font><font color="#800000">$d06016f7</font><font color="#000080">, </font><font color="#800000">$4969474d</font><font color="#000080">, </font><font color="#800000">$3e6e77db</font><font color="#000080">,
</font><font color="#800000">$aed16a4a</font><font color="#000080">, </font><font color="#800000">$d9d65adc</font><font color="#000080">, </font><font color="#800000">$40df0b66</font><font color="#000080">, </font><font color="#800000">$37d83bf0</font><font color="#000080">, </font><font color="#800000">$a9bcae53</font><font color="#000080">, </font><font color="#800000">$debb9ec5</font><font color="#000080">, </font><font color="#800000">$47b2cf7f</font><font color="#000080">, </font><font color="#800000">$30b5ffe9</font><font color="#000080">,
</font><font color="#800000">$bdbdf21c</font><font color="#000080">, </font><font color="#800000">$cabac28a</font><font color="#000080">, </font><font color="#800000">$53b39330</font><font color="#000080">, </font><font color="#800000">$24b4a3a6</font><font color="#000080">, </font><font color="#800000">$bad03605</font><font color="#000080">, </font><font color="#800000">$cdd70693</font><font color="#000080">, </font><font color="#800000">$54de5729</font><font color="#000080">, </font><font color="#800000">$23d967bf</font><font color="#000080">,
</font><font color="#800000">$b3667a2e</font><font color="#000080">, </font><font color="#800000">$c4614ab8</font><font color="#000080">, </font><font color="#800000">$5d681b02</font><font color="#000080">, </font><font color="#800000">$2a6f2b94</font><font color="#000080">, </font><font color="#800000">$b40bbe37</font><font color="#000080">, </font><font color="#800000">$c30c8ea1</font><font color="#000080">, </font><font color="#800000">$5a05df1b</font><font color="#000080">, </font><font color="#800000">$2d02ef8d
</font><font color="#000080">);

</font><font color="#FF0000"><b>FUNCTION </b></font>UpdC32<font color="#000080">(</font>octet<font color="#000080">: </font>BYTE<font color="#000080">; </font>crc<font color="#000080">: </font>LONGINT<font color="#000080">) : </font>LONGINT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{ UpdC32 }
   </i></font>UpdC32 <font color="#000080">:= </font>crc_32_tab<font color="#000080">[</font>BYTE<font color="#000080">(</font>crc <font color="#FF0000"><b>XOR </b></font>LONGINT<font color="#000080">(</font>octet<font color="#000080">))] </font><font color="#FF0000"><b>XOR </b></font><font color="#000080">((</font>crc <font color="#FF0000"><b>SHR </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$00FFFFFF</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LongHash <font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>r<font color="#000080">: </font>pwtype<font color="#000080">);
  </font><font color="#008000"><i>{ return modified 3-byte checksum }
</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do </b></font>r<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
  </font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
    </b></font>r<font color="#000080">[</font>j<font color="#000080">]:=</font>r<font color="#000080">[</font>j<font color="#000080">]+</font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>r<font color="#000080">[</font>j<font color="#000080">] </font><font color="#FF0000"><b>mod </b></font><font color="#800000">2</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
      </b></font>j<font color="#000080">:=</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>j<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>j<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>numtowords<font color="#000080">(</font>n<font color="#000080">:</font>word<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>const </b></font>Eng<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">] = (</font><font color="#800000">'Zero '</font><font color="#000080">,</font><font color="#800000">'One '</font><font color="#000080">,</font><font color="#800000">'Two '</font><font color="#000080">,</font><font color="#800000">'Three '</font><font color="#000080">,
                                        </font><font color="#800000">'Four '</font><font color="#000080">,</font><font color="#800000">'Five '</font><font color="#000080">,</font><font color="#800000">'Six '</font><font color="#000080">,</font><font color="#800000">'Seven '</font><font color="#000080">,
                                        </font><font color="#800000">'Eight '</font><font color="#000080">,</font><font color="#800000">'Nine '</font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>ts<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
     </font>ns<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
     </font>i <font color="#000080">:</font>byte<font color="#000080">;
     </font>cn<font color="#000080">:</font>byte<font color="#000080">;
     </font>c <font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>str<font color="#000080">(</font>n<font color="#000080">,</font>ns<font color="#000080">);
 </font>ts<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;

 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>ns<font color="#000080">) </font><font color="#FF0000"><b>do
   begin
   </b></font>val<font color="#000080">(</font>ns<font color="#000080">[</font>i<font color="#000080">],</font>cn<font color="#000080">,</font>c<font color="#000080">);
   </font>ts<font color="#000080">:=</font>ts<font color="#000080">+</font>eng<font color="#000080">[</font>cn<font color="#000080">];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>numtowords<font color="#000080">:=</font>rtrim<font color="#000080">(</font>ts<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>ShortPath<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>t<font color="#000080">,</font>u<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>function </b></font>lastslash<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>u<font color="#000080">:=</font>s<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font>length<font color="#000080">(</font>u<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
   begin
   if </b></font>u<font color="#000080">[</font>a<font color="#000080">]=</font><font color="#800000">'\' </font><font color="#FF0000"><b>then begin </b></font>lastslash<font color="#000080">:=</font>a<font color="#000080">; </font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 if </b></font>length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">30 </font><font color="#FF0000"><b>then
  begin
  </b></font>a<font color="#000080">:=</font>lastslash<font color="#000080">;
  </font>t<font color="#000080">:=</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">,</font>s<font color="#000080">))+</font><font color="#800000">'&ugrave;&ugrave;&ugrave;'</font><font color="#000080">+</font>copy<font color="#000080">(</font>s<font color="#000080">,</font>a<font color="#000080">,</font>length<font color="#000080">(</font>s<font color="#000080">));
  </font>shortpath<font color="#000080">:=</font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end
 else </b></font>shortpath<font color="#000080">:=</font>s<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>SplitFilePath<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var
     </b></font>D<font color="#000080">: </font>DirStr<font color="#000080">;
     </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
     </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>fsplit<font color="#000080">(</font>s<font color="#000080">,</font>d<font color="#000080">,</font>n<font color="#000080">,</font>e<font color="#000080">);
</font>splitfilepath<font color="#000080">:=</font>d<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>splitFileExt <font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var
     </b></font>D<font color="#000080">: </font>DirStr<font color="#000080">;
     </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
     </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;</font><font color="#FF0000"><b>begin
</b></font>fsplit<font color="#000080">(</font>s<font color="#000080">,</font>d<font color="#000080">,</font>n<font color="#000080">,</font>e<font color="#000080">);
</font>splitfileext<font color="#000080">:=</font>e<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>splitFileName<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var
     </b></font>D<font color="#000080">: </font>DirStr<font color="#000080">;
     </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
     </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;</font><font color="#FF0000"><b>begin
</b></font>fsplit<font color="#000080">(</font>s<font color="#000080">,</font>d<font color="#000080">,</font>n<font color="#000080">,</font>e<font color="#000080">);
</font>splitfilename<font color="#000080">:=</font>n<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>KillFileSpec<font color="#000080">(</font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">;
     </font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>FindFirst<font color="#000080">(</font>p<font color="#000080">,</font>anyfile <font color="#FF0000"><b>XOR </b></font>directory<font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
  </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>splitfilepath<font color="#000080">(</font>p<font color="#000080">)+</font>s<font color="#000080">.</font>name<font color="#000080">);
  </font>erase<font color="#000080">(</font>f<font color="#000080">);
  </font>FindNext<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>killallindir<font color="#000080">(</font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">;
     </font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>FindFirst<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>anyfile <font color="#FF0000"><b>XOR </b></font>directory<font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
  </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>p<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">);
  </font>erase<font color="#000080">(</font>f<font color="#000080">);
  </font>FindNext<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>PruneDir<font color="#000080">(</font>p<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);

 </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 if </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>char<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font>char<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>delete<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
 </font>killallindir<font color="#000080">(</font>p<font color="#000080">);

 </font>FindFirst<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>directory<font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
  if not </b></font><font color="#000080">((</font>s<font color="#000080">.</font>name<font color="#000080">=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>s<font color="#000080">.</font>name<font color="#000080">=</font><font color="#800000">'..'</font><font color="#000080">)) </font><font color="#FF0000"><b>then
    begin
    </b></font>killallindir<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">);

    </font>prunedir<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">);

    </font><font color="#008000"><i>{$I-}
    </i></font>rmdir<font color="#000080">(</font>fexpand<font color="#000080">(</font>p<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">));
    </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FindNext<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#008000"><i>{$I-}
 </i></font>rmdir<font color="#000080">(</font>p<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>nowsecondssincemidnight<font color="#000080">: </font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>curtime<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
 </font>nowsecondssincemidnight<font color="#000080">:=</font>secondssincemidnight<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>nowmins<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>curtime<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
 </font>nowmins<font color="#000080">:=</font>h<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">+</font>m<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(*
function LineWrapInput(var s:string):boolean;
  var t:char;
      i:byte;

  begin
  s:='';
  repeat until keypressed;
  t:=readkey;
  case t of
    {KEY} #32..#126:
    { BS} #8: if ord(s[0])&gt;0 then
                begin
                s[0]:=chr(ord(s[0])-1);
                case ansi of
                  true : begin
                         gotoxy(wherex-1),wherey);
                         write(' ');
                         gotoxy(wherex-1,wherey);
                         end;
                  false: begin
                         pr(#8+' '+#8);
                         end;
                  end;
                end;
    end;
  end;
*)

</i></font><font color="#FF0000"><b>function </b></font>DtTmStamp<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">,</font>d<font color="#000080">,</font>y<font color="#000080">,</font>dw<font color="#000080">: </font>word<font color="#000080">;
     </font>sm<font color="#000080">,</font>sd<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
     </font>sy<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];

     </font>ts<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
     </font>i<font color="#000080">:</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>dw<font color="#000080">);

 </font>str<font color="#000080">(</font>m<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>sm<font color="#000080">);
 </font>str<font color="#000080">(</font>d<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>sd<font color="#000080">);
 </font>str<font color="#000080">(</font>y<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>sy<font color="#000080">);

 </font>sy<font color="#000080">:=</font>copy<font color="#000080">(</font>sy<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);

 </font>ts<font color="#000080">:=</font>concat<font color="#000080">(</font>sy<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font>sm<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font>sd<font color="#000080">);

 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>ts<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do if </b></font>ts<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>ts<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;

 </font>ts<font color="#000080">:=</font>ts<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>curtimestr<font color="#000080">;

 </font>DtTmStamp<font color="#000080">:=</font>ts<font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>(*
Function Carrier_On:boolean;          {TRUE if carrier present}
     var a:word;
     begin

     case PortNum of
       1: A := $3F8;
       2: A := $2F8;
       3: A := $3E8;
       4: A := $2E8;
       end;

     Carrier_On:=odd ( Port[ A + $06 ] shr 7 )

     end;
*)

</i></font><font color="#FF0000"><b>function </b></font>ToStr<font color="#000080">(</font>s<font color="#000080">: </font>longint<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>str<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">);
  </font>ToStr<font color="#000080">:=</font>A<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ToStr2<font color="#000080">(</font>s<font color="#000080">: </font>longint<font color="#000080">;</font>b<font color="#000080">:</font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>str<font color="#000080">(</font>S<font color="#000080">:</font>b<font color="#000080">,</font>A<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
  </font>ToStr2<font color="#000080">:=</font>A<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ToInt<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font>word<font color="#000080">;
      </font>c<font color="#000080">:</font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>begin
  </b></font>val<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">,</font>c<font color="#000080">);
  </font>ToInt<font color="#000080">:=</font>a<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Tolong<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>longint<font color="#000080">;
      </font>c<font color="#000080">:</font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>begin
  </b></font>val<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">,</font>c<font color="#000080">);
  </font>Tolong<font color="#000080">:=</font>a<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>function </b></font>ToStrb<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>str<font color="#000080">(</font>S<font color="#000080">,</font>A<font color="#000080">);
  </font>ToStrb<font color="#000080">:=</font>A<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SecondsSinceMidnight<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">:</font>word<font color="#000080">):</font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>SecondsSinceMidnight <font color="#000080">:= (</font>longint<font color="#000080">(</font>h<font color="#000080">)*</font><font color="#800000">3600</font><font color="#000080">)+(</font>longint<font color="#000080">(</font>m<font color="#000080">)*</font><font color="#800000">60</font><font color="#000080">)+</font>longint<font color="#000080">(</font>s<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CurTimeStr<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Var </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">:</font>word<font color="#000080">;
     </font>HourS<font color="#000080">,</font>MinS<font color="#000080">,</font>SecS<font color="#000080">,</font>Sec100s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
     </font>i<font color="#000080">:</font>byte<font color="#000080">;
     </font>t<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);

 </font>Str<font color="#000080">(</font>Hour<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>HourS<font color="#000080">);
 </font>Str<font color="#000080">(</font>Min<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>MinS<font color="#000080">);
 </font>Str<font color="#000080">(</font>Sec<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>Secs<font color="#000080">);

 </font>t<font color="#000080">:=</font>concat<font color="#000080">(</font>HourS<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>MinS<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">,</font>SecS<font color="#000080">);
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>t<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do
  if </b></font>t<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>t<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
 </font>CurTimeStr<font color="#000080">:=</font>t<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CurTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>h<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>word<font color="#000080">);
 </font><font color="#FF0000"><b>Var </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
 </font>h<font color="#000080">:=</font>hour<font color="#000080">;
 </font>m<font color="#000080">:=</font>min<font color="#000080">;
 </font>s<font color="#000080">:=</font>sec<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ltrim<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
  if </b></font>s<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then begin </b></font>ltrim<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">; </font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    begin
    if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">;
  </font>ltrim<font color="#000080">:=</font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOff<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>regs<font color="#000080">:</font>registers<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  </b></font>Regs<font color="#000080">.</font>Ax <font color="#000080">:= </font><font color="#800000">$0100</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>Cx <font color="#000080">:= </font><font color="#800000">$2807</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CursorOn<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>regs<font color="#000080">:</font>registers<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  </b></font>Regs<font color="#000080">.</font>Ax <font color="#000080">:= </font><font color="#800000">$0100</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>Then
    </b></font>Regs<font color="#000080">.</font>Cx <font color="#000080">:= </font><font color="#800000">$090A
  </font><font color="#FF0000"><b>Else
    </b></font>Regs<font color="#000080">.</font>Cx <font color="#000080">:= </font><font color="#800000">$0607</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>beep<font color="#000080">(</font>hz<font color="#000080">,</font>ms<font color="#000080">:</font>word<font color="#000080">);
 </font><font color="#FF0000"><b>begin
 </b></font>sound<font color="#000080">(</font>hz<font color="#000080">);
 </font>delay<font color="#000080">(</font>ms<font color="#000080">);
 </font>nosound<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>rtrim<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font>byte<font color="#000080">;</font>d<font color="#000080">:</font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  if </b></font>s<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then begin </b></font>rtrim<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">; </font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>d<font color="#000080">:=</font>false<font color="#000080">;
  </font>a<font color="#000080">:= </font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font><font color="#FF0000"><b>repeat
   if </b></font>s<font color="#000080">[</font>a<font color="#000080">]=</font><font color="#800000">#32 </font><font color="#FF0000"><b>then
    begin
    </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])-</font><font color="#800000">1</font><font color="#000080">);
    </font>dec<font color="#000080">(</font>a<font color="#000080">);
    </font><font color="#FF0000"><b>end
  else </b></font>d<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>d<font color="#000080">;
  </font>rtrim<font color="#000080">:=</font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Procedure CursorOff;
Begin
  Inline($50/$51/$B4/$01/$B5/$FF/$B1/$0C/$CD/$10/$59/$58);
End;



Procedure CursorOn;
Begin
  Inline($50/$51/$B4/$01/$B5/$0C/$B1/$0D/$CD/$10/$59/$58);
End;
}

</i></font><font color="#FF0000"><b>function </b></font>compare<font color="#000080">(</font>s1<font color="#000080">,</font>s2<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>s1<font color="#000080">:=</font>upcasestr<font color="#000080">(</font>s1<font color="#000080">);
 </font>s2<font color="#000080">:=</font>upcasestr<font color="#000080">(</font>s2<font color="#000080">);

 </font><font color="#FF0000"><b>if </b></font>s1 <font color="#000080">= </font>s2 <font color="#FF0000"><b>then </b></font>compare<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>s1 <font color="#000080">&lt; </font>s2 <font color="#FF0000"><b>then </b></font>compare<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font>s1 <font color="#000080">&gt; </font>s2 <font color="#FF0000"><b>then </b></font>compare<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;

 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ExistFile<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>flags<font color="#000080">:</font>word<font color="#000080">):</font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>re<font color="#000080">:</font>searchrec<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>FindFirst<font color="#000080">(</font>s<font color="#000080">,</font>flags<font color="#000080">,</font>re<font color="#000080">);
  </font>ExistFile <font color="#000080">:= </font><font color="#FF0000"><b>not</b></font><font color="#000080">((</font>DosError<font color="#000080">=</font><font color="#800000">18</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DosError<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DosError<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>UpcaseStr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>a<font color="#000080">] := </font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>a<font color="#000080">]);
  </font>UpCaseStr <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LowcaseStr<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do </b></font>s<font color="#000080">[</font>a<font color="#000080">] := </font>lowcase<font color="#000080">(</font>s<font color="#000080">[</font>a<font color="#000080">]);
  </font>lowCaseStr <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LTab<font color="#000080">(</font>n<font color="#000080">: </font>integer<font color="#000080">;</font>m<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>b<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>a <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>b <font color="#000080">:= </font>n<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do </b></font>a<font color="#000080">:=</font>a<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
  </font>Ltab <font color="#000080">:= </font>a<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>Ltabc<font color="#000080">(</font>n<font color="#000080">,</font>m<font color="#000080">:</font>integer<font color="#000080">;</font>c<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>b<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>a <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>b <font color="#000080">:= </font>n<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do </b></font>a<font color="#000080">:=</font>a<font color="#000080">+</font>c<font color="#000080">;
  </font>Ltabc <font color="#000080">:= </font>a<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>Key<font color="#000080">:</font>char<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   </b></font>Key <font color="#000080">:= </font>ReadKey<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ClearScreen<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   if </b></font>ANSI <font color="#FF0000"><b>then </b></font>ClrScr<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>CaseStr<font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>byte<font color="#000080">;

   </font><font color="#FF0000"><b>begin
   </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>upcase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do
       begin
       case </b></font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>of

        </b></font><font color="#800000">32</font><font color="#000080">..</font><font color="#800000">46</font><font color="#000080">,</font><font color="#800000">58</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">91</font><font color="#000080">..</font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">132</font><font color="#000080">..</font><font color="#800000">126
          </font><font color="#000080">:  </font>s<font color="#000080">[</font>i<font color="#000080">] := </font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
        </font><font color="#FF0000"><b>else </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>lowcase<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>CaseStr <font color="#000080">:= </font>s<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>lowcase<font color="#000080">(</font>ch<font color="#000080">: </font>char<font color="#000080">): </font>char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>ch <font color="#000080">:= </font>upcase<font color="#000080">(</font>Ch<font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>ord<font color="#000080">(</font>ch<font color="#000080">) </font><font color="#FF0000"><b>of
  </b></font><font color="#800000">65</font><font color="#000080">..</font><font color="#800000">90</font><font color="#000080">: </font>Lowcase <font color="#000080">:= </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>ch<font color="#000080">)+</font><font color="#800000">32</font><font color="#000080">);
  </font><font color="#FF0000"><b>else </b></font>Lowcase <font color="#000080">:= </font>Ch<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>PR<font color="#000080">(</font>t<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
   </font><font color="#FF0000"><b>begin
   if </b></font>ANSI <font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>t<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Write<font color="#000080">(</font>output<font color="#000080">, </font>t<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Newline<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   if </b></font>ANSI <font color="#FF0000"><b>then </b></font>writeln <font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font>output<font color="#000080">, </font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#10</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ColorFG<font color="#000080">(</font>c<font color="#000080">: </font>byte<font color="#000080">);
    </font><font color="#FF0000"><b>begin
    if </b></font>ANSI <font color="#FF0000"><b>then </b></font>textcolor<font color="#000080">(</font>c<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ColorBG<font color="#000080">(</font>c<font color="#000080">: </font>byte<font color="#000080">);
    </font><font color="#FF0000"><b>begin
    if </b></font>ANSI <font color="#FF0000"><b>then </b></font>textbackground<font color="#000080">(</font>c<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>PhoneEditor<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>answerformain<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>prestring<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">:</font>byte<font color="#000080">);
    </font><font color="#FF0000"><b>var
 </b></font>tempkey      <font color="#000080">: </font>char<font color="#000080">;
 </font>stringtempkey<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>baseX       <font color="#000080">: </font>byte<font color="#000080">;
  </font>answer      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
  </font>done        <font color="#000080">: </font>boolean<font color="#000080">;
  </font>i           <font color="#000080">: </font>byte<font color="#000080">;
    </font><font color="#FF0000"><b>begin
    </b></font>done <font color="#000080">:= </font>false<font color="#000080">;
    </font>baseX <font color="#000080">:= </font>whereX<font color="#000080">;
    </font>answer <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#008000"><i>{
    if length(prestring) &lt;&gt; 0 then
      begin
      answer := prestring;
      for i:=1 to (10 - length(prestring)) do answer := answer + #32;
      ord(answer[0]) := length(prestring);
      end;
    }
    </i></font>colorFG<font color="#000080">(</font>fgc<font color="#000080">);
    </font>colorBG<font color="#000080">(</font>bgc<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then begin </b></font>PR<font color="#000080">(</font><font color="#800000">' (   )    -     '</font><font color="#000080">); </font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>wherey<font color="#000080">); </font><font color="#FF0000"><b>end
    else </b></font>PR<font color="#000080">(</font><font color="#800000">' ('</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat
    </b></font>tempkey <font color="#000080">:= </font>readkey<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>tempkey <font color="#FF0000"><b>of
       </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">:</font><font color="#FF0000"><b>if </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
                 begin
                   </b></font>answer <font color="#000080">:= </font>answer <font color="#000080">+ </font>tempkey<font color="#000080">;
                   </font><font color="#FF0000"><b>case </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>of
                     </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">:</font>PR<font color="#000080">(</font>tempkey<font color="#000080">);
                     </font><font color="#800000">3</font><font color="#000080">:
                       </font><font color="#FF0000"><b>begin
                       if </b></font>ANSI <font color="#FF0000"><b>then begin </b></font>pr<font color="#000080">(</font>tempkey<font color="#000080">);</font>gotoXY<font color="#000080">(</font>basex<font color="#000080">+</font><font color="#800000">7</font><font color="#000080">, </font>whereY<font color="#000080">) </font><font color="#FF0000"><b>end
                       else </b></font>PR<font color="#000080">(</font>tempkey<font color="#000080">+</font><font color="#800000">') '</font><font color="#000080">);
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                     </font><font color="#800000">6</font><font color="#000080">:
                       </font><font color="#FF0000"><b>begin
                       if </b></font>ANSI <font color="#FF0000"><b>then begin </b></font>pr<font color="#000080">(</font>tempkey<font color="#000080">);</font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font><font color="#800000">11</font><font color="#000080">, </font>wherey<font color="#000080">) </font><font color="#FF0000"><b>end
                       else </b></font>PR<font color="#000080">(</font>tempkey<font color="#000080">+</font><font color="#800000">'-'</font><font color="#000080">);
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font><font color="#800000">#8</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          begin
          </b></font>delete<font color="#000080">(</font>answer<font color="#000080">,</font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]),</font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#008000"><i>{dec(ord(answer[0]));}
          {answer := copy(answer, 1, ord(answer[0]));}
          </i></font><font color="#FF0000"><b>case </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>of
               </b></font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then begin
                                               </b></font>gotoXY<font color="#000080">(</font>whereX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                                               </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                                               </font>gotoXY<font color="#000080">(</font>whereX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                                               </font><font color="#FF0000"><b>end
                                  else
                                               begin
                                               </b></font>PR<font color="#000080">(</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#32</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">);
                                               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#800000">2</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then
                      begin
                      </b></font>gotoXY<font color="#000080">(</font>wherex<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">, </font>whereY<font color="#000080">);
                      </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                      </font>gotoXY<font color="#000080">(</font>wherex<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                      </font><font color="#FF0000"><b>end
                   else
                       begin
                       </b></font>PR<font color="#000080">(</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#32</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">);
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#800000">5</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then
                      begin
                      </b></font>gotoXY<font color="#000080">(</font>whereX<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">, </font>wherey<font color="#000080">);
                      </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
                      </font>gotoXY<font color="#000080">(</font>wherex<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                      </font><font color="#FF0000"><b>end
                  else
                      begin
                      </b></font>PR<font color="#000080">(</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">#32</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#800000">#13</font><font color="#000080">:</font>done <font color="#000080">:= </font>true<font color="#000080">;

       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;
    </font>colorBG<font color="#000080">(</font>black<font color="#000080">);
    </font>answerformain <font color="#000080">:= </font>answer<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Editor<font color="#000080">(</font>maxlen<font color="#000080">: </font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>answerformain<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>prestring<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#FF0000"><b>var
       </b></font>tempkey <font color="#000080">: </font>char<font color="#000080">;
       </font>done    <font color="#000080">: </font>boolean<font color="#000080">;
       </font>index   <font color="#000080">: </font>byte<font color="#000080">;
       </font>answer  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
       </font>baseX   <font color="#000080">: </font>byte<font color="#000080">;
       </font>i       <font color="#000080">: </font>byte<font color="#000080">;
     </font>insertmode<font color="#000080">: </font>boolean<font color="#000080">;
  </font>stringtempkey<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];

   </font><font color="#FF0000"><b>begin
   </b></font>baseX <font color="#000080">:= </font>whereX<font color="#000080">;
   </font>done <font color="#000080">:= </font>false<font color="#000080">;

   </font>insertmode<font color="#000080">:=</font>useinsert<font color="#000080">;
   </font><font color="#FF0000"><b>if not</b></font><font color="#000080">(</font>ansi<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>useinsert<font color="#000080">:=</font>false<font color="#000080">;

   </font>index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>answer <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>prestring<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
      </b></font>answer <font color="#000080">:= </font>prestring<font color="#000080">;
      </font>index <font color="#000080">:= </font>length<font color="#000080">(</font>prestring<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ANSI <font color="#FF0000"><b>and </b></font>insertmode<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
     </b></font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font>maxlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>whereY<font color="#000080">);
     </font>ColorFG<font color="#000080">(</font>lightred<font color="#000080">);</font>ColorBG<font color="#000080">(</font>black<font color="#000080">);
     </font>PR<font color="#000080">(</font><font color="#800000">'i'</font><font color="#000080">);
     </font>gotoxy<font color="#000080">(</font>basex<font color="#000080">, </font>wherey<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>ColorFG<font color="#000080">(</font>fgc<font color="#000080">);
   </font>ColorBG<font color="#000080">(</font>bgc<font color="#000080">);


   </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font>Prestring<font color="#000080">);

   </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then
     begin
     for </b></font>i<font color="#000080">:=</font>length<font color="#000080">(</font>prestring<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxlen<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
     </font>gotoXY<font color="#000080">(</font>basex<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">+</font>index<font color="#000080">,</font>wherey<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ functions ... backspace, right, left, overwrite mode for L, R }
   {               enter, delete                                   }

   </i></font><font color="#FF0000"><b>repeat
      repeat
       If </b></font>portcheck <font color="#FF0000"><b>then if not </b></font>carrierfunc <font color="#FF0000"><b>then
         begin
         </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;

      </font>tempkey <font color="#000080">:= </font>readkey<font color="#000080">;
      </font><font color="#FF0000"><b>case </b></font>tempkey <font color="#FF0000"><b>of
        </b></font><font color="#800000">#32</font><font color="#000080">,

             </font><font color="#008000"><i>{'A'..'Z', 'a'..'z','0'..'9', ',' , '.':}

             </i></font><font color="#800000">' '</font><font color="#000080">..</font><font color="#800000">'~'</font><font color="#000080">:

             </font><font color="#FF0000"><b>begin
              if </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &lt; </font>maxlen <font color="#FF0000"><b>then
               begin
               </b></font>inc<font color="#000080">(</font>index<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font>index <font color="#000080">&lt;= </font>maxlen <font color="#FF0000"><b>then
               begin
               if </b></font>CapsOn <font color="#FF0000"><b>then
   </b></font><font color="#008000"><i>{for upcase} </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>answer<font color="#000080">[</font>index<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Answer<font color="#000080">[</font>index<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then
   </b></font><font color="#008000"><i>{checking}     </i></font><font color="#FF0000"><b>begin
                  </b></font>tempkey <font color="#000080">:= </font>upcase<font color="#000080">(</font>tempkey<font color="#000080">);
                  </font><font color="#FF0000"><b>end
                else </b></font>tempkey <font color="#000080">:= </font>lowcase<font color="#000080">(</font>tempkey<font color="#000080">);

               </font><font color="#FF0000"><b>if </b></font>insertmode <font color="#FF0000"><b>and </b></font>ansi <font color="#FF0000"><b>then
                  begin
                  if </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &lt; </font>maxlen <font color="#FF0000"><b>then
                    begin
                    </b></font>stringtempkey <font color="#000080">:= </font>tempkey<font color="#000080">;
                    </font>insert<font color="#000080">(</font>stringtempkey<font color="#000080">, </font>answer<font color="#000080">, </font>index<font color="#000080">);
                    </font><font color="#FF0000"><b>if </b></font>CapsOn <font color="#FF0000"><b>then </b></font>Answer <font color="#000080">:= </font>CaseStr<font color="#000080">(</font>Answer<font color="#000080">);
                    </font><font color="#FF0000"><b>if </b></font>index <font color="#000080">&lt;&gt; </font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                     begin
                     </b></font>gotoxy<font color="#000080">(</font>baseX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                     </font>PR<font color="#000080">(</font>answer<font color="#000080">);
                     </font>gotoxy<font color="#000080">(</font>baseX<font color="#000080">+</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                     </font><font color="#FF0000"><b>end
                    else </b></font>pr<font color="#000080">(</font>tempkey<font color="#000080">);
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end
               else
                  begin
                  if </b></font>index <font color="#000080">&lt; </font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>answer<font color="#000080">[</font>index<font color="#000080">] := </font>tempkey
                  <font color="#FF0000"><b>else </b></font>answer <font color="#000080">:= </font>answer <font color="#000080">+ </font>tempkey<font color="#000080">;
                  </font>PR<font color="#000080">(</font>tempkey<font color="#000080">)
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">#13</font><font color="#000080">:
             </font><font color="#FF0000"><b>begin
             </b></font>done <font color="#000080">:= </font>true<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">#8</font><font color="#000080">:
             </font><font color="#FF0000"><b>begin

             if </b></font><font color="#000080">(</font>index <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">)  </font><font color="#FF0000"><b>then
              begin
              </b></font>dec<font color="#000080">(</font>index<font color="#000080">);
              </font>delete<font color="#000080">(</font>answer<font color="#000080">, </font>Index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then
                  begin

                  </b></font>gotoXY<font color="#000080">(</font>BaseX<font color="#000080">+</font>Index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                  </font>PR<font color="#000080">(</font>copy<font color="#000080">(</font>answer<font color="#000080">, </font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])-</font>index<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">);
                  </font>gotoXY<font color="#000080">(</font>BaseX<font color="#000080">+</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);

                   </font><font color="#FF0000"><b>end
              else </b></font>PR<font color="#000080">(</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">#0</font><font color="#000080">:                         </font><font color="#008000"><i>{ test for extended characters }
             </i></font><font color="#FF0000"><b>begin
             case </b></font>readkey <font color="#FF0000"><b>of        </b></font><font color="#008000"><i>{ poll for extended part }
               </i></font><font color="#800000">#75</font><font color="#000080">:                 </font><font color="#008000"><i>{ left arrow }
                   </i></font><font color="#FF0000"><b>begin
                   if </b></font>ANSI <font color="#FF0000"><b>then
                    begin
                    if </b></font>index <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                     begin
                     </b></font>dec<font color="#000080">(</font>index<font color="#000080">);
                     </font>gotoxy<font color="#000080">(</font>whereX<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#800000">#77</font><font color="#000080">:                 </font><font color="#008000"><i>{ right arrow }
                  </i></font><font color="#FF0000"><b>begin
                  if </b></font>ANSI <font color="#FF0000"><b>then
                   begin
                   if </b></font>index <font color="#000080">&lt; </font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                     begin
                     </b></font>inc<font color="#000080">(</font>index<font color="#000080">);
                     </font>gotoxy<font color="#000080">(</font>whereX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#800000">#71</font><font color="#000080">:                 </font><font color="#008000"><i>{ home }
                  </i></font><font color="#FF0000"><b>begin
                  if </b></font>ANSI <font color="#FF0000"><b>then
                     begin
                     </b></font>index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                     </font>gotoxy<font color="#000080">(</font>baseX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#800000">#79</font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>ANSI <font color="#FF0000"><b>then
                  begin
                  </b></font>index <font color="#000080">:= </font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                  </font>gotoXY<font color="#000080">(</font>BaseX<font color="#000080">+</font>Ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);

                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#800000">#82</font><font color="#000080">:      </font><font color="#008000"><i>{ ins }
                </i></font><font color="#FF0000"><b>if </b></font>useinsert <font color="#FF0000"><b>then
                  begin
                  </b></font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font>maxlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>whereY<font color="#000080">);
                  </font>ColorFG<font color="#000080">(</font>lightred<font color="#000080">);</font>ColorBG<font color="#000080">(</font>black<font color="#000080">);
                  </font><font color="#FF0000"><b>if </b></font>insertmode <font color="#FF0000"><b>then begin </b></font>insertmode <font color="#000080">:= </font>false<font color="#000080">; </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>end
                  else begin </b></font>insertmode <font color="#000080">:= </font>true<font color="#000080">; </font>PR<font color="#000080">(</font><font color="#800000">'i'</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font>GotoXY<font color="#000080">(</font>BaseX<font color="#000080">+</font>Index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                  </font>ColorFG<font color="#000080">(</font>white<font color="#000080">);</font>ColorBG<font color="#000080">(</font>blue<font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#800000">#83</font><font color="#000080">:         </font><font color="#008000"><i>{ del }
                  </i></font><font color="#FF0000"><b>begin
                  if </b></font>ANSI <font color="#FF0000"><b>then
                    begin
                    </b></font>delete<font color="#000080">(</font>answer<font color="#000080">,</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                    </font><font color="#FF0000"><b>If </b></font>CapsOn <font color="#FF0000"><b>then </b></font>Answer <font color="#000080">:= </font>CaseStr<font color="#000080">(</font>Answer<font color="#000080">);
                    </font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>whereY<font color="#000080">);
                    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>answer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do </b></font>PR<font color="#000080">(</font>Answer<font color="#000080">[</font>i<font color="#000080">]);
                    </font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);

                    </font>gotoxy<font color="#000080">(</font>baseX<font color="#000080">+</font>index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>wherey<font color="#000080">);
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                           </font><font color="#008000"><i>{ end of 'case readkey of' }
             </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                             </font><font color="#008000"><i>{ end of '#0: begin' }
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                  </font><font color="#008000"><i>{ end of 'case tempkey of' }
   </i></font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;

   </font><font color="#008000"><i>{answer[0] := chr(ord(answer[0]));}
   </i></font>answerformain <font color="#000080">:= </font>answer<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>ANSI <font color="#FF0000"><b>then </b></font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font>maxlen<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>wherey<font color="#000080">) </font><font color="#FF0000"><b>else
     for </b></font>i <font color="#000080">:= </font>index <font color="#FF0000"><b>to </b></font>maxlen<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
   </font>colorBG<font color="#000080">(</font>black<font color="#000080">);</font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>setup_output<font color="#000080">;
   </font><font color="#FF0000"><b>begin
   if </b></font>ANSI <font color="#000080">= </font>false <font color="#FF0000"><b>then
      begin
      </b></font>assign<font color="#000080">(</font>output<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
      </font>rewrite<font color="#000080">(</font>output<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>showmc<font color="#000080">(</font>ch<font color="#000080">: </font>char<font color="#000080">);
    </font><font color="#FF0000"><b>begin
    </b></font>colorFG<font color="#000080">(</font>blue<font color="#000080">);</font>PR<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">);</font>colorFG<font color="#000080">(</font>white<font color="#000080">);</font>PR<font color="#000080">(</font>CH<font color="#000080">);</font>colorFG<font color="#000080">(</font>blue<font color="#000080">);</font>PR<font color="#000080">(</font><font color="#800000">']'</font><font color="#000080">);
    </font>colorFG<font color="#000080">(</font>cyan<font color="#000080">);</font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>GetChoice<font color="#000080">(</font>numofchoices<font color="#000080">:</font>byte<font color="#000080">; </font>Choices<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>fgc<font color="#000080">,</font>bgc<font color="#000080">,</font>oc<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Reply<font color="#000080">: </font>byte<font color="#000080">);
   </font><font color="#008000"><i>{ last char of choices must NOT be #32 }

   </i></font><font color="#FF0000"><b>type
       </b></font>datatype <font color="#000080">= </font><font color="#FF0000"><b>record
         </b></font>beginpos<font color="#000080">: </font>byte<font color="#000080">;
         </font>text    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>choicetype <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>datatype<font color="#000080">;

   </font><font color="#FF0000"><b>var
      </b></font>i      <font color="#000080">: </font>byte<font color="#000080">;
      </font>c      <font color="#000080">: </font>choicetype<font color="#000080">;
      </font>incr   <font color="#000080">: </font>byte<font color="#000080">;
      </font>done   <font color="#000080">: </font>boolean<font color="#000080">;
      </font>baseX  <font color="#000080">: </font>byte<font color="#000080">;
      </font>tempkey<font color="#000080">: </font>char<font color="#000080">;
      </font>last   <font color="#000080">: </font>byte<font color="#000080">;
      </font>curc   <font color="#000080">: </font>byte<font color="#000080">;
      </font>oldc   <font color="#000080">: </font>byte<font color="#000080">;

   </font><font color="#FF0000"><b>begin
   if </b></font>ANSI <font color="#FF0000"><b>then
    Begin
    </b></font>baseX <font color="#000080">:= </font>whereX<font color="#000080">;
    </font>done <font color="#000080">:= </font>false<font color="#000080">;
    </font>choices <font color="#000080">:= </font>choices<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
    </font>last <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>incr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>choices<font color="#000080">) </font><font color="#FF0000"><b>do
        if </b></font>choices<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
           begin
           </b></font>inc<font color="#000080">(</font>incr<font color="#000080">);
           </font>c<font color="#000080">[</font>incr<font color="#000080">].</font>beginpos <font color="#000080">:= (</font>incr<font color="#000080">+</font>last<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">) ;
           </font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">+</font>copy<font color="#000080">(</font>choices<font color="#000080">,</font>last<font color="#000080">,</font>i<font color="#000080">-</font>last<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">;
           </font>last <font color="#000080">:= </font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>textcolor<font color="#000080">(</font>oc<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>incr <font color="#FF0000"><b>do
         begin
         </b></font>write<font color="#000080">(</font>c<font color="#000080">[</font>i<font color="#000080">].</font>text<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>OldC <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>CurC <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

    </font>Textcolor<font color="#000080">(</font>fgc<font color="#000080">);
    </font>textbackground<font color="#000080">(</font>bgc<font color="#000080">);
    </font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font>c<font color="#000080">[</font>CurC<font color="#000080">].</font>beginpos<font color="#000080">, </font>whereY<font color="#000080">);
    </font>write<font color="#000080">(</font>c<font color="#000080">[</font>CurC<font color="#000080">].</font>text<font color="#000080">);

    </font><font color="#FF0000"><b>repeat
       begin
      repeat
       if </b></font>portcheck <font color="#FF0000"><b>then
        if not </b></font>carrierfunc <font color="#FF0000"><b>then
         begin
         </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;


       </font>tempkey <font color="#000080">:= </font>readkey<font color="#000080">;
       </font><font color="#FF0000"><b>case </b></font>upcase<font color="#000080">(</font>tempkey<font color="#000080">) </font><font color="#FF0000"><b>of
          </b></font><font color="#800000">#0</font><font color="#000080">:
             </font><font color="#FF0000"><b>case </b></font>readkey <font color="#FF0000"><b>of
               </b></font><font color="#800000">#77</font><font color="#000080">:
                   </font><font color="#FF0000"><b>begin
                   </b></font>inc<font color="#000080">(</font>CurC<font color="#000080">);
                   </font><font color="#FF0000"><b>if </b></font>CurC <font color="#000080">= </font>numofchoices<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>CurC <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#800000">#75</font><font color="#000080">:
                   </font><font color="#FF0000"><b>begin
                   </b></font>dec<font color="#000080">(</font>CurC<font color="#000080">);
                   </font><font color="#FF0000"><b>if </b></font>CurC <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>CurC <font color="#000080">:= </font>numofchoices<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#800000">#32</font><font color="#000080">:</font><font color="#FF0000"><b>begin
              </b></font>CurC <font color="#000080">:= </font>CurC <font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>CurC <font color="#000080">= </font>numofchoices<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>CurC <font color="#000080">:= </font><font color="#800000">1
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#800000">#13</font><font color="#000080">: </font>done <font color="#000080">:= </font>true<font color="#000080">;
          </font><font color="#FF0000"><b>else
               for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numofchoices <font color="#FF0000"><b>do
                   if </b></font>upcase<font color="#000080">(</font>tempkey<font color="#000080">) = </font>c<font color="#000080">[</font>i<font color="#000080">].</font>text<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then
                                      begin
                                      </b></font>CurC <font color="#000080">:= </font>i<font color="#000080">;
                                      </font>done <font color="#000080">:= </font>true<font color="#000080">;
                                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>if </b></font>OldC <font color="#000080">&lt;&gt; </font>CurC <font color="#FF0000"><b>then
         begin
         </b></font>textcolor<font color="#000080">(</font>oc<font color="#000080">);
         </font>textbackground<font color="#000080">(</font>black<font color="#000080">);
         </font>gotoXY<font color="#000080">(</font>baseX<font color="#000080">+</font>c<font color="#000080">[</font>oldc<font color="#000080">].</font>beginpos<font color="#000080">, </font>wherey<font color="#000080">);
         </font>write<font color="#000080">(</font>c<font color="#000080">[</font>oldc<font color="#000080">].</font>text<font color="#000080">);

         </font>textbackground<font color="#000080">(</font>bgc<font color="#000080">);
         </font>textcolor<font color="#000080">(</font>fgc<font color="#000080">);
         </font>gotoXY<font color="#000080">(</font>basex<font color="#000080">+</font>c<font color="#000080">[</font>curc<font color="#000080">].</font>beginpos<font color="#000080">, </font>wherey<font color="#000080">);
         </font>write<font color="#000080">(</font>c<font color="#000080">[</font>curc<font color="#000080">].</font>text<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

       </font>OldC <font color="#000080">:= </font>CurC
       <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;

    </font>colorBG<font color="#000080">(</font>black<font color="#000080">);</font>PR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">);
    </font>Reply <font color="#000080">:= </font>CurC<font color="#000080">;

    </font><font color="#FF0000"><b>end

   else

    begin
    </b></font>incr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>last <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>done <font color="#000080">:= </font>false<font color="#000080">;
    </font>choices <font color="#000080">:= </font>Choices <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;

    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>choices<font color="#000080">) </font><font color="#FF0000"><b>do
     if </b></font>choices<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
        begin
        </b></font>inc<font color="#000080">(</font>incr<font color="#000080">);
        </font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text <font color="#000080">:= </font>copy<font color="#000080">(</font>choices<font color="#000080">, </font>last<font color="#000080">, </font>i<font color="#000080">-</font>last<font color="#000080">);
        </font><font color="#008000"><i>{writeln(c[incr].text);}
        </i></font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text <font color="#000080">:= </font><font color="#800000">'['</font><font color="#000080">+</font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font><font color="#800000">']'</font><font color="#000080">+</font>copy<font color="#000080">(</font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>ord<font color="#000080">(</font>c<font color="#000080">[</font>incr<font color="#000080">].</font>text<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])-</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">;
        </font>last <font color="#000080">:= </font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numofchoices <font color="#FF0000"><b>do </b></font>PR<font color="#000080">(</font>c<font color="#000080">[</font>i<font color="#000080">].</font>text<font color="#000080">);
    </font>PR<font color="#000080">(</font><font color="#800000">'-&gt; '</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat
        begin
        </b></font>tempkey <font color="#000080">:= </font>upcase<font color="#000080">(</font>readkey<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numofchoices <font color="#FF0000"><b>do
            begin
            if </b></font>tempkey <font color="#000080">= </font>c<font color="#000080">[</font>i<font color="#000080">].</font>text<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>then begin </b></font>done <font color="#000080">:= </font>true<font color="#000080">; </font>Reply <font color="#000080">:= </font>i<font color="#000080">;</font><font color="#FF0000"><b>end
            end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>done<font color="#000080">;
    </font>PR<font color="#000080">(</font>c<font color="#000080">[</font>reply<font color="#000080">].</font>text<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] + </font>copy<font color="#000080">(</font>c<font color="#000080">[</font>reply<font color="#000080">].</font>text<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>length<font color="#000080">(</font>c<font color="#000080">[</font>reply<font color="#000080">].</font>text<font color="#000080">)-</font><font color="#800000">4</font><font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>PrintScreen<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  InLine </b></font><font color="#000080">(</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$05</font><font color="#000080">)
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin   </b></font><font color="#008000"><i>{initialize the global variables }
    </i></font>ANSI <font color="#000080">:= </font>true<font color="#000080">;
    </font>carrierfunc<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font>useinsert <font color="#000080">:= </font>true<font color="#000080">;
    </font>CapsOn <font color="#000080">:= </font>true<font color="#000080">;
    </font>PortCheck <font color="#000080">:= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MISC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0204.PAS">Original</a><b>]</b></p></body>
</html>
