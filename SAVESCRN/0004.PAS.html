<html>
<head><title> "SAVE4.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SAVESCRN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I couldn't find your original message, but you could use this code fragment to
save and restore a Text-mode screen.
}

(* global Vars *)
</i></font><font color="#FF0000"><b>Var
   </b></font>vidSeg <font color="#000080">: </font>Word<font color="#000080">;
   </font>oldScr <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetVidSeg <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>mode <font color="#000080">: </font>Byte<font color="#000080">;
   </font>seg  <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>seg <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>mode <font color="#000080">:= </font>Mem<font color="#000080">[</font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">$449</font><font color="#000080">];
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mode <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>seg <font color="#000080">:= </font><font color="#800000">$B000</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mode <font color="#000080">&lt;= </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>seg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mode <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">]) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>mode <font color="#000080">&gt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font><font color="#008000"><i>(* the Program is not in the correct Text mode *)
        </i></font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>(* return errorlevel of 1 *)
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>GetVidSeg <font color="#000080">:= </font>seg<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* main Program *)
</i></font><font color="#FF0000"><b>begin
     </b></font>vidSeg <font color="#000080">:= </font>GetVidSeg<font color="#000080">;
     </font>Move<font color="#000080">(</font>Mem<font color="#000080">[</font>vidSeg <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">], </font>oldScr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>SizeOf<font color="#000080">(</font>oldScr<font color="#000080">));
     </font><font color="#008000"><i>(* the above line copies 4000 Bytes starting at $B000 : 0 For mono.
        or $B800 For colour into the Array 'oldScr' *)
     </i></font>ClrScr<font color="#000080">;
     </font>WriteLn<font color="#000080">(</font><font color="#800000">'Press ENTER to restore the screen...'</font><font color="#000080">);
     </font>Readln<font color="#000080">;
     </font>Move<font color="#000080">(</font>oldScr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>Mem<font color="#000080">[</font>vidSeg <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">], </font>SizeOf<font color="#000080">(</font>oldScr<font color="#000080">));
     </font><font color="#008000"><i>(* the above line copies the Array to video memory to restore the
        old screen *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
As you can see, video memory starts at offset 0 of either of two segments.  If
the computer is colour, Text screen memory starts at $B800 : 0000 and if the
computer is mono/herc, it starts at $B000 : 0000.  It is 4000 Bytes long.  Why?
 Because there are 2000 Characters on the screen (80 x 25), and each Character
gets a colour attribute (foreground, background, (non)blinking).  The top-left
Character, at row 1, column 1, is [vidSeg] : 0, and the next Byte,[vidSeg] : 1,
is the attribute For the Character, so the memory is laid out like this:

(offset 0) Char, attr, Char, attr, Char, attr.......Char, attr (offset 3999)
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SAVESCRN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
