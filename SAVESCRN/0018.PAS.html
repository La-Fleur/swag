<html>
<head><title> "Text Screen Capture" by ALEKSANDAR DLABAC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SAVESCRN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">  <font color="#008000"><i>{$B-,F-,I-,R-,S-}
  {$M 2048,2048,2048}
  </i></font><font color="#FF0000"><b>Program </b></font>CapText<font color="#000080">;
</font><font color="#008000"><i>{
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;     Resident text screen capture     &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;           Aleksandar Dlabac          &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;     (C)1992. Dlabac Bros. Company    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;    ------------------------------    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.urc.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.pmf.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
               &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;
}
    </i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>OldKeyboard        <font color="#000080">: </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">;
        </font>OldTimeClick       <font color="#000080">: </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">;
        </font>OldIdle            <font color="#000080">: </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Keyboard<font color="#000080">; </font>Interrupt<font color="#000080">; </font><font color="#FF0000"><b>Forward</b></font><font color="#000080">;    </font><font color="#008000"><i>{&lt;                        }
    </i></font><font color="#FF0000"><b>Procedure </b></font>TimeClick<font color="#000080">; </font>Interrupt<font color="#000080">; </font><font color="#FF0000"><b>Forward</b></font><font color="#000080">;   </font><font color="#008000"><i>{&lt; New interrapt routines }
    </i></font><font color="#FF0000"><b>Procedure </b></font>Idle<font color="#000080">; </font>Interrupt<font color="#000080">; </font><font color="#FF0000"><b>Forward</b></font><font color="#000080">;        </font><font color="#008000"><i>{&lt;                        }

    </i></font><font color="#FF0000"><b>Var </b></font>FileName           <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
        </font>InDos              <font color="#000080">: ^</font>Boolean<font color="#000080">;
        </font>PSP                <font color="#000080">: </font>word<font color="#000080">;
        </font>Signature          <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
        </font>PoV                <font color="#000080">: </font>byte<font color="#000080">;
        </font>Call               <font color="#000080">: </font>byte<font color="#000080">;
        </font>I                  <font color="#000080">: </font>byte<font color="#000080">;
        </font>X1<font color="#000080">, </font>X2<font color="#000080">, </font>Y1<font color="#000080">, </font>Y2     <font color="#000080">: </font>byte<font color="#000080">;
        </font>Ctrl<font color="#000080">, </font>Shift<font color="#000080">, </font>Alt   <font color="#000080">: </font>Boolean<font color="#000080">;
        </font>PasStack           <font color="#000080">: </font>pointer<font color="#000080">;
        </font>OldStack           <font color="#000080">: </font>pointer<font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>GetStack<font color="#000080">;
    </font><font color="#008000"><i>{ Gets current SP and SS values }
      </i></font><font color="#FF0000"><b>Inline </b></font><font color="#000080">(</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/&gt;</font>PasStack<font color="#000080">/</font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/&gt;</font>PasStack<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);

    </font><font color="#FF0000"><b>Procedure </b></font>ToPasStack<font color="#000080">;
    </font><font color="#008000"><i>{ Changes current SP and SS values, to Pascal code ones }
      </i></font><font color="#FF0000"><b>Inline </b></font><font color="#000080">(</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/&gt;</font>OldStack<font color="#000080">/</font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/&gt;</font>OldStack<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">/
              </font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/&gt;</font>PasStack<font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/&gt;</font>PasSTack<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">$FB</font><font color="#000080">);

    </font><font color="#FF0000"><b>Procedure </b></font>ToOldStack<font color="#000080">;
    </font><font color="#008000"><i>{ Changes current SP and SS values, to original ones }
      </i></font><font color="#FF0000"><b>Inline </b></font><font color="#000080">(</font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/&gt;</font>OldStack<font color="#000080">/</font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/&gt;</font>OldStack<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);

    </font><font color="#FF0000"><b>Function </b></font>PasStackFree <font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#008000"><i>{ Checks if Pascal stack is free }
      </i></font><font color="#FF0000"><b>Inline </b></font><font color="#000080">(</font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$D0</font><font color="#000080">/</font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/&gt;</font>PasStack<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">/</font><font color="#800000">$0A</font><font color="#000080">/</font><font color="#800000">$C4</font><font color="#000080">);

    </font><font color="#FF0000"><b>Procedure </b></font>PushF<font color="#000080">;
    </font><font color="#008000"><i>{ PUSHF assembler command must be executed before old interrupt   }
    { procedure call. This is because IRET pops flags, and RET don't. }
      </i></font><font color="#FF0000"><b>Inline </b></font><font color="#000080">(</font><font color="#800000">$9C</font><font color="#000080">);

    </font><font color="#FF0000"><b>Function </b></font>IntVec <font color="#000080">(</font>IntNo<font color="#000080">:</font>byte<font color="#000080">) : </font>pointer<font color="#000080">;
    </font><font color="#008000"><i>{ Returns pointer to requested interrupt routine }
      </i></font><font color="#FF0000"><b>Var </b></font>P <font color="#000080">: </font>pointer<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
          </b></font>GetIntVec <font color="#000080">(</font>IntNo<font color="#000080">,</font>P<font color="#000080">); </font>IntVec<font color="#000080">:=</font>P
        <font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Swp <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">,</font>Y<font color="#000080">:</font>byte<font color="#000080">);
    </font><font color="#008000"><i>{ Swaps two variables }
      </i></font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
          </b></font>Temp<font color="#000080">:=</font>X<font color="#000080">;
          </font>X<font color="#000080">:=</font>Y<font color="#000080">;
          </font>Y<font color="#000080">:=</font>Temp
        <font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>SaveScreen<font color="#000080">;
    </font><font color="#008000"><i>{ Procedure for screen content saving to file }
      </i></font><font color="#FF0000"><b>Function </b></font>VideoAdr <font color="#000080">: </font>word<font color="#000080">;
      </font><font color="#008000"><i>{ Address of video segment }
        </i></font><font color="#FF0000"><b>Begin
          If </b></font>Mem <font color="#000080">[</font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0449</font><font color="#000080">] = </font><font color="#800000">7
            </font><font color="#FF0000"><b>then </b></font>VideoAdr<font color="#000080">:=</font><font color="#800000">$B000
            </font><font color="#FF0000"><b>else </b></font>VideoAdr<font color="#000080">:=</font><font color="#800000">$B800
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Var </b></font>F    <font color="#000080">: </font>text<font color="#000080">;
          </font>St   <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
          </font>I<font color="#000080">, </font>J <font color="#000080">: </font>integer<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
          </b></font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FileName<font color="#000080">);
          </font>Append <font color="#000080">(</font>F<font color="#000080">);
          </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>Y1 <font color="#FF0000"><b>to </b></font>Y2 <font color="#FF0000"><b>do
            Begin
              </b></font>St<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
              </font><font color="#FF0000"><b>For </b></font>J<font color="#000080">:=</font>X1 <font color="#FF0000"><b>to </b></font>X2 <font color="#FF0000"><b>do </b></font>St<font color="#000080">:=</font>St<font color="#000080">+</font>Chr <font color="#000080">(</font>Mem <font color="#000080">[</font>VideoAdr<font color="#000080">:((</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]);
              </font>Writeln <font color="#000080">(</font>F<font color="#000080">,</font>St<font color="#000080">)
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>Close <font color="#000080">(</font>F<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>UnInstall<font color="#000080">;
    </font><font color="#008000"><i>{ Uninstalls program, if it is possible, i.e. if hooked vectors are not }
    { changed after installation. Beep if successfull.                      }
      </i></font><font color="#FF0000"><b>Type </b></font>MCB    <font color="#000080">= </font><font color="#FF0000"><b>record
                      </b></font>Tok      <font color="#000080">: </font>byte<font color="#000080">;
                      </font>PID      <font color="#000080">: </font>word<font color="#000080">;
                      </font>Siz      <font color="#000080">: </font>word
                    <font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font>MCBPtr <font color="#000080">= ^</font>MCB<font color="#000080">;
           </font>WrdPtr <font color="#000080">= ^</font>word<font color="#000080">;
      </font><font color="#FF0000"><b>Var </b></font>Blk <font color="#000080">: </font>MCBPtr<font color="#000080">;
          </font>Adr <font color="#000080">: </font>WrdPtr<font color="#000080">;
          </font>R   <font color="#000080">: </font>Registers<font color="#000080">;
        </font><font color="#FF0000"><b>Begin
          If </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">)=@</font>TimeClick<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">)=@</font>Keyboard<font color="#000080">)
             </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">)=@</font>Idle<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font>PoV<font color="#000080">)=@</font>Signature<font color="#000080">) </font><font color="#FF0000"><b>then
            Begin
              </b></font>SetIntVec <font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">,@</font>OldTimeClick<font color="#000080">);
              </font>SetIntVec <font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">,@</font>OldKeyboard<font color="#000080">);
              </font>SetIntVec <font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">,@</font>OldIdle<font color="#000080">);
              </font>SetIntVec <font color="#000080">(</font>PoV<font color="#000080">,</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">);
              </font>R<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$52</font><font color="#000080">;
              </font>MsDos <font color="#000080">(</font>R<font color="#000080">);
              </font>Adr<font color="#000080">:=</font>Ptr <font color="#000080">(</font>R<font color="#000080">.</font>ES<font color="#000080">,</font>R<font color="#000080">.</font>BX<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
              </font>Blk<font color="#000080">:=</font>Ptr <font color="#000080">(</font>Adr<font color="#000080">^,</font><font color="#800000">0</font><font color="#000080">);
                </font><font color="#FF0000"><b>Repeat
                  If </b></font><font color="#000080">(</font>Blk<font color="#000080">^.</font>PID<font color="#000080">=</font>PSP<font color="#000080">) </font><font color="#FF0000"><b>then
                    Begin
                      </b></font>R<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$49</font><font color="#000080">;
                      </font>R<font color="#000080">.</font>ES<font color="#000080">:=</font>Seg <font color="#000080">(</font>Blk<font color="#000080">^)+</font><font color="#800000">1</font><font color="#000080">;
                      </font>MsDos <font color="#000080">(</font>R<font color="#000080">)
                    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Blk<font color="#000080">^.</font>Tok<font color="#000080">=</font><font color="#800000">$4D</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Blk<font color="#000080">:=</font>Ptr <font color="#000080">(</font>Blk<font color="#000080">^.</font>Siz<font color="#000080">+</font>Seg <font color="#000080">(</font>Blk<font color="#000080">^)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
                                    </font><font color="#FF0000"><b>else </b></font>Blk<font color="#000080">:=</font><font color="#FF0000"><b>Nil
                Until </b></font>Blk<font color="#000080">=</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
              </font>Write <font color="#000080">(</font><font color="#800000">#7</font><font color="#000080">);
            </font><font color="#FF0000"><b>End
        End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Action<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
          Case </b></font>Call <font color="#FF0000"><b>of
            </b></font><font color="#800000">22 </font><font color="#000080">: </font>Uninstall<font color="#000080">;
            </font><font color="#800000">38 </font><font color="#000080">: </font>SaveScreen
          <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Call<font color="#000080">:=</font><font color="#800000">0
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Keyboard<font color="#000080">;
    </font><font color="#008000"><i>{ New Keyboard interrupt routine }
      </i></font><font color="#FF0000"><b>Begin
          Case </b></font>Port <font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">] </font><font color="#FF0000"><b>of
            </b></font><font color="#800000">29     </font><font color="#000080">: </font>Ctrl<font color="#000080">:=</font>True<font color="#000080">;
            </font><font color="#800000">157    </font><font color="#000080">: </font>Ctrl<font color="#000080">:=</font>False<font color="#000080">;
            </font><font color="#800000">42     </font><font color="#000080">: </font>Shift<font color="#000080">:=</font>True<font color="#000080">;
            </font><font color="#800000">170    </font><font color="#000080">: </font>Shift<font color="#000080">:=</font>False<font color="#000080">;
            </font><font color="#800000">56     </font><font color="#000080">: </font>Alt<font color="#000080">:=</font>True<font color="#000080">;
            </font><font color="#800000">184    </font><font color="#000080">: </font>Alt<font color="#000080">:=</font>False<font color="#000080">;
            </font><font color="#800000">22</font><font color="#000080">, </font><font color="#800000">38 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>Shift <font color="#FF0000"><b>and </b></font>Ctrl <font color="#FF0000"><b>and </b></font>Alt <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Call<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                       </font><font color="#FF0000"><b>then </b></font>Call<font color="#000080">:=</font>Port <font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">]
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>PushF<font color="#000080">;
        </font>OldKeyboard
      <font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>TimeClick<font color="#000080">;
    </font><font color="#008000"><i>{ New timer interrupt routine }
      </i></font><font color="#FF0000"><b>Begin
        </b></font>PushF<font color="#000080">;
        </font>OldTimeClick<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Call<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>InDos<font color="#000080">^) </font><font color="#FF0000"><b>and </b></font>PasStackFree <font color="#FF0000"><b>then
          Begin
            </b></font>ToPasStack<font color="#000080">;
            </font>Action<font color="#000080">;
            </font>ToOldStack
          <font color="#FF0000"><b>End
      End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Procedure </b></font>Idle<font color="#000080">;
    </font><font color="#008000"><i>{ New DOS Idle interrupt routine }
      </i></font><font color="#FF0000"><b>Begin
        </b></font>PushF<font color="#000080">;
        </font>OldIdle<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Call<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>PasStackFree <font color="#FF0000"><b>then
          Begin
            </b></font>ToPasStack<font color="#000080">;
            </font>Action<font color="#000080">;
            </font>ToOldStack
          <font color="#FF0000"><b>End
      End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>Var </b></font>R <font color="#000080">: </font>Registers<font color="#000080">;
        </font>F <font color="#000080">: </font>Text<font color="#000080">;
      </font><font color="#FF0000"><b>Begin
        </b></font>Writeln<font color="#000080">;
        </font>Writeln <font color="#000080">(</font><font color="#800000">'Text Capture  ver 1.0'</font><font color="#000080">);
        </font>Writeln <font color="#000080">(</font><font color="#800000">'Dlabac Bros Software  (C) 1992'</font><font color="#000080">);
        </font>Writeln <font color="#000080">(</font><font color="#800000">'Activation Ctrl-Alt-Shift L'</font><font color="#000080">);
        </font>Writeln <font color="#000080">(</font><font color="#800000">'Deactivation Ctrl-Alt-Shift U'</font><font color="#000080">);
        </font>Writeln<font color="#000080">;
        </font>Signature<font color="#000080">:=</font><font color="#800000">'TextCap1.0'</font><font color="#000080">;
        </font>PoV<font color="#000080">:=</font><font color="#800000">$60</font><font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PoV<font color="#000080">&lt;</font><font color="#800000">$68</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>string </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font>PoV<font color="#000080">)^)&lt;&gt;</font>Signature<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Inc <font color="#000080">(</font>PoV<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PoV<font color="#000080">&lt;&gt;</font><font color="#800000">$68</font><font color="#000080">) </font><font color="#FF0000"><b>then
          Begin
            </b></font>Writeln <font color="#000080">(</font><font color="#800000">'TextCap already installed.'</font><font color="#000080">);
            </font>Halt <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>PoV<font color="#000080">:=</font><font color="#800000">$60</font><font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>PoV<font color="#000080">&lt;</font><font color="#800000">$68</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>IntVec <font color="#000080">(</font>PoV<font color="#000080">)&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Inc <font color="#000080">(</font>PoV<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>PoV<font color="#000080">=</font><font color="#800000">$68 </font><font color="#FF0000"><b>then
          Begin
            </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Instalation unsuccessful - no free vector : 60H-67H'</font><font color="#000080">);
            </font>Halt <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>Repeat
          </b></font>Write <font color="#000080">(</font><font color="#800000">'Define window coordinates (X1 Y1 X2 Y2) : '</font><font color="#000080">);
          </font>Readln <font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>X1<font color="#000080">&gt;</font>X2 <font color="#FF0000"><b>then </b></font>Swp <font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>Y1<font color="#000080">&gt;</font>Y2 <font color="#FF0000"><b>then </b></font>Swp <font color="#000080">(</font>Y1<font color="#000080">,</font>Y2<font color="#000080">)
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>X1<font color="#000080">&gt;=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>X2<font color="#000080">&lt;=</font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y1<font color="#000080">&gt;=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y2<font color="#000080">&lt;=</font><font color="#800000">25</font><font color="#000080">);
        </font>Write <font color="#000080">(</font><font color="#800000">'File name : '</font><font color="#000080">);
        </font>Readln <font color="#000080">(</font>FileName<font color="#000080">);
        </font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FileName<font color="#000080">);
        </font>Rewrite <font color="#000080">(</font>F<font color="#000080">);
        </font>Close <font color="#000080">(</font>F<font color="#000080">);
        </font>R<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$34</font><font color="#000080">;
        </font>MsDos <font color="#000080">(</font>R<font color="#000080">);
        </font>InDos<font color="#000080">:=</font>Ptr <font color="#000080">(</font>R<font color="#000080">.</font>ES<font color="#000080">,</font>R<font color="#000080">.</font>BX<font color="#000080">);
        </font>R<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$62</font><font color="#000080">;
        </font>MsDos <font color="#000080">(</font>R<font color="#000080">);
        </font>PSP<font color="#000080">:=</font>R<font color="#000080">.</font>BX<font color="#000080">;
        </font>Call<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>Ctrl<font color="#000080">:=</font>False<font color="#000080">;
        </font>Shift<font color="#000080">:=</font>False<font color="#000080">;
        </font>Alt<font color="#000080">:=</font>False<font color="#000080">;
        </font>SwapVectors<font color="#000080">;
        </font>GetIntVec <font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">,@</font>OldTimeClick<font color="#000080">);
        </font>GetIntVec <font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">,@</font>OldKeyboard<font color="#000080">);
        </font>GetIntVec <font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">,@</font>OldIdle<font color="#000080">);
        </font>SetIntVec <font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">,@</font>TimeClick<font color="#000080">);
        </font>SetIntVec <font color="#000080">(</font><font color="#800000">$09</font><font color="#000080">,@</font>Keyboard<font color="#000080">);
        </font>SetIntVec <font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">,@</font>Idle<font color="#000080">);
        </font>SetIntVec <font color="#000080">(</font>Pov<font color="#000080">,@</font>Signature<font color="#000080">);
        </font>GetStack<font color="#000080">;
        </font>Keep <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SAVESCRN SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
