<html>
<head><title> "Encode/Decode w/ Password" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*-----
        Program                : CODE/DECODE

        File                : Code.Pas

        Version                : 1.2

        Author(s)        : Mark Midgley

        Date
         (Started)        : April 11, 1990
        Date
         (Finished)        : , 1990

        Comment(s)        :

-----*)
</i></font><font color="#FF0000"><b>Program </b></font>Code_and_DeCode<font color="#000080">;


</font><font color="#008000"><i>{$IFDEF DEBUG}
        {$D+}                (* Turn Debugging Info **ON** *)
        {$L+}                (* Turn Local Symbols  **ON** *)
        {$R+}                (* Turn Range Checking **ON** *)
        {$S+}                (* Turn Stack Checking **ON** *)
{$ELSE}
        {$D-}                (* Turn Debugging Info **OFF** *)
        {$L-}                (* Turn Local Symbols  **OFF** *)
        {$R-}                (* Turn Range Checking **OFF** *)
        {$S-}                (* Turn Stack Checking **OFF** *)
{$ENDIF}

</i></font><font color="#FF0000"><b>Uses
        </b></font>Crt<font color="#000080">,
        </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
        </b></font>BufSize                <font color="#000080">=        </font><font color="#800000">512</font><font color="#000080">;
        </font>Version                <font color="#000080">=        </font><font color="#800000">'1.3'</font><font color="#000080">;
        </font>MaxError    <font color="#000080">=        </font><font color="#800000">7</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
        </b></font>EDMode                        <font color="#000080">=        (</font>EnCrypt<font color="#000080">,</font>EnCryptPass<font color="#000080">,</font>DeCrypt<font color="#000080">);
        </font>String79                <font color="#000080">=        </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">79</font><font color="#000080">];
        </font>FilePaths                <font color="#000080">=        </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>String79<font color="#000080">;
        </font>Errors                        <font color="#000080">=        </font><font color="#800000">1</font><font color="#000080">..(</font>MaxError <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>WriteXY<font color="#000080">( </font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Byte<font color="#000080">; </font>S <font color="#000080">: </font>String79 <font color="#000080">);
</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* WriteXY *)
        </i></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
        </font>Write<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* WriteXY *)

</i></font><font color="#FF0000"><b>Function </b></font>UpStr<font color="#000080">( </font>S <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
        </b></font>X        <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* UpStr *)
        </i></font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>Do
                </b></font>S<font color="#000080">[</font>x<font color="#000080">] := (</font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font>x<font color="#000080">]) );
        </font>UpStr <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* UpStr *)

</i></font><font color="#FF0000"><b>Procedure </b></font>Center<font color="#000080">( </font>Y <font color="#000080">: </font>Byte<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>OverWriteMode <font color="#000080">: </font>Errors <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>X <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* Center *)
        </i></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">);
        </font><font color="#FF0000"><b>Case </b></font><font color="#000080">(</font>OverWriteMode<font color="#000080">) </font><font color="#FF0000"><b>of
                </b></font><font color="#800000">1        </font><font color="#000080">: </font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>To </b></font><font color="#800000">78 </font><font color="#FF0000"><b>Do </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">,</font>WhereY<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
                </font><font color="#800000">2        </font><font color="#000080">: </font>ClrEOL<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
        </i></font>X <font color="#000080">:= ((</font><font color="#800000">79 </font><font color="#000080">- </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>X <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>X <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>WriteXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Center *)

</i></font><font color="#FF0000"><b>Procedure </b></font>OutError<font color="#000080">( </font>S <font color="#000080">: </font>String79<font color="#000080">; </font>X<font color="#000080">,</font>OWM <font color="#000080">: </font>Errors <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>T <font color="#000080">: </font>String79<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* OutError *)
        </i></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>WhereY<font color="#000080">);
        </font><font color="#FF0000"><b>Case </b></font><font color="#000080">( </font>X <font color="#000080">) </font><font color="#FF0000"><b>Of
                </b></font><font color="#800000">1        </font><font color="#000080">: </font>T <font color="#000080">:= (</font><font color="#800000">'Incorrect Number of parameters.'</font><font color="#000080">);
                </font><font color="#800000">2        </font><font color="#000080">: </font>T <font color="#000080">:= (</font><font color="#800000">'Input file &quot;'</font><font color="#000080">+ </font>S <font color="#000080">+</font><font color="#800000">'&quot; not found.'</font><font color="#000080">);
                </font><font color="#800000">3        </font><font color="#000080">: </font>T <font color="#000080">:= (</font><font color="#800000">'Input and Output files conflict.'</font><font color="#000080">);
                </font><font color="#800000">4        </font><font color="#000080">: </font>T <font color="#000080">:= (</font><font color="#800000">'User Aborted!'</font><font color="#000080">);
                </font><font color="#800000">5        </font><font color="#000080">: </font>T <font color="#000080">:= (</font><font color="#800000">'Input file &quot;'</font><font color="#000080">+ </font>S <font color="#000080">+</font><font color="#800000">'&quot; is corrupted!'</font><font color="#000080">);
                </font><font color="#800000">6        </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>T <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>T <font color="#000080">:= (</font><font color="#800000">'DOS Input/Output Failure.'</font><font color="#000080">)
                                </font><font color="#FF0000"><b>Else </b></font>T <font color="#000080">:= </font>S<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
        </i></font>TextColor<font color="#000080">(</font>LightRed<font color="#000080">);
        </font>Center<font color="#000080">(</font>WhereY<font color="#000080">,</font>T<font color="#000080">,</font>OWM<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>OWM <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>WriteLn<font color="#000080">;
        </font>WriteLn<font color="#000080">;
        </font>Halt<font color="#000080">(</font>x<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* OutError *)

</i></font><font color="#FF0000"><b>Procedure </b></font>HelpScreen<font color="#000080">( </font>FullScreen <font color="#000080">: </font>Boolean <font color="#000080">);
</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* HelpScreen *)
        </i></font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'               USAGE: CODE [/D|/E|/P] INPUT_FILE OUTPUT_FILE'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                  Options are: /D Decode File.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                               /E Encode File.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                               /P Encode with Password.'</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>FullScreen<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Halt<font color="#000080">(</font>MaxError<font color="#000080">);
        </font>WriteLn<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Description:'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  CODE  encrypts a  DOS  file  to  garbage using  a  randomly  generated  seed'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  and then back again.  For  more protection, the password  option can be used.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Note:  With no  option, CODE defaults to encode &quot;/E&quot;;  Input and Output files'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  must be different;  the &quot;/P&quot; option will  prompt  for the password  and  echo'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  dots;  Code does not allow wildcards;  Pressing  ESCape during operation will'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  abort.  The author  does  not  guarantee  the reliability of this program and'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  is not responsible for  any data lost.  If you appreciate this program in any'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  way or value its use then please send $5.00 - $20.00 to:'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">;
        </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                                        Mark &quot;Zing&quot; Midgley'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                                        843 East 300 South'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'                                        Bountiful Ut, 84010'</font><font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>Halt<font color="#000080">(</font>MaxError<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;         </font><font color="#008000"><i>(* HelpScreen *)

</i></font><font color="#FF0000"><b>Function </b></font>Shrink<font color="#000080">( </font>P <font color="#000080">: </font>PathStr <font color="#000080">) : </font>String79<font color="#000080">;
</font><font color="#FF0000"><b>Var
        </b></font>D        <font color="#000080">: </font>DirStr<font color="#000080">;
        </font>N        <font color="#000080">: </font>NameStr<font color="#000080">;
        </font>E        <font color="#000080">: </font>ExtStr<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* Shrink *)
        </i></font>FSplit<font color="#000080">(</font>P<font color="#000080">,</font>D<font color="#000080">,</font>N<font color="#000080">,</font>E<font color="#000080">);
        </font>Shrink <font color="#000080">:= </font>N <font color="#000080">+ </font>E<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Shrink *)

</i></font><font color="#FF0000"><b>Procedure </b></font>GraphIt<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>F1<font color="#000080">, </font>F2        <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
                                   </font><font color="#FF0000"><b>Var </b></font>OldX                <font color="#000080">: </font>Byte<font color="#000080">;
                                   </font>Hour<font color="#000080">,
                                   </font>Min<font color="#000080">,
                                   </font>Sec<font color="#000080">,
                                   </font>Sec100                <font color="#000080">: </font>Word<font color="#000080">;
                                   </font>BoxSetUp                <font color="#000080">: </font>Boolean <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>F1Size<font color="#000080">,
        </font>F2Size        <font color="#000080">: </font>LongInt<font color="#000080">;
        </font>Percent<font color="#000080">,
        </font>X<font color="#000080">,
        </font>NewX        <font color="#000080">: </font>Byte<font color="#000080">;
        </font>H<font color="#000080">,
        </font>M<font color="#000080">,
        </font>S<font color="#000080">,
        </font>S100        <font color="#000080">: </font>Word<font color="#000080">;
        </font>A<font color="#000080">,
        </font>B<font color="#000080">,
        </font>C<font color="#000080">,
        </font>D<font color="#000080">,
        </font>Temp        <font color="#000080">: </font>String79<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* GraphIt *)
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>BoxSetUp<font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>Percent <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                </font>OldX <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
                </font>WriteLn<font color="#000080">(</font><font color="#800000">'&Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;'</font><font color="#000080">);
                </font>WriteLn<font color="#000080">(</font><font color="#800000">'&ordm;                                                                             &ordm;'</font><font color="#000080">);
                </font>WriteLn<font color="#000080">(</font><font color="#800000">'&Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;'</font><font color="#000080">);
                </font>GotoXY<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font>WhereY <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>End Else
        Begin
                </b></font>GetTime<font color="#000080">(</font>H<font color="#000080">,</font>M<font color="#000080">,</font>S<font color="#000080">,</font>S100<font color="#000080">);
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Sec100 <font color="#000080">&lt;= </font>S100<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>S100<font color="#000080">,</font>Sec100<font color="#000080">)
                        </font><font color="#FF0000"><b>Else
                        Begin
                                </b></font>S100 <font color="#000080">:= (</font>S100 <font color="#000080">+ </font><font color="#800000">100 </font><font color="#000080">- </font>Sec100<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>S <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>S<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Sec <font color="#000080">&lt;= </font>S<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>S<font color="#000080">,</font>Sec<font color="#000080">)
                        </font><font color="#FF0000"><b>Else
                        Begin
                                </b></font>S <font color="#000080">:= (</font>S <font color="#000080">+ </font><font color="#800000">60 </font><font color="#000080">- </font>Sec<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>M <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>M<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Min <font color="#000080">&lt;= </font>M<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>M<font color="#000080">,</font>Min<font color="#000080">)
                        </font><font color="#FF0000"><b>Else
                        Begin
                                </b></font>M <font color="#000080">:= (</font>M <font color="#000080">+ </font><font color="#800000">60 </font><font color="#000080">- </font>Min<font color="#000080">);
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>H <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>H<font color="#000080">);
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Hour <font color="#000080">&lt;= </font>H<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>H<font color="#000080">,</font>Hour<font color="#000080">)
                        </font><font color="#FF0000"><b>Else </b></font>H <font color="#000080">:= (</font>H <font color="#000080">+ </font><font color="#800000">12 </font><font color="#000080">- </font>Hour<font color="#000080">);
                </font>Str<font color="#000080">(</font>H<font color="#000080">,</font>A<font color="#000080">);
                </font>Str<font color="#000080">(</font>M<font color="#000080">,</font>B<font color="#000080">);
                </font>Str<font color="#000080">(</font>S<font color="#000080">,</font>C<font color="#000080">);
                </font>Str<font color="#000080">(</font>S100<font color="#000080">,</font>D<font color="#000080">);
                </font><font color="#FF0000"><b>Case </b></font><font color="#000080">(</font>S100<font color="#000080">) </font><font color="#FF0000"><b>of
                        </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9        </font><font color="#000080">: </font>D <font color="#000080">:= (</font><font color="#800000">'0' </font><font color="#000080">+ </font>D<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
                </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>M <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                Case </b></font><font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>of
                        </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9        </font><font color="#000080">: </font>C <font color="#000080">:= (</font><font color="#800000">'0' </font><font color="#000080">+ </font>C<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
                </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>H <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                Case </b></font><font color="#000080">(</font>M<font color="#000080">) </font><font color="#FF0000"><b>of
                        </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9        </font><font color="#000080">: </font>B <font color="#000080">:= (</font><font color="#800000">'0' </font><font color="#000080">+ </font>B<font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
                </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>H <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                Begin
                        If </b></font><font color="#000080">(</font>M <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Temp <font color="#000080">:= (</font>Concat<font color="#000080">(</font>C<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">' sec'</font><font color="#000080">) )
                        </font><font color="#FF0000"><b>Else </b></font>Temp <font color="#000080">:= (</font>Concat<font color="#000080">(</font>B<font color="#000080">,</font><font color="#800000">' min '</font><font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">' sec'</font><font color="#000080">) );
                </font><font color="#FF0000"><b>End
                Else If </b></font><font color="#000080">(</font>H <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Temp <font color="#000080">:= (</font>Concat<font color="#000080">(</font>A<font color="#000080">,</font><font color="#800000">' hr '</font><font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">' min '</font><font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">' sec'</font><font color="#000080">) )
                                </font><font color="#FF0000"><b>Else </b></font>Temp <font color="#000080">:= (</font>Concat<font color="#000080">(</font>A<font color="#000080">,</font><font color="#800000">' hrs '</font><font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">' min '</font><font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">' sec'</font><font color="#000080">) );
            </font>F1Size <font color="#000080">:= </font>FileSize<font color="#000080">(</font>F1<font color="#000080">);
                </font>F2Size <font color="#000080">:= </font>FileSize<font color="#000080">(</font>F2<font color="#000080">);
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>F2Size <font color="#000080">&lt;= </font>F1Size<font color="#000080">) </font><font color="#FF0000"><b>Then
                </b></font>Percent <font color="#000080">:= ((</font>F2Size <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font>F1Size <font color="#000080">)
                        </font><font color="#FF0000"><b>Else </b></font>Percent <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
                </font>NewX <font color="#000080">:= (((</font>Percent <font color="#000080">* </font><font color="#800000">76</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">100</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">);
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NewX <font color="#000080">&lt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>NewX <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
                </font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font>OldX <font color="#FF0000"><b>To </b></font>NewX <font color="#FF0000"><b>Do </b></font>WriteXY<font color="#000080">(</font>X<font color="#000080">,</font>WhereY<font color="#000080">,</font><font color="#800000">#176</font><font color="#000080">);
                </font>OldX <font color="#000080">:= </font>NewX<font color="#000080">;
                </font>Center<font color="#000080">(</font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,(</font><font color="#800000">#181 </font><font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>Temp <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font><font color="#800000">#198</font><font color="#000080">),</font><font color="#800000">3</font><font color="#000080">);
                </font>GotoXY<font color="#000080">(</font>NewX<font color="#000080">,</font>WhereY <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* GraphIt *)

</i></font><font color="#FF0000"><b>Procedure </b></font>Rm<font color="#000080">( </font>FileName <font color="#000080">: </font>String79 <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>F <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* Rm *)
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>FileName <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
        </font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>FileName<font color="#000080">);
        </font>Erase<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Rm *)

</i></font><font color="#FF0000"><b>Procedure </b></font>GetStr<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>S <font color="#000080">: </font>String79<font color="#000080">; </font>Prompt<font color="#000080">,</font>FName <font color="#000080">: </font>String79<font color="#000080">; </font>Show <font color="#000080">: </font>Boolean <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>Max<font color="#000080">,
        </font>Min        <font color="#000080">: </font>Byte<font color="#000080">;
        </font>A        <font color="#000080">: </font>Char<font color="#000080">;
        </font>X        <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* GetStr *)
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>FName <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>Max <font color="#000080">:= </font><font color="#800000">54</font><font color="#000080">;
                </font>Min <font color="#000080">:= </font><font color="#800000">0
        </font><font color="#FF0000"><b>End Else
        Begin
                </b></font>Max <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;
                </font>Min <font color="#000080">:= </font><font color="#800000">3
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>WriteXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">,</font>Prompt<font color="#000080">);
        </font><font color="#FF0000"><b>Repeat
                </b></font>GotoXY<font color="#000080">(</font>Length<font color="#000080">(</font>Prompt<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">);
                </font>ClrEOL<font color="#000080">;
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Show<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>WriteXY<font color="#000080">(</font>Length<font color="#000080">(</font>Prompt<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">,</font>S<font color="#000080">)
                </font><font color="#FF0000"><b>Else For </b></font>X <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font><font color="#800000">#249</font><font color="#000080">);
                </font>A <font color="#000080">:= (</font>ReadKey<font color="#000080">);
                </font><font color="#FF0000"><b>Case </b></font><font color="#000080">( </font>A <font color="#000080">) </font><font color="#FF0000"><b>of
                        </b></font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#126 </font><font color="#000080">:
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) &lt; </font>Max<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font>A
                                <font color="#FF0000"><b>Else
                                Begin
                                        </b></font>Sound<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
                                        </font>Delay<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
                                        </font>NoSound<font color="#000080">;
                                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font><font color="#800000">#8 </font><font color="#000080">:
                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
                                        </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,(</font>Length<font color="#000080">(</font>S<font color="#000080">) ), </font><font color="#800000">1</font><font color="#000080">);
                        </font><font color="#800000">#0 </font><font color="#000080">:
                                </font>A <font color="#000080">:= </font>ReadKey<font color="#000080">;
                        </font><font color="#800000">#27</font><font color="#000080">:
                                </font><font color="#FF0000"><b>Begin
                                        </b></font>Rm<font color="#000080">(</font>FName<font color="#000080">);
                                        </font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
        </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>A <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">) &gt;= </font>Min<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* GetStr *)

</i></font><font color="#FF0000"><b>Function </b></font>RealFile<font color="#000080">( </font>St <font color="#000080">: </font>String79<font color="#000080">; </font>OWM <font color="#000080">: </font>Errors <font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
        </b></font>Error <font color="#000080">: </font>Word<font color="#000080">;
        </font>F          <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* RealFile *)
        </i></font>RealFile <font color="#000080">:= </font>False<font color="#000080">;
        </font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>St<font color="#000080">);
        </font><font color="#008000"><i>{$I-}                 (* Turn Input/Output-Checking Switch Off *)
        </i></font>Reset<font color="#000080">(</font>F<font color="#000080">);        </font><font color="#008000"><i>(* Open file. *)
        </i></font>Error <font color="#000080">:= </font>IOResult<font color="#000080">;
        </font><font color="#008000"><i>{$I+}            (* Turn Input/Output-Checking Switch On  *)
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Error <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>(* File exists. *)
        </i></font><font color="#FF0000"><b>Begin
                </b></font>RealFile <font color="#000080">:= </font>True<font color="#000080">;
                </font>Close<font color="#000080">(</font>F<font color="#000080">);
        </font><font color="#FF0000"><b>End Else
</b></font><font color="#008000"><i>{*}                </i></font><font color="#FF0000"><b>Case </b></font><font color="#000080">(</font>Error<font color="#000080">) </font><font color="#FF0000"><b>Of
                        </b></font><font color="#800000">152        </font><font color="#000080">: </font>OutError<font color="#000080">(</font><font color="#800000">'Drive Not Ready.'</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>OWM<font color="#000080">);
                        </font><font color="#800000">3        </font><font color="#000080">: </font>OutError<font color="#000080">(</font><font color="#800000">'Invalid Drive specification.'</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>OWM<font color="#000080">);
                        </font><font color="#008000"><i>(* 5  : Directory *)
                </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* RealFile *)

</i></font><font color="#FF0000"><b>Procedure </b></font>CheckError<font color="#000080">( </font>FileName<font color="#000080">, </font>Msg <font color="#000080">: </font>String79 <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>Error <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* CheckError *)
        </i></font>Error <font color="#000080">:= </font>IOResult<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Error <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                If </b></font><font color="#000080">(</font>Error <font color="#000080">&lt;&gt; </font><font color="#800000">152</font><font color="#000080">) </font><font color="#FF0000"><b>And
                   </b></font><font color="#000080">(</font>Error <font color="#000080">&lt;&gt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Rm<font color="#000080">(</font>FileName<font color="#000080">)
                        </font><font color="#FF0000"><b>Else </b></font>Msg <font color="#000080">:= (</font><font color="#800000">'Drive Not Ready.'</font><font color="#000080">);
                </font>OutError<font color="#000080">(</font>Msg<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* CheckError *)

</i></font><font color="#FF0000"><b>Procedure </b></font>CheckAbort<font color="#000080">( </font>FileName <font color="#000080">: </font>String79 <font color="#000080">);
</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* CheckAbort *)
        </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">) </font><font color="#FF0000"><b>Then
        If </b></font><font color="#000080">(</font>ReadKey <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>Rm<font color="#000080">(</font>FileName<font color="#000080">);
                </font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* CheckAbort *)

(*----
        Procedure Encode();

        Author(s)        :        Mark Midgley
                                        Louis Zirkel

        Comments        :        Cool Man...

----*)

</i></font><font color="#FF0000"><b>Procedure </b></font>EnCode<font color="#000080">( </font>_File <font color="#000080">: </font>FilePaths<font color="#000080">; </font>Protect <font color="#000080">: </font>Boolean <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>Seed<font color="#000080">,
        </font>PI<font color="#000080">,
        </font>Y<font color="#000080">,
        </font>OldX                <font color="#000080">: </font>Byte<font color="#000080">;
        </font>I<font color="#000080">,
        </font>Increment        <font color="#000080">: </font>Integer<font color="#000080">;
        </font>Buf                        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>Hour<font color="#000080">,
        </font>Min<font color="#000080">,
        </font>Sec<font color="#000080">,
        </font>Sec100<font color="#000080">,
        </font>Status                <font color="#000080">: </font>Word<font color="#000080">;
        </font>Temp<font color="#000080">,
        </font>Pass                <font color="#000080">: </font>String79<font color="#000080">;
        </font>F1<font color="#000080">,
        </font>F2                        <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* EnCode *)
        </i></font>Pass <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#008000"><i>{$I-}
        </i></font>Assign<font color="#000080">(</font>F1<font color="#000080">, </font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);        </font><font color="#008000"><i>(* input file  *)
        </i></font>Assign<font color="#000080">(</font>F2<font color="#000080">, </font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);        </font><font color="#008000"><i>(* output file *)
        </i></font>Reset<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>CheckError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">'Couldn''t open input file.'</font><font color="#000080">);
        </font>ReWrite<font color="#000080">(</font>F2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t create output file.'</font><font color="#000080">);
        </font>Randomize<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Protect<font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>GetStr<font color="#000080">(</font>Pass<font color="#000080">,</font><font color="#800000">'(3 Char min, 25 Char max) Enter Password: '</font><font color="#000080">,</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>False<font color="#000080">);
                </font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Random<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">) );
                </font>BlockWrite<font color="#000080">(</font>F2<font color="#000080">,</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SizeOf<font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t write to output file.'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End Else
        Begin
                </b></font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Random<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">) + </font><font color="#800000">127</font><font color="#000080">);
                </font>BlockWrite<font color="#000080">(</font>F2<font color="#000080">,</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SizeOf<font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t write to output file.'</font><font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>Seed <font color="#000080">:= </font>Ord<font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font>Increment <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>PI <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>Y <font color="#000080">:= </font><font color="#800000">127</font><font color="#000080">;
    </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>ClrEOL<font color="#000080">;
        </font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
        </font>GraphIt<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>OldX<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">,</font>True<font color="#000080">);
        </font><font color="#FF0000"><b>Repeat
                </b></font>BlockRead<font color="#000080">(</font>F1<font color="#000080">, </font>Buf<font color="#000080">, </font>BufSize<font color="#000080">, </font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t read input file.'</font><font color="#000080">);
                </font>CheckAbort<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font>GraphIt<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>OldX<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">,</font>False<font color="#000080">);
                </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>BufSize <font color="#FF0000"><b>Do
                        Begin
                                If </b></font><font color="#000080">(</font>Protect<font color="#000080">) </font><font color="#FF0000"><b>Then
                                        Begin
                                                </b></font>Buf<font color="#000080">[</font>I<font color="#000080">] := </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font>Buf<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>XOR </b></font>Byte<font color="#000080">(</font>Pass<font color="#000080">[</font>PI<font color="#000080">]));
                                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PI <font color="#000080">= </font>Length<font color="#000080">(</font>Pass<font color="#000080">)) </font><font color="#FF0000"><b>Then </b></font>Increment <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
                                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PI <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Increment <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                                                </font>Inc<font color="#000080">(</font>PI<font color="#000080">,</font>Increment<font color="#000080">);
                                        </font><font color="#FF0000"><b>End
                                Else
                                        Begin
                                                </b></font>Buf<font color="#000080">[</font>I<font color="#000080">] := </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font>Buf<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>XOR </b></font>Y<font color="#000080">);
                                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>BlockWrite<font color="#000080">(</font>F2<font color="#000080">, </font>Buf<font color="#000080">, </font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t write to output file.'</font><font color="#000080">);
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Status <font color="#000080">&lt; </font>BufSize<font color="#000080">);
        </font>Close<font color="#000080">(</font>F1<font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t close input file.'</font><font color="#000080">);
        </font>Close<font color="#000080">(</font>F2<font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t close output file.'</font><font color="#000080">);
        </font><font color="#008000"><i>{$I+}
(* Successful Encryption *)
        </i></font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>Temp <font color="#000080">:= (</font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) +</font><font color="#800000">' Encoded to '</font><font color="#000080">+ </font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]));
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Protect<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Temp <font color="#000080">:= (</font>Temp <font color="#000080">+ </font><font color="#800000">' with Password.'</font><font color="#000080">);
        </font>Center<font color="#000080">(</font>WhereY<font color="#000080">,</font>Temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
        </font>WriteLn<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* EnCode *)

(*----
        Procedure DeCode();

        Author(s)        :        Mark Midgley
                                        Louis Zirkel

        Comments        :        Cool Man...

----*)

</i></font><font color="#FF0000"><b>Procedure </b></font>DeCode<font color="#000080">( </font>_File <font color="#000080">: </font>FilePaths <font color="#000080">);
</font><font color="#FF0000"><b>Var
        </b></font>Seed<font color="#000080">,
        </font>PI<font color="#000080">,
        </font>Y<font color="#000080">,
        </font>OldX                <font color="#000080">: </font>Byte<font color="#000080">;
        </font>I<font color="#000080">,
        </font>Increment        <font color="#000080">: </font>Integer<font color="#000080">;
        </font>Buf                        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BufSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>Hour<font color="#000080">,
        </font>Min<font color="#000080">,
        </font>Sec<font color="#000080">,
        </font>Sec100<font color="#000080">,
        </font>Status                <font color="#000080">: </font>Word<font color="#000080">;
        </font>Temp<font color="#000080">,
        </font>Pass                <font color="#000080">: </font>String79<font color="#000080">;
        </font>F1<font color="#000080">,
        </font>F2                        <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* DeCode *)
        </i></font>Pass <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#008000"><i>{$I-}
        </i></font>Assign<font color="#000080">(</font>F1<font color="#000080">, </font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font>Assign<font color="#000080">(</font>F2<font color="#000080">, </font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
        </font>Reset<font color="#000080">(</font>F1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>CheckError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">'Couldn''t open input file.'</font><font color="#000080">);
        </font>ReWrite<font color="#000080">(</font>F2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t create output file.'</font><font color="#000080">);
        </font>BlockRead<font color="#000080">(</font>F1<font color="#000080">,</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>SizeOf<font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font>Status<font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t read input file.'</font><font color="#000080">);
        </font>Seed <font color="#000080">:= </font>Ord<font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Buf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt; </font><font color="#800000">#127</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>(* There's a Password *)
                </i></font>GetStr<font color="#000080">(</font>Pass<font color="#000080">,</font><font color="#800000">'Enter Password: '</font><font color="#000080">,</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>False<font color="#000080">);
        </font>Increment <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>PI <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>Y <font color="#000080">:= </font><font color="#800000">127</font><font color="#000080">;
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>ClrEOL<font color="#000080">;
        </font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
        </font>GraphIt<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>OldX<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">,</font>True<font color="#000080">);
        </font><font color="#FF0000"><b>Repeat
                </b></font>BlockRead<font color="#000080">(</font>F1<font color="#000080">, </font>Buf<font color="#000080">, </font>BufSize<font color="#000080">, </font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t read input file.'</font><font color="#000080">);
                </font>GraphIt<font color="#000080">(</font>F1<font color="#000080">,</font>F2<font color="#000080">,</font>OldX<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">,</font>False<font color="#000080">);
                </font>CheckAbort<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>BufSize <font color="#FF0000"><b>Do
                        Begin
                                If </b></font><font color="#000080">(</font>Pass <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>(* There's a Password *)
                                        </i></font><font color="#FF0000"><b>Begin
                                                </b></font>Buf<font color="#000080">[</font>I<font color="#000080">] := </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font>Buf<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>XOR </b></font>Byte<font color="#000080">(</font>Pass<font color="#000080">[</font>PI<font color="#000080">]));
                                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PI <font color="#000080">= </font>Length<font color="#000080">(</font>Pass<font color="#000080">)) </font><font color="#FF0000"><b>Then </b></font>Increment <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
                                                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>PI <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Increment <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                                                </font>Inc<font color="#000080">(</font>PI<font color="#000080">,</font>Increment<font color="#000080">);
                                        </font><font color="#FF0000"><b>End
                                Else
                                        Begin
                                                </b></font>Buf<font color="#000080">[</font>I<font color="#000080">] := </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font>Buf<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>XOR </b></font>Y<font color="#000080">);
                                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>BlockWrite<font color="#000080">(</font>F2<font color="#000080">, </font>Buf<font color="#000080">, </font>Status<font color="#000080">);
                </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t write to output file.'</font><font color="#000080">);
        </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Status <font color="#000080">&lt; </font>BufSize<font color="#000080">);
        </font>Close<font color="#000080">(</font>F1<font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t close input file.'</font><font color="#000080">);
        </font>Close<font color="#000080">(</font>F2<font color="#000080">);
        </font>CheckError<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Couldn''t close output file.'</font><font color="#000080">);
        </font><font color="#008000"><i>{$I+}
(* Successful Decryption *)
        </i></font>Center<font color="#000080">(</font>WhereY<font color="#000080">,</font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) +</font><font color="#800000">' Decoded to '</font><font color="#000080">+ </font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]),</font><font color="#800000">1</font><font color="#000080">);
        </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
        </font>WriteLn<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* DeCode *)

</i></font><font color="#FF0000"><b>Procedure </b></font>CheckParameters<font color="#000080">;
</font><font color="#FF0000"><b>Var
        </b></font>_File        <font color="#000080">: </font>FilePaths<font color="#000080">;
        </font>Temp        <font color="#000080">: </font>String79<font color="#000080">;
        </font>Mode        <font color="#000080">: </font>EDMode<font color="#000080">;
        </font>OkMode<font color="#000080">,
        </font>Input1<font color="#000080">,
        </font>Input2        <font color="#000080">: </font>Boolean<font color="#000080">;
        </font>X                <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* CheckParameters *)
        </i></font><font color="#FF0000"><b>For </b></font>X <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">2 </font><font color="#FF0000"><b>Do </b></font>_File<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
        </font>Mode <font color="#000080">:= </font>EnCrypt<font color="#000080">;
        </font>OkMode <font color="#000080">:= </font>False<font color="#000080">;
        </font>X <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>X <font color="#000080">&lt;= </font>ParamCount<font color="#000080">) </font><font color="#FF0000"><b>Do
        Begin
                </b></font>Temp <font color="#000080">:= (</font>UpStr<font color="#000080">(</font>ParamStr<font color="#000080">(</font>x<font color="#000080">) ) );
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'?'</font><font color="#000080">,</font>Temp<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>Temp<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>HelpScreen<font color="#000080">(</font>True<font color="#000080">);
                </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">)) </font><font color="#FF0000"><b>And
                  </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Temp<font color="#000080">) = </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>OkMode<font color="#000080">) </font><font color="#FF0000"><b>Then
                Begin
                        Case </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>of
                                </b></font><font color="#800000">'E'        </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                                </b></font>Mode <font color="#000080">:= </font>EnCrypt<font color="#000080">;
                                                </font>OkMode <font color="#000080">:= </font>True<font color="#000080">;
                                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#800000">'D' </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                                </b></font>Mode <font color="#000080">:= </font>DeCrypt<font color="#000080">;
                                                </font>OkMode <font color="#000080">:= </font>True<font color="#000080">;
                                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#800000">'P' </font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                                                </b></font>Mode <font color="#000080">:= </font>EnCryptPass<font color="#000080">;
                                                </font>OkMode <font color="#000080">:= </font>True<font color="#000080">;
                                          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                </font><font color="#800000">'H'</font><font color="#000080">,
                                </font><font color="#800000">'?' </font><font color="#000080">: </font>HelpScreen<font color="#000080">(</font>True<font color="#000080">);
                                </font><font color="#FF0000"><b>Else
                                        </b></font>OkMode <font color="#000080">:= </font>False<font color="#000080">;
                        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
                </i></font><font color="#FF0000"><b>End Else
                Begin
                        If </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Temp <font color="#FF0000"><b>Else
                        If </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>Temp<font color="#000080">;
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                </font>Inc<font color="#000080">(</font>x<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>GetStr<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">'Enter Input Path/File : '</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>True<font color="#000080">);
                </font>Input1 <font color="#000080">:= </font>True<font color="#000080">;
                </font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := (</font>UpStr<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) );
        </font><font color="#FF0000"><b>End Else </b></font>Input1 <font color="#000080">:= </font>False<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>GetStr<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">'Enter Output Path/File : '</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>True<font color="#000080">);
                </font>Input2 <font color="#000080">:= </font>True<font color="#000080">;
                </font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := (</font>UpStr<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) );
        </font><font color="#FF0000"><b>End Else </b></font>Input2 <font color="#000080">:= </font>False<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'?'</font><font color="#000080">,</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) &gt; </font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>Then </b></font>HelpScreen<font color="#000080">(</font>True<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>OkMode<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">((</font>Input1<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Input2<font color="#000080">)) </font><font color="#FF0000"><b>And
           </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] &lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        Begin
                </b></font>WriteXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">,</font><font color="#800000">'[E]ncode, Encode with [P]assword, or [D]ecode? '</font><font color="#000080">);
                </font>ClrEOL<font color="#000080">;
                </font><font color="#FF0000"><b>Case </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">) ) </font><font color="#FF0000"><b>of
                        </b></font><font color="#800000">'E' </font><font color="#000080">: </font>Mode <font color="#000080">:= </font>EnCrypt<font color="#000080">;
                        </font><font color="#800000">'D' </font><font color="#000080">: </font>Mode <font color="#000080">:= </font>DeCrypt<font color="#000080">;
                        </font><font color="#800000">'P' </font><font color="#000080">: </font>Mode <font color="#000080">:= </font>EnCryptPass<font color="#000080">;
                        </font><font color="#800000">#27 </font><font color="#000080">: </font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
        </i></font><font color="#FF0000"><b>End Else If </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>HelpScreen<font color="#000080">(</font>False<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>ParamCount <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&gt; </font><font color="#800000">3</font><font color="#000080">)) </font><font color="#FF0000"><b>And
           </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not</b></font><font color="#000080">(</font>RealFile<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">2</font><font color="#000080">) ) ) </font><font color="#FF0000"><b>Then </b></font>OutError<font color="#000080">(</font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]),</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>RealFile<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">2</font><font color="#000080">) ) </font><font color="#FF0000"><b>Then
        Begin
                If </b></font><font color="#000080">(</font>FExpand<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) = </font>FExpand<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) ) </font><font color="#FF0000"><b>Then </b></font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                </font>TextColor<font color="#000080">(</font>Red<font color="#000080">);
                </font>WriteXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">,</font><font color="#800000">'Warning! &quot;'</font><font color="#000080">);
                </font>TextColor<font color="#000080">(</font>LightRed<font color="#000080">);
                </font>Write<font color="#000080">(</font>Shrink<font color="#000080">(</font>_File<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) );
                </font>TextColor<font color="#000080">(</font>Red<font color="#000080">);
                </font>Write<font color="#000080">(</font><font color="#800000">'&quot; already exists...Replace ([Y],N)? '</font><font color="#000080">);
                </font>ClrEOL<font color="#000080">;
                </font><font color="#FF0000"><b>Case </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">) ) </font><font color="#FF0000"><b>Of
                        </b></font><font color="#800000">'N'</font><font color="#000080">,</font><font color="#800000">#27 </font><font color="#000080">: </font>OutError<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Case *)
        </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Mode <font color="#000080">= </font>EnCryptPass<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>EnCode<font color="#000080">(</font>_File<font color="#000080">,</font>True<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Mode <font color="#000080">= </font>EnCrypt<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>EnCode<font color="#000080">(</font>_File<font color="#000080">,</font>False<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Mode <font color="#000080">= </font>DeCrypt<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>DeCode<font color="#000080">(</font>_File<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* CheckParameters *)

</i></font><font color="#FF0000"><b>Procedure </b></font>Main<font color="#000080">;
</font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* Main *)
        </i></font>CheckBreak <font color="#000080">:= </font>False<font color="#000080">;
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>WriteLn<font color="#000080">;
        </font>ClrEOL<font color="#000080">;
        </font>WriteXY<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">,</font>WhereY<font color="#000080">,</font><font color="#800000">'DOS file Encrypter v' </font><font color="#000080">+ </font>Version <font color="#000080">+ </font><font color="#800000">' by '</font><font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightBlue<font color="#000080">);
        </font>Write<font color="#000080">(</font><font color="#800000">'Zing Merway'</font><font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'  CODE/h for Help.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">;
        </font>CheckParameters<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Main *)

</i></font><font color="#FF0000"><b>Begin        </b></font><font color="#008000"><i>(* Code *)
        </i></font>Main<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.        </font><font color="#008000"><i>(* Code *)</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0015.PAS">Original</a><b>]</b></p></body>
</html>
