<html>
<head><title> "Store Hidden Text" by RICH VERAA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
            HIDESTR -- Rich Veraa's Anti-hack string hider.

                    Released to the Public Domaim
                          22 April, 1992
                        by Richard P. Veraa


INTRODUCTION

     The purpose of HIDESTR is to encrypt string variables in a Turbo
     Pascal &lt;tm&gt; program so that they will be hidden in the .EXE file
     and will make things a bit more difficult for hackers.

     HIDESTR reads an ASCII list of text strings used in the program and
     creates Turbo Pascal &lt;tm&gt; source code for a TPU unit that includes
     the strings encrypted as constant arrays of bytes. There is a
     decrypting procedure to be used at run time to return the decrypted
     strings as functions.

     To use HIDESTR, just

     1. list the text strings to be used by the program in a text file
     named LIST with numbered lines, as follows:

1   Myprog
2   Version 1.0
3   by John Doe
4   Enter velocity, mph:
5   Enter time of trip, hours:
6   The distance traveled is
7   miles.
8   Do you wish to go on [Y/n]?
9   Done
10  Thank you for using MYPROG

     2. Then write your program using str1, str2, str3, etc in place of
     the strings.

     4. Place the TPU name &quot;STRLIST&quot; in your &quot;uses&quot; statement. The
     following is code for a typical small program:

Program Myprog;
uses strlist;

var
   v, t, d : real;
   ch : char;

begin
   ch := 'y';
   writeln (srt1,' ',srt2);
   writeln(str3);
   writeln;
   while not ch in ['n','N'] do
      begin
         write(str4,' ');
         readln(v);
         write(str5,' ');
         readln(t);
         writeln;
         d := v * t;
         writeln(str6,' ',d);
      end;
   writeln;
   write(str8,' ');
   readln(ch);
   writeln;
   writeln(str9);
   writeln(str10);
end.


     5. Run HIDESTR in the same directory as the file LIST, with any
     valid longint on the command line. The longint is the key for
     encrypting the strings, and functions as randseed for the Turbo
     random number generator, whose output is added to the strings to
     encode them byte by byte;

     HIDESTR will generate TP source code for the STRLIST.TPU, which may
     be compiled with the program. The strings will appear in the
     resulting EXE file as arrays of random-appearing bytes.

     The encryption technique is admittedly crude, and you may wish to
     improve on it, but It would take a very determined hacker to take
     the trouble to unscramble this.

program hidestr;  {v 1.2}
{       By Richard Veraa                                        }
{       Villa Maria, Room 211                                   }
{       1050 NE 125 Street                                      }
{       N. Miami, FL  33161                                     }
{          released into the public domain, April 23, 1992      }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const
   </b></font>key <font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">1111111</font><font color="#000080">;       </font><font color="#008000"><i>{default encryption key}
                                   {change to any number}
</i></font><font color="#FF0000"><b>type
   </b></font>stringptr <font color="#000080">= ^</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>byteptr <font color="#000080">= ^</font>byte<font color="#000080">;
   </font>bytearray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>str <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>stringptr<font color="#000080">;
   </font>l <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byteptr<font color="#000080">;
   </font>th <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>boolean<font color="#000080">;
   </font>n <font color="#000080">: </font>integer<font color="#000080">;
   </font>ba <font color="#000080">: </font>bytearray<font color="#000080">;
   </font>i<font color="#000080">, </font>j <font color="#000080">: </font>integer<font color="#000080">;
   </font>f2 <font color="#000080">: </font>text<font color="#000080">;
   </font>spacecount <font color="#000080">: </font>integer<font color="#000080">;
   </font>x<font color="#000080">, </font>y <font color="#000080">: </font>byte<font color="#000080">;
   </font>keystring <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>code <font color="#000080">: </font>integer<font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>crypt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>b <font color="#000080">: </font>bytearray<font color="#000080">; </font>l <font color="#000080">: </font>byte<font color="#000080">);
    </font><font color="#008000"><i>{Add random number to each byte}
      </i></font><font color="#FF0000"><b>var
         </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
         </font>r <font color="#000080">: </font>byte<font color="#000080">;
         </font>save <font color="#000080">: </font>byte<font color="#000080">;
      </font><font color="#FF0000"><b>begin
         </b></font>randseed <font color="#000080">:= </font>key<font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l <font color="#FF0000"><b>do
            begin
               </b></font>r <font color="#000080">:= </font>random<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
               </font>b<font color="#000080">[</font>i<font color="#000080">] := </font>b<font color="#000080">[</font>i<font color="#000080">] + </font>r<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>decrypt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>b <font color="#000080">: </font>bytearray<font color="#000080">; </font>l <font color="#000080">: </font>byte<font color="#000080">);
    </font><font color="#008000"><i>{Subtract number from each byte}
      </i></font><font color="#FF0000"><b>var
         </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
         </font>r <font color="#000080">: </font>byte<font color="#000080">;
      </font><font color="#FF0000"><b>begin
         </b></font>randseed <font color="#000080">:= </font>key<font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l <font color="#FF0000"><b>do
            begin
               </b></font>r <font color="#000080">:= </font>random<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
               </font>b<font color="#000080">[</font>i<font color="#000080">] := </font>b<font color="#000080">[</font>i<font color="#000080">] - </font>r
            <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>readfile<font color="#000080">;
      </font><font color="#FF0000"><b>var
         </b></font>f <font color="#000080">: </font>text<font color="#000080">;
         </font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font>len<font color="#000080">, </font>i <font color="#000080">: </font>integer<font color="#000080">;
      </font><font color="#FF0000"><b>begin
         </b></font>n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>assign<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">'list'</font><font color="#000080">);
         </font>reset<font color="#000080">(</font>f<font color="#000080">);
         </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
            begin
               </b></font>inc<font color="#000080">(</font>n<font color="#000080">);
               </font>read<font color="#000080">(</font>f<font color="#000080">,</font>i<font color="#000080">);   </font><font color="#008000"><i>{read line number}
               </i></font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&lt;&gt; </font>n <font color="#FF0000"><b>then
                  begin
                     </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error in LIST.'</font><font color="#000080">);
                     </font>Writeln<font color="#000080">(</font><font color="#800000">'  -- Numbering incorrect at line '</font><font color="#000080">,</font>n<font color="#000080">);
                     </font>Writeln<font color="#000080">;
                     </font>Halt<font color="#000080">(</font>n<font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>readln<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">);      </font><font color="#008000"><i>{read string}
               </i></font><font color="#FF0000"><b>while </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font>chr<font color="#000080">( </font><font color="#800000">$20</font><font color="#000080">) </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{remove leading blanks}
                  </i></font><font color="#FF0000"><b>begin
                       </b></font>len <font color="#000080">:= </font>length<font color="#000080">(</font>s<font color="#000080">);
                       </font>dec<font color="#000080">(</font>len<font color="#000080">);
                       </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>len <font color="#FF0000"><b>do
                          </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>s<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
                       </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>len<font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>str<font color="#000080">[</font>n<font color="#000080">]^ := </font>s<font color="#000080">;
               </font>l<font color="#000080">[</font>n<font color="#000080">]^ := </font>length<font color="#000080">(</font>str<font color="#000080">[</font>n<font color="#000080">]^)
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>close<font color="#000080">(</font>f<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>var
   </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>clrscr<font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#800000">'Rich Veraa''s little string hider unit maker'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'Version 1.2'</font><font color="#000080">);

   </font>writeln<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then     </b></font><font color="#008000"><i>{check for key on command line}
      </i></font><font color="#FF0000"><b>begin
         </b></font>keystring <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
         </font>val<font color="#000080">(</font>keystring<font color="#000080">,</font>key<font color="#000080">,</font>code<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
            begin
               </b></font>writeln<font color="#000080">(</font><font color="#800000">'Parameter should be key in form longint'</font><font color="#000080">);
               </font>writeln<font color="#000080">(</font><font color="#800000">' * * * Parameter error '</font><font color="#000080">,</font>code<font color="#000080">,</font><font color="#800000">' * * * '</font><font color="#000080">);
               </font>writeln<font color="#000080">;
               </font>halt<font color="#000080">(</font>code<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>x <font color="#000080">:= </font>wherex<font color="#000080">;
   </font>y <font color="#000080">:= </font>wherey<font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{allocate memory}
      </i></font><font color="#FF0000"><b>begin
         </b></font>new<font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">]);
         </font>new<font color="#000080">(</font>l<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do    </b></font><font color="#008000"><i>{initialize}
      </i></font><font color="#FF0000"><b>begin
         </b></font>th<font color="#000080">[</font>i<font color="#000080">] := </font>false<font color="#000080">;
         </font>l<font color="#000080">[</font>i<font color="#000080">]^ := </font><font color="#800000">0</font><font color="#000080">;
         </font>str<font color="#000080">[</font>i<font color="#000080">]^ :=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>readfile<font color="#000080">;              </font><font color="#008000"><i>{read LIST}
   </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{set lengths for arrays to hold strings}
      </i></font><font color="#FF0000"><b>begin
         for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
            if </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ = </font>j <font color="#FF0000"><b>then </b></font>th<font color="#000080">[</font>j<font color="#000080">] := </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>assign<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'strlist.pas'</font><font color="#000080">);    </font><font color="#008000"><i>{write source code for strlist.pas}
   </i></font>rewrite<font color="#000080">(</font>f2<font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'unit strlist;'</font><font color="#000080">);

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'interface'</font><font color="#000080">);

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'type'</font><font color="#000080">);           </font><font color="#008000"><i>{type statement}
   </i></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   bytearray = array[1..255] of byte;'</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do          </b></font><font color="#008000"><i>{type arrays for encrypted strings}
   </i></font><font color="#FF0000"><b>if </b></font>th<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then  </b></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   t'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' = string['</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">'];'</font><font color="#000080">);

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'const'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'     n = '</font><font color="#000080">,</font>n<font color="#000080">,</font><font color="#800000">';'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   key = '</font><font color="#000080">,</font>key<font color="#000080">,</font><font color="#800000">';'</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do if </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ &gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      begin
        for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ </font><font color="#FF0000"><b>do      </b></font><font color="#008000"><i>{place string in array of byte}
           </i></font>ba<font color="#000080">[</font>j<font color="#000080">] := </font>ord<font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">]^[</font>j<font color="#000080">]);
         </font>crypt<font color="#000080">(</font>ba<font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^);           </font><font color="#008000"><i>{encrypt bytes in array}
         </i></font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
         </font>write<font color="#000080">(</font><font color="#800000">'Encrypted '</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' strings.'</font><font color="#000080">);
         </font>spacecount <font color="#000080">:= </font><font color="#800000">34</font><font color="#000080">;
         </font>write<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   cr'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' : array[1..'</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">'] of byte = ('</font><font color="#000080">);
         </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ </font><font color="#FF0000"><b>do     </b></font><font color="#008000"><i>{list array as constant in strlist.pas}
            </i></font><font color="#FF0000"><b>begin
               </b></font>write<font color="#000080">(</font>f2<font color="#000080">,</font>ba<font color="#000080">[</font>j<font color="#000080">]);
               </font>inc<font color="#000080">(</font>spacecount<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font>ba<font color="#000080">[</font>j<font color="#000080">] &gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>spacecount<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font>ba<font color="#000080">[</font>j<font color="#000080">] &gt; </font><font color="#800000">99 </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>spacecount<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>spacecount <font color="#000080">&gt; </font><font color="#800000">72</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>j <font color="#000080">&lt; </font>l<font color="#000080">[</font>i<font color="#000080">]^) </font><font color="#FF0000"><b>then
                  begin
                     </b></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">);
                     </font>write<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        '</font><font color="#000080">);
                     </font>spacecount <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
                  </font><font color="#FF0000"><b>end
                     else if </b></font>j <font color="#000080">&lt; </font>l<font color="#000080">[</font>i<font color="#000080">]^ </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{for j}
         </i></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">');'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{for i}
   </i></font>writeln<font color="#000080">;
   </font>writeln<font color="#000080">;
   </font>x <font color="#000080">:= </font>wherex<font color="#000080">;
   </font>y <font color="#000080">:= </font>wherey<font color="#000080">;

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   procedure decrypt(var b : bytearray; l : byte);'</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do if </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ &gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      begin
         </b></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   function str'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' : t'</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">';'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'implementation'</font><font color="#000080">);
                 </font><font color="#008000"><i>{write source code for decrypt procedure}

   </i></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   procedure decrypt(var b : bytearray; l : byte);'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   var'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      i : integer;'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      r : byte;'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   begin'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      randseed := key;'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      for i := 1 to l do'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'         begin'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'            r := random(255);'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'            b[i] := b[i] - r;'</font><font color="#000080">);

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'         end;'</font><font color="#000080">);
   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   end;'</font><font color="#000080">);

   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do if </b></font>l<font color="#000080">[</font>i<font color="#000080">]^ &gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      begin
          </b></font><font color="#008000"><i>{write source code for function to return string}
         </i></font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'   function str'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' : t'</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">';'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      var'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'         ba : bytearray;'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'         j : integer;'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'         s : string;'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      begin'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        for j := 1 to '</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">' do'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'          ba[j] := cr'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">'[j];'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        decrypt(ba, '</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">');'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        for j := 1 to '</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">' do'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'          s[j] := chr(ba[j]);'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        s[0] := chr('</font><font color="#000080">,</font>l<font color="#000080">[</font>i<font color="#000080">]^,</font><font color="#800000">');'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'        str'</font><font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">' := s;'</font><font color="#000080">);
         </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'      end;'</font><font color="#000080">);
         </font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
         </font>write<font color="#000080">(</font><font color="#800000">'String functions coded: '</font><font color="#000080">,</font>i<font color="#000080">);

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>gotoxy<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">);
   </font>writeln<font color="#000080">;
   </font>writeln<font color="#000080">;

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'begin'</font><font color="#000080">);

   </font>writeln<font color="#000080">(</font>f2<font color="#000080">,</font><font color="#800000">'end.'</font><font color="#000080">);
   </font>close<font color="#000080">(</font>f2<font color="#000080">);
   </font>writeln<font color="#000080">(</font><font color="#800000">'DONE'</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do      </b></font><font color="#008000"><i>{dispose}
      </i></font><font color="#FF0000"><b>begin
         </b></font>dispose<font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">]);
         </font>dispose<font color="#000080">(</font>l<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>writeln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
