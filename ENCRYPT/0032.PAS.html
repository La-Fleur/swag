<html>
<head><title> "Encrypt Message in EXE" by SALVATORE MESCHINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>EncryptMessageInsideExe<font color="#000080">;

</font><font color="#008000"><i>{This stupid program is useful to encrypt copyright messages into executables.
 Use: Run this program
      Input message and xor value
      Write encrypted string and xor value on a sheet
      If you declare the encrypted string as a var(string)/const you can
      decrypt it on-the-fly using XorIT with the same xor value
      In this way hackers (the lamest ones) can't see/modify your string}
{Author: Salvatore Meschini - E-Mail: smeschini@ermes.it - WWW:
         http://www.ermes.it/pws/mesk . Please report bugs and suggestions}
{This program if FREE, use it copy it think me :) }

</i></font><font color="#FF0000"><b>uses </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">,</font>xs<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>i<font color="#000080">,</font>xv<font color="#000080">,</font>c<font color="#000080">:</font>word<font color="#000080">;
    </font>f<font color="#000080">:</font>text<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>XORIT<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
   </b></font>xs<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>c<font color="#000080">:=</font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font>xv<font color="#000080">;
      </font>xs<font color="#000080">:=</font>xs<font color="#000080">+</font>chr<font color="#000080">(</font>c<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>xorit<font color="#000080">:=</font>xs<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>clrscr<font color="#000080">;
     </font>write<font color="#000080">(</font><font color="#800000">'Input string: '</font><font color="#000080">);
     </font>readln<font color="#000080">(</font>s<font color="#000080">);
     </font>write<font color="#000080">(</font><font color="#800000">'Input XOR Value: '</font><font color="#000080">);</font><font color="#008000"><i>{Low values creates plain ASCII strings}
     </i></font>readln<font color="#000080">(</font>xv<font color="#000080">);
     </font>clrscr<font color="#000080">;
     </font>writeln<font color="#000080">(</font>S<font color="#000080">);
     </font>writeln<font color="#000080">(</font>xorit<font color="#000080">(</font>s<font color="#000080">));
     </font>writeln<font color="#000080">(</font>xorit<font color="#000080">(</font>xs<font color="#000080">));  </font><font color="#008000"><i>{Safe Check}
     </i></font>writeln<font color="#000080">;
     </font><font color="#FF0000"><b>asm </b></font><font color="#008000"><i>{Turns cursor off}
        </i></font><font color="#FF00FF">XOR   ax,ax
        MOV   ax,$0100;
        MOV   cx,$2607;
        INT   $10
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#008000"><i>{IMPORTANT:}
     </i></font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin   </b></font><font color="#008000"><i>{If parameter isn't null  you will have the encrypted
               message in a file, so ... cut and paste in your source (see
below)!}
         </i></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));          </font><font color="#008000"><i>{^^^^^^^^^^^^}
         </i></font>rewrite<font color="#000080">(</font>f<font color="#000080">);
         </font>write<font color="#000080">(</font>f<font color="#000080">,</font>xorit<font color="#000080">(</font>s<font color="#000080">));
         </font>close<font color="#000080">(</font>f<font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>write<font color="#000080">(</font><font color="#800000">'Now you can declare
''');textcolor(lightred);write(xorit(s));textcolor(7);
     </font>write<font color="#000080">(</font><font color="#800000">''' as a const and decrypt it in execution time with xorit!
</font><font color="#000080">(</font>Remember XORVALUE<font color="#000080">=</font><font color="#800000">');
     </font>textcolor<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);</font>write<font color="#000080">(</font>xv<font color="#000080">);</font>textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);</font>writeln<font color="#000080">(</font><font color="#800000">')'</font><font color="#000080">);</font>writeln<font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'I saved '</font><font color="#000080">,</font>xorit<font color="#000080">(</font>S<font color="#000080">),</font><font color="#800000">' in
');textcolor(10);writeln(paramstr(1));
     </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{Example -------------------------------------------------------- Example}

</i></font><font color="#FF0000"><b>Program </b></font>Demo<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>hiddenmessage<font color="#000080">=</font><font color="#800000">'-F,%Vdisdqjw`%H`vfmlkl'</font><font color="#000080">; </font><font color="#008000"><i>{&lt;- This is equal to:
                                             '(C) Salvatore Meschini' XORed
                                                 by 5}
      </i></font>xorvalue<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;               </font><font color="#008000"><i>{You can use your message and xorvalue}

</i></font><font color="#FF0000"><b>Function </b></font>XORIT<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>xs<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>xv<font color="#000080">,</font>i<font color="#000080">,</font>c<font color="#000080">:</font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   </b></font>xs<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;

   </font>xv<font color="#000080">:=</font>xorvalue<font color="#000080">;  </font><font color="#008000"><i>{&lt;-- xv:=5}

   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      </b></font>c<font color="#000080">:=</font>ord<font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font>xv<font color="#000080">;
      </font>xs<font color="#000080">:=</font>xs<font color="#000080">+</font>chr<font color="#000080">(</font>c<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>xorit<font color="#000080">:=</font>xs<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin

</b></font>writeln<font color="#000080">(</font>xorit<font color="#000080">(</font>hiddenmessage<font color="#000080">)); </font><font color="#008000"><i>{You DON'T HAVE (C) Salvatore Meschini in .exe
                                but you CAN display it!!!}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
