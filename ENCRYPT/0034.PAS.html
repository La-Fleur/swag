<html>
<head><title> "Encryption/Decryption Engine" by SALVATORE MESCHINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Hi Gayle<font color="#000080">, </font>I have this contribution <font color="#FF0000"><b>for </b></font>SWAG Archives<font color="#000080">. 
</font>This source <font color="#FF0000"><b>is </b></font>an easy<font color="#000080">-</font><font color="#FF0000"><b>to</b></font><font color="#000080">-</font>use <font color="#000080">(</font>I hope<font color="#000080">) </font>encoding<font color="#000080">/</font>decoding engine <font color="#000080">(</font>it
includes a demo<font color="#000080">).

</font><font color="#FF0000"><b>Unit </b></font>EncDec<font color="#000080">;

</font><font color="#008000"><i>{EncDec is copyrighted by Salvatore Meschini - FREEWARE -
Salvatore Meschini - smeschini@ermes.it - http://www.ermes.it/pws/mesk
Please report: bugs,suggestions,comments to the address above}

{Use this code at your own risk! I'm not responsible if it cause any
damages!!!}

{Usage: The procedure ENCODE will encrypt with PASSWORD the BUFFERIN (that is
        long BYTESTOENCODE bytes) in BUFFEROUT.
        The procedure DECODE will decrypt with PASSWORD the BUFFERIN (blah
blah)
        in BUFFEROUT.}

{Tips : I suggest you to encode the PASSWORD too! (if you don't know how to do
       it, feel free to contact me). In the encoding process, BUFFERIN is
       plain data that will be encrypted in BUFFEROUT. In the decoding
process,
       BUFFERIN is the encrypted data that will be decrypted in BUFFEROUT.}


{I included a DEMO, check it...}

</i></font><font color="#FF0000"><b>interface

type </b></font>BufType<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8192</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Encode<font color="#000080">(</font>password<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>bytestoencode<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var
</b></font>bufferIN<font color="#000080">,</font>BufferOUT<font color="#000080">:</font>bufType<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Decode<font color="#000080">(</font>password<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font><font color="#FF0000"><b>var </b></font>bytestodecode<font color="#000080">:</font>integer<font color="#000080">;</font><font color="#FF0000"><b>var
</b></font>bufferIN<font color="#000080">,</font>BufferOUT<font color="#000080">:</font>bufType<font color="#000080">);

</font><font color="#008000"><i>(*--------------------------------------------------------------------------
--*)
</i></font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>(*--------------------------------------------------------------------------
--*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ENCODE<font color="#000080">(</font>PASSWORD<font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>BYTESTOENCODE<font color="#000080">: </font>INTEGER<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>BUFFERIN<font color="#000080">,
                 </font>BUFFEROUT<font color="#000080">: </font>BUFTYPE<font color="#000080">);

  </font><font color="#FF0000"><b>VAR
    </b></font>INB<font color="#000080">, </font>OUTB<font color="#000080">, </font>LP<font color="#000080">: </font>BYTE<font color="#000080">;
    </font>K<font color="#000080">:</font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>K <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>LP <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font>K <font color="#000080">&lt; </font>BYTESTOENCODE <font color="#FF0000"><b>DO
      BEGIN
        </b></font>INC<font color="#000080">(</font>K<font color="#000080">);
        </font>INB <font color="#000080">:= </font>ORD<font color="#000080">(</font>BUFFERIN<font color="#000080">[</font>K<font color="#000080">]);
        </font>OUTB <font color="#000080">:= </font>INB <font color="#000080">+ </font>K<font color="#000080">;
        </font>OUTB <font color="#000080">:= </font>OUTB <font color="#FF0000"><b>XOR </b></font>ORD<font color="#000080">(</font>PASSWORD<font color="#000080">[</font>LP<font color="#000080">]);
        </font>BUFFEROUT<font color="#000080">[</font>K<font color="#000080">] := </font>CHR<font color="#000080">(</font>OUTB<font color="#000080">);
        </font>INC<font color="#000080">(</font>LP<font color="#000080">);

        </font><font color="#FF0000"><b>IF </b></font>LP <font color="#000080">&gt; </font>LENGTH<font color="#000080">(</font>PASSWORD<font color="#000080">)
          </font><font color="#FF0000"><b>THEN
            </b></font>LP <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(*--------------------------------------------------------------------------
--*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>DECODE<font color="#000080">(</font>PASSWORD<font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>BYTESTODECODE<font color="#000080">: </font>INTEGER<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>BUFFERIN<font color="#000080">,
                 </font>BUFFEROUT<font color="#000080">: </font>BUFTYPE<font color="#000080">);

  </font><font color="#FF0000"><b>VAR
    </b></font>INB<font color="#000080">, </font>OUTB<font color="#000080">,</font>LP<font color="#000080">: </font>BYTE<font color="#000080">;
    </font>K<font color="#000080">:</font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>BEGIN
    </b></font>K <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>LP <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font>K <font color="#000080">&lt; </font>BYTESTODECODE <font color="#FF0000"><b>DO
      BEGIN
        </b></font>INC<font color="#000080">(</font>K<font color="#000080">);
        </font>INB <font color="#000080">:= </font>ORD<font color="#000080">(</font>BUFFERIN<font color="#000080">[</font>K<font color="#000080">]);
        </font>OUTB <font color="#000080">:= </font>INB <font color="#FF0000"><b>XOR </b></font>ORD<font color="#000080">(</font>PASSWORD<font color="#000080">[</font>LP<font color="#000080">]);
        </font>OUTB <font color="#000080">:= </font>OUTB <font color="#000080">- </font>K<font color="#000080">;
        </font>BUFFEROUT<font color="#000080">[</font>K<font color="#000080">] := </font>CHR<font color="#000080">(</font>OUTB<font color="#000080">);
        </font>INC<font color="#000080">(</font>LP<font color="#000080">);

        </font><font color="#FF0000"><b>IF </b></font>LP <font color="#000080">&gt; </font>LENGTH<font color="#000080">(</font>PASSWORD<font color="#000080">)
          </font><font color="#FF0000"><b>THEN
            </b></font>LP <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(*--------------------------------------------------------------------------
--*)
</i></font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font>ses EncDec<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>inf<font color="#000080">,</font>outf<font color="#000080">,</font>testf<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#008000"><i>{Files used for this DEMO}
    </i></font>bufferIN<font color="#000080">,</font>BufferOUT<font color="#000080">:</font>BufType<font color="#000080">;
    </font>count<font color="#000080">,</font>result<font color="#000080">:</font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>assign<font color="#000080">(</font>inf<font color="#000080">,</font><font color="#800000">'encdec.pas'</font><font color="#000080">); </font><font color="#008000"><i>{Source File}
</i></font>reset<font color="#000080">(</font>inf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font>assign<font color="#000080">(</font>outf<font color="#000080">,</font><font color="#800000">'encdec.enc'</font><font color="#000080">); </font><font color="#008000"><i>{Target File}
</i></font>rewrite<font color="#000080">(</font>outf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>inf<font color="#000080">) </font><font color="#FF0000"><b>do      </b></font><font color="#008000"><i>{Encoding cycle}
 </i></font><font color="#FF0000"><b>begin
   </b></font>blockread<font color="#000080">(</font>inf<font color="#000080">,</font>bufferin<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">,</font>count<font color="#000080">);
   </font>encode<font color="#000080">(</font><font color="#800000">'Hello World!'</font><font color="#000080">,</font>count<font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">);
   </font>blockwrite<font color="#000080">(</font>outf<font color="#000080">,</font>bufferout<font color="#000080">,</font>count<font color="#000080">,</font>result<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>close<font color="#000080">(</font>inf<font color="#000080">);</font>close<font color="#000080">(</font>outf<font color="#000080">);
</font>assign<font color="#000080">(</font>outf<font color="#000080">,</font><font color="#800000">'encdec.enc'</font><font color="#000080">); </font><font color="#008000"><i>{I will try to decode what I encoded...}
</i></font>reset<font color="#000080">(</font>outf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font>assign<font color="#000080">(</font>testf<font color="#000080">,</font><font color="#800000">'encdec.bak'</font><font color="#000080">); </font><font color="#008000"><i>{...so encdec.bak should be equal to encdec.pas}
</i></font>rewrite<font color="#000080">(</font>testf<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>outf<font color="#000080">) </font><font color="#FF0000"><b>do       </b></font><font color="#008000"><i>{Decoding cycle}
   </i></font><font color="#FF0000"><b>begin
   </b></font>blockread<font color="#000080">(</font>outf<font color="#000080">,</font>bufferin<font color="#000080">,</font><font color="#800000">8192</font><font color="#000080">,</font>count<font color="#000080">);
   </font>decode<font color="#000080">(</font><font color="#800000">'Hello World!'</font><font color="#000080">,</font>count<font color="#000080">,</font>bufferin<font color="#000080">,</font>bufferout<font color="#000080">);
   </font>blockwrite<font color="#000080">(</font>testf<font color="#000080">,</font>bufferOUT<font color="#000080">,</font>count<font color="#000080">,</font>result<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>close<font color="#000080">(</font>testf<font color="#000080">);</font>close<font color="#000080">(</font>outf<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.



</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
