<html>
<head><title> "Criptation code" by EMIDIO SPINOGATTI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I want to let you see a program I made to criptate binary and
text files... it just traslate ALL THE FILE of a bit to right,
then adds the old extension to the start of the file, followed by
a (eof) #26... try it and tell me what do you think!

I you have something to suggest... i'm here!... for example how
to add a password to coded files, how to increase the speed of
the program and so on...

Sorry for my english :-) }

</i></font><font color="#FF0000"><b>program </b></font>NCode<font color="#000080">;

</font><font color="#008000"><i>{FREEWARE! 1996, Emidio Spinogatti (2:335/622.18@fidonet)}

</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>f1<font color="#000080">, </font>f2<font color="#000080">: </font><font color="#FF0000"><b>file of </b></font>byte<font color="#000080">;
  </font>DirInfo<font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>P<font color="#000080">: </font>PathStr<font color="#000080">;
  </font>D<font color="#000080">: </font>DirStr<font color="#000080">;
  </font>N<font color="#000080">: </font>NameStr<font color="#000080">;
  </font>E<font color="#000080">: </font>ExtStr<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>code<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>eofile<font color="#000080">:</font>byte<font color="#000080">=</font><font color="#800000">26</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>b<font color="#000080">, </font>LByte<font color="#000080">, </font>SByte<font color="#000080">: </font>byte<font color="#000080">;
  </font>ctrl_bit<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'CODIFICA IN CORSO...'</font><font color="#000080">);
  </font>assign<font color="#000080">(</font>f1<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)); </font>assign<font color="#000080">(</font>f2<font color="#000080">, </font>n<font color="#000080">+</font><font color="#800000">'.cod'</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>f1<font color="#000080">); </font>rewrite<font color="#000080">(</font>f2<font color="#000080">);
  </font>b<font color="#000080">:=</font>ord<font color="#000080">(</font>e<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]); </font>LByte<font color="#000080">:=</font>ord<font color="#000080">(</font>e<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]); </font>SByte<font color="#000080">:=</font>ord<font color="#000080">(</font>e<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
  </font>write<font color="#000080">(</font>f2<font color="#000080">, </font>b<font color="#000080">, </font>LByte<font color="#000080">, </font>SByte<font color="#000080">, </font>eofile<font color="#000080">); </font><font color="#008000"><i>{INTESTAZIONE DEL FILE}

  {LEGGE L'ULTIMO BIT E LO SALVA IN CTRL_BIT} </i></font>seek<font color="#000080">(</font>f1<font color="#000080">, </font>filesize<font color="#000080">(</font>f1<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
  </font>read<font color="#000080">(</font>f1<font color="#000080">, </font>b<font color="#000080">); </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>b <font color="#FF0000"><b>or </b></font><font color="#800000">1</font><font color="#000080">) = </font>b<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>ctrl_bit<font color="#000080">:=</font>true
                                 <font color="#FF0000"><b>else </b></font>ctrl_bit<font color="#000080">:=</font>false<font color="#000080">;

  </font><font color="#008000"><i>{TORNA ALL'INIZIO DEL FILE} </i></font>seek<font color="#000080">(</font>f1<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

  </font><font color="#FF0000"><b>repeat
    </b></font>write<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">, </font>round<font color="#000080">((</font>filepos<font color="#000080">(</font>f1<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">)/</font>filesize<font color="#000080">(</font>f1<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">), </font><font color="#800000">'%'</font><font color="#000080">);
    </font>read<font color="#000080">(</font>f1<font color="#000080">, </font>LByte<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>ctrl_bit <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font><font color="#800000">128
                </font><font color="#FF0000"><b>else </b></font>SByte<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">128</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">064</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">064</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">032</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">032</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">016</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">016</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">008</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">008</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">004</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">004</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">002</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">002</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">001</font><font color="#000080">;

    </font>write<font color="#000080">(</font>f2<font color="#000080">, </font>SByte<font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">1</font><font color="#000080">) = </font>LByte<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>ctrl_bit<font color="#000080">:=</font>true
                              <font color="#FF0000"><b>else </b></font>ctrl_bit<font color="#000080">:=</font>false<font color="#000080">;

  </font><font color="#FF0000"><b>until </b></font>eof<font color="#000080">(</font>f1<font color="#000080">);

  </font>close<font color="#000080">(</font>f2<font color="#000080">); </font>close<font color="#000080">(</font>f1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>decode<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Hold_Bit<font color="#000080">, </font>Ctrl_Bit<font color="#000080">: </font>boolean<font color="#000080">;
  </font>LByte<font color="#000080">, </font>b<font color="#000080">, </font>SByte<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>writeln<font color="#000080">(</font><font color="#800000">'DECODIFICA IN CORSO...'</font><font color="#000080">);

  </font>assign<font color="#000080">(</font>f1<font color="#000080">, </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)); </font>reset<font color="#000080">(</font>f1<font color="#000080">);

  </font>read<font color="#000080">(</font>f1<font color="#000080">, </font>LByte<font color="#000080">, </font>b<font color="#000080">, </font>SByte<font color="#000080">); </font><font color="#008000"><i>{LETTURA INTESTAZIONE DEL FILE}
  </i></font>e<font color="#000080">:=</font><font color="#800000">'.'</font><font color="#000080">+</font>chr<font color="#000080">(</font>LByte<font color="#000080">)+</font>chr<font color="#000080">(</font>b<font color="#000080">)+</font>chr<font color="#000080">(</font>SByte<font color="#000080">);
  </font>assign<font color="#000080">(</font>f2<font color="#000080">, </font>n<font color="#000080">+</font>e<font color="#000080">); </font>rewrite<font color="#000080">(</font>f2<font color="#000080">);

  </font>read<font color="#000080">(</font>f1<font color="#000080">, </font>LByte<font color="#000080">); </font><font color="#008000"><i>{LETTURA EOF 4&oslash; CARATTERE}

  </i></font>read<font color="#000080">(</font>f1<font color="#000080">, </font>LByte<font color="#000080">); </font><font color="#008000"><i>{PRIMO BYTE &quot;SIGNIFICATIVO&quot;}

  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">128</font><font color="#000080">)=</font>LByte<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Hold_Bit<font color="#000080">:=</font>true <font color="#008000"><i>{&quot;CONSERVA&quot; IL PRIMO BIT}
                            </i></font><font color="#FF0000"><b>else </b></font>Hold_Bit<font color="#000080">:=</font>false<font color="#000080">;
  </font>SByte<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>eof<font color="#000080">(</font>f1<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>write<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">, </font>round<font color="#000080">((</font>filepos<font color="#000080">(</font>f1<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">)/</font>filesize<font color="#000080">(</font>f1<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">), </font><font color="#800000">'%'</font><font color="#000080">);
    </font>read<font color="#000080">(</font>f1<font color="#000080">, </font>b<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>b <font color="#FF0000"><b>or </b></font><font color="#800000">128</font><font color="#000080">)=</font>b<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Ctrl_Bit<font color="#000080">:=</font>true   <font color="#008000"><i>{CONSERVA IL PRIMO BIT DEL BYTE}
                      </i></font><font color="#FF0000"><b>else </b></font>Ctrl_Bit<font color="#000080">:=</font>false<font color="#000080">; </font><font color="#008000"><i>{SUCCESSIVO}

    </i></font><font color="#FF0000"><b>if </b></font>Ctrl_Bit             <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">001</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">001</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">002</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">002</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">004</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">004</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">008</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">008</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">016</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">016</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">032</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">032</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">064</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">064</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">128</font><font color="#000080">;

    </font>write<font color="#000080">(</font>f2<font color="#000080">, </font>SByte<font color="#000080">);
    </font>LByte<font color="#000080">:=</font>b<font color="#000080">;
    </font>SByte<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font>Hold_Bit             <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font><font color="#800000">001</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">001</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">002</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">002</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">004</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">004</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">008</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">008</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">016</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">016</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">032</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">032</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">064</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LByte <font color="#FF0000"><b>or </b></font><font color="#800000">064</font><font color="#000080">)=</font>LByte <font color="#FF0000"><b>then </b></font>SByte<font color="#000080">:=</font>SByte<font color="#000080">+</font><font color="#800000">128</font><font color="#000080">;
    </font>write<font color="#000080">(</font>f2<font color="#000080">, </font>SByte<font color="#000080">);

  </font>close<font color="#000080">(</font>f1<font color="#000080">); </font>close<font color="#000080">(</font>f2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>guida<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">#13#10</font><font color="#000080">,
          </font><font color="#800000">'Questo programma serve a codificare file binari e di testo.'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">#13#10</font><font color="#000080">,
          </font><font color="#800000">' (Codifica)  NCODE &lt;filename.estensione&gt;'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'(Decodifica) NCODE &lt;filename&gt;.COD'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FileExists<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Boolean function that returns True if the file exists;otherwise,
 it returns False. Closes the file if it exists. }
</i></font><font color="#FF0000"><b>var
 </b></font>F<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$I-}
 </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
 </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ Set file access to read only }
 </i></font>Reset<font color="#000080">(</font>F<font color="#000080">);
 </font>Close<font color="#000080">(</font>F<font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font>FileExists <font color="#000080">:= (</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>FileName <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FileExists }

</i></font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'NCode 1.0 - Nogat Software 1996'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>paramcount<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then begin </b></font>guida<font color="#000080">; </font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{CONTROLLO} </i></font><font color="#FF0000"><b>if not </b></font>FileExists<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then begin
                                                  </b></font>writeln<font color="#000080">(</font><font color="#800000">'File inesistente.'</font><font color="#000080">);
                                                  </font>exit
                                                  <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FindFirst<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">); </font><font color="#008000"><i>{ Same as DIR *.PAS }
    </i></font>fsplit<font color="#000080">(</font>dirinfo<font color="#000080">.</font>name<font color="#000080">, </font>d<font color="#000080">, </font>n<font color="#000080">, </font>e<font color="#000080">);
  </font><font color="#008000"><i>{CONTROLLO} </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>e<font color="#000080">=</font><font color="#800000">'.COD'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>e<font color="#000080">=</font><font color="#800000">'.cod'</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>decode
                                            <font color="#FF0000"><b>else </b></font>code<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
