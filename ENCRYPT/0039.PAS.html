<html>
<head><title> "Encrypt important values in games etc." by EMIL MIKULIC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0039.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>cheat<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>crt<font color="#000080">;

</font><font color="#FF0000"><b>type </b></font>PValue<font color="#000080">=^</font>TValue<font color="#000080">;
     </font>TValue<font color="#000080">=</font><font color="#FF0000"><b>object
       </b></font><font color="#008000"><i>{ Encrypted value }
       </i></font>value<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Unsigned key }
       </i></font>key<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Signed key }
       </i></font>key2<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Init }
       </i></font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>v<font color="#000080">:</font>integer<font color="#000080">);
       </font><font color="#008000"><i>{ Done }
       </i></font><font color="#FF0000"><b>destructor </b></font>done<font color="#000080">;
       </font><font color="#008000"><i>{ Get value }
       </i></font><font color="#FF0000"><b>function </b></font>get<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Set value }
       </i></font><font color="#FF0000"><b>procedure </b></font>put<font color="#000080">(</font>x<font color="#000080">:</font>integer<font color="#000080">);
       </font><font color="#008000"><i>{ Re-encrypt }
       </i></font><font color="#FF0000"><b>procedure </b></font>encrypt<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

constructor </b></font>TValue<font color="#000080">.</font>init<font color="#000080">(</font>v<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Set value }
 </i></font>value<font color="#000080">:=</font>v<font color="#000080">;
 </font><font color="#008000"><i>{ No key }
 </i></font>key<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#008000"><i>{ No key }
 </i></font>key2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font><font color="#008000"><i>{ Encrypt }
 </i></font>encrypt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TValue<font color="#000080">.</font>done<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Nothing to dispose of }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TValue<font color="#000080">.</font>get<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Decrypt value and store temporarily }
 </i></font>temp<font color="#000080">:=</font>value <font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>key <font color="#FF0000"><b>xor </b></font>key2<font color="#000080">);
 </font><font color="#008000"><i>{ Re-encrypt }
 </i></font>encrypt<font color="#000080">;
 </font><font color="#008000"><i>{ Return value }
 </i></font>get<font color="#000080">:=</font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TValue<font color="#000080">.</font>put<font color="#000080">(</font>x<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Set new value }
 </i></font>value<font color="#000080">:=</font>x <font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>key <font color="#FF0000"><b>xor </b></font>key2<font color="#000080">);
 </font><font color="#008000"><i>{ Re-encrypt }
 </i></font>encrypt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TValue<font color="#000080">.</font>encrypt<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>temp<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{ Decode }
 </i></font>temp<font color="#000080">:=</font>value <font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>key <font color="#FF0000"><b>xor </b></font>key2<font color="#000080">);
 </font><font color="#008000"><i>{ Random unsigned key }
 </i></font>key<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">32000</font><font color="#000080">);
 </font><font color="#008000"><i>{ Random signed key }
 </i></font>key2<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">64000</font><font color="#000080">)-</font><font color="#800000">32000</font><font color="#000080">;
 </font><font color="#008000"><i>{ Encrypt }
 </i></font>value<font color="#000080">:=</font>temp <font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>key <font color="#FF0000"><b>xor </b></font>key2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{ ------------------  CUT  -------------------}

</i></font>CHEAT
<font color="#FF0000"><b>Unit </b></font>Documentation

by Emil Mikulic

CHEAT <font color="#FF0000"><b>is </b></font>a something that I<font color="#800000">'ve been trying to get around to for
</font>quite a <font color="#FF0000"><b>while</b></font><font color="#000080">. </font>It<font color="#800000">'s a simple, reasonably fool-proof anti-cheat measure.
</font>It <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to </b></font>encrypt important values <font color="#FF0000"><b>in </b></font>games <font color="#FF0000"><b>or </b></font>programs from
pesky memory<font color="#000080">-</font>meddling programs <font color="#FF0000"><b>and </b></font>Cheat Makers <font color="#000080">(</font>i<font color="#000080">.</font>e<font color="#000080">. </font>GW<font color="#000080">).

</font>Here<font color="#800000">'s the definition of the PValue object:

</font><font color="#FF0000"><b>type </b></font>PValue<font color="#000080">=^</font>TValue<font color="#000080">;
     </font>TValue<font color="#000080">=</font><font color="#FF0000"><b>object
       </b></font><font color="#008000"><i>{ Encrypted value }
       </i></font>value<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Unsigned key }
       </i></font>key<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Signed key }
       </i></font>key2<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Init }
       </i></font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>v<font color="#000080">:</font>integer<font color="#000080">);
       </font><font color="#008000"><i>{ Done }
       </i></font><font color="#FF0000"><b>destructor </b></font>done<font color="#000080">;
       </font><font color="#008000"><i>{ Get value }
       </i></font><font color="#FF0000"><b>function </b></font>get<font color="#000080">:</font>integer<font color="#000080">;
       </font><font color="#008000"><i>{ Set value }
       </i></font><font color="#FF0000"><b>procedure </b></font>put<font color="#000080">(</font>x<font color="#000080">:</font>integer<font color="#000080">);
       </font><font color="#008000"><i>{ Re-encrypt }
       </i></font><font color="#FF0000"><b>procedure </b></font>encrypt<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>You use TValue<font color="#000080">.</font>Init <font color="#FF0000"><b>to </b></font>initialise a value<font color="#000080">.
</font>Here<font color="#800000">'s an example:

</font><font color="#FF0000"><b>var </b></font>money<font color="#000080">,</font>lives<font color="#000080">:</font>PValue<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>money<font color="#000080">:=</font>new<font color="#000080">(</font>PValue<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)); </font><font color="#008000"><i>{ Give player a hundred bucks }

 </i></font><font color="#000080">...


</font>You don<font color="#800000">'t need to use TValue.Done when disposing of your PValue
</font>because it doesn<font color="#800000">'t have anything to dismantle.

</font><font color="#FF0000"><b>To </b></font>get the decrypted the value<font color="#000080">, </font>use TValue<font color="#000080">.</font>Get <font color="#000080">- </font>ex<font color="#000080">:

 ...

 </font>writeln<font color="#000080">(</font><font color="#800000">'You have exactly '</font><font color="#000080">,</font>money<font color="#000080">^.</font>Get<font color="#000080">,</font><font color="#800000">' bucks on you.'</font><font color="#000080">);

 ...

</font><font color="#FF0000"><b>To set </b></font>the value use TValue<font color="#000080">.</font>put <font color="#000080">- </font>ex<font color="#000080">:

 ...

 </font>writeln<font color="#000080">(</font><font color="#800000">'Sold for $20'</font><font color="#000080">);
 </font>money<font color="#000080">^.</font>Put<font color="#000080">(</font>Money<font color="#000080">^.</font>Get<font color="#000080">-</font><font color="#800000">20</font><font color="#000080">);
 
 ...

</font><font color="#FF0000"><b>If </b></font>you want more control<font color="#000080">, </font>you can use TValue<font color="#000080">.</font>Encrypt <font color="#FF0000"><b>to
</b></font>re<font color="#000080">-</font>encrypt the data<font color="#000080">, </font>the value remains but the encrypted value
<font color="#FF0000"><b>and </b></font>the keys change<font color="#000080">.

</font>That<font color="#800000">'s it.
</font>Emil Mikulic<font color="#000080">, </font><font color="#800000">1997.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0039.PAS">Original</a><b>]</b></p></body>
</html>
