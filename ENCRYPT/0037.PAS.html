<html>
<head><title> "Base64 coding (RFC 1521)" by HENDRIK T. VOELKER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>UNIT </b></font>base64<font color="#000080">;

 </font><font color="#008000"><i>{
   Copyright (c) 1996 Hendrik T. Voelker &lt;basicbaer@emcom.doo.donut.de&gt;

   Base64-Kodierung nach RFC 1521
 }

 </i></font><font color="#FF0000"><b>INTERFACE </b></font><font color="#008000"><i>{ ************************************************************** }

   </i></font><font color="#FF0000"><b>TYPE
     </b></font>tripel_at          <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF
                            </b></font>Byte<font color="#000080">;

     </font>quadrupel_at       <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF
                            </b></font>Byte<font color="#000080">;

   </font><font color="#FF0000"><b>FUNCTION </b></font>codeb64
           <font color="#000080">( </font>cnt        <font color="#000080">: </font>Byte<font color="#000080">;
             </font>t          <font color="#000080">: </font>tripel_at <font color="#000080">)
           : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>decodeb64
            <font color="#000080">(     </font>strg  <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>VAR </b></font>cnt   <font color="#000080">: </font>Byte<font color="#000080">;
              </font><font color="#FF0000"><b>VAR </b></font>t     <font color="#000080">: </font>tripel_at <font color="#000080">);

 </font><font color="#FF0000"><b>IMPLEMENTATION </b></font><font color="#008000"><i>{ ********************************************************* }

   </i></font><font color="#FF0000"><b>CONST
     </b></font>padd               <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;

     </font>code64             <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">65</font><font color="#000080">]
                            = </font><font color="#800000">'ABCDEFGHIJKLMNOPQRSTUVWXYZ' </font><font color="#000080">+
                              </font><font color="#800000">'abcdefghijklmnopqrstuvwxyz' </font><font color="#000080">+
                              </font><font color="#800000">'0123456789+/='</font><font color="#000080">;

   </font><font color="#FF0000"><b>FUNCTION </b></font>codeb64<font color="#000080">;

     </font><font color="#FF0000"><b>VAR        </b></font><font color="#008000"><i>{ *codeb64* }
       </i></font>q                <font color="#000080">: </font>quadrupel_at<font color="#000080">;
       </font>strg             <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
       </font>idx              <font color="#000080">: </font>Byte<font color="#000080">;

     </font><font color="#FF0000"><b>BEGIN      </b></font><font color="#008000"><i>{ *codeb64* }
       </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>cnt <font color="#000080">&lt; </font><font color="#800000">3</font><font color="#000080">)
         </font><font color="#FF0000"><b>THEN BEGIN
                </b></font>t<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
                </font>q<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font>padd<font color="#000080">;
              </font><font color="#FF0000"><b>END
         ELSE </b></font>q<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := (</font>t<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3f</font><font color="#000080">);

       </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>cnt <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">)
         </font><font color="#FF0000"><b>THEN BEGIN
                </b></font>t<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
                </font>q<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>padd<font color="#000080">;
              </font><font color="#FF0000"><b>END
         ELSE </b></font>q<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>Byte <font color="#000080">(((</font>t<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>t<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">6</font><font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3f</font><font color="#000080">);

       </font>q<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>Byte <font color="#000080">(((</font>t<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>t<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3f</font><font color="#000080">);

       </font>q<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := ((</font>t<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3f</font><font color="#000080">);

       </font>strg <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
       </font><font color="#FF0000"><b>FOR </b></font>idx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
         </b></font>strg <font color="#000080">:= (</font>strg <font color="#000080">+ </font>code64<font color="#000080">[(</font>q<font color="#000080">[</font>idx<font color="#000080">] + </font><font color="#800000">1</font><font color="#000080">)]);

       </font>codeb64 <font color="#000080">:= </font>strg<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;       </font><font color="#008000"><i>{ *codeb64* }

   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>decodeb64<font color="#000080">;

     </font><font color="#FF0000"><b>VAR        </b></font><font color="#008000"><i>{ *decodeb64* }
       </i></font>idx              <font color="#000080">: </font>Byte<font color="#000080">;
       </font>q                <font color="#000080">: </font>quadrupel_at<font color="#000080">;

     </font><font color="#FF0000"><b>BEGIN      </b></font><font color="#008000"><i>{ *decodeb64* }
       </i></font>cnt <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;

       </font><font color="#FF0000"><b>FOR </b></font>idx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
         BEGIN
           </b></font>q<font color="#000080">[</font>idx<font color="#000080">] := (</font>Pos <font color="#000080">(</font>strg<font color="#000080">[</font>idx<font color="#000080">], </font>code64<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>q<font color="#000080">[</font>idx<font color="#000080">] = </font>padd<font color="#000080">)
             </font><font color="#FF0000"><b>THEN </b></font>Dec <font color="#000080">(</font>cnt<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

       </font>t<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>Byte <font color="#000080">((</font>q<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>q<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$03</font><font color="#000080">));
       </font>t<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>Byte <font color="#000080">((</font>q<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>q<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0f</font><font color="#000080">));
       </font>t<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>Byte <font color="#000080">((</font>q<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">6</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>q<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$3f</font><font color="#000080">));
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;       </font><font color="#008000"><i>{ *decodeb64* }

 { INITIALIZATION ********************************************************* }

   </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ENCRYPT SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p></body>
</html>
