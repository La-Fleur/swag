<html>
<head><title> "Fast Boyer-Moore Search" by RUFUS HENDON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ BOYERMO2.PAS (23 January 1988) (Rufus S. Hendon) }

{    This Unit provides facilities For searching a Text For a target using
  the Boyer-Moore search method.  The routine is based on Don Strenczewilk's
  Implementation of a Variant form of the Boyer-Moore method (his case-
  insensitive version B1, available on CompuServe in File BLINE.ARC in
  Borland BPROGA Data Library 4, uploaded 21 August 1987).  In addition to
  repackaging his routine as a Turbo Pascal 4.0 Unit, I have modified it
  (1) to provide protection against endless loops that in the original
  version can arise due to wrap-around of the index used to scan the Text
  when the the length of the Text approaches the maximum (65521 Characters)
  allowed by Turbo Pascal 4.0 For Arrays of Type Char and (2) to improve
  efficiency slightly by removing three instructions (a PUSH, a MOV, and a
  POP) from the comparison loop.
     The Text to be searched must be stored in an Array of Type Char or an
  equivalent user-defined Type.  The lower bound of the Array must be 1.
  The target For which the Text is to be searched must be of Type String.
  The Program must also provide a Variable For the storage of the shift
  table used by the Boyer-Moore method when it searches the Text.  This
  Variable must provide 256 Bytes of storage; it can, For example, be a
  Variable of Type Array[Char] of Byte.  The target Variable and the shift-
  table Variable must be in the same segment:  they must both be global
  Variables (located in the data segment) or both local Variables (stored
  in the stack segment).
     Whenever the Text is to be searched For a new target, the Program must
  call MAKE_BOYER_MOORE_TABLE to create the shift table For the target.
  Thereafter the Text can be searched For the target by invoking
  BOYER_MOORE_SEARCH, specifying as arguments the target and its shift
  table as well as the position in the Text where the search is to begin.
  if the Program maintains multiple target Variables and a separate shift
  table and starting-position Variable For each target, searches for
  occurrences of the Various targets can be underway simultaneously.
     In a call to BOYER_MOORE_SEARCH, the argument associated With the
  parameter START determines the position in the Text With which the search
  begins.  To search the entire Text, the Function would be invoked With
  START = 1.  The Function scans the Text beginning from the START position
  For the first subString that matches the target specified by the Variable
  associated With the parameter TARGET, using the shift table stored in the
  Variable associated With the parameter TABLE.  if such a subString is
  found, the Function returns the position (Array subscript) of the initial
  Character of the matching subString; since the Array is required to have
  1 as its lower bound, the position returned after a successful search
  will always be greater than 0.  if the Function fails to find a matching
  subString, it returns 0.  (if the requirement that the TARGET and TABLE
  Variables be in the same segment is violated, the Function also returns
  0.)
     When it is required that all occurrences in the Text of a given target
  be found, BOYER_MOORE_SEARCH would be invoked in a loop, in which the
  START argument would initially have the value of 1; thereafter, after
  every successful search, the START argument would be reset to the
  position returned by the Function plus 1.  The loop would terminate when
  the Function reported failure.  The loop would have a general structure
  similar to this:

    item := [the target String];
    make_Boyer_Moore_table(item,shift_table);
    scan_beginning := 1;
    search_Text_length := length(search_Text);
    Repeat
      i := Boyer_Moore_search(search_Text,scan_beginning,search_Text_length,
          item,shift_table);
      if i &gt; 0 then begin
        [do whatever processing is required when the search is successful];
        scan_beginning := i+1
      end
    Until i = 0

     Note that if the Text Array can only be referred to by means of a
  Pointer, as will be the Case if the Array is allocated in the heap by
  means of the NEW Procedure, the Pointer, when used as the first argument
  of BOYER_MOORE_SEARCH, must be dereferenced by writing '^' after it.  If,
  For example, TextPTR is a Pointer to the Text Array, the call to the
  search Function in the loop just given would take this form:

      i := Boyer_Moore_search(Textptr^,scan_beginning,search_Text_length,
          item,shift_table);
                                                                             }
{============================================================================}
</i></font><font color="#FF0000"><b>Unit </b></font>BOYERMO2<font color="#000080">;
</font><font color="#008000"><i>{============================================================================}
</i></font><font color="#FF0000"><b>Interface

Procedure </b></font>MAKE_BOYER_MOORE_TABLE<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>target<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">);
</font><font color="#008000"><i>{ TARGET is the target String For which a Text is to be searched.  The
  shift table For the target String is Constructed in TABLE, which must be
  a Variable providing 256 Bytes of storage, e.g. a Variable declared as
  Array[Char] of Byte. }

</i></font><font color="#FF0000"><b>Function </b></font>BOYER_MOORE_SEARCH<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Text_Array<font color="#000080">; </font>start<font color="#000080">, </font>Text_length<font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>target<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Text_Array is an Array of Characters in which a Text is stored; the
  Text begins in Text_Array[1] and is Text_LENGTH Characters long.  TARGET
  must either be the same Variable used as parameter TARGET in an earlier
  call to MAKE_BOYER_MOORE_TABLE or another Variable With the same value.
  TABLE must be the Variable that was used as parameter TABLE in the same
  call to MAKE_BOYER_MOORE_TABLE.  TARGET and TABLE must be in the same
  segment, i.e. they must both be global Variables or both local Variables.
  A Boyer-Moore search is performed on the Text in Text_Array, beginning
  With the Character in position START and using shift table TABLE, for
  the first subString that matches TARGET.  if a match is found, the
  position of the first Character of the matching subString is returned.
  Otherwise 0 is returned.  A Function value of 0 is also returned if TABLE
  and TARGET are not in the same segment. }
{============================================================================}
</i></font><font color="#FF0000"><b>Implementation

Const
  </b></font>copy<font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>table<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Char<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>MAKE_BOYER_MOORE_TABLE<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>target<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">);
</font><font color="#008000"><i>{ TARGET is the target String For which a Text is to be searched.  The
  shift table For the target String is Constructed in TABLE, which must be
  a Variable providing 256 Bytes of storage, e.g. a Variable declared as
  Array[Char] of Byte. }
</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ MAKE_BOYER_MOORE_TABLE }
  </i></font><font color="#FF0000"><b>Inline
    </b></font><font color="#000080">(</font><font color="#800000">$1E</font><font color="#000080">/              </font><font color="#008000"><i>{       push ds            }
     </i></font><font color="#800000">$C5</font><font color="#000080">/</font><font color="#800000">$76</font><font color="#000080">/&lt;</font>target<font color="#000080">/  </font><font color="#008000"><i>{       lds si,[bp+target] }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$F3</font><font color="#000080">/          </font><font color="#008000"><i>{       mov bx,si          }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$04</font><font color="#000080">/          </font><font color="#008000"><i>{       mov al, [si]       }
     </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$C4</font><font color="#000080">/          </font><font color="#008000"><i>{       mov ah,al          }
     </i></font><font color="#800000">$B9</font><font color="#000080">/</font><font color="#800000">$80</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/      </font><font color="#008000"><i>{       mov cx,$0080       }
     </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/&lt;</font>table<font color="#000080">/   </font><font color="#008000"><i>{       les di,[bp+table]  }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$FA</font><font color="#000080">/          </font><font color="#008000"><i>{       mov dx,di          }
     </i></font><font color="#800000">$FC</font><font color="#000080">/              </font><font color="#008000"><i>{       cld                }
     </i></font><font color="#800000">$F2</font><font color="#000080">/</font><font color="#800000">$AB</font><font color="#000080">/          </font><font color="#008000"><i>{       rep stosw          }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$DE</font><font color="#000080">/          </font><font color="#008000"><i>{       mov si,bx          }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$D7</font><font color="#000080">/          </font><font color="#008000"><i>{       mov di,dx          }
     </i></font><font color="#800000">$46</font><font color="#000080">/              </font><font color="#008000"><i>{       inc si             }
     </i></font><font color="#800000">$98</font><font color="#000080">/              </font><font color="#008000"><i>{       cbw                }
     </i></font><font color="#800000">$3C</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/          </font><font color="#008000"><i>{       cmp al,1           }
     </i></font><font color="#800000">$7E</font><font color="#000080">/</font><font color="#800000">$13</font><font color="#000080">/          </font><font color="#008000"><i>{       jle done           }
     </i></font><font color="#800000">$48</font><font color="#000080">/              </font><font color="#008000"><i>{       dec ax             }
     </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$E1</font><font color="#000080">/          </font><font color="#008000"><i>{       mov cl,ah          }
     </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$E7</font><font color="#000080">/          </font><font color="#008000"><i>{       mov bh,ah          }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$1C</font><font color="#000080">/          </font><font color="#008000"><i>{ next: mov bl,[si]        }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$C2</font><font color="#000080">/          </font><font color="#008000"><i>{       mov dx,ax          }
     </i></font><font color="#800000">$29</font><font color="#000080">/</font><font color="#800000">$CA</font><font color="#000080">/          </font><font color="#008000"><i>{       sub dx,cx          }
     </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/          </font><font color="#008000"><i>{       mov [bx+di],dl     }
     </i></font><font color="#800000">$46</font><font color="#000080">/              </font><font color="#008000"><i>{       inc si             }
     </i></font><font color="#800000">$41</font><font color="#000080">/              </font><font color="#008000"><i>{       inc cx             }
     </i></font><font color="#800000">$39</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/          </font><font color="#008000"><i>{       cmp cx,ax          }
     </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$F2</font><font color="#000080">/          </font><font color="#008000"><i>{       jne next           }
     </i></font><font color="#800000">$1F</font><font color="#000080">)              </font><font color="#008000"><i>{ done: pop ds             }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ MAKE_BOYER_MOORE_TABLE }

{****************************************************************************}
</i></font><font color="#FF0000"><b>Function </b></font>BOYER_MOORE_SEARCH<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Text_Array<font color="#000080">; </font>start<font color="#000080">, </font>Text_length<font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>Var </b></font>target<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#008000"><i>{ Text_Array is an Array of Characters in which a Text is stored; the
  Text begins in Text_Array[1] and is Text_LENGTH Characters long.  TARGET
  must either be the same Variable used as parameter TARGET in an earlier
  call to MAKE_BOYER_MOORE_TABLE or another Variable With the same value.
  TABLE must be the Variable that was used as parameter TABLE in the same
  call to MAKE_BOYER_MOORE_TABLE.  TARGET and TABLE must be in the same
  segment, i.e. they must both be global Variables or both local Variables.
  A Boyer-Moore search is performed on the Text in Text_Array, beginning
  With the Character in position START and using shift table TABLE, for
  the first subString that matches TARGET.  if a match is found, the
  position of the first Character of the matching subString is returned.
  Otherwise 0 is returned.  A Function value of 0 is also returned if TABLE
  and TARGET are not in the same segment. }
</i></font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{ BOYER_MOORE_SEARCH }
  </i></font><font color="#FF0000"><b>Inline
    </b></font><font color="#000080">(</font><font color="#800000">$1E</font><font color="#000080">/                  </font><font color="#008000"><i>{            push ds                 }
     </i></font><font color="#800000">$33</font><font color="#000080">/</font><font color="#800000">$C0</font><font color="#000080">/              </font><font color="#008000"><i>{            xor ax,ax               }
     </i></font><font color="#800000">$C5</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/&lt;</font>table<font color="#000080">/       </font><font color="#008000"><i>{            lds bx,[bp+table]   } { if TABLE and  }
     </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$D9</font><font color="#000080">/              </font><font color="#008000"><i>{            mov cx,ds           } { TARGET are in }
     </i></font><font color="#800000">$C5</font><font color="#000080">/</font><font color="#800000">$76</font><font color="#000080">/&lt;</font>target<font color="#000080">/      </font><font color="#008000"><i>{            lds si,[bp+target]  } { different     }
     </i></font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$DA</font><font color="#000080">/              </font><font color="#008000"><i>{            mov dx,ds           } { segments, re- }
     </i></font><font color="#800000">$3B</font><font color="#000080">/</font><font color="#800000">$D1</font><font color="#000080">/              </font><font color="#008000"><i>{            cmp dx,cx           } { port failure  }
     </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$76</font><font color="#000080">/              </font><font color="#008000"><i>{            jne notfound2       } { at once       }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$F4</font><font color="#000080">/              </font><font color="#008000"><i>{            mov dh,ah               }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$14</font><font color="#000080">/              </font><font color="#008000"><i>{            mov dl,[si]             }
     </i></font><font color="#800000">$80</font><font color="#000080">/</font><font color="#800000">$FA</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/          </font><font color="#008000"><i>{            cmp dl,1                }
     </i></font><font color="#800000">$7F</font><font color="#000080">/</font><font color="#800000">$1F</font><font color="#000080">/              </font><font color="#008000"><i>{            jg boyer                }
     </i></font><font color="#800000">$7C</font><font color="#000080">/</font><font color="#800000">$6B</font><font color="#000080">/              </font><font color="#008000"><i>{            jl notfound2            }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$44</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/          </font><font color="#008000"><i>{            mov al,[si+1]           }
     </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$56</font><font color="#000080">/&lt;</font>start<font color="#000080">/       </font><font color="#008000"><i>{            mov dx,[bp+start]       }
     </i></font><font color="#800000">$4A</font><font color="#000080">/                  </font><font color="#008000"><i>{            dec dx                  }
     </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$4E</font><font color="#000080">/&lt;</font>Text_length<font color="#000080">/ </font><font color="#008000"><i>{            mov cx,[bp+Text_length] }
     </i></font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$CA</font><font color="#000080">/              </font><font color="#008000"><i>{            sub cx,dx               }
     </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/&lt;</font>Text_Array<font color="#000080">/  </font><font color="#008000"><i>{            les di,[bp+Text_Array]  }
     </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$DF</font><font color="#000080">/              </font><font color="#008000"><i>{            mov bx,di               }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$FA</font><font color="#000080">/              </font><font color="#008000"><i>{            add di,dx               }
     </i></font><font color="#800000">$FC</font><font color="#000080">/                  </font><font color="#008000"><i>{            cld                     }
     </i></font><font color="#800000">$F2</font><font color="#000080">/</font><font color="#800000">$AE</font><font color="#000080">/              </font><font color="#008000"><i>{            repne scasb             }
     </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$53</font><font color="#000080">/              </font><font color="#008000"><i>{            jne notfound2           }
     </i></font><font color="#800000">$97</font><font color="#000080">/                  </font><font color="#008000"><i>{            xchg ax,di              }
     </i></font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$C3</font><font color="#000080">/              </font><font color="#008000"><i>{            sub ax,bx               }
     </i></font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$50</font><font color="#000080">/              </font><font color="#008000"><i>{            jmp short Exit          }
     </i></font><font color="#800000">$FE</font><font color="#000080">/</font><font color="#800000">$CA</font><font color="#000080">/              </font><font color="#008000"><i>{ boyer:     dec dl                  }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$F2</font><font color="#000080">/              </font><font color="#008000"><i>{            add si,dx               }
     </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/&lt;</font>Text_Array<font color="#000080">/  </font><font color="#008000"><i>{            les di,[bp+Text_Array]  }
     </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$CF</font><font color="#000080">/              </font><font color="#008000"><i>{            mov cx,di               }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$4E</font><font color="#000080">/&lt;</font>Text_length<font color="#000080">/ </font><font color="#008000"><i>{            add cx,[bp+Text_length] }
     </i></font><font color="#800000">$49</font><font color="#000080">/                  </font><font color="#008000"><i>{            dec cx                  }
     </i></font><font color="#800000">$4F</font><font color="#000080">/                  </font><font color="#008000"><i>{            dec di                  }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$7E</font><font color="#000080">/&lt;</font>start<font color="#000080">/       </font><font color="#008000"><i>{            add di,[bp+start]       }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$FA</font><font color="#000080">/              </font><font color="#008000"><i>{            add di,dx               }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$74</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/          </font><font color="#008000"><i>{            mov dh,[si+1]           }
     </i></font><font color="#800000">$55</font><font color="#000080">/                  </font><font color="#008000"><i>{            push bp                 }
     </i></font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$E9</font><font color="#000080">/              </font><font color="#008000"><i>{            mov bp,cx               }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$EC</font><font color="#000080">/              </font><font color="#008000"><i>{            mov ch,ah               }
     </i></font><font color="#800000">$FD</font><font color="#000080">/                  </font><font color="#008000"><i>{            std                     }
     </i></font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$05</font><font color="#000080">/              </font><font color="#008000"><i>{            jmp short comp          }
     </i></font><font color="#800000">$D7</font><font color="#000080">/                  </font><font color="#008000"><i>{ nexttable: xlat                    }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$F8</font><font color="#000080">/              </font><font color="#008000"><i>{            add di,ax               }
     </i></font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$2A</font><font color="#000080">/              </font><font color="#008000"><i>{            jc notfound             }
     </i></font><font color="#800000">$3B</font><font color="#000080">/</font><font color="#800000">$EF</font><font color="#000080">/              </font><font color="#008000"><i>{ comp:      cmp bp,di               }
     </i></font><font color="#800000">$72</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/              </font><font color="#008000"><i>{            jb notfound             }
     </i></font><font color="#800000">$26</font><font color="#000080">/</font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$05</font><font color="#000080">/          </font><font color="#008000"><i>{            mov al,es:[di]          }
     </i></font><font color="#800000">$3A</font><font color="#000080">/</font><font color="#800000">$F0</font><font color="#000080">/              </font><font color="#008000"><i>{            cmp dh,al               }
     </i></font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$F0</font><font color="#000080">/              </font><font color="#008000"><i>{            jne nexttable           }
     </i></font><font color="#800000">$4F</font><font color="#000080">/                  </font><font color="#008000"><i>{            dec di                  }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$CA</font><font color="#000080">/              </font><font color="#008000"><i>{            mov cl,dl               }
     </i></font><font color="#800000">$F3</font><font color="#000080">/</font><font color="#800000">$A6</font><font color="#000080">/              </font><font color="#008000"><i>{            repe cmpsb              }
     </i></font><font color="#800000">$74</font><font color="#000080">/</font><font color="#800000">$0D</font><font color="#000080">/              </font><font color="#008000"><i>{            je found                }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$C2</font><font color="#000080">/              </font><font color="#008000"><i>{            mov al,dl               }
     </i></font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$C1</font><font color="#000080">/              </font><font color="#008000"><i>{            sub ax,cx               }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$F8</font><font color="#000080">/              </font><font color="#008000"><i>{            add di,ax               }
     </i></font><font color="#800000">$47</font><font color="#000080">/                  </font><font color="#008000"><i>{            inc di                  }
     </i></font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$F0</font><font color="#000080">/              </font><font color="#008000"><i>{            add si,ax               }
     </i></font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$C6</font><font color="#000080">/              </font><font color="#008000"><i>{            mov al,dh               }
     </i></font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$DC</font><font color="#000080">/              </font><font color="#008000"><i>{            jmp short nexttable     }
     </i></font><font color="#800000">$5D</font><font color="#000080">/                  </font><font color="#008000"><i>{ found:     pop bp                  }
     </i></font><font color="#800000">$C4</font><font color="#000080">/</font><font color="#800000">$46</font><font color="#000080">/&lt;</font>Text_Array<font color="#000080">/  </font><font color="#008000"><i>{            les ax,[bp+Text_Array]  }
     </i></font><font color="#800000">$97</font><font color="#000080">/                  </font><font color="#008000"><i>{            xchg ax,di              }
     </i></font><font color="#800000">$2B</font><font color="#000080">/</font><font color="#800000">$C7</font><font color="#000080">/              </font><font color="#008000"><i>{            sub ax,di               }
     </i></font><font color="#800000">$40</font><font color="#000080">/                  </font><font color="#008000"><i>{            inc ax                  }
     </i></font><font color="#800000">$40</font><font color="#000080">/                  </font><font color="#008000"><i>{            inc ax                  }
     </i></font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/              </font><font color="#008000"><i>{            jmp short Exit          }
     </i></font><font color="#800000">$5D</font><font color="#000080">/                  </font><font color="#008000"><i>{ notfound:  pop bp                  }
     </i></font><font color="#800000">$32</font><font color="#000080">/</font><font color="#800000">$C0</font><font color="#000080">/              </font><font color="#008000"><i>{ notfound2: xor al,al               }
     </i></font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$46</font><font color="#000080">/</font><font color="#800000">$FE</font><font color="#000080">/          </font><font color="#008000"><i>{ Exit:      mov [bp-2],ax           }
     </i></font><font color="#800000">$FC</font><font color="#000080">/                  </font><font color="#008000"><i>{            cld                     }
     </i></font><font color="#800000">$1F</font><font color="#000080">)                  </font><font color="#008000"><i>{            pop ds                  }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ BOYER_MOORE_SEARCH }
{****************************************************************************}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
