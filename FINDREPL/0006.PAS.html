<html>
<head><title> "FINDDATA.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{   Following is some code I've thrown together &lt;!&gt;, which has to find a
sequence of 4 Characters in a large buffer - non-Text data.  The buffer
is 4096 Characters, and the sequence(s) I'm searching For could be
anywhere in it, and may be found numerous times. I suspect this code is
pretty inefficient, but I can't think of anything better. (Yep, this is
to work With the ZIP directory at the end of the File...)
   So, I'm looking For a better way to code this process.  I know that
Pos won't work, so this brute-Force is what I came up with.  Anything
better?  Thanks...
}
</i></font><font color="#FF0000"><b>Const </b></font>CFHS <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'PK'#01#02</font><font color="#000080">;  </font><font color="#008000"><i>{ CENTRAL_File_HEADER_SIGNATURE }
      </i></font>ECDS <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'PK'#05#06</font><font color="#000080">; </font><font color="#008000"><i>{ end_CENTRAL_DIRECtoRY_SIGNATURE }
</i></font><font color="#FF0000"><b>Var </b></font>S4     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>FOUND  <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>QUIT   <font color="#000080">: </font>Boolean<font color="#000080">;      </font><font color="#008000"><i>{ &quot;end&quot; sentinel encountered }
</i></font><font color="#FF0000"><b>begin
  </b></font>FETCH_NAME<font color="#000080">; </font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>F1<font color="#000080">); </font>Reset <font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>C <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>HSize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FSize <font color="#000080">:= </font>FileSize<font color="#000080">(</font>F<font color="#000080">);
  </font>I <font color="#000080">:= </font>FSize<font color="#000080">-</font>BSize<font color="#000080">;                   </font><font color="#008000"><i>{ Compute point to start read }
  </i></font>Seek <font color="#000080">(</font>F<font color="#000080">,</font>I<font color="#000080">); </font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BUFF<font color="#000080">,</font>BSize<font color="#000080">,</font>RES<font color="#000080">); </font><font color="#008000"><i>{ ZIP central directory }
  </i></font>S4<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#4</font><font color="#000080">; </font>C <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>FOUND <font color="#000080">:= </font>False<font color="#000080">; </font><font color="#008000"><i>{ search For CENTRAL_File_HEADER_SIGNATURE }
    </i></font><font color="#FF0000"><b>Repeat
      </b></font>Inc <font color="#000080">(</font>C<font color="#000080">); </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font>C<font color="#000080">],</font>S4<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">4</font><font color="#000080">); </font>FOUND <font color="#000080">:= </font>S4 <font color="#000080">= </font>CFHS<font color="#000080">;
      </font>QUIT <font color="#000080">:= </font>S4 <font color="#000080">= </font>ECDS<font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>FOUND <font color="#FF0000"><b>or </b></font>QUIT<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
