<html>
<head><title> "BOYER.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">              <font color="#008000"><i>(* Public-domain demo of Boyer-Moore search algorithm.  *)
              (* Guy McLoughlin - May 2, 1993.                        *)
</i></font><font color="#FF0000"><b>program </b></font>DemoBMSearch<font color="#000080">;


              </font><font color="#008000"><i>(* Boyer-Moore index-table data definition.             *)
</i></font><font color="#FF0000"><b>type
  </b></font>BMTable  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;


  </font><font color="#008000"><i>(***** Create a Boyer-Moore index-table to search with.             *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>procedure </b></font>Create_BMTable<font color="#000080">(</font><font color="#008000"><i>{output} </i></font><font color="#FF0000"><b>var       </b></font>BMT <font color="#000080">: </font>BMTable<font color="#000080">;
                           </font><font color="#008000"><i>{input }       </i></font>Pattern <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                                        </font>ExactCase <font color="#000080">: </font>boolean<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>Index <font color="#000080">: </font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>BMT<font color="#000080">, </font>sizeof<font color="#000080">(</font>BMT<font color="#000080">), </font>length<font color="#000080">(</font>Pattern<font color="#000080">));
    </font><font color="#FF0000"><b>if NOT </b></font>ExactCase <font color="#FF0000"><b>then
      for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Pattern<font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>Pattern<font color="#000080">[</font>Index<font color="#000080">] := </font>upcase<font color="#000080">(</font>Pattern<font color="#000080">[</font>Index<font color="#000080">]);
    </font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Pattern<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>BMT<font color="#000080">[</font>ord<font color="#000080">(</font>Pattern<font color="#000080">[</font>Index<font color="#000080">])] := (</font>length<font color="#000080">(</font>Pattern<font color="#000080">) - </font>Index<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Create_BMTable.                                      *)


  (***** Boyer-Moore Search function. Returns 0 if string is not      *)
  (*     found. Returns 65,535 if BufferSize is too large.            *)
  (*     ie: Greater than 65,520 bytes.                               *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>function </b></font>BMsearch<font color="#000080">(</font><font color="#008000"><i>{input } </i></font><font color="#FF0000"><b>var </b></font>BMT       <font color="#000080">: </font>BMTable<font color="#000080">;
                             </font><font color="#FF0000"><b>var </b></font>Buffer<font color="#000080">;
                                 </font>BuffSize  <font color="#000080">: </font>word<font color="#000080">;
                                 </font>Pattern   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                                 </font>ExactCase <font color="#000080">: </font>boolean<font color="#000080">) : </font><font color="#008000"><i>{output} </i></font>word<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>Buffer2 <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65520</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#FF0000"><b>absolute </b></font>Buffer<font color="#000080">;
    </font>Index1<font color="#000080">,
    </font>Index2<font color="#000080">,
    </font>PatSize <font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>BuffSize <font color="#000080">&gt; </font><font color="#800000">65520</font><font color="#000080">)  </font><font color="#FF0000"><b>then
      begin
        </b></font>BMsearch <font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;
        </font>exit
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>PatSize <font color="#000080">:= </font>length<font color="#000080">(</font>Pattern<font color="#000080">);
    </font><font color="#FF0000"><b>if NOT </b></font>ExactCase <font color="#FF0000"><b>then
      begin
        for </b></font>Index1 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>BuffSize <font color="#FF0000"><b>do
          if  </b></font><font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">] &gt; </font><font color="#800000">#96</font><font color="#000080">)
          </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">] &lt; </font><font color="#800000">#123</font><font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>dec<font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">], </font><font color="#800000">32</font><font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>Index1 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Pattern<font color="#000080">) </font><font color="#FF0000"><b>do
          </b></font>Pattern<font color="#000080">[</font>Index1<font color="#000080">] := </font>upcase<font color="#000080">(</font>Pattern<font color="#000080">[</font>Index1<font color="#000080">])
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Index1 <font color="#000080">:= </font>PatSize<font color="#000080">;
    </font>Index2 <font color="#000080">:= </font>PatSize<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      if </b></font><font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">] = </font>Pattern<font color="#000080">[</font>Index2<font color="#000080">]) </font><font color="#FF0000"><b>then
        begin
          </b></font>dec<font color="#000080">(</font>Index1<font color="#000080">);
          </font>dec<font color="#000080">(</font>Index2<font color="#000080">)
        </font><font color="#FF0000"><b>end
      else
        begin
          if </b></font><font color="#000080">(</font>succ<font color="#000080">(</font>PatSize <font color="#000080">- </font>Index2<font color="#000080">) &gt; (</font>BMT<font color="#000080">[</font>ord<font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">])])) </font><font color="#FF0000"><b>then
            </b></font>inc<font color="#000080">(</font>Index1<font color="#000080">, </font>succ<font color="#000080">(</font>PatSize <font color="#000080">- </font>Index2<font color="#000080">))
          </font><font color="#FF0000"><b>else
            </b></font>inc<font color="#000080">(</font>Index1<font color="#000080">, </font>BMT<font color="#000080">[</font>ord<font color="#000080">(</font>Buffer2<font color="#000080">[</font>Index1<font color="#000080">])]);
          </font>Index2 <font color="#000080">:= </font>PatSize
        <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>Index2 <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index1 <font color="#000080">&gt; </font>BuffSize<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Index1 <font color="#000080">&gt; </font>BuffSize<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>BMsearch <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>else
      </b></font>BMsearch <font color="#000080">:= </font>succ<font color="#000080">(</font>Index1<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* BMsearch.                                            *)

</i></font><font color="#FF0000"><b>type
  </b></font>arby_64K <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65520</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Index   <font color="#000080">: </font>word<font color="#000080">;
  </font>st_Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
  </font>Buffer  <font color="#000080">: ^</font>arby_64K<font color="#000080">;
  </font>BMT     <font color="#000080">: </font>BMTable<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>new<font color="#000080">(</font>Buffer<font color="#000080">);
  </font>fillchar<font color="#000080">(</font>Buffer<font color="#000080">^, </font>sizeof<font color="#000080">(</font>Buffer<font color="#000080">^), </font><font color="#800000">0</font><font color="#000080">);
  </font>st_Temp <font color="#000080">:= </font><font color="#800000">'aBcDeFgHiJkLmNoPqRsT'</font><font color="#000080">;
  </font>move<font color="#000080">(</font>st_Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Buffer<font color="#000080">^[</font><font color="#800000">65501</font><font color="#000080">], </font>length<font color="#000080">(</font>st_Temp<font color="#000080">));
  </font>st_Temp <font color="#000080">:= </font><font color="#800000">'AbCdEfGhIjKlMnOpQrSt'</font><font color="#000080">;
  </font>Create_BMTable<font color="#000080">(</font>BMT<font color="#000080">, </font>st_Temp<font color="#000080">, </font>false<font color="#000080">);
  </font>Index <font color="#000080">:= </font>BMSearch<font color="#000080">(</font>BMT<font color="#000080">, </font>Buffer<font color="#000080">^, </font>sizeof<font color="#000080">(</font>Buffer<font color="#000080">^), </font>st_Temp<font color="#000080">, </font>false<font color="#000080">);
  </font>writeln<font color="#000080">(</font>st_Temp<font color="#000080">, </font><font color="#800000">' found at offset '</font><font color="#000080">, </font>Index<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
                               - </font>Guy
<font color="#000080">---
 &thorn; </font>DeLuxe<font color="#000080">&yacute;/</font><font color="#800000">386 1.25 #5060 </font><font color="#000080">&thorn;
 * </font>Rose Media<font color="#000080">, </font>Toronto<font color="#000080">, </font>Canada <font color="#000080">: </font><font color="#800000">416</font><font color="#000080">-</font><font color="#800000">733</font><font color="#000080">-</font><font color="#800000">2285
 </font><font color="#000080">* </font>PostLink<font color="#000080">(</font>tm<font color="#000080">) </font>v1<font color="#000080">.</font><font color="#800000">04  </font>ROSE <font color="#000080">(</font><font color="#800000">#1047</font><font color="#000080">) : </font>RelayNet<font color="#000080">(</font>tm<font color="#000080">)

</font>                                                                               
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
