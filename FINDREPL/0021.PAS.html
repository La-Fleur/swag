<html>
<head><title> "Boyer-Moore Search Unit" by SWAG TEAM SUPPORT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Unit </b></font>BMoore<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Type
  </b></font>bigarray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">65520</font><font color="#000080">] </font><font color="#FF0000"><b>Of
  </b></font>Byte<font color="#000080">;
  </font>baptr    <font color="#000080">= ^</font>bigarray<font color="#000080">;
  </font>BMTable  <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>Of
  </b></font>Byte<font color="#000080">;
  
  
</font><font color="#FF0000"><b>Type  </b></font>pBMSearchObj <font color="#000080">= ^</font>bmsearchobj<font color="#000080">;
  </font>bmsearchobj <font color="#000080">= </font><font color="#FF0000"><b>Object
  Constructor </b></font>Init <font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>Function   </b></font>Search <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buff<font color="#000080">; </font>size <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Destructor </b></font>Done<font color="#000080">;

  </font><font color="#FF0000"><b>Private
  </b></font>Btable <font color="#000080">: </font>BMTable<font color="#000080">;
  </font>ss     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Constructor </b></font>bmsearchobj<font color="#000080">.</font>Init <font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  
</font><font color="#FF0000"><b>Var
  </b></font>st   <font color="#000080">: </font>BMTable <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
  </font>slen <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>s<font color="#000080">;
  </font>x    <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>{  Move (s, ss, Byte (s) );}
  </i></font>ss<font color="#000080">:=</font>s<font color="#000080">;

  </font>FillChar <font color="#000080">(</font>Btable<font color="#000080">, </font>SizeOf <font color="#000080">(</font>Btable<font color="#000080">), </font>slen<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font>slen <font color="#FF0000"><b>DownTo </b></font><font color="#800000">1 </font><font color="#FF0000"><b>Do
      If </b></font><font color="#000080">(</font>Btable <font color="#000080">[</font>st <font color="#000080">[</font>x<font color="#000080">] ] = </font>slen<font color="#000080">) </font><font color="#FF0000"><b>Then
         </b></font>Btable <font color="#000080">[</font>st <font color="#000080">[</font>x<font color="#000080">] ] := </font>slen <font color="#000080">- </font>x
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>bmsearchobj<font color="#000080">.</font>Search <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buff<font color="#000080">; </font>size <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>buffer <font color="#000080">: </font>bigarray <font color="#FF0000"><b>Absolute </b></font>buff<font color="#000080">;
  </font>s      <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>byte <font color="#FF0000"><b>Absolute </b></font>ss<font color="#000080">;
  </font>len    <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>ss<font color="#000080">;
  </font>s1     <font color="#000080">: </font><font color="#FF0000"><b>String Absolute </b></font>ss<font color="#000080">;
  </font>s2     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>count<font color="#000080">,
  </font>x      <font color="#000080">: </font>Word<font color="#000080">;
  </font>found  <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>s2 <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr <font color="#000080">(</font>len<font color="#000080">);       
  </font>found <font color="#000080">:= </font>False<font color="#000080">;
  
  </font>count <font color="#000080">:= </font>Pred <font color="#000080">(</font>len<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>found<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>count <font color="#000080">&lt; (</font>size <font color="#000080">- </font>len<font color="#000080">) ) </font><font color="#FF0000"><b>Do
        Begin
        If </b></font><font color="#000080">(</font>buffer <font color="#000080">[</font>count<font color="#000080">] = </font>s <font color="#000080">[</font>len<font color="#000080">]) </font><font color="#FF0000"><b>Then 
           Begin
           If </b></font>buffer <font color="#000080">[</font>count <font color="#000080">- </font>Pred <font color="#000080">(</font>len<font color="#000080">) ] = </font>s <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>Then 
              Begin
              </b></font>Move <font color="#000080">(</font>buffer <font color="#000080">[</font>count <font color="#000080">- </font>Pred <font color="#000080">(</font>len<font color="#000080">) ], </font>s2 <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>len<font color="#000080">);
              </font>found <font color="#000080">:= </font>s1 <font color="#000080">= </font>s2<font color="#000080">;                   
              </font>Search <font color="#000080">:= </font>count <font color="#000080">- </font>Pred <font color="#000080">(</font>len<font color="#000080">);      
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font>Inc <font color="#000080">(</font>count<font color="#000080">);                
           </font><font color="#FF0000"><b>End
        Else
           </b></font>Inc <font color="#000080">(</font>count<font color="#000080">, </font>Btable <font color="#000080">[</font>buffer <font color="#000080">[</font>count<font color="#000080">] ]);   
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If Not </b></font>found <font color="#FF0000"><b>Then
     </b></font>Search <font color="#000080">:= </font><font color="#800000">$ffff</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  

</font><font color="#FF0000"><b>Destructor </b></font>bmsearchobj<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>Begin
End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
