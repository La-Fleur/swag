<html>
<head><title> "STRPOS.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">  Hi<font color="#000080">, </font>Andy<font color="#000080">:

  ...</font>Just <font color="#FF0000"><b>for </b></font>fun I also threw together a <font color="#000080">&quot;</font>PosSearch<font color="#000080">&quot; </font>routine
  that <font color="#FF0000"><b>uses </b></font>the built<font color="#000080">-</font><font color="#FF0000"><b>in </b></font>TP <font color="#000080">&quot;</font>POS<font color="#000080">&quot; </font><font color="#FF0000"><b>function</b></font><font color="#000080">. </font>It actually performs
  better than I thought it would<font color="#000080">, </font><font color="#FF0000"><b>as </b></font>it takes a <font color="#FF0000"><b>string </b></font>longer than
  <font color="#800000">15 </font>characters before it starts <font color="#FF0000"><b>to </b></font>become slower than the Boyer<font color="#000080">-
  </font>Moore <font color="#FF0000"><b>function </b></font>I just posted<font color="#000080">. (</font>ie<font color="#000080">: </font>PosSearch <font color="#FF0000"><b>is </b></font>faster than the
  Boyer<font color="#000080">-</font>Moore routine <font color="#FF0000"><b>for </b></font>strings that are smaller than <font color="#800000">16 </font>chars<font color="#000080">)
  </font>Here<font color="#800000">'s a demo program of the &quot;PosSearch&quot; search routine I put
  </font>together<font color="#000080">. *</font>Remember<font color="#000080">* </font><font color="#FF0000"><b>to </b></font>turn<font color="#000080">-</font>off <font color="#000080">&quot;</font>range<font color="#000080">-</font>checking<font color="#000080">&quot; </font><font color="#008000"><i>{$R-} </i></font><font color="#FF0000"><b>in </b></font>your
  finished <font color="#FF0000"><b>program</b></font><font color="#000080">, </font>otherwise the PosSearch will take longer than
  it should <font color="#FF0000"><b>to </b></font>execute<font color="#000080">.

              </font><font color="#008000"><i>(* Public-domain Search routine, using the standard TP  *)
              (* POS function. Guy McLoughlin - May 1, 1993.          *)
</i></font><font color="#FF0000"><b>program </b></font>DemoPosSearch<font color="#000080">;


  </font><font color="#008000"><i>(***** PosSearch function. Returns 0 if string is not found.        *)
  (*     Returns 65,535 if BufferSize is too large.                   *)
  (*     ie: Greater than 65,520 bytes.                               *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>function </b></font>PosSearch<font color="#000080">(</font><font color="#008000"><i>{input } </i></font><font color="#FF0000"><b>var </b></font>Buffer<font color="#000080">;
                                  </font>BuffSize <font color="#000080">: </font>word<font color="#000080">;
                                  </font>Pattern  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#008000"><i>{output} </i></font>word<font color="#000080">;
  </font><font color="#FF0000"><b>type
    </b></font>arwo_2    <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
    </font>arch_255  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>po_Buffer  <font color="#000080">: ^</font>arch_255<font color="#000080">;
    </font>by_Temp<font color="#000080">,
    </font>by_IncSize <font color="#000080">: </font>byte<font color="#000080">;
    </font>wo_Index   <font color="#000080">: </font>word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>BuffSize <font color="#000080">&gt; </font><font color="#800000">65520</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>PosSearch <font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;
        </font>exit
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>wo_Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>by_IncSize <font color="#000080">:= (</font><font color="#800000">255 </font><font color="#000080">- </font>pred<font color="#000080">(</font>length<font color="#000080">(</font>Pattern<font color="#000080">)));
    </font>po_Buffer <font color="#000080">:= </font>addr<font color="#000080">(</font>Buffer<font color="#000080">);
    </font><font color="#FF0000"><b>repeat
      </b></font>by_Temp <font color="#000080">:= </font>pos<font color="#000080">(</font>Pattern<font color="#000080">, </font>po_Buffer<font color="#000080">^);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>by_Temp <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>inc<font color="#000080">(</font>wo_Index<font color="#000080">, </font>by_IncSize<font color="#000080">);
          </font>inc<font color="#000080">(</font>arwo_2<font color="#000080">(</font>po_Buffer<font color="#000080">)[</font><font color="#800000">1</font><font color="#000080">], </font>by_IncSize<font color="#000080">)
        </font><font color="#FF0000"><b>end
      else
        </b></font>inc<font color="#000080">(</font>wo_Index<font color="#000080">, </font>by_Temp<font color="#000080">)
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>by_Temp <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>wo_Index <font color="#000080">&gt; </font>BuffSize<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>by_Temp <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>PosSearch <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>else
      </b></font>PosSearch <font color="#000080">:= </font>wo_Index
  <font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* PosSearch.                                           *)


</i></font><font color="#FF0000"><b>type
  </b></font>arby_64K <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65520</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Index   <font color="#000080">: </font>word<font color="#000080">;
  </font>st_Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
  </font>Buffer  <font color="#000080">: ^</font>arby_64K<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>new<font color="#000080">(</font>Buffer<font color="#000080">);
  </font>fillchar<font color="#000080">(</font>Buffer<font color="#000080">^, </font>sizeof<font color="#000080">(</font>Buffer<font color="#000080">^), </font><font color="#800000">0</font><font color="#000080">);
  </font>st_Temp <font color="#000080">:= </font><font color="#800000">'12345678901234567890'</font><font color="#000080">;
  </font>move<font color="#000080">(</font>st_Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>Buffer<font color="#000080">^[</font><font color="#800000">65501</font><font color="#000080">], </font>length<font color="#000080">(</font>st_Temp<font color="#000080">));
  </font>Index <font color="#000080">:= </font>PosSearch<font color="#000080">(</font>Buffer<font color="#000080">^, </font>sizeof<font color="#000080">(</font>Buffer<font color="#000080">^), </font>st_Temp<font color="#000080">);
  </font>writeln<font color="#000080">(</font>st_Temp<font color="#000080">, </font><font color="#800000">' found at offset '</font><font color="#000080">, </font>Index<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

                               - </font>Guy
<font color="#000080">---
 &thorn; </font>DeLuxe<font color="#000080">&yacute;/</font><font color="#800000">386 1.25 #5060 </font><font color="#000080">&thorn;
 * </font>Rose Media<font color="#000080">, </font>Toronto<font color="#000080">, </font>Canada <font color="#000080">: </font><font color="#800000">416</font><font color="#000080">-</font><font color="#800000">733</font><font color="#000080">-</font><font color="#800000">2285
 </font><font color="#000080">* </font>PostLink<font color="#000080">(</font>tm<font color="#000080">) </font>v1<font color="#000080">.</font><font color="#800000">04  </font>ROSE <font color="#000080">(</font><font color="#800000">#1047</font><font color="#000080">) : </font>RelayNet<font color="#000080">(</font>tm<font color="#000080">)

</font>                                                                     
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to FINDREPL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
