<html>
<head><title> "QWK Conf Member listing" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{***********************************************************************}
{$M 16384,0,0}                  { Save memory for Calling PKUNZIP.      }
</i></font><font color="#FF0000"><b>PROGRAM </b></font>NMembers<font color="#000080">;               </font><font color="#008000"><i>{ May 16/94, Greg Estabrooks.           }
</i></font><font color="#FF0000"><b>USES
     </b></font>DOS<font color="#000080">;
</font><font color="#FF0000"><b>CONST
     </b></font>Ver      <font color="#000080">= </font><font color="#800000">'V0.2&aacute;'</font><font color="#000080">;        </font><font color="#008000"><i>{ Current Version of program.           }
     </i></font>ProgTitle<font color="#000080">= </font><font color="#800000">'NMem '</font><font color="#000080">+</font>Ver<font color="#000080">+</font><font color="#800000">'- Conference Member Tracking Program. '</font><font color="#000080">;
     </font>Author   <font color="#000080">= </font><font color="#800000">'CopyRight (C) 1994, Greg Estabrooks.'</font><font color="#000080">;
</font><font color="#FF0000"><b>TYPE
    </b></font>Direction <font color="#000080">= (</font>Left<font color="#000080">,</font>Right<font color="#000080">);

    </font>MsgDHdr <font color="#000080">= </font><font color="#FF0000"><b>RECORD            </b></font><font color="#008000"><i>{ Structre of QWK Message Header.       }
               </i></font>Status    <font color="#000080">:</font>CHAR<font color="#000080">;
               </font>MNum      <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>Date      <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>Time      <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>MTo       <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>MFrom     <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>MSubj     <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>Pass      <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>MRefer    <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>NChunks   <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
               </font>Active    <font color="#000080">:</font>CHAR<font color="#000080">;
               </font>MConf     <font color="#000080">:</font>WORD<font color="#000080">;
               </font>Fill      <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{MsgDHdr}

    </i></font>NDXType <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                </b></font>Offset <font color="#000080">:</font>LONGINT<font color="#000080">;
                </font>Misc   <font color="#000080">:</font>BYTE<font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>MessInfType <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                   </b></font>Name  <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">25</font><font color="#000080">];   </font><font color="#008000"><i>{ Name of person message FROM.  }
                   </i></font>Origin<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];   </font><font color="#008000"><i>{ Origin line from message.     }
                  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>QWKName <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];         </font><font color="#008000"><i>{ QWK File to process.                  }
  </i></font>OutFile <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];         </font><font color="#008000"><i>{ File to place new member names.       }
  </i></font>WorkDir <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">];         </font><font color="#008000"><i>{ Holds the name of our work directory. }
  </i></font>OutHan  <font color="#000080">:</font>TEXT<font color="#000080">;                </font><font color="#008000"><i>{ File handle for output file.          }
  </i></font>MessDat <font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;                </font><font color="#008000"><i>{ File handle for MESSAGES.DAT.         }

  </i></font>NumMess <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Number of messages in conference.     }
  </i></font>NewMems <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Number of new members found.          }
  </i></font>NumFound<font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds number of different names found.}

  </i></font>fOfs    <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">500</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>LONGINT<font color="#000080">;</font><font color="#008000"><i>{ Holds offset info from NDX file.  }
  </i></font>FInf    <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">500</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>MessInfType<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PadStr<font color="#000080">( </font>Dir <font color="#000080">:</font>Direction<font color="#000080">; </font>Str2Pad <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Til <font color="#000080">:</font>BYTE<font color="#000080">;
                                                 </font>Ch <font color="#000080">:</font>CHAR <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                         </font><font color="#008000"><i>{ Function to pad a string with 'Ch' until it  }
                         { is 'Til' long.                               }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Temp <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                </font><font color="#008000"><i>{ Temporary String info.                }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Temp <font color="#000080">:= </font>Str2Pad<font color="#000080">;              </font><font color="#008000"><i>{ Initialize 'Temp' to users string.    }
  </i></font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Temp<font color="#000080">) &lt; </font>Til <font color="#FF0000"><b>THEN    </b></font><font color="#008000"><i>{ If its smaller than 'Til' add padding.}
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Temp<font color="#000080">) &lt; </font>Til<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{ Loop until proper length reached.     }
   </i></font><font color="#FF0000"><b>BEGIN
     CASE </b></font>Dir <font color="#FF0000"><b>OF
      </b></font>Right <font color="#000080">:</font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>Ch<font color="#000080">; </font><font color="#008000"><i>{ If Right then add to end of string.   }
      </i></font>Left  <font color="#000080">:</font>Temp <font color="#000080">:= </font>Ch <font color="#000080">+ </font>Temp<font color="#000080">; </font><font color="#008000"><i>{ If Left then add to begining.         }
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>PadStr <font color="#000080">:= </font>Temp<font color="#000080">;               </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InitVars<font color="#000080">;
                        </font><font color="#008000"><i>{ Procedure to initialize program variables.    }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Temp <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];             </font><font color="#008000"><i>{ Temporary String value.               }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar<font color="#000080">(</font>FInf<font color="#000080">,</font>SizeOf<font color="#000080">(</font>FInf<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font><font color="#008000"><i>{ Clear FInf.                         }
  </i></font>NumMess <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                 </font><font color="#008000"><i>{ Clear number of messages.             }
  </i></font>NewMems <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                 </font><font color="#008000"><i>{ Clear number of new members found.    }
  </i></font>QWKName <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);       </font><font color="#008000"><i>{ Get QWK Name from command line.       }
  </i></font>NumFound <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                </font><font color="#008000"><i>{ Initialize 'NumFound.'                }
  </i></font>Temp <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);          </font><font color="#008000"><i>{ Get Conf Number from command line.    }
  </i></font>OutFile <font color="#000080">:= </font><font color="#800000">'CNF'</font><font color="#000080">+</font>PadStr<font color="#000080">(</font>Left<font color="#000080">,</font>Temp<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">)+</font><font color="#800000">'.LST'</font><font color="#000080">;
                                </font><font color="#008000"><i>{ Prepare output file name.             }

  </i></font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>WorkDir<font color="#000080">);            </font><font color="#008000"><i>{ Save current directory.               }
  </i></font><font color="#FF0000"><b>IF </b></font>WorkDir<font color="#000080">[</font>Length<font color="#000080">(</font>WorkDir<font color="#000080">)] = </font><font color="#800000">'\' </font><font color="#FF0000"><b>THEN
   </b></font>WorkDir <font color="#000080">:= </font>WorkDir <font color="#000080">+</font><font color="#800000">'NMEM'
  </font><font color="#FF0000"><b>ELSE
   </b></font>WorkDir <font color="#000080">:= </font>WorkDir <font color="#000080">+</font><font color="#800000">'\NMEM'</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{InitVars}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Syntax_Error<font color="#000080">;
                       </font><font color="#008000"><i>{ Display proper command line syntax to user.    }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Writeln<font color="#000080">;                      </font><font color="#008000"><i>{ Skip a line.                          }
  </i></font>Writeln<font color="#000080">(
     </font><font color="#800000">'Syntax: NMEM [drive]:[path]PacketName ConfNum'</font><font color="#000080">);
                                </font><font color="#008000"><i>{ Show syntax for user.                 }
  </i></font>Writeln<font color="#000080">;                      </font><font color="#008000"><i>{ Skip a line.                          }
                                { Show an example usage.                }
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'EXAMPLE : NMEM C:\QWK\MYBBS.QWK 123'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">' Scans MYBBS.QWK and generates CNF00123.LST'</font><font color="#000080">);
  </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                      </font><font color="#008000"><i>{ Halt program with and ERRORLEVEL of 1.}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Syntax_Error}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>fExist<font color="#000080">( </font>FName <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">) :</font>BOOLEAN<font color="#000080">;
                        </font><font color="#008000"><i>{ Routine to determine whether or not 'FName'   }
                        { really exists.                                }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>fExist <font color="#000080">:= (</font>fSearch<font color="#000080">(</font>FName<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">) &lt;&gt; </font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{fExist}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>DirExist<font color="#000080">( </font>DName <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">) :</font>BOOLEAN<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to determine whether or not the      }
                         { Directory 'DName' exists.                    }
</i></font><font color="#FF0000"><b>VAR
   </b></font>DirInf <font color="#000080">:</font>SearchRec<font color="#000080">;           </font><font color="#008000"><i>{ Hold info if dir found.               }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FindFirst<font color="#000080">(</font>DName<font color="#000080">,</font>Directory<font color="#000080">,</font>DirInf<font color="#000080">);
  </font>DirExist <font color="#000080">:= (</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{DirExist}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>DelWorkDir<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to delete files in the work directory}
                         { and them remove the directory.               }
</i></font><font color="#FF0000"><b>VAR
   </b></font>FileInf <font color="#000080">:</font>SEARCHREC<font color="#000080">;          </font><font color="#008000"><i>{ Holds file names for erasure.         }
   </i></font>fVar    <font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;               </font><font color="#008000"><i>{ Handle of file to delete.             }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FindFirst<font color="#000080">(</font>WorkDir<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>Archive<font color="#000080">,</font>FileInf<font color="#000080">); </font><font color="#008000"><i>{ Get File Name.           }
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO       </b></font><font color="#008000"><i>{ Loop until all file names read.       }
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>Assign<font color="#000080">(</font>fVar<font color="#000080">,</font>WorkDir<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>FileInf<font color="#000080">.</font>Name<font color="#000080">);
                                </font><font color="#008000"><i>{ Assign file name to handle.           }
    </i></font>Erase<font color="#000080">(</font>fVar<font color="#000080">);                </font><font color="#008000"><i>{ Erase File.                           }
    </i></font>FindNext<font color="#000080">(</font>FileInf<font color="#000080">);          </font><font color="#008000"><i>{ Get next file name.                   }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{DelWorkDir}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>OpenPacket<font color="#000080">( </font>QName <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">);
                         </font><font color="#008000"><i>{ Routine open mail packets.                   }
</i></font><font color="#FF0000"><b>VAR
   </b></font>PKPath <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Holds location of PKUNZIP.EXE         }
</i></font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>DirExist<font color="#000080">(</font>WorkDir<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ If dir doesn't exist then make it.    }
   </i></font><font color="#FF0000"><b>BEGIN
    </b></font><font color="#008000"><i>{$I-}                       { Turn I/O checking off.                }
    </i></font>MKDir<font color="#000080">(</font>WorkDir<font color="#000080">);             </font><font color="#008000"><i>{ Create our work directory.            }
    {$I+}                       { Turn I/O checking off.                }

    </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN        </b></font><font color="#008000"><i>{ If I/O error then                     }
     </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ Display error message.                }
      </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Error creating work directory'</font><font color="#000080">,^</font>G<font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                  </font><font color="#008000"><i>{ Now halt program.                     }
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>END
  ELSE
   </b></font>DelWorkDir<font color="#000080">;                  </font><font color="#008000"><i>{ If it does exist then clear it.       }

  </i></font><font color="#FF0000"><b>IF NOT </b></font>fExist<font color="#000080">(</font><font color="#800000">'PKUNZIP.EXE'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ If it's not in the current dir    }
   </i></font><font color="#FF0000"><b>BEGIN                        </b></font><font color="#008000"><i>{ then search the %PATH%.               }
    </i></font>PKPath <font color="#000080">:= </font>fSearch<font color="#000080">(</font><font color="#800000">'PKUNZIP.EXE'</font><font color="#000080">,</font>GetEnv<font color="#000080">(</font><font color="#800000">'PATH'</font><font color="#000080">));
    </font><font color="#FF0000"><b>IF </b></font>PKPath <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ If it's nowhere to be found then      }
     </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ Display error message.                }
      </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot find PKUNZIP.EXE!'</font><font color="#000080">,^</font>G<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'It must be located either in the '</font><font color="#000080">,
                 </font><font color="#800000">'current directory or along your %PATH%'</font><font color="#000080">);
      </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                  </font><font color="#008000"><i>{ Now halt program.                     }
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>SwapVectors<font color="#000080">;                  </font><font color="#008000"><i>{ Swap to proper Interrupt vectors.     }
  </i></font>Exec<font color="#000080">(</font>GetEnv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">),</font><font color="#800000">'/C '</font><font color="#000080">+</font>PKPath<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>QWKName<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>WorkDir<font color="#000080">+</font><font color="#800000">' &gt;NUL'</font><font color="#000080">);
  </font>SwapVectors<font color="#000080">;                  </font><font color="#008000"><i>{ Swap em back.                         }

  </i></font><font color="#FF0000"><b>IF </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ If there was an 'Exec' error then     }
   </i></font><font color="#FF0000"><b>BEGIN                        </b></font><font color="#008000"><i>{ Display error message.                }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Error #'</font><font color="#000080">,</font>DosError<font color="#000080">,</font><font color="#800000">' occured executing '</font><font color="#000080">,</font>PKPath<font color="#000080">,^</font>G<font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);                    </font><font color="#008000"><i>{ Now Halt program.                     }
   </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>DosExitCode <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN      </b></font><font color="#008000"><i>{ Check for a program error.            }
   </i></font>Writeln<font color="#000080">(</font>PKPath<font color="#000080">,</font><font color="#800000">' returned an ERRORLEVEL of '</font><font color="#000080">,</font>DosExitCode<font color="#000080">,^</font>G<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{OpenPacket}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>NotNumber<font color="#000080">( </font>NumStr <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">) :</font>BOOLEAN<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to determine whether or not 'NumStr' }
                         { is a valid number.                           }
                         { Returns TRUE if not a number FALSE if a num. }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Result <font color="#000080">:</font>BOOLEAN<font color="#000080">;             </font><font color="#008000"><i>{ Holds Function result.                }
   </i></font>StrPos <font color="#000080">:</font>BYTE<font color="#000080">;                </font><font color="#008000"><i>{ Position withing string.              }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Result <font color="#000080">:= </font>FALSE<font color="#000080">;              </font><font color="#008000"><i>{ Defaults to false.                    }
  </i></font><font color="#FF0000"><b>FOR </b></font>StrPos <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NumStr<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{ Loop through entire string.    }
   </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>NumStr<font color="#000080">[</font>StrPos<font color="#000080">] </font><font color="#FF0000"><b>IN
            </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,</font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,</font><font color="#800000">'7'</font><font color="#000080">,</font><font color="#800000">'8'</font><font color="#000080">,</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
     </b></font>Result <font color="#000080">:= </font>TRUE<font color="#000080">;

  </font>NotNumber <font color="#000080">:= </font>Result<font color="#000080">;          </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{NotNumber}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ReadNDX <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to read proper NDX file for conference.}
</i></font><font color="#FF0000"><b>VAR
   </b></font>Result <font color="#000080">:</font>BOOLEAN<font color="#000080">;             </font><font color="#008000"><i>{ Holds Function result.                }
   </i></font>NDX    <font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;                </font><font color="#008000"><i>{ File handle for NDX file.             }
   </i></font>Info   <font color="#000080">:</font>NDXType<font color="#000080">;             </font><font color="#008000"><i>{ Hold info read from NDX file.         }
   </i></font>NumRead<font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds number of bytes read from NDX.  }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Result <font color="#000080">:= </font>TRUE<font color="#000080">;               </font><font color="#008000"><i>{ Default to success.                   }
  </i></font>Assign<font color="#000080">(</font>NDX<font color="#000080">,</font>WorkDir<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>PadStr<font color="#000080">(</font>Left<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">)+</font><font color="#800000">'.NDX'</font><font color="#000080">);
  </font><font color="#008000"><i>{$I-}                         { Turn off I/O checking.                }
  </i></font>Reset<font color="#000080">(</font>NDX<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                 </font><font color="#008000"><i>{ Open NDX for reading.                 }
  {$I+}                         { Turn on I/O checking.                 }
  </i></font><font color="#FF0000"><b>WHILE NOT </b></font>EOF<font color="#000080">(</font>NDX<font color="#000080">) </font><font color="#FF0000"><b>DO         </b></font><font color="#008000"><i>{ Loop until end of file.               }
   </i></font><font color="#FF0000"><b>BEGIN
     </b></font>BlockRead<font color="#000080">(</font>NDX<font color="#000080">,</font>Info<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Info<font color="#000080">),</font>NumRead<font color="#000080">); </font><font color="#008000"><i>{ Read offset of message.}
     </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>NumRead <font color="#000080">= </font>Sizeof<font color="#000080">(</font>Info<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>NumMess <font color="#000080">&lt;</font><font color="#800000">501</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                </b></font><font color="#008000"><i>{ If proper amount read then            }
      </i></font><font color="#FF0000"><b>BEGIN                     </b></font><font color="#008000"><i>{ Convert it to a proper LONGINT.       }
        </i></font>INC<font color="#000080">(</font>NumMess<font color="#000080">);           </font><font color="#008000"><i>{ Increase message total.               }
                                { Now convert offset.                   }
        </i></font>fOfs<font color="#000080">[</font>NumMess<font color="#000080">] := ((</font>Info<font color="#000080">.</font>Offset <font color="#FF0000"><b>AND NOT </b></font><font color="#800000">$FF000000</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#800000">$00800000</font><font color="#000080">)
                          </font><font color="#FF0000"><b>SHR </b></font><font color="#000080">(</font><font color="#800000">24 </font><font color="#000080">- ((</font>Info<font color="#000080">.</font>Offset <font color="#FF0000"><b>SHR </b></font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$7F</font><font color="#000080">));
        </font>fOfs<font color="#000080">[</font>NumMess<font color="#000080">] := (</font>fOfs<font color="#000080">[</font>NumMess<font color="#000080">]-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">7</font><font color="#000080">;
      </font><font color="#FF0000"><b>END
     ELSE
      </b></font>Result <font color="#000080">:= </font>FALSE<font color="#000080">;          </font><font color="#008000"><i>{ Otherwise return FALSE result.        }
   </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>NDX<font color="#000080">);                   </font><font color="#008000"><i>{ Close NDX File.                       }
  </i></font>ReadNDX <font color="#000080">:= </font>Result<font color="#000080">;            </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{ReadNDX}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RemoveSpaces<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Str2Rem <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">);
                         </font><font color="#008000"><i>{ Routine to remove any spaces from 'Str2Rem'. }
</i></font><font color="#FF0000"><b>VAR
   </b></font>StrPos <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Position within string.               }
   </i></font>Temp   <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Temporary string work space.          }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                   </font><font color="#008000"><i>{ Clear string.                         }
  </i></font><font color="#FF0000"><b>FOR </b></font>StrPos <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>Str2Rem<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{ Loop through all characters.  }
   </i></font><font color="#FF0000"><b>IF </b></font>Str2Rem<font color="#000080">[</font>StrPos<font color="#000080">] &lt;&gt; </font><font color="#800000">#32 </font><font color="#FF0000"><b>THEN   </b></font><font color="#008000"><i>{ If its not a space then           }
    </i></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>Str2Rem<font color="#000080">[</font>StrPos<font color="#000080">]; </font><font color="#008000"><i>{ add it to our string.             }

  </i></font>Str2Rem <font color="#000080">:= </font>Temp<font color="#000080">;              </font><font color="#008000"><i>{ Return newly changed string.          }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{RemoveSpaces}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Compare<font color="#000080">( </font>Str1<font color="#000080">,</font>Str2 <font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">) :</font>BOOLEAN<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to compare to strings after removing }
                         { any spaces from it.Case INSENSITIVE.         }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Result <font color="#000080">:</font>BOOLEAN<font color="#000080">;             </font><font color="#008000"><i>{ Result from comparing.                }
   </i></font>StrPos <font color="#000080">:</font>BYTE<font color="#000080">;                </font><font color="#008000"><i>{ Position within 2 strings.            }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Result <font color="#000080">:= </font>TRUE<font color="#000080">;               </font><font color="#008000"><i>{ Default result to TRUE.               }
  </i></font>RemoveSpaces<font color="#000080">(</font>Str1<font color="#000080">);           </font><font color="#008000"><i>{ Trim spaces from the strings.         }
  </i></font>RemoveSpaces<font color="#000080">(</font>Str2<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Str1<font color="#000080">) &lt;&gt; </font>Length<font color="#000080">(</font>Str2<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ If different lengths then they }
   </i></font>Result <font color="#000080">:= </font>FALSE                     <font color="#008000"><i>{ must be different.             }
  </i></font><font color="#FF0000"><b>ELSE
   BEGIN
    </b></font>StrPos <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                </font><font color="#008000"><i>{ Initialize 'StrPos' to 0.             }
    </i></font><font color="#FF0000"><b>REPEAT                      </b></font><font color="#008000"><i>{ Loop until every char checked.        }
     </i></font>INC<font color="#000080">(</font>StrPos<font color="#000080">);               </font><font color="#008000"><i>{ Point to next char.                   }
     </i></font><font color="#FF0000"><b>IF </b></font>UpCase<font color="#000080">(</font>Str1<font color="#000080">[</font>StrPos<font color="#000080">]) &lt;&gt; </font>UpCase<font color="#000080">(</font>Str2<font color="#000080">[</font>StrPos<font color="#000080">]) </font><font color="#FF0000"><b>THEN
      BEGIN
       </b></font>Result <font color="#000080">:= </font>FALSE<font color="#000080">;         </font><font color="#008000"><i>{ If there not the same then return     }
                                { a FALSE result.                       }
       </i></font>StrPos <font color="#000080">:= </font>Length<font color="#000080">(</font>Str2<font color="#000080">);  </font><font color="#008000"><i>{ Now set loop exit condition.          }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font>StrPos <font color="#000080">= </font>Length<font color="#000080">(</font>Str2<font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>Compare <font color="#000080">:= </font>Result<font color="#000080">;            </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Compare}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Arr2String<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>Arr<font color="#000080">; </font>Len <font color="#000080">:</font>BYTE <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to convert 'Len' bytes of the array  }
                         { 'Arr' into a string.                         }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Result <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Holds function result.                }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>MOVE<font color="#000080">(</font>Arr<font color="#000080">,</font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Len<font color="#000080">);      </font><font color="#008000"><i>{ Move bytes into our result string.    }
  </i></font>Result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHR<font color="#000080">(</font>Len<font color="#000080">);        </font><font color="#008000"><i>{ Set string length byte.               }

  </i></font>Arr2String <font color="#000080">:= </font>Result<font color="#000080">;         </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Arr2String}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Fmt<font color="#000080">( </font>Info <font color="#000080">:</font>WORD <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to create a String with info int the }
                         { format '00'.                                 }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Temp <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                </font><font color="#008000"><i>{ Hold temporary string info.           }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Str<font color="#000080">(</font>Info<font color="#000080">,</font>Temp<font color="#000080">);               </font><font color="#008000"><i>{ Convert info to a string.             }
  </i></font><font color="#FF0000"><b>IF </b></font>Length<font color="#000080">(</font>Temp<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN      </b></font><font color="#008000"><i>{ if its only a single digit then add   }
    </i></font>Fmt <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">+</font>Temp             <font color="#008000"><i>{ leading zero.                         }
  </i></font><font color="#FF0000"><b>ELSE
    </b></font>Fmt <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{Fmt}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>TimeStr <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100 <font color="#000080">:</font>WORD<font color="#000080">;   </font><font color="#008000"><i>{ Holds temporary time info.            }
   </i></font>Year<font color="#000080">,</font>Mon<font color="#000080">,</font>Day<font color="#000080">,</font>DoWeek <font color="#000080">:</font>WORD<font color="#000080">;   </font><font color="#008000"><i>{ Holds temporary date info.            }
   </i></font>TempTime <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;            </font><font color="#008000"><i>{ Holds temporary TimeStr.              }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GetDate<font color="#000080">(</font>Year<font color="#000080">,</font>Mon<font color="#000080">,</font>Day<font color="#000080">,</font>DoWeek<font color="#000080">);
  </font>TempTime <font color="#000080">:= </font>Fmt<font color="#000080">(</font>Mon<font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+</font>Fmt<font color="#000080">(</font>Day<font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+</font>Fmt<font color="#000080">(</font>Year<font color="#000080">-</font><font color="#800000">1900</font><font color="#000080">)+</font><font color="#800000">' at '</font><font color="#000080">;
  </font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">); </font><font color="#008000"><i>{ Get Current Time.                     }
  </i></font><font color="#FF0000"><b>IF </b></font>Hour <font color="#000080">&gt;= </font><font color="#800000">12 </font><font color="#FF0000"><b>THEN
    </b></font>TempTime <font color="#000080">:= </font>TempTime<font color="#000080">+</font>Fmt<font color="#000080">(</font>Hour<font color="#000080">-</font><font color="#800000">12</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font>Fmt<font color="#000080">(</font>Min<font color="#000080">)+</font><font color="#800000">'pm'
  </font><font color="#FF0000"><b>ELSE
    IF </b></font>Hour <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>TempTime <font color="#000080">:= </font>TempTime<font color="#000080">+</font><font color="#800000">'12:'</font><font color="#000080">+</font>Fmt<font color="#000080">(</font>Min<font color="#000080">)+</font><font color="#800000">'am'
    </font><font color="#FF0000"><b>ELSE
      </b></font>TempTime <font color="#000080">:= </font>TempTime<font color="#000080">+</font>Fmt<font color="#000080">(</font>Hour<font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font>Fmt<font color="#000080">(</font>Min<font color="#000080">)+</font><font color="#800000">'pm'</font><font color="#000080">;
  </font>TimeStr <font color="#000080">:= </font>TempTime<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetOrigin<font color="#000080">( </font>Chunks <font color="#000080">:</font>WORD <font color="#000080">) :</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to get message origin line if any.   }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Result <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Holds function result.                }
   </i></font>CurChnk<font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds current chunk being read.       }
   </i></font>BufPos <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Position within buffer.               }
   </i></font>Temp   <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
   </font>NumRead<font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds number of bytes read from file. }
   </i></font>Buffer <font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;</font><font color="#008000"><i>{ Buffer for info read from file.      }
   </i></font>TareLin<font color="#000080">:</font>BOOLEAN<font color="#000080">;             </font><font color="#008000"><i>{ Holds whether or not we've past the   }
                                { tear line.                            }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Result <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                 </font><font color="#008000"><i>{ Clear result.                         }
  </i></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                   </font><font color="#008000"><i>{ Clear temporary storage space.        }
  </i></font>TareLin <font color="#000080">:= </font>FALSE<font color="#000080">;             </font><font color="#008000"><i>{ Default to FALSE.                     }
  </i></font><font color="#FF0000"><b>FOR </b></font>CurChnk <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Chunks<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{ Loop through all the 128 byte chunks.}
   </i></font><font color="#FF0000"><b>BEGIN
    </b></font>BlockRead<font color="#000080">(</font>MessDat<font color="#000080">,</font>Buffer<font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font>NumRead<font color="#000080">); </font><font color="#008000"><i>{ Read message info.         }
    </i></font><font color="#FF0000"><b>FOR </b></font>BufPos <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">128 </font><font color="#FF0000"><b>DO
     BEGIN
      IF </b></font>Buffer<font color="#000080">[</font>BufPos<font color="#000080">] = </font><font color="#800000">#227 </font><font color="#FF0000"><b>THEN
       BEGIN
        IF </b></font>Temp <font color="#000080">= </font><font color="#800000">'---' </font><font color="#FF0000"><b>THEN
         </b></font>TareLin <font color="#000080">:= </font>TRUE
        <font color="#FF0000"><b>ELSE
         IF </b></font>TareLin <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Temp <font color="#000080">&lt;&gt; </font>PadStr<font color="#000080">(</font>Right<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font>Length<font color="#000080">(</font>Temp<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
          </b></font>Result <font color="#000080">:= </font>Temp<font color="#000080">;
        </font>Temp <font color="#000080">:= </font><font color="#800000">''
       </font><font color="#FF0000"><b>END
      ELSE
       </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>Buffer<font color="#000080">[</font>BufPos<font color="#000080">];
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Result <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'ILink:'</font><font color="#000080">,</font>Result<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
   </b></font>Result <font color="#000080">:= </font><font color="#800000">' &thorn; Origin Line Unavailable &thorn; '</font><font color="#000080">;

  </font>GetOrigin <font color="#000080">:= </font>Result<font color="#000080">;          </font><font color="#008000"><i>{ Return proper result.                 }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ReadMsgs<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to read Messages and save new members}
                         { to disk.                                     }
</i></font><font color="#FF0000"><b>VAR
  </b></font>MessBuf <font color="#000080">:</font>MsgDHdr<font color="#000080">;             </font><font color="#008000"><i>{ Holds header info read from file.     }
  </i></font>InfPos  <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Loop variable for searching 'FileInf'.}
  </i></font>CurMess <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Loop variable for reading messages.   }
  </i></font>NumRead <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds number of bytes read from file. }
  </i></font>Found   <font color="#000080">:</font>BOOLEAN<font color="#000080">;             </font><font color="#008000"><i>{ Holds whether or not name was already }
                                { read.                                 }
  </i></font>FoundPos<font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds position in array name was found.}
  </i></font>Temp    <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Holds temporary string info.          }
  </i></font>Chunks  <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds number of 128 byte chunks message}
                                { takes up in file.                     }
  </i></font>ErrCode <font color="#000080">:</font>WORD<font color="#000080">;                </font><font color="#008000"><i>{ Holds error codes returned from 'Val'.}
  </i></font>Create  <font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Create  <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>fExist<font color="#000080">(</font>OutFile<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>NumFound <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>NumFound <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>MessDat<font color="#000080">,</font>WorkDir<font color="#000080">+</font><font color="#800000">'\MESSAGES.DAT'</font><font color="#000080">);</font><font color="#008000"><i>{ Assign handle to message file.}
  {$I-}                         { Turn I/O checking off.                }
  </i></font>Reset<font color="#000080">(</font>MessDat<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);             </font><font color="#008000"><i>{ Open file for reading.                }
  {$I+}                         { Turn I/O checking back on.            }
  </i></font><font color="#FF0000"><b>FOR </b></font>CurMess <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NumMess <font color="#FF0000"><b>DO </b></font><font color="#008000"><i>{ Loop through all the messages.       }
   </i></font><font color="#FF0000"><b>BEGIN
     </b></font>Seek<font color="#000080">(</font>MessDat<font color="#000080">,</font>fOfs<font color="#000080">[</font>CurMess<font color="#000080">]);</font><font color="#008000"><i>{ Move to current message position.    }
     </i></font>BlockRead<font color="#000080">(</font>MessDat<font color="#000080">,</font>MessBuf<font color="#000080">,</font>SizeOf<font color="#000080">(</font>MessBuf<font color="#000080">),</font>NumRead<font color="#000080">); </font><font color="#008000"><i>{ Read Header. }
     </i></font><font color="#FF0000"><b>FOR </b></font>InfPos <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NumFound <font color="#FF0000"><b>DO
      BEGIN
       </b></font>Found <font color="#000080">:= </font>Compare<font color="#000080">(</font>FInf<font color="#000080">[</font>InfPos<font color="#000080">].</font>Name<font color="#000080">,</font>Arr2String<font color="#000080">(</font>MessBuf<font color="#000080">.</font>MFrom<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">));
       </font><font color="#FF0000"><b>IF </b></font>Found <font color="#FF0000"><b>THEN
        </b></font>InfPos <font color="#000080">:= </font>NumFound<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>IF NOT </b></font>Found <font color="#FF0000"><b>THEN
      BEGIN
       </b></font>INC<font color="#000080">(</font>NewMems<font color="#000080">);            </font><font color="#008000"><i>{ Increase number of new members.       }
       </i></font><font color="#FF0000"><b>IF </b></font>Create <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>NumFound <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>NumFound <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>Create <font color="#000080">:= </font>FALSE<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font>INC<font color="#000080">(</font>NumFound<font color="#000080">);           </font><font color="#008000"><i>{ Increase number found.                }

       </i></font>FInf<font color="#000080">[</font>NumFound<font color="#000080">].</font>Name <font color="#000080">:= </font>Arr2String<font color="#000080">(</font>MessBuf<font color="#000080">.</font>MFrom<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
       </font>Temp <font color="#000080">:= </font>Arr2String<font color="#000080">(</font>MessBuf<font color="#000080">.</font>NChunks<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
       </font>RemoveSpaces<font color="#000080">(</font>Temp<font color="#000080">);
       </font>Val<font color="#000080">(</font>Temp<font color="#000080">,</font>Chunks<font color="#000080">,</font>ErrCode<font color="#000080">);
       </font>FInf<font color="#000080">[</font>NumFound<font color="#000080">].</font>Origin <font color="#000080">:= </font>GetOrigin<font color="#000080">(</font>Chunks<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>MessDat<font color="#000080">);               </font><font color="#008000"><i>{ Close message file.                   }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{ReadMsgs}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SaveList<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to write our list to the list file.  }
</i></font><font color="#FF0000"><b>VAR
   </b></font>ListPos <font color="#000080">:</font>WORD<font color="#000080">;               </font><font color="#008000"><i>{ Position withing list being written.  }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Assign<font color="#000080">(</font>OutHan<font color="#000080">,</font>OutFile<font color="#000080">);       </font><font color="#008000"><i>{ Assign handle to file name.           }
  {$I-}                         { I/O off.                              }
  </i></font>Rewrite<font color="#000080">(</font>OutHan<font color="#000080">);              </font><font color="#008000"><i>{ Open file for writing.                }
  {$I+}                         { I/O on.                               }
  </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ If there was an error.                }
   </i></font>Writeln<font color="#000080">(</font><font color="#800000">'-Error! Unable to Open '</font><font color="#000080">,</font>OutFile<font color="#000080">,^</font>G<font color="#000080">)
  </font><font color="#FF0000"><b>ELSE
   BEGIN
    </b></font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);         </font><font color="#008000"><i>{ Write a blank line to file.           }
    </i></font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">'/*'</font><font color="#000080">+</font>PadStr<font color="#000080">(</font>Right<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">75</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">)+</font><font color="#800000">'*/'</font><font color="#000080">);

    </font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">'                         Conference ['</font><font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),
                   </font><font color="#800000">'] Members list.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font>PadStr<font color="#000080">(</font>Right<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">)+</font><font color="#800000">'Last Change '</font><font color="#000080">+</font>TimeStr<font color="#000080">);
    </font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">'/*'</font><font color="#000080">+</font>PadStr<font color="#000080">(</font>Right<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">,</font><font color="#800000">75</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">)+</font><font color="#800000">'*/'</font><font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>ListPos <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>NumFound <font color="#FF0000"><b>DO
     BEGIN
      </b></font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);       </font><font color="#008000"><i>{ Writeln a blank line.                 }
      </i></font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font><font color="#800000">'User : '</font><font color="#000080">+</font>FInf<font color="#000080">[</font>ListPos<font color="#000080">].</font>Name<font color="#000080">); </font><font color="#008000"><i>{ Writeln user name.}
      </i></font>Writeln<font color="#000080">(</font>OutHan<font color="#000080">,</font>FInf<font color="#000080">[</font>ListPos<font color="#000080">].</font>Origin<font color="#000080">); </font><font color="#008000"><i>{ Write users origin line.  }
     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Close<font color="#000080">(</font>OutHan<font color="#000080">);                </font><font color="#008000"><i>{ Close file.                           }
   </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{SaveList}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ReadList<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to read in the conf members list.    }
</i></font><font color="#FF0000"><b>VAR
   </b></font>InFile <font color="#000080">:</font>TEXT<font color="#000080">;                </font><font color="#008000"><i>{ Text handle for conference list.      }
   </i></font>Temp   <font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;              </font><font color="#008000"><i>{ Holds string read from file.          }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>NumFound <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>InFile<font color="#000080">,</font>OutFile<font color="#000080">);       </font><font color="#008000"><i>{ Assign handle to file name.           }
  {$I-}                         { I/O checking off.                     }
  </i></font>Reset<font color="#000080">(</font>Infile<font color="#000080">);                </font><font color="#008000"><i>{ Open file for reading.                }
  {$I+}                         { I/O checking on.                      }
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>EOF<font color="#000080">(</font>InFile<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>NumFound <font color="#000080">&lt;</font><font color="#800000">500</font><font color="#000080">) </font><font color="#FF0000"><b>DO
   BEGIN
    </b></font>ReadLn<font color="#000080">(</font>InFile<font color="#000080">,</font>Temp<font color="#000080">);        </font><font color="#008000"><i>{ Read a line from the file.            }
    </i></font><font color="#FF0000"><b>IF </b></font>Copy<font color="#000080">(</font>Temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">) = </font><font color="#800000">'User : ' </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ If its the user name then.     }
     </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ Save Name to array and read origin.   }
      </i></font>INC<font color="#000080">(</font>NumFound<font color="#000080">);
      </font>FInf<font color="#000080">[</font>NumFound<font color="#000080">].</font>Name <font color="#000080">:= </font>Copy<font color="#000080">(</font>Temp<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>Length<font color="#000080">(</font>Temp<font color="#000080">));
      </font>ReadLn<font color="#000080">(</font>InFile<font color="#000080">,</font>FInf<font color="#000080">[</font>NumFound<font color="#000080">].</font>Origin<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>NumFound <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
   </b></font>NumFound <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Close<font color="#000080">(</font>InFile<font color="#000080">);                </font><font color="#008000"><i>{ Close file.                           }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{ReadList}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SortList<font color="#000080">;
                         </font><font color="#008000"><i>{ Routine to sort the list of conference       }
                         { members using a simple bubble sort.          }
</i></font><font color="#FF0000"><b>VAR
   </b></font>Temp  <font color="#000080">:</font>MessInfType<font color="#000080">;          </font><font color="#008000"><i>{ Temporary record for swapping.        }
   </i></font>Index1<font color="#000080">,</font>Index2<font color="#000080">:</font>WORD<font color="#000080">;          </font><font color="#008000"><i>{ Sort loop variables.                  }
</i></font><font color="#FF0000"><b>BEGIN
  FOR </b></font>Index1 <font color="#000080">:= </font>NumFound <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO
   FOR </b></font>Index2 <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>Index1 <font color="#FF0000"><b>DO
    IF </b></font>FInf<font color="#000080">[</font>Index2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">].</font>Name <font color="#000080">&gt; </font>FInf<font color="#000080">[</font>Index2<font color="#000080">].</font>Name <font color="#FF0000"><b>THEN
     BEGIN
      </b></font>Temp <font color="#000080">:= </font>FInf<font color="#000080">[</font>Index2<font color="#000080">];
      </font>FInf<font color="#000080">[</font>Index2<font color="#000080">] := </font>FInf<font color="#000080">[</font>Index2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
      </font>FInf<font color="#000080">[</font>Index2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] := </font>Temp<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{SortList}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Writeln<font color="#000080">(</font>ProgTitle<font color="#000080">);           </font><font color="#008000"><i>{ Display program title.                }

  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>NotNumber<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
                                </b></font><font color="#008000"><i>{ If wrong command argument show proper }
    </i></font>Syntax_Error                <font color="#008000"><i>{ syntax to use.                        }
  </i></font><font color="#FF0000"><b>ELSE
   BEGIN
    </b></font>InitVars<font color="#000080">;                   </font><font color="#008000"><i>{ Initialize variables.                 }
    </i></font><font color="#FF0000"><b>IF </b></font>fExist<font color="#000080">(</font>QWKName<font color="#000080">) </font><font color="#FF0000"><b>THEN     </b></font><font color="#008000"><i>{ If it exists begin processing.        }
     </i></font><font color="#FF0000"><b>BEGIN
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-Opening Packet'</font><font color="#000080">);
      </font>OpenPacket<font color="#000080">(</font>QWKName<font color="#000080">);      </font><font color="#008000"><i>{ Open mail packet.                     }
      </i></font><font color="#FF0000"><b>IF </b></font>fExist<font color="#000080">(</font>WorkDir<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>PadStr<font color="#000080">(</font>Left<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">)+</font><font color="#800000">'.NDX'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
       BEGIN                    </b></font><font color="#008000"><i>{ IF there are any Messages in conf then}
                                { Attempt to read NDX files.            }
        </i></font>Writeln<font color="#000080">(</font><font color="#800000">'-Reading NDX file'</font><font color="#000080">);

        </font><font color="#FF0000"><b>IF </b></font>ReadNDX <font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>{ IF there is no error, read messages.  }
         </i></font><font color="#FF0000"><b>BEGIN

          IF </b></font>fExist<font color="#000080">(</font>OutFile<font color="#000080">) </font><font color="#FF0000"><b>THEN</b></font><font color="#008000"><i>{ IF Conf list already exist then read.}
           </i></font><font color="#FF0000"><b>BEGIN
            </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-Reading '</font><font color="#000080">,</font>OutFile<font color="#000080">);
            </font>ReadList<font color="#000080">;

           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

          </font>Writeln<font color="#000080">(</font><font color="#800000">'-Reading Messages in conference ['</font><font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">']'</font><font color="#000080">);
          </font>ReadMsgs<font color="#000080">;

          </font><font color="#FF0000"><b>IF </b></font>NewMems <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
           BEGIN

            IF </b></font>fExist<font color="#000080">(</font>OutFile<font color="#000080">) </font><font color="#FF0000"><b>THEN
             BEGIN
              </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-Renaming '</font><font color="#000080">,</font>OutFile<font color="#000080">,</font><font color="#800000">' to '</font><font color="#000080">,</font>Copy<font color="#000080">(</font>OutFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">)+</font><font color="#800000">'.BAK'</font><font color="#000080">);

              </font><font color="#FF0000"><b>IF </b></font>fExist<font color="#000080">(</font>Copy<font color="#000080">(</font>OutFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">)+</font><font color="#800000">'.BAK'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
               BEGIN
                </b></font>Assign<font color="#000080">(</font>OutHan<font color="#000080">,</font>Copy<font color="#000080">(</font>OutFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">)+</font><font color="#800000">'.BAK'</font><font color="#000080">);
                </font>Erase<font color="#000080">(</font>OutHan<font color="#000080">);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

              </font>Assign<font color="#000080">(</font>OutHan<font color="#000080">,</font>OutFile<font color="#000080">);
              </font>Rename<font color="#000080">(</font>OutHan<font color="#000080">,</font>Copy<font color="#000080">(</font>OutFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">)+</font><font color="#800000">'.BAK'</font><font color="#000080">);
             </font><font color="#FF0000"><b>END
            ELSE
             BEGIN
              </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-Creating '</font><font color="#000080">,</font>OutFile<font color="#000080">);
              </font>Assign<font color="#000080">(</font>OutHan<font color="#000080">,</font>OutFile<font color="#000080">);
              </font><font color="#008000"><i>{$I-}
              </i></font>Rewrite<font color="#000080">(</font>OutHan<font color="#000080">);
              </font><font color="#008000"><i>{$I+}
              </i></font>Close<font color="#000080">(</font>OutHan<font color="#000080">);
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font>Writeln<font color="#000080">(</font><font color="#800000">'-Sorting member list'</font><font color="#000080">);
            </font>SortList<font color="#000080">;
            </font>Writeln<font color="#000080">(</font><font color="#800000">'-Saving '</font><font color="#000080">,</font>NewMems<font color="#000080">,
                    </font><font color="#800000">' new members for a total of '</font><font color="#000080">,</font>NumFound<font color="#000080">,</font><font color="#800000">' members'</font><font color="#000080">);
            </font>SaveList<font color="#000080">;
           </font><font color="#FF0000"><b>END
          ELSE
           </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-No new members found'</font><font color="#000080">);
         </font><font color="#FF0000"><b>END
        ELSE
         </b></font>Writeln<font color="#000080">(</font><font color="#800000">'-Error reading NDX file'</font><font color="#000080">,^</font>G<font color="#000080">);
       </font><font color="#FF0000"><b>END
      ELSE                      </b></font><font color="#008000"><i>{ Other wise let user know its not there.}
       </i></font>Writeln<font color="#000080">(</font><font color="#800000">'-NDX file for conference ['</font><font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">),
               </font><font color="#800000">'] does not exist. No new messages?'</font><font color="#000080">^</font>G<font color="#000080">);

      </font>Writeln<font color="#000080">(</font><font color="#800000">'-Deleteing Work Directory'</font><font color="#000080">);
      </font>DelWorkDir<font color="#000080">;               </font><font color="#008000"><i>{ Delete Work Directory.                }
      {$I-}                     { Turn I/O checking off.                }
      </i></font>RMDir<font color="#000080">(</font>WorkDir<font color="#000080">);           </font><font color="#008000"><i>{ Remove work Directory.                }
      {$I+}                     { Turn I/O checking on.                 }
      </i></font><font color="#FF0000"><b>IF </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN     </b></font><font color="#008000"><i>{ If and error occurs then              }
      </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Error Removing work directory.'</font><font color="#000080">,^</font>G<font color="#000080">);

     </font><font color="#FF0000"><b>END
    ELSE                        </b></font><font color="#008000"><i>{ .... Otherwise ......                 }
     </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ Show error message and beep.          }
      </i></font>Writeln<font color="#000080">(^</font>G<font color="#000080">,</font><font color="#800000">'Cannot find '</font><font color="#000080">,</font>QWKName<font color="#000080">);
      </font>Writeln<font color="#000080">(</font><font color="#800000">'Tracking aborted!!'</font><font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{NMembers}
{***********************************************************************}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0020.PAS">Original</a><b>]</b></p></body>
</html>
