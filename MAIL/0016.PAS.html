<html>
<head><title> "QWK packets to text" by DAVID DANIEL ANDERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{DAT2TXT v0.90- Free DOS utility: Converts .QWK MESSAGES.DAT to text.}
{$V-,S-}
</i></font><font color="#FF0000"><b>program </b></font>DAT2TXT <font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>dos <font color="#000080">;
</font><font color="#FF0000"><b>const
   </b></font>Seperator <font color="#000080">= </font><font color="#800000">'---------------------------------------------------------------------------' </font><font color="#000080">;
   </font>herald    <font color="#000080">= </font><font color="#800000">'===========================================================================' </font><font color="#000080">;
</font><font color="#FF0000"><b>type
   </b></font>CharArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;  </font><font color="#008000"><i>{ to read in chunks }

   </i></font>MSGDATHdr <font color="#000080">= </font><font color="#FF0000"><b>record  </b></font><font color="#008000"><i>{ ALSO the format for SWAG files !!! }
      </i></font>Status   <font color="#000080">: </font>char <font color="#000080">;
      </font>MSGNum   <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>Date     <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>Time     <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>UpTO     <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>UpFROM   <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>Subject  <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>PassWord <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>ReferNum <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
      </font>NumChunk <font color="#000080">: </font>CharArray <font color="#000080">;
      </font>Alive    <font color="#000080">: </font>byte <font color="#000080">;
      </font>LeastSig <font color="#000080">: </font>byte <font color="#000080">;
      </font>MostSig  <font color="#000080">: </font>byte <font color="#000080">;
      </font>Reserved <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
   </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>F           <font color="#000080">: </font><font color="#FF0000"><b>file </b></font><font color="#000080">;
   </font>txtfile     <font color="#000080">: </font>text <font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>showhelp<font color="#000080">(</font>problem<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#008000"><i>{if any *foreseen* errors arise, we are sent}
                             { here to give a little help and exit peacefully }
</i></font><font color="#FF0000"><b>const
 </b></font>progdata <font color="#000080">= </font><font color="#800000">'DAT2TXT v0.90- Free DOS utility: Converts .QWK MESSAGES.DAT to text.'</font><font color="#000080">;
 </font>progdat2 <font color="#000080">= </font><font color="#800000">'(By SWAG contributors.)'</font><font color="#000080">;
 </font>usage    <font color="#000080">= </font><font color="#800000">'Usage:  DAT2TXT infile(s) [/o]'</font><font color="#000080">;
 </font>usag2    <font color="#000080">= </font><font color="#800000">'The &quot;/o&quot; causes DAT2TXT to overwrite (not append to) existing messages.txt.'</font><font color="#000080">;
 </font>note     <font color="#000080">= </font><font color="#800000">'DOS * and ? wildcards ok with &quot;infile(s)&quot;.  Output is always to MESSAGES.TXT.'</font><font color="#000080">;
</font><font color="#FF0000"><b>var
   message </b></font><font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
   </b></font>writeln<font color="#000080">(</font>progdata<font color="#000080">);                  </font><font color="#008000"><i>{ just tell user what this program   }
   </i></font>writeln<font color="#000080">(</font>progdat2<font color="#000080">);                  </font><font color="#008000"><i>{ is and who wrote it                }
   </i></font>writeln<font color="#000080">;
   </font>writeln<font color="#000080">(</font>usage<font color="#000080">);
   </font>writeln<font color="#000080">(</font>usag2<font color="#000080">);
   </font>writeln<font color="#000080">(</font>note<font color="#000080">);
   </font>writeln<font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#800000">'Error encountered:'</font><font color="#000080">);
   </font><font color="#FF0000"><b>case </b></font>problem <font color="#FF0000"><b>of
     </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>message </b></font><font color="#000080">:= </font><font color="#800000">'Incorrect number of parameters.'</font><font color="#000080">;
     </font><font color="#008000"><i>{ plenty of room for other errors! }
   </i></font><font color="#FF0000"><b>else
        message </b></font><font color="#000080">:= </font><font color="#800000">'Unknown error.'</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">);
   </font>halt<font color="#000080">(</font>problem<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>converttoupper<font color="#000080">(</font>w <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>cp  <font color="#000080">: </font>integer<font color="#000080">;        </font><font color="#008000"><i>{the position of the character to change.}
</i></font><font color="#FF0000"><b>begin
     for </b></font>cp <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>w<font color="#000080">) </font><font color="#FF0000"><b>do
         </b></font>w<font color="#000080">[</font>cp<font color="#000080">] := </font>upcase<font color="#000080">(</font>w<font color="#000080">[</font>cp<font color="#000080">]);
     </font>converttoupper <font color="#000080">:= </font>w<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ArrayTOInteger <font color="#000080">( </font>B <font color="#000080">: </font>CharArray <font color="#000080">; </font>Len <font color="#000080">: </font>byte <font color="#000080">) : </font>longint <font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>I <font color="#000080">: </font>byte <font color="#000080">;
    </font>S <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">;
    </font>E <font color="#000080">: </font>integer <font color="#000080">;
    </font>T <font color="#000080">: </font>integer <font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>S <font color="#000080">:= </font><font color="#800000">'' </font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Len <font color="#FF0000"><b>do
      if </b></font>B<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#32 </font><font color="#FF0000"><b>then </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font>B<font color="#000080">[</font>i<font color="#000080">] ;

   </font>Val <font color="#000080">( </font>S<font color="#000080">, </font>T<font color="#000080">, </font>E <font color="#000080">);

   </font><font color="#FF0000"><b>if </b></font>E <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>ArrayToInteger <font color="#000080">:= </font>T
   <font color="#FF0000"><b>else
      </b></font>ArrayToInteger <font color="#000080">:= </font><font color="#800000">0 </font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ReadWriteHdr <font color="#000080">( </font><font color="#FF0000"><b>var </b></font>HDR <font color="#000080">: </font>MSGDatHdr <font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>BlockRead <font color="#000080">( </font>F<font color="#000080">, </font>Hdr<font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>ArrayToInteger <font color="#000080">( </font>Hdr<font color="#000080">.</font>NumChunk<font color="#000080">, </font><font color="#800000">6 </font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      with </b></font>Hdr <font color="#FF0000"><b>do begin
         </b></font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font>herald <font color="#000080">);
         </font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'Date: '</font><font color="#000080">, </font>Date<font color="#000080">, </font><font color="#800000">' ('</font><font color="#000080">, </font>Time<font color="#000080">, </font><font color="#800000">')' </font><font color="#000080">);
         </font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">'Number: '</font><font color="#000080">, </font>MSGNum <font color="#000080">);
         </font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'From: '</font><font color="#000080">, </font>UpFROM <font color="#000080">);
         </font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">'Refer#: '</font><font color="#000080">, </font>ReferNum <font color="#000080">);
         </font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'  To: '</font><font color="#000080">, </font>UpTO <font color="#000080">);
         </font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">'Recvd: ' </font><font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>Status <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'`'</font><font color="#000080">, </font><font color="#800000">'^'</font><font color="#000080">, </font><font color="#800000">'#'</font><font color="#000080">] </font><font color="#FF0000"><b>then
            </b></font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'YES' </font><font color="#000080">)
         </font><font color="#FF0000"><b>else
            </b></font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'NO' </font><font color="#000080">);
         </font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'Subj: '</font><font color="#000080">, </font>Subject <font color="#000080">);
         </font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">'Conf: '</font><font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">, (</font>MostSig <font color="#000080">* </font><font color="#800000">256</font><font color="#000080">) + </font>LeastSig<font color="#000080">, </font><font color="#800000">')' </font><font color="#000080">);
         </font>writeln <font color="#000080">( </font>txtfile<font color="#000080">, </font>Seperator <font color="#000080">);
      </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ReadMSG <font color="#000080">( </font>NumChunks <font color="#000080">: </font>integer <font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>Buff <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">;
   </font>J    <font color="#000080">: </font>integer <font color="#000080">;
   </font>I    <font color="#000080">: </font>byte <font color="#000080">;

</font><font color="#FF0000"><b>begin
   for </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>PRED <font color="#000080">( </font>NumChunks <font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>BlockRead <font color="#000080">( </font>F<font color="#000080">, </font>Buff<font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">);
      </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">128 </font><font color="#FF0000"><b>do
         if </b></font>Buff <font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">#$E3 </font><font color="#FF0000"><b>then
            </b></font>writeln <font color="#000080">( </font>txtfile <font color="#000080">)
         </font><font color="#FF0000"><b>else
            </b></font>write <font color="#000080">( </font>txtfile<font color="#000080">, </font>Buff <font color="#000080">[</font>I<font color="#000080">] );
   </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ReadMessage <font color="#000080">( </font>HDR <font color="#000080">: </font>MSGDatHdr <font color="#000080">; </font>RelNum <font color="#000080">: </font>longint <font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Chunks <font color="#000080">: </font>integer <font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>Seek <font color="#000080">( </font>F<font color="#000080">, </font>RelNum <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">);
   </font>ReadWriteHdr <font color="#000080">( </font>HDR <font color="#000080">);
   </font>Chunks <font color="#000080">:= </font>ArrayToInteger <font color="#000080">( </font>HDR<font color="#000080">.</font>NumChunk<font color="#000080">, </font><font color="#800000">6 </font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>Chunks <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>ReadMsg <font color="#000080">( </font>Chunks <font color="#000080">);
      </font>writeln <font color="#000080">( </font>txtfile <font color="#000080">);
   </font><font color="#FF0000"><b>end
   else
      </b></font>Chunks <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>MSGHdr   <font color="#000080">: </font>MSGDatHdr <font color="#000080">;
   </font>repordat <font color="#000080">: </font>boolean <font color="#000080">;
   </font>ch       <font color="#000080">: </font>char <font color="#000080">;
   </font>count    <font color="#000080">: </font>integer <font color="#000080">;
   </font>chunks   <font color="#000080">: </font>integer <font color="#000080">;
   </font>defsavefile <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">;
   </font>fileinfo <font color="#000080">: </font>searchrec <font color="#000080">;
   </font>fdt      <font color="#000080">: </font>longint <font color="#000080">;
   </font>ps1<font color="#000080">,</font>ps2  <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] ;
   </font>fileexists<font color="#000080">,
   </font>overwrite  <font color="#000080">: </font>boolean <font color="#000080">;
   </font>response   <font color="#000080">: </font>char <font color="#000080">;

   </font>dpath<font color="#000080">, </font>tpath  <font color="#000080">: </font>pathstr <font color="#000080">;
   </font><font color="#008000"><i>{epath &amp; dpath are fully qualified pathnames of .dat &amp; .txt files}

   </i></font>ddir<font color="#000080">,  </font>tdir   <font color="#000080">: </font>dirstr <font color="#000080">;
   </font>dname<font color="#000080">, </font>tname  <font color="#000080">: </font>namestr <font color="#000080">;
   </font>d_ext<font color="#000080">, </font>t_ext  <font color="#000080">: </font>extstr <font color="#000080">;
   </font>txtfileinfo   <font color="#000080">: </font>searchrec <font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">( </font>paramcount <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>paramcount <font color="#000080">&gt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>showhelp<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font>ps1 <font color="#000080">:= </font>converttoupper <font color="#000080">( </font>paramstr <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ps1 <font color="#000080">= </font><font color="#800000">'/H'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ps1 <font color="#000080">= </font><font color="#800000">'/?'</font><font color="#000080">) </font><font color="#FF0000"><b>or
      </b></font><font color="#000080">(</font>ps1 <font color="#000080">= </font><font color="#800000">'-H'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ps1 <font color="#000080">= </font><font color="#800000">'-?'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>showhelp<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);

   </font>DefSaveFile <font color="#000080">:= </font><font color="#800000">'' </font><font color="#000080">;
   </font>ps2 <font color="#000080">:= </font><font color="#800000">'/A' </font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>ps2 <font color="#000080">:= </font>paramstr <font color="#000080">( </font><font color="#800000">2 </font><font color="#000080">);
   </font>overwrite <font color="#000080">:= (</font>upcase <font color="#000080">( </font>ps2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] ) = </font><font color="#800000">'O'</font><font color="#000080">);
   </font>dpath <font color="#000080">:= </font>fexpand <font color="#000080">( </font>paramstr <font color="#000080">( </font><font color="#800000">1 </font><font color="#000080">) );
   </font>fsplit <font color="#000080">( </font>dpath<font color="#000080">, </font>ddir<font color="#000080">, </font>dname<font color="#000080">, </font>d_ext <font color="#000080">);
   </font><font color="#008000"><i>{ break up path into components }
   </i></font>findfirst <font color="#000080">( </font>dpath<font color="#000080">, </font>anyfile<font color="#000080">, </font>fileinfo <font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>doserror <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
      </b></font>fsplit <font color="#000080">( </font>fexpand <font color="#000080">( </font>fileinfo<font color="#000080">.</font>name <font color="#000080">), </font>tdir<font color="#000080">, </font>tname<font color="#000080">, </font>t_ext <font color="#000080">);
      </font>dpath <font color="#000080">:= </font>ddir <font color="#000080">+ </font>fileinfo<font color="#000080">.</font>name <font color="#000080">;
      </font>tpath <font color="#000080">:= </font>ddir <font color="#000080">+ </font>tname <font color="#000080">+ </font><font color="#800000">'.TXT' </font><font color="#000080">;
      </font>Assign <font color="#000080">( </font>F<font color="#000080">, </font>dpath <font color="#000080">);
      </font><font color="#008000"><i>{ whatever file .. ( MESSAGES.DAT for .QWK ) }
      </i></font>Reset <font color="#000080">( </font>F<font color="#000080">, </font>SizeOf <font color="#000080">( </font>MsgHdr <font color="#000080">) );

      </font>assign <font color="#000080">( </font>txtfile<font color="#000080">, </font>tpath <font color="#000080">);
</font><font color="#008000"><i>{$i-} </i></font>reset <font color="#000080">( </font>txtfile <font color="#000080">); </font><font color="#008000"><i>{$i+}
      </i></font>fileexists <font color="#000080">:= (</font>ioresult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);

      </font><font color="#FF0000"><b>if </b></font>fileexists <font color="#FF0000"><b>then </b></font>close <font color="#000080">( </font>txtfile <font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>fileexists <font color="#FF0000"><b>and </b></font><font color="#000080">( </font><font color="#FF0000"><b>not </b></font>overwrite <font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>append <font color="#000080">( </font>txtfile <font color="#000080">)
      </font><font color="#FF0000"><b>else
         </b></font>rewrite <font color="#000080">( </font>txtfile <font color="#000080">);

      </font>write <font color="#000080">( </font><font color="#800000">'DAT2TXT: '</font><font color="#000080">, </font>dpath<font color="#000080">, </font><font color="#800000">' to: '</font><font color="#000080">, </font>tpath <font color="#000080">);
      </font>Count <font color="#000080">:= </font><font color="#800000">2 </font><font color="#000080">;                     </font><font color="#008000"><i>{ start at RECORD #2 }
      </i></font><font color="#FF0000"><b>while </b></font>Count <font color="#000080">&lt; </font>FileSize <font color="#000080">( </font>F <font color="#000080">) </font><font color="#FF0000"><b>do begin
         </b></font>ReadMessage <font color="#000080">( </font>MSGHdr<font color="#000080">, </font>Count<font color="#000080">, </font>Chunks <font color="#000080">);
         </font>INC <font color="#000080">( </font>Count<font color="#000080">, </font>Chunks <font color="#000080">);
      </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

      </font>getftime <font color="#000080">( </font>F<font color="#000080">, </font>fdt <font color="#000080">);
      </font>close <font color="#000080">( </font>F <font color="#000080">); </font>close <font color="#000080">( </font>txtfile <font color="#000080">); </font>reset <font color="#000080">( </font>txtfile <font color="#000080">);
      </font>setftime <font color="#000080">( </font>txtfile <font color="#000080">, </font>fdt <font color="#000080">);
      </font>close <font color="#000080">( </font>txtfile <font color="#000080">);

      </font>writeln <font color="#000080">( </font><font color="#800000">', done!' </font><font color="#000080">);
      </font>findnext <font color="#000080">( </font>fileinfo <font color="#000080">);
   </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
