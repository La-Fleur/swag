<html>
<head><title> "JAM Message Base Unit" by MARTIN WOODS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
12 Jan 96 17:12, Mark Tassin wrote to All:
 MT&gt; Can anybody help me find a Documented JAM message base unit for
 MT&gt; TP 7.0? The one in JAMAPI would suffice except that all of the
 MT&gt; functions that you can perform with it are undocumented, thus I
 MT&gt; have to hunt through a slew function calls guessing what values I
 MT&gt; should pass to them... RADU comes with the ability to post to
 MT&gt; Hudson Message bases, but does not claim to support JAM, can
 MT&gt; anybody point me to something that will let me post messages to
 MT&gt; the JAM message base or am I screwed?


MKSM106.LZH    226200  12-22-94  MK Source for Msg Access v1.06 - Mark May's
                                 Pascal OOP source code to access Squish,
                                 Jam, Hudson, *.Msg, and Ezycom message
                                 bases. Great for developing BBS utilities.
                                 (FW)

Get the above archive,and here is
a generic reader that I put together using Mark's units/source...


(*   Generic Message Reader by Martin Woods 1:351/233.1      *)
(* To use this you need MKSM106.LZH , Mark May's OOP library *)
(* which should be availible just about anywhere             *)
(* This program will read the following:                     *)
(*          HUDSON,SQUISH,*.MSG,EZY and JAM                  *)
(*    thanks to Mark May for writing a great Library!        *)

Program Reader;
{$M 16384, 0, 655360}
{$I MKB.Def}

{$X+}

  </i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">,</font>MKMsgAbs<font color="#000080">, </font>MKOpen<font color="#000080">, </font>MKDos<font color="#000080">, </font>MKstring<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MsgOut<font color="#000080">: </font>AbsMsgPtr<font color="#000080">;
  </font>TmpStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>AreaId<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>ch<font color="#000080">:</font>char<font color="#000080">;
  </font>a<font color="#000080">,</font>b<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>StLen <font color="#000080">= </font><font color="#800000">78</font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
If </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'/?'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
  Begin
  </b></font>textattr<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
  </font>clrscr<font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>textcolor<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'         Generic  READER version 01.0 by Martin Woods,June 1995'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>textcolor<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           Proper syntax is:'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           READER MsgAreaId'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           Squish MsgAreaId Example = SC:\Max\Msg\Muffin'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           Hudson MsgAreaId Example = H042C:\RA\MsgBase'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           *.Msg  MsgAreaId Example = FC:\Mail'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           Ezy    MsgAreaId Example = E0001C:\Ezy\MsgBase'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'           Jam    MsgAreaId Example = JC:\Msg\General'</font><font color="#000080">);
  </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>AreaId <font color="#000080">:= </font>Upper<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));

</font><font color="#FF0000"><b>If Not </b></font>OpenMsgArea<font color="#000080">(</font>MsgOut<font color="#000080">, </font>AreaId<font color="#000080">) </font><font color="#FF0000"><b>Then
  Begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Unable to open message base'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>textattr<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
  </font>clrscr<font color="#000080">;
  </font>gotoxy<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'Generic READER version 01.0 by Martin Woods,June 1995 '</font><font color="#000080">+</font><font color="#800000">#13</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>Delay<font color="#000080">(</font><font color="#800000">1500</font><font color="#000080">); </font><font color="#008000"><i>{opening screen here}

  </i></font>MsgOut<font color="#000080">^.</font>SeekFirst<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#FF0000"><b>While </b></font>MsgOut<font color="#000080">^.</font>SeekFound <font color="#FF0000"><b>Do
   Begin
     </b></font>window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
     </font>textbackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
     </font>clrscr<font color="#000080">;
     </font>textcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
       </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&Auml;'</font><font color="#000080">);  </font><font color="#008000"><i>{ header starts here }
         </i></font>textcolor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
         </font>MsgOut<font color="#000080">^.</font>MsgStartUp<font color="#000080">;
         </font>WriteLn<font color="#000080">(</font>MsgOut<font color="#000080">^.</font>GetMsgNum<font color="#000080">);
         </font>Write<font color="#000080">(</font><font color="#800000">'Message Number: ' </font><font color="#000080">+ </font>Long2Str<font color="#000080">(</font>MsgOut<font color="#000080">^.</font>GetMsgNum<font color="#000080">));
           </font><font color="#FF0000"><b>If </b></font>MsgOut<font color="#000080">^.</font>IsPriv <font color="#FF0000"><b>Then
             </b></font>Write<font color="#000080">(</font><font color="#800000">'  (Priv)'</font><font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>MsgOut<font color="#000080">^.</font>IsRcvd <font color="#FF0000"><b>Then
                 </b></font>Write<font color="#000080">(</font><font color="#800000">' (Rcvd)'</font><font color="#000080">);
                 </font>WriteLn<font color="#000080">;
                 </font>Write<font color="#000080">(</font><font color="#800000">'From: ' </font><font color="#000080">+ </font>PadRight<font color="#000080">(</font>MsgOut<font color="#000080">^.</font>GetFrom<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">45</font><font color="#000080">));
                 </font>Write<font color="#000080">(</font><font color="#800000">'Date: '</font><font color="#000080">);
                 </font>WriteLn<font color="#000080">(</font>ReformatDate<font color="#000080">(</font>MsgOut<font color="#000080">^.</font>GetDate<font color="#000080">, </font><font color="#800000">'MM/DD/YY'</font><font color="#000080">)
                 + </font><font color="#800000">' ' </font><font color="#000080">+ </font>MsgOut<font color="#000080">^.</font>GetTime<font color="#000080">);
                 </font>WriteLn<font color="#000080">(</font><font color="#800000">'To: ' </font><font color="#000080">+ </font>MsgOut<font color="#000080">^.</font>GetTo<font color="#000080">);
                 </font>Write<font color="#000080">(</font><font color="#800000">'Subj: '</font><font color="#000080">);
                 </font>WriteLn<font color="#000080">(</font>MsgOut<font color="#000080">^.</font>GetSubj<font color="#000080">);
                 </font>textcolor<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
                   </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&Auml;'</font><font color="#000080">); </font><font color="#008000"><i>{ header ends here }
                     </i></font>window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">); </font><font color="#008000"><i>{make a window to scroll message}
                     </i></font>textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
                     </font>textbackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                     </font>clrscr<font color="#000080">;
                     </font>WriteLn<font color="#000080">;
                     </font>MsgOut<font color="#000080">^.</font>MsgTxtStartUp<font color="#000080">;
              </font><font color="#FF0000"><b>repeat

    </b></font>TmpStr <font color="#000080">:= </font>MsgOut<font color="#000080">^.</font>GetString<font color="#000080">(</font>StLen<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font>TmpStr<font color="#000080">);
    </font>TmpStr <font color="#000080">:= </font>MsgOut<font color="#000080">^.</font>GetString<font color="#000080">(</font>StLen<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then
         begin
           </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
             </font><font color="#FF0000"><b>if </b></font>ch <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>then </b></font>halt<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>if </b></font>ch <font color="#000080">= </font><font color="#800000">#13 </font><font color="#FF0000"><b>then
               begin
                 </b></font>WriteLn<font color="#000080">(</font>TmpStr<font color="#000080">);
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>wherey <font color="#000080">&gt; </font><font color="#800000">15 </font><font color="#FF0000"><b>then
        begin
          </b></font>textcolor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
          </font>textbackground<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
          </font>writeln<font color="#000080">;
          </font>writeln<font color="#000080">;
          </font>write<font color="#000080">(</font><font color="#800000">' Esc to Quit  -   Press enter to Continue: '</font><font color="#000080">); </font><font color="#008000"><i>{status line}
          </i></font>clreol<font color="#000080">;
          </font>textattr<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
          </font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
            </font><font color="#FF0000"><b>if </b></font>ch <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>then </b></font>halt<font color="#000080">;
              </font>clrscr<font color="#000080">;
              </font>textcolor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>MsgOut<font color="#000080">^.</font>EOM <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ioresult <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">);
    </font>textcolor<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
    </font>textbackground<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">);  </font><font color="#008000"><i>{this is funky,any ideas how to optimize?}
    </i></font>write<font color="#000080">(</font><font color="#800000">' Esc to Quit  -   Press enter to Continue:                     End
</font>ofMsg<font color="#000080">: </font><font color="#800000">');clreol; {got word wrapped here}
    </font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>ch <font color="#000080">= </font><font color="#800000">#27 </font><font color="#FF0000"><b>then </b></font>halt<font color="#000080">;
        </font>clrscr<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>TmpStr<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
             </b></font>WriteLn<font color="#000080">(</font>TmpStr<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>IoResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then</b></font><font color="#000080">;
                  </font>MsgOut<font color="#000080">^.</font>SeekNext<font color="#000080">;
              </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                 </font><font color="#FF0000"><b>If Not </b></font>CloseMsgArea<font color="#000080">(</font>MsgOut<font color="#000080">) </font><font color="#FF0000"><b>Then</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0031.PAS">Original</a><b>]</b></p></body>
</html>
