<html>
<head><title> "Read SWG or QWK Files" by GAYLE DAVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$V-,S-}
{ this SIMPLE little ditty let's you read SWAG or QWK files which have
  EXACTLY the same format }
</i></font><font color="#FF0000"><b>Program </b></font>ReadQWKORSWAGFile<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Seperator <font color="#000080">= </font><font color="#800000">'---------------------------------------------------------------------------'</font><font color="#000080">;

</font><font color="#FF0000"><b>Type

  </b></font>CharArray <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;  </font><font color="#008000"><i>{ to read in chunks }

  </i></font>MSGDATHdr <font color="#000080">= </font><font color="#FF0000"><b>Record  </b></font><font color="#008000"><i>{ ALSO the format for SWAG files !!! }
    </i></font>Status   <font color="#000080">: </font>Char<font color="#000080">;
    </font>MSGNum   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Date     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Time     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UpTO     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UpFROM   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Subject  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>PassWord <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>ReferNum <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>NumChunk <font color="#000080">: </font>CharArray<font color="#000080">;
    </font>Alive    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>LeastSig <font color="#000080">: </font>Byte<font color="#000080">;
    </font>MostSig  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Reserved <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>F           <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>DefSaveFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Number      <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ArrayTOInteger<font color="#000080">(</font>B <font color="#000080">: </font>CharArray<font color="#000080">; </font>Len <font color="#000080">: </font>BYTE<font color="#000080">) : </font>LONGINT<font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
    </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
    </font>E  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>T  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
    </b></font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>PRED<font color="#000080">(</font>Len<font color="#000080">) </font><font color="#FF0000"><b>DO IF </b></font>B<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#32 </font><font color="#FF0000"><b>THEN </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font>B<font color="#000080">[</font>i<font color="#000080">];
    </font>Val <font color="#000080">(</font>S<font color="#000080">, </font>T<font color="#000080">, </font>E<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>E <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>ArrayToInteger <font color="#000080">:= </font>T<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMSG <font color="#000080">(</font>NumChunks <font color="#000080">: </font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Buff <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>J    <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>I    <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>PRED<font color="#000080">(</font>NumChunks<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">, </font>Buff<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">128 </font><font color="#FF0000"><b>do
      If </b></font>Buff <font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">#$E3 </font><font color="#FF0000"><b>then
        </b></font>Writeln
      <font color="#FF0000"><b>else
        </b></font>Write <font color="#000080">(</font>Buff <font color="#000080">[</font>I<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadWriteHdr <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>HDR <font color="#000080">: </font>MSGDatHdr<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">, </font>Hdr<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Hdr <font color="#FF0000"><b>do
  begin
    </b></font>Write <font color="#000080">(</font><font color="#800000">'Date: '</font><font color="#000080">, </font>Date<font color="#000080">, </font><font color="#800000">' ('</font><font color="#000080">, </font>Time<font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">'Number: '</font><font color="#000080">, </font>MSGNum<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'From: '</font><font color="#000080">, </font>UpFROM<font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">'Refer#: '</font><font color="#000080">, </font>ReferNum<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'  To: '</font><font color="#000080">, </font>UpTO<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">'Recvd: '</font><font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Status <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'`'</font><font color="#000080">, </font><font color="#800000">'^'</font><font color="#000080">, </font><font color="#800000">'#'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      </b></font>Writeln <font color="#000080">(</font><font color="#800000">'YES'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>Writeln <font color="#000080">(</font><font color="#800000">'NO'</font><font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'Subj: '</font><font color="#000080">, </font>Subject<font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">'Conf: '</font><font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">, </font>LeastSig<font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font>Seperator<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMessage <font color="#000080">(</font>HDR <font color="#000080">: </font>MSGDatHdr<font color="#000080">; </font>RelNum <font color="#000080">: </font>LONGINT<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Chunks <font color="#000080">: </font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Seek<font color="#000080">(</font>F<font color="#000080">,</font>RelNum<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>ReadWriteHdr <font color="#000080">(</font>HDR<font color="#000080">);
  </font>Chunks <font color="#000080">:= </font>ArrayToInteger<font color="#000080">(</font>HDR<font color="#000080">.</font>NumChunk<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
  </font>ReadMsg <font color="#000080">(</font>Chunks<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MSGHdr   <font color="#000080">: </font>MSGDatHdr<font color="#000080">;
  </font>REPorDAT <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>ch       <font color="#000080">: </font>CHAR<font color="#000080">;
  </font>count    <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>chunks   <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>begin

  </b></font>DefSaveFile <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>DirectVideo <font color="#000080">:= </font>False<font color="#000080">;
  </font>Assign <font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'\SWAG\FILES\EGAVGA.SWG'</font><font color="#000080">); </font><font color="#008000"><i>{ whatever file ..    }
                                        { MESSAGES.DAT for .QWK}
  </i></font>Reset <font color="#000080">(</font>F<font color="#000080">, </font>SizeOf<font color="#000080">(</font>MsgHdr<font color="#000080">));
  </font>Count <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ start at RECORD #2 }
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Count <font color="#000080">&lt; </font>FileSize<font color="#000080">(</font>F<font color="#000080">)) </font><font color="#FF0000"><b>DO
        BEGIN
        </b></font>ClrScr<font color="#000080">;
        </font>ReadMessage <font color="#000080">(</font>MSGHdr<font color="#000080">, </font>Count<font color="#000080">, </font>Chunks<font color="#000080">);
        </font>Writeln<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'..any key to continue .. (any FN Key quits)'</font><font color="#000080">);
        </font>ch <font color="#000080">:= </font>Readkey<font color="#000080">;  </font><font color="#008000"><i>{ any FN key quits }
        </i></font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>THEN </b></font>HALT<font color="#000080">;
        </font>INC<font color="#000080">(</font>Count<font color="#000080">,</font>Chunks<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Close <font color="#000080">(</font>F<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
