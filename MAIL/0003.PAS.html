<html>
<head><title> "MSGINFO.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>VERBOSITY_INDEX<font color="#000080">;
</font><font color="#008000"><i>{
JUSTIN MARQUEZ

  Reads a FidoNet *.MSG File areas and logs info about authorship and
  &quot;verbosity&quot; found in the messages.

  Requires Turbo Pascal 7.xx or Borland Pascal 7.xx (for the StringS Unit)

  OutPut is redirectable.  Can be quickly sorted With Dos's SORT.COM
  Here is a batch File you may find useful:

rem YAK.BAT
verbose %1 &gt; zap.txt
sort &lt; zap.txt &gt; yak.txt /+37 /R
del zap.txt

   This Program is written by Justin Marquez, FidoNet 106/100
   It is being donated to all as a PUBLIC DOMAIN Program, which may be
   freely used, copied and modified as you please.

   &quot;if you improve on it, I'd like a copy of the modifications For my
   own edification!&quot;
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Strings<font color="#000080">,
  </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>FidoMessageHeader <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>FromUser  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">;
    </font>ToUser    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">;
    </font>Subject   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">71</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">;
    </font>DateTime  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">;
    </font>TimesRead <font color="#000080">: </font>Word <font color="#000080">;
    </font>DestNode  <font color="#000080">: </font>Word <font color="#000080">;
    </font>OrigNode  <font color="#000080">: </font>Word <font color="#000080">;
    </font>Cost      <font color="#000080">: </font>Word <font color="#000080">;
    </font>OrigNet   <font color="#000080">: </font>Word <font color="#000080">;
    </font>DestNet   <font color="#000080">: </font>Word <font color="#000080">;
    </font>Filler    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">;
    </font>Replyto   <font color="#000080">: </font>Word <font color="#000080">;
    </font>Attribute <font color="#000080">: </font>Word <font color="#000080">;
    </font>NextReply <font color="#000080">: </font>Word <font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Entry <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Author <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">36</font><font color="#000080">];
    </font>Count  <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Bytes  <font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MsgDir<font color="#000080">,
  </font>fn       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>SR       <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>tmp      <font color="#000080">: </font>FidoMessageHeader<font color="#000080">;
  </font>Who_From <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">36</font><font color="#000080">];
  </font>n<font color="#000080">,
  </font>i        <font color="#000080">: </font>Integer<font color="#000080">;
  </font>HiNum    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>rec      <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">512</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Entry<font color="#000080">;
  </font>TotBytes <font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetMsgInfo <font color="#000080">(</font>fname <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Hdr <font color="#000080">: </font>FidoMessageHeader<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>HFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>FidoMessageHeader<font color="#000080">;
  </font>MFile <font color="#000080">: </font>Text<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Hdr<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Hdr<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);  </font><font color="#008000"><i>{ clear it out initially }
  { get msg hdr only }
  </i></font>Assign<font color="#000080">(</font>HFile<font color="#000080">,</font>fname<font color="#000080">);
  </font>Reset<font color="#000080">(</font>HFile<font color="#000080">);
  </font>Seek<font color="#000080">(</font>HFile<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>Read<font color="#000080">(</font>HFile<font color="#000080">, </font>Hdr<font color="#000080">);
  </font>Close<font color="#000080">(</font>HFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Pad_Path<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>s<font color="#000080">[</font>length<font color="#000080">(</font>s<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Process_Name<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>k <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Found <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Found <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    For </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      if </b></font>Who_From <font color="#000080">= </font>rec<font color="#000080">[</font>k<font color="#000080">].</font>author <font color="#FF0000"><b>then
      begin
        </b></font>inc<font color="#000080">(</font>rec<font color="#000080">[</font>k<font color="#000080">].</font>count<font color="#000080">);
        </font>rec<font color="#000080">[</font>k<font color="#000080">].</font>Bytes <font color="#000080">:= </font>rec<font color="#000080">[</font>k<font color="#000080">].</font>Bytes <font color="#000080">+ </font>SR<font color="#000080">.</font>Size<font color="#000080">;
        </font>Found <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>rec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>author <font color="#000080">:= </font>Who_From<font color="#000080">;
    </font>rec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>count  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>rec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>Bytes <font color="#000080">:= </font>rec<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>Bytes <font color="#000080">+ </font>SR<font color="#000080">.</font>Size
  <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>Found <font color="#FF0000"><b>then
  begin
    </b></font>inc<font color="#000080">(</font>n<font color="#000080">);
    </font>Rec<font color="#000080">[</font>n<font color="#000080">].</font>Author <font color="#000080">:= </font>Who_From<font color="#000080">;
    </font>Rec<font color="#000080">[</font>n<font color="#000080">].</font>Count  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>rec<font color="#000080">[</font>n<font color="#000080">].</font>Bytes  <font color="#000080">:= </font>rec<font color="#000080">[</font>n<font color="#000080">].</font>Bytes <font color="#000080">+ </font>SR<font color="#000080">.</font>Size<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Intro_And_Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>rec<font color="#000080">,</font>SizeOf<font color="#000080">(</font>rec<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);  </font><font color="#008000"><i>{ clear it out initially }
  </i></font>HiNum    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>TotBytes <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>n        <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>MsgDir <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
  begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">' VERBOSE &lt;path&gt; &gt;'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'EXAMPLE:'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'VERBOSE C:\OPUS\HOUSYSOP\ '</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' reads all msg Files in the area and reports findings.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' Note: can be redirected to a File or device.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Public Domain from 106/100. Request as VERBOSE.ZIP.'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Process_Files<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Pad_Path<font color="#000080">(</font>MsgDir<font color="#000080">);
  </font>fn <font color="#000080">:= </font>MsgDir <font color="#000080">+ </font><font color="#800000">'*.MSG'</font><font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>fn<font color="#000080">, </font>AnyFile<font color="#000080">, </font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>fn <font color="#000080">:= </font>MsgDir <font color="#000080">+ </font>SR<font color="#000080">.</font>Name<font color="#000080">;
    </font>GetMsgInfo <font color="#000080">(</font>fn<font color="#000080">, </font>tmp<font color="#000080">);
    </font>Who_From <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>Who_From <font color="#000080">:= </font>StrPas<font color="#000080">(</font>StrUpper<font color="#000080">(</font>tmp<font color="#000080">.</font>FromUser<font color="#000080">));
    </font>Inc<font color="#000080">(</font>HiNum<font color="#000080">);
    </font>TotBytes <font color="#000080">:= </font>TotBytes <font color="#000080">+ </font>SR<font color="#000080">.</font>Size<font color="#000080">;
    </font>Process_Name<font color="#000080">;
    </font>FindNext<font color="#000080">(</font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Report_Results<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>WriteLn<font color="#000080">(</font>rec<font color="#000080">[</font>i<font color="#000080">].</font>Author <font color="#000080">: </font><font color="#800000">36</font><font color="#000080">, </font>Rec<font color="#000080">[</font>i<font color="#000080">].</font>Count <font color="#000080">: </font><font color="#800000">4</font><font color="#000080">,
           (</font><font color="#800000">100 </font><font color="#000080">* </font>Rec<font color="#000080">[</font>i<font color="#000080">].</font>Count <font color="#000080">/ </font>HiNum<font color="#000080">) : </font><font color="#800000">6 </font><font color="#000080">: </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">'% '</font><font color="#000080">,
            </font>Rec<font color="#000080">[</font>i<font color="#000080">].</font>Bytes <font color="#000080">: </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">' Bytes or'</font><font color="#000080">,
           (</font><font color="#800000">100 </font><font color="#000080">* </font>Rec<font color="#000080">[</font>i<font color="#000080">].</font>Bytes <font color="#000080">/ </font>TotBytes<font color="#000080">) : </font><font color="#800000">5 </font><font color="#000080">: </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">'% by size' </font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' Total messages found: ' </font><font color="#000080">: </font><font color="#800000">36</font><font color="#000080">, </font>HiNum <font color="#000080">: </font><font color="#800000">4</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">' Total Bytes found   : ' </font><font color="#000080">: </font><font color="#800000">36</font><font color="#000080">, </font>TotBytes <font color="#000080">: </font><font color="#800000">18</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>n<font color="#000080">, </font><font color="#800000">' different Writers found in '</font><font color="#000080">, </font>MsgDir<font color="#000080">, </font><font color="#800000">'.'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Intro_And_Init<font color="#000080">;
  </font>Process_Files<font color="#000080">;
  </font>Report_Results<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
