<html>
<head><title> "RemoteAccess Security Edit" by MARTIN WOODS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
16 Dec 95 18:41, Adam Rutter wrote to Martin Woods:
 AR&gt; ok, well I wanted to know how to CREATE an account in the RA
 AR&gt; userbase.. sorry if I was unclear.. I said I wanted to know both,
 AR&gt; but I know how to read from it already.. if you could post some
 AR&gt; source on creating a user record I would appreciate it... thanks.

{ This is similar to the viewer except it will allow editing of the security
level and writes the new value to the users.bbs,using this as a guide you
could edit each of the other fields in the same way,I would suggest you copy
a users.bbs file into the current work dir to play with first: see main below
}
</i></font><font color="#FF0000"><b>Program </b></font>RA_Security_Edit<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;
</font><font color="#008000"><i>{$I c:\ra\STRUCT.200}
</i></font><font color="#FF0000"><b>Var
   </b></font>UserRec <font color="#000080">: </font>USERSrecord<font color="#000080">;
   </font>UserFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>USERSrecord<font color="#000080">;
   </font>SysPath<font color="#000080">,</font>UserPath<font color="#000080">,</font>ConfigPath <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>SysRec<font color="#000080">: </font>CONFIGrecord<font color="#000080">;
   </font>SysFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>CONFIGrecord<font color="#000080">;
   </font>X<font color="#000080">,</font>a <font color="#000080">: </font>Integer<font color="#000080">;
   </font>Done <font color="#000080">: </font>Boolean<font color="#000080">;
   </font>Ch <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FixPath<font color="#000080">(</font>Path <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    If </b></font>Path<font color="#000080">[</font>Length<font color="#000080">(</font>Path<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>Then
        </b></font>Path <font color="#000080">:= </font>Path<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
     </font>FixPath <font color="#000080">:= </font>Path<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>drawscreen<font color="#000080">;
</font><font color="#FF0000"><b>begin</b></font><font color="#000080">;
   </font>textattr<font color="#000080">:=</font><font color="#800000">14</font><font color="#000080">;
   </font>gotoxy<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>write<font color="#000080">(</font><font color="#800000">' Remote Access Security Edit'</font><font color="#000080">);
   </font>textattr<font color="#000080">:=</font><font color="#800000">$01</font><font color="#000080">;
   </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&Iacute;'</font><font color="#000080">);
   </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">23</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&Auml;'</font><font color="#000080">);
   </font>textattr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;
   </font>gotoxy<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'(PgUp) Last User    (PgDn) Next User    (C)hange Security   (ESC)
</font>Exit<font color="#800000">');end;

</font><font color="#FF0000"><b>Procedure </b></font>Write_New_Record<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>gotoxy<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">);</font>clreol<font color="#000080">;
    </font>write<font color="#000080">(</font><font color="#800000">'Levels: [L]ockout, [U]nvalidated, [R]egular, [V]ip, [S]ysop. ?'</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat </b></font>ch <font color="#000080">:= </font>upcase<font color="#000080">(</font>readkey<font color="#000080">) </font><font color="#FF0000"><b>until </b></font>ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'L'</font><font color="#000080">,</font><font color="#800000">'U'</font><font color="#000080">,</font><font color="#800000">'R'</font><font color="#000080">,</font><font color="#800000">'V'</font><font color="#000080">,</font><font color="#800000">'S'</font><font color="#000080">];
      </font><font color="#FF0000"><b>case </b></font>ch <font color="#FF0000"><b>of
        </b></font><font color="#800000">'L' </font><font color="#000080">: </font>UserRec<font color="#000080">.</font>security <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#800000">'U' </font><font color="#000080">: </font>UserRec<font color="#000080">.</font>security <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
        </font><font color="#800000">'R' </font><font color="#000080">: </font>UserRec<font color="#000080">.</font>security <font color="#000080">:= </font><font color="#800000">150</font><font color="#000080">;
        </font><font color="#800000">'V' </font><font color="#000080">: </font>UserRec<font color="#000080">.</font>security <font color="#000080">:= </font><font color="#800000">2000</font><font color="#000080">;
        </font><font color="#800000">'S' </font><font color="#000080">: </font>UserRec<font color="#000080">.</font>security <font color="#000080">:= </font><font color="#800000">65535</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">); </font>clreol<font color="#000080">;
          </font>writeln<font color="#000080">(</font><font color="#800000">'Writing User File One Moment...'</font><font color="#000080">);
          </font>delay<font color="#000080">(</font><font color="#800000">450</font><font color="#000080">);
          </font><font color="#008000"><i>{$I-}
          </i></font>seek<font color="#000080">(</font>userfile<font color="#000080">,</font>X<font color="#000080">);
          </font>write<font color="#000080">(</font>userfile<font color="#000080">,</font>UserRec<font color="#000080">);
          </font><font color="#008000"><i>{$I+}
       </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{main}
   </i></font>ClrScr<font color="#000080">;
   </font>SysPath <font color="#000080">:= </font>GetEnv<font color="#000080">(</font><font color="#800000">'RA'</font><font color="#000080">);           </font><font color="#008000"><i>{[drive]:\RA}
       </i></font>SysPath <font color="#000080">:= </font>Fixpath<font color="#000080">(</font>SysPath<font color="#000080">);   </font><font color="#008000"><i>{[drive]:\RA\}
       </i></font>ConfigPath <font color="#000080">:= </font>SysPath <font color="#000080">+ </font><font color="#800000">'CONFIG.RA'</font><font color="#000080">; </font><font color="#008000"><i>{[drive]:\RA\CONFIG.RA}

   {$I-}
   </i></font>Assign<font color="#000080">(</font>SysFile<font color="#000080">,</font>ConfigPath<font color="#000080">);
   </font>Reset<font color="#000080">(</font>SysFile<font color="#000080">);
    </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>If </b></font>IOresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">' Error Reading '</font><font color="#000080">,</font>ConfigPath<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' Exiting with Errorlevel 1'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{Exit at errorlevel 1,[drive]:\RA\CONFIG.RA not Found}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;      </font><font color="#008000"><i>{Is the enviroment variable set?}

   </i></font>read<font color="#000080">(</font>SysFile<font color="#000080">,</font>SysRec<font color="#000080">); </font><font color="#008000"><i>{open up CONFIG.RA and find the Path to the}
                         { Messsage base,(where users.bbs is stored) }
   </i></font>Close<font color="#000080">(</font>SysFile<font color="#000080">);
   </font>UserPath <font color="#000080">:= </font>FixPath<font color="#000080">(</font>SysRec<font color="#000080">.</font>MsgBasePath<font color="#000080">);
   </font>UserPath<font color="#000080">:=</font>UserPath <font color="#000080">+ </font><font color="#800000">'USERS.BBS'</font><font color="#000080">;
   </font><font color="#008000"><i>{$I-}
</i></font><font color="#000080">&gt; </font>Assign<font color="#000080">(</font>UserFile<font color="#000080">,</font><font color="#008000"><i>{UserPath}</i></font><font color="#800000">'USERS.BBS'</font><font color="#000080">); </font><font color="#008000"><i>{ &lt;- Copy a USERS.BBS file into the
} </i></font>Reset<font color="#000080">(</font>UserFile<font color="#000080">);                        </font><font color="#008000"><i>{ current dir to play with before
}   {$I+}                                 { you comment out UserPath
}    </i></font><font color="#FF0000"><b>If </b></font>IOresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin
     </b></font>WriteLn<font color="#000080">(</font><font color="#800000">' Error Reading '</font><font color="#000080">,</font>UserPath<font color="#000080">);
     </font>WriteLn<font color="#000080">(</font><font color="#800000">' Exiting with Errorlevel 2'</font><font color="#000080">);
     </font>Halt<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);</font><font color="#008000"><i>{Exit At Errorlevel 2,[drive]:\Msgbase\Users.bbs not found}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>X <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>Done <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>Repeat
   </b></font>textattr<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
   </font>ClrScr<font color="#000080">;
   </font>Seek<font color="#000080">(</font>UserFile<font color="#000080">, </font>X<font color="#000080">);
   </font>Read<font color="#000080">(</font>UserFile<font color="#000080">, </font>UserRec<font color="#000080">);
   </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font><font color="#FF0000"><b>with </b></font>UserRec <font color="#FF0000"><b>do
   Begin
   </b></font>Writeln<font color="#000080">;
   </font>Writeln<font color="#000080">(</font><font color="#800000">'  User #    : '</font><font color="#000080">,</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
   </font>Writeln<font color="#000080">(</font><font color="#800000">'  Name      : '</font><font color="#000080">,</font>Name<font color="#000080">);
   </font>Writeln<font color="#000080">(</font><font color="#800000">'  Handle    : '</font><font color="#000080">,</font>Handle<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Security  : '</font><font color="#000080">,</font>Security<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Location  : '</font><font color="#000080">,</font>Location<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Data #    : '</font><font color="#000080">,</font>DataPhone<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Home #    : '</font><font color="#000080">,</font>VoicePhone<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'  Birthday  : '</font><font color="#000080">,</font>BirthDate<font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'  Last Call : '</font><font color="#000080">,</font>LastDate<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>Lasttime<font color="#000080">);
          </font><font color="#FF0000"><b>case </b></font>Sex <font color="#FF0000"><b>of
               </b></font><font color="#800000">1 </font><font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'  Sex       : Male'</font><font color="#000080">);
               </font><font color="#800000">2 </font><font color="#000080">: </font>writeln <font color="#000080">(</font><font color="#800000">'  Sex       : Female'</font><font color="#000080">);
              </font><font color="#FF0000"><b>else </b></font>writeln <font color="#000080">(</font><font color="#800000">'  Sex       : Unknown'</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>writeln<font color="#000080">(</font><font color="#800000">'  Number of Calls :'</font><font color="#000080">,</font>NoCalls<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{with}
    </i></font>drawscreen<font color="#000080">;
    </font>Ch <font color="#000080">:= </font>Readkey<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ch<font color="#000080">=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>ch<font color="#000080">:=</font>upcase<font color="#000080">(</font>readkey<font color="#000080">);
   </font><font color="#FF0000"><b>Case </b></font>ch <font color="#FF0000"><b>Of
     </b></font><font color="#800000">#81 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&lt; </font>FileSize<font color="#000080">(</font>UserFile<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
     </font><font color="#800000">#73 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>X<font color="#000080">);
     </font><font color="#800000">#27 </font><font color="#000080">: </font>Done <font color="#000080">:= </font>True<font color="#000080">;
     </font><font color="#800000">#99 </font><font color="#008000"><i>{'C'} </i></font><font color="#000080">: </font>Write_New_Record<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font>done<font color="#000080">;
    </font>Close<font color="#000080">(</font>UserFile<font color="#000080">);
    </font>textattr<font color="#000080">:=</font><font color="#800000">$07</font><font color="#000080">;
    </font>clrscr<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
