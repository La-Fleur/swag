<html>
<head><title> "MSG-FIDO.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Could someone post the structures For a QWK mail packet, and could
&gt;someone, post how to make a BBS Fido-Net compatible, in other Words the
&gt;File structures..Thanks in advance..
}

{$V-}

</i></font><font color="#FF0000"><b>Program </b></font>ReadQWKRepFile<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Seperator <font color="#000080">= </font><font color="#800000">'---------------------------------------------------------------------------'</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ConfType <font color="#000080">= ^</font>Conference<font color="#000080">;
  </font>Conference <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Number <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Name   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CONDATHdr <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>BBSName  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Location <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Number   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>SysopName<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>SerialNum<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>BBSID    <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Date     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Time     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UserName <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>NumConfs <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Confs    <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">30</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ConfType<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>MSGDATHdr <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Status   <font color="#000080">: </font>Char<font color="#000080">;
    </font>MSGNum   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Date     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Time     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UpTO     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>UpFROM   <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Subject  <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>PassWord <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>ReferNum <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>NumChunk <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>Alive    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>LeastSig <font color="#000080">: </font>Byte<font color="#000080">;
    </font>MostSig  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Reserved <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>MSSingle <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>F           <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>DefSaveFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>ConfNum     <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
  </font>Number      <font color="#000080">: </font>Word<font color="#000080">;



</font><font color="#FF0000"><b>Function </b></font>Valu2 <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>C  <font color="#000080">: </font>Word<font color="#000080">;
  </font>E  <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Val <font color="#000080">(</font>S<font color="#000080">, </font>C<font color="#000080">, </font>E<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>E <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Valu2 <font color="#000080">:= </font>C
  <font color="#FF0000"><b>else
    </b></font>Valu2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ParseCommandLine<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
  </font>C <font color="#000080">: </font>Char<font color="#000080">;
  </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>do
  begin
    </b></font>S <font color="#000080">:= </font>ParamStr <font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'/' </font><font color="#FF0000"><b>then
    begin
      </b></font>C <font color="#000080">:= </font>UpCase <font color="#000080">(</font>S <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
      </font>Delete <font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>C <font color="#FF0000"><b>of
        </b></font><font color="#800000">'C' </font><font color="#000080">: </font>ConfNum <font color="#000080">:= </font>S<font color="#000080">;
        </font><font color="#800000">'S' </font><font color="#000080">:
              </font><font color="#FF0000"><b>begin
                While </b></font>Length <font color="#000080">(</font>S<font color="#000080">) &lt;&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>do
                  </b></font>S <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>S<font color="#000080">;
                </font>DefSaveFile <font color="#000080">:= </font>S<font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font><font color="#800000">'N' </font><font color="#000080">: </font>Number <font color="#000080">:= </font>Valu2 <font color="#000080">(</font>S<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>MStoIEEE <font color="#000080">(</font>MS <font color="#000080">: </font>MSSingle<font color="#000080">) : </font>Real<font color="#000080">;
</font><font color="#008000"><i>{ Converts a 4 Byte Microsoft format single precision Real Variable as
  used in earlier versions of QuickBASIC and GW-BASIC to IEEE 6 Byte Real }
</i></font><font color="#FF0000"><b>Var
  </b></font>r      <font color="#000080">: </font>Real<font color="#000080">;
  </font>ieee   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#FF0000"><b>Absolute </b></font>r<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>r<font color="#000080">,</font>sizeof<font color="#000080">(</font>r<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>ieee<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>MS<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font>MS<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font>MS<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>ieee<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] := </font>MS<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>MStoIEEE  <font color="#000080">:= </font>r<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ MStoIEEE }

</i></font><font color="#FF0000"><b>Function </b></font>Valu <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>C     <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>T<font color="#000080">, </font>E  <font color="#000080">: </font>Integer<font color="#000080">;
  </font>I     <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Place <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Place <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>C <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">6 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    </b></font>Val <font color="#000080">(</font>S <font color="#000080">[</font>I<font color="#000080">], </font>T<font color="#000080">, </font>E<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>T <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>C <font color="#000080">:= </font>C <font color="#000080">+ </font>T <font color="#000080">* </font>Place<font color="#000080">;
      </font>Place <font color="#000080">:= </font>Place <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Valu <font color="#000080">:= </font>C <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMSG <font color="#000080">(</font>NumChunks <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Buff <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>J    <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>I    <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NumChunks <font color="#FF0000"><b>do
  begin
    </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">, </font>Buff<font color="#000080">, </font><font color="#800000">128</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">128 </font><font color="#FF0000"><b>do
      If </b></font>Buff <font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">#$E3 </font><font color="#FF0000"><b>then
        </b></font>Writeln
      <font color="#FF0000"><b>else
        </b></font>Write <font color="#000080">(</font>Buff <font color="#000080">[</font>I<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadWriteHdr <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>HDR <font color="#000080">: </font>MSGDatHdr<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>BlockRead <font color="#000080">(</font>F<font color="#000080">, </font>Hdr<font color="#000080">, </font>SizeOf <font color="#000080">(</font>Hdr<font color="#000080">));
  </font><font color="#FF0000"><b>With </b></font>Hdr <font color="#FF0000"><b>do
  begin
    </b></font>Write <font color="#000080">(</font><font color="#800000">'Date: '</font><font color="#000080">, </font>Date<font color="#000080">, </font><font color="#800000">' ('</font><font color="#000080">, </font>Time<font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">'Number: '</font><font color="#000080">, </font>MSGNum<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'From: '</font><font color="#000080">, </font>UpFROM<font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">14</font><font color="#000080">, </font><font color="#800000">'Refer#: '</font><font color="#000080">, </font>ReferNum<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'  To: '</font><font color="#000080">, </font>UpTO<font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">'Recvd: '</font><font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Status <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'`'</font><font color="#000080">, </font><font color="#800000">'^'</font><font color="#000080">, </font><font color="#800000">'#'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      </b></font>Writeln <font color="#000080">(</font><font color="#800000">'YES'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>Writeln <font color="#000080">(</font><font color="#800000">'NO'</font><font color="#000080">);
    </font>Write <font color="#000080">(</font><font color="#800000">'Subj: '</font><font color="#000080">, </font>Subject<font color="#000080">);
    </font>Writeln <font color="#000080">(</font><font color="#800000">'' </font><font color="#000080">: </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">'Conf: '</font><font color="#000080">, </font><font color="#800000">'('</font><font color="#000080">, </font>LeastSig<font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMessage <font color="#000080">(</font>HDR <font color="#000080">: </font>MSGDatHdr<font color="#000080">; </font>REPorDAT <font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>ReadWriteHdr <font color="#000080">(</font>HDR<font color="#000080">);
  </font>ReadMsg <font color="#000080">(</font>Valu <font color="#000080">(</font>HDR<font color="#000080">.</font>NumChunk<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadControlFile <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Control <font color="#000080">: </font>CONDatHdr<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>CFile    <font color="#000080">: </font>Text<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ReadToEOLN <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FNAME<font color="#000080">; </font>Length <font color="#000080">: </font>Byte<font color="#000080">; </font>Down <font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>I <font color="#000080">: </font>Byte<font color="#000080">;
    </font>C <font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>Read <font color="#000080">(</font>CFile<font color="#000080">, </font>C<font color="#000080">);
      </font>Mem <font color="#000080">[</font>Seg <font color="#000080">(</font>FNAME<font color="#000080">) : </font>Ofs <font color="#000080">(</font>FNAME<font color="#000080">) + </font>I<font color="#000080">] := </font>Ord <font color="#000080">(</font>C<font color="#000080">);
      </font>Inc <font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>EOLN <font color="#000080">(</font>CFile<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>I <font color="#000080">&gt; </font>Length<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>Down <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>C <font color="#000080">= </font><font color="#800000">','</font><font color="#000080">));
    </font><font color="#FF0000"><b>If Not </b></font>Down <font color="#FF0000"><b>then
      </b></font>Dec <font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>I <font color="#FF0000"><b>to </b></font>Length <font color="#FF0000"><b>do
      </b></font>Mem <font color="#000080">[</font>Seg <font color="#000080">(</font>FNAME<font color="#000080">) : </font>Ofs <font color="#000080">(</font>FNAME<font color="#000080">) + </font>I<font color="#000080">] :=</font><font color="#800000">32</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Down <font color="#FF0000"><b>then
      </b></font>Readln <font color="#000080">(</font>CFile<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>TempChar <font color="#000080">: </font>Char<font color="#000080">;
  </font>S        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>I        <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign <font color="#000080">(</font>CFile<font color="#000080">, </font><font color="#800000">'CONTROL.DAT'</font><font color="#000080">);
  </font>Reset <font color="#000080">(</font>CFile<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Control <font color="#FF0000"><b>do
  begin
    </b></font>ReadToEOLN <font color="#000080">(</font>BBSName<font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font>True<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>Location<font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font>True<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>Number<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font>True<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>SysopName<font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font>False<font color="#000080">);
    </font>Readln <font color="#000080">(</font>CFile<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>SerialNum<font color="#000080">, </font><font color="#800000">5</font><font color="#000080">, </font>False<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>BBSID<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font>True<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>Date<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>False<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>Time<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font>True<font color="#000080">);
    </font>ReadToEOLN <font color="#000080">(</font>UserName<font color="#000080">, </font><font color="#800000">25</font><font color="#000080">, </font>True<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">4 </font><font color="#FF0000"><b>do
      </b></font>Readln <font color="#000080">(</font>CFile<font color="#000080">, </font>S<font color="#000080">);
    </font>NumConfs <font color="#000080">:= </font>Valu <font color="#000080">(</font>S<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NumConfs <font color="#FF0000"><b>do
    begin
      </b></font>New <font color="#000080">(</font>Confs <font color="#000080">[</font>I<font color="#000080">]);
      </font>Readln <font color="#000080">(</font>CFile<font color="#000080">, </font>S<font color="#000080">);
      </font>Confs <font color="#000080">[</font>I<font color="#000080">]^.</font>Number <font color="#000080">:= </font>Valu2 <font color="#000080">(</font>S<font color="#000080">);
      </font>ReadToEOLN <font color="#000080">(</font>Confs <font color="#000080">[</font>I<font color="#000080">]^.</font>Name<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font>True<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close <font color="#000080">(</font>CFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetSaveFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Enter the name of the File to save it in (GIVE A DIRECTORY!) or [Return] for'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'C:\SLMR\SAVE.TXT'</font><font color="#000080">);
  </font>Readln <font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>S <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    </b></font>S <font color="#000080">:= </font><font color="#800000">'C:\SLMR\SAVE.TXT'</font><font color="#000080">;
  </font>GetSaveFile <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetYN <font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>X  <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Repeat
    </b></font>Write <font color="#000080">(</font>S<font color="#000080">);
    </font>X <font color="#000080">:= </font>UpCase <font color="#000080">(</font>ReadKey<font color="#000080">);
    </font>Writeln <font color="#000080">(</font>X<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>X <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">, </font><font color="#800000">'N'</font><font color="#000080">];
  </font>GetYN <font color="#000080">:= </font>X <font color="#000080">= </font><font color="#800000">'Y'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ScanMessages <font color="#000080">(</font>REPorDAT <font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Var
    </b></font>HDR <font color="#000080">: </font>MSGDatHdr<font color="#000080">;
    </font>S  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
    </font>I  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>F2 <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>MS <font color="#000080">: </font>MSSingle<font color="#000080">;
    </font>YN  <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    If </b></font>ConfNum <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    begin
      </b></font>Writeln<font color="#000080">;
      </font>Write <font color="#000080">(</font><font color="#800000">'Enter the name/number For the conference : '</font><font color="#000080">);
      </font>Readln <font color="#000080">(</font>ConfNum<font color="#000080">);
      </font>Writeln<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Length <font color="#000080">(</font>ConfNum<font color="#000080">) &lt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>ConfNum <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>ConfNum<font color="#000080">;
    </font>Writeln <font color="#000080">(</font>ConfNum<font color="#000080">);
    </font>Assign <font color="#000080">(</font>F2<font color="#000080">, </font>ConfNum <font color="#000080">+ </font><font color="#800000">'.NDX'</font><font color="#000080">);
    </font><font color="#008000"><i>{$I-}
    </i></font>Reset <font color="#000080">(</font>F2<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>RunError <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);

    </font><font color="#FF0000"><b>Repeat
      Repeat

        </b></font>Writeln<font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>Number <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        begin
          </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Enter the SLMR number ( ??? / XXX ) of the message to pull, or 0 to quit : '</font><font color="#000080">);
          </font>Readln <font color="#000080">(</font>Number<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>Number <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        begin
          </b></font>Close <font color="#000080">(</font>F2<font color="#000080">);
          </font>Close <font color="#000080">(</font>F<font color="#000080">);
          </font>Halt<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

        </font>Writeln<font color="#000080">;
        </font>Seek <font color="#000080">(</font>F2<font color="#000080">, (</font>Number <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">5</font><font color="#000080">);
        </font>BlockRead <font color="#000080">(</font>F2<font color="#000080">, </font>MS<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);

        </font>Seek <font color="#000080">(</font>F<font color="#000080">, </font>Round <font color="#000080">(</font>MStoIEEE <font color="#000080">(</font>MS<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">128</font><font color="#000080">);
        </font>ReadWriteHdr <font color="#000080">(</font>HDR<font color="#000080">);

        </font>YN <font color="#000080">:= </font>GetYN <font color="#000080">(</font><font color="#800000">'Capture this message ? '</font><font color="#000080">);
        </font>Number <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

      </font><font color="#FF0000"><b>Until </b></font>YN<font color="#000080">;

      </font>Seek <font color="#000080">(</font>F<font color="#000080">, </font>Round <font color="#000080">(</font>MStoIEEE <font color="#000080">(</font>MS<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">128</font><font color="#000080">);
      </font>Writeln<font color="#000080">;
      </font>Writeln<font color="#000080">;
      </font><font color="#FF0000"><b>If Not </b></font>GetYN <font color="#000080">(</font><font color="#800000">'Extract to Screen ? [Y/N] (N sends to File): '</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>Assign <font color="#000080">(</font>Output<font color="#000080">, </font>GetSaveFile<font color="#000080">);
      </font><font color="#008000"><i>{$I-}
      </i></font>Reset <font color="#000080">(</font>Output<font color="#000080">);
      </font><font color="#008000"><i>{$I+}
      </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>ReWrite <font color="#000080">(</font>Output<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Append <font color="#000080">(</font>Output<font color="#000080">);
      </font>Writeln<font color="#000080">;
      </font>Writeln <font color="#000080">(</font>Seperator<font color="#000080">);
      </font>Writeln<font color="#000080">;
      </font>ReadMessage <font color="#000080">(</font>Hdr<font color="#000080">, </font>REPorDAT<font color="#000080">);
      </font>Writeln<font color="#000080">;
      </font>Writeln<font color="#000080">;
      </font>Close <font color="#000080">(</font>Output<font color="#000080">);
      </font>Assign <font color="#000080">(</font>Output<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
      </font>ReWrite <font color="#000080">(</font>Output<font color="#000080">);
      </font>YN <font color="#000080">:= </font>GetYN <font color="#000080">(</font><font color="#800000">'Extract more messages? [Y/N] '</font><font color="#000080">);
    </font><font color="#FF0000"><b>Until Not </b></font>YN<font color="#000080">;

    </font>Close <font color="#000080">(</font>F2<font color="#000080">);
    </font>YN <font color="#000080">:= </font>GetYN <font color="#000080">(</font><font color="#800000">'Select another message base? [Y/N] '</font><font color="#000080">);
  </font><font color="#FF0000"><b>Until Not </b></font>YN<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Var
  </b></font>Control  <font color="#000080">: </font>CONDatHdr<font color="#000080">;
  </font>MSGHdr   <font color="#000080">: </font>MSGDatHdr<font color="#000080">;
  </font>REPorDAT <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>DefSaveFile <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>ConfNum <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Number <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ParseCommandLine<font color="#000080">;
  </font>DirectVideo <font color="#000080">:= </font>False<font color="#000080">;
  </font>ReadControlFile <font color="#000080">(</font>Control<font color="#000080">);
  </font><font color="#008000"><i>{ Assign (F, Control.BBSID + '.MSG');}
  </i></font>Assign <font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'MESSAGES.DAT'</font><font color="#000080">);
  </font>Reset <font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>BlockRead <font color="#000080">(</font>F<font color="#000080">, </font>MSGHdr<font color="#000080">, </font>SizeOf <font color="#000080">(</font>MSGHdr<font color="#000080">));
  </font>REPorDAT <font color="#000080">:= (</font>MSGHdr<font color="#000080">.</font>Status <font color="#000080">+ </font>MSGHdr<font color="#000080">.</font>MSGNum <font color="#000080">= </font>Control<font color="#000080">.</font>BBSID<font color="#000080">);
  </font>ScanMessages <font color="#000080">(</font>REPorDAT<font color="#000080">);
  </font><font color="#008000"><i>{ While Not EOF (F) do ReadMessage (MSGHdr, REPorDAT);}
  </i></font>Close <font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
