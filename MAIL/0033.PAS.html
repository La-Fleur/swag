<html>
<head><title> "FIDO Message Numbers" by MARTIN WOODS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>program </b></font>MSGNUM<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">,</font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>version<font color="#000080">=</font><font color="#800000">'v1.5'</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>sto<font color="#000080">,
    </font>sfrom<font color="#000080">,
    </font>daystosave<font color="#000080">,
    </font>top<font color="#000080">,
    </font>bottom<font color="#000080">,
    </font>mtop<font color="#000080">,
    </font>mbottom<font color="#000080">,
    </font>keep      <font color="#000080">:</font>word<font color="#000080">;
    </font>drv       <font color="#000080">:</font>byte<font color="#000080">;
    </font>st<font color="#000080">,
    </font>path      <font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>msg<font color="#000080">,
    </font>save      <font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10240</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>boolean<font color="#000080">;
    </font>date      <font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10240</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CurrentDrive<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>pthstr<font color="#000080">:</font>pathstr<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>pthstr<font color="#000080">:=</font>fexpand<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>CurrentDrive<font color="#000080">:=</font>pthstr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>mchr<font color="#000080">(</font>n<font color="#000080">:</font>byte<font color="#000080">;</font>ch<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>byte<font color="#000080">;</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do </b></font>s<font color="#000080">:=</font>s<font color="#000080">+</font>ch<font color="#000080">;
  </font>mchr<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FDayOfYear<font color="#000080">(</font>l<font color="#000080">:</font>longint<font color="#000080">):</font>word<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>t<font color="#000080">:</font>datetime<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>unpacktime<font color="#000080">(</font>l<font color="#000080">,</font>t<font color="#000080">);
   </font>t<font color="#000080">.</font>month<font color="#000080">:=</font>t<font color="#000080">.</font>month<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
   </font>FDayOfYear<font color="#000080">:=((</font>t<font color="#000080">.</font>year<font color="#000080">-</font><font color="#800000">1990</font><font color="#000080">)*</font><font color="#800000">365</font><font color="#000080">)
   + (</font>t<font color="#000080">.</font>year<font color="#000080">-</font><font color="#800000">1988 </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">)
   + (</font>t<font color="#000080">.</font>month<font color="#000080">*</font><font color="#800000">30</font><font color="#000080">) + </font>t<font color="#000080">.</font>day
   <font color="#000080">+ (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">1</font><font color="#000080">))
   - (</font><font color="#800000">2</font><font color="#000080">*</font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">2</font><font color="#000080">))
   + (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">3</font><font color="#000080">))
   + (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">5</font><font color="#000080">))
   + (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">7</font><font color="#000080">))
   + (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">8</font><font color="#000080">))
   + (  </font>ord<font color="#000080">(</font>t<font color="#000080">.</font>month<font color="#000080">&gt;=</font><font color="#800000">10</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TodaysDate<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>temp<font color="#000080">:</font>word<font color="#000080">;</font>dt<font color="#000080">:</font>datetime<font color="#000080">;</font>l<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
      </b></font>getdate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>temp<font color="#000080">);
      </font>dt<font color="#000080">.</font>year<font color="#000080">:=</font>y<font color="#000080">;
      </font>dt<font color="#000080">.</font>month<font color="#000080">:=</font>m<font color="#000080">;
      </font>dt<font color="#000080">.</font>day<font color="#000080">:=</font>d<font color="#000080">;
      </font>packtime<font color="#000080">(</font>dt<font color="#000080">,</font>l<font color="#000080">);
      </font>todaysdate<font color="#000080">:=</font>fdayofyear<font color="#000080">(</font>l<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initvars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>sto<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>sfrom<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>daystosave<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
   </font>keep<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
   </font>bottom<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>mbottom<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>mtop<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>top<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>path<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10240 </font><font color="#FF0000"><b>do
   begin
      </b></font>msg<font color="#000080">[</font>a<font color="#000080">]:=</font>FALSE<font color="#000080">;
      </font>save<font color="#000080">[</font>a<font color="#000080">]:=</font>FALSE<font color="#000080">;
      </font>date<font color="#000080">[</font>a<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>getparams<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">,</font>b<font color="#000080">,</font>code<font color="#000080">:</font>word<font color="#000080">;</font>parama<font color="#000080">,</font>temp<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>past<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
   If </b></font><font color="#000080">(</font>paramcount<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then
   begin
      </b></font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">' MSGNUM '</font><font color="#000080">,</font>version<font color="#000080">,</font><font color="#800000">' -  A Message base renumbering system for
</font>FIDOnet <font color="#FF0000"><b>and </b></font>compatible<font color="#800000">');      writeln(' </font><font color="#FF0000"><b>message </b></font>systems<font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a brute
force handler that <font color="#FF0000"><b>is </b></font>s<font color="#000080">-</font>l<font color="#000080">-</font>o<font color="#000080">-</font>w<font color="#000080">. </font>But it<font color="#800000">');      writeln(' </font><font color="#FF0000"><b>uses file </b></font>handlers
instead <font color="#FF0000"><b>of </b></font>FCBs like RENUM<font color="#000080">, </font>so <font color="#FF0000"><b>is </b></font>safer<font color="#000080">. </font>Syntax<font color="#000080">:</font><font color="#800000">');      writeln;
      </font>writeln<font color="#000080">(</font><font color="#800000">'    MSGNUM  [switches] [path]'</font><font color="#000080">);
      </font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">' Switches:'</font><font color="#000080">);
      </font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">'    /Sxx-yy    Save messages xx to yy - keeps those messages
</font>exactly <font color="#FF0000"><b>as</b></font><font color="#800000">');      writeln('               </font>they were before<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>does <font color="#FF0000"><b>NOT
</b></font>renumber THEM<font color="#800000">');      writeln('    </font><font color="#000080">/</font>Dxx       Messages less than xx days old
will be saved even <font color="#FF0000"><b>if </b></font>they<font color="#800000">');      writeln('               </font>exceed the <font color="#000080">/</font>L
paramater<font color="#800000">');      writeln('    </font><font color="#000080">/</font>Kxx       Keeps xx messages <font color="#FF0000"><b>in </b></font>the base<font color="#000080">, </font>even
<font color="#FF0000"><b>if </b></font>they are older than the<font color="#800000">');      writeln('               </font>number <font color="#FF0000"><b>of </b></font>days
specified <font color="#FF0000"><b>in </b></font>the <font color="#000080">/</font>D paramater<font color="#000080">.</font><font color="#800000">');      writeln;
      </font>writeln<font color="#000080">(</font><font color="#800000">' Path MUST be specified.  The path refers to the subdir of the
</font>base <font color="#FF0000"><b>to </b></font>be<font color="#800000">');      writeln(' </font>renumbered<font color="#000080">.</font><font color="#800000">');
      </font>writeln<font color="#000080">;
      </font>writeln<font color="#000080">(</font><font color="#800000">' Default is:  MSGNUM /S1-1 /D2 /K100 [path]'</font><font color="#000080">);
      </font>halt<font color="#000080">;
   </font><font color="#FF0000"><b>end
   else
   begin
      for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>paramcount <font color="#FF0000"><b>do
      begin
         </b></font>parama<font color="#000080">:=</font>paramstr<font color="#000080">(</font>a<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>parama<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'/' </font><font color="#FF0000"><b>then
         begin
            Case </b></font>upcase<font color="#000080">(</font>parama<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>of
            </b></font><font color="#800000">'S'</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                   </b></font>past<font color="#000080">:=</font>FALSE<font color="#000080">;
                   </font>temp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font><font color="#FF0000"><b>for </b></font>b<font color="#000080">:=</font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>parama<font color="#000080">) </font><font color="#FF0000"><b>do
                   begin
                      If </b></font>parama<font color="#000080">[</font>b<font color="#000080">]=</font><font color="#800000">'-' </font><font color="#FF0000"><b>then
                      begin
                         </b></font>past<font color="#000080">:=</font>TRUE<font color="#000080">;
                         </font>val<font color="#000080">(</font>temp<font color="#000080">,</font>sfrom<font color="#000080">,</font>code<font color="#000080">);
                         </font>temp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                      </font><font color="#FF0000"><b>end
                      else
                      begin
                         </b></font>temp<font color="#000080">:=</font>temp<font color="#000080">+</font>parama<font color="#000080">[</font>b<font color="#000080">];
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font>val<font color="#000080">(</font>temp<font color="#000080">,</font>sto<font color="#000080">,</font>code<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">'D'</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                   </b></font>temp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font><font color="#FF0000"><b>for </b></font>b<font color="#000080">:=</font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>parama<font color="#000080">) </font><font color="#FF0000"><b>do
                   begin
                      </b></font>temp<font color="#000080">:=</font>temp<font color="#000080">+</font>parama<font color="#000080">[</font>b<font color="#000080">];
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font>val<font color="#000080">(</font>temp<font color="#000080">,</font>daystosave<font color="#000080">,</font>code<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#800000">'K'</font><font color="#000080">:</font><font color="#FF0000"><b>begin
                   </b></font>temp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
                   </font><font color="#FF0000"><b>for </b></font>b<font color="#000080">:=</font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>parama<font color="#000080">) </font><font color="#FF0000"><b>do
                   begin
                      </b></font>temp<font color="#000080">:=</font>temp<font color="#000080">+</font>parama<font color="#000080">[</font>b<font color="#000080">];
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                   </font>val<font color="#000080">(</font>temp<font color="#000080">,</font>keep<font color="#000080">,</font>code<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end
         else
         begin
            If </b></font>path<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then
               for </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>parama<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>path<font color="#000080">:=</font>path<font color="#000080">+</font>parama<font color="#000080">[</font>b<font color="#000080">];
            </font><font color="#FF0000"><b>If </b></font>path<font color="#000080">[</font>length<font color="#000080">(</font>path<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>then </b></font>path<font color="#000080">:=</font>path<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
            </font>path<font color="#000080">:=</font>fexpand<font color="#000080">(</font>path<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>readfilesin<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">;
    </font>tempword<font color="#000080">:</font>word<font color="#000080">;
    </font>tempint<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Findfirst<font color="#000080">(</font>path<font color="#000080">+</font><font color="#800000">'*.msg'</font><font color="#000080">,</font>AnyFile<font color="#000080">,</font>s<font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
   begin
      </b></font>val<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">.</font>name<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>s<font color="#000080">.</font>name<font color="#000080">)-</font><font color="#800000">4</font><font color="#000080">),</font>tempword<font color="#000080">,</font>tempint<font color="#000080">);
      </font>msg<font color="#000080">[</font>tempword<font color="#000080">]:=</font>TRUE<font color="#000080">;
      </font>save<font color="#000080">[</font>tempword<font color="#000080">]:=(</font>tempword<font color="#000080">&gt;=</font>sfrom<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>tempword<font color="#000080">&lt;=</font>sto<font color="#000080">);
      </font>date<font color="#000080">[</font>tempword<font color="#000080">]:=</font>FDayOfYear<font color="#000080">(</font>s<font color="#000080">.</font>time<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>tempword<font color="#000080">&lt;</font>bottom <font color="#FF0000"><b>then </b></font>bottom<font color="#000080">:=</font>tempword<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>tempword<font color="#000080">&gt;</font>top <font color="#FF0000"><b>then </b></font>top<font color="#000080">:=</font>tempword<font color="#000080">;
      </font>Findnext<font color="#000080">(</font>s<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>findkeep<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>count<font color="#000080">:</font>word<font color="#000080">;</font>td<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>count<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>mtop<font color="#000080">:=</font>top<font color="#000080">;
   </font>mbottom<font color="#000080">:=</font>top<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font>td<font color="#000080">:=</font>todaysdate<font color="#000080">;
   </font><font color="#FF0000"><b>repeat
      </b></font>dec<font color="#000080">(</font>mbottom<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>msg<font color="#000080">[</font>mbottom<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>save<font color="#000080">[</font>mbottom<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>mbottom<font color="#000080">&gt;</font>bottom<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>inc<font color="#000080">(</font>count<font color="#000080">);
   </font><font color="#FF0000"><b>until </b></font><font color="#000080">((</font>count<font color="#000080">&gt;=</font>keep<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>date<font color="#000080">[</font>mbottom<font color="#000080">]+</font>daystosave<font color="#000080">&lt;=</font>td<font color="#000080">)) </font><font color="#FF0000"><b>or
</b></font><font color="#000080">(</font>mbottom<font color="#000080">&lt;=</font>bottom<font color="#000080">);</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>deleteunwanted<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">,
    </font>todayyear<font color="#000080">,
    </font>y<font color="#000080">,
    </font>m<font color="#000080">,
    </font>d<font color="#000080">,
    </font>temp    <font color="#000080">:</font>word<font color="#000080">;
    </font>tempstr <font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
    </font>f       <font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Write<font color="#000080">(</font><font color="#800000">'Erasing  No Files!  '</font><font color="#000080">);
   </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>mbottom<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
   begin
      If </b></font><font color="#000080">(</font>msg<font color="#000080">[</font>a<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>save<font color="#000080">[</font>a<font color="#000080">]) </font><font color="#FF0000"><b>then
      begin
         </b></font>str<font color="#000080">(</font>a<font color="#000080">,</font>tempstr<font color="#000080">);
         </font>tempstr<font color="#000080">:=</font>tempstr<font color="#000080">+</font><font color="#800000">'.MSG'</font><font color="#000080">;
         </font>assign<font color="#000080">(</font>f<font color="#000080">,</font>tempstr<font color="#000080">);
         </font>Write<font color="#000080">(</font>mchr<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">),</font>mchr<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">-</font>length<font color="#000080">(</font>tempstr<font color="#000080">),</font><font color="#800000">#32</font><font color="#000080">)+</font>tempstr<font color="#000080">);
         </font>erase<font color="#000080">(</font>f<font color="#000080">);
         </font>msg<font color="#000080">[</font>a<font color="#000080">]:=</font>FALSE<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Writeln<font color="#000080">(</font>mchr<font color="#000080">(</font><font color="#800000">70</font><font color="#000080">-</font>wherex<font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">),</font><font color="#800000">' ...Done.'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>renameexisting<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">,</font>count<font color="#000080">:</font>word<font color="#000080">;
    </font>tempstr<font color="#000080">,</font>countstr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
    </font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>a<font color="#000080">:=</font>mbottom<font color="#000080">;
   </font>count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>Write<font color="#000080">(</font><font color="#800000">'Renaming '</font><font color="#000080">+</font>mchr<font color="#000080">(</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">));
   </font><font color="#FF0000"><b>repeat
      If </b></font><font color="#000080">(</font>msg<font color="#000080">[</font>a<font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>save<font color="#000080">[</font>a<font color="#000080">]) </font><font color="#FF0000"><b>then
      begin
         </b></font>tempstr<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
         </font>str<font color="#000080">(</font>a<font color="#000080">,</font>tempstr<font color="#000080">);
         </font>tempstr<font color="#000080">:=</font>tempstr<font color="#000080">+</font><font color="#800000">'.MSG'</font><font color="#000080">;
         </font>assign<font color="#000080">(</font>f<font color="#000080">,</font>tempstr<font color="#000080">);
         </font>inc<font color="#000080">(</font>count<font color="#000080">);
         </font><font color="#FF0000"><b>while </b></font>save<font color="#000080">[</font>count<font color="#000080">] </font><font color="#FF0000"><b>do </b></font>inc<font color="#000080">(</font>count<font color="#000080">);
         </font>str<font color="#000080">(</font>count<font color="#000080">,</font>countstr<font color="#000080">);
         </font>countstr<font color="#000080">:=</font>countstr<font color="#000080">+</font><font color="#800000">'.MSG'</font><font color="#000080">;
         </font>Write<font color="#000080">(</font>mchr<font color="#000080">(</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">),</font>tempstr<font color="#000080">,</font><font color="#800000">' to
',countstr,mchr(24-length(tempstr)-length(countstr),#32));         If
</font><font color="#000080">(</font>countstr<font color="#000080">&lt;&gt;</font>tempstr<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>rename<font color="#000080">(</font>f<font color="#000080">,</font>countstr<font color="#000080">);      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>inc<font color="#000080">(</font>a<font color="#000080">);
   </font><font color="#FF0000"><b>until </b></font>a<font color="#000080">&gt;</font>top<font color="#000080">;
   </font>writeln<font color="#000080">(</font>mchr<font color="#000080">(</font><font color="#800000">70</font><font color="#000080">-</font>wherex<font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">),</font><font color="#800000">' ...Done.'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>initvars<font color="#000080">;
   </font>getparams<font color="#000080">;
   </font>getdir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>st<font color="#000080">);
   </font>chdir<font color="#000080">(</font>copy<font color="#000080">(</font>path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>path<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
   </font>writeln<font color="#000080">(</font><font color="#800000">' Renumbering directory '</font><font color="#000080">+</font>copy<font color="#000080">(</font>path<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>length<font color="#000080">(</font>path<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
   </font>readfilesin<font color="#000080">;
   </font>findkeep<font color="#000080">;
   </font>write<font color="#000080">(</font><font color="#800000">' Deleting Unwanted files.... '</font><font color="#000080">);
   </font>deleteunwanted<font color="#000080">;
   </font>write<font color="#000080">(</font><font color="#800000">' Renaming Remaining files... '</font><font color="#000080">);
   </font>renameexisting<font color="#000080">;
   </font>chdir<font color="#000080">(</font>st<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p></body>
</html>
