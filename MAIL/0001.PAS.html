<html>
<head><title> "MAILMSGR.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
After lots of controversy, and a lot of reteaching myself the meanings of
a few Words, I've redone my *.MSG reader....
}

</i></font><font color="#FF0000"><b>Const </b></font>MSGPRIVATE  <font color="#000080">= </font><font color="#800000">$0001</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGConst    <font color="#000080">= </font><font color="#800000">$0002</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGREAD     <font color="#000080">= </font><font color="#800000">$0004</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGSENT     <font color="#000080">= </font><font color="#800000">$0008</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGFile     <font color="#000080">= </font><font color="#800000">$0010</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGFWD      <font color="#000080">= </font><font color="#800000">$0020</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGorPHAN   <font color="#000080">= </font><font color="#800000">$0040</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGKILL     <font color="#000080">= </font><font color="#800000">$0080</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGLOCAL    <font color="#000080">= </font><font color="#800000">$0100</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGHOLD     <font color="#000080">= </font><font color="#800000">$0200</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGCRAP     <font color="#000080">= </font><font color="#800000">$0400</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGFRQ      <font color="#000080">= </font><font color="#800000">$0800</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGRRQ      <font color="#000080">= </font><font color="#800000">$1000</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGCPT      <font color="#000080">= </font><font color="#800000">$2000</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGARQ      <font color="#000080">= </font><font color="#800000">$4000</font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>MSGURQ      <font color="#000080">= </font><font color="#800000">$8000</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
     </b></font>Fido_FromType    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>Fido_toType      <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>Fido_SubType     <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">71</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>Fido_DateType    <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

     </font>FidoMsgType <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>From         <font color="#000080">: </font>Fido_FromType<font color="#000080">; </font><font color="#008000"><i>(* 0   *)
      </i></font>toWhom       <font color="#000080">: </font>Fido_toType<font color="#000080">;   </font><font color="#008000"><i>(* 35  *)
      </i></font>Subject      <font color="#000080">: </font>Fido_SubType<font color="#000080">;  </font><font color="#008000"><i>(* 71  *)
      </i></font>AZDate       <font color="#000080">: </font>Fido_DateType<font color="#000080">; </font><font color="#008000"><i>(* 142 *)
      </i></font>TimesRead    <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 162 *)
      </i></font>Dest_Node    <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 164 *)
      </i></font>orig_Node    <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 166 *)
      </i></font>Cost         <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 168 *)
      </i></font>orig_Net     <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 170 *)
      </i></font>Dest_Net     <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 172 *)
      </i></font>Date_Written <font color="#000080">: </font>LongInt<font color="#000080">;       </font><font color="#008000"><i>(* 176 *)
      </i></font>Date_Arrived <font color="#000080">: </font>LongInt<font color="#000080">;       </font><font color="#008000"><i>(* 180 *)
      </i></font>Reply        <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 184 *)
      </i></font>Attr         <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 186 *)
      </i></font>Up           <font color="#000080">: </font>Word<font color="#000080">;          </font><font color="#008000"><i>(* 188 *)
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>MsgTxtPtr  <font color="#000080">= ^</font>MsgTxtType<font color="#000080">;
   </font>MsgTxtType <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">65535</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>MessageFile <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>Msg         <font color="#000080">: </font>FidoMsgType<font color="#000080">;
  </font>MsgTxt      <font color="#000080">: </font>MsgTxtPtr<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMessage<font color="#000080">(</font>Fname <font color="#000080">: </font>PathStr<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Left <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>MessageFile<font color="#000080">,</font>FName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>MessageFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>MessageFile<font color="#000080">,</font>Msg<font color="#000080">,</font><font color="#800000">190</font><font color="#000080">);
  </font>Left<font color="#000080">:=</font>FileSize<font color="#000080">(</font>MessageFile<font color="#000080">) - </font><font color="#800000">190</font><font color="#000080">;
  </font>New<font color="#000080">(</font>MsgTxt<font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>MessageFile<font color="#000080">,</font>MsgTxt<font color="#000080">^,</font>Left<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
This will correctly read in a *.MSG File in two parts..THe Header(stored in
Msg), and the Text which is a 64k buffer(stored in Pointer MsgTxt)...
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
