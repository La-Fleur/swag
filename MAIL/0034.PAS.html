<html>
<head><title> "Re: QWK & Turbo Pascal 7" by PAUL M. GOORSKIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{P
 MM&gt; QWK:
 MM&gt; Can anybody write for me or send me a unit that reads QWK packets???

I've wrote my one:
NOTE: Here some bugs can be found.Report me as soon as you check that.

---8&lt;--- Begin QWKUSE.PAS ---8&lt;--- }

</i></font><font color="#FF0000"><b>Unit </b></font>QWKUse<font color="#000080">;

</font><font color="#FF0000"><b>Interface

USES </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>QWKHead<font color="#000080">=</font><font color="#FF0000"><b>Record
     </b></font>NOM <font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>Date<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">7</font><font color="#000080">..</font><font color="#800000">$e</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>Time<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$f</font><font color="#000080">..</font><font color="#800000">$13</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>to_<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$14</font><font color="#000080">..</font><font color="#800000">$2c</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>From<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$2d</font><font color="#000080">..</font><font color="#800000">$45</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>Subj<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$46</font><font color="#000080">..</font><font color="#800000">$6a</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>NOR <font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$6b</font><font color="#000080">..</font><font color="#800000">$72</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>NOMB<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$73</font><font color="#000080">..</font><font color="#800000">$78</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>Res <font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">$79</font><font color="#000080">..</font><font color="#800000">$7e</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>MessageBlock<font color="#000080">=</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>CHAR<font color="#000080">;

</font><font color="#FF0000"><b>CONST </b></font>CrLf<font color="#000080">=</font><font color="#800000">#13#10</font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetMessageLength<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>BYte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GetMessageTime<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>GetMessageDate<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>DD<font color="#000080">,</font>MM<font color="#000080">,</font>YY<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>MessageNumber<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>NumberOfReplay<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>WORd<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Replay<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>NormalCrLf<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>DelChr<font color="#000080">(</font>c<font color="#000080">:</font>Char<font color="#000080">;</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>DelChr<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>a<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
For </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>Do If </b></font>s<font color="#000080">[</font>a<font color="#000080">]=</font>c <font color="#FF0000"><b>Then Begin </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font>a<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font>Dec<font color="#000080">(</font>a<font color="#000080">);</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetMessageLength<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>c<font color="#000080">:</font>Integer<font color="#000080">;
    </font>len<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font>s<font color="#000080">:=</font>s<font color="#000080">+</font>msg<font color="#000080">.</font>nomb<font color="#000080">;
</font>DelChr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>len<font color="#000080">,</font>c<font color="#000080">);
</font>Dec<font color="#000080">(</font>Len<font color="#000080">);
</font>GetMessageLength<font color="#000080">:=</font>len<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetMessageTime<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">,</font>s1<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>c<font color="#000080">:</font>INteger<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s1<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;</font>s1<font color="#000080">:=</font>s1<font color="#000080">+</font>msg<font color="#000080">.</font>time<font color="#000080">;
</font>s<font color="#000080">:=</font>Copy<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font>Delete<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>hour<font color="#000080">,</font>c<font color="#000080">);
</font>Val<font color="#000080">(</font>s1<font color="#000080">,</font>Minute<font color="#000080">,</font>c<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetMessageDate<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>DD<font color="#000080">,</font>MM<font color="#000080">,</font>YY<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>s<font color="#000080">,</font>s1<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>c<font color="#000080">:</font>INteger<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s1<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;</font>s1<font color="#000080">:=</font>s1<font color="#000080">+</font>msg<font color="#000080">.</font>date<font color="#000080">;
</font>s<font color="#000080">:=</font>Copy<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font>Delete<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>mm<font color="#000080">,</font>c<font color="#000080">);
</font>s<font color="#000080">:=</font>Copy<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font>Delete<font color="#000080">(</font>s1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>dd<font color="#000080">,</font>c<font color="#000080">);
</font>Val<font color="#000080">(</font>s1<font color="#000080">,</font>yy<font color="#000080">,</font>c<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>MessageNumber<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>w<font color="#000080">:</font>Word<font color="#000080">;
    </font>c<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s<font color="#000080">:=</font>msg<font color="#000080">.</font>nom<font color="#000080">;
</font>DelChr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>w<font color="#000080">,</font>c<font color="#000080">);
</font>MessageNumber<font color="#000080">:=</font>w<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>NumberOfReplay<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>WORd<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>w<font color="#000080">:</font>Word<font color="#000080">;
    </font>c<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s<font color="#000080">:=</font>msg<font color="#000080">.</font>nor<font color="#000080">;
</font>DelChr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>s<font color="#000080">);
</font>Val<font color="#000080">(</font>s<font color="#000080">,</font>w<font color="#000080">,</font>c<font color="#000080">);
</font>NumberOfReplay<font color="#000080">:=</font>w<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>Replay<font color="#000080">(</font>msg<font color="#000080">:</font>QWKHead<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>Replay<font color="#000080">:=</font>NumberOfReplay<font color="#000080">(</font>msg<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NormalCrLf<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>b<font color="#000080">,</font>a<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEgin
</b></font>b<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>s<font color="#000080">);
</font><font color="#FF0000"><b>While </b></font>b<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Do Begin </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font>b<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font>Insert<font color="#000080">(</font>crlf<font color="#000080">,</font>s<font color="#000080">,</font>b<font color="#000080">);</font>b<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>s<font color="#000080">);</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">. ---</font><font color="#800000">8</font><font color="#000080">&lt;---  </font><font color="#FF0000"><b>End </b></font>QWKUSE<font color="#000080">.</font>PAS  <font color="#000080">---</font><font color="#800000">8</font><font color="#000080">&lt;---

</font><font color="#FF0000"><b>And </b></font>here <font color="#FF0000"><b>is </b></font>example <font color="#FF0000"><b>of </b></font>usage<font color="#000080">:

---</font><font color="#800000">8</font><font color="#000080">&lt;--- </font><font color="#FF0000"><b>Begin </b></font>QWKPMG<font color="#000080">.</font>PAS <font color="#000080">---</font><font color="#800000">8</font><font color="#000080">&lt;---
</font><font color="#FF0000"><b>Program </b></font>QWK_PMG<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">,</font>Objects<font color="#000080">,</font>PMG_Str1<font color="#000080">,</font>QWKuse<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>box<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>Of String</b></font><font color="#000080">=(
      </font><font color="#800000">'From:'</font><font color="#000080">,
      </font><font color="#800000">'To  :'</font><font color="#000080">,
      </font><font color="#800000">'Subj:'</font><font color="#000080">,
      </font><font color="#800000">'Date:'</font><font color="#000080">,
      </font><font color="#800000">'Time:'</font><font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>Mes<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">700</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>PString<font color="#000080">;
    </font>MsgPtr<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>LongINT<font color="#000080">;
    </font>f2<font color="#000080">,</font>f1<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>current<font color="#000080">,</font>Total<font color="#000080">:</font>Word<font color="#000080">;
    </font>Header<font color="#000080">:</font>QWKHEAD<font color="#000080">;
    </font>a<font color="#000080">:</font>Integer<font color="#000080">;
    </font>c<font color="#000080">:</font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FillStr<font color="#000080">(</font>c<font color="#000080">:</font>Char<font color="#000080">;</font>a<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>b<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>b<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>a s<font color="#000080">:=</font>s<font color="#000080">+</font>c<font color="#000080">;
</font>FillStr<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Draw<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>fields<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>Of String</b></font><font color="#000080">;
    </font>a<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>Fields<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">+</font>Header<font color="#000080">.</font>from<font color="#000080">;
</font>Fields<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">+</font>Header<font color="#000080">.</font>To_<font color="#000080">;
</font>Fields<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">+</font>Header<font color="#000080">.</font>Subj<font color="#000080">;
</font>Fields<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">+</font>Header<font color="#000080">.</font>Date<font color="#000080">;
</font>Fields<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">+</font>Header<font color="#000080">.</font>Time<font color="#000080">;
</font>TextColor<font color="#000080">(</font>Cyan<font color="#000080">);
</font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do </b></font>WriteLn<font color="#000080">(</font>box<font color="#000080">[</font>a<font color="#000080">]);
</font>TextColor<font color="#000080">(</font>Red<font color="#000080">);</font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font>Write<font color="#000080">(</font><font color="#800000">'Message '</font><font color="#000080">);
</font>TextColor<font color="#000080">(</font>White<font color="#000080">);</font>Write<font color="#000080">(</font>Current<font color="#000080">);</font>TextColor<font color="#000080">(</font>red<font color="#000080">);
</font>Write<font color="#000080">(</font><font color="#800000">' of '</font><font color="#000080">);</font>TextColor<font color="#000080">(</font>White<font color="#000080">);</font>Write<font color="#000080">(</font>TOtal<font color="#000080">);
</font>TextBackGround<font color="#000080">(</font>White<font color="#000080">);</font>TextColor<font color="#000080">(</font>Black<font color="#000080">);</font>GotoXy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
</font>Write<font color="#000080">(</font><font color="#800000">'&quot;+&quot; - next message  &quot;-&quot; - previouse message.'</font><font color="#000080">,</font>FillStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">35</font><font color="#000080">));
</font>TextBackGround<font color="#000080">(</font>Black<font color="#000080">);
</font>TextColor<font color="#000080">(</font>LightGreen<font color="#000080">);
</font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do
    Begin
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">,</font>a<font color="#000080">);</font>Write<font color="#000080">(</font>fields<font color="#000080">[</font>a<font color="#000080">]);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>TextColor<font color="#000080">(</font>White<font color="#000080">);</font>WriteLn<font color="#000080">(</font>Crlf<font color="#000080">,</font>FillSTR<font color="#000080">(</font><font color="#800000">'&Auml;'</font><font color="#000080">,</font><font color="#800000">79</font><font color="#000080">),</font>CrLf<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadMsg<font color="#000080">(</font>n<font color="#000080">:</font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>b<font color="#000080">,</font>a<font color="#000080">:</font>Byte<font color="#000080">;
    </font>CurMsgPtr<font color="#000080">:</font>LongInt<font color="#000080">;
    </font>MsgBuf<font color="#000080">:</font>MESsageBlock<font color="#000080">;
    </font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>Current<font color="#000080">:=</font>n<font color="#000080">;
</font>Seek<font color="#000080">(</font>f1<font color="#000080">,</font>MSgPtr<font color="#000080">[</font>n<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]);
</font>BlockRead<font color="#000080">(</font>f1<font color="#000080">,</font>Header<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
</font>ClrScr<font color="#000080">;
</font>Draw<font color="#000080">;
</font>b<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>FOR </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>GetMessageLength<font color="#000080">(</font>Header<font color="#000080">) </font><font color="#FF0000"><b>Do
    BEGin
    </b></font>BlockRead<font color="#000080">(</font>f1<font color="#000080">,</font>MsgBuf<font color="#000080">,</font><font color="#800000">128</font><font color="#000080">);
    </font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;</font>s<font color="#000080">:=</font>s<font color="#000080">+</font>MsgBuf<font color="#000080">;
    </font>NormalCrLf<font color="#000080">(</font>s<font color="#000080">);
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>s<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>Do
          BEGin
               </b></font>Inc<font color="#000080">(</font>b<font color="#000080">);
               </font>DisposeStr<font color="#000080">(</font>MES<font color="#000080">[</font>b<font color="#000080">]);
               </font><font color="#FF0000"><b>While </b></font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>Do </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>s<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>s<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Mes<font color="#000080">[</font>b<font color="#000080">]:=</font>NewStr<font color="#000080">( </font>Copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)
)               </font><font color="#FF0000"><b>Else </b></font>Mes<font color="#000080">[</font>b<font color="#000080">]:=</font>NewStr<font color="#000080">(</font>s<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>pos<font color="#000080">(</font><font color="#800000">'&gt;'</font><font color="#000080">,</font>Mes<font color="#000080">[</font>b<font color="#000080">]^)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">) </font><font color="#FF0000"><b>Else
</b></font>TextColor<font color="#000080">(</font>Cyan<font color="#000080">);               </font><font color="#FF0000"><b>IF </b></font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>WriteLn<font color="#000080">(</font>Mes<font color="#000080">[</font>b<font color="#000080">]^) </font><font color="#FF0000"><b>Else
</b></font>Write<font color="#000080">(</font>Mes<font color="#000080">[</font>b<font color="#000080">]^) ;               </font><font color="#FF0000"><b>If </b></font>WhereY<font color="#000080">&gt;</font><font color="#800000">22 </font><font color="#FF0000"><b>Then
                  Begin
                       </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>WhereY<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
                       </font>Write<font color="#000080">(</font><font color="#800000">'Press any key to continue ...'</font><font color="#000080">);
                       </font>ReadKEY<font color="#000080">;
                       </font>ClrScr<font color="#000080">;
                       </font>Draw<font color="#000080">;
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font>CrLf<font color="#000080">,</font>s<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Else </b></font>s<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;

          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitPStrings<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>a<font color="#000080">:</font>Word<font color="#000080">;
    </font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>s<font color="#000080">:=</font>FillSTR<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">);
</font><font color="#FF0000"><b>For </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">700 </font><font color="#FF0000"><b>DO </b></font>Mes<font color="#000080">[</font>a<font color="#000080">]:=</font>NewStr<font color="#000080">(</font>s<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitMsgBase<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>a<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font>Seek<font color="#000080">(</font>f1<font color="#000080">,</font><font color="#800000">$81</font><font color="#000080">);
</font>a<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>f1<font color="#000080">) </font><font color="#FF0000"><b>Do
      Begin
           </b></font>MsgPtr<font color="#000080">[</font>a<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>FilePos<font color="#000080">(</font>f1<font color="#000080">);
           </font>BlockRead<font color="#000080">(</font>f1<font color="#000080">,</font>Header<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Header<font color="#000080">));
           </font>MsgPTR<font color="#000080">[</font>a<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>MessageNumber<font color="#000080">(</font>Header<font color="#000080">);
           </font>Seek<font color="#000080">(</font>f1<font color="#000080">,</font>Filepos<font color="#000080">(</font>f1<font color="#000080">)+</font><font color="#800000">128</font><font color="#000080">*</font>GetMessageLength<font color="#000080">(</font>Header<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
           </font>Inc<font color="#000080">(</font>a<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>Total<font color="#000080">:=</font>a<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>Assign<font color="#000080">(</font>f1<font color="#000080">,</font><font color="#800000">'messages.dat'</font><font color="#000080">);
</font>Reset<font color="#000080">(</font>f1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font>InitMsgBase<font color="#000080">;
</font>a<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>REpeat
</b></font>ReadMsg<font color="#000080">(</font>a<font color="#000080">);
</font>c<font color="#000080">:=</font>ReadKey<font color="#000080">;
</font><font color="#FF0000"><b>If </b></font>c<font color="#000080">=</font><font color="#800000">'+' </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>A<font color="#000080">);
</font><font color="#FF0000"><b>If </b></font>c<font color="#000080">=</font><font color="#800000">'-' </font><font color="#FF0000"><b>Then </b></font>Dec<font color="#000080">(</font>A<font color="#000080">);
</font><font color="#FF0000"><b>If </b></font>a<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>a<font color="#000080">:=</font>Total<font color="#000080">;

</font><font color="#FF0000"><b>if </b></font>a<font color="#000080">&gt;</font>Total <font color="#FF0000"><b>Then </b></font>a<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>UNTIL </b></font>c<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">. ---</font><font color="#800000">8</font><font color="#000080">&lt;---  </font><font color="#FF0000"><b>End </b></font>QWKPMG<font color="#000080">.</font>PAS  <font color="#000080">---</font><font color="#800000">8</font><font color="#000080">&lt;---
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0034.PAS">Original</a><b>]</b></p></body>
</html>
