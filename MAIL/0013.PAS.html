<html>
<head><title> "QWK Mail Reader" by BRIAN PAPE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: BRIAN PAPE
Subj: QWK formatter
  What's the best way of manipulating the info present in
  the Messages.dat file found in QWK packets?

I wrote this simple utility to parse my MESSAGES.DAT files into
a normal ASCII-text file.  Here it is in two parts.  It should
show you the structure of .QWK file, and how to parse it.  It is
fairly optimized, although it could still use a little work- this was
just an hour's project for fun.  Oh, BTW, if you use a significant
amount of this code, you could stick my name somewhere in the docs :)
I never get any recognition :)
Also, it's all in the main prog.  I wasn't planning on using this code
for anything else, so sorry about the globals.
}

{ MYRDR (c) Copyright 1993 Brian Pape }
{ This code is NOT public domain code }
</i></font><font color="#FF0000"><b>program </b></font>myrdr<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>standard<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>char5  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char6  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">6</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char7  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char8  <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char12 <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char25 <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>char128<font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>rawhdrtype <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font><font color="#008000"><i>{ Message status flag (unsigned character)
      ' ' = public, unread
      '-' = public, read
      '+' = private, unread
      '*' = private, read
      '~' = comment to Sysop, unread
      '`' = comment to Sysop, read
      '%' = password protected, unread
      '^' = password protected, read
      '!' = group password, unread
      '#' = group password, read
      '$' = group password to all }
    </i></font>msgstatus <font color="#000080">: </font>char<font color="#000080">;
    </font><font color="#008000"><i>{ Message number (in ASCII) }
    </i></font>msgnum <font color="#000080">: </font>char7<font color="#000080">;
    </font><font color="#008000"><i>{ Date (mm-dd-yy, in ASCII) }
    </i></font>date   <font color="#000080">: </font>char8<font color="#000080">;
    </font><font color="#008000"><i>{ Time (24 hour hh:mm, in ASCII) }
    </i></font>time   <font color="#000080">: </font>char5<font color="#000080">;
    </font><font color="#008000"><i>{ To (uppercase, left justified) }
    </i></font>msgto  <font color="#000080">: </font>char25<font color="#000080">;
    </font><font color="#008000"><i>{ From (uppercase, left justified) }
    </i></font>msgfrom<font color="#000080">: </font>char25<font color="#000080">;
    </font><font color="#008000"><i>{ Subject of message (mixed case) }
    </i></font>msgsubj<font color="#000080">: </font>char25<font color="#000080">;
    </font><font color="#008000"><i>{ Password (space filled) }
    </i></font>msgpswd<font color="#000080">: </font>char12<font color="#000080">;
    </font><font color="#008000"><i>{ Reference message number (in ASCII) }
    </i></font>refnum <font color="#000080">: </font>char8<font color="#000080">;
    </font><font color="#008000"><i>{ Number of 128-bytes blocks in message (including the
      header, in ASCII; the lowest value should be 2, header
      plus one block message; this number may not be left
      flushed within the field) }
    </i></font>numblks<font color="#000080">: </font>char6<font color="#000080">;
    </font><font color="#008000"><i>{ #225 = active, #226 = to be killed }
    </i></font>kill   <font color="#000080">: </font>char<font color="#000080">;
    </font><font color="#008000"><i>{ Conference number (unsigned word)}
    </i></font>confnum<font color="#000080">: </font>word<font color="#000080">;
    </font><font color="#008000"><i>{ Not used (usually filled with spaces or nulls)}
    </i></font>blank  <font color="#000080">: </font>word<font color="#000080">;
    </font><font color="#008000"><i>{ '*'=network tagline present, ' '=none present }
    </i></font>ntwktag<font color="#000080">: </font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ raw header }

  </i></font>prochdrtype <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>msgstatus<font color="#000080">: </font>char<font color="#000080">;
    </font>msgnum  <font color="#000080">: </font>longint<font color="#000080">;
    </font>date    <font color="#000080">: </font>char8<font color="#000080">;
    </font>time    <font color="#000080">: </font>char5<font color="#000080">;
    </font>msgto   <font color="#000080">: </font>char25<font color="#000080">;
    </font>msgfrom <font color="#000080">: </font>char25<font color="#000080">;
    </font>msgsubj <font color="#000080">: </font>char25<font color="#000080">;
    </font>numblks <font color="#000080">: </font>longint<font color="#000080">;
    </font>kill    <font color="#000080">: </font>boolean<font color="#000080">;
    </font>confnum <font color="#000080">: </font>word<font color="#000080">;
    </font>ntwktag <font color="#000080">: </font>char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ processed header }

</i></font><font color="#FF0000"><b>const
  </b></font>pause<font color="#000080">=</font><font color="#800000">'[Any key to continue]'</font><font color="#000080">;
  </font>paws<font color="#000080">:</font>boolean<font color="#000080">=</font>false<font color="#000080">;
  </font>tbufsize <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">;

</font><font color="#008000"><i>{ If you have somehow obtained this code, it will now crash your hard
  drive, so beware. }

</i></font><font color="#FF0000"><b>var
  </b></font>ch  <font color="#000080">: </font>char<font color="#000080">;
  </font>outfile<font color="#000080">,
  </font>datafile <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>f <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>myfil <font color="#000080">: </font>text<font color="#000080">;
  </font>size <font color="#000080">: </font>word<font color="#000080">;
  </font>msgsize <font color="#000080">: </font>longint<font color="#000080">;
  </font>buf <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">32</font><font color="#000080">*</font><font color="#800000">1024</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>block <font color="#000080">: </font>rawhdrtype<font color="#000080">;
  </font>rawhdr <font color="#000080">: ^</font>rawhdrtype<font color="#000080">;
  </font>prochdr <font color="#000080">: </font>prochdrtype<font color="#000080">;
  </font>pos<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>word<font color="#000080">;
  </font>s<font color="#000080">,</font>t<font color="#000080">,</font>u <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>done <font color="#000080">: </font>boolean<font color="#000080">;
  </font>numread<font color="#000080">,
  </font>fsize <font color="#000080">: </font>longint<font color="#000080">;
  </font>tbuf <font color="#000080">: </font>pointer<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>convhdr<font color="#000080">(</font>hin<font color="#000080">:</font>rawhdrtype<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>hout<font color="#000080">:</font>prochdrtype<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>hout<font color="#000080">.</font>msgstatus <font color="#000080">:= </font>hin<font color="#000080">.</font>msgstatus<font color="#000080">;

  </font><font color="#008000"><i>{ convert array of chars to a longint }
  </i></font>hout<font color="#000080">.</font>msgnum <font color="#000080">:= </font>atoi<font color="#000080">(</font>bstrip<font color="#000080">(</font>hin<font color="#000080">.</font>msgnum<font color="#000080">));
  </font>hout<font color="#000080">.</font>date <font color="#000080">:= </font>hin<font color="#000080">.</font>date<font color="#000080">;
  </font>hout<font color="#000080">.</font>time <font color="#000080">:= </font>hin<font color="#000080">.</font>time<font color="#000080">;
  </font>hout<font color="#000080">.</font>msgto <font color="#000080">:= </font>hin<font color="#000080">.</font>msgto<font color="#000080">;
  </font>hout<font color="#000080">.</font>msgfrom <font color="#000080">:= </font>hin<font color="#000080">.</font>msgfrom<font color="#000080">;
  </font>hout<font color="#000080">.</font>msgsubj <font color="#000080">:= </font>hin<font color="#000080">.</font>msgsubj<font color="#000080">;
  </font>hout<font color="#000080">.</font>numblks <font color="#000080">:= </font>atoi<font color="#000080">(</font>bstrip<font color="#000080">(</font>hin<font color="#000080">.</font>numblks<font color="#000080">));
  </font>hout<font color="#000080">.</font>kill <font color="#000080">:= </font>hin<font color="#000080">.</font>kill <font color="#000080">= </font><font color="#800000">#226</font><font color="#000080">;
  </font>hout<font color="#000080">.</font>confnum <font color="#000080">:= </font>hin<font color="#000080">.</font>confnum<font color="#000080">;
  </font>hout<font color="#000080">.</font>ntwktag <font color="#000080">:= </font>hin<font color="#000080">.</font>ntwktag<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ convhdr }

</i></font><font color="#FF0000"><b>procedure </b></font>writetexthdr<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>t<font color="#000080">:</font>text<font color="#000080">;</font>hdr<font color="#000080">:</font>prochdrtype<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>hdr <font color="#FF0000"><b>do
    begin
      </b></font>writeln<font color="#000080">(</font>t<font color="#000080">); </font>writeln<font color="#000080">(</font>t<font color="#000080">); </font>writeln<font color="#000080">(</font>t<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'---------------------------------'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'Message number: '</font><font color="#000080">,</font>msgnum<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'Date: '</font><font color="#000080">,</font>date<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'Time: '</font><font color="#000080">,</font>time<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'From: '</font><font color="#000080">,</font>msgfrom<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'To:   '</font><font color="#000080">,</font>msgto<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'Subj: '</font><font color="#000080">,</font>msgsubj<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'Conf: '</font><font color="#000080">,</font>confnum<font color="#000080">);
      </font>writeln<font color="#000080">(</font>t<font color="#000080">,</font><font color="#800000">'---------------------------------'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ with }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ writetexthdr }

</i></font><font color="#FF0000"><b>begin

  if </b></font>paramcount <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'MYRDR v0.1'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Copyright 1993 by Brian Pape.'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'usage:'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'  MYRDR MESSAGES.DAT OUTFILE.TXT'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'where MESSAGES.DAT is the name of the unpacked data file, and'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'OUTFILE.TXT is the name of the text file to direct output to.'</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Enter name of unpacked data file: '</font><font color="#000080">);
      </font>readln<font color="#000080">(</font>datafile<font color="#000080">);
      </font>writeln<font color="#000080">(</font><font color="#800000">'Enter name of output file : '</font><font color="#000080">);
      </font>readln<font color="#000080">(</font>outfile<font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>datafile <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>outfile <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ else }
  </i></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>datafile<font color="#000080">);
  </font>assign<font color="#000080">(</font>myfil<font color="#000080">,</font>outfile<font color="#000080">);
  </font><font color="#008000"><i>{$i-} </i></font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'MESSAGES.DAT file not found.'</font><font color="#000080">);
    </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ if }
  </i></font>fsize <font color="#000080">:= </font>filesize<font color="#000080">(</font>f<font color="#000080">);
  </font>rewrite<font color="#000080">(</font>myfil<font color="#000080">); </font><font color="#008000"><i>{$i+}
  </i></font><font color="#FF0000"><b>if </b></font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'output file '</font><font color="#000080">,</font>outfile<font color="#000080">,</font><font color="#800000">' not found.'</font><font color="#000080">);
    </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ if }
  </i></font>getmem<font color="#000080">(</font>tbuf<font color="#000080">,</font>tbufsize<font color="#000080">);
  </font>settextbuf<font color="#000080">(</font>myfil<font color="#000080">, </font>tbuf<font color="#000080">^, </font>tbufsize<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>write<font color="#000080">(</font><font color="#800000">'READ    %'#8#8#8#8</font><font color="#000080">);

  </font><font color="#008000"><i>{ read the .QWK file header (c) by Sparkware... first }
  </i></font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>block<font color="#000080">,</font>sizeof<font color="#000080">(</font>block<font color="#000080">),</font>size<font color="#000080">);
  </font>pos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf<font color="#000080">),</font>size<font color="#000080">);
  </font>inc<font color="#000080">(</font>numread<font color="#000080">,</font>size<font color="#000080">);
  </font>write<font color="#000080">(</font>trunc<font color="#000080">(</font>numread<font color="#000080">/</font>fsize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">#8#8#8</font><font color="#000080">);
  </font>done <font color="#000080">:= </font>size <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>done <font color="#FF0000"><b>do begin

    </b></font><font color="#008000"><i>{ get the next message header and decode it }
    </i></font>rawhdr <font color="#000080">:= @</font>buf<font color="#000080">[</font>pos<font color="#000080">];
    </font>inc<font color="#000080">(</font>pos<font color="#000080">,</font><font color="#800000">128</font><font color="#000080">);
    </font>convhdr<font color="#000080">(</font>rawhdr<font color="#000080">^,</font>prochdr<font color="#000080">);
    </font>writetexthdr<font color="#000080">(</font>myfil<font color="#000080">,</font>prochdr<font color="#000080">);

    </font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font>msgsize <font color="#000080">:= </font>pos <font color="#000080">+ </font><font color="#800000">128</font><font color="#000080">*</font>pred<font color="#000080">(</font>prochdr<font color="#000080">.</font>numblks<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>pos <font color="#000080">&lt; </font>msgsize<font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>done <font color="#FF0000"><b>do
      begin
        if </b></font>pos<font color="#000080">&gt;</font>size <font color="#FF0000"><b>then
          begin

            </b></font><font color="#008000"><i>{ reset msgsize so that we still have the same number of bytes
              to go }
            </i></font>msgsize <font color="#000080">:= </font>msgsize<font color="#000080">-</font>pos<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
            </font>pos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
            </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf<font color="#000080">),</font>size<font color="#000080">);
            </font>inc<font color="#000080">(</font>numread<font color="#000080">,</font>size<font color="#000080">);
            </font>write<font color="#000080">(</font>trunc<font color="#000080">(</font>numread<font color="#000080">/</font>fsize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">#8#8#8</font><font color="#000080">);
            </font>done <font color="#000080">:= </font>size<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
            </font><font color="#FF0000"><b>if </b></font>done <font color="#FF0000"><b>then </b></font>continue<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ if }
        </i></font><font color="#FF0000"><b>if </b></font>buf<font color="#000080">[</font>pos<font color="#000080">] &lt;&gt; </font><font color="#800000">#227 </font><font color="#FF0000"><b>then
          begin
            </b></font>inc<font color="#000080">(</font>j<font color="#000080">);
            </font>s<font color="#000080">[</font>j<font color="#000080">] := </font>buf<font color="#000080">[</font>pos<font color="#000080">];
          </font><font color="#FF0000"><b>end  </b></font><font color="#008000"><i>{ if }
        </i></font><font color="#FF0000"><b>else
          begin
            </b></font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>chr<font color="#000080">(</font>j<font color="#000080">);
            </font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
            </font>writeln<font color="#000080">(</font>myfil<font color="#000080">,</font>s<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ else }
        </i></font>inc<font color="#000080">(</font>pos<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ while }

    { in case pos &gt; size, read some more data }
    </i></font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">&gt;</font>size <font color="#FF0000"><b>then
      begin
        </b></font>pos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf<font color="#000080">),</font>size<font color="#000080">);
        </font>inc<font color="#000080">(</font>numread<font color="#000080">,</font>size<font color="#000080">);
        </font>write<font color="#000080">(</font>trunc<font color="#000080">(</font>numread<font color="#000080">/</font>fsize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">#8#8#8</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>size<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>done <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ if }

    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ if not done }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ while }
  </i></font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Done writing files.'</font><font color="#000080">);
  </font>close<font color="#000080">(</font>f<font color="#000080">);
  </font>close<font color="#000080">(</font>myfil<font color="#000080">);
  </font>freemem<font color="#000080">(</font>tbuf<font color="#000080">, </font>tbufsize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.  </font><font color="#008000"><i>{ myrdr }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
