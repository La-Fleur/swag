<html>
<head><title> "Numbers in QWK packets" by TRYGVE GUDMUNDSEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
TH&gt; Apparently this contains the filepositions of the records (and also the
TH&gt; conference numbers?) but the numbers are not in normal format. Can somebody
TH&gt;  please explain the format of this file and how to convert these numbers to
TH&gt; and from something TP can work with?

There is supposed to be at least two doc's explaining the QWK format. I have
here a unit that converts the integer to basicreal (i guess it's what you
need..) I'm sorry I can't remember the of the doc's..

------------------- 8&lt;
}
</i></font><font color="#FF0000"><b>Unit </b></font>BasConv<font color="#000080">;

</font><font color="#FF0000"><b>Interface
  Function </b></font>BasicReal2Long<font color="#000080">(</font>InValue<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
                </font><font color="#008000"><i>{Convert Basic Short Reals to LongInts}

  </i></font><font color="#FF0000"><b>Function </b></font>Long2BasicReal<font color="#000080">(</font>InValue<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
                </font><font color="#008000"><i>{Convert LongInts to Basic Short Reals}

</i></font><font color="#FF0000"><b>Implementation

Function </b></font>BasicReal2Long<font color="#000080">(</font>InValue<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Var
  </b></font>Temp<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Expon<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Expon <font color="#000080">:= ((</font>InValue <font color="#FF0000"><b>shr </b></font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$ff</font><font color="#000080">) - </font><font color="#800000">152</font><font color="#000080">;
  </font>Temp <font color="#000080">:= (</font>InValue <font color="#FF0000"><b>and </b></font><font color="#800000">$007FFFFF</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#800000">$00800000</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Expon <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>Temp <font color="#000080">:= </font>Temp <font color="#FF0000"><b>shr </b></font>Abs<font color="#000080">(</font>Expon<font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Temp <font color="#000080">:= </font>Temp <font color="#FF0000"><b>shl </b></font>Expon<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>InValue <font color="#FF0000"><b>and </b></font><font color="#800000">$00800000</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>BasicReal2Long <font color="#000080">:= -</font>Temp
  <font color="#FF0000"><b>Else
    </b></font>BasicReal2Long <font color="#000080">:= </font>Temp<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Expon <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>BasicReal2Long <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Long2BasicReal<font color="#000080">(</font>InValue<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
  </b></font>Negative<font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Expon<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  If </b></font>InValue <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>Long2BasicReal <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>Else
    Begin
    If </b></font>InValue <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      Begin
      </b></font>Negative <font color="#000080">:= </font>True<font color="#000080">;
      </font>InValue <font color="#000080">:= </font>Abs<font color="#000080">(</font>InValue<font color="#000080">);
      </font><font color="#FF0000"><b>End
    Else
      </b></font>Negative <font color="#000080">:= </font>False<font color="#000080">;
    </font>Expon <font color="#000080">:= </font><font color="#800000">152</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>InValue <font color="#000080">&lt; </font><font color="#800000">$007FFFFF </font><font color="#FF0000"><b>Then
      While </b></font><font color="#000080">((</font>InValue <font color="#FF0000"><b>and </b></font><font color="#800000">$00800000</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        Begin
        </b></font>InValue <font color="#000080">:= </font>InValue <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
        </font>Dec<font color="#000080">(</font>Expon<font color="#000080">);
        </font><font color="#FF0000"><b>End
    Else
      While </b></font><font color="#000080">((</font>InValue <font color="#FF0000"><b>And </b></font><font color="#800000">$FF000000</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do
        Begin
        </b></font>InValue <font color="#000080">:= </font>InValue <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
        </font>Inc<font color="#000080">(</font>Expon<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>InValue <font color="#000080">:= </font>InValue <font color="#FF0000"><b>And </b></font><font color="#800000">$007FFFFF</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Negative <font color="#FF0000"><b>Then
      </b></font>InValue <font color="#000080">:= </font>InValue <font color="#FF0000"><b>Or </b></font><font color="#800000">$00800000</font><font color="#000080">;
    </font>Long2BasicReal <font color="#000080">:= </font>InValue <font color="#000080">+ (</font>Expon <font color="#FF0000"><b>shl </b></font><font color="#800000">24</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0018.PAS">Original</a><b>]</b></p></body>
</html>
