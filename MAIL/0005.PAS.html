<html>
<head><title> "FIDONET *.MSG format" by KELLY DROWN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I am trying to write a program.  Does anyone have the structures for the
&gt; FIDONET *.MSG format.  ANy help would be greatly appreciated.
}

</i></font><font color="#FF0000"><b>Unit </b></font>FidoNet<font color="#000080">; </font><font color="#008000"><i>{ Beta Copy - Rev 6/5/89 - Tested 6/20/89  Ver. 0.31 }

           { FIDONET UNIT by Kelly Drown, Copyright (C)1988,89-LCP  }
           {                                   All rights reserved  }
           { If you use this unit in your own programming, I ask    }
           { only that you give me credit in your documentation.    }
           { I ask this instead of money. All of the following code }
           { is covered under the copyright of Laser Computing Co.  }
           { and may be used in your own programming provided the   }
           { terms above have been satisfactorily met.              }

</i></font><font color="#FF0000"><b>INTERFACE

Uses
  </b></font>Dos<font color="#000080">,
  </font>Crt<font color="#000080">,
  </font>StrnTTT5<font color="#000080">,  </font><font color="#008000"><i>{ TechnoJocks Turbo Toolkit v5.0 }
  </i></font>MiscTTT5<font color="#000080">;


</font><font color="#FF0000"><b>Type
  </b></font>NetMsg <font color="#000080">= </font><font color="#FF0000"><b>Record        </b></font><font color="#008000"><i>{ NetMessage Record Structure }
    </i></font>From<font color="#000080">,
    </font>Too        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">35</font><font color="#000080">];
    </font>Subject    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">71</font><font color="#000080">];
    </font>Date       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">19</font><font color="#000080">];
    </font>TimesRead<font color="#000080">,
    </font>DestNode<font color="#000080">,
    </font>OrigNode<font color="#000080">,
    </font>Cost<font color="#000080">,
    </font>OrigNet<font color="#000080">,
    </font>DestNet<font color="#000080">,
    </font>ReplyTo<font color="#000080">,
    </font>Attr<font color="#000080">,
    </font>NextReply  <font color="#000080">: </font>Word<font color="#000080">;
    </font>AreaName   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PktHeader <font color="#000080">= </font><font color="#FF0000"><b>Record        </b></font><font color="#008000"><i>{ Packet Header of Packet }
    </i></font>OrigNode<font color="#000080">,
    </font>DestNode<font color="#000080">,
    </font>Year<font color="#000080">,
    </font>Month<font color="#000080">,
    </font>Day<font color="#000080">,
    </font>Hour<font color="#000080">,
    </font>Minute<font color="#000080">,
    </font>Second<font color="#000080">,
    </font>Baud<font color="#000080">,
    </font>OrigNet<font color="#000080">,
    </font>DestNet  <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>PktMessage <font color="#000080">= </font><font color="#FF0000"><b>Record        </b></font><font color="#008000"><i>{ Packet Header of each individual message }
    </i></font>OrigNode<font color="#000080">,
    </font>DestNode<font color="#000080">,
    </font>OrigNet<font color="#000080">,
    </font>DestNet<font color="#000080">,
    </font>Attr<font color="#000080">,
    </font>Cost     <font color="#000080">: </font>Word<font color="#000080">;
    </font>Date     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">19</font><font color="#000080">];
    </font>Too      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">35</font><font color="#000080">];
    </font>From     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">35</font><font color="#000080">];
    </font>Subject  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">71</font><font color="#000080">];
    </font>AreaName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>ArchiveName <font color="#000080">= </font><font color="#FF0000"><b>Record        </b></font><font color="#008000"><i>{ Internal Record Structure used for     }
    </i></font>MyNet<font color="#000080">,                    </font><font color="#008000"><i>{ determining the name of of an echomail }
    </i></font>MyNode<font color="#000080">,                   </font><font color="#008000"><i>{ archive. i.e. 00FA1FD3.MO1             }
    </i></font>HisNet<font color="#000080">,
    </font>HisNode <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const                        </b></font><font color="#008000"><i>{ Attribute Flags }
  </i></font>_Private  <font color="#000080">= </font><font color="#800000">$0001</font><font color="#000080">;
  </font>_Crash    <font color="#000080">= </font><font color="#800000">$0002</font><font color="#000080">;
  </font>_Recvd    <font color="#000080">= </font><font color="#800000">$0004</font><font color="#000080">;
  </font>_Sent     <font color="#000080">= </font><font color="#800000">$0008</font><font color="#000080">;
  </font>_File     <font color="#000080">= </font><font color="#800000">$0010</font><font color="#000080">;
  </font>_Forward  <font color="#000080">= </font><font color="#800000">$0020</font><font color="#000080">;     </font><font color="#008000"><i>{ Also know as In-Transit }
  </i></font>_Orphan   <font color="#000080">= </font><font color="#800000">$0040</font><font color="#000080">;
  </font>_KillSent <font color="#000080">= </font><font color="#800000">$0080</font><font color="#000080">;
  </font>_Local    <font color="#000080">= </font><font color="#800000">$0100</font><font color="#000080">;
  </font>_Hold     <font color="#000080">= </font><font color="#800000">$0200</font><font color="#000080">;
  </font>_Freq     <font color="#000080">= </font><font color="#800000">$0800</font><font color="#000080">;

  </font>Status    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>Of String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] =
                (</font><font color="#800000">'Jan'</font><font color="#000080">,</font><font color="#800000">'Feb'</font><font color="#000080">,</font><font color="#800000">'Mar'</font><font color="#000080">,</font><font color="#800000">'Apr'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'Jun'</font><font color="#000080">,
                 </font><font color="#800000">'Jul'</font><font color="#000080">,</font><font color="#800000">'Aug'</font><font color="#000080">,</font><font color="#800000">'Sep'</font><font color="#000080">,</font><font color="#800000">'Oct'</font><font color="#000080">,</font><font color="#800000">'Nov'</font><font color="#000080">,</font><font color="#800000">'Dec'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Net  <font color="#000080">: </font>NetMsg<font color="#000080">;
  </font>PH   <font color="#000080">: </font>PktHeader<font color="#000080">;
  </font>PM   <font color="#000080">: </font>PktMessage<font color="#000080">;
  </font>ArcN <font color="#000080">: </font>ArchiveName<font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>PacketName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>PacketMessage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>PacketHeader <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>NetMessage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetPath<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetNet<font color="#000080">(</font>GN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetNode<font color="#000080">(</font>GN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>MsgDateStamp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>LastMsgNum<font color="#000080">(</font>_NetPath <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Hex<font color="#000080">(</font>n <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ArcName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ExpandNodeNumbers<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>List <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>TotalNumber <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Conv_NetNode<font color="#000080">(</font>NetNode <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Net<font color="#000080">, </font>Node <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>PacketName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Creates and returns a unique Packet name }
</i></font><font color="#FF0000"><b>Var
  </b></font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">,
  </font>hs<font color="#000080">, </font>yr<font color="#000080">,
  </font>mo<font color="#000080">, </font>da<font color="#000080">,
  </font>dow     <font color="#000080">: </font>Word<font color="#000080">;
  </font>WrkStr  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>WrkStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>GetTime<font color="#000080">(</font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hs<font color="#000080">);
  </font>GetDate<font color="#000080">(</font>yr<font color="#000080">, </font>mo<font color="#000080">, </font>da<font color="#000080">, </font>dow<font color="#000080">);

  </font>WrkStr <font color="#000080">:= </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>da<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">)
           + </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>h<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">)
           + </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>m<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">)
           + </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>s<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);

  </font>PacketName <font color="#000080">:= </font>WrkStr <font color="#000080">+ </font><font color="#800000">'.PKT'</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>PacketMessage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns a Packet message header }
</i></font><font color="#FF0000"><b>Var
  </b></font>Hdr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Hdr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font>Hdr <font color="#000080">:= </font><font color="#800000">#2#0 </font><font color="#008000"><i>{ Type #2 packets... Type #1 is obsolete }
         </i></font><font color="#000080">+ </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>OrigNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>OrigNode<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>DestNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>DestNode<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>OrigNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>OrigNet<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>DestNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>DestNet<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>Attr<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>Attr<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PM<font color="#000080">.</font>Cost<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PM<font color="#000080">.</font>Cost<font color="#000080">))
         + </font>PM<font color="#000080">.</font>Date <font color="#000080">+ </font><font color="#800000">#0 </font><font color="#000080">+ </font>PM<font color="#000080">.</font>Too <font color="#000080">+ </font><font color="#800000">#0 </font><font color="#000080">+ </font>PM<font color="#000080">.</font>From <font color="#000080">+ </font><font color="#800000">#0 </font><font color="#000080">+ </font>PM<font color="#000080">.</font>Subject <font color="#000080">+ </font><font color="#800000">#0
         </font><font color="#000080">+ </font>Upper<font color="#000080">(</font>PM<font color="#000080">.</font>AreaName<font color="#000080">);

  </font>PacketMessage <font color="#000080">:= </font>Hdr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>PacketHeader <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns a Packet Header String }
</i></font><font color="#FF0000"><b>Var
  </b></font>Hdr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Hdr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font>Hdr <font color="#000080">:= </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>OrigNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>OrigNode<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>DestNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>DestNode<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Year<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Year<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Month<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Month<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Day<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Day<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Hour<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Hour<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Minute<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Minute<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Second<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Second<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>Baud<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>Baud<font color="#000080">))
         + </font><font color="#800000">#2#0 </font><font color="#000080">+ </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>OrigNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>OrigNet<font color="#000080">))
         + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>PH<font color="#000080">.</font>DestNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>PH<font color="#000080">.</font>DestNet<font color="#000080">))
         + </font><font color="#800000">#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0   </font><font color="#008000"><i>{ Null Field Fill Space }
         </i></font><font color="#000080">+ </font><font color="#800000">#0#0#0#0#0#0#0#0#0#0#0#0#0#0#0</font><font color="#000080">;

  </font>PacketHeader <font color="#000080">:= </font>Hdr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>NetMessage <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns a NetMessage header string }
</i></font><font color="#FF0000"><b>Var
  </b></font>Hdr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Hdr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

  </font>Hdr <font color="#000080">:= </font>PadLeft<font color="#000080">(</font>Net<font color="#000080">.</font>From<font color="#000080">, </font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);
  </font>Hdr <font color="#000080">:= </font>Hdr <font color="#000080">+ </font>PadLeft<font color="#000080">(</font>Net<font color="#000080">.</font>Too<font color="#000080">, </font><font color="#800000">36</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">)
             + </font>PadLeft<font color="#000080">(</font>Net<font color="#000080">.</font>Subject<font color="#000080">, </font><font color="#800000">72</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">)
             + </font>PadRight<font color="#000080">(</font>Net<font color="#000080">.</font>Date<font color="#000080">, </font><font color="#800000">19</font><font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">) + </font><font color="#800000">#0
             </font><font color="#000080">+ </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>TimesRead<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>TimesRead<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>DestNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>DestNode<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>OrigNode<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>OrigNode<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>Cost<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>Cost<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>OrigNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>OrigNet<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>DestNet<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>DestNet<font color="#000080">))
             + </font><font color="#800000">#0#0#0#0#0#0#0#0
             </font><font color="#000080">+ </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>ReplyTo<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>ReplyTo<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>Attr<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>Attr<font color="#000080">))
             + </font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>Net<font color="#000080">.</font>NextReply<font color="#000080">)) + </font>Chr<font color="#000080">(</font>Hi<font color="#000080">(</font>Net<font color="#000080">.</font>NextReply<font color="#000080">))
             + </font>Upper<font color="#000080">(</font>Net<font color="#000080">.</font>AreaName<font color="#000080">);

  </font>NetMessage <font color="#000080">:= </font>Hdr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>GetPath<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>FName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Returns the FULL Path and filename for a filename if the file  }
{ is found in the path. }
</i></font><font color="#FF0000"><b>Var
  </b></font>Str1<font color="#000080">,
  </font>Str2    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>NR      <font color="#000080">: </font>Byte<font color="#000080">;
  </font>HomeDir <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>HomeDir <font color="#000080">:= </font>FExpand<font color="#000080">(</font>FName<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Exist<font color="#000080">(</font>HomeDir<font color="#000080">) </font><font color="#FF0000"><b>Then
  Begin
    </b></font>FName   <font color="#000080">:= </font>HomeDir<font color="#000080">;
    </font>GetPath <font color="#000080">:= </font>True<font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>Str1 <font color="#000080">:= </font>GetEnv<font color="#000080">(</font><font color="#800000">'PATH'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>NR <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Str1<font color="#000080">) </font><font color="#FF0000"><b>DO
    IF </b></font>Str1<font color="#000080">[</font>NR<font color="#000080">] = </font><font color="#800000">';' </font><font color="#FF0000"><b>Then
      </b></font>Str1<font color="#000080">[</font>NR<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>NR <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>WordCnt<font color="#000080">(</font>Str1<font color="#000080">) </font><font color="#FF0000"><b>DO
  Begin
    </b></font>Str2 <font color="#000080">:= </font>ExtractWords<font color="#000080">(</font>NR<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Str1<font color="#000080">) + </font><font color="#800000">'\' </font><font color="#000080">+ </font>FName<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>Exist<font color="#000080">(</font>Str2<font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
      </b></font>FName   <font color="#000080">:= </font>Str2<font color="#000080">;
      </font>GetPath <font color="#000080">:= </font>True<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>GetPath <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>MsgDateStamp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{ Creates Fido standard- 01 Jan 89 21:05:18 }
</i></font><font color="#FF0000"><b>Var                              </b></font><font color="#008000"><i>{ Standard message header time/date stamp   }
  </i></font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">,
  </font>hs<font color="#000080">, </font>y<font color="#000080">, </font>mo<font color="#000080">,
  </font>d<font color="#000080">, </font>dow    <font color="#000080">: </font>Word<font color="#000080">;
  </font>Tmp<font color="#000080">, </font>o1<font color="#000080">,
  </font>o2<font color="#000080">, </font>o3    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>o1  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>o2  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>o3  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>tmp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>GetDate<font color="#000080">(</font>y<font color="#000080">, </font>mo<font color="#000080">, </font>d<font color="#000080">, </font>dow<font color="#000080">);
  </font>GetTime<font color="#000080">(</font>h<font color="#000080">, </font>m<font color="#000080">, </font>s<font color="#000080">, </font>hs<font color="#000080">);
  </font>o1  <font color="#000080">:= </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>d<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
  </font>o2  <font color="#000080">:= </font>Status<font color="#000080">[</font>mo<font color="#000080">];
  </font>o3  <font color="#000080">:= </font>Last<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>Int_To_Str<font color="#000080">(</font>y<font color="#000080">));
  </font>Tmp <font color="#000080">:= </font>Concat<font color="#000080">(</font>o1<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>o2<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>o3<font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">);
  </font>o1  <font color="#000080">:= </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>h<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
  </font>o2  <font color="#000080">:= </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>m<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
  </font>o3  <font color="#000080">:= </font>PadRight<font color="#000080">(</font>Int_To_Str<font color="#000080">(</font>s<font color="#000080">), </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">);
  </font>Tmp <font color="#000080">:= </font>Tmp <font color="#000080">+ </font>Concat<font color="#000080">(</font>o1<font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font>o2<font color="#000080">, </font><font color="#800000">':'</font><font color="#000080">, </font>o3<font color="#000080">);
  </font>MsgDateStamp <font color="#000080">:= </font>Tmp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>MsgToNum<font color="#000080">(</font>Fnm <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ Used Internally by LastMsgNum }
</i></font><font color="#FF0000"><b>Var
  </b></font>p <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>p        <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Fnm<font color="#000080">);
  </font>Fnm      <font color="#000080">:= </font>First<font color="#000080">(</font>p <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>Fnm<font color="#000080">);
  </font>MsgToNum <font color="#000080">:= </font>Str_To_Int<font color="#000080">(</font>Fnm<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Function </b></font>LastMsgNum<font color="#000080">(</font>_NetPath <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{ Returns the highest numbered xxx.MSG in NetPath directory }
</i></font><font color="#FF0000"><b>Var
  </b></font>_Path<font color="#000080">,
  </font>Temp1<font color="#000080">,
  </font>Temp2   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Len     <font color="#000080">: </font>Byte<font color="#000080">;
  </font>DxirInf <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>Num<font color="#000080">,
  </font>Num1    <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Num   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Num1  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Temp1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Temp2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>_Path <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>_Path <font color="#000080">:= </font>_NetPath <font color="#000080">+ </font><font color="#800000">'\*.MSG'</font><font color="#000080">;

  </font>FindFirst<font color="#000080">(</font>_Path<font color="#000080">, </font>Archive<font color="#000080">, </font>DxirInf<font color="#000080">);
  </font><font color="#FF0000"><b>While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  Begin
    </b></font>Temp1 <font color="#000080">:= </font>DxirInf<font color="#000080">.</font>Name<font color="#000080">;
    </font>Num1 <font color="#000080">:= </font>MsgToNum<font color="#000080">(</font>Temp1<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>Num1 <font color="#000080">&gt; </font>Num <font color="#FF0000"><b>Then
      </b></font>Num <font color="#000080">:= </font>Num1<font color="#000080">;
    </font>FindNext<font color="#000080">(</font>DxirInf<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>Num <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>Num <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>LastMsgNum <font color="#000080">:= </font>Num<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>Hex<font color="#000080">(</font>N <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Converts an integer or word to it's Hex equivelent }
</i></font><font color="#FF0000"><b>Var
  </b></font>L   <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
  </font>BHi<font color="#000080">,
  </font>BLo <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>L   <font color="#000080">:= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
  </font>BHi <font color="#000080">:= </font>Hi<font color="#000080">(</font>n<font color="#000080">);
  </font>BLo <font color="#000080">:= </font>Lo<font color="#000080">(</font>n<font color="#000080">);
  </font>Hex <font color="#000080">:= </font>copy<font color="#000080">(</font>L<font color="#000080">,</font>succ<font color="#000080">(</font>BHi <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">),  </font><font color="#800000">1</font><font color="#000080">) +
         </font>copy<font color="#000080">(</font>L<font color="#000080">,</font>succ<font color="#000080">(</font>BHi <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">), </font><font color="#800000">1</font><font color="#000080">) +
         </font>copy<font color="#000080">(</font>L<font color="#000080">,</font>succ<font color="#000080">(</font>BLo <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">),  </font><font color="#800000">1</font><font color="#000080">) +
         </font>copy<font color="#000080">(</font>L<font color="#000080">,</font>succ<font color="#000080">(</font>BLo <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>ArcName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns the proper name of an echomail archive }
</i></font><font color="#FF0000"><b>Var
  </b></font>C1<font color="#000080">, </font>C2 <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>C1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>C2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>C1 <font color="#000080">:= </font>ArcN<font color="#000080">.</font>MyNet <font color="#000080">- </font>ArcN<font color="#000080">.</font>HisNet<font color="#000080">;
  </font>C2 <font color="#000080">:= </font>ArcN<font color="#000080">.</font>MyNode <font color="#000080">- </font>ArcN<font color="#000080">.</font>HisNode<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>C1 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>C1 <font color="#000080">:= </font><font color="#800000">65535 </font><font color="#000080">+ </font>C1<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>C2 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>C2 <font color="#000080">:= </font><font color="#800000">65535 </font><font color="#000080">+ </font>C2<font color="#000080">;
  </font>ArcName <font color="#000080">:= </font>Hex<font color="#000080">(</font>C1<font color="#000080">) + </font>Hex<font color="#000080">(</font>C2<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>GetNet<font color="#000080">(</font>GN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns the NET portion of a Net/Node string }
</i></font><font color="#FF0000"><b>Var
  </b></font>P <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>P <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>GN<font color="#000080">);
  </font>GetNet <font color="#000080">:= </font>First<font color="#000080">(</font>P <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>GN<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Function </b></font>GetNode<font color="#000080">(</font>GN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns the NODE portion of a Net/Node string }
</i></font><font color="#FF0000"><b>Var
  </b></font>P <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>P <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>GN<font color="#000080">);
  </font>GetNode <font color="#000080">:= </font>Last<font color="#000080">(</font>Length<font color="#000080">(</font>GN<font color="#000080">) - </font>P<font color="#000080">, </font>GN<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>ExpandNodeNumbers<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>List <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>TotalNumber <font color="#000080">: </font>Integer <font color="#000080">);
</font><font color="#008000"><i>{ Expands a list of short form node numbers to thier proper       }
{ Net/Node representations. Example:                              }
{ The string: 170/100 101 102 5 114/12 15 17 166/225 226          }
{ Would return: 170/100 170/101 170/102 170/5 114/12 114/15 etc.. }
</i></font><font color="#FF0000"><b>Var
  </b></font>Net<font color="#000080">,
  </font>NetNode  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
  </font>HoldStr<font color="#000080">,
  </font>WS1      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>N1       <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Net <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>NetNode <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>HoldStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>WS1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>N1  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>TotalNumber <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>TotalNumber <font color="#000080">:= </font>WordCnt<font color="#000080">(</font>List<font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>N1 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>TotalNumber <font color="#FF0000"><b>DO
  Begin
    </b></font>WS1 <font color="#000080">:= </font>ExtractWords<font color="#000080">(</font>N1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>List<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>WS1<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Net <font color="#000080">:= </font>GetNet<font color="#000080">(</font>WS1<font color="#000080">) + </font><font color="#800000">'/'</font><font color="#000080">;
      </font>NetNode <font color="#000080">:= </font>WS1<font color="#000080">;
    </font><font color="#FF0000"><b>End
    ELSE
      </b></font>NetNode <font color="#000080">:= </font>Net <font color="#000080">+ </font>WS1<font color="#000080">;
    </font>HoldStr <font color="#000080">:= </font>HoldStr <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>Strip<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>NetNode<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------------------------------}
</i></font><font color="#FF0000"><b>Procedure </b></font>Conv_NetNode<font color="#000080">(</font>NetNode <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Net<font color="#000080">, </font>Node <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{ Returns NET and NODE as words from a Net/Node string }
</i></font><font color="#FF0000"><b>Var
  </b></font>WStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">6</font><font color="#000080">];
</font><font color="#FF0000"><b>Begin
  </b></font>Wstr <font color="#000080">:= </font>GetNet<font color="#000080">(</font>NetNode<font color="#000080">);
  </font>Net  <font color="#000080">:= </font>Str_To_Int<font color="#000080">(</font>Wstr<font color="#000080">);
  </font>Wstr <font color="#000080">:= </font>GetNode<font color="#000080">(</font>NetNode<font color="#000080">);
  </font>Node <font color="#000080">:= </font>Str_To_Int<font color="#000080">(</font>Wstr<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{ Initialize the data structures }

  </i></font>FillChar<font color="#000080">(</font>Net<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Net<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>PM<font color="#000080">, </font>SizeOf<font color="#000080">(</font>PM<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>PH<font color="#000080">, </font>SizeOf<font color="#000080">(</font>PH<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>ArcN<font color="#000080">, </font>SizeOf<font color="#000080">(</font>ArcN<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">. </font><font color="#008000"><i>{Unit}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MAIL SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
