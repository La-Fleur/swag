<html>
<head><title> "Determine CPU Speed" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&uacute;    Subject: How to determine mhz using TP6.0...

It seems to work pretty well, but on a 486/33DX it gave inacurate results...
}

</i></font><font color="#FF0000"><b>Program </b></font>CpuSpeed<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Speed<font color="#000080">, </font>DelayCalibrate <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>Offset <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">; </font><font color="#008000"><i>{ For TP 4.0, it should be 16 }


</i></font><font color="#FF0000"><b>Procedure </b></font>WaitForFloppy<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>tickTil     <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>TimerTicks  <font color="#000080">: </font>LongInt <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$6C</font><font color="#000080">;
  </font>motorStatus <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$3F</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>MotorStatus <font color="#FF0000"><b>and </b></font><font color="#800000">$F </font><font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Loading...'</font><font color="#000080">);
    </font>TickTil <font color="#000080">:= </font>TimerTicks <font color="#000080">+ </font><font color="#800000">91</font><font color="#000080">;
    </font><font color="#008000"><i>{There are $17FE80 ticks in a day}
    </i></font><font color="#FF0000"><b>if </b></font>TickTil <font color="#000080">&gt; </font><font color="#800000">$17FE80 </font><font color="#FF0000"><b>then
      </b></font>Dec<font color="#000080">(</font>TickTil<font color="#000080">, </font><font color="#800000">$17FE80</font><font color="#000080">);
    </font><font color="#FF0000"><b>Repeat Until </b></font><font color="#000080">(</font>MotorStatus <font color="#FF0000"><b>and </b></font><font color="#800000">$F </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>TimerTicks <font color="#000080">&gt;= </font>TickTil<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>WaitForFloppy<font color="#000080">;
  </font>DelayCalibrate <font color="#000080">:= </font>MemW<font color="#000080">[</font>Seg<font color="#000080">(</font>CheckSnow<font color="#000080">): </font>Ofs<font color="#000080">(</font>CheckSnow<font color="#000080">)+</font>Offset<font color="#000080">];
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Delay calibration value is '</font><font color="#000080">, </font>DelayCalibrate<font color="#000080">);
  </font>Speed <font color="#000080">:= ((</font>LongInt<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">) * </font>DelayCalibrate<font color="#000080">) + </font><font color="#800000">110970</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">438</font><font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Calculated speed: '</font><font color="#000080">, </font>Speed <font color="#FF0000"><b>div </b></font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">((</font>speed <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">, </font>speed <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'CPU speed is probably '</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>Speed <font color="#FF0000"><b>OF
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">499     </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'4.77MHz or below'</font><font color="#000080">);
    </font><font color="#800000">500</font><font color="#000080">..</font><font color="#800000">699   </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'6MHz'</font><font color="#000080">);
    </font><font color="#800000">700</font><font color="#000080">..</font><font color="#800000">899   </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'8MHz'</font><font color="#000080">);
    </font><font color="#800000">900</font><font color="#000080">..</font><font color="#800000">1099  </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'10MHz'</font><font color="#000080">);
    </font><font color="#800000">1100</font><font color="#000080">..</font><font color="#800000">1399 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'12MHz'</font><font color="#000080">);
    </font><font color="#800000">1400</font><font color="#000080">..</font><font color="#800000">1799 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'16MHz'</font><font color="#000080">);
    </font><font color="#800000">1800</font><font color="#000080">..</font><font color="#800000">2199 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'20MHz'</font><font color="#000080">);
    </font><font color="#800000">2200</font><font color="#000080">..</font><font color="#800000">2699 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'25MHz'</font><font color="#000080">);
    </font><font color="#800000">2700</font><font color="#000080">..</font><font color="#800000">3599 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'30MHz'</font><font color="#000080">);
    </font><font color="#FF0000"><b>ELSE
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'30MHz or MORE!'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
