<html>
<head><title> "Read/Write 93xx EEPROM chips" by IVAN BELTRAME</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
              Unit       :Eeprom
	      File       :EEPROM.PAS
              Author     :Ivan Beltrame (ivan.beltrame@nline.it)
              Date       :5 August 1997
              Rev.       :1.00b

              Note       :This unit provide to read and write in 93xx EEPROM.
                          93xx chip are present in many circuit board to
                          storage of a password,to retain some data in non
			  volatile memory,or to limit the 'life' of a device.
                          It is very easy to use it but this version has
                          a little 'bug' : *timing !*
                          Since I'm a TP6 beginner I'm not able to implement
                          a *compact* and *serious* &quot;delay&quot; routine that run
			  over microsecond or nanosecond, then I have used
			  &quot;FastWait&quot; unit by Southern Software from the
			  SWAG archive (not included in this source).
                          Use of this unit it's free, but comments on my
                          programming mode (self-made) will be apreciated.

              Important  :I decline any responsibilities or liabilities
                          resulting from the use of these informations
                          (source and schematics).


	           ------------------------------------------------------

                          Pin connections of the parallel port vs chip:

                      LPTx                    chip
                       v                       v

                                          ____________
                                  2 K    !   o        !
                     16(C2)   ---\/\/\---! 1(CS)    8 !------&gt; +5 Volt
                                  2 K    !            !
                     2 (D0)   ---\/\/\---! 2(CK)    7 !--x
                                  2 K    !            !
                     1 (C0)   ---\/\/\---! 3(DI)    6 !--x
                                100 ohm  !            !
                     11(S7)   ---\/\/\---! 4(DO)    5 !---*---&gt; GND
                                         !____________!   I
                                                          I
                     18(GND)  ____________________________I

                                             9306
                                             9346

}


</i></font><font color="#FF0000"><b>Unit </b></font>Eeprom<font color="#000080">;

</font><font color="#FF0000"><b>interface

var
  </b></font>PData      <font color="#000080">:</font>word<font color="#000080">;                            </font><font color="#008000"><i>{ may be $378 or $278 or $3BC }

</i></font><font color="#FF0000"><b>procedure </b></font>LptInit<font color="#000080">;                </font><font color="#008000"><i>{ initialize LPTx wires and port registers }
</i></font><font color="#FF0000"><b>procedure </b></font>Eral<font color="#000080">;                            </font><font color="#008000"><i>{ reset all registers in the chip }
</i></font><font color="#FF0000"><b>procedure </b></font>Wral<font color="#000080">(</font>EEfill <font color="#000080">:</font>word<font color="#000080">);             </font><font color="#008000"><i>{ write all reg. with EEfill value }
</i></font><font color="#FF0000"><b>procedure </b></font>EraseLoc<font color="#000080">(</font>Erase_Loc <font color="#000080">:</font>byte<font color="#000080">);                      </font><font color="#008000"><i>{ reset a register }
</i></font><font color="#FF0000"><b>procedure </b></font>EEwrite<font color="#000080">(</font>WrLoc <font color="#000080">:</font>byte<font color="#000080">; </font>WrValue <font color="#000080">:</font>word<font color="#000080">);         </font><font color="#008000"><i>{ write in a register }
</i></font><font color="#FF0000"><b>function </b></font>EEvalue<font color="#000080">(</font>Loc <font color="#000080">:</font>byte<font color="#000080">) :</font>word<font color="#000080">;               </font><font color="#008000"><i>{ return a register's value }


{ Notice: Eral procedure sets all registers at $FFFF;  EraseLoc sets
          selected location to $FFFF. }


</i></font><font color="#FF0000"><b>implementation


uses
  </b></font>crt<font color="#000080">, </font>FastWait<font color="#000080">; </font><font color="#008000"><i>{ also available in SWAG  -- TIMING.SWG}

</i></font><font color="#FF0000"><b>var
  </b></font>Weight     <font color="#000080">:</font>word<font color="#000080">;
  </font>s          <font color="#000080">:</font>byte<font color="#000080">;
  </font>PStatus    <font color="#000080">:</font>word<font color="#000080">;
  </font>PControl   <font color="#000080">:</font>word<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>CK<font color="#000080">;

</font><font color="#008000"><i>{ Generate a clock pulse in the CK wire }
{ Produce un impulso di clock sul filo CK }

</i></font><font color="#FF0000"><b>begin
  </b></font>Wait<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);                                </font><font color="#008000"><i>{ ritardo dopo il dato (2 mS) }
  </i></font>port<font color="#000080">[</font>PData<font color="#000080">] := </font>port<font color="#000080">[</font>PData<font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#800000">1</font><font color="#000080">;        </font><font color="#008000"><i>{ CK = 1 }
  </i></font>Wait<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);                                </font><font color="#008000"><i>{ tempo di CK alto (4 mS) }
  </i></font>port<font color="#000080">[</font>PData<font color="#000080">] := </font>port<font color="#000080">[</font>PData<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">254</font><font color="#000080">;     </font><font color="#008000"><i>{ CK = 0 }
  </i></font>Wait<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);                                </font><font color="#008000"><i>{ tempo di CK basso (6 mS) }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>CSon<font color="#000080">;

</font><font color="#008000"><i>{ Abilita il chip (Chip Select on) *e lo lascia abilitato* }
{ Enable the chip (Chip Select on) *and it remain still enabled* }

</i></font><font color="#FF0000"><b>begin
  </b></font>Wait<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);                                </font><font color="#008000"><i>{ ritardo dal precedente CSon }
  </i></font>port<font color="#000080">[</font>PControl<font color="#000080">] := </font>port<font color="#000080">[</font>PControl<font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#800000">4</font><font color="#000080">;  </font><font color="#008000"><i>{ CS = 1 }
  </i></font>CK<font color="#000080">;                                     </font><font color="#008000"><i>{ un CK a vuoto (necessario) }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>CSoff<font color="#000080">;

</font><font color="#008000"><i>{ Disabilita il chip (Chip Select off) *e lo lascia disabilitato* }
{ Disable the chip (Chip Select off) *and it remain still disabled* }

</i></font><font color="#FF0000"><b>begin
</b></font>	port<font color="#000080">[</font>PControl<font color="#000080">] := </font>port<font color="#000080">[</font>PControl<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">251</font><font color="#000080">;  </font><font color="#008000"><i>{ CS = 0 }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>DI1<font color="#000080">;

</font><font color="#008000"><i>{ Attiva il filo DI (Data Input) del chip }
{ Brought DI wire (Data Input) high }

</i></font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font>PControl<font color="#000080">] := </font>port<font color="#000080">[</font>PControl<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">30</font><font color="#000080">;   </font><font color="#008000"><i>{ DI = 1 }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>DI0<font color="#000080">;

</font><font color="#008000"><i>{ Disattiva il filo DI (Data Input) del chip }
{ Brought DI wire (Data Input) low }

</i></font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font>PControl<font color="#000080">] := </font>port<font color="#000080">[</font>PControl<font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#800000">1</font><font color="#000080">;     </font><font color="#008000"><i>{ DI = 0 }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LptInit<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>PStatus <font color="#000080">:= </font>PData <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>PControl <font color="#000080">:= </font>PData <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
  </font>CSoff<font color="#000080">;                         </font><font color="#008000"><i>{ evita confusioni }
  </i></font>DI0<font color="#000080">;                           </font><font color="#008000"><i>{ evita confusioni }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>EEcmd<font color="#000080">(</font>EEcode <font color="#000080">:</font>word<font color="#000080">;</font>EEloc <font color="#000080">:</font>byte<font color="#000080">);

</font><font color="#008000"><i>{ Invia il codice operativo al chip }
{ Send operating code to the chip }

</i></font><font color="#FF0000"><b>begin
  </b></font>CSon<font color="#000080">;
  </font>EEcode <font color="#000080">:= </font>EEcode <font color="#000080">+ </font>EEloc<font color="#000080">;     </font><font color="#008000"><i>{ Codice operativo = Operazione + Locazione }
  </i></font><font color="#FF0000"><b>for </b></font>s<font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin                         </b></font><font color="#008000"><i>{ invia stringa di bit seriali sul filo DI }
    </i></font>Weight <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>shl</b></font><font color="#000080">(</font>s<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>EEcode <font color="#000080">&lt; </font>Weight <font color="#FF0000"><b>then
    begin
      </b></font>DI0<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>EEcode <font color="#000080">:= </font>EEcode <font color="#000080">- </font>Weight<font color="#000080">;
      </font>DI1<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Ewen<font color="#000080">;

</font><font color="#008000"><i>{ Ordine di abilitazione alla scrittura/cancellazione al chip }
{ Enable command for writing/erasing operations to the chip }

</i></font><font color="#FF0000"><b>const
  </b></font>EwenCode     <font color="#000080">= </font><font color="#800000">304</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>EEcmd<font color="#000080">(</font>EwenCode<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);            </font><font color="#008000"><i>{ il campo EELoc deve essere = 0 }
  </i></font>DI0<font color="#000080">;                          </font><font color="#008000"><i>{ ripristina DI = 0 (evita confusioni) }
  </i></font>CSoff<font color="#000080">;                        </font><font color="#008000"><i>{ disabilita il chip dopo il comando }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Ewds<font color="#000080">;

</font><font color="#008000"><i>{ Ordine di disabilitazione alla scrittura/cancellazione al chip }
{ Disable command for writing/erasing operations to the chip }

</i></font><font color="#FF0000"><b>const
  </b></font>EwdsCode     <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>EEcmd<font color="#000080">(</font>EwdsCode<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);            </font><font color="#008000"><i>{ il campo EELoc deve essere = 0 }
  </i></font>CSoff<font color="#000080">;                        </font><font color="#008000"><i>{ disabilita il chip dopo il comando }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>Eral<font color="#000080">;

</font><font color="#008000"><i>{ Ordine di cancellazione totale al chip. Tutte le loc diventeranno $FFFF }
{ Erase all command to the chip. All locations become $FFFF }

</i></font><font color="#FF0000"><b>const
  </b></font>EralCode     <font color="#000080">= </font><font color="#800000">288</font><font color="#000080">;

</font><font color="#FF0000"><b>begin

  </b></font>Ewen<font color="#000080">;                         </font><font color="#008000"><i>{ abilita il chip alla cancellazione totale }

  </i></font>EEcmd<font color="#000080">(</font>EralCode<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);            </font><font color="#008000"><i>{ il campo EELoc deve essere = 0 }
  </i></font>CSoff<font color="#000080">;                        </font><font color="#008000"><i>{ disabilita il chip dopo il comando }

  </i></font>Ewds<font color="#000080">;                         </font><font color="#008000"><i>{ disab. il chip alla cancellazione totale }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>Wral<font color="#000080">(</font>EEfill <font color="#000080">:</font>word<font color="#000080">);

</font><font color="#008000"><i>{ Ordine di riempimento delle loc del chip con un valore 'EEfill' }
{ Fill all locations with 'EEfill' value }

</i></font><font color="#FF0000"><b>const
  </b></font>WralCode     <font color="#000080">= </font><font color="#800000">272</font><font color="#000080">;

</font><font color="#FF0000"><b>begin

  </b></font>Eral<font color="#000080">;                         </font><font color="#008000"><i>{ &quot;ERAL&quot; necessario per affidabilita' }

  </i></font>Ewen<font color="#000080">;                         </font><font color="#008000"><i>{ abilita il chip alla scrittura }

  </i></font>EEcmd<font color="#000080">(</font>WralCode<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);            </font><font color="#008000"><i>{ comando &quot;WRAL&quot; }
  </i></font><font color="#FF0000"><b>for </b></font>s<font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin                         </b></font><font color="#008000"><i>{ invia stringa di bit seriali }
    </i></font>Weight <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>shl</b></font><font color="#000080">(</font>s<font color="#000080">);         </font><font color="#008000"><i>{ per specificare il dato di }
    </i></font><font color="#FF0000"><b>if </b></font>EEfill <font color="#000080">&lt; </font>Weight <font color="#FF0000"><b>then     </b></font><font color="#008000"><i>{ riempimento }
    </i></font><font color="#FF0000"><b>begin
      </b></font>DI0<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>EEfill <font color="#000080">:= </font>EEfill <font color="#000080">- </font>Weight<font color="#000080">;
      </font>DI1<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>DI0<font color="#000080">;                          </font><font color="#008000"><i>{ ripristina DI = 0 (evita confusioni) }
  </i></font>CSoff<font color="#000080">;                        </font><font color="#008000"><i>{ Disabilita il chip }

  </i></font>Ewds<font color="#000080">;                         </font><font color="#008000"><i>{ disab. il chip alla scrittura }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>EraseLoc<font color="#000080">(</font>Erase_Loc <font color="#000080">:</font>byte<font color="#000080">);

</font><font color="#008000"><i>{ Ordine di resettare una locazione; il suo valore diventera' $FFFF }
{ Reset command for a single location; it become $FFFF }

</i></font><font color="#FF0000"><b>const
  </b></font>EraseCode <font color="#000080">= </font><font color="#800000">448</font><font color="#000080">;

</font><font color="#FF0000"><b>begin

  </b></font>Ewen<font color="#000080">;                         </font><font color="#008000"><i>{ abilita il chip alla cancellazione }

  </i></font>EEcmd<font color="#000080">(</font>EraseCode<font color="#000080">,</font>Erase_Loc<font color="#000080">);   </font><font color="#008000"><i>{ il campo Erase_Loc deve avere il }
  </i></font>DI0<font color="#000080">;                          </font><font color="#008000"><i>{ ripristina DI = 0 (evita confusioni) }
  </i></font>CSoff<font color="#000080">;                        </font><font color="#008000"><i>{ numero della locazione da resettare }

  </i></font>Ewds<font color="#000080">;                         </font><font color="#008000"><i>{ disab. il chip alla cancellazione  }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>EEwrite<font color="#000080">(</font>WrLoc <font color="#000080">:</font>byte<font color="#000080">; </font>WrValue <font color="#000080">:</font>word<font color="#000080">);

</font><font color="#008000"><i>{ Ordine di scrivere un dato 'WrValue' alla loc 'WrLoc' }
{ Writing command; it will write a 'WrValue' in a 'WrLoc' location }

</i></font><font color="#FF0000"><b>const
  </b></font>WrCode  <font color="#000080">= </font><font color="#800000">320</font><font color="#000080">;

</font><font color="#FF0000"><b>begin

  </b></font>Ewen<font color="#000080">;                            </font><font color="#008000"><i>{ abilita il chip alla scrittura }

  </i></font>EEcmd<font color="#000080">(</font>WrCode<font color="#000080">,</font>WrLoc<font color="#000080">);             </font><font color="#008000"><i>{ comando di scrittura alla loc WrLoc }
  </i></font><font color="#FF0000"><b>for </b></font>s<font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin                            </b></font><font color="#008000"><i>{ invia stringa di bit seriali sul DI }
    </i></font>Weight <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>shl</b></font><font color="#000080">(</font>s<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>WrValue <font color="#000080">&lt; </font>Weight <font color="#FF0000"><b>then
    begin
      </b></font>DI0<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>WrValue <font color="#000080">:= </font>WrValue <font color="#000080">- </font>Weight<font color="#000080">;
      </font>DI1<font color="#000080">; </font>CK<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>DI0<font color="#000080">;                             </font><font color="#008000"><i>{ ripristina DI = 0 (evita confusioni) }
  </i></font>CSoff<font color="#000080">;                           </font><font color="#008000"><i>{ disabilita il chip }

  </i></font>Ewds<font color="#000080">;                            </font><font color="#008000"><i>{ disabilita il chip alla scrittura }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>EEvalue<font color="#000080">(</font>Loc <font color="#000080">:</font>byte<font color="#000080">) :</font>word<font color="#000080">;

</font><font color="#008000"><i>{ Ritorna il valore letto nella 'Loc' }
{ It return a Loc's value }

</i></font><font color="#FF0000"><b>const
  </b></font>ReadCode      <font color="#000080">= </font><font color="#800000">384</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Value         <font color="#000080">:</font>byte<font color="#000080">;
  </font>EEval         <font color="#000080">:</font>word<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>EEvalue <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>EEval   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>EEcmd<font color="#000080">(</font>ReadCode<font color="#000080">,</font>Loc<font color="#000080">);             </font><font color="#008000"><i>{ comando di lettura alla 'Loc' }
  </i></font><font color="#FF0000"><b>for </b></font>s <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do
  begin
    </b></font>CK<font color="#000080">;                            </font><font color="#008000"><i>{ invia impulso di clock }
    </i></font>wait<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
    </font>Value <font color="#000080">:= </font>port<font color="#000080">[</font>PStatus<font color="#000080">];        </font><font color="#008000"><i>{ legge sul filo DO il livello logico }

    </i></font><font color="#FF0000"><b>if </b></font>Value <font color="#000080">&lt; </font><font color="#800000">128 </font><font color="#FF0000"><b>then </b></font>EEval <font color="#000080">:=  </font>EEval <font color="#000080">+ (</font><font color="#800000">1 </font><font color="#FF0000"><b>shl</b></font><font color="#000080">(</font><font color="#800000">15 </font><font color="#000080">- </font>s<font color="#000080">));

    </font><font color="#008000"><i>{ poiche' quando il filo &quot;S7&quot; della porta e' a &quot;1&quot; il peso 7 del byte }
    { di stato e' a &quot;0&quot; potremmo dire di avere un &quot;1&quot; quando Value &lt; 128. }
    { Se ad ogni ciclo incrementiamo o decrementiamo i pesi di EEval a }
    { seconda del valore di DO, ci ritroveremo col dato della locazione. }

  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>DI0<font color="#000080">;                             </font><font color="#008000"><i>{ ripristina DI = 0 (evita confusioni) }
  </i></font>CSoff<font color="#000080">;                           </font><font color="#008000"><i>{ disabilita il chip }
  </i></font>EEvalue <font color="#000080">:= </font>EEval<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>End</b></font><font color="#000080">.


</font><font color="#008000"><i>{ There are some examples }

{

program EEpromTest;

uses EEprom;

var
  j  :byte;
  h  :word;

begin
  PData := $378;                 { You must specify the parallel port in use }
  </i></font>LptInit<font color="#000080">;                       </font><font color="#008000"><i>{ initialize LPTx wires and port regs }
  </i></font>writeln<font color="#000080">(</font><font color="#800000">'Reading test on EEPROM 9306'</font><font color="#000080">);
  </font>writeln<font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do            </b></font><font color="#008000"><i>{ this &quot;for&quot;cicle put on &quot;h&quot; }
  </i></font><font color="#FF0000"><b>begin                          </b></font><font color="#008000"><i>{ the &quot;j&quot; location           }
    </i></font>h <font color="#000080">:= </font>EEvalue<font color="#000080">(</font>j<font color="#000080">);             </font><font color="#008000"><i>{ of the EEPROM chip         }
    </i></font>write <font color="#000080">(</font>h<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);               </font><font color="#008000"><i>{                            }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>readln<font color="#000080">;

  </font>Eral<font color="#000080">;                          </font><font color="#008000"><i>{ this procedure sets all regs }
                                 { in the EEPROM chip = 65535   }
  </i></font>readln<font color="#000080">;
  </font>h <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;

  </font>Wral<font color="#000080">(</font>h<font color="#000080">);                       </font><font color="#008000"><i>{ this procedure sets all regs }
                                 { in the EEPROM chip = &quot;h&quot;     }
  </i></font>readln<font color="#000080">;
  </font>j <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;

  </font>EraseLoc<font color="#000080">(</font>j<font color="#000080">);                   </font><font color="#008000"><i>{ this procedure sets the &quot;j&quot;  }
                                 { reg in the EEPROM = 65535    }
  </i></font>readln<font color="#000080">;
  </font>j <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
  </font>h <font color="#000080">:= </font><font color="#800000">1500</font><font color="#000080">;
  </font>EEwrite<font color="#000080">(</font>j<font color="#000080">,</font>h<font color="#000080">);                  </font><font color="#008000"><i>{ this procedure sets the reg  }
                                 { &quot;j&quot; = &quot;h&quot; in the EEPROM      }
                                 { Notice : in certain cases it }
                                 { is necessary to perform an   }
                                 { EaseLoc(j) before of EEwrite(j,.... }


</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.                             
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p></body>
</html>
