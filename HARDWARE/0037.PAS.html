<html>
<head><title> "Math Co-Processor Speed" by COLIN NICHOLSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is a program I wrote to see how good my new 387sx co-processor was. It
uses the standard REAL type.
}
</i></font><font color="#FF0000"><b>program </b></font>Math_Speed_Test<font color="#000080">;
</font><font color="#008000"><i>{$N-,E-,R-,S-}

</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>longint<font color="#000080">;
    </font>num1<font color="#000080">, </font>num2<font color="#000080">, </font>num3 <font color="#000080">: </font>real<font color="#000080">; </font><font color="#008000"><i>{ or double }
    </i></font>output <font color="#000080">: </font>text<font color="#000080">;
    </font>hou<font color="#000080">,</font>minu<font color="#000080">,</font>seco<font color="#000080">,</font>s100 <font color="#000080">: </font>word<font color="#000080">;
    </font>StartClock<font color="#000080">,
    </font>StopClock <font color="#000080">: </font>Real<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClockOn<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>GetTime<font color="#000080">(</font>hou<font color="#000080">,</font>minu<font color="#000080">,</font>seco<font color="#000080">,</font>s100<font color="#000080">);
     </font>StartClock<font color="#000080">:=( </font>hou <font color="#000080">* </font><font color="#800000">3600 </font><font color="#000080">) + ( </font>minu <font color="#000080">* </font><font color="#800000">60 </font><font color="#000080">) + </font>seco <font color="#000080">+ ( </font>s100 <font color="#000080">/ </font><font color="#800000">100 </font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClockOff<font color="#000080">;


</font><font color="#FF0000"><b>Begin
     </b></font>GetTime<font color="#000080">(</font>hou<font color="#000080">,</font>minu<font color="#000080">,</font>seco<font color="#000080">,</font>s100<font color="#000080">);
     </font>StopClock<font color="#000080">:=( </font>hou <font color="#000080">* </font><font color="#800000">3600 </font><font color="#000080">) + ( </font>minu <font color="#000080">* </font><font color="#800000">60 </font><font color="#000080">) + </font>seco <font color="#000080">+ ( </font>s100 <font color="#000080">/ </font><font color="#800000">100 </font><font color="#000080">);
     </font>WriteLn<font color="#000080">(</font>output<font color="#000080">,</font><font color="#800000">'Elapsed Time = '</font><font color="#000080">,(</font>StopClock<font color="#000080">-</font>StartClock<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'s'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
     </b></font>assign<font color="#000080">(</font>output<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
     </font>rewrite<font color="#000080">(</font>output<font color="#000080">);
     </font>clockon<font color="#000080">;
</font><font color="#008000"><i>{$IFOPT N+}
     </i></font>writeln<font color="#000080">(</font>output<font color="#000080">,</font><font color="#800000">'Using 8087 Code'</font><font color="#000080">);
</font><font color="#008000"><i>{$ELSE}
     </i></font>writeln<font color="#000080">(</font>output<font color="#000080">,</font><font color="#800000">'Using Software floating point routines'</font><font color="#000080">);
</font><font color="#008000"><i>{$ENDIF}
     </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">100000 </font><font color="#FF0000"><b>do
     begin

     </b></font>num1<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">60000</font><font color="#000080">)/</font><font color="#800000">100</font><font color="#000080">;
     </font><font color="#FF0000"><b>repeat
     </b></font>num2<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">60000</font><font color="#000080">)/</font><font color="#800000">100</font><font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>num2<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">;
     </font>num3<font color="#000080">:=</font>num1<font color="#000080">/</font>num2<font color="#000080">;

     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>clockoff<font color="#000080">;
     </font>close<font color="#000080">(</font>output<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>And </b></font>the results<font color="#000080">.....

</font>Using Software floating point routines
Elapsed Time <font color="#000080">= </font><font color="#800000">31.03</font>s

Using <font color="#800000">8087 </font>Code
Elapsed Time <font color="#000080">= </font><font color="#800000">8.78</font>s

However<font color="#000080">, </font>changing REAL <font color="#FF0000"><b>to </b></font>DOUBLE gives

Using <font color="#800000">8087 </font>Code
Elapsed Time <font color="#000080">= </font><font color="#800000">5.50</font>s

I don<font color="#800000">'t want to remove my co-processor, so I can'</font>t get the results <font color="#FF0000"><b>for
</b></font>using the emulation <font color="#FF0000"><b>library </b></font><font color="#000080">:-). </font>You could compile the <font color="#FF0000"><b>program and try </b></font>it
<font color="#FF0000"><b>for </b></font>yourself<font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to HARDWARE SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p></body>
</html>
