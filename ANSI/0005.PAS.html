<html>
<head><title> "ANSI Output" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Now that I need to make a .ANS bulletin Type File, I was wondering
&gt; how to Write from a Pascal Program, ANSI control Characters to a
&gt; File and produce nice color bulletin screen to be displayed by RA.

The following Unit will enable you to Write Ansi sequences to a Text
File Without having to look them up yourself. It enables you to do this
using the (easier) Crt Unit style of commands, and provides the optimum
Ansi sequence to do the job.
}

</i></font><font color="#FF0000"><b>Unit </b></font>AnsiOut<font color="#000080">;
</font><font color="#008000"><i>{1. Contains reduced set of Procedures from AnsiCrt Unit by I.Hinson.}
{2. Modified to provide output to a Text File.}

</i></font><font color="#FF0000"><b>Interface

Const </b></font>Black <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;     </font>Blue <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;          </font>Green <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;       </font>Cyan <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
      </font>Red <font color="#000080">=   </font><font color="#800000">4</font><font color="#000080">;     </font>Magenta <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;       </font>Brown <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;       </font>LightGray <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
      </font>DarkGray <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;  </font>LightBlue <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;     </font>LightGreen <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">; </font>LightCyan <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
      </font>LightRed <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">; </font>LightMagenta <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">; </font>Yellow <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;     </font>White <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;
      </font>Blink <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>AnsiFile<font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TextColor<font color="#000080">(</font>fore <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>TextBackGround<font color="#000080">(</font>back <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LowVideo<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HighVideo<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClrEol<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClrScr<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Const </b></font>forestr<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Black<font color="#000080">..</font>LightGray<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]
               = (</font><font color="#800000">'30'</font><font color="#000080">,</font><font color="#800000">'34'</font><font color="#000080">,</font><font color="#800000">'32'</font><font color="#000080">,</font><font color="#800000">'36'</font><font color="#000080">,</font><font color="#800000">'31'</font><font color="#000080">,</font><font color="#800000">'35'</font><font color="#000080">,</font><font color="#800000">'33'</font><font color="#000080">,</font><font color="#800000">'37'</font><font color="#000080">);
      </font>backstr<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Black<font color="#000080">..</font>LightGray<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]
               = (</font><font color="#800000">'40'</font><font color="#000080">,</font><font color="#800000">'44'</font><font color="#000080">,</font><font color="#800000">'42'</font><font color="#000080">,</font><font color="#800000">'46'</font><font color="#000080">,</font><font color="#800000">'41'</font><font color="#000080">,</font><font color="#800000">'45'</font><font color="#000080">,</font><font color="#800000">'43'</font><font color="#000080">,</font><font color="#800000">'47'</font><font color="#000080">);
      </font>decisiontree<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Boolean<font color="#000080">, </font>Boolean<font color="#000080">, </font>Boolean<font color="#000080">, </font>Boolean<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">=
      ((((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)),((</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">))),(((</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)),((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">))));

</font><font color="#FF0000"><b>Var </b></font>forecolour<font color="#000080">, </font>backcolour<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ stores last colours set }
    </i></font>boldstate<font color="#000080">, </font>blinkstate<font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TextColor<font color="#000080">(</font>fore <font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>blinknow<font color="#000080">, </font>boldnow<font color="#000080">: </font>Boolean<font color="#000080">;
    </font>outstr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>blinknow <font color="#000080">:= (</font>fore <font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$80</font><font color="#000080">;
    </font>boldnow <font color="#000080">:= (</font>fore <font color="#FF0000"><b>and </b></font><font color="#800000">$08</font><font color="#000080">) = </font><font color="#800000">$08</font><font color="#000080">;
    </font>fore <font color="#000080">:= </font>fore <font color="#FF0000"><b>and </b></font><font color="#800000">$07</font><font color="#000080">;  </font><font color="#008000"><i>{ mask out intensity and blink attributes }
    </i></font>forecolour <font color="#000080">:= </font>fore<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>decisiontree<font color="#000080">[</font>blinknow<font color="#000080">, </font>blinkstate<font color="#000080">, </font>boldnow<font color="#000080">, </font>boldstate<font color="#000080">] </font><font color="#FF0000"><b>OF
    </b></font><font color="#800000">0</font><font color="#000080">: </font>outstr <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">1</font><font color="#000080">: </font>outstr <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[0;'</font><font color="#000080">,</font>backstr<font color="#000080">[</font>backcolour<font color="#000080">],</font><font color="#800000">';'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">2</font><font color="#000080">: </font>outstr <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[1;'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">3</font><font color="#000080">: </font>outstr <font color="#000080">:=
         </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[0;1;'</font><font color="#000080">,</font>backstr<font color="#000080">[</font>backcolour<font color="#000080">],</font><font color="#800000">';'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">4</font><font color="#000080">: </font>outstr <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[5;'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">5</font><font color="#000080">: </font>outstr <font color="#000080">:=
         </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[0;5;'</font><font color="#000080">,</font>backstr<font color="#000080">[</font>backcolour<font color="#000080">],</font><font color="#800000">';'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#800000">6</font><font color="#000080">: </font>outstr <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[1;5;'</font><font color="#000080">,</font>forestr<font color="#000080">[</font>fore<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case }
    </i></font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font>outstr<font color="#000080">);
    </font>blinkstate <font color="#000080">:= </font>blinknow<font color="#000080">;
    </font>boldstate <font color="#000080">:= </font>boldnow<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TextBackGround<font color="#000080">(</font>back<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>Var </b></font>outString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>Back <font color="#000080">&gt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">; </font><font color="#008000"><i>{ No such thing as bright or blinking backgrounds }
    </i></font>BackColour <font color="#000080">:= </font>Back<font color="#000080">;
    </font>outString <font color="#000080">:= </font>Concat<font color="#000080">(</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">,</font>backstr<font color="#000080">[</font>back<font color="#000080">],</font><font color="#800000">'m'</font><font color="#000080">);
    </font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font>outString<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NormVideo<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">#27'[0m'</font><font color="#000080">);
    </font>forecolour <font color="#000080">:= </font>LightGray<font color="#000080">;
    </font>backcolour <font color="#000080">:= </font>Black<font color="#000080">;
    </font>boldstate <font color="#000080">:= </font>False<font color="#000080">;
    </font>blinkstate <font color="#000080">:= </font>False
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LowVideo<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>blinkstate <font color="#FF0000"><b>then </b></font>forecolour <font color="#000080">:= </font>forecolour <font color="#FF0000"><b>or </b></font><font color="#800000">$80</font><font color="#000080">;  </font><font color="#008000"><i>{ retain blinking }
    </i></font>TextColor<font color="#000080">(</font>forecolour<font color="#000080">);   </font><font color="#008000"><i>{ stored forecolour never contains bold attr }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HighVideo<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if not </b></font>boldstate <font color="#FF0000"><b>then
    begin
      </b></font>boldstate <font color="#000080">:= </font>True<font color="#000080">;
      </font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'[1m'</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClrEol<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">#27'[K'</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">#27'[2J'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>forecolour <font color="#000080">:= </font>LightGray<font color="#000080">;
  </font>backcolour <font color="#000080">:= </font>Black<font color="#000080">;
  </font>boldstate <font color="#000080">:= </font>False<font color="#000080">;
  </font>blinkstate <font color="#000080">:= </font>False
<font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>___<font color="#000080">------------------------------------------------------------------
</font><font color="#FF0000"><b>Program </b></font>Demo<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>AnsiOut<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">'CON'</font><font color="#000080">);   </font><font color="#008000"><i>{ or a File - e.g. 'MYSCREEN.ANS' }
  </i></font>ReWrite<font color="#000080">(</font>AnsiFile<font color="#000080">);
  </font>ClrScr<font color="#000080">;
  </font>TextColor<font color="#000080">(</font>Blue<font color="#000080">); </font>TextBackGround<font color="#000080">(</font>LightGray<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">' Blue Text on LightGray '</font><font color="#000080">);
  </font>HighVideo<font color="#000080">; </font>Write<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">' Now the Text is LightBlue '</font><font color="#000080">);
  </font>TextBackground<font color="#000080">(</font>Red<font color="#000080">); </font>Writeln<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">' on a Red background'</font><font color="#000080">);
  </font>TextColor<font color="#000080">(</font>Black<font color="#000080">+</font>Blink<font color="#000080">); </font>TextBackground<font color="#000080">(</font>Cyan<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>AnsiFile<font color="#000080">,</font><font color="#800000">' Blinking Black '</font><font color="#000080">);
  </font>TextBackGround<font color="#000080">(</font>Green<font color="#000080">); </font>ClrEol<font color="#000080">;         </font><font color="#008000"><i>{ a blank Green line }
</i></font><font color="#000080">(</font><font color="#800000">53 </font>min left<font color="#000080">), (</font>H<font color="#000080">)</font>elp<font color="#000080">, </font>More<font color="#000080">?   </font>Writeln<font color="#000080">(</font>AnsiFile<font color="#000080">);
  </font>NormVideo<font color="#000080">;
  </font>Close<font color="#000080">(</font>AnsiFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
