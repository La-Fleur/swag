<html>
<head><title> "Use LVI Color on BBS" by TOBIN FRICKE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
*****************************************************************************

				  COLOR.PAS

 By Tobin Fricke

 This should solve everyone's problems with Ascii, ANSI, WWIV, Avatar, LVI,
 Pipe, Direct, and RIP.


*****************************************************************************
}
{$IFDEF DEBUG}
{$D+,L+}
{$ENDIF}

</i></font><font color="#FF0000"><b>Unit </b></font>Color<font color="#000080">;

</font><font color="#008000"><i>{$S-}

(* BBS Color Unit by Tobin Fricke                                          *)
(* TobinTech Software Research and Development                             *)
(* Copyright (c) 1994 Tobin Fricke, All Rights Reserved                    *)

(* This is a unit to allow the use of color on bbs systems.  It will send  *)
(* the color codes to the screen using BIOS.  These can easily be trapped  *)
(* and sent to the modem by most BBS systems.                              *)


(* -=- If you use this in any of your programs, you must give credit to the
       author of this toolkit, Tobin Fricke.  You must register this and 
       receive permission to use it in any commercial product or shareware
       product.  It may be used without consent from the author (as long as
       credit is given) in any &quot;freeware&quot; or &quot;public domain&quot; programs. This
       may not be bought or sold, and contains no warrantee.  Use it at your
       own risk.  Please send the author a copy of anything you create using
       this toolkit.  Thanks.  For information on registration, contact the
       author. *)

(* -=- Reaching The Author                                                 
     
       Internet:        dr261@cleveland.freenet.edu


       Postal:          25271 Arion Way, Mission Viejo, Ca, 92691-3702

	
       Phone:           (714) 586-4906

       
       BBS:             (714) 586-6142 The Digital Forest Information system


       DFIN:            13:714/100

	*)
</i></font>	
	

<font color="#FF0000"><b>Interface

uses </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>ProcType<font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Const </b></font>NoColor<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;              </font><font color="#008000"><i>{ Ignores Color commands, no color         }
      </i></font>ASCIIColor<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Same as NoColor                          }
      </i></font>ANSIColor<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;            </font><font color="#008000"><i>{ Uses ANSI Escape Codes                   }
      </i></font>WWIVColor<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>{ Uses WWIV Heart  Codes                   }
      </i></font>AVATARColor<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;          </font><font color="#008000"><i>{ Uses AVATAR codes                        }
      </i></font>LVIColor<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;             </font><font color="#008000"><i>{ Uses LVI (Last Video Interface)  codes   }
      </i></font>DirectColor<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;
      </font>PipeSystemColor<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;      </font><font color="#008000"><i>{ The Renegade Pipe System for Color       }
      </i></font>RipColor<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">;

      </font>WWIVEscape<font color="#000080">:</font>Char<font color="#000080">=</font><font color="#800000">#3</font><font color="#000080">;     </font><font color="#008000"><i>{ These are escape codes for the different }
      </i></font>ANSIEscape<font color="#000080">:</font>Char<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">;    </font><font color="#008000"><i>{ modes.                                   }
      </i></font>AVATEscape<font color="#000080">:</font>Char<font color="#000080">=</font><font color="#800000">#22</font><font color="#000080">;

      </font>Black<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;                </font><font color="#008000"><i>{ These are color constants.               }
      </i></font>Blue<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
      </font>Green<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;
      </font>Cyan<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;
      </font>Red<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;
      </font>Magenta<font color="#000080">=</font><font color="#800000">5</font><font color="#000080">;
      </font>Brown<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">;
      </font>Gray<font color="#000080">=</font><font color="#800000">7</font><font color="#000080">;
      </font>Bright<font color="#000080">=</font><font color="#800000">8</font><font color="#000080">;

      </font>EmuNum<font color="#000080">=</font><font color="#800000">6</font><font color="#000080">;
      </font>EmuMenu<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>EmuNum<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">=
       (</font><font color="#800000">'ASCII '</font><font color="#000080">,
</font>	<font color="#800000">'ANSI  '</font><font color="#000080">,
</font>	<font color="#800000">'WWIV  '</font><font color="#000080">,
</font>	<font color="#800000">'AVATAR'</font><font color="#000080">,
</font>	<font color="#800000">'LVI   '</font><font color="#000080">,
</font>	<font color="#800000">'PIPE System'</font><font color="#000080">,
</font>	<font color="#800000">'RIPScrip'</font><font color="#000080">);
      </font>EmuComment<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>EmuNum<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">=
      (</font><font color="#800000">'No Color or Screen Control'</font><font color="#000080">,
       </font><font color="#800000">'ANSI Color and Screen Control'</font><font color="#000080">,
       </font><font color="#800000">'WWIV BBS Software &quot;Heart Codes&quot;'</font><font color="#000080">,
       </font><font color="#800000">'This isn''t used much anymore'</font><font color="#000080">,
       </font><font color="#800000">'The Last Video Interface, Faster than ANSI'</font><font color="#000080">,
       </font><font color="#800000">'Renegade Style Color Codes'</font><font color="#000080">,
       </font><font color="#800000">'Remote Imaging Protocol Script'</font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>WriteMode<font color="#000080">:</font>Byte<font color="#000080">;           </font><font color="#008000"><i>{ Prior to use, you must set WriteMode equal }
    </i></font>Output<font color="#000080">:</font>ProcType<font color="#000080">;          </font><font color="#008000"><i>{ to NoColor, ANSIcolor, AVATARColor, or LVI-}
</i></font>			      <font color="#008000"><i>{ color }

</i></font><font color="#FF0000"><b>Var </b></font>T<font color="#000080">:</font>Text<font color="#000080">;                   </font><font color="#008000"><i>{Assigned to StdOutput }


</i></font><font color="#FF0000"><b>Procedure Default</b></font><font color="#000080">;                  </font><font color="#008000"><i>{ Change colors to default (7 on 0) }
</i></font><font color="#FF0000"><b>Procedure </b></font>BackgroundColor<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);  </font><font color="#008000"><i>{ Set Background color to I         }
</i></font><font color="#FF0000"><b>Procedure </b></font>ForgroundColor<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);   </font><font color="#008000"><i>{ Set Foreground Color to I         }
</i></font><font color="#FF0000"><b>Procedure </b></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">);         </font><font color="#008000"><i>{ Go to specific location on screen }
</i></font><font color="#FF0000"><b>Procedure </b></font>CLRSCR<font color="#000080">;                   </font><font color="#008000"><i>{ Clear the screen                  }
</i></font><font color="#FF0000"><b>function </b></font>readkey<font color="#000080">:</font>char<font color="#000080">;              </font><font color="#008000"><i>{ Not Implemented Yet               }
</i></font><font color="#FF0000"><b>Procedure </b></font>D<font color="#000080">;                        </font><font color="#008000"><i>{ Same as Default;                  }
</i></font><font color="#FF0000"><b>Procedure </b></font>WWIVParse<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);      </font><font color="#008000"><i>{ See the end of this file...       }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetEmu<font color="#000080">;                   </font><font color="#008000"><i>{ See the end of this file...       }
</i></font><font color="#FF0000"><b>Procedure </b></font>FColor<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);           </font><font color="#008000"><i>{ Same as ForegroundColor           }
</i></font><font color="#FF0000"><b>Procedure </b></font>BColor<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);           </font><font color="#008000"><i>{ Same as BackgroundColor           }

</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>CRT<font color="#000080">;




</font><font color="#FF0000"><b>Procedure </b></font>DefOutput<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>StrinG</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>Write<font color="#000080">(</font>T<font color="#000080">,</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{function readkey:char;
var B:Byte;
begin
 ASM;
  Mov AH, 01h
  Int 21
  Mov [B], AL
 End;
 readkey:=chr(B);
end; }
</i></font><font color="#FF0000"><b>function </b></font>readkey<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>it<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>Regs<font color="#000080">:</font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>Regs<font color="#000080">.</font>AH<font color="#000080">:=</font><font color="#800000">$01</font><font color="#000080">;
</font>MSDOS<font color="#000080">(</font>Regs<font color="#000080">);
</font>STr<font color="#000080">(</font>Regs<font color="#000080">.</font>AL<font color="#000080">,</font>it<font color="#000080">);
</font>readkey<font color="#000080">:=</font>it<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PIPEBackground<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Case </b></font>B <font color="#FF0000"><b>Of
   </b></font><font color="#800000">0</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|16'</font><font color="#000080">;
   </font><font color="#800000">1</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|17'</font><font color="#000080">;
   </font><font color="#800000">2</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|18'</font><font color="#000080">;
   </font><font color="#800000">3</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|19'</font><font color="#000080">;
   </font><font color="#800000">4</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|20'</font><font color="#000080">;
   </font><font color="#800000">5</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|21'</font><font color="#000080">;
   </font><font color="#800000">6</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|22'</font><font color="#000080">;
   </font><font color="#800000">7</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|23'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Write<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PIPEForground<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Case </b></font>B <font color="#FF0000"><b>Of
   </b></font><font color="#800000">0</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|00'</font><font color="#000080">;
   </font><font color="#800000">1</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|01'</font><font color="#000080">;
   </font><font color="#800000">2</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|02'</font><font color="#000080">;
   </font><font color="#800000">3</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|03'</font><font color="#000080">;
   </font><font color="#800000">4</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|04'</font><font color="#000080">;
   </font><font color="#800000">5</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|05'</font><font color="#000080">;
   </font><font color="#800000">6</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|06'</font><font color="#000080">;
   </font><font color="#800000">7</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|07'</font><font color="#000080">;
   </font><font color="#800000">8</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|08'</font><font color="#000080">;
   </font><font color="#800000">9</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|09'</font><font color="#000080">;
  </font><font color="#800000">10</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|10'</font><font color="#000080">;
  </font><font color="#800000">11</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|11'</font><font color="#000080">;
  </font><font color="#800000">12</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|12'</font><font color="#000080">;
  </font><font color="#800000">13</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|13'</font><font color="#000080">;
  </font><font color="#800000">14</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|14'</font><font color="#000080">;
  </font><font color="#800000">15</font><font color="#000080">: </font>S<font color="#000080">:=</font><font color="#800000">'|15'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font>Write<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>AVATARGotoXy<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>Write<font color="#000080">(</font><font color="#800000">#22</font><font color="#000080">+</font><font color="#800000">#8</font><font color="#000080">+</font>Char<font color="#000080">(</font>X<font color="#000080">)+</font>Char<font color="#000080">(</font>Y<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AvatarForground<font color="#000080">(</font>A<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>Write<font color="#000080">(</font><font color="#800000">#22</font><font color="#000080">+</font><font color="#800000">#1</font><font color="#000080">+</font>Char<font color="#000080">(</font>A <font color="#FF0000"><b>and </b></font><font color="#800000">$7F</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AvatarClrScr<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Write<font color="#000080">(</font><font color="#800000">#12</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WWIVForground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>C<font color="#000080">:</font>Byte<font color="#000080">;
    </font>D<font color="#000080">:</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
 Repeat
  If </b></font>I<font color="#000080">&gt;</font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>I<font color="#000080">:=</font>I<font color="#000080">-</font><font color="#800000">8</font><font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font>I<font color="#000080">&lt;</font><font color="#800000">9</font><font color="#000080">;
 </font>C<font color="#000080">:=</font>I<font color="#000080">;
 </font><font color="#FF0000"><b>Case </b></font>I <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#800000">1</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#800000">2</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">5</font><font color="#000080">;
    </font><font color="#800000">3</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#800000">4</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">6</font><font color="#000080">;
    </font><font color="#800000">5</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
    </font><font color="#800000">6</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
    </font><font color="#800000">7</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
    </font><font color="#800000">8</font><font color="#000080">:</font>C<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Output<font color="#000080">(</font>WWIVEscape<font color="#000080">+</font>Char<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">+</font>C<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WWIVBackground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 If </b></font>I<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Output<font color="#000080">(</font>WWIVEscape<font color="#000080">+</font><font color="#800000">'4'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ANSIDefault<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Output<font color="#000080">(</font>ANSIEscape<font color="#000080">+</font><font color="#800000">'[0m'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ANSIForground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>z<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ANSIDefault;}
</i></font><font color="#FF0000"><b>case </b></font>I <font color="#FF0000"><b>of
     </b></font><font color="#800000">0</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;30'</font><font color="#000080">;
     </font><font color="#800000">1</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;34'</font><font color="#000080">;
     </font><font color="#800000">2</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;32'</font><font color="#000080">;
     </font><font color="#800000">3</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;36'</font><font color="#000080">;
     </font><font color="#800000">4</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;31'</font><font color="#000080">;
     </font><font color="#800000">5</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;35'</font><font color="#000080">;
     </font><font color="#800000">6</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;33'</font><font color="#000080">;
     </font><font color="#800000">7</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'0;37'</font><font color="#000080">;
     </font><font color="#800000">8</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;30'</font><font color="#000080">;
     </font><font color="#800000">9</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;34'</font><font color="#000080">;
     </font><font color="#800000">10</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;32'</font><font color="#000080">;
     </font><font color="#800000">11</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;36'</font><font color="#000080">;
     </font><font color="#800000">12</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;31'</font><font color="#000080">;
     </font><font color="#800000">13</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;35'</font><font color="#000080">;
     </font><font color="#800000">14</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;33'</font><font color="#000080">;
     </font><font color="#800000">15</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'1;37'</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>Output<font color="#000080">(</font>ANSIescape<font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>z<font color="#000080">+</font><font color="#800000">'m'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ANSIBackground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>z<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>ansistr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ ANSIDefault;}
 </i></font><font color="#FF0000"><b>case </b></font>I <font color="#FF0000"><b>of
      </b></font><font color="#800000">0</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'40'</font><font color="#000080">;
      </font><font color="#800000">1</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'44'</font><font color="#000080">;
      </font><font color="#800000">2</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'42'</font><font color="#000080">;
      </font><font color="#800000">3</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'46'</font><font color="#000080">;
      </font><font color="#800000">4</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'41'</font><font color="#000080">;
      </font><font color="#800000">5</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'45'</font><font color="#000080">;
      </font><font color="#800000">6</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'43'</font><font color="#000080">;
      </font><font color="#800000">7</font><font color="#000080">:</font>z<font color="#000080">:=</font><font color="#800000">'47'</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>ansistr<font color="#000080">:=</font>ANSIEscape<font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>z<font color="#000080">+</font><font color="#800000">'m'</font><font color="#000080">;
</font>Output<font color="#000080">(</font>ansistr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GotoXY<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>SX<font color="#000080">,</font>SY<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>Str<font color="#000080">(</font>X<font color="#000080">,</font>SX<font color="#000080">);
</font>Str<font color="#000080">(</font>Y<font color="#000080">,</font>SY<font color="#000080">);
</font>Output<font color="#000080">(</font>ANSIEscape<font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>SY<font color="#000080">+</font><font color="#800000">';'</font><font color="#000080">+</font>SX<font color="#000080">+</font><font color="#800000">'H'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>F<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LVIForground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>F<font color="#000080">:=</font>I<font color="#000080">;
 </font>Output<font color="#000080">(</font><font color="#800000">#29</font><font color="#000080">+</font>Char<font color="#000080">(</font>F<font color="#000080">+(</font>B<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LVIBackground<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>B<font color="#000080">:=</font>I<font color="#000080">;
 </font>Output<font color="#000080">(</font><font color="#800000">#29</font><font color="#000080">+</font>Char<font color="#000080">(</font>F<font color="#000080">+(</font>B<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Zero<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FColor<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>ForgroundColor<font color="#000080">(</font>B<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BColor<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
 </b></font>BackgroundColor<font color="#000080">(</font>B<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WWIVParse<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Zero<font color="#000080">(</font>I<font color="#000080">);
 </font><font color="#FF0000"><b>Repeat
  </b></font>Inc<font color="#000080">(</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>S<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>of
    </b></font><font color="#800000">#3</font><font color="#000080">:</font><font color="#FF0000"><b>Begin            </b></font><font color="#008000"><i>{ #3 =  }
</i></font>	Inc<font color="#000080">(</font>I<font color="#000080">);
</font>	<font color="#FF0000"><b>Case </b></font>S<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>of
</b></font>	   <font color="#800000">'0'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">0</font><font color="#000080">);  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'1'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'2'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'3'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">+</font><font color="#800000">0</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'4'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">0</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'5'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">0</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'6'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'7'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'8'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	   <font color="#800000">'9'</font><font color="#000080">:</font><font color="#FF0000"><b>Begin </b></font>BColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font>FColor<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">8</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	  <font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>	<font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Else </b></font>Output<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Until </b></font>I<font color="#000080">&gt;=</font>Length<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BackgroundColor<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 Case </b></font>WriteMode <font color="#FF0000"><b>of
   </b></font>ANSIColor<font color="#000080">:</font>ANSIBackground<font color="#000080">(</font>I<font color="#000080">);
   </font>RIPColor<font color="#000080">:</font>ANSIBackground<font color="#000080">(</font>I<font color="#000080">);
   </font>WWIVColor<font color="#000080">:</font>WWIVBackground<font color="#000080">(</font>I<font color="#000080">);
   </font>LVIColor<font color="#000080">:</font>LVIBackground<font color="#000080">(</font>I<font color="#000080">);
   </font>DirectColor<font color="#000080">:</font>CRT<font color="#000080">.</font>TextBackground<font color="#000080">(</font>I<font color="#000080">);
   </font>PipeSystemColor<font color="#000080">:</font>PipeBackground<font color="#000080">(</font>I<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ForgroundColor<font color="#000080">(</font>I<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 Case </b></font>WriteMode <font color="#FF0000"><b>of
   </b></font>ANSIColor<font color="#000080">:</font>ANSIForground<font color="#000080">(</font>I<font color="#000080">);
   </font>RIPColor<font color="#000080">:</font>ANSIForground<font color="#000080">(</font>I<font color="#000080">);
   </font>WWIVColor<font color="#000080">:</font>WWIVForground<font color="#000080">(</font>I<font color="#000080">);
   </font>AVATARColor<font color="#000080">:</font>AvatarForground<font color="#000080">(</font>I<font color="#000080">);
   </font>LVIColor<font color="#000080">:</font>LVIForground<font color="#000080">(</font>I<font color="#000080">);
   </font>DirectColor<font color="#000080">:</font>CRT<font color="#000080">.</font>TextColor<font color="#000080">(</font>I<font color="#000080">);
   </font>PipeSystemColor<font color="#000080">:</font>PipeForground<font color="#000080">(</font>I<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ANSIClrScr<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>Output<font color="#000080">(</font>ANSIEscape<font color="#000080">+</font><font color="#800000">'[2J'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WWIVClrScr<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do </b></font>Writeln<font color="#000080">(</font>T<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>begin
 Case </b></font>WriteMode <font color="#FF0000"><b>of
    </b></font>ANSIColor<font color="#000080">:</font>ANSIClrScr<font color="#000080">;
    </font>RIPColor<font color="#000080">:</font>ANSIClrScr<font color="#000080">;
    </font>WWIVColor<font color="#000080">:</font>WWIVClrScr<font color="#000080">;
    </font>AVATARColor<font color="#000080">:</font>AvatarClrScr<font color="#000080">;
    </font>LVIColor<font color="#000080">:</font>ANSIClrScr<font color="#000080">;
    </font>DirectColor<font color="#000080">:</font>CRT<font color="#000080">.</font>ClrScr<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure Default</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
 Case </b></font>Writemode <font color="#FF0000"><b>of
  </b></font>ANSIColor<font color="#000080">: </font>ANSIDefault<font color="#000080">;
  </font>RipColor<font color="#000080">:  </font>ANSIDefault<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>D<font color="#000080">;
</font><font color="#FF0000"><b>begin
 Default</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetEMu<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">,</font>E<font color="#000080">:</font>Integer<font color="#000080">;
    </font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>T<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
Repeat
 </b></font>Writeln<font color="#000080">(</font><font color="#800000">' Please choose a terminal type: '</font><font color="#000080">);
 </font>Writeln<font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Color<font color="#000080">.</font>EmuNum <font color="#FF0000"><b>do
     </b></font>Writeln<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">') '</font><font color="#000080">,</font>Color<font color="#000080">.</font>EmuMenu<font color="#000080">[</font>I<font color="#000080">],</font><font color="#800000">#9</font><font color="#000080">,</font>Color<font color="#000080">.</font>EmuComment<font color="#000080">[</font>I<font color="#000080">]);
 </font>Writeln<font color="#000080">;
 </font>Write<font color="#000080">(</font><font color="#800000">' TERM&gt;'</font><font color="#000080">);
 </font>Readln<font color="#000080">(</font>S<font color="#000080">);
 </font>Val<font color="#000080">(</font>S<font color="#000080">,</font>T<font color="#000080">,</font>E<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>E<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">' I can''t understand: '</font><font color="#000080">,</font>S<font color="#000080">);
    </font>Write<font color="#000080">(</font><font color="#800000">'                    '</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>E <font color="#FF0000"><b>do </b></font>Write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'^'</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>T<font color="#000080">&gt;</font>Color<font color="#000080">.</font>EmuNum<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>T<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>E<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">' You must enter a number from 0 to '</font><font color="#000080">,</font>EmuNum<font color="#000080">);
    </font>E<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Until </b></font>E<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
</font>Writeln<font color="#000080">;
</font>Writeln<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>EmuMenu<font color="#000080">[</font>T<font color="#000080">],</font><font color="#800000">' Emulation Selected '</font><font color="#000080">);
</font>WriteMode<font color="#000080">:=</font>T<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
 </b></font>Output<font color="#000080">:=</font>DefOutput<font color="#000080">;
 </font>Assign<font color="#000080">(</font>System<font color="#000080">.</font>Output<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
 </font>Assign<font color="#000080">(</font>System<font color="#000080">.</font>Input<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
 </font>Assign<font color="#000080">(</font>T<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
 </font>Rewrite<font color="#000080">(</font>T<font color="#000080">);
 </font>Rewrite<font color="#000080">(</font>System<font color="#000080">.</font>Output<font color="#000080">);
 </font>Reset<font color="#000080">(</font>Input<font color="#000080">);
 </font>DirectVideo<font color="#000080">:=</font>False<font color="#000080">;
 </font>WriteMode<font color="#000080">:=</font>ANSIColor<font color="#000080">;
 </font>F<font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
 </font>B<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>(*  Information...



      Set WriteMode to one of the following before calling any color commands.


      NoColor=0;              { Ignores Color commands, no color         }
      ASCIIColor=0;           { Same as NoColor                          }
      ANSIColor=1;            { Uses ANSI Escape Codes                   }
      WWIVColor=2;            { Uses WWIV Heart  Codes                   }
      AVATARColor=3;          { Uses AVATAR codes                        }
      LVIColor=4;             { Uses LVI (Last Video Interface)  codes   }
      DirectColor=7;          { Not implemented yet  }
      PipeSystemColor=5;      { The Renegade Pipe System for Color       }
      RipColor=6;


      For TTY emulation, see TTY.PAS
      For LVI emulation, see LVI.PAS


      Output(S:String) Is called to output the ANSI/WWIV/AVATAR/LVI/PIPE/RIP
      codes.  It defaults to StdOutput, and It may be redefined like so:


      Procedure COMOutput(S:String);
      begin
       { send S to COMPort }

      end;


      begin
       Color.Output:=ComOutput;
      end.


      WWIVParse(S:String) will take a string containing WWIV (ASCII 3) color
      codes, parse it, and output it (through procedure output) with the 
      correct coloring.


      GetEmu will display a menu and ask the user for an emulation.
*)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p></body>
</html>
