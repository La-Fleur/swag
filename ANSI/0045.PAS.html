<html>
<head><title> "ANSI file scroller" by JASON RANDALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 Well, this was NOT written by me, but the author is darn cool. I have a
 question for you.. I'm trying to make a *simple* SB16 DMA player, using those
 darned end-transfer interrupts. I am pretty good in TP, but all the info I've
 recieved about this has been too varied. People also like to use those crappy
 drivers. Any advice? Anyways, here's a program for ya..
                                -Jason Randall-
}

</i></font><font color="#FF0000"><b>USES </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;

</font><font color="#FF0000"><b>Label </b></font>Jm1<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>FF <font color="#000080">= </font><font color="#800000">#12</font><font color="#000080">;
  </font>ESC <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;

</font><font color="#FF0000"><b>type
    </b></font>rgbtype <font color="#000080">= </font><font color="#FF0000"><b>record
              </b></font>red<font color="#000080">,</font>green<font color="#000080">,</font>blue<font color="#000080">:</font>byte<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rgbarray<font color="#000080">=</font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>rgbtype<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>USERFILE<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>InFile <font color="#000080">:</font><font color="#FF0000"><b>File of </b></font>Char<font color="#000080">;
   </font>XX<font color="#000080">:</font>INTEGER<font color="#000080">;
   </font>rgbpal<font color="#000080">,</font>fadepal<font color="#000080">:</font>rgbarray<font color="#000080">;
   </font>ii<font color="#000080">:</font>word<font color="#000080">;
   </font>c<font color="#000080">:</font>char<font color="#000080">;
   </font>count<font color="#000080">: </font>Byte<font color="#000080">;
   </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">;
   </font>i <font color="#000080">, </font>FGcolor<font color="#000080">, </font>BGcolor<font color="#000080">, </font>CursorX<font color="#000080">, </font>CursorY <font color="#000080">: </font>INTEGER<font color="#000080">;
        </font>escape_mode<font color="#000080">, </font>lightcolor <font color="#000080">: </font>BOOLEAN<font color="#000080">;
        </font>escape_number <font color="#000080">: </font>BYTE<font color="#000080">;
        </font>escape_register <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
        </font>escape_str <font color="#000080">: </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font>AnsiFile <font color="#000080">: </font>TEXT<font color="#000080">;

</font><font color="#008000"><i>(* FADES ROUTINES *)

</i></font><font color="#FF0000"><b>procedure </b></font>setcolor<font color="#000080">(</font>col<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
     </b></font>port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>col<font color="#000080">;
     </font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>r<font color="#000080">;
     </font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>g<font color="#000080">;
     </font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>b<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>getcolor<font color="#000080">(</font>col<font color="#000080">:</font>byte<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
     </b></font>port<font color="#000080">[</font><font color="#800000">$3c7</font><font color="#000080">]:=</font>col<font color="#000080">;
     </font>r<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">];
     </font>g<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">];
     </font>b<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>fadein<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>fadepal <font color="#000080">: </font>rgbarray<font color="#000080">; </font>col1<font color="#000080">, </font>col2 <font color="#000080">,</font>dly<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>lcv<font color="#000080">,
   </font>lcv2 <font color="#000080">: </font>integer<font color="#000080">;
   </font>tpal <font color="#000080">: </font>rgbarray<font color="#000080">;
</font><font color="#FF0000"><b>begin
     for </b></font>lcv <font color="#000080">:= </font>col1 <font color="#FF0000"><b>to </b></font>col2 <font color="#FF0000"><b>do
     begin
          </b></font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>red   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>green <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>blue  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>lcv <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
     begin
          for </b></font>lcv2<font color="#000080">:=</font>col1 <font color="#FF0000"><b>to </b></font>col2 <font color="#FF0000"><b>do
          begin
               if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#FF0000"><b>then
                  </b></font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">:= </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#FF0000"><b>then
                  </b></font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">:= </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#FF0000"><b>then
                  </b></font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#000080">:= </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
               </font>setcolor<font color="#000080">(</font>lcv2<font color="#000080">, </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red<font color="#000080">, </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green<font color="#000080">,
</font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>delay<font color="#000080">(</font>dly<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>fadeout<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>fadepal <font color="#000080">: </font>rgbarray<font color="#000080">; </font>col1<font color="#000080">, </font>col2 <font color="#000080">,</font>dly<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>lcv<font color="#000080">,
   </font>lcv2 <font color="#000080">: </font>integer<font color="#000080">;
   </font>TPal <font color="#000080">: </font>rgbarray<font color="#000080">;
</font><font color="#FF0000"><b>begin
     for </b></font>lcv <font color="#000080">:= </font>col1 <font color="#FF0000"><b>to </b></font>col2 <font color="#FF0000"><b>do
     begin
          </b></font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>red   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>green <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>TPal<font color="#000080">[</font>lcv<font color="#000080">].</font>blue  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>lcv <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
     begin
          for </b></font>lcv2 <font color="#000080">:= </font>col1 <font color="#FF0000"><b>to </b></font>col2 <font color="#FF0000"><b>do
          begin
               if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#FF0000"><b>then
                  </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">:= </font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#FF0000"><b>then
                  </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">:= </font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#000080">&gt; </font>TPal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#FF0000"><b>then
                  </b></font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#000080">:= </font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
               </font>setcolor<font color="#000080">(</font>lcv2<font color="#000080">, </font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>red<font color="#000080">, </font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>green<font color="#000080">,
</font>fadepal<font color="#000080">[</font>lcv2<font color="#000080">].</font>blue<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>delay<font color="#000080">(</font>dly<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(****************************************************************************)
(*                             PROCESS ESCAPE                               *)
(****************************************************************************)
</i></font><font color="#FF0000"><b>PROCEDURE
      </b></font>wrt <font color="#000080">( </font>c <font color="#000080">: </font>CHAR <font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN

      CASE </b></font>c <font color="#FF0000"><b>OF
           </b></font>FF <font color="#000080">:  </font>CLRSCR<font color="#000080">;
          </font><font color="#FF0000"><b>ELSE   </b></font>WRITE <font color="#000080">(</font>c<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>PROCEDURE
      </b></font>set_graphics<font color="#000080">;
   </font><font color="#FF0000"><b>VAR
      </b></font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;
      </font>FG<font color="#000080">, </font>BG <font color="#000080">: </font>INTEGER<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      </b></font>FG <font color="#000080">:= </font>FGcolor<font color="#000080">;
      </font>BG <font color="#000080">:= </font>BGcolor<font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>escape_number <font color="#FF0000"><b>DO BEGIN
         CASE </b></font>escape_register <font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>OF
            </b></font><font color="#800000">0 </font><font color="#000080">: </font>lightcolor <font color="#000080">:= </font>FALSE<font color="#000080">;
            </font><font color="#800000">1 </font><font color="#000080">: </font>lightcolor <font color="#000080">:= </font>TRUE<font color="#000080">;
            </font><font color="#800000">5 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>FG <font color="#000080">+ </font>blink<font color="#000080">;
            </font><font color="#800000">7 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                   </b></font>FG <font color="#000080">:= </font>BG<font color="#000080">;
                   </font>BG <font color="#000080">:= </font>FG<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font><font color="#800000">30 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>black<font color="#000080">;
           </font><font color="#800000">30 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>black<font color="#000080">;
           </font><font color="#800000">31 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>red<font color="#000080">;
           </font><font color="#800000">32 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>green<font color="#000080">;
           </font><font color="#800000">33 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>brown<font color="#000080">;
           </font><font color="#800000">34 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>blue<font color="#000080">;
           </font><font color="#800000">35 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>magenta<font color="#000080">;
           </font><font color="#800000">36 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>cyan<font color="#000080">;
           </font><font color="#800000">37 </font><font color="#000080">: </font>FG <font color="#000080">:= </font>white<font color="#000080">;
           </font><font color="#800000">40 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>black<font color="#000080">;
           </font><font color="#800000">41 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>red<font color="#000080">;
           </font><font color="#800000">42 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>green<font color="#000080">;
           </font><font color="#800000">43 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>yellow<font color="#000080">;
           </font><font color="#800000">44 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>blue<font color="#000080">;
           </font><font color="#800000">45 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>magenta<font color="#000080">;
           </font><font color="#800000">46 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>cyan<font color="#000080">;
           </font><font color="#800000">47 </font><font color="#000080">: </font>BG <font color="#000080">:= </font>white<font color="#000080">;
         </font><font color="#FF0000"><b>ELSE
            </b></font><font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>lightcolor<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>fg <font color="#000080">&lt; </font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
         </b></font>fg <font color="#000080">:= </font>fg <font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>lightcolor <font color="#000080">= </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>fg <font color="#000080">&gt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
         </b></font>fg <font color="#000080">:= </font>fg <font color="#000080">- </font><font color="#800000">8</font><font color="#000080">;
      </font>TEXTCOLOR <font color="#000080">( </font>FG <font color="#000080">);
      </font>TEXTBACKGROUND <font color="#000080">( </font>BG <font color="#000080">);
      </font>escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>MoveUp<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
     IF </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
        </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
     </font>GOTOXY <font color="#000080">(</font>WHEREX<font color="#000080">, </font>WHEREY <font color="#000080">- (</font>Escape_Register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) );
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>MoveDown<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
     IF </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
        </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
     </font>GOTOXY <font color="#000080">(</font>WHEREX<font color="#000080">, </font>WHEREY <font color="#000080">+ (</font>Escape_Register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) );
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>MoveForeward<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
     IF </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
        </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
     </font>GOTOXY <font color="#000080">(</font>WHEREX <font color="#000080">+ (</font>Escape_Register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]), </font>WHEREY<font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>MoveBackward<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
     IF </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
        </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
     </font>GOTOXY <font color="#000080">(</font>WHEREX <font color="#000080">- (</font>Escape_Register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]), </font>WHEREY<font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>SaveCursorPos<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      </b></font>CursorX <font color="#000080">:= </font>WHEREX<font color="#000080">;
      </font>CursorY <font color="#000080">:= </font>WHEREY<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>RestoreCursorPos<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      </b></font>GOTOXY <font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>addr_cursor<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      CASE </b></font>escape_number <font color="#FF0000"><b>OF
         </b></font><font color="#800000">0 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                </font>escape_register <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">1 </font><font color="#000080">: </font>escape_register <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>ELSE
         </b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">25 </font><font color="#FF0000"><b>THEN
         </b></font>GOTOXY <font color="#000080">(</font>escape_register <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font><font color="#800000">24</font><font color="#000080">)
      </font><font color="#FF0000"><b>ELSE
         </b></font>GOTOXY <font color="#000080">(</font>escape_register <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font>escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>clear_scr<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF </b></font><font color="#000080">( </font>escape_number <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">)  </font><font color="#FF0000"><b>AND  </b></font><font color="#000080">( </font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">2 </font><font color="#000080">) </font><font color="#FF0000"><b>THEN
         </b></font>CLRSCR<font color="#000080">;
      </font>escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>clear_line<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF </b></font><font color="#000080">( </font>escape_number <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">)  </font><font color="#FF0000"><b>AND  </b></font><font color="#000080">( </font>escape_register <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>THEN
         </b></font>CLREOL<font color="#000080">;
      </font>escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>process_escape <font color="#000080">( </font>c <font color="#000080">: </font>CHAR <font color="#000080">);
   </font><font color="#FF0000"><b>VAR
      </b></font>i    <font color="#000080">: </font>INTEGER<font color="#000080">;
      </font>ch   <font color="#000080">: </font>CHAR<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      </b></font>c <font color="#000080">:= </font>UPCASE <font color="#000080">(</font>c<font color="#000080">);
      </font><font color="#FF0000"><b>CASE </b></font>c <font color="#FF0000"><b>OF
          </b></font><font color="#800000">'['
             </font><font color="#000080">: </font>EXIT<font color="#000080">;
         </font><font color="#800000">'F'</font><font color="#000080">, </font><font color="#800000">'H'
             </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                  </b></font>addr_cursor<font color="#000080">;
                  </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'J' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                  </b></font>clear_scr<font color="#000080">;
                  </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font><font color="#800000">'K' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                  </b></font>clear_line<font color="#000080">;
                  </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'M' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                  </b></font>set_graphics<font color="#000080">;
                  </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                  </font>EXIT<font color="#000080">;

               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'S' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                 </b></font>SaveCursorPos<font color="#000080">;
                  </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                 </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'U' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                 </b></font>RestoreCursorPos<font color="#000080">;
                 </font>Escape_Mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                 </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'A' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                 </b></font>MoveUp<font color="#000080">;
                 </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                 </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'B' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                 </b></font>MoveDown<font color="#000080">;
                 </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                 </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'C' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>MoveForeward<font color="#000080">;
                 </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'D' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>MoveBackward<font color="#000080">;
                 </font>Escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
                </font>EXIT<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>ch <font color="#000080">:= </font>UPCASE <font color="#000080">( </font>c <font color="#000080">);
      </font>escape_str <font color="#000080">:= </font>escape_str <font color="#000080">+ </font>ch<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[ </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'G'</font><font color="#000080">, </font><font color="#800000">'L'</font><font color="#000080">..</font><font color="#800000">'P' </font><font color="#000080">] </font><font color="#FF0000"><b>THEN </b></font>EXIT<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[ </font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9' </font><font color="#000080">] </font><font color="#FF0000"><b>THEN BEGIN
         </b></font>escape_register <font color="#000080">[</font>escape_number<font color="#000080">] := (</font>escape_register <font color="#000080">[</font>escape_number<font color="#000080">] *
</font><font color="#800000">10</font><font color="#000080">) + </font>ORD <font color="#000080">( </font>ch <font color="#000080">) - </font>ORD <font color="#000080">( </font><font color="#800000">'0' </font><font color="#000080">);
         </font>EXIT<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>CASE </b></font>ch <font color="#FF0000"><b>OF
         </b></font><font color="#800000">';'</font><font color="#000080">, </font><font color="#800000">',' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                       </b></font>escape_number <font color="#000080">:= </font>escape_number <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                       </font>escape_register <font color="#000080">[</font>escape_number<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#800000">'T'</font><font color="#000080">,  </font><font color="#800000">'#'</font><font color="#000080">, </font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'&gt;'</font><font color="#000080">, </font><font color="#800000">'&lt;'</font><font color="#000080">, </font><font color="#800000">'.'
                  </font><font color="#000080">: ;
      </font><font color="#FF0000"><b>ELSE
         </b></font>escape_mode <font color="#000080">:= </font>FALSE<font color="#000080">;
         </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">( </font>escape_str <font color="#000080">) </font><font color="#FF0000"><b>DO
            </b></font>wrt <font color="#000080">( </font>escape_str <font color="#000080">[</font>i<font color="#000080">] );
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(**************************************************************************)
(*                             SCREEN HANDLER                             *)
(**************************************************************************)
   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>scrwrite <font color="#000080">( </font>c <font color="#000080">: </font>CHAR <font color="#000080">);
   </font><font color="#FF0000"><b>VAR
      </b></font>i  <font color="#000080">: </font>INTEGER<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
      IF </b></font>c <font color="#000080">= </font>ESC <font color="#FF0000"><b>THEN BEGIN
         IF </b></font>escape_mode <font color="#FF0000"><b>THEN BEGIN
            FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">( </font>escape_str <font color="#000080">) </font><font color="#FF0000"><b>DO
               </b></font>wrt <font color="#000080">( </font>escape_str <font color="#000080">[</font>i<font color="#000080">] );
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>escape_str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
         </font>escape_number <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
         </font>escape_register <font color="#000080">[</font>escape_number<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
         </font>escape_mode <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font><font color="#FF0000"><b>END
      ELSE
         IF </b></font>escape_mode <font color="#FF0000"><b>THEN
            </b></font>process_escape <font color="#000080">(</font>c<font color="#000080">)
         </font><font color="#FF0000"><b>ELSE
            </b></font>wrt <font color="#000080">( </font>c <font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Set50Lines<font color="#000080">;
</font><font color="#FF0000"><b>Begin
Asm
  </b></font><font color="#FF00FF">mov ax, $1202
  mov bl, $30
  int $10     </font><font color="#008000"><i>{set 400 scan lines}
  </i></font><font color="#FF00FF">mov ax, 3
  int $10     </font><font color="#008000"><i>{set Text mode}
  </i></font><font color="#FF00FF">mov ax, $1112
  mov bl, 0
  int $10     </font><font color="#008000"><i>{load 8x8 font to page 0 block}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   for </b></font>II<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
   </b></font>getcolor<font color="#000080">(</font>II<font color="#000080">,</font>fadepal<font color="#000080">[</font>II<font color="#000080">].</font>red<font color="#000080">,</font>fadepal<font color="#000080">[</font>II<font color="#000080">].</font>green<font color="#000080">,</font>fadepal<font color="#000080">[</font>II<font color="#000080">].</font>blue<font color="#000080">);
   </font>rgbpal<font color="#000080">:=</font>fadepal<font color="#000080">;
   </font>fadeout<font color="#000080">(</font>fadepal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>fadepal<font color="#000080">:=</font>rgbpal<font color="#000080">;
   </font>ClrScr<font color="#000080">;
   </font>fadein<font color="#000080">(</font>fadepal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">127</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
</font>Write <font color="#000080">(</font><font color="#800000">'Do you want 50 lines mode?'</font><font color="#000080">);
</font>ch<font color="#000080">:=</font>Readkey<font color="#000080">;
</font>c <font color="#000080">:= </font>UPCASE <font color="#000080">(</font>ch<font color="#000080">);
      </font><font color="#FF0000"><b>CASE </b></font>c <font color="#FF0000"><b>OF
         </b></font><font color="#800000">'N'
             </font><font color="#000080">: </font><font color="#FF0000"><b>goto </b></font>JM1<font color="#000080">;
         </font><font color="#800000">'Y'
             </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                  asm</b></font><font color="#FF00FF">;  Mov  AH,00;  Mov  AL,$3;  Int  10h;  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                  </font>Set50Lines<font color="#000080">;
                  </font>clrScr<font color="#000080">;
                  </font>Set50Lines<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font>Jm1<font color="#000080">:
</font>USERFILE<font color="#000080">:=</font>PARAMSTR<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{('Test.Ans');}
</i></font>Escape_Str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font>FGColor <font color="#000080">:= </font>White<font color="#000080">;</font>BGColor <font color="#000080">:= </font>BLACK<font color="#000080">;
</font>Escape_Mode <font color="#000080">:= </font>TRUE<font color="#000080">;
</font>CLRSCR<font color="#000080">;
</font>ASSIGN <font color="#000080">(</font>AnsiFile<font color="#000080">, </font>USERFILE<font color="#000080">);
</font>RESET <font color="#000080">(</font>AnsiFile<font color="#000080">);
</font><font color="#FF0000"><b>WHILE NOT </b></font>EOF <font color="#000080">(</font>AnsiFile<font color="#000080">) </font><font color="#FF0000"><b>DO
BEGIN
  </b></font>READ <font color="#000080">(</font>AnsiFile<font color="#000080">, </font>ch<font color="#000080">);
  </font>DELAY <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>ScrWrite <font color="#000080">(</font>Ch<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
