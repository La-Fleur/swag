<html>
<head><title> "Full ANSI Output unit" by GAYLE DAVIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ A unit to implement FULL ANSI output.  Useful for a BBS or DOOR program
  where you would want to send string out over the modem.  Simply call
  your modem routine to :

             SENDSTRING(port,ANSIGoToXY(1,1))

  Would reposition the cursor on the remote terminal.  Get the idea ??

  The thing will EVEN play ANSI music !!

  Gayle Davis 1/24/94



}

</i></font><font color="#FF0000"><b>UNIT </b></font>AnsiIO<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

   USES
      </b></font>CRT<font color="#000080">,
      </font>Graph3<font color="#000080">;

   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIClrScr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIClrEol <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIGotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIUp<font color="#000080">(</font>Lines <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIDown<font color="#000080">(</font>Lines <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIRight<font color="#000080">(</font>Cols <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSILeft<font color="#000080">(</font>Cols <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIColor<font color="#000080">(</font>Fg<font color="#000080">, </font>Bg <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>FUNCTION </b></font>ANSIMusic<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>PROCEDURE </b></font>ANSIWrite<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
   </font><font color="#FF0000"><b>PROCEDURE </b></font>ANSIWriteLn<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

   CONST
      </b></font>ColorArray <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer <font color="#000080">= (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);

   </font><font color="#FF0000"><b>VAR
      </b></font>Bold<font color="#000080">, </font>TruncateLines <font color="#000080">: </font>boolean<font color="#000080">;
      </font>Vari<font color="#000080">, </font>Octave<font color="#000080">, </font>Numb <font color="#000080">: </font>integer<font color="#000080">;
      </font>Test<font color="#000080">, </font>Dly<font color="#000080">, </font>Intern<font color="#000080">, </font>DlyKeep <font color="#000080">: </font>longInt<font color="#000080">;
      </font>Flager<font color="#000080">, </font>ChartoPlay <font color="#000080">: </font>char<font color="#000080">;
      </font>Typom<font color="#000080">, </font>Min1<font color="#000080">, </font>Adder <font color="#000080">: </font>real<font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***       Function that returns the ANSI code for a Clear Screen.        ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIClrScr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>BEGIN
         </b></font>ANSIClrScr <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'[2J'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***    Function that returns the ANSI code for a Clear to End of Line.   ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIClrEol <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>BEGIN
         </b></font>ANSIClrEol <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'[K'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***   Function that returns the ANSI code to move the cursor to (X,Y).   ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIGotoXY<font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>XStr<font color="#000080">, </font>YStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>X<font color="#000080">,</font>XStr<font color="#000080">);
         </font>str<font color="#000080">(</font>Y<font color="#000080">,</font>YStr<font color="#000080">);
         </font>ANSIGotoXY <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>YStr<font color="#000080">+</font><font color="#800000">';'</font><font color="#000080">+</font>XStr<font color="#000080">+</font><font color="#800000">'H'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***  Function that returns the ANSI code to move the cursor up &quot;Lines&quot;   ***}
{***                         number of lines.                             ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIUp<font color="#000080">(</font>Lines <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>LinesStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>Lines<font color="#000080">,</font>LinesStr<font color="#000080">);
         </font>ANSIUp <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>LinesStr<font color="#000080">+</font><font color="#800000">'A'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***  Function that returns the ANSI code to move the cursor down &quot;Lines&quot; ***}
{***                        number of lines.                              ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIDown<font color="#000080">(</font>Lines <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>LinesStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>Lines<font color="#000080">,</font>LinesStr<font color="#000080">);
         </font>ANSIDown <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>LinesStr<font color="#000080">+</font><font color="#800000">'B'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***     Function that returns the ANSI code to move the cursor &quot;Cols&quot;    ***}
{***                         positions forward.                           ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIRight<font color="#000080">(</font>Cols <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>ColsStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>Cols<font color="#000080">,</font>ColsStr<font color="#000080">);
         </font>ANSIRight <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>ColsStr<font color="#000080">+</font><font color="#800000">'C'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***     Function that returns the ANSI code to move the cursor &quot;Cols&quot;    ***}
{***                        positions backward.                           ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSILeft<font color="#000080">(</font>Cols <font color="#000080">: </font>word<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>ColsStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>Cols<font color="#000080">,</font>ColsStr<font color="#000080">);
         </font>ANSILeft <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">+</font>ColsStr<font color="#000080">+</font><font color="#800000">'D'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***    Function that returns the ANSI code to change the screen color    ***}
{***             to an &quot;Fg&quot; foreground and a &quot;Bg&quot; background.             ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIColor<font color="#000080">(</font>Fg<font color="#000080">, </font>Bg <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>FgStr<font color="#000080">, </font>BgStr<font color="#000080">, </font>Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>str<font color="#000080">(</font>ColorArray<font color="#000080">[</font>Fg <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">] + </font><font color="#800000">30</font><font color="#000080">, </font>FgStr<font color="#000080">);
         </font>str<font color="#000080">(</font>ColorArray<font color="#000080">[</font>Bg <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">] + </font><font color="#800000">40</font><font color="#000080">, </font>BgStr<font color="#000080">);
         </font>Temp <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'['</font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>Bg <font color="#000080">&gt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then
            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">+</font><font color="#800000">'5;'
         </font><font color="#FF0000"><b>else
            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">+</font><font color="#800000">'0;'</font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>Fg <font color="#000080">&gt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then
            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">+</font><font color="#800000">'1;'
         </font><font color="#FF0000"><b>else
            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">+</font><font color="#800000">'2;'</font><font color="#000080">;
         </font>ANSIColor <font color="#000080">:= </font>Temp<font color="#000080">+</font>FgStr<font color="#000080">+</font><font color="#800000">';'</font><font color="#000080">+</font>BgStr<font color="#000080">+</font><font color="#800000">'m'</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{*** Function that returns an ANSI code representing a music string (&quot;s&quot;) ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>FUNCTION </b></font>ANSIMusic<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         </b></font>ANSIMusic <font color="#000080">:= </font><font color="#800000">#27</font><font color="#000080">+</font><font color="#800000">'[MF'</font><font color="#000080">+</font>s<font color="#000080">+</font><font color="#800000">#14</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***  Procedure that simulates BASIC's &quot;PLAY&quot; procedure.  Will also work  ***}
{***      with ANSI codes.  Taken from PC Magazine Volume 9 Number 3      ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Play<font color="#000080">(</font>SoundC <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>FUNCTION </b></font>IsNumber<font color="#000080">(</font>ch <font color="#000080">: </font>char<font color="#000080">) : </font>boolean<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN
            </b></font>IsNumber <font color="#000080">:= (</font>CH <font color="#000080">&gt;= </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CH <font color="#000080">&lt;= </font><font color="#800000">'9'</font><font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#008000"><i>{Converts a string to an integer}
      </i></font><font color="#FF0000"><b>FUNCTION </b></font>value<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>integer<font color="#000080">;
         </font><font color="#FF0000"><b>VAR
            </b></font>ss<font color="#000080">, </font>sss <font color="#000080">: </font>integer<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN
            </b></font>Val<font color="#000080">(</font>s<font color="#000080">, </font>ss<font color="#000080">, </font>sss<font color="#000080">);
            </font>value <font color="#000080">:= </font>ss<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#008000"><i>{Plays the selected note}
      </i></font><font color="#FF0000"><b>PROCEDURE </b></font>sounder<font color="#000080">(</font>key <font color="#000080">: </font>char<font color="#000080">; </font>flag <font color="#000080">: </font>char<font color="#000080">);
         </font><font color="#FF0000"><b>VAR
            </b></font>old<font color="#000080">, </font>New<font color="#000080">, </font>new2 <font color="#000080">: </font>Real<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN
            </b></font>adder <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
            </font>old <font color="#000080">:= </font>dly<font color="#000080">;
            </font>New <font color="#000080">:= </font>dly<font color="#000080">;
            </font>intern <font color="#000080">:= </font>Pos<font color="#000080">(</font>key<font color="#000080">, </font><font color="#800000">'C D EF G A B'</font><font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>flag <font color="#000080">= </font><font color="#800000">'+'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>key <font color="#000080">&lt;&gt; </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>key <font color="#000080">&lt;&gt; </font><font color="#800000">'B'</font><font color="#000080">) </font><font color="#008000"><i>{See if note}
               </i></font><font color="#FF0000"><b>THEN </b></font>Inc<font color="#000080">(</font>intern<font color="#000080">);                              </font><font color="#008000"><i>{is sharped }
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>flag <font color="#000080">= </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>key <font color="#000080">&lt;&gt; </font><font color="#800000">'F'</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>key <font color="#000080">&lt;&gt; </font><font color="#800000">'C'</font><font color="#000080">)
               </font><font color="#FF0000"><b>THEN </b></font>Dec<font color="#000080">(</font>intern<font color="#000080">);                              </font><font color="#008000"><i>{or a flat. }
            </i></font><font color="#FF0000"><b>WHILE </b></font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'.' </font><font color="#FF0000"><b>DO
               BEGIN
                  </b></font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                  </font>adder <font color="#000080">:= </font>adder<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;
                  </font>New <font color="#000080">:= </font>New<font color="#000080">+(</font>old<font color="#000080">*</font>adder<font color="#000080">);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font>new2 <font color="#000080">:= (</font>New<font color="#000080">/</font>typom<font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">-</font>typom<font color="#000080">);
            </font>sound<font color="#000080">(</font>Round<font color="#000080">(</font>Exp<font color="#000080">((</font>octave<font color="#000080">+</font>intern<font color="#000080">/</font><font color="#800000">12</font><font color="#000080">)*</font>Ln<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">)))); </font><font color="#008000"><i>{Play the note}
            </i></font>Delay<font color="#000080">(</font>Trunc<font color="#000080">(</font>New<font color="#000080">));
            </font>Nosound<font color="#000080">;
            </font>Delay<font color="#000080">(</font>Trunc<font color="#000080">(</font>new2<font color="#000080">));
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#008000"><i>{Calculate delay for a specified note length}
      </i></font><font color="#FF0000"><b>FUNCTION </b></font>delayer1 <font color="#000080">: </font>integer<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN
            </b></font>numb <font color="#000080">:= </font>value<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
            </font>delayer1 <font color="#000080">:= </font>Trunc<font color="#000080">((</font><font color="#800000">60000</font><font color="#000080">/(</font>numb<font color="#000080">*</font>min1<font color="#000080">))*</font>typom<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#008000"><i>{Used as above, except reads a number &gt;10}

      </i></font><font color="#FF0000"><b>FUNCTION </b></font>delayer2 <font color="#000080">: </font>Integer<font color="#000080">;
         </font><font color="#FF0000"><b>BEGIN
            </b></font>numb <font color="#000080">:= </font>value<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]);
            </font>delayer2 <font color="#000080">:= </font>Trunc<font color="#000080">((</font><font color="#800000">60000</font><font color="#000080">/(</font>numb<font color="#000080">*</font>min1<font color="#000080">))*</font>typom<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{Play}
         </i></font>SoundC <font color="#000080">:= </font>SoundC<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
         </font><font color="#FF0000"><b>FOR </b></font>vari <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>SoundC<font color="#000080">) </font><font color="#FF0000"><b>DO
            BEGIN                     </b></font><font color="#008000"><i>{Go through entire string}
               </i></font>SoundC<font color="#000080">[</font>vari<font color="#000080">] := </font>Upcase<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">]);
               </font><font color="#FF0000"><b>CASE </b></font>SoundC<font color="#000080">[</font>vari<font color="#000080">] </font><font color="#FF0000"><b>OF
</b></font><font color="#008000"><i>{Check to see}    </i></font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,
</font><font color="#008000"><i>{if char is a}    </i></font><font color="#800000">'F'</font><font color="#000080">,</font><font color="#800000">'G'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">,
</font><font color="#008000"><i>{note}            </i></font><font color="#800000">'B' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                           </b></font>flager <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
                           </font>dlykeep <font color="#000080">:= </font>dly<font color="#000080">;
                           </font>chartoplay <font color="#000080">:= </font>SoundC<font color="#000080">[</font>vari<font color="#000080">];
                           </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                              </b></font><font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'+'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Check for flats &amp; sharps}    </i></font><font color="#FF0000"><b>BEGIN
                                 </b></font>flager <font color="#000080">:= </font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
                                 </font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font><font color="#FF0000"><b>IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                              BEGIN
                                 IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                                    BEGIN
                                       </b></font>test <font color="#000080">:= </font>delayer2<font color="#000080">;
</font><font color="#008000"><i>{Make sure # is legal}                 </i></font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&lt; </font><font color="#800000">65 </font><font color="#FF0000"><b>THEN
                                          </b></font>dly <font color="#000080">:= </font>test<font color="#000080">;
                                       </font>Inc<font color="#000080">(</font>vari<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
                                    </font><font color="#FF0000"><b>END
                                 ELSE
                                    BEGIN
                                       </b></font>test <font color="#000080">:= </font>delayer1<font color="#000080">;
</font><font color="#008000"><i>{Make sure # is legal}                 </i></font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                                          </b></font>dly <font color="#000080">:= </font>test<font color="#000080">;
                                       </font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font>sounder<font color="#000080">(</font>chartoplay<font color="#000080">, </font>flager<font color="#000080">);
                           </font>dly <font color="#000080">:= </font>dlykeep<font color="#000080">;
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{Check for}       </i></font><font color="#800000">'O' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{octave change}            </i></font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                           </font><font color="#FF0000"><b>CASE </b></font>SoundC<font color="#000080">[</font>vari<font color="#000080">] </font><font color="#FF0000"><b>OF
                              </b></font><font color="#800000">'-' </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>octave <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>Dec<font color="#000080">(</font>octave<font color="#000080">);
                              </font><font color="#800000">'+' </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>octave <font color="#000080">&lt; </font><font color="#800000">7 </font><font color="#FF0000"><b>THEN </b></font>Inc<font color="#000080">(</font>octave<font color="#000080">);
                              </font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,
                              </font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,
                              </font><font color="#800000">'7' </font><font color="#000080">: </font>octave <font color="#000080">:= </font>value<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">])+</font><font color="#800000">4</font><font color="#000080">;
                           </font><font color="#FF0000"><b>ELSE </b></font>Dec<font color="#000080">(</font>vari<font color="#000080">);
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{Check for a}     </i></font><font color="#800000">'L' </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{change in length}         </i></font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{for notes}                   </i></font><font color="#FF0000"><b>IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                                 BEGIN
                                    </b></font>test <font color="#000080">:= </font>delayer2<font color="#000080">;
                                    </font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&lt; </font><font color="#800000">65 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # is legal}                 </i></font>dly <font color="#000080">:= </font>test<font color="#000080">;
                                    </font>Inc<font color="#000080">(</font>vari<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
                                 </font><font color="#FF0000"><b>END
                              ELSE
                                 BEGIN
                                    </b></font>test <font color="#000080">:= </font>delayer1<font color="#000080">;
                                    </font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # is legal}                 </i></font>dly <font color="#000080">:= </font>test<font color="#000080">;
                                    </font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{Check for pause} </i></font><font color="#800000">'P' </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{and it's length}          </i></font><font color="#FF0000"><b>BEGIN
                              IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                                 BEGIN
                                    </b></font>test <font color="#000080">:= </font>delayer2<font color="#000080">;
                                    </font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&lt; </font><font color="#800000">65 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # is legal}                 </i></font>Delay<font color="#000080">(</font>test<font color="#000080">);
                                    </font>Inc<font color="#000080">(</font>vari<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
                                 </font><font color="#FF0000"><b>END
                              ELSE
                                 BEGIN
                                    </b></font>test <font color="#000080">:= </font>delayer1<font color="#000080">;
                                    </font><font color="#FF0000"><b>IF </b></font>numb <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # is legal}                 </i></font>Delay<font color="#000080">(</font>test<font color="#000080">);
                                    </font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{Check for}       </i></font><font color="#800000">'T' </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>AND
</b></font><font color="#008000"><i>{tempo change}             </i></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                           BEGIN
                              IF </b></font>IsNumber<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
                                 BEGIN
                                    </b></font>min1 <font color="#000080">:= </font>value<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+
                                            </font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]+</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]);
                                    </font>Inc<font color="#000080">(</font>vari<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                                    </font><font color="#FF0000"><b>IF </b></font>min1 <font color="#000080">&gt; </font><font color="#800000">255 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # isn't too big}            </i></font>min1 <font color="#000080">:= </font><font color="#800000">255</font><font color="#000080">;
                                 </font><font color="#FF0000"><b>END
                              ELSE
                                 BEGIN
                                    </b></font>min1 <font color="#000080">:= </font>value<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]+
                                            </font>SoundC<font color="#000080">[</font>vari<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]);
                                    </font><font color="#FF0000"><b>IF </b></font>min1 <font color="#000080">&lt; </font><font color="#800000">32 </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{Make sure # isn't too small}          </i></font>min1 <font color="#000080">:= </font><font color="#800000">32</font><font color="#000080">;
                                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font>min1 <font color="#000080">:= </font>min1<font color="#000080">/</font><font color="#800000">4</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{Check for music} </i></font><font color="#800000">'M' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{type}                     </i></font>Inc<font color="#000080">(</font>vari<font color="#000080">);
                           </font><font color="#FF0000"><b>CASE </b></font>Upcase<font color="#000080">(</font>SoundC<font color="#000080">[</font>vari<font color="#000080">]) </font><font color="#FF0000"><b>OF
</b></font><font color="#008000"><i>{Normal}                      </i></font><font color="#800000">'N' </font><font color="#000080">: </font>typom <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">/</font><font color="#800000">8</font><font color="#000080">;
</font><font color="#008000"><i>{Legato}                      </i></font><font color="#800000">'L' </font><font color="#000080">: </font>typom <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#008000"><i>{Staccato}                    </i></font><font color="#800000">'S' </font><font color="#000080">: </font>typom <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">/</font><font color="#800000">4</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***    Procedure to process string &quot;s&quot; and write its contents to the     ***}
{***          screen, interpreting ANSI codes as it goes along.           ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>ANSIWrite<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>VAR
         </b></font>SaveX<font color="#000080">, </font>SaveY <font color="#000080">: </font>byte<font color="#000080">;
         </font>MusicStr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font>MusicPos <font color="#000080">: </font>integer<font color="#000080">;

   </font><font color="#008000"><i>{*** Procedure to process the actual ANSI sequence ***}
      </i></font><font color="#FF0000"><b>PROCEDURE </b></font>ProcessEsc<font color="#000080">;
         </font><font color="#FF0000"><b>VAR
            </b></font>DeleteNum <font color="#000080">: </font>integer<font color="#000080">;
            </font>ts <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
            </font>Num <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>shortint<font color="#000080">;
            </font>Color <font color="#000080">: </font>integer<font color="#000080">;

         </font><font color="#FF0000"><b>LABEL
            </b></font>loop<font color="#000080">;

      </font><font color="#008000"><i>{*** Procedure to extract a parameter from the ANSI sequence and ***}
      {*** place it in &quot;Num&quot; ***}
         </i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetNum<font color="#000080">(</font>cx <font color="#000080">: </font>byte<font color="#000080">);
            </font><font color="#FF0000"><b>VAR
               </b></font>code <font color="#000080">: </font>integer<font color="#000080">;
            </font><font color="#FF0000"><b>BEGIN
               </b></font>ts <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
               </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>length<font color="#000080">(</font>s<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                  BEGIN
                     </b></font>ts <font color="#000080">:= </font>ts <font color="#000080">+ </font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
                     </font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font>val<font color="#000080">(</font>ts<font color="#000080">,</font>Num<font color="#000080">[</font>cx<font color="#000080">],</font>code<font color="#000080">)
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>BEGIN
            IF </b></font>s<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'[' </font><font color="#FF0000"><b>THEN </b></font>exit<font color="#000080">;
            </font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) = </font><font color="#800000">'M'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'F'</font><font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN
</b></font><font color="#008000"><i>{play music}   </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                  </font>MusicPos <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">#14</font><font color="#000080">,</font>s<font color="#000080">);
                  </font>Play<font color="#000080">(</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>MusicPos<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">));
                  </font>DeleteNum <font color="#000080">:= </font>MusicPos<font color="#000080">;
                  </font><font color="#FF0000"><b>Goto </b></font>Loop<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font>fillchar<font color="#000080">(</font>Num<font color="#000080">,</font>sizeof<font color="#000080">(</font>Num<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
            </font>GetNum<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
            </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">';'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>DeleteNum <font color="#000080">&lt; </font><font color="#800000">11</font><font color="#000080">) </font><font color="#FF0000"><b>DO
               BEGIN
                  </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                  </font>GetNum<font color="#000080">(</font>DeleteNum<font color="#000080">);
                  </font>DeleteNum  <font color="#000080">:= </font>DeleteNum <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>CASE </b></font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>of
</b></font><font color="#008000"><i>{move up}      </i></font><font color="#800000">'A' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>WHILE </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
                           BEGIN
                              </b></font>GotoXY<font color="#000080">(</font>wherex<font color="#000080">,</font>wherey <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
                              </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{move down}    </i></font><font color="#800000">'B' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>WHILE </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
                           BEGIN
                              </b></font>GotoXY<font color="#000080">(</font>wherex<font color="#000080">,</font>wherey <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
                              </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{move right}   </i></font><font color="#800000">'C' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>WHILE </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
                           BEGIN
                              </b></font>GotoXY<font color="#000080">(</font>wherex <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
                              </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{move left}    </i></font><font color="#800000">'D' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>WHILE </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
                           BEGIN
                              </b></font>GotoXY<font color="#000080">(</font>wherex <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
                              </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] - </font><font color="#800000">1</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{goto x,y}     </i></font><font color="#800000">'H'</font><font color="#000080">,
               </font><font color="#800000">'F' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font><font color="#000080">(</font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Num<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                           </b></font>Num<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
                        </font>GotoXY<font color="#000080">(</font>Num<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{save current} </i></font><font color="#800000">'S' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{position}              </i></font>SaveX <font color="#000080">:= </font>wherex<font color="#000080">;
                        </font>SaveY <font color="#000080">:= </font>wherey<font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{restore}      </i></font><font color="#800000">'U' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{saved position}        </i></font>GotoXY<font color="#000080">(</font>SaveX<font color="#000080">,</font>SaveY<font color="#000080">);
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{clear screen} </i></font><font color="#800000">'J' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN
                           </b></font>ClrScr<font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{clear from}   </i></font><font color="#800000">'K' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{cursor position}       </i></font>ClrEOL<font color="#000080">;
</font><font color="#008000"><i>{to end of line}        </i></font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{change}       </i></font><font color="#800000">'M' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{colors and}            </i></font>DeleteNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#008000"><i>{attributes}            </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Num<font color="#000080">[</font>DeleteNum<font color="#000080">] &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DeleteNum <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                           BEGIN
                              CASE </b></font>Num<font color="#000080">[</font>DeleteNum<font color="#000080">] </font><font color="#FF0000"><b>of
</b></font><font color="#008000"><i>{all attributes off}             </i></font><font color="#800000">0 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                                        </b></font>NormVideo<font color="#000080">;
                                        </font>Bold <font color="#000080">:= </font>false<font color="#000080">;
                                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{bold on}                        </i></font><font color="#800000">1 </font><font color="#000080">: </font>Bold <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#008000"><i>{blink on}                       </i></font><font color="#800000">5 </font><font color="#000080">: </font>textattr <font color="#000080">:= </font>textattr <font color="#000080">+ </font>blink<font color="#000080">;
</font><font color="#008000"><i>{reverse on}                     </i></font><font color="#800000">7 </font><font color="#000080">: </font>textattr <font color="#000080">:= ((</font>textattr <font color="#FF0000"><b>and </b></font><font color="#800000">$07</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) +
                                     ((</font>textattr <font color="#FF0000"><b>and </b></font><font color="#800000">$70</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">);
</font><font color="#008000"><i>{invisible on}                   </i></font><font color="#800000">8 </font><font color="#000080">: </font>textattr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#008000"><i>{general foregrounds}            </i></font><font color="#800000">30</font><font color="#000080">..
                                 </font><font color="#800000">37 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                                         </b></font>color <font color="#000080">:= </font>ColorArray<font color="#000080">[</font>Num<font color="#000080">[</font>DeleteNum<font color="#000080">]
                                                  - </font><font color="#800000">30</font><font color="#000080">];
                                         </font><font color="#FF0000"><b>IF </b></font>Bold <font color="#FF0000"><b>THEN
                                            </b></font>color <font color="#000080">:= </font>color <font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">;
                                         </font>textcolor<font color="#000080">(</font>color<font color="#000080">);
                                      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{general backgrounds}            </i></font><font color="#800000">40</font><font color="#000080">..
                                 </font><font color="#800000">47 </font><font color="#000080">: </font>textbackground<font color="#000080">(
                                      </font>ColorArray<font color="#000080">[</font>Num<font color="#000080">[</font>DeleteNum<font color="#000080">] - </font><font color="#800000">40</font><font color="#000080">]);
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font>DeleteNum <font color="#000080">:= </font>DeleteNum <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{change text}  </i></font><font color="#800000">'='</font><font color="#000080">,
</font><font color="#008000"><i>{modes}        </i></font><font color="#800000">'?' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                        </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                        </font>GetNum<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
                        </font><font color="#FF0000"><b>if </b></font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) = </font><font color="#800000">'H' </font><font color="#FF0000"><b>THEN
                           BEGIN
                              CASE </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>of
                                 </b></font><font color="#800000">0 </font><font color="#000080">: </font>TextMode<font color="#000080">(</font>bw40<font color="#000080">);
                                 </font><font color="#800000">1 </font><font color="#000080">: </font>TextMode<font color="#000080">(</font>co40<font color="#000080">);
                                 </font><font color="#800000">2 </font><font color="#000080">: </font>TextMode<font color="#000080">(</font>bw80<font color="#000080">);
                                 </font><font color="#800000">3 </font><font color="#000080">: </font>TextMode<font color="#000080">(</font>co80<font color="#000080">);
                                 </font><font color="#800000">4 </font><font color="#000080">: </font>GraphColorMode<font color="#000080">;
                                 </font><font color="#800000">5 </font><font color="#000080">: </font>GraphMode<font color="#000080">;
                                 </font><font color="#800000">6 </font><font color="#000080">: </font>HiRes<font color="#000080">;
                                 </font><font color="#800000">7 </font><font color="#000080">: </font>TruncateLines <font color="#000080">:= </font>false<font color="#000080">;
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>if </b></font>UpCase<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) = </font><font color="#800000">'L' </font><font color="#FF0000"><b>THEN
                           if </b></font>Num<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] = </font><font color="#800000">7 </font><font color="#FF0000"><b>THEN
                              </b></font>TruncateLines <font color="#000080">:= </font>true<font color="#000080">;
                        </font>DeleteNum <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>loop<font color="#000080">:       </font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>DeleteNum<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>BEGIN
         WHILE </b></font>length<font color="#000080">(</font>s<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
            BEGIN
               if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">#27 </font><font color="#FF0000"><b>THEN
                  </b></font>ProcessEsc
               <font color="#FF0000"><b>else
                  BEGIN
                     </b></font>Write<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
                     </font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
{***                                                                      ***}
{***         Procedure that calls ANSIWrite, then line feeds.             ***}
{***                                                                      ***}
{****************************************************************************}
   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>ANSIWriteLn<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>BEGIN
         </b></font>ANSIWrite<font color="#000080">(</font>s<font color="#000080">);
         </font>WriteLn<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>BEGIN
      </b></font>Octave <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
      </font>ChartoPlay <font color="#000080">:= </font><font color="#800000">'N'</font><font color="#000080">;
      </font>Typom <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">/</font><font color="#800000">8</font><font color="#000080">;
      </font>Min1 <font color="#000080">:= </font><font color="#800000">120</font><font color="#000080">;
      </font>TruncateLines <font color="#000080">:= </font>false<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{----------------------------   DEMO PROGRAM  ------------------ }

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Atype<font color="#000080">;

   </font><font color="#FF0000"><b>USES
      </b></font>ANSIIO<font color="#000080">,
      </font>DOS<font color="#000080">,
      </font>CRT<font color="#000080">;

   </font><font color="#FF0000"><b>VAR
      </b></font>F <font color="#000080">: </font>text<font color="#000080">;
      </font>S<font color="#000080">, </font>L <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font>Ch <font color="#000080">: </font>char<font color="#000080">;
      </font>i <font color="#000080">: </font>integer<font color="#000080">;
      </font>Rec <font color="#000080">: </font>searchrec<font color="#000080">;

   </font><font color="#FF0000"><b>FUNCTION </b></font>PathOnly<font color="#000080">(</font>p1 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>VAR
         </b></font>s<font color="#000080">, </font>p <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
         </font>i<font color="#000080">, </font>t <font color="#000080">: </font>integer<font color="#000080">;
      </font><font color="#FF0000"><b>BEGIN
         </b></font>p <font color="#000080">:= </font>p1<font color="#000080">;
         </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>REPEAT
            </b></font>t <font color="#000080">:= </font>i<font color="#000080">;
            </font>i <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">'\'</font><font color="#000080">,</font>p<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
               </b></font>p<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'|'</font><font color="#000080">;
         </font><font color="#FF0000"><b>UNTIL </b></font>i <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>IF </b></font>t <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
            </b></font>t <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>p<font color="#000080">);
         </font>p1 <font color="#000080">:= </font>copy<font color="#000080">(</font>p1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>t<font color="#000080">);
         </font><font color="#FF0000"><b>IF </b></font>length<font color="#000080">(</font>p1<font color="#000080">) &gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN
            IF </b></font>p1<font color="#000080">[</font>length<font color="#000080">(</font>p1<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>THEN
               </b></font>p1 <font color="#000080">:= </font>p1<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
         </font>PathOnly <font color="#000080">:= </font>p1<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>BEGIN
      IF </b></font>ParamCount <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
         BEGIN
            </b></font>writeln<font color="#000080">;
            </font>writeln<font color="#000080">(</font><font color="#800000">'Usage : ATYPE file1 file2 file3 ...'</font><font color="#000080">,
                    </font><font color="#800000">'                       (Wildcards are OK)'</font><font color="#000080">);
            </font>EXIT<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$I-} </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>DO
         BEGIN
            </b></font>s <font color="#000080">:= </font>PathOnly<font color="#000080">(</font>ParamStr<font color="#000080">(</font>i<font color="#000080">));
            </font>FindFirst<font color="#000080">(</font>ParamStr<font color="#000080">(</font>i<font color="#000080">),</font>AnyFile<font color="#000080">,</font>Rec<font color="#000080">);
            </font><font color="#FF0000"><b>WHILE </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
               BEGIN
                  </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>s<font color="#000080">+</font>Rec<font color="#000080">.</font>name<font color="#000080">);
                  </font>reset<font color="#000080">(</font>f<font color="#000080">);
                  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>eof<font color="#000080">(</font>f<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>IOResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
                     BEGIN
                        </b></font>readln<font color="#000080">(</font>f<font color="#000080">,</font>l<font color="#000080">);
                        </font>ANSIWriteln<font color="#000080">(</font>l<font color="#000080">);
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                  </font>close<font color="#000080">(</font>f<font color="#000080">);
                  </font><font color="#FF0000"><b>While </b></font>KeyPressed <font color="#FF0000"><b>do
                     </b></font>ch <font color="#000080">:= </font>readkey<font color="#000080">;
                  </font><font color="#FF0000"><b>Repeat until </b></font>KeyPressed<font color="#000080">;
                  </font>FindNext<font color="#000080">(</font>Rec<font color="#000080">);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$I+}
   </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
