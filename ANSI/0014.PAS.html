<html>
<head><title> "Display THEDRAW BIN File" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here are the relevant pieces from a Program I wrote to convert TheDraw
.Bin Files to .ANS Files.  Why?  TheDraw's .ANSI Files are incredibly
wasteful!  The display speed of the menus of the BBS I wrote this For
now redraw at 300% the speed they used to!

if you (or anyone) wants the full Program, give me a yell.
}

</i></font><font color="#FF0000"><b>Program </b></font>Bin2Ansi<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Filenum   <font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#008000"><i>{Points to the command line parameter now being looked at}
  </i></font>fName     <font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{File from cmd line - possibly With wildcards}
  </i></font>Filesdone <font color="#000080">:</font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ParseFile <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>cmdFName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Details<font color="#000080">:</font>SearchRec<font color="#000080">;
    </font>fDir<font color="#000080">, </font>fName<font color="#000080">, </font>fExt<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Dummy<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#008000"><i>{The parts of the name of the source .Bin File}

  </i></font><font color="#FF0000"><b>begin
    </b></font><font color="#008000"><i>{Default extension}
    </i></font><font color="#FF0000"><b>if </b></font>pos <font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>cmdFName<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>cmdFName <font color="#000080">:= </font>cmdFName <font color="#000080">+ </font><font color="#800000">'.Bin'</font><font color="#000080">;
    </font>FSplit<font color="#000080">(</font>cmdFName<font color="#000080">, </font>fDir<font color="#000080">, </font>dummy<font color="#000080">, </font>dummy<font color="#000080">); </font><font color="#008000"><i>{Get the directory name}
    {Check to see if we have any matches For this Filespec}
    </i></font>FindFirst <font color="#000080">(</font>cmdFName<font color="#000080">,</font>AnyFile<font color="#000080">,</font>Details<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>Writeln <font color="#000080">(</font><font color="#800000">'Filespec: '</font><font color="#000080">,</font>cmdfname<font color="#000080">);
      </font>error <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">,</font>warning<font color="#000080">);
    </font><font color="#FF0000"><b>end else begin
      While </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
        </b></font>FSplit<font color="#000080">(</font>fdir<font color="#000080">+</font>details<font color="#000080">.</font>name<font color="#000080">, </font>dummy<font color="#000080">, </font>fName<font color="#000080">, </font>fExt<font color="#000080">); </font><font color="#008000"><i>{Get the directory name}
        </i></font>assign <font color="#000080">(</font>BinFile<font color="#000080">,</font>fdir<font color="#000080">+</font>details<font color="#000080">.</font>name<font color="#000080">);
        </font>Write <font color="#000080">(</font><font color="#800000">'Opening File: '</font><font color="#000080">,</font>details<font color="#000080">.</font>name<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">);
        </font><font color="#008000"><i>{$i-}
        </i></font>reset <font color="#000080">(</font>BinFile<font color="#000080">);
        </font><font color="#008000"><i>{$i+}
        </i></font><font color="#FF0000"><b>end else begin
          </b></font>Writeln <font color="#000080">(</font>details<font color="#000080">.</font>name<font color="#000080">,</font><font color="#800000">' --&gt; '</font><font color="#000080">,</font>fname<font color="#000080">,</font><font color="#800000">'.ANS  '</font><font color="#000080">);
          </font>process <font color="#000080">(</font>BinFile<font color="#000080">,</font>fdir<font color="#000080">+</font>fname<font color="#000080">+</font><font color="#800000">'.ANS'</font><font color="#000080">);
          </font>close <font color="#000080">(</font>BinFile<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>FindNext <font color="#000080">(</font>Details<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>directvideo <font color="#000080">:= </font>False<font color="#000080">;
  </font>Filesdone <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>header<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>error <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>fatal<font color="#000080">);
  </font>FileNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>fname <font color="#000080">:= </font>paramstr <font color="#000080">(</font>Filenum <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
    </font>ParseFile <font color="#000080">(</font>fname<font color="#000080">);
    </font>inc <font color="#000080">(</font>FileNum<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>paramstr <font color="#000080">(</font>FileNum <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">''</font><font color="#000080">;
  </font>Writeln<font color="#000080">; </font>Write <font color="#000080">(</font><font color="#800000">' &thorn; Done, With '</font><font color="#000080">,</font>Filesdone<font color="#000080">,</font><font color="#800000">' File'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Filesdone <font color="#000080">&lt;&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Write <font color="#000080">(</font><font color="#800000">'s'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">' processed.'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
