<html>
<head><title> "ANSI Screen Bounce" by AARON SCHROEDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MC&gt; I once saw an advo for TMP BBS.
MC&gt; It had an ANSi screen that &quot;bounced&quot; up and down.
MC&gt;
MC&gt; It was coded in ASM, but I wondered if Pascal could do the same. (without
MC&gt; having to do all ASM calls.)

     Of course, but there are some calls to ports that have to be  done.

MC&gt; The screen would bounce once, and then again, but with less height, ...
MC&gt; It looked like a ball bouncing.

     Well, Here's some of my code.. It does a pretty good job of  imitating a
ball bouncing, but one of the bounces goes higher than  the other.. Haven't
really had time to look into it. Hopefully you  have TheDraw because I made
the program such that you have to save  your ANSI as a normal Pascal file in
The Draw and then cut and  paste it into the program. Hope this helps!

{/////////////////////////////Program/////////////////////////////////////}
</i></font><font color="#FF0000"><b>Program </b></font>AnsiBounce<font color="#000080">;
</font><font color="#008000"><i>{Right here you place all the ANSI data from TheDraw.. When I tried, I just
 saved my picture in The Draw as a Normal pascal file and used the
 default identifier. THen I cut and pasted!                        }


</i></font><font color="#FF0000"><b>Var
  </b></font>start<font color="#000080">,</font>Speed <font color="#000080">: </font>integer<font color="#000080">;   </font><font color="#008000"><i>{Where to position the screen and how fast to inc}
  </i></font>cnt<font color="#000080">,</font>Winc <font color="#000080">: </font>byte<font color="#000080">;         </font><font color="#008000"><i>{two dummy counters}

</i></font><font color="#FF0000"><b>procedure </b></font>SetScreenStart<font color="#000080">(</font>ScanLine<font color="#000080">:</font>word<font color="#000080">);            </font><font color="#008000"><i>{ MAIN PROCEDURE !!!!   }
{This procedure just adjusts the text viewport.. Jon Merkel gave it to me   }
</i></font><font color="#FF0000"><b>var    </b></font>StartAddress<font color="#000080">: </font>word<font color="#000080">; </font><font color="#FF0000"><b>begin    </b></font>StartAddress <font color="#000080">:= (</font>ScanLine <font color="#FF0000"><b>div </b></font><font color="#800000">16</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">;
    </font>portw<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">] := </font>hi<font color="#000080">(</font>StartAddress<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">$0C</font><font color="#000080">;    </font><font color="#008000"><i>{ Set start address     }
    </i></font>portw<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">] := </font>lo<font color="#000080">(</font>StartAddress<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">$0D</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat until </b></font>port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;               </font><font color="#008000"><i>{ wait for retrace      }
    </i></font>portw<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">] := (</font>ScanLine <font color="#FF0000"><b>mod </b></font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8 </font><font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">;     </font><font color="#008000"><i>{ Set start scanline    }
    </i></font><font color="#FF0000"><b>repeat until </b></font>port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;                </font><font color="#008000"><i>{ wait out retrace      }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">mov ax,3; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;     </font><font color="#008000"><i>{set to 80x25 text mode just in case}
  </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">in al,21h; or al,2; out 21h,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>{ Disable the keyboard  }
  </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,0100h; mov cx,2000h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>{ Hide the cursor       }
  </i></font>fillchar<font color="#000080">(</font>mem<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">32768</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);        </font><font color="#008000"><i>{Clear the screen }
  </i></font>Start <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">;
  </font>SetScreenStart<font color="#000080">(</font>start<font color="#000080">);
  </font>Move<font color="#000080">(</font>ImageData<font color="#000080">,</font>mem<font color="#000080">[</font><font color="#800000">$B800</font><font color="#000080">:</font><font color="#800000">20</font><font color="#000080">*</font><font color="#800000">16</font><font color="#000080">],</font>ImageData_length<font color="#000080">); </font><font color="#008000"><i>{put our image on screen}
  </i></font>Speed <font color="#000080">:= -</font><font color="#800000">3</font><font color="#000080">;  </font>cnt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>Winc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat      </b></font><font color="#008000"><i>{Repeat Repeat Repeat Repeat Repeat... sorry ;) }
    </i></font>inc<font color="#000080">(</font>cnt<font color="#000080">);                          </font><font color="#008000"><i>{Dummy counter for the gravity}
    </i></font>Inc<font color="#000080">(</font>start<font color="#000080">,</font>SPeed<font color="#000080">);                  </font><font color="#008000"><i>{Where to position screenStart}
    </i></font><font color="#FF0000"><b>If </b></font>Cnt <font color="#FF0000"><b>mod </b></font><font color="#800000">2 </font><font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then              </b></font><font color="#008000"><i>{Gives the gravity effect}
      </i></font>Dec<font color="#000080">(</font>Speed<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>Start <font color="#000080">&lt;=</font><font color="#800000">0  </font><font color="#FF0000"><b>Then Begin           </b></font><font color="#008000"><i>{We have reached the top!}
      </i></font>Speed <font color="#000080">:= </font>abs<font color="#000080">(- (</font>Speed<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>Winc<font color="#000080">)                  </font><font color="#008000"><i>{When this gets to 15, we stop the loop}
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;                </font><font color="#008000"><i>{A term used to close the argument =) }
    </i></font>SetScreenStart<font color="#000080">(</font>start<font color="#000080">);             </font><font color="#008000"><i>{Position the Screen!}
  </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Winc<font color="#000080">&gt;=</font><font color="#800000">15</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">] = </font><font color="#800000">$1</font><font color="#000080">);   </font><font color="#008000"><i>{or escape is hit}
  </i></font><font color="#FF0000"><b>repeat until </b></font>port<font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">] = </font><font color="#800000">$1</font><font color="#000080">;            </font><font color="#008000"><i>{wait till you hit escape }
  </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">in al,21h; and al,253; out 21h,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;         </font><font color="#008000"><i>{ enable keyboard   }
  </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,3; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;      </font><font color="#008000"><i>{ reset the text mode   } </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0041.PAS">Original</a><b>]</b></p></body>
</html>
