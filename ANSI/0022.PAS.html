<html>
<head><title> "Another DETECT ANSI.SYS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
The following Functions provide a way to determine if the machine
the your application is running on has ANSI installed.

if your Program is written using the Crt Unit the Function may return
the result as False even if ANSI is present, unless you successfully
use a 'work around' method to ensure all Writes go through Dos.

I find it's easier just to not use Crt if my Program is working With
ANSI - since there is not much that you use the Crt Unit For that can't
be done in some other way.

The Dos-based alternatives to ReadKey and KeyPressed are included since
they are needed For the AnsiDetect Function.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>KeyPressed <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#008000"><i>{ Detects whether a key is pressed. Key remains in kbd buffer}
</i></font><font color="#FF0000"><b>Var
  </b></font>r<font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0B</font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>r<font color="#000080">);
  </font>KeyPressed <font color="#000080">:= (</font>r<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ReadKey <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>r<font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$08</font><font color="#000080">;
  </font>MsDos<font color="#000080">(</font>r<font color="#000080">);
  </font>ReadKey <font color="#000080">:= </font>Chr<font color="#000080">(</font>r<font color="#000080">.</font>AL<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>AnsiDetected <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ Detects whether ANSI is installed }
</i></font><font color="#FF0000"><b>Var
  </b></font>dummy<font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">#27'[6n'</font><font color="#000080">);               </font><font color="#008000"><i>{ Ask For cursor position report via }
  </i></font><font color="#FF0000"><b>if not </b></font>KeyPressed              <font color="#008000"><i>{ the ANSI driver. }
  </i></font><font color="#FF0000"><b>then
    </b></font>AnsiDetected <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else
  begin
    </b></font>AnsiDetected <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ empty the keyboard buffer }
    </i></font><font color="#FF0000"><b>Repeat
      </b></font>Dummy <font color="#000080">:= </font>ReadKey<font color="#000080">;
    </font><font color="#FF0000"><b>Until not </b></font>KeyPressed<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ANSI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
