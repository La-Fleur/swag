<html>
<head><title> "Example of calling One program from anot" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  This code is provided as is, without guarrantees or support of any kind. 
  We have two programs, one of which launches another, and passes
  shared data to it. You can place anything in that shared data,
  including instructions on when to launch a third or fourth program. 
  The shared data could be of virtually any size, the record we
  chose here was picked more or less at random.
}
{$M 1024, 0, 0}
{$R+,S+}
</i></font><font color="#FF0000"><b>program </b></font>Home<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,
  </font>SharInfo<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>SD<font color="#000080">: </font>TData <font color="#000080">=
    (</font>S<font color="#000080">: </font><font color="#800000">'Hi, this message came from Home.Exe.'</font><font color="#000080">;
    </font>I<font color="#000080">: </font><font color="#800000">42</font><font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>AddrStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];
  </font>Temp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];

  </font><font color="#FF0000"><b>procedure </b></font>HandleInput<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>vSeg<font color="#000080">, </font>vOfs<font color="#000080">, </font>Code<font color="#000080">: </font>Word<font color="#000080">;
    </font>PData<font color="#000080">: ^</font>TData<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>vSeg<font color="#000080">, </font>Code<font color="#000080">);
    </font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">), </font>vOfs<font color="#000080">, </font>Code<font color="#000080">);
    </font>PData <font color="#000080">:= </font>Ptr<font color="#000080">(</font>vSeg<font color="#000080">, </font>vOfs<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Home hears: '</font><font color="#000080">, </font>PData<font color="#000080">^.</font>S<font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'The magic number is: '</font><font color="#000080">, </font>PData<font color="#000080">^.</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>AddrStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
  </font>Str<font color="#000080">(</font>Seg<font color="#000080">(</font>SD<font color="#000080">), </font>AddrStr<font color="#000080">);
  </font>Str<font color="#000080">(</font>Ofs<font color="#000080">(</font>SD<font color="#000080">), </font>Temp<font color="#000080">);
  </font>Move<font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>AddrStr<font color="#000080">[</font>length<font color="#000080">(</font>AddrStr<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">], </font>length<font color="#000080">(</font>Temp<font color="#000080">));
  </font>Inc<font color="#000080">(</font>AddrStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>succ<font color="#000080">(</font>length<font color="#000080">(</font>temp<font color="#000080">)));
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'==============='</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Execing Visitor'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'==============='</font><font color="#000080">);
  </font>Swapvectors<font color="#000080">;
  </font>Exec<font color="#000080">(</font><font color="#800000">'Visitor.Exe'</font><font color="#000080">, </font>AddrStr<font color="#000080">);
  </font>Swapvectors<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'=========================='</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'We have returned to home. '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'=========================='</font><font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Home Says: '</font><font color="#000080">, </font>SD<font color="#000080">.</font>S<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Here''s a number visitor gave us: '</font><font color="#000080">, </font>SD<font color="#000080">.</font>I<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{======================}
{$M 2024, 0, 2000}
{$S+,R+}
</i></font><font color="#FF0000"><b>program </b></font>Visitor<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,
  </font>SharInfo<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>vSeg<font color="#000080">, </font>vOfs<font color="#000080">, </font>Code<font color="#000080">: </font>Word<font color="#000080">;
  </font>PData<font color="#000080">: ^</font>TData<font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>ReportError<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'This program is a subprogram of Home'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>SendDataBack<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>AddrStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];
    </font>Temp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];
    </font>SD<font color="#000080">: </font>TData<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>SD<font color="#000080">.</font>S <font color="#000080">:= </font><font color="#800000">'Hi, this message came from Visitor.Exe.'</font><font color="#000080">;
    </font>SD<font color="#000080">.</font>I <font color="#000080">:= </font><font color="#800000">42</font><font color="#000080">;
    </font>FillChar<font color="#000080">(</font>AddrStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">#32</font><font color="#000080">);
    </font>Str<font color="#000080">(</font>Seg<font color="#000080">(</font>SD<font color="#000080">), </font>AddrStr<font color="#000080">);
    </font>Str<font color="#000080">(</font>Ofs<font color="#000080">(</font>SD<font color="#000080">), </font>Temp<font color="#000080">);
    </font>Move<font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>AddrStr<font color="#000080">[</font>length<font color="#000080">(</font>AddrStr<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">], </font>length<font color="#000080">(</font>Temp<font color="#000080">));
    </font>Inc<font color="#000080">(</font>AddrStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font>succ<font color="#000080">(</font>length<font color="#000080">(</font>temp<font color="#000080">)));
    </font>Exec<font color="#000080">(</font><font color="#800000">'Home.Exe'</font><font color="#000080">, </font>AddrStr<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>ReportError<font color="#000080">;
  </font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">), </font>vSeg<font color="#000080">, </font>Code<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>ReportError<font color="#000080">;
  </font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">), </font>vOfs<font color="#000080">, </font>Code<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>ReportError<font color="#000080">;
  </font>PData <font color="#000080">:= </font>Ptr<font color="#000080">(</font>vSeg<font color="#000080">, </font>vOfs<font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Visitor hears: '</font><font color="#000080">, </font>PData<font color="#000080">^.</font>S<font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>PData<font color="#000080">^.</font>S <font color="#000080">:= </font><font color="#800000">'This is a message from visitor. '</font><font color="#000080">;
  </font>PData<font color="#000080">^.</font>i <font color="#000080">:= </font><font color="#800000">231</font><font color="#000080">;
  </font><font color="#008000"><i>{SendDataBack;}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{======================}

</i></font><font color="#FF0000"><b>Unit </b></font>SharInfo<font color="#000080">;
</font><font color="#008000"><i>{
  Here 's the data being shared between the two programs. 
  I've declared a record with a string and an integer, but
  it wouldn't matter what the contents of this record 
  happened to be. The fields could be of virtually any type
  and could contain any type of data.
}
</i></font><font color="#FF0000"><b>Interface
Type
  </b></font>TData <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>I<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Implementation
end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0030.PAS">Original</a><b>]</b></p></body>
</html>
