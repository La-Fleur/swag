<html>
<head><title> "Operating Modes" by FRED JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
If you ever wanted to tell what Operating System Mode you are using,
this /ditty/ will do the trick.  It sets a global integer to a value
which represents the Mode being used.  There is also a demo_prog at the
end of the unit.
}

</i></font><font color="#FF0000"><b>unit </b></font>mode<font color="#000080">;

</font><font color="#FF0000"><b>interface

var
  </b></font>OperatingMode <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#008000"><i>{ This integer holds a value of 0, 1, 2 or 3, which is an indicator
  if the machine is in:
    Dos Mode              (0),
    Windows Standard Mode (1),
    Windows Enhanced Mode (2),
    DESQview mode         (3); }
</i></font><font color="#FF0000"><b>implementation

function </b></font>wincheck <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 asm
   </b></font><font color="#FF00FF">mov  ax,   $4680
   int  $2f
   mov  dl,   $1
   or   ax,   ax
   jz   @finished
   mov  ax,   $1600
   int  $2f
   mov  dl,   $2
   or   al,   al
   jz   @Not_Win
   cmp  al,   $80
   jne  @finished
  @Not_Win:
   mov  ax,   $1022
   mov  bx,   $0
   int  $15
   mov  dl,   $3
   cmp  bx,   $0a01
   je   @finished
   xor  dl,   dl
  @finished:
   xor  ah,   ah
   mov  al,   dl
   mov  @Result, ax
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>OperatingMode <font color="#000080">:= </font>Wincheck<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>program </b></font>Use_Mode<font color="#000080">;

</font><font color="#FF0000"><b>uses
  </b></font>mode<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>xModeStringArr <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">] =
     (</font><font color="#800000">'Dos Mode'</font><font color="#000080">, </font><font color="#800000">'Windows Standard'</font><font color="#000080">, </font><font color="#800000">'Windows Enhanced'</font><font color="#000080">, </font><font color="#800000">'DESQview Mode'</font><font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>Write<font color="#000080">(</font>xModeStringArr<font color="#000080">[</font>OperatingMode<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
