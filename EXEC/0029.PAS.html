<html>
<head><title> "DOS Redirection" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 RG&gt; I am writing a simple program which executes other programs. I am using
 RG&gt; the function

 RG&gt; EXEC(ProgramName,CmdLine)

 RG&gt; which is working just fine. However, I would like to somehow prevent the
 RG&gt; executed program from writing to the screen, rather I just want to display
 RG&gt; in my program something like

 RG&gt; Working...

 RG&gt; While still maintaining the screen which the program is using for output.
 RG&gt; So my questions is, how would I go about doing this?

Try this unit! }

</i></font><font color="#FF0000"><b>unit </b></font>Redir<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
 </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SetOutput<font color="#000080">(</font>FileName<font color="#000080">: </font>PathStr<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>CancelOutput<font color="#000080">;

</font><font color="#FF0000"><b>implementation

const
 </b></font>OutRedir<font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SetOutput<font color="#000080">(</font>FileName<font color="#000080">: </font>PathStr<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>FileName<font color="#000080">:=</font>FileName<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
 </font>SetOutput<font color="#000080">:=</font>False<font color="#000080">;
 </font><font color="#FF0000"><b>asm
</b></font><font color="#FF00FF">push ds
mov  ax, ss
mov  ds, ax
lea  dx, FileName[1]
mov  ah, 3Ch
int  21h
pop  ds
jnc  @@1
ret
@@1:
push ax
mov  bx, ax
mov  cx, Output.FileRec.Handle
mov  ah, 46h
int  21h
mov  ah, 3Eh
pop  bx
jnc  @@2
ret
@@2:
int  21h
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>OutRedir<font color="#000080">:=</font>True<font color="#000080">;
 </font>SetOutput<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CancelOutput<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
 if not </b></font>OutRedir <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
 </font>FileName<font color="#000080">:=</font><font color="#800000">'CON'#0</font><font color="#000080">;
 </font><font color="#FF0000"><b>asm
</b></font><font color="#FF00FF">push ds
mov  ax, ss
mov  ds, ax
lea  dx, FileName[1]
mov  ax, 3D01h
int  21h
pop  ds
jnc  @@1
ret
@@1:
push ax
mov  bx, ax
mov  cx, Output.FileRec.Handle
mov  ah, 46h
int  21h
mov  ah, 3Eh
pop  bx
int  21h
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>OutRedir<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>________________

Standard output will be changed <font color="#FF0000"><b>to </b></font>FileName<font color="#000080">. </font>The FileName can be NUL<font color="#000080">. </font>When your
executed <font color="#FF0000"><b>program is </b></font>using int <font color="#800000">$10</font><font color="#000080">, </font>all <font color="#FF0000"><b>is </b></font>hardly<font color="#000080">. </font><font color="#FF0000"><b>In </b></font>your main <font color="#FF0000"><b>program </b></font>use<font color="#000080">:

</font>SetOutput<font color="#000080">(</font><font color="#800000">'NUL'</font><font color="#000080">);
</font>Exec<font color="#000080">(....);
</font>CancelOutput<font color="#000080">;

 </font><font color="#008000"><i>{change the dos prompt when Shelling to DOS without
 having to change the current or master enviroment(It makes it's own).}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
