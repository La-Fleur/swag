<html>
<head><title> "Yet Another Window Shell" by TOM CARROLL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
-&gt; I seen some code posted here a few weeks ago. I meant to save it,
-&gt; but didn't.  The code creates a windowed DOS shell.  I would like
-&gt; to simply run a .BAT installation file in a window from my pascal
-&gt; program.

Here's some code that I posted.  Maybe this is what you were talking
about:
}

(* Written by Tom Carroll, Nov 24, 1993.

   Adapted from the example code posted by Kelly Small in the FidoNet
   Pascal echo 11/19/93.

   Released to the Public Domain 11/24/93.

   Please give credit where credit is due

   This unit will execute a program within a text window
   and all program scrolling will be maintained within
   the window.

   11-24-93 - Initial release /twc/
   11-29-93 - Added code to allow for multiple border styles,
              color usage, window titles, and screen save/restore
              under the window. /twc/

   FUTURE PLANS:  To add a check for the video mode and adjust the
                  window boundary checking accordingly.
*)

</i></font><font color="#FF0000"><b>UNIT </b></font>ExecTWin<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

FUNCTION </b></font>ExecWin<font color="#000080">(</font>ProgName<font color="#000080">, </font>Params<font color="#000080">, </font>Title <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                 </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">, </font>RightCol<font color="#000080">, </font>BottomLine<font color="#000080">,
                 </font>ForeColor<font color="#000080">, </font>BackColor<font color="#000080">, </font>ForeBorder<font color="#000080">, </font>BackBorder<font color="#000080">,
                 </font>Border<font color="#000080">, </font>ForeTitle<font color="#000080">, </font>BackTitle <font color="#000080">: </font>WORD<font color="#000080">) : </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

USES
   </b></font>Dos<font color="#000080">,
   </font>Crt<font color="#000080">,
   </font>ScrnCopy<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>OldIntVect <font color="#000080">: </font>POINTER<font color="#000080">;

</font><font color="#008000"><i>{$F+}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Int29Handler<font color="#000080">(</font>AX<font color="#000080">, </font>BX<font color="#000080">, </font>CX<font color="#000080">, </font>DX<font color="#000080">, </font>SI<font color="#000080">, </font>DI<font color="#000080">, </font>DS<font color="#000080">, </font>ES<font color="#000080">, </font>BP <font color="#000080">: </font>WORD<font color="#000080">); </font>INTERRUPT<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>Dummy <font color="#000080">: </font>BYTE<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font>Lo<font color="#000080">(</font>AX<font color="#000080">)));         </font><font color="#008000"><i>{write each character to screen}
   </i></font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">Sti; </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>HookInt29<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>GetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">, </font>OldIntVect<font color="#000080">);               </font><font color="#008000"><i>{ Save the old vector }
   </i></font>SetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">, @</font>Int29Handler<font color="#000080">);            </font><font color="#008000"><i>{ Install interrupt handler }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>ExecWin<font color="#000080">(</font>ProgName<font color="#000080">, </font>Params<font color="#000080">, </font>Title <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                 </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">, </font>RightCol<font color="#000080">, </font>BottomLine<font color="#000080">,
                 </font>ForeColor<font color="#000080">, </font>BackColor<font color="#000080">, </font>ForeBorder<font color="#000080">, </font>BackBorder<font color="#000080">,
                 </font>Border<font color="#000080">, </font>ForeTitle<font color="#000080">, </font>BackTitle <font color="#000080">: </font>WORD<font color="#000080">) : </font>WORD<font color="#000080">;

</font><font color="#008000"><i>{
  ProgName   = Program name to execute (must includes the full path)
  Params     = Program parameters passed to child process
  Title      = Title assigned to the text window (unused if blank)
  LeftCol    = Left column of the window border
  TopLine    = Top line of the window border
  RightCol   = Right column of the window border
  BottomLine = Bottom line of the window border
  ForeColor  = Foreground color of the window
  BackColor  = Background color of the window
  ForeBorder = Foreground color of the window border
  BackBorder = Background color of the window border
  Border     = Border type to use.  Where type is:
                0 - None used
                1 - '+'
                2 - '+'
                3 - '#'
                4 - '+'
  ForeTitle  = Foreground color of the window title
  BackTitle  = Background color of the window title

  If an error is encountered, the program will return the following
  error codes in the ExecWin variable.

      97 - Title wider than the window
      98 - The left or right screen margins have been exceeded
      99 - The top or bottom screen margins have been exceeded
}

</i></font><font color="#FF0000"><b>LABEL
   </b></font>ExitExec<font color="#000080">;

</font><font color="#FF0000"><b>VAR
   </b></font>A <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   IF </b></font><font color="#000080">(</font>LeftCol <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>RightCol <font color="#000080">&gt; </font><font color="#800000">80</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">98</font><font color="#000080">;
         </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>TopLine <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>BottomLine <font color="#000080">&gt; </font><font color="#800000">24</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">99</font><font color="#000080">;
         </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>SaveScrn<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
   </font>TextColor<font color="#000080">(</font>ForeBorder<font color="#000080">);
   </font>TextBackground<font color="#000080">(</font>BackBorder<font color="#000080">);
   </font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">);
   </font><font color="#FF0000"><b>CASE </b></font>Border <font color="#FF0000"><b>OF
      </b></font><font color="#800000">1 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>BottomLine <font color="#000080">- </font>TopLine<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                BEGIN
                   </b></font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>RightCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>BottomLine<font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>IF </b></font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                IF </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) &lt;= (</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) </font><font color="#FF0000"><b>THEN
                   BEGIN
                      </b></font>A <font color="#000080">:= </font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                      </font>A <font color="#000080">:= </font>RightCol <font color="#000080">- </font>LeftCol <font color="#000080">- </font>A<font color="#000080">;
                      </font>A <font color="#000080">:= </font>A <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>A <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">+ </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">'+ '</font><font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeTitle<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackTitle<font color="#000080">);
                      </font>Write<font color="#000080">(</font>Title<font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeBorder<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackBorder<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">' +'</font><font color="#000080">);
                   </font><font color="#FF0000"><b>END
                ELSE
                   BEGIN
                      </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">97</font><font color="#000080">;
                      </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>BottomLine <font color="#000080">- </font>TopLine<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                BEGIN
                   </b></font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>RightCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>BottomLine<font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>IF </b></font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                IF </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) &lt;= (</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) </font><font color="#FF0000"><b>THEN
                   BEGIN
                      </b></font>A <font color="#000080">:= </font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                      </font>A <font color="#000080">:= </font>RightCol <font color="#000080">- </font>LeftCol <font color="#000080">- </font>A<font color="#000080">;
                      </font>A <font color="#000080">:= </font>A <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>A <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">+ </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">'+ '</font><font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeTitle<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackTitle<font color="#000080">);
                      </font>Write<font color="#000080">(</font>Title<font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeBorder<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackBorder<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">' +'</font><font color="#000080">);
                   </font><font color="#FF0000"><b>END
                ELSE
                   BEGIN
                      </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">97</font><font color="#000080">;
                      </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#800000">3 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>BottomLine <font color="#000080">- </font>TopLine<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                BEGIN
                   </b></font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>RightCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>BottomLine<font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'#'</font><font color="#000080">);
             </font><font color="#FF0000"><b>IF </b></font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                IF </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) &lt;= (</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) </font><font color="#FF0000"><b>THEN
                   BEGIN
                      </b></font>A <font color="#000080">:= </font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                      </font>A <font color="#000080">:= </font>RightCol <font color="#000080">- </font>LeftCol <font color="#000080">- </font>A<font color="#000080">;
                      </font>A <font color="#000080">:= </font>A <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>A <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">+ </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">'# '</font><font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeTitle<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackTitle<font color="#000080">);
                      </font>Write<font color="#000080">(</font>Title<font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeBorder<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackBorder<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">' #'</font><font color="#000080">);
                   </font><font color="#FF0000"><b>END
                ELSE
                   BEGIN
                      </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">97</font><font color="#000080">;
                      </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#800000">4 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>BottomLine <font color="#000080">- </font>TopLine<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                BEGIN
                   </b></font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>RightCol<font color="#000080">, </font>TopLine <font color="#000080">+ </font>A<font color="#000080">);
                   </font>Write<font color="#000080">(</font><font color="#800000">'|'</font><font color="#000080">);
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>GotoXY<font color="#000080">(</font>LeftCol<font color="#000080">, </font>BottomLine<font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>FOR </b></font>A <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">);
             </font>Write<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">);
             </font><font color="#FF0000"><b>IF </b></font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                IF </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])) &lt;= (</font>RightCol <font color="#000080">- </font>LeftCol<font color="#000080">) </font><font color="#FF0000"><b>THEN
                   BEGIN
                      </b></font>A <font color="#000080">:= </font>Ord<font color="#000080">(</font>Title<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
                      </font>A <font color="#000080">:= </font>RightCol <font color="#000080">- </font>LeftCol <font color="#000080">- </font>A<font color="#000080">;
                      </font>A <font color="#000080">:= </font>A <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>A <font color="#000080">- </font><font color="#800000">2 </font><font color="#000080">+ </font>LeftCol<font color="#000080">, </font>TopLine<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">'| '</font><font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeTitle<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackTitle<font color="#000080">);
                      </font>Write<font color="#000080">(</font>Title<font color="#000080">);
                      </font>TextColor<font color="#000080">(</font>ForeBorder<font color="#000080">);
                      </font>TextBackground<font color="#000080">(</font>BackBorder<font color="#000080">);
                      </font>Write<font color="#000080">(</font><font color="#800000">' |'</font><font color="#000080">);
                   </font><font color="#FF0000"><b>END
                ELSE
                   BEGIN
                      </b></font>ExecWin <font color="#000080">:= </font><font color="#800000">97</font><font color="#000080">;
                      </font><font color="#FF0000"><b>GOTO </b></font>ExitExec<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>TextColor<font color="#000080">(</font>ForeColor<font color="#000080">);
   </font>TextBackground<font color="#000080">(</font>BackColor<font color="#000080">);
   </font>Window<font color="#000080">(</font>LeftCol <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>TopLine <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>RightCol <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>BottomLine <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
   </font>ClrScr<font color="#000080">;
   </font>HookInt29<font color="#000080">;
   </font>SwapVectors<font color="#000080">;
   </font>Exec<font color="#000080">(</font>ProgName<font color="#000080">, </font>Params<font color="#000080">);
   </font>SwapVectors<font color="#000080">;
   </font>ExecWin <font color="#000080">:= </font>DOSExitCode<font color="#000080">;
   </font>SetIntVec<font color="#000080">(</font><font color="#800000">$29</font><font color="#000080">,</font>OldIntVect<font color="#000080">); </font><font color="#008000"><i>{ Restore the interrupt }
   </i></font>Window<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
   </font>RestoreScrn<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);

   </font>ExitExec<font color="#000080">:

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{
The ScrnCopy unit may be found within the SWAG files or you can make up
your own.

Tom Carroll
Dataware Software
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
