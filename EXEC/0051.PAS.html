<html>
<head><title> "Return the size of the exe file" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{

   Returns the size of the executable: not the size of the file but
   the size of the EXE by consulting the header of the executable


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;

}

</i></font><font color="#FF0000"><b>Function  </b></font>ExeSize <font color="#000080">(</font>sFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>ImageInfo <font color="#000080">: </font><font color="#FF0000"><b>Record
        </b></font>ExeID     <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[ </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1 </font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
        </font>Remainder <font color="#000080">: </font>Word<font color="#000080">;
        </font>Size      <font color="#000080">: </font>Word
     <font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>FichS    <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin

  </b></font>Assign <font color="#000080">(</font>FichS<font color="#000080">, </font>sFile<font color="#000080">);
  </font>FileMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Reset <font color="#000080">(</font>FichS<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#FF0000"><b>If </b></font>Ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
     </b></font>ExeSize <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>Else
     Begin

        </b></font><font color="#008000"><i>{ Get the EXE header }

        </i></font>BlockRead <font color="#000080">(</font>FichS<font color="#000080">, </font>ImageInfo<font color="#000080">, </font>Sizeof <font color="#000080">(</font>ImageInfo<font color="#000080">));

        </font><font color="#008000"><i>{ Check the two first bytes: should be MZ for a DOS executable. }

        </i></font><font color="#FF0000"><b>If </b></font>ImageInfo<font color="#000080">.</font>ExeID <font color="#000080">&lt;&gt; </font><font color="#800000">'MZ' </font><font color="#FF0000"><b>Then
           </b></font>ExeSize <font color="#000080">:= </font><font color="#800000">0
        </font><font color="#FF0000"><b>Else
           </b></font>ExeSize <font color="#000080">:= </font>LongInt <font color="#000080">(</font>ImageInfo<font color="#000080">.</font>size<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">9 </font><font color="#000080">+ </font>ImageInfo<font color="#000080">.</font>Remainder<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p></body>
</html>
