<html>
<head><title> "Menu System" by MIKE PERRY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 GG&gt; Could somebody post a message with the Pascal 6.0 source for some
 GG&gt; sort of a scrolling menu system?  I do NOT want TurboVision.  I
 GG&gt; HATE OOP.  I don't mind records and arrays, but i don't want OOP.
 GG&gt; I've done some programming for one myself....
}

</i></font><font color="#FF0000"><b>UNIT </b></font>MPMENU<font color="#000080">;
</font><font color="#008000"><i>{
 Written and designed by Michael Perry, (c) 1990 Progressive Computer Serv.

 A basic, flexible, user-definable menu system using only the most basic
 functions in Turbo Pascal.  This unit is easily integratable into your
 applications and gives you more versatility than most &quot;pull down&quot;-type
 menu interfaces.

 License:  This unit should NOT be modified and redistributed in source
           or object/TPU form.  You can modify and use this in any non-
           commercial program free-of-charge provided that &quot;Mike Perry&quot;
           if credited either in the program or documentation.  Use of
           these routines in a commercially-sold package requires a
           one-time registration fee of $30 to be sent to:

             Progressive Computer Services
             P.O. Box 7638
             Metairie, LA 70010

           Non-commercial users are also invited to register the code.
           This insures that updates and future revisions are made
           available and users are kept informed via mail.


 Usage:    Implementing menus using the MPMENU unit involves just a
           few basic steps.  At any point in your program, add code
           to perform the following actions:

              1.  Define the menu by assigning values to the MENU_DATA
                  record.
              2.  Call the procedure MENU(MENU_DATA,RETURNCODE);
              3.  Implement a routine to evaluate the value of
                  RETURNCODE and act accordingly.  The values of
                  RETURNCODE are as follows:
                    0   = ESC pressed (menu aborted)
                    1-x = The appropriate option was selected, with 1
                          being the first menu choice, 2 the second,
                          etc.

 Example:  Here is a sample main menu using the MENU procedure:
-----------------------------------------------------------------------------
   Program DontDoMuch;
   Uses Crt,MPMenu;

   CONST     HELL_FREEZES_OVER=FALSE;
   VAR       CHOICE:BYTE;

   Begin
     REPEAT

     With Menu_Data Do Begin
       Menu_Choices[1]:='1 - First Option ';    - define menu choice onscreen
       Row[1]:=10; Column[1]:=30;               - where on screen displayed
       Menu_Choices[2]:='2 - Second Option';    - same thing for 2nd choice
       Row[2]:=12; Column[2]:=30;                 .
       Menu_Choices[3]:='X - Exit Program ';      .
       Row[3]:=14; Column[3]:=30;                 .
       Onekey:=TRUE;                            - enable 1-key execution
       Num_Choices:=3;                          - number of menu choices
       HiLighted:=112;                          - highlighted attribute
       Normal:=7;                               - normal attribute
     End;

     MENU(MENU_DATA,CHOICE);          - call the menu now and wait for user

     Case Choice Of                   - evaluate user response and act
       0:Halt;                        - ESC pressed
       3:Halt;                        - option 3, Exit, selected
       1:Begin
           - put code here to do menu option 1
         End;
       2:Begin
           - put code here to do menu option 2
         End;
     End

     UNTIL HELL_FREEZES_OVER;          - infinite loop - back to main menu
End.
-----------------------------------------------------------------------------
}
</i></font><font color="#FF0000"><b>INTERFACE

  USES </b></font>Crt<font color="#000080">;

  </font><font color="#FF0000"><b>CONST
    </b></font>MAX_CHOICES <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;                            </font><font color="#008000"><i>{ MAX_CHOICES can be changed
                                                   depending upon the highest
                                                   number of options you will
                                                   have on any given menu }

  </i></font><font color="#FF0000"><b>TYPE
    </b></font>MENU_ARRAY <font color="#000080">= </font><font color="#FF0000"><b>RECORD                          </b></font><font color="#008000"><i>{ record structure for menu }
      </i></font>MENU_CHOICES <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAX_CHOICES<font color="#000080">] </font><font color="#FF0000"><b>OF STRING</b></font><font color="#000080">[</font><font color="#800000">50</font><font color="#000080">];  </font><font color="#008000"><i>{ displayed option }
      </i></font>COLUMN       <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAX_CHOICES<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;        </font><font color="#008000"><i>{ column location }
      </i></font>ROW          <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAX_CHOICES<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;  </font><font color="#008000"><i>{ row location }
      </i></font>NUM_CHOICES  <font color="#000080">: </font>BYTE<font color="#000080">;                           </font><font color="#008000"><i>{ # choices on menu }
      </i></font>HILIGHTED    <font color="#000080">: </font>WORD<font color="#000080">;                           </font><font color="#008000"><i>{ attribute for hilight }
      </i></font>NORMAL       <font color="#000080">: </font>WORD<font color="#000080">;                           </font><font color="#008000"><i>{ attributed for normal }
      </i></font>ONEKEY       <font color="#000080">: </font>BOOLEAN<font color="#000080">;                        </font><font color="#008000"><i>{ TRUE for 1-key execution
}
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>VAR
    </b></font>MENU_DATA <font color="#000080">: </font>MENU_ARRAY<font color="#000080">;                      </font><font color="#008000"><i>{ global menu variable }

{
  NOTE:  You can define many menu variables simultaneously, but since you
         can generally use only one menu at a time, you can conserve
         memory and program space by re-defining this one MENU_DATA record
         each time a menu is to be displayed.
}

{ internal procedures }
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>SHOW_MENU<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">);
  </font><font color="#FF0000"><b>PROCEDURE </b></font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font>CHOICENUM<font color="#000080">:</font>BYTE<font color="#000080">);
  </font><font color="#FF0000"><b>PROCEDURE </b></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font>CHOICENUM<font color="#000080">:</font>BYTE<font color="#000080">);
  </font><font color="#FF0000"><b>FUNCTION </b></font>GETKEY<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>FUNCTIONKEY<font color="#000080">:</font>BOOLEAN<font color="#000080">):</font>CHAR<font color="#000080">;
  </font><font color="#FF0000"><b>FUNCTION </b></font>FOUND_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>EXITCODE<font color="#000080">:</font>BYTE<font color="#000080">;</font>CH<font color="#000080">:</font>CHAR<font color="#000080">):</font>BOOLEAN<font color="#000080">;

</font><font color="#008000"><i>{ basically, the ONE callable procedure }
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>MENU<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>EXITCODE<font color="#000080">:</font>BYTE<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION


</b></font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SHOW_MENU<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">);
</font><font color="#008000"><i>{ display defined menu array }
</i></font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">:</font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>TEXTATTR<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>NORMAL<font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO BEGIN
    </b></font>GOTOXY<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>COLUMN<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>MENU_DATA<font color="#000080">.</font>ROW<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
    </font>WRITE<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font>CHOICENUM<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#008000"><i>{ highlight the appropriate menu choice }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GOTOXY<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>COLUMN<font color="#000080">[</font>CHOICENUM<font color="#000080">],</font>MENU_DATA<font color="#000080">.</font>ROW<font color="#000080">[</font>CHOICENUM<font color="#000080">]);
  </font>TEXTATTR<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>HILIGHTED<font color="#000080">;
  </font>WRITE<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font>CHOICENUM<font color="#000080">]);
  </font><font color="#008000"><i>{ below needed if direct screen writing not done }
  </i></font>GOTOXY<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>COLUMN<font color="#000080">[</font>CHOICENUM<font color="#000080">],</font>MENU_DATA<font color="#000080">.</font>ROW<font color="#000080">[</font>CHOICENUM<font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font>CHOICENUM<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#008000"><i>{ highlight the appropriate menu choice }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GOTOXY<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>COLUMN<font color="#000080">[</font>CHOICENUM<font color="#000080">],</font>MENU_DATA<font color="#000080">.</font>ROW<font color="#000080">[</font>CHOICENUM<font color="#000080">]);
  </font>TEXTATTR<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>NORMAL<font color="#000080">;
  </font>WRITE<font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font>CHOICENUM<font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>GETKEY<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>FUNCTIONKEY<font color="#000080">:</font>BOOLEAN<font color="#000080">):</font>CHAR<font color="#000080">;
</font><font color="#008000"><i>{ read keyboard and return character/function key }
</i></font><font color="#FF0000"><b>VAR </b></font>CH<font color="#000080">: </font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CH<font color="#000080">:=</font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>CH<font color="#000080">=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>CH<font color="#000080">:=</font>ReadKey<font color="#000080">;
      </font>FUNCTIONKEY<font color="#000080">:=</font>TRUE<font color="#000080">;
    </font><font color="#FF0000"><b>END
  ELSE </b></font>FUNCTIONKEY<font color="#000080">:=</font>FALSE<font color="#000080">;
  </font>GETKEY<font color="#000080">:=</font>CH<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>FOUND_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>EXITCODE<font color="#000080">:</font>BYTE<font color="#000080">;</font>CH<font color="#000080">:</font>CHAR<font color="#000080">):</font>BOOLEAN<font color="#000080">;
</font><font color="#008000"><i>{ locate next occurance of menu choice starting with char CH }
</i></font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">:</font>BYTE<font color="#000080">; </font>TEMP<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CH<font color="#000080">:=</font>UPCASE<font color="#000080">(</font>CH<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">=</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES <font color="#FF0000"><b>THEN BEGIN
    </b></font>TEMP<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
    </font><font color="#FF0000"><b>IF </b></font>UPCASE<font color="#000080">(</font>TEMP<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])=</font>CH <font color="#FF0000"><b>THEN BEGIN
      </b></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
      </font>EXITCODE<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
      </font>FOUND_CHOICE<font color="#000080">:=</font>TRUE<font color="#000080">;
      </font>EXIT<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font>EXITCODE<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES <font color="#FF0000"><b>DO BEGIN
    </b></font>TEMP<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font>I<font color="#000080">];
    </font><font color="#FF0000"><b>IF </b></font>UPCASE<font color="#000080">(</font>TEMP<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])=</font>CH <font color="#FF0000"><b>THEN BEGIN
      </b></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
      </font>EXITCODE<font color="#000080">:=</font>I<font color="#000080">;
      </font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
      </font>FOUND_CHOICE<font color="#000080">:=</font>TRUE<font color="#000080">;
      </font>EXIT<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN BEGIN             </b></font><font color="#008000"><i>{ KILLER RECURSION }
    </i></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
    </font>EXITCODE<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>FOUND_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">,</font>CH<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
      </font>FOUND_CHOICE<font color="#000080">:=</font>TRUE<font color="#000080">;
      </font>EXIT<font color="#000080">;
    </font><font color="#FF0000"><b>END ELSE </b></font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
  </font><font color="#FF0000"><b>END ELSE BEGIN
    </b></font>TEMP<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>MENU_CHOICES<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
    </font><font color="#FF0000"><b>IF </b></font>UPCASE<font color="#000080">(</font>TEMP<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])=</font>CH <font color="#FF0000"><b>THEN BEGIN
      </b></font>FOUND_CHOICE<font color="#000080">:=</font>TRUE<font color="#000080">;
      </font>EXIT<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>FOUND_CHOICE<font color="#000080">:=</font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MENU<font color="#000080">(</font>MENU_DATA<font color="#000080">:</font>MENU_ARRAY<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>EXITCODE<font color="#000080">:</font>BYTE<font color="#000080">);
</font><font color="#008000"><i>{ display menu and return user's response:
   0   = ESC pressed
   1-x = appropriate choice selected

   during operation, variable EXITCODE holds number of currently-selected
   menu choice.
}
</i></font><font color="#FF0000"><b>VAR
  </b></font>FNC<font color="#000080">:</font>BOOLEAN<font color="#000080">; </font>TEMPATTR<font color="#000080">:</font>WORD<font color="#000080">;
  </font>CH<font color="#000080">:</font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>TEMPATTR<font color="#000080">:=</font>TEXTATTR<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>EXITCODE<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>EXITCODE<font color="#000080">&gt;</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES<font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>EXITCODE<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>SHOW_MENU<font color="#000080">(</font>MENU_DATA<font color="#000080">);
  </font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>CH<font color="#000080">:=</font>GETKEY<font color="#000080">(</font>FNC<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>FNC <font color="#FF0000"><b>THEN BEGIN
      IF </b></font>CH<font color="#000080">=</font><font color="#800000">#77 </font><font color="#FF0000"><b>THEN </b></font>CH<font color="#000080">:=</font><font color="#800000">#80 </font><font color="#FF0000"><b>ELSE
      IF </b></font>CH<font color="#000080">=</font><font color="#800000">#75 </font><font color="#FF0000"><b>THEN </b></font>CH<font color="#000080">:=</font><font color="#800000">#72</font><font color="#000080">;

      </font><font color="#FF0000"><b>CASE </b></font>CH <font color="#FF0000"><b>OF
        </b></font><font color="#800000">#72</font><font color="#000080">:</font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN BEGIN                              </b></font><font color="#008000"><i>{ UP }
              </i></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
              </font>EXITCODE<font color="#000080">:=</font>EXITCODE<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">#80</font><font color="#000080">:</font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">&lt;</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES <font color="#FF0000"><b>THEN BEGIN          </b></font><font color="#008000"><i>{ DOWN }
              </i></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
              </font>EXITCODE<font color="#000080">:=</font>EXITCODE<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">#71</font><font color="#000080">:</font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN BEGIN                             </b></font><font color="#008000"><i>{ HOME }
              </i></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
              </font>EXITCODE<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">#79</font><font color="#000080">:</font><font color="#FF0000"><b>IF </b></font>EXITCODE<font color="#000080">&lt;</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES <font color="#FF0000"><b>THEN BEGIN          </b></font><font color="#008000"><i>{ END }
              </i></font>UNHILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
              </font>EXITCODE<font color="#000080">:=</font>MENU_DATA<font color="#000080">.</font>NUM_CHOICES<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ functionkey CASE }
      </i></font>HILIGHT_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">);
    </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{ if FNC }

    </i></font><font color="#FF0000"><b>ELSE
      CASE </b></font>CH <font color="#FF0000"><b>OF
        </b></font><font color="#800000">#27</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
              </b></font>EXITCODE<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
              </font>TEXTATTR<font color="#000080">:=</font>TEMPATTR<font color="#000080">;
              </font>EXIT<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">#13</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
              </b></font>TEXTATTR<font color="#000080">:=</font>TEMPATTR<font color="#000080">;
              </font>EXIT<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>ELSE
        IF </b></font>FOUND_CHOICE<font color="#000080">(</font>MENU_DATA<font color="#000080">,</font>EXITCODE<font color="#000080">,</font>CH<font color="#000080">) </font><font color="#FF0000"><b>THEN
          IF </b></font><font color="#000080">(</font>MENU_DATA<font color="#000080">.</font>ONEKEY<font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
            </b></font>TEXTATTR<font color="#000080">:=</font>TEMPATTR<font color="#000080">;
            </font>EXIT<font color="#000080">;
          </font><font color="#FF0000"><b>END ELSE </b></font><font color="#008000"><i>{ nothing }
        </i></font><font color="#FF0000"><b>ELSE
</b></font><font color="#008000"><i>{          BEGIN
            GOTOXY(1,20);  used for debugging
            WRITELN('FNC=',FNC,'      KEYVAL=',ORD(CH));
          END;
 }
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
  </i></font><font color="#FF0000"><b>UNTIL </b></font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>(*===========================================================================*)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{ of unit MPMENU }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0025.PAS">Original</a><b>]</b></p></body>
</html>
