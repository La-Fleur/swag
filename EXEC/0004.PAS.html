<html>
<head><title> "Demonstrates DOS Exec" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$M 8192,0,0}
{* This memory directive is used to make
   certain there is enough memory left
   to execute the DOS shell and any
   other programs needed.  *}

</i></font><font color="#FF0000"><b>Program </b></font>EXEC_Demo<font color="#000080">;

</font><font color="#008000"><i>{*

  EXEC.PAS

  This program demonstrates the use of
  Pascal's EXEC function to execute
  either an individual DOS command or
  to move into a DOS Shell.

  You may enter any command you could
  normally enter at a DOS prompt and
  it will execute.  You may also hit
  RETURN without entering anything and
  you will enter into a DOS Shell, from
  which you can exit by typing EXIT.

  The program stops when you hit a
  'Q', upper or lower case.
*}


</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Command <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{**************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>Do_Exec<font color="#000080">; </font><font color="#008000"><i>{*******************}

  </i></font><font color="#FF0000"><b>Var
    </b></font>Ch <font color="#000080">: </font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    If </b></font>Command <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>Then
      </b></font>Command <font color="#000080">:= </font><font color="#800000">'/C' </font><font color="#000080">+ </font>Command
    <font color="#FF0000"><b>Else
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Type EXIT to return from the DOS Shell.'</font><font color="#000080">);
    </font><font color="#008000"><i>{* The /C prefix is needed to
       execute any command other than
       the complete DOS Shell. *}

    </i></font>SwapVectors<font color="#000080">;
    </font>Exec<font color="#000080">(</font>GetEnv<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">), </font>Command<font color="#000080">);
    </font><font color="#008000"><i>{* GetEnv is used to read COMSPEC
       from the DOS environment so the
       program knows the correct path
       to COMMAND.COM. *}

    </i></font>SwapVectors<font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'DOS Error = '</font><font color="#000080">,</font>DosError<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Could not execute COMMAND.COM'</font><font color="#000080">);
    </font><font color="#008000"><i>{* We're assuming that the only
       reason DosError would be something
       other than 0 is if it couldn't
       find the COMMAND.COM, but there
       are other errors that can occur,
       we just haven't provided for them
       here. *}

    </i></font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Hit any key to continue...'</font><font color="#000080">);
    </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Get_Command <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>Count <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Cmnd <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Clrscr<font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">'Enter DOS Command (or Q to Quit): '</font><font color="#000080">);
    </font>Readln<font color="#000080">(</font>Cmnd<font color="#000080">);
    </font>Get_Command <font color="#000080">:= </font>Cmnd
  <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Command <font color="#000080">:= </font>Get_Command<font color="#000080">;
  </font><font color="#FF0000"><b>While NOT </b></font><font color="#000080">((</font>Command <font color="#000080">= </font><font color="#800000">'Q'</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Command <font color="#000080">= </font><font color="#800000">'q'</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
    Begin
      </b></font>Do_Exec<font color="#000080">;
      </font>Command <font color="#000080">:= </font>Get_Command
    <font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
