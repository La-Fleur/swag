<html>
<head><title> "Multiple DOS Calls" by FRANK DIACHEYSN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  Coded By Frank Diacheysn Of Gemini Software

  FUNCTION MASSEXEC

  Input......: DOS Command Line(s)
             :
             :
             :
             :

  Output.....: Logical
             :        TRUE  = No Errors During Execution
             :        FALSE = Error Occured During Execution
             :
             :

  Example....: IF MASSEXEC('DIR,PAUSE') THEN
             :   WriteLn('No Errors!')
             : ELSE
             :   WriteLn('DOS Error Occured!');
             :

  Description: Execute One Or More DOS Program Calls
             : (Seperate Calls With A Comma)
             :
             :
             :

}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>MASSEXEC<font color="#000080">( </font>S<font color="#000080">:</font><font color="#FF0000"><b>STRING </b></font><font color="#000080">):</font>BOOLEAN<font color="#000080">;
</font><font color="#008000"><i>{$M $4000,0,0}
</i></font><font color="#FF0000"><b>VAR </b></font>nCount <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>ExS    <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Ch     <font color="#000080">: </font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  REPEAT
    </b></font>nCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>ExS <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      </b></font>Inc<font color="#000080">(</font>nCount<font color="#000080">);
      </font>Ch <font color="#000080">:= </font>S<font color="#000080">[</font>nCount<font color="#000080">];
      </font><font color="#FF0000"><b>IF </b></font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">',' </font><font color="#FF0000"><b>THEN
        </b></font>ExS <font color="#000080">:= </font>ExS <font color="#000080">+ </font>Ch<font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Ch <font color="#000080">= </font><font color="#800000">','</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>nCount <font color="#000080">= </font>Length<font color="#000080">(</font>S<font color="#000080">));
    </font><font color="#FF0000"><b>IF </b></font>POS<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>S<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>S <font color="#000080">:= </font><font color="#800000">''
    </font><font color="#FF0000"><b>ELSE
      </b></font>DELETE<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>POS<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>S<font color="#000080">));
    </font>SWAPVECTORS<font color="#000080">;
    </font>EXEC<font color="#000080">( </font>GETENV<font color="#000080">(</font><font color="#800000">'COMSPEC'</font><font color="#000080">), </font><font color="#800000">'/C '</font><font color="#000080">+ </font>ExS <font color="#000080">);
    </font>SWAPVECTORS<font color="#000080">;
    </font>MASSEXEC <font color="#000080">:= </font>DOSERROR <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>S <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
