<html>
<head><title> "Display all info in EXE header" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
                 =======================================

                       EXE-HEAD (c) AVC Software
                               Cardware

                  Display all  informations  containing
                  in the EXE DOS header.

                 =======================================

   Display all informations containing in the EXE DOS header.



               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;


}

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Fich <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
    </font>Header <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">27</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Aide<font color="#000080">;

</font><font color="#FF0000"><b>Begin

   </b></font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">'Please specify the name of executable file.'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">'For exemple :  EXE-HEAD.EXE  EXEMPLE.EXE'</font><font color="#000080">);
   </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Word2Hex<font color="#000080">(</font>Number<font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>Hexa <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= (</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,</font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,</font><font color="#800000">'7'</font><font color="#000080">,</font><font color="#800000">'8'</font><font color="#000080">,
                                      </font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>Ch1 <font color="#000080">, </font>Ch2 <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Ch3 <font color="#000080">, </font>Ch4 <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin

  </b></font>Ch1 <font color="#000080">:= (</font>Number <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
  </font>Ch2 <font color="#000080">:= (</font>Number <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">) - (</font>Ch1 <font color="#FF0000"><b>shl </b></font><font color="#000080">(</font><font color="#800000">4</font><font color="#000080">));
  </font>Ch3 <font color="#000080">:= (</font>Number <font color="#FF0000"><b>AND </b></font><font color="#800000">$FF</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
  </font>Ch4 <font color="#000080">:= (</font>Number <font color="#FF0000"><b>AND </b></font><font color="#800000">$FF</font><font color="#000080">)- (</font>Ch3 <font color="#FF0000"><b>shl </b></font><font color="#000080">(</font><font color="#800000">4</font><font color="#000080">));

  </font>Word2Hex <font color="#000080">:= </font>Hexa<font color="#000080">[</font>Ch1<font color="#000080">]+</font>Hexa<font color="#000080">[</font>Ch2<font color="#000080">]+</font>Hexa<font color="#000080">[</font>Ch3<font color="#000080">]+</font>Hexa<font color="#000080">[</font>Ch4<font color="#000080">];

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Begin

     If </b></font><font color="#000080">((</font>ParamCount <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>Aide
     <font color="#FF0000"><b>Else Begin
          </b></font>Assign <font color="#000080">(</font>Fich<font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
          </font>Reset <font color="#000080">(</font>Fich<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
          </font>BlockRead <font color="#000080">(</font>Fich<font color="#000080">, </font>Header<font color="#000080">, </font><font color="#800000">28</font><font color="#000080">);
          </font>Close <font color="#000080">(</font>Fich<font color="#000080">);
          </font>ClrScr<font color="#000080">;
          </font>Writeln <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
          </font>Writeln <font color="#000080">(</font><font color="#800000">'&thorn; AVC Software, Inc.                         (c) Octobre 1994'</font><font color="#000080">);
          </font>Writeln <font color="#000080">(</font><font color="#800000">'&thorn; Exe-Head'</font><font color="#000080">);
          </font>WriteLn <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Chr<font color="#000080">(</font>Header<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) = </font><font color="#800000">'M'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Chr<font color="#000080">(</font>Header<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) = </font><font color="#800000">'Z'</font><font color="#000080">) </font><font color="#FF0000"><b>then Begin
            </b></font>WriteLn <font color="#000080">(</font><font color="#800000">'Signature du fichier                        : '</font><font color="#000080">,</font>Chr<font color="#000080">(</font>Header<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]),</font>Chr<font color="#000080">(</font>Header<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]));
            </font>WriteLn <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Taille de la derniäre page                  : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Nombres de pages                            : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'EntrÇes de la table de relocalisation       : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Paragraphes de l''en-tàte                    : '</font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'MINALLOC                                    : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'MAXALLOC                                    : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'ss initial                                  : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'sp initial                                  : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">17</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">16</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Total de contrìle                           : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">19</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">18</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'ip initial                                  : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">20</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'cs initial                                  : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">23</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">22</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Offset de la table de relocalisation        : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">24</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
            </font>WriteLn <font color="#000080">(</font><font color="#800000">'Nombre du segemnt de recouvrement           : ' </font><font color="#000080">,</font>Word2Hex<font color="#000080">((</font>Header<font color="#000080">[</font><font color="#800000">27</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">) + </font>Header<font color="#000080">[</font><font color="#800000">26</font><font color="#000080">]),</font><font color="#800000">'h'</font><font color="#000080">);
          </font><font color="#FF0000"><b>End
          Else </b></font>WriteLn <font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">' n''est pas un fichier de type .EXE'</font><font color="#000080">);
          </font>WriteLn <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EXEC SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p></body>
</html>
