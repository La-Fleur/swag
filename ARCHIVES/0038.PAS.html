<html>
<head><title> "Object Oriented Archive Viewers" by EDWIN GROOTHUIS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ OOAVTEST.PAS
  cut out each of the units below and compile to test the use of this package}

</i></font><font color="#FF0000"><b>uses      </b></font>OOAV<font color="#000080">,</font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>var       </b></font>a<font color="#000080">:</font>PArchive<font color="#000080">;
          </font>sr<font color="#000080">:</font>SearchRec<font color="#000080">;
          </font>DT<font color="#000080">:</font>DateTime<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'avail: '</font><font color="#000080">,</font>memavail<font color="#000080">);

  </font><font color="#008000"><i>{ It's not necessary that you call IdentifyArchive,
    but it's easy for checking when you've add new archive-types }
  </i></font><font color="#FF0000"><b>case </b></font>IdentifyArchive<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>of
    </b></font><font color="#800000">'?'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'Cannot open/identify current archive'</font><font color="#000080">);
    </font><font color="#800000">'Z'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'It''s a ZIP-archive'</font><font color="#000080">);
    </font><font color="#800000">'A'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'It''s an ARJ-archive'</font><font color="#000080">);
    </font><font color="#800000">'L'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'It''s an LZH-archive'</font><font color="#000080">);
    </font><font color="#800000">'C'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'It''s an ARC-archive'</font><font color="#000080">);
    </font><font color="#800000">'O'</font><font color="#000080">: </font>writeln<font color="#000080">(</font><font color="#800000">'It''s a ZOO-archive'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>a<font color="#000080">:=</font>New<font color="#000080">(</font>PArchive<font color="#000080">,</font>Init<font color="#000080">);
  </font><font color="#FF0000"><b>if not </b></font>a<font color="#000080">^.</font>Name<font color="#000080">(</font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Cannot open file'</font><font color="#000080">);
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Name'</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">'Size'</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">'Date'</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">'Time'</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">);
  </font>a<font color="#000080">^.</font>FindFirst<font color="#000080">(</font>sr<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>sr<font color="#000080">.</font>Name<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>do
  begin
    </b></font>write  <font color="#000080">(</font>sr<font color="#000080">.</font>Name<font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font>sr<font color="#000080">.</font>Size<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
    </font>UnpackTime<font color="#000080">(</font>sr<font color="#000080">.</font>Time<font color="#000080">,</font>DT<font color="#000080">);
    </font>writeln<font color="#000080">(</font>dt<font color="#000080">.</font>day<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,</font>dt<font color="#000080">.</font>month<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font>dt<font color="#000080">.</font>year<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>dt<font color="#000080">.</font>hour<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>dt<font color="#000080">.</font>min<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font>dt<font color="#000080">.</font>sec<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
    </font>a<font color="#000080">^.</font>FindNext<font color="#000080">(</font>sr<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Dispose<font color="#000080">(</font>A<font color="#000080">,</font>Done<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'End'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'avail: '</font><font color="#000080">,</font>memavail<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ the rest of the units follow }
{ CUT ----------------------------------------------------------- }

{
        Object-Oriented Archive-viewer, version 3
        &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
        This Object-Oriented Archive-viewer (OOAV) is copyright (c) by
        Edwin Groothuis, MavEtJu software. You are free to use it
        if you agree with these three rules:

        1. You tell me you're using this unit.

        2. You give me proper credit in the documentation. (Like:
           &quot;This program uses the Object-Oriented Archive-viewer
            (c) Edwin Groothuis, MavEtJu software&quot;.

        3. If you make Archive-objects for other archive-types, don't
           hesitate to inform me so I can add them to the unit and
           redistribute it!

        That's all!

        How to use this unit:
        &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
        (see also the file ArchTest.pas)

        - Declare a variable Arch of the       var Arch:TArchive;
          type TArchive                        begin
        - Call it's constructor                  Arch.Init;
        - Tell the unit which file you           if not Arch.Name('TEST.ZIP')
          want to view. This function            then begin
          returns a boolean. If this               writeln('TEST.ZIP is not
          boolean is false, then the                        a valid archive');
          file couldn't be identified              exit;
          as a valid archive.                    end;
        - Just like the dos-functions            Arch.FindFirst(sr);
          FindFirst and FindNext, you            while sr.Name&lt;&gt;'' do
          can search through the archive.        begin
          The parameter you give with it           writeln(sr.Name);
          is one of the SearchRec-type.            Arch.FindNext(sr);
          If there are no more files in          end;
          this archive, sr.Name will be
          empty. Valid fields are
          sr.Name, sr.Size and sr.Time
        - Call the destructor                    Arch.Done;
                                               end;

        - You can call the function
          IdentifyArchive() to see what
          kind of archive you're dealing
          with.

        What if you want to add more archive-types
        &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
        - Add the unit name in the second Uses-statement.
        - Find out how to identify it and add that algoritm
          to the IdentifyArchive()-function. Please choose a
          unique and no-nonsens character to return.
        - Add it to the IdentifyArchive()-case in TArchive.Name.
        - Create a FindFirst-method and FindNext-method for this
          object.
        - That's it! Simple, isn't it? (If it isn't, please see the
          files ZipView, ArjView and others for examples ;-)

        Author:
        &Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;
        Edwin Groothuis          email:
        Johann Strausslaan 1     edwing@stack.urc.tue.nl (valid until 10-94)
        5583ZA Aalst-Waalre      Edwin_Groothuis@p1.f205.n284.z2.gds.nl
        The Netherlands          2:284/205.1@fidonet
                                 115:3145/102.1@pascal-net


}

</i></font><font color="#FF0000"><b>unit      </b></font>OOAV<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses      </b></font>Dos<font color="#000080">;

</font><font color="#008000"><i>{
  General Archive, which is the father of all the specific archives. See
  OOAVZip, OOAVArj and others for examples.
}
</i></font><font color="#FF0000"><b>type      </b></font>PGeneralArchive<font color="#000080">=^</font>TGeneralArchive<font color="#000080">;
          </font>TGeneralArchive<font color="#000080">=</font><font color="#FF0000"><b>object
                            </b></font>_FArchive<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;

                            </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                            </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">;</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;

                            </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                            </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
  TArchive is the object you're working with. See the documentation at the
  begin of this file for more information
}
</i></font><font color="#FF0000"><b>type      </b></font>PArchive<font color="#000080">=^</font>TArchive<font color="#000080">;
          </font>TArchive<font color="#000080">=</font><font color="#FF0000"><b>object
                     constructor </b></font>Init<font color="#000080">;
                     </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">;

                     </font><font color="#FF0000"><b>function  </b></font>Name<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>n<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;

                     </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                     </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);

                   </font><font color="#FF0000"><b>private
                     </b></font>_Name<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                     </font>_Archive<font color="#000080">:</font>PGeneralArchive<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function  </b></font>IdentifyArchive<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>char<font color="#000080">;

</font><font color="#FF0000"><b>implementation

uses      </b></font>Objects<font color="#000080">,</font>Strings<font color="#000080">,
          </font>OOAVZip<font color="#000080">,</font>OOAVArj<font color="#000080">,</font>OOAVLzh<font color="#000080">,</font>OOAVArc<font color="#000080">,</font>OOAVZoo<font color="#000080">;


</font><font color="#FF0000"><b>function  </b></font>IdentifyArchive<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>char<font color="#000080">;
</font><font color="#008000"><i>{
  returns:
    '?': unknown archive
    'A': Arj-archive;
    'Z': Zip-archive
    'L': Lzh-archive
    'C': Arc-archive
    'O': Zoo-archive
}
</i></font><font color="#FF0000"><b>var       </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
          </font>a<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
          </font>bc<font color="#000080">:</font>word<font color="#000080">;
          </font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
          </font>OldFileMode<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Name<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'?'</font><font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>OldFileMode<font color="#000080">:=</font>FileMode<font color="#000080">;
  </font>FileMode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>assign<font color="#000080">(</font>f<font color="#000080">,</font>Name<font color="#000080">);
  </font><font color="#008000"><i>{$I-}</i></font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font><font color="#008000"><i>{$I+}
  </i></font>FileMode<font color="#000080">:=</font>OldFileMode<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>IOresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'?'</font><font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>a<font color="#000080">,</font>sizeof<font color="#000080">(</font>a<font color="#000080">),</font>bc<font color="#000080">);
  </font>close<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>bc<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'?'</font><font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#$60</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">#$EA</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'A'</font><font color="#000080">;  </font><font color="#008000"><i>{ ARJ }
    </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'P'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'K'</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'Z'</font><font color="#000080">;  </font><font color="#008000"><i>{ ZIP }
    </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">#$1A </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'C'</font><font color="#000080">;  </font><font color="#008000"><i>{ ARC }
    </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font><font color="#800000">'Z'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'O'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">'O'</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'O'</font><font color="#000080">;  </font><font color="#008000"><i>{ ZOO }
    </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>s<font color="#000080">:=</font>Name<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>bc<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>s<font color="#000080">[</font>bc<font color="#000080">]:=</font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>bc<font color="#000080">]);
  </font><font color="#FF0000"><b>if </b></font>copy<font color="#000080">(</font>s<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>s<font color="#000080">),</font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">'.LZH' </font><font color="#FF0000"><b>then
  begin
    </b></font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'L'</font><font color="#000080">;  </font><font color="#008000"><i>{ LZH }
    </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>IdentifyArchive<font color="#000080">:=</font><font color="#800000">'?'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>constructor </b></font>TGeneralArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Abstract</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>destructor </b></font>TGeneralArchive<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TGeneralArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Abstract</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TGeneralArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Abstract</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>constructor </b></font>TArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>_Name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>_Archive<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>destructor </b></font>TArchive<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>_Archive<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil then
  begin
    </b></font>close<font color="#000080">(</font>_Archive<font color="#000080">^.</font>_FArchive<font color="#000080">);
    </font>Dispose<font color="#000080">(</font>_Archive<font color="#000080">,</font>Done<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function  </b></font>TArchive<font color="#000080">.</font>Name<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>n<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var       </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">;
          </font>OldFileMode<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>_Archive<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil then
  begin
    </b></font>close<font color="#000080">(</font>_Archive<font color="#000080">^.</font>_FArchive<font color="#000080">);
    </font>Dispose<font color="#000080">(</font>_Archive<font color="#000080">,</font>Done<font color="#000080">);
    </font>_Archive<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Name<font color="#000080">:=</font>false<font color="#000080">;
  </font>_Name<font color="#000080">:=</font>n<font color="#000080">;
  </font>Dos<font color="#000080">.</font>FindFirst<font color="#000080">(</font>_Name<font color="#000080">,</font>anyfile<font color="#000080">,</font>sr<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>case </b></font>IdentifyArchive<font color="#000080">(</font>_Name<font color="#000080">) </font><font color="#FF0000"><b>of
    </b></font><font color="#800000">'?'</font><font color="#000080">: </font>exit<font color="#000080">;
    </font><font color="#800000">'A'</font><font color="#000080">: </font>_Archive<font color="#000080">:=</font>New<font color="#000080">(</font>PArjArchive<font color="#000080">,</font>Init<font color="#000080">);
    </font><font color="#800000">'Z'</font><font color="#000080">: </font>_Archive<font color="#000080">:=</font>New<font color="#000080">(</font>PZipArchive<font color="#000080">,</font>Init<font color="#000080">);
    </font><font color="#800000">'L'</font><font color="#000080">: </font>_Archive<font color="#000080">:=</font>New<font color="#000080">(</font>PLzhArchive<font color="#000080">,</font>Init<font color="#000080">);
    </font><font color="#800000">'C'</font><font color="#000080">: </font>_Archive<font color="#000080">:=</font>New<font color="#000080">(</font>PArcArchive<font color="#000080">,</font>Init<font color="#000080">);
    </font><font color="#800000">'O'</font><font color="#000080">: </font>_Archive<font color="#000080">:=</font>New<font color="#000080">(</font>PZooArchive<font color="#000080">,</font>Init<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>OldFileMode<font color="#000080">:=</font>FileMode<font color="#000080">;
  </font>FileMode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>_Archive<font color="#000080">^.</font>_FArchive<font color="#000080">,</font>n<font color="#000080">);
  </font><font color="#008000"><i>{$I-}</i></font>reset<font color="#000080">(</font>_Archive<font color="#000080">^.</font>_FArchive<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);</font><font color="#008000"><i>{$I+}
  </i></font>FileMode<font color="#000080">:=</font>OldFileMode<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>IOresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Dispose<font color="#000080">(</font>_Archive<font color="#000080">);
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Name<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>sr<font color="#000080">,</font>sizeof<font color="#000080">(</font>sr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>_Archive<font color="#000080">=</font><font color="#FF0000"><b>nil then
    </b></font>exit<font color="#000080">;
  </font>_Archive<font color="#000080">^.</font>FindFirst<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>sr<font color="#000080">,</font>sizeof<font color="#000080">(</font>sr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>_Archive<font color="#000080">=</font><font color="#FF0000"><b>nil then
    </b></font>exit<font color="#000080">;
  </font>_Archive<font color="#000080">^.</font>FindNext<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{ CUT ----------------------------------------------------------- }
{
        Object-Oriented Archive-viewer: ARC-part
}

</i></font><font color="#FF0000"><b>unit </b></font>OOAVArc<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses      </b></font>Dos<font color="#000080">,</font>OOAV<font color="#000080">;

</font><font color="#FF0000"><b>Type      </b></font>AFHeader <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>HeadId  <font color="#000080">: </font>byte<font color="#000080">;
                 </font>DataType <font color="#000080">: </font>byte<font color="#000080">;   </font><font color="#008000"><i>{ 0 = no more data }
                 </i></font>Name     <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                 </font>CompSize <font color="#000080">: </font>longint<font color="#000080">;
                 </font>FileDate <font color="#000080">: </font>word<font color="#000080">;
                 </font>FileTime <font color="#000080">: </font>word<font color="#000080">;
                 </font>Crc      <font color="#000080">: </font>word<font color="#000080">;
                 </font>OrigSize <font color="#000080">: </font>longint<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>type      </b></font>PArcArchive<font color="#000080">=^</font>TArcArchive<font color="#000080">;
          </font>TArcArchive<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TGeneralArchive<font color="#000080">)
                        </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>private
                        </b></font>_FHdr<font color="#000080">:</font>AFHeader<font color="#000080">;
                        </font>_SL<font color="#000080">:</font>longint<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

const     </b></font>BSize<font color="#000080">=</font><font color="#800000">4096</font><font color="#000080">;
</font><font color="#FF0000"><b>var       </b></font>BUFF<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;



</font><font color="#FF0000"><b>constructor </b></font>TArcArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TArcArchive<font color="#000080">.</font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>var       </b></font>bc<font color="#000080">:</font>word<font color="#000080">;
          </font>b<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>BUFF<font color="#000080">,</font>BSize<font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);
  </font>Seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_SL<font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>BUFF<font color="#000080">,</font>BSIZE<font color="#000080">,</font>bc<font color="#000080">);
  </font>Move<font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>_FHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>_FHdr<font color="#000080">));
  </font><font color="#FF0000"><b>with </b></font>_FHdr <font color="#FF0000"><b>do
  begin
    if </b></font>DataType<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>b<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>Name<font color="#000080">[</font>b<font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>do
      begin
        if </b></font>Name<font color="#000080">[</font>b<font color="#000080">]=</font><font color="#800000">'/' </font><font color="#FF0000"><b>then
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''
        </font><font color="#FF0000"><b>else
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font>sr<font color="#000080">.</font>Name<font color="#000080">+</font>Name<font color="#000080">[</font>b<font color="#000080">];
        </font>inc<font color="#000080">(</font>b<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>OrigSize<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>DataType<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>sr<font color="#000080">.</font>Time<font color="#000080">:=</font>FileDate<font color="#000080">*</font>longint<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">256</font><font color="#000080">)+</font>FileTime<font color="#000080">;
      </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font>CompSize<font color="#000080">);
      </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHDR<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>TArcArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>_SL<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
 </font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TArcArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{ CUT ----------------------------------------------------------- }
{
        Object-Oriented Archive-viewer: ARJ-part
}

</i></font><font color="#FF0000"><b>unit </b></font>OOAVArj<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses      </b></font>Dos<font color="#000080">,</font>OOAV<font color="#000080">;

</font><font color="#FF0000"><b>Type      </b></font>AFHeader <font color="#000080">= </font><font color="#FF0000"><b>Record
                       </b></font>HeadId  <font color="#000080">: </font>Word<font color="#000080">;                         </font><font color="#008000"><i>{ 60000 }
                       </i></font>BHdrSz  <font color="#000080">: </font>Word<font color="#000080">;             </font><font color="#008000"><i>{ Basic Header Size }
                       </i></font>FHdrSz  <font color="#000080">: </font>Byte<font color="#000080">;              </font><font color="#008000"><i>{ File Header Size }
                       </i></font>AVNo    <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>MAVX    <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>HostOS  <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>Flags   <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>SVer    <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>FType   <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ must be 2 for basic header }
                       </i></font>Res1    <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>DOS_DT  <font color="#000080">: </font>LongInt<font color="#000080">;
                       </font>CSize   <font color="#000080">: </font>LongInt<font color="#000080">;            </font><font color="#008000"><i>{ Compressed Size }
                       </i></font>OSize   <font color="#000080">: </font>LongInt<font color="#000080">;            </font><font color="#008000"><i>{ Original Size }
                       </i></font>SEFP    <font color="#000080">: </font>LongInt<font color="#000080">;
                       </font>FSFPos  <font color="#000080">: </font>Word<font color="#000080">;
                       </font>SEDLgn  <font color="#000080">: </font>Word<font color="#000080">;
                       </font>Res2    <font color="#000080">: </font>Word<font color="#000080">;
                       </font>NameDat <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">120</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;</font><font color="#008000"><i>{ start of Name, etc. }
                       </i></font>Res3    <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>type      </b></font>PArjArchive<font color="#000080">=^</font>TArjArchive<font color="#000080">;
          </font>TArjArchive<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TGeneralArchive<font color="#000080">)
                        </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>private
                        </b></font>_FHdr<font color="#000080">:</font>AFHeader<font color="#000080">;
                        </font>_SL<font color="#000080">:</font>longint<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

const     </b></font>BSize<font color="#000080">=</font><font color="#800000">4096</font><font color="#000080">;
</font><font color="#FF0000"><b>var       </b></font>BUFF<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;



</font><font color="#FF0000"><b>constructor </b></font>TArjArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TArjArchive<font color="#000080">.</font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>var       </b></font>bc<font color="#000080">:</font>word<font color="#000080">;
          </font>b<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>BUFF<font color="#000080">,</font>BSize<font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);
  </font>Seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_SL<font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>BUFF<font color="#000080">,</font>BSIZE<font color="#000080">,</font>bc<font color="#000080">);
  </font>Move<font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>_FHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>_FHdr<font color="#000080">));
  </font><font color="#FF0000"><b>with </b></font>_FHdr <font color="#FF0000"><b>do
  begin
    if </b></font>BHdrSz<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>b<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;</font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>NameDat<font color="#000080">[</font>b<font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>do
      begin
        if </b></font>NameDat<font color="#000080">[</font>b<font color="#000080">]=</font><font color="#800000">'/' </font><font color="#FF0000"><b>then
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''
        </font><font color="#FF0000"><b>else
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font>sr<font color="#000080">.</font>Name<font color="#000080">+</font>NameDat<font color="#000080">[</font>b<font color="#000080">];
        </font>inc<font color="#000080">(</font>b<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>BHdrSz<font color="#000080">+</font>CSize<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>FType<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>BHdrSz<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>BHdrSz<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font>sr<font color="#000080">.</font>Size<font color="#000080">+</font><font color="#800000">10</font><font color="#000080">);
      </font>sr<font color="#000080">.</font>Time<font color="#000080">:=</font>DOS_DT<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>TArjArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>_SL<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
  </font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#008000"><i>{ Why a call to GetHeader() twice?
  Because ARJ stores the name of the archive in the first field }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TArjArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{ CUT ----------------------------------------------------------- }
{
        Object-Oriented Archive-viewer: LZH-part
}

</i></font><font color="#FF0000"><b>Unit      </b></font>OOAVLzh<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses      </b></font>Dos<font color="#000080">,</font>OOAV<font color="#000080">;

</font><font color="#FF0000"><b>Type      </b></font>LFHeader<font color="#000080">=</font><font color="#FF0000"><b>Record
                     </b></font>Headsize<font color="#000080">,</font>Headchk          <font color="#000080">:</font>byte<font color="#000080">;
                     </font>HeadID                    <font color="#000080">:</font><font color="#FF0000"><b>packed Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                     </font>Packsize<font color="#000080">,</font>Origsize<font color="#000080">,</font>Filetime<font color="#000080">:</font>longint<font color="#000080">;
                     </font>Attr                      <font color="#000080">:</font>word<font color="#000080">;
                     </font>Filename                  <font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];
                     </font>f32                       <font color="#000080">:</font>pathstr<font color="#000080">;
                     </font>dt                        <font color="#000080">:</font>DateTime<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>type      </b></font>PLzhArchive<font color="#000080">=^</font>TLzhArchive<font color="#000080">;
          </font>TLzhArchive<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TGeneralArchive<font color="#000080">)
                        </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>private
                        </b></font>_FHdr<font color="#000080">:</font>LFHeader<font color="#000080">;
                        </font>_SL<font color="#000080">:</font>longint<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Implementation


constructor </b></font>TLzhArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>_SL<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TLzhArchive<font color="#000080">.</font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>var       </b></font>nr<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fillchar<font color="#000080">(</font>sr<font color="#000080">,</font>sizeof<font color="#000080">(</font>sr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_SL<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>eof<font color="#000080">(</font>_FArchive<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>blockread<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>LFHeader<font color="#000080">),</font>nr<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>_FHdr<font color="#000080">.</font>headsize<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font>_FHdr<font color="#000080">.</font>headsize<font color="#000080">);
  </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>inc<font color="#000080">(</font>_SL<font color="#000080">,</font>_FHdr<font color="#000080">.</font>packsize<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>_FHdr<font color="#000080">.</font>headsize<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>UnPackTime<font color="#000080">(</font>_FHdr<font color="#000080">.</font>FileTime<font color="#000080">,</font>_FHdr<font color="#000080">.</font>DT<font color="#000080">);
  </font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font>_FHdr<font color="#000080">.</font>FileName<font color="#000080">;
  </font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>_FHdr<font color="#000080">.</font>OrigSize<font color="#000080">;
  </font>sr<font color="#000080">.</font>Time<font color="#000080">:=</font>_FHdr<font color="#000080">.</font>FileTime<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TLzhArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>_SL<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TLzhArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ CUT ----------------------------------------------------------- }
{
        Object-Oriented Archive-viewer: ZIP-part
}

</i></font><font color="#FF0000"><b>Unit      </b></font>OOAVZip<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Uses      </b></font>Dos<font color="#000080">,</font>OOAV<font color="#000080">;


</font><font color="#FF0000"><b>Type      </b></font>ZFHeader<font color="#000080">=</font><font color="#FF0000"><b>Record
                     </b></font>Signature                         <font color="#000080">:</font>longint<font color="#000080">;
                     </font>Version<font color="#000080">,</font>GPBFlag<font color="#000080">,</font>Compress<font color="#000080">,</font>Date<font color="#000080">,</font>Time<font color="#000080">:</font>word<font color="#000080">;
                     </font>CRC32<font color="#000080">,</font>CSize<font color="#000080">,</font>USize                 <font color="#000080">:</font>longint<font color="#000080">;
                     </font>FNameLen<font color="#000080">,</font>ExtraField               <font color="#000080">:</font>word<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>type      </b></font>PZipArchive<font color="#000080">=^</font>TZipArchive<font color="#000080">;
          </font>TZipArchive<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TGeneralArchive<font color="#000080">)
                        </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>private
                        </b></font>Hdr<font color="#000080">:</font>ZFHeader<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation


Const     </b></font>SIG <font color="#000080">= </font><font color="#800000">$04034B50</font><font color="#000080">;                  </font><font color="#008000"><i>{ Signature }


</i></font><font color="#FF0000"><b>constructor </b></font>TZipArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Hdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>Hdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TZipArchive<font color="#000080">.</font>GetHeader<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>var       </b></font>b<font color="#000080">:</font>byte<font color="#000080">;
          </font>bc<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>fillchar<font color="#000080">(</font>sr<font color="#000080">,</font>sizeof<font color="#000080">(</font>sr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>eof<font color="#000080">(</font>_FArchive<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>Hdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Hdr<font color="#000080">),</font>bc<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>bc<font color="#000080">&lt;&gt;</font>Sizeof<font color="#000080">(</font>Hdr<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
</font><font color="#008000"><i>{ Why checking for Hdr.FNamelen=0?
  Because the comments inserted in a ZIP-file are at the last field }
  </i></font><font color="#FF0000"><b>if </b></font>Hdr<font color="#000080">.</font>FNameLen<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>b<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>b<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font>sr<font color="#000080">.</font>Name<font color="#000080">+</font>Chr<font color="#000080">(</font>b<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>length<font color="#000080">(</font>sr<font color="#000080">.</font>Name<font color="#000080">)=</font>Hdr<font color="#000080">.</font>FNameLen<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>b<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>b<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>Seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>FilePos<font color="#000080">(</font>_FArchive<font color="#000080">)+</font>Hdr<font color="#000080">.</font>CSize<font color="#000080">+</font>Hdr<font color="#000080">.</font>ExtraField<font color="#000080">);
  </font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>Hdr<font color="#000080">.</font>USize<font color="#000080">;
  </font>sr<font color="#000080">.</font>Time<font color="#000080">:=</font>Hdr<font color="#000080">.</font>Date<font color="#000080">+</font>Hdr<font color="#000080">.</font>Time<font color="#000080">*</font>longint<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">256</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>TZipArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>TZipArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>GetHeader<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ CUT ----------------------------------------------------------- }
{
        Object-Oriented Archive-viewer: ZOO-part
}

</i></font><font color="#FF0000"><b>unit </b></font>OOAVZoo<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses      </b></font>Dos<font color="#000080">,</font>OOAV<font color="#000080">;

</font><font color="#FF0000"><b>const     </b></font>SIZ_TEXT<font color="#000080">=</font><font color="#800000">20</font><font color="#000080">;
</font><font color="#FF0000"><b>const     </b></font>FNAMESIZE<font color="#000080">=</font><font color="#800000">13</font><font color="#000080">;
</font><font color="#FF0000"><b>const     </b></font>MAX_PACK<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>const     </b></font>LO_TAG<font color="#000080">=</font><font color="#800000">$a7dc</font><font color="#000080">;
</font><font color="#FF0000"><b>const     </b></font>HI_TAG<font color="#000080">=</font><font color="#800000">$fdc4</font><font color="#000080">;


</font><font color="#FF0000"><b>type      </b></font>ZFHeader<font color="#000080">=</font><font color="#FF0000"><b>record
                     </b></font>lo_tag<font color="#000080">:</font>word<font color="#000080">;
                     </font>hi_tag<font color="#000080">:</font>word<font color="#000080">;
                     </font>_type<font color="#000080">:</font>byte<font color="#000080">;
                     </font>packing_method<font color="#000080">:</font>byte<font color="#000080">;
                     </font>next<font color="#000080">:</font>longint<font color="#000080">;      </font><font color="#008000"><i>{ pos'n of next directory entry }
                     </i></font>offset<font color="#000080">:</font>longint<font color="#000080">;
                     </font>date<font color="#000080">:</font>word<font color="#000080">;         </font><font color="#008000"><i>{ DOS format date }
                     </i></font>time<font color="#000080">:</font>word<font color="#000080">;         </font><font color="#008000"><i>{ DOS format time }
                     </i></font>file_crc<font color="#000080">:</font>word<font color="#000080">;     </font><font color="#008000"><i>{ CRC of this file }
                     </i></font>org_size<font color="#000080">:</font>longint<font color="#000080">;
                     </font>size_now<font color="#000080">:</font>longint<font color="#000080">;
                     </font>major_ver<font color="#000080">:</font>byte<font color="#000080">;
                     </font>minor_ver<font color="#000080">:</font>byte<font color="#000080">;
                     </font>deleted<font color="#000080">:</font>boolean<font color="#000080">;
                     </font>comment<font color="#000080">:</font>longint<font color="#000080">;   </font><font color="#008000"><i>{ points to comment;  zero if none }
                     </i></font>cmt_size<font color="#000080">:</font>word<font color="#000080">;     </font><font color="#008000"><i>{ length of comment, 0 if none }
                     </i></font>unknown<font color="#000080">:</font>byte<font color="#000080">;
                     </font>fname<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>FNAMESIZE<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>type      </b></font>PZooArchive<font color="#000080">=^</font>TZooArchive<font color="#000080">;
          </font>TZooArchive<font color="#000080">=</font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TGeneralArchive<font color="#000080">)
                        </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);</font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>private
                        </b></font>_FHdr<font color="#000080">:</font>ZFHeader<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetHeader<font color="#000080">;
                        </font><font color="#FF0000"><b>procedure </b></font>GetEntry<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation



type      </b></font>zooHeader<font color="#000080">=</font><font color="#FF0000"><b>record
                      </b></font>text<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>SIZ_TEXT<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
                      </font>lo_tag<font color="#000080">:</font>word<font color="#000080">;
                      </font>hi_tag<font color="#000080">:</font>word<font color="#000080">;
                      </font>start<font color="#000080">:</font>longint<font color="#000080">;
                      </font>minus<font color="#000080">:</font>longint<font color="#000080">;
                      </font>major_ver<font color="#000080">:</font>char<font color="#000080">;
                      </font>minor_ver<font color="#000080">:</font>char<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>constructor </b></font>TZooArchive<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TZooArchive<font color="#000080">.</font>GetHeader<font color="#000080">;
</font><font color="#FF0000"><b>var       </b></font>hdr<font color="#000080">:</font>zooHeader<font color="#000080">;
          </font>bc<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>hdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>hdr<font color="#000080">),</font>bc<font color="#000080">);
  </font>seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>hdr<font color="#000080">.</font>start<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TZooArchive<font color="#000080">.</font>GetEntry<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>var       </b></font>bc<font color="#000080">:</font>word<font color="#000080">;
          </font>b<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>_FHdr<font color="#000080">,</font>SizeOf<font color="#000080">(</font>_FHdr<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_FHdr<font color="#000080">,</font>sizeof<font color="#000080">(</font>_FHdr<font color="#000080">),</font>bc<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>_FHdr <font color="#FF0000"><b>do
  begin
    if </b></font>_Type<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>b<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>FName<font color="#000080">[</font>b<font color="#000080">]&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>do
      begin
        if </b></font>FName<font color="#000080">[</font>b<font color="#000080">]=</font><font color="#800000">'/' </font><font color="#FF0000"><b>then
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font><font color="#800000">''
        </font><font color="#FF0000"><b>else
          </b></font>sr<font color="#000080">.</font>Name<font color="#000080">:=</font>sr<font color="#000080">.</font>Name<font color="#000080">+</font>FName<font color="#000080">[</font>b<font color="#000080">];
        </font>inc<font color="#000080">(</font>b<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font>Org_Size<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>_Type<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>sr<font color="#000080">.</font>Size<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>sr<font color="#000080">.</font>Time<font color="#000080">:=</font>Date<font color="#000080">*</font>longint<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">*</font><font color="#800000">256</font><font color="#000080">)+</font>Time<font color="#000080">;
      </font>Seek<font color="#000080">(</font>_FArchive<font color="#000080">,</font>_FHdr<font color="#000080">.</font>next<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TZooArchive<font color="#000080">.</font>FindFirst<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>GetHeader<font color="#000080">;
 </font>GetEntry<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TZooArchive<font color="#000080">.</font>FindNext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sr<font color="#000080">:</font>SearchRec<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>GetEntry<font color="#000080">(</font>sr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0038.PAS">Original</a><b>]</b></p></body>
</html>
