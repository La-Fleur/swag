<html>
<head><title> "ARJ File Viewer" by STEVE WIERENGA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Author: Steve Wierenga
ARJ Viewer
}
{Hello All:
I am releasing these Units to the public domain.  They are Units to view Arj,
Lzh, and Zip Files.  They are by no means professional, and probably have some
bugs.  If you use these in your Programs and feel like giving me credit, I
won't Object...  Here goes: }

</i></font><font color="#FF0000"><b>Unit </b></font>ArjV<font color="#000080">;

</font><font color="#008000"><i>(**) </i></font><font color="#FF0000"><b>Interface </b></font><font color="#008000"><i>(**)

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,</font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>AFHeader <font color="#000080">= </font><font color="#FF0000"><b>Record  </b></font><font color="#008000"><i>{ ArjFileHeader }
    </i></font>HeadID<font color="#000080">,
    </font>HdrSize   <font color="#000080">: </font>Word<font color="#000080">;
    </font>HeadSize<font color="#000080">,
    </font>VerNum<font color="#000080">,
    </font>MinVerNum<font color="#000080">,
    </font>HostOS<font color="#000080">,
    </font>ArjFlag<font color="#000080">,
    </font>Method<font color="#000080">,
    </font>FType<font color="#000080">,
    </font>Reserved  <font color="#000080">: </font>Byte<font color="#000080">;
    </font>FileTime<font color="#000080">,
    </font>PackSize<font color="#000080">,
    </font>OrigSize<font color="#000080">,
    </font>FileCRC   <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>FilePosF<font color="#000080">,
    </font>FileAcc<font color="#000080">,
    </font>HostData  <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>ff     <font color="#000080">: </font>Integer<font color="#000080">;
  </font>b      <font color="#000080">: </font>Byte<font color="#000080">;
  </font>f      <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>sl     <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>NR     <font color="#000080">: </font>Word<font color="#000080">;
  </font>FHdr   <font color="#000080">: ^</font>AFHeader<font color="#000080">;
  </font>s<font color="#000080">,</font>sss  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Method <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
  </font>l      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font>Z<font color="#000080">,
  </font>totalu<font color="#000080">,
  </font>totalc <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>x<font color="#000080">,</font>d    <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Dt1<font color="#000080">,</font>dt2<font color="#000080">: </font>DateTime<font color="#000080">;
  </font>i<font color="#000080">,</font>e    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>registered <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ArjView<font color="#000080">(</font>ArjFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>GAN<font color="#000080">(</font>ArjFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>(**) </i></font><font color="#FF0000"><b>Implementation </b></font><font color="#008000"><i>(**)

</i></font><font color="#FF0000"><b>Procedure </b></font>Terminate<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">'ARCHPEEK could not find specified File.
  </font>Aborting<font color="#000080">...</font><font color="#800000">');
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ArjView<font color="#000080">(</font>ArjFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>FHdr<font color="#000080">);
  </font>Assign<font color="#000080">(</font>f<font color="#000080">, </font>arjFile<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>Reset<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);                     </font><font color="#008000"><i>{ Open File }
  {$I+}
  </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Terminate<font color="#000080">; </font><font color="#008000"><i>{ Specified File exists?}
  </i></font>registered <font color="#000080">:= </font>False<font color="#000080">;             </font><font color="#008000"><i>{ Unregistered }
  </i></font><font color="#FF0000"><b>if not </b></font>registered <font color="#FF0000"><b>then
  begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'ArchPeek 0.01Alpha [UNREGISTERED] Copyright 1993 Steve Wierenga'</font><font color="#000080">);
    </font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>SL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;</font>z <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;</font>TotalU <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>TotalC <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ Init  Variables }
  </i></font>sss <font color="#000080">:= </font>GAN<font color="#000080">(</font>ArjFile<font color="#000080">);                       </font><font color="#008000"><i>{ Get the Arj Filename }
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Arj FileName: '</font><font color="#000080">,</font>SSS<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'   Name           Length      Size       Saved     Method     Date Time      '</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'____________________________________________________________________________'</font><font color="#000080">);
  </font>ff <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>ff <font color="#000080">:= </font>ff <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>Seek<font color="#000080">(</font>F<font color="#000080">,</font>SL<font color="#000080">);
    </font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>FHdr<font color="#000080">^,</font>SizeOf<font color="#000080">(</font>AFHeader<font color="#000080">),</font>NR<font color="#000080">);     </font><font color="#008000"><i>{ Read the header }
    </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>NR <font color="#000080">= </font>SizeOf<font color="#000080">(</font>AFHeader<font color="#000080">)) </font><font color="#FF0000"><b>Then
    begin
      </b></font>s <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
        </b></font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);               </font><font color="#008000"><i>{ Get Char For Compressed Filename }
        </i></font><font color="#FF0000"><b>If </b></font>B <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
          </b></font>s <font color="#000080">:= </font>s <font color="#000080">+ </font>Chr<font color="#000080">(</font>b<font color="#000080">);              </font><font color="#008000"><i>{ Put Char in String }
      </i></font><font color="#FF0000"><b>Until </b></font>B <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;                      </font><font color="#008000"><i>{ Until no more Chars }
      </i></font><font color="#FF0000"><b>Case </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>Of                 </b></font><font color="#008000"><i>{ Straighten out String }
        </i></font><font color="#800000">0  </font><font color="#000080">: </font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'            '</font><font color="#000080">;
        </font><font color="#800000">1  </font><font color="#000080">: </font>S <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'           '</font><font color="#000080">;
        </font><font color="#800000">2  </font><font color="#000080">: </font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'          '</font><font color="#000080">;
        </font><font color="#800000">3  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'         '</font><font color="#000080">;
        </font><font color="#800000">4  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'        '</font><font color="#000080">;
        </font><font color="#800000">5  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'       '</font><font color="#000080">;
        </font><font color="#800000">6  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'      '</font><font color="#000080">;
        </font><font color="#800000">7  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'     '</font><font color="#000080">;
        </font><font color="#800000">8  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'    '</font><font color="#000080">;
        </font><font color="#800000">9  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'   '</font><font color="#000080">;
        </font><font color="#800000">10 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'  '</font><font color="#000080">;
        </font><font color="#800000">11 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
        </font><font color="#800000">12 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>z <font color="#000080">:= </font>z <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>UnPackTime<font color="#000080">(</font>FHdr<font color="#000080">^.</font>FileTime<font color="#000080">,</font>dt2<font color="#000080">);  </font><font color="#008000"><i>{ Get the time of compressed File }
      </i></font><font color="#FF0000"><b>Case </b></font>FHdr<font color="#000080">^.</font>Method <font color="#FF0000"><b>Of             </b></font><font color="#008000"><i>{ Get compression method }
        </i></font><font color="#800000">0 </font><font color="#000080">: </font>Method <font color="#000080">:= </font><font color="#800000">'Stored  '</font><font color="#000080">;
        </font><font color="#800000">1 </font><font color="#000080">: </font>Method <font color="#000080">:= </font><font color="#800000">'Most    '</font><font color="#000080">;
        </font><font color="#800000">2 </font><font color="#000080">: </font>Method <font color="#000080">:= </font><font color="#800000">'2nd Most'</font><font color="#000080">;
        </font><font color="#800000">3 </font><font color="#000080">: </font>Method <font color="#000080">:= </font><font color="#800000">'2nd Fast'</font><font color="#000080">;
        </font><font color="#800000">4 </font><font color="#000080">: </font>Method <font color="#000080">:= </font><font color="#800000">'Fastest '</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">' '</font><font color="#000080">,</font>S<font color="#000080">,</font>FHdr<font color="#000080">^.</font>OrigSize<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,</font>FHdr<font color="#000080">^.</font>PackSize<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">);
      </font><font color="#008000"><i>{ Write Filesizes }
      </i></font><font color="#FF0000"><b>If </b></font>ff <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
        </b></font><font color="#008000"><i>{ Don't get first Arj File in Arj File }
        </i></font>Write<font color="#000080">( (</font><font color="#800000">100</font><font color="#000080">-</font>FHdr<font color="#000080">^.</font>PackSize<font color="#000080">/</font>FHdr<font color="#000080">^.</font>OrigSize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">9</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">,</font>Method<font color="#000080">:</font><font color="#800000">15</font><font color="#000080">)
         </font><font color="#008000"><i>{ Write ratios, method }
        </i></font><font color="#FF0000"><b>Else
          </b></font>Write<font color="#000080">( </font>Method<font color="#000080">:</font><font color="#800000">25</font><font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>month <font color="#FF0000"><b>of               </b></font><font color="#008000"><i>{ Show date of compressed File }
        </i></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>dt2<font color="#000080">.</font>month<font color="#000080">);
        </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">12 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt2<font color="#000080">.</font>month<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>day <font color="#FF0000"><b>of
        </b></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt2<font color="#000080">.</font>day<font color="#000080">);
        </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">31 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt2<font color="#000080">.</font>day<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>year <font color="#FF0000"><b>of
        </b></font><font color="#800000">1980 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'80'</font><font color="#000080">);
        </font><font color="#800000">1981 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'81'</font><font color="#000080">);
        </font><font color="#800000">1982 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'82'</font><font color="#000080">);
        </font><font color="#800000">1983 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'83'</font><font color="#000080">);
        </font><font color="#800000">1984 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'84'</font><font color="#000080">);
        </font><font color="#800000">1985 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'85'</font><font color="#000080">);
        </font><font color="#800000">1986 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'86'</font><font color="#000080">);
        </font><font color="#800000">1987 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'87'</font><font color="#000080">);
        </font><font color="#800000">1988 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'88'</font><font color="#000080">);
        </font><font color="#800000">1989 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'89'</font><font color="#000080">);
        </font><font color="#800000">1990 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'90'</font><font color="#000080">);
        </font><font color="#800000">1991 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'91'</font><font color="#000080">);
        </font><font color="#800000">1992 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'92'</font><font color="#000080">);
        </font><font color="#800000">1993 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'93'</font><font color="#000080">);
        </font><font color="#800000">1994 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'94'</font><font color="#000080">);
        </font><font color="#800000">1995 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'95'</font><font color="#000080">);
        </font><font color="#800000">1996 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'96'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>hour <font color="#FF0000"><b>of                          </b></font><font color="#008000"><i>{ Show time of compressed File }
        </i></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>dt2<font color="#000080">.</font>hour<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
        </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">23 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt2<font color="#000080">.</font>hour<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>min <font color="#FF0000"><b>of
        </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt2<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
        </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt2<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Case </b></font>dt2<font color="#000080">.</font>sec <font color="#FF0000"><b>of
        </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt2<font color="#000080">.</font>sec<font color="#000080">);
        </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Writeln<font color="#000080">( </font>dt2<font color="#000080">.</font>sec<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TotalU <font color="#000080">:= </font>TotalU <font color="#000080">+ </font>FHdr<font color="#000080">^.</font>OrigSize<font color="#000080">; </font><font color="#008000"><i>{ Increase total uncompressed size }
      </i></font>TotalC <font color="#000080">:= </font>TotalC <font color="#000080">+ </font>FHdr<font color="#000080">^.</font>PackSize<font color="#000080">; </font><font color="#008000"><i>{ Increase total compressed size }
      </i></font><font color="#FF0000"><b>Repeat
        </b></font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>Until </b></font>b <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
      </font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>FHdr<font color="#000080">^.</font>FileCRC<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);      </font><font color="#008000"><i>{ Go past File CRC }
      </i></font>BlockRead<font color="#000080">(</font>f<font color="#000080">,</font>NR<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>Sl <font color="#000080">:= </font>FilePos<font color="#000080">(</font>F<font color="#000080">) + </font>FHdr<font color="#000080">^.</font>PackSize<font color="#000080">; </font><font color="#008000"><i>{ Where are we in File? }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>FHdr<font color="#000080">^.</font>HdrSize <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{ No more Files? }
  </i></font>GetFTime<font color="#000080">(</font>F<font color="#000080">,</font>x<font color="#000080">);
  </font>UnPackTime<font color="#000080">(</font>x<font color="#000080">,</font>dt1<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'============================================================================'</font><font color="#000080">);
  </font>Write<font color="#000080">( (</font>z<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Files'</font><font color="#000080">,</font>TotalU<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>TotalC<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,(</font><font color="#800000">100</font><font color="#000080">-</font>TotalC<font color="#000080">/</font>TotalU<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">9</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>month <font color="#FF0000"><b>of                  </b></font><font color="#008000"><i>{ Get date and time of Arj File }
    </i></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">19</font><font color="#000080">,</font>dt1<font color="#000080">.</font>month<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">12 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>month<font color="#000080">:</font><font color="#800000">20</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>day <font color="#FF0000"><b>of
    </b></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>day<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">31 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>day<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>year <font color="#FF0000"><b>of
    </b></font><font color="#800000">1980 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'80'</font><font color="#000080">);
    </font><font color="#800000">1981 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'81'</font><font color="#000080">);
    </font><font color="#800000">1982 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'82'</font><font color="#000080">);
    </font><font color="#800000">1983 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'83'</font><font color="#000080">);
    </font><font color="#800000">1984 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'84'</font><font color="#000080">);
    </font><font color="#800000">1985 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'85'</font><font color="#000080">);
    </font><font color="#800000">1986 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'86'</font><font color="#000080">);
    </font><font color="#800000">1987 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'87'</font><font color="#000080">);
    </font><font color="#800000">1988 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'88'</font><font color="#000080">);
    </font><font color="#800000">1989 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'89'</font><font color="#000080">);
    </font><font color="#800000">1990 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'90'</font><font color="#000080">);
    </font><font color="#800000">1991 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'91'</font><font color="#000080">);
    </font><font color="#800000">1992 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'92'</font><font color="#000080">);
    </font><font color="#800000">1993 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'93'</font><font color="#000080">);
    </font><font color="#800000">1994 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'94'</font><font color="#000080">);
    </font><font color="#800000">1995 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'95'</font><font color="#000080">);
    </font><font color="#800000">1996 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'96'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>hour <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font>dt1<font color="#000080">.</font>hour<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">23 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>hour<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>min <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>sec <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>sec<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Writeln<font color="#000080">( </font>dt1<font color="#000080">.</font>sec<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>f<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>FHdr<font color="#000080">);  </font><font color="#008000"><i>{ Done }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GAN<font color="#000080">(</font>ARJFile<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
  </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
  </font>Exts <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FSplit<font color="#000080">(</font>ARJFile<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Exts<font color="#000080">);
  </font>GAN <font color="#000080">:= </font>Name <font color="#000080">+ </font>Exts<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0010.PAS">Original</a><b>]</b></p></body>
</html>
