<html>
<head><title> "ARJ Password Cracker" by JON ZARATE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Do somebody have a ARJ 2.41 Password finder, because I have packed
&gt; some of my pascal codes and grabled it with password and now .... hmmmm
&gt; I can't extract the ARJ file with the password.  I must have typed a
&gt; different password when I pascked those files.

In my next two messages is ARJCRACK.PAS.  It's a program that may
help you find that password.  It's EXTREMELY slow, but if you are
really really really (did i say really? :)) ) desperate about it
you might want to give it a try.

You will need to place this in a FAST machine (one you won't need
for a LONG while) along with ARJ.EXE and the password-encrypted
archive on the same drive &amp; directory.

Tips to speed it up:

 + Using &quot;ARJ v archive,&quot; pick the smallest file you can find (but not
   less than about 10 bytes), that was archived using the store method
   (no compression)
 + Move ARJ.EXE, ARJCRACK.EXE and the archive in a ram drive.
 + Remove some characters in PassSet that you think you never used
   as the password (maybe  ~ ` ^ etc..)
 + Run it in plain old DOS *NOT* under Windows or DESQview or OS2.
 + Start off the [last_password] parameter with &quot;a&quot; x minimum-password-
   length-that-you-normaly-use.  Something like:

   arjcrack sources small.pas aaaa
                              ^^^^
             if you're sure that you never use passwords that are less
             than 4 characters

jon.zarate@vidgame.com
}

{$M 8192, 0, 0}
{$V-}{$S-}{$G+}{$X+}{$R-}

</i></font><font color="#FF0000"><b>uses
 </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;


</font><font color="#FF0000"><b>const
 </b></font>PassSet <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">=
   </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' </font><font color="#000080">+
   </font><font color="#800000">'0123456789`=\[];'',./~!@#$%^&amp;*()_{}:'</font><font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>Pw  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font>Arc <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font>Fn  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font>Prev<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Sounder<font color="#000080">(</font>R <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>N <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>N<font color="#000080">:=</font><font color="#800000">2000</font><font color="#000080">;
 </font><font color="#FF0000"><b>repeat
  </b></font>Sound<font color="#000080">(</font>N<font color="#000080">);
  </font>N<font color="#000080">:=</font>N <font color="#000080">+ </font>R<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>N <font color="#000080">&lt; </font><font color="#800000">50</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>N<font color="#000080">:=</font><font color="#800000">2000 </font><font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>N <font color="#000080">&gt; </font><font color="#800000">2000</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>N<font color="#000080">:=</font><font color="#800000">50</font><font color="#000080">;
  </font>Delay<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
 </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">);
 </font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Crack<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>I <font color="#000080">: </font>Word<font color="#000080">;
 </font>Pw<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];
 </font>J <font color="#000080">: </font>Word<font color="#000080">;
 </font>X <font color="#000080">: </font>Word<font color="#000080">;
 </font>Y <font color="#000080">: </font>Word<font color="#000080">;
 </font>Z <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">41</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
 </font>C <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>FillChar<font color="#000080">(</font>Z<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Z<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);

 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Prev <font color="#000080">&lt;&gt; </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
   for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Prev<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
     </b></font>Z<font color="#000080">[</font>I<font color="#000080">]:=</font>Pos<font color="#000080">(</font>Prev<font color="#000080">[</font>I<font color="#000080">], </font>PassSet<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Z<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
       </b></font>writeln<font color="#000080">(</font><font color="#800000">'Invalid character in [last_password]'</font><font color="#000080">);
       </font>Halt<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>Pw<font color="#000080">:=</font>Prev<font color="#000080">;
   </font>X<font color="#000080">:=</font>Length<font color="#000080">(</font>Pw<font color="#000080">);
   </font>J<font color="#000080">:=</font>X<font color="#000080">;
  </font><font color="#FF0000"><b>end else
  begin
   </b></font>Pw<font color="#000080">:=</font>PassSet<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
   </font>Z<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
   </font>X<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>J<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#FF0000"><b>repeat
  </b></font>Pw<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>PassSet<font color="#000080">[</font>Z<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]];

  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'////////////////////////////////////////////////////////////'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'ARJ t '</font><font color="#000080">, </font>Arc<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">, </font>Fn<font color="#000080">, </font><font color="#800000">' -g'</font><font color="#000080">, </font>Pw<font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>SwapVectors<font color="#000080">;
  </font>Exec<font color="#000080">(</font><font color="#800000">'ARJ.EXE'</font><font color="#000080">, </font><font color="#800000">'t ' </font><font color="#000080">+ </font>Arc <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>Fn <font color="#000080">+ </font><font color="#800000">' -g' </font><font color="#000080">+ </font>Pw<font color="#000080">);
  </font>SwapVectors<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'////////////////////////////////////////////////////////////'</font><font color="#000080">);

  </font>C<font color="#000080">:=</font>DosExitCode<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>C <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
   begin
    </b></font>writeln<font color="#000080">;
    </font>writeln<font color="#000080">;
    </font>writeln<font color="#000080">(</font><font color="#800000">'Hey I found it!!'</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'The password is -- '</font><font color="#000080">, </font>Pw<font color="#000080">);
    </font>writeln<font color="#000080">;
    </font>Sounder<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
    </font>Halt
   <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>C <font color="#000080">&lt;&gt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>DosError <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
   begin
    </b></font>writeln<font color="#000080">;
    </font>writeln<font color="#000080">(</font><font color="#800000">'Duhh... What happened?? Why did I get an EXITCODE of '</font><font color="#000080">,
      </font>C<font color="#000080">, </font><font color="#800000">' and a DOSERROR of '</font><font color="#000080">, </font>DosError<font color="#000080">, </font><font color="#800000">'??'</font><font color="#000080">);
    </font>Sounder<font color="#000080">(-</font><font color="#800000">30</font><font color="#000080">);
    </font>Halt
   <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>KeyPressed<font color="#000080">) </font><font color="#FF0000"><b>then
   begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'ARJCRACK aborted.'</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Last password used was --&gt; '</font><font color="#000080">, </font>Pw<font color="#000080">, </font><font color="#800000">' &lt;--'</font><font color="#000080">);
    </font>Halt<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>inc<font color="#000080">(</font>Z<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>X <font color="#FF0000"><b>do
   begin
    if </b></font><font color="#000080">(</font>Z<font color="#000080">[</font>I<font color="#000080">] &gt; </font>Length<font color="#000080">(</font>PassSet<font color="#000080">)) </font><font color="#FF0000"><b>then
     begin
      </b></font>Z<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
      </font>inc<font color="#000080">(</font>Z<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>I <font color="#000080">= </font>J<font color="#000080">) </font><font color="#FF0000"><b>then
       begin
        </b></font>inc<font color="#000080">(</font>J<font color="#000080">);
        </font>inc<font color="#000080">(</font>X<font color="#000080">);
        </font>Pw<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>X<font color="#000080">);
        </font>Pw<font color="#000080">[</font>X<font color="#000080">]:=</font>PassSet<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>Pw<font color="#000080">[</font>I<font color="#000080">]:=</font>PassSet<font color="#000080">[</font>Z<font color="#000080">[</font>I<font color="#000080">]];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>X <font color="#000080">&gt; </font>Length<font color="#000080">(</font>Pw<font color="#000080">));

 </font>writeln<font color="#000080">(</font><font color="#800000">'Sorry, I can''t find the password!!'</font><font color="#000080">);
 </font>Sounder<font color="#000080">(-</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>writeln<font color="#000080">;
 </font>writeln<font color="#000080">;
 </font>writeln<font color="#000080">(</font><font color="#800000">'ARJ Password Cracker Version 0.10'</font><font color="#000080">);
 </font>writeln<font color="#000080">(</font><font color="#800000">'by Jonathan Zarate'</font><font color="#000080">);
 </font>writeln<font color="#000080">;
 </font>writeln<font color="#000080">(</font><font color="#800000">'Password character set: '</font><font color="#000080">, </font>PassSet<font color="#000080">);
 </font>writeln<font color="#000080">;
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>ParamCount <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&gt; </font><font color="#800000">3</font><font color="#000080">)) </font><font color="#FF0000"><b>then
  begin
   </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage: ARJCRACK &lt;archive&gt; &lt;file_to_crack&gt; [last_password]'</font><font color="#000080">);
   </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font>Arc<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
 </font>Fn<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
 </font>Prev<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
 </font>Crack<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0023.PAS">Original</a><b>]</b></p></body>
</html>
