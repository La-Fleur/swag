<html>
<head><title> "LZH Extract Front End" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0039.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
INSTALLER

Param 1 : Path to where .LZH files reside
      2 : Path to install to.
      3 (optional) : Where LHA.EXE program resides,
        default is C:\DOS

All of the LZH files in the directory shall be unpacked to
the install directory.
}

</i></font><font color="#FF0000"><b>Uses </b></font>CRT<font color="#000080">, </font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Var  </b></font>DirInfo<font color="#000080">: </font>SearchRec<font color="#000080">;
     </font>Archive_Loc <font color="#000080">: </font>char<font color="#000080">;
     </font>LhaPath<font color="#000080">: </font>pathstr<font color="#000080">;
     </font>LZH_Count<font color="#000080">: </font>byte<font color="#000080">;
     </font>LZH_Name<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];


</font><font color="#008000"><i>{$M 4000,0,0}

</i></font><font color="#FF0000"><b>Begin
     If </b></font>ParamCount <font color="#FF0000"><b>in</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>Then
     Begin
        </b></font>TextBackground<font color="#000080">(</font>Blue<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>White<font color="#000080">);
        </font>ClrScr<font color="#000080">;

        </font>TextBackground<font color="#000080">(</font>LightGray<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>Black<font color="#000080">);

        </font>ClrEol<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'LHArc INSTALLER (C) 1994 Scott Tunstall. All rights reserved.'</font><font color="#000080">);
        </font>Writeln<font color="#000080">;

        </font>TextBackground<font color="#000080">(</font>Blue<font color="#000080">);
        </font>TextColor<font color="#000080">(</font>LightGray<font color="#000080">);

        </font>Writeln<font color="#000080">(</font><font color="#800000">'Installing .LZH files FROM : '</font><font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
        </font>Writeln<font color="#000080">(</font><font color="#800000">'                      TO   : '</font><font color="#000080">, </font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));


        </font><font color="#008000"><i>{ O.K. That's the end of the niceness. }


        </i></font><font color="#FF0000"><b>If </b></font>ParamCount<font color="#000080">=</font><font color="#800000">3 </font><font color="#FF0000"><b>Then
           Begin
           </b></font>LhaPath<font color="#000080">:=</font>Paramstr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>LhaPath<font color="#000080">[</font>Length<font color="#000080">(</font>LHAPath<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>Then
              </b></font>LhaPath<font color="#000080">:=</font>LhaPath<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
           </font><font color="#FF0000"><b>End
        Else
            </b></font>LhaPath<font color="#000080">:=</font><font color="#800000">'C:'</font><font color="#000080">;


        </font>Writeln<font color="#000080">;
        </font>Writeln<font color="#000080">;
        </font>Writeln<font color="#000080">(</font><font color="#800000">'Looking for LHA.EXE in directory '</font><font color="#000080">,</font>LHAPath<font color="#000080">,</font><font color="#800000">'..'</font><font color="#000080">);

        </font><font color="#FF0000"><b>If </b></font>Fsearch<font color="#000080">(</font><font color="#800000">'LHA.EXE'</font><font color="#000080">,</font>LHAPath<font color="#000080">)&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>Then
           Begin
           </b></font>LZH_Count<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font>LZH_Name<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">'*.LZH'</font><font color="#000080">;

           </font>FindFirst<font color="#000080">(</font>LZH_Name<font color="#000080">,</font>AnyFile<font color="#000080">,</font>DirInfo<font color="#000080">);

           </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
              </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Could not find any .LZH files ! Check your SOURCE PATH !'</font><font color="#000080">)
           </font><font color="#FF0000"><b>Else
           Begin
               While </b></font><font color="#000080">(</font>DosError <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
               Begin
                  </b></font>SwapVectors<font color="#000080">;
                  </font>Exec<font color="#000080">(</font>LhaPath<font color="#000080">+</font><font color="#800000">'LHA.EXE'</font><font color="#000080">,</font><font color="#800000">'e '</font><font color="#000080">+</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)+</font>DirInfo<font color="#000080">.</font>Name<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">+</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
                  </font>SwapVectors<font color="#000080">;

                  </font><font color="#FF0000"><b>If </b></font>DosError <font color="#000080">= </font><font color="#800000">0  </font><font color="#FF0000"><b>Then
                     Begin
                     </b></font>Inc<font color="#000080">(</font>LZH_Count<font color="#000080">);
                     </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
                     </font><font color="#FF0000"><b>End
                  Else
                      Begin
                      </b></font>Writeln<font color="#000080">;
                      </font>Writeln<font color="#000080">(</font><font color="#800000">'A DOS error has occurred!. Program execution halted.'</font><font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font>Writeln<font color="#000080">;
               </font>Writeln<font color="#000080">;
               </font>Writeln<font color="#000080">(</font>LZH_Count<font color="#000080">,</font><font color="#800000">' archive(s) transferred. All done!'</font><font color="#000080">);
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>End
        Else
            Begin
            </b></font>Writeln<font color="#000080">;
            </font>Writeln<font color="#000080">(</font><font color="#800000">'Could not find LHA.EXE, the Main Archival Program.'</font><font color="#000080">);
            </font>Writeln<font color="#000080">(</font><font color="#800000">'Please check that it is in the appropriate directory!'</font><font color="#000080">);
            </font>Writeln<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>End
Else
    Begin
    </b></font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'LZH UNPACKER  (C) 1994 SCOTT &quot;TOODY&quot; TUNSTALL'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Usage :'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'DECRUNCH &lt;src file path&gt; &lt;dest path&gt; [path to LHA program]'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'i.e. To decrunch all .LZH files in directory A:\WORK'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'to directory C:\GAMES you would type :'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'DECRUNCH A:\ C:\GAMES\   &lt;- REMEMBER THE BACKSLASH &quot;\&quot; !'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Finally, the last parameter is the PATH to where the LHA'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'program resides on disk. It should ALWAYS be on a fixed'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'disk (hard disk) system where it can be continually accessed.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'The DEFAULT PATH is C:, which means this param is optional !'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">;
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Finally, hello to all the guys at Lauder College who love to'</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'go out and get STEAMIN!.'</font><font color="#000080">);
    </font>Writeln<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0039.PAS">Original</a><b>]</b></p></body>
</html>
