<html>
<head><title> "Show mountable drives in network" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{
 Program Name : Mounts.Pas
 Written By   : Anonymous
 E-Mail       : nothing
 Web Page     : nothing
 Program
 Compilation  : Turbo Pascal 5.0 or later

 Program Description :

 Usefulness for BBS'S and general communications.
 For a detailed description of this code source, please,
 read the file TENTOOLS.DOC. Thank you
 }

</i></font><font color="#FF0000"><b>Program </b></font>Mounts<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">,</font>TenTools<font color="#000080">; </font><font color="#008000"><i>{ tentools is also in NETWORK.SWG}

</i></font><font color="#FF0000"><b>TYPE
  </b></font>Charset <font color="#000080">= </font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">;
  </font>RDRTable <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>LocalTable <font color="#000080">: </font>DriveArray<font color="#000080">;
  </font>PrintTable <font color="#000080">: </font>PrintArray<font color="#000080">;
  </font>I<font color="#000080">,</font>J<font color="#000080">,</font>H<font color="#000080">,</font>K<font color="#000080">,</font>T<font color="#000080">,</font>L<font color="#000080">,</font>P <font color="#000080">: </font>Integer<font color="#000080">;
  </font>C <font color="#000080">: </font>Charset<font color="#000080">;
  </font>SR <font color="#000080">: </font>SearchRec<font color="#000080">;
  </font>SA <font color="#000080">: </font>Word<font color="#000080">;
  </font>RDR <font color="#000080">: ^</font>RDRTAble<font color="#000080">;
  </font>Avail <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Test <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If Not </b></font>Loaded <font color="#FF0000"><b>then </b></font>Halt<font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">);
   </font>Avail<font color="#000080">:=</font><font color="#800000">'Mounts Unused: '</font><font color="#000080">;
   </font>I<font color="#000080">:=</font><font color="#800000">14</font><font color="#000080">;
   </font>Test<font color="#000080">:=</font>Mountlist<font color="#000080">(</font>LocalTable<font color="#000080">,</font>PrintTable<font color="#000080">,</font>I<font color="#000080">);
   </font>T<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>C<font color="#000080">:=</font><font color="#800000">'A' </font><font color="#FF0000"><b>to </b></font>Char<font color="#000080">(</font>I<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>do
   if </b></font>LocalTable<font color="#000080">[</font>C<font color="#000080">].</font>ServerID<font color="#000080">&lt;&gt;</font><font color="#800000">'            ' </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>T<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>T <font color="#FF0000"><b>mod </b></font><font color="#800000">2</font><font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>T<font color="#000080">:=</font>T <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>T<font color="#000080">:=</font>T <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
   </font>Inc<font color="#000080">(</font>T<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>H<font color="#000080">:=</font>WhereY<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>H<font color="#000080">&gt;(</font><font color="#800000">25</font><font color="#000080">-</font>T<font color="#000080">)) </font><font color="#FF0000"><b>then
   while </b></font><font color="#000080">(</font>H<font color="#000080">&gt;(</font><font color="#800000">25</font><font color="#000080">-</font>T<font color="#000080">)) </font><font color="#FF0000"><b>do
    begin
       </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
       </font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
       </font>Dec<font color="#000080">(</font>H<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Dec<font color="#000080">(</font>T<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">);
   </font>J<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>K<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Test<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)</font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>I<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">))
   </font><font color="#FF0000"><b>then
    begin
       for </b></font>C<font color="#000080">:=</font><font color="#800000">'A' </font><font color="#FF0000"><b>to </b></font>Char<font color="#000080">(</font>I<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">) </font><font color="#FF0000"><b>do
        begin
           If </b></font>J<font color="#000080">&lt;=</font>T <font color="#FF0000"><b>then </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font>H<font color="#000080">+</font>J<font color="#000080">-</font>T<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>LocalTable<font color="#000080">[</font>C<font color="#000080">].</font>ServerID<font color="#000080">&lt;&gt;</font><font color="#800000">'            '
           </font><font color="#FF0000"><b>then
            begin
               </b></font>Inc<font color="#000080">(</font>J<font color="#000080">);
               </font>Write<font color="#000080">(</font>C<font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">,</font>LocalTable<font color="#000080">[</font>C<font color="#000080">].</font>RPath<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>LocalTable<font color="#000080">[</font>C<font color="#000080">].</font>ServerID<font color="#000080">);
            </font><font color="#FF0000"><b>end
           else
            begin
               </b></font>Inc<font color="#000080">(</font>K<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>K<font color="#000080">&lt;&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Avail<font color="#000080">:=</font>Avail<font color="#000080">+</font><font color="#800000">','</font><font color="#000080">;
               </font>Avail<font color="#000080">:=</font>Avail<font color="#000080">+</font>C<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>L<font color="#000080">:=</font>K<font color="#000080">;
       </font>P<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>C<font color="#000080">:=</font><font color="#800000">'1' </font><font color="#FF0000"><b>to </b></font><font color="#800000">'3' </font><font color="#FF0000"><b>do
        begin
           If </b></font>J<font color="#000080">&lt;=</font>T <font color="#FF0000"><b>then </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>else </b></font>GotoXY<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">,</font>H<font color="#000080">+</font>J<font color="#000080">-</font>T<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>PrintTable<font color="#000080">[</font>C<font color="#000080">].</font>ServerID<font color="#000080">&lt;&gt;</font><font color="#800000">'            '
           </font><font color="#FF0000"><b>then
            begin
               </b></font>Write<font color="#000080">(</font><font color="#800000">'LPT'</font><font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">':='</font><font color="#000080">,</font><font color="#800000">'LPT'</font><font color="#000080">,</font>PrintTable<font color="#000080">[</font>C<font color="#000080">].</font>RPath<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>PrintTable<font color="#000080">[</font>C<font color="#000080">].</font>ServerID<font color="#000080">);
               </font>Inc<font color="#000080">(</font>J<font color="#000080">);
               </font>Inc<font color="#000080">(</font>P<font color="#000080">);
            </font><font color="#FF0000"><b>end
           else
            begin
               </b></font>Inc<font color="#000080">(</font>K<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>K<font color="#000080">&lt;&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Avail<font color="#000080">:=</font>Avail<font color="#000080">+</font><font color="#800000">','</font><font color="#000080">;
               </font>Avail<font color="#000080">:=</font>Avail<font color="#000080">+</font><font color="#800000">'LPT'</font><font color="#000080">+</font>C<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>I<font color="#000080">:=</font>MountsAvail<font color="#000080">;
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">+</font>T<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
   </font>Writeln<font color="#000080">(</font>Avail<font color="#000080">);
   </font>Write<font color="#000080">(</font><font color="#800000">'Total Drives Mountable: '</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">'    Drives Mounted: '</font><font color="#000080">,</font>I<font color="#000080">-</font>L<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>P<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'    Printers Mounted: '</font><font color="#000080">,</font>P<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Writeln<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
