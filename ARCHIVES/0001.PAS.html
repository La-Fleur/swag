<html>
<head><title> "Get Archive ID" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 &gt; I'm looking For descriptions of the formats of headers in
 &gt; all popular archive Files, ie .ZIP, .ARC, .LZH, .ARJ, etc.
 &gt; I just want to be able to read the headers of all of these
 &gt; archives, not necessarily manipulate them.  Anyone know
 &gt; where such can be had?

Here's a Program that will determine most of the major archive Types.
I've made a couple of additions, but the original source was from
a message on this echo...the original author's name has since been
lost.  To use the Procedure, just call it as follows:
 If GetArcType(FileName.Ext)=Zip then....
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ArcType <font color="#000080">= (</font>FileError<font color="#000080">, </font>Unknown<font color="#000080">, </font>Zip<font color="#000080">, </font>Zoo<font color="#000080">, </font>Arc<font color="#000080">, </font>Lzh<font color="#000080">, </font>Pak<font color="#000080">, </font>Arj<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>GetArcType<font color="#000080">(</font>FName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>ArcType<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>ArcFile <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>Byte<font color="#000080">;
  </font>i       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Gat     <font color="#000080">: </font>ArcType<font color="#000080">;
  </font>c       <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Assign<font color="#000080">(</font>ArcFile<font color="#000080">, </font>FName<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>Reset<font color="#000080">(</font>ArcFile<font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Gat <font color="#000080">:= </font>FileError
  <font color="#FF0000"><b>else
  if </b></font>FileSize<font color="#000080">(</font>ArcFile<font color="#000080">) &lt; </font><font color="#800000">5 </font><font color="#FF0000"><b>then
    </b></font>Gat <font color="#000080">:= </font>FileError
  <font color="#FF0000"><b>else
  begin
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
      </b></font>Read<font color="#000080">(</font>ArcFile<font color="#000080">, </font>c<font color="#000080">[</font>i<font color="#000080">]);
    </font>Close<font color="#000080">(</font>ArcFile<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">$50</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">$4B</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Zip
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">$60</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">$EA</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Arj
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">$6c</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">] = </font><font color="#800000">$68</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Lzh
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">$5a</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">$4f</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] = </font><font color="#800000">$4f</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Zoo
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">$1a</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">$08</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Arc
    <font color="#FF0000"><b>else
    if </b></font><font color="#000080">((</font>c<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">$1a</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>c<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">$0b</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Gat <font color="#000080">:= </font>Pak
    <font color="#FF0000"><b>else
      </b></font>Gat <font color="#000080">:= </font>Unknown<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>GetArcType <font color="#000080">:= </font>Gat<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Return   <font color="#000080">: </font>ArcType<font color="#000080">;
  </font><font color="#008000"><i>{ArcType = (FileError,Unknown,Zip,Zoo,Arc,Lzh,Pak,Arj)}


</i></font><font color="#FF0000"><b>begin
 if </b></font>ParamCount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
 begin
   </b></font>FileName <font color="#000080">:= </font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
   </font>Return   <font color="#000080">:= </font>GetArcType<font color="#000080">(</font>FileName<font color="#000080">);
   </font><font color="#FF0000"><b>Case </b></font>Return <font color="#FF0000"><b>of
     </b></font>ARJ     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = ARJ '</font><font color="#000080">);
     </font>PAK     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = PAK '</font><font color="#000080">);
     </font>LZH     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = LZH '</font><font color="#000080">);
     </font>ARC     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = ARC '</font><font color="#000080">);
     </font>ZOO     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = ZOO '</font><font color="#000080">);
     </font>ZIP     <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = ZIP '</font><font color="#000080">);
     </font>UNKNOWN <font color="#000080">: </font>Writeln<font color="#000080">(</font>FileName<font color="#000080">, </font><font color="#800000">' = Unknown!'</font><font color="#000080">)
     </font><font color="#FF0000"><b>else
       </b></font>Writeln<font color="#000080">(</font><font color="#800000">'File Not Found'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{IF}
 </i></font><font color="#FF0000"><b>else
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'No parameter'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
