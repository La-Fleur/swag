<html>
<head><title> "Zip Comment Program" by ZAK SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
  This code may be used as long as the resulting product is FREE.

  See the end of the file (after end.) for the zipfile data structure

  Written by Zak Smith

       I am reachable the following ways..
             sysop Sirius Cybernetics 414-966-3552
             Zak Smith @ 1:154/736 fido-land
             zak.smith@mixcom.com
}


{$M 32768,0,65520}
</i></font><font color="#FF0000"><b>Program </b></font>ZipComment<font color="#000080">;  </font><font color="#008000"><i>{ by Zak, mahahaha }
</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">,</font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Type </b></font>FindZipType <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>id <font color="#000080">: </font>longint<font color="#000080">;
    </font>dn <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>sd <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>cd <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>tcd<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>scd<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>sdn<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>cl <font color="#000080">: </font>word<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>total    <font color="#000080">: </font>longint<font color="#000080">;
    </font>starttime<font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>type </b></font>commentfiletype <font color="#000080">= </font><font color="#FF0000"><b>record
      </b></font>len <font color="#000080">: </font>word<font color="#000080">;
      </font>data <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5120</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SecondsSinceMidnight<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">:</font>word<font color="#000080">):</font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>SecondsSinceMidnight <font color="#000080">:= (</font>h<font color="#000080">*</font><font color="#800000">3600</font><font color="#000080">)+(</font>m<font color="#000080">*</font><font color="#800000">60</font><font color="#000080">)+</font>s
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CurTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>h<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>m<font color="#000080">: </font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>word<font color="#000080">);
 </font><font color="#FF0000"><b>Var </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">:</font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>GetTime<font color="#000080">(</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
 </font>h<font color="#000080">:=</font>hour<font color="#000080">;
 </font>m<font color="#000080">:=</font>min<font color="#000080">;
 </font>s<font color="#000080">:=</font>sec<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>nowsecondssincemidnight<font color="#000080">: </font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>curtime<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
 </font>nowsecondssincemidnight<font color="#000080">:=</font>secondssincemidnight<font color="#000080">(</font>h<font color="#000080">,</font>m<font color="#000080">,</font>s<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(********* The following search engine routines are sneakly swiped *********)
(********* from Turbo Technix v1n6.  See there for further details *********)

</i></font><font color="#FF0000"><b>type
  </b></font>ProcType<font color="#000080">=             </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">; </font>P<font color="#000080">: </font>PathStr<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>EngineMask<font color="#000080">:           </font>PathStr<font color="#000080">;
  </font>EngineAttr<font color="#000080">:           </font>byte<font color="#000080">;
  </font>EngineProc<font color="#000080">:           </font>ProcType<font color="#000080">;
  </font>EngineCode<font color="#000080">:           </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ValidExtention<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Junk1<font color="#000080">: </font>dirstr                <font color="#000080">;
  </font>junk2<font color="#000080">: </font>namestr<font color="#000080">;
  </font>E<font color="#000080">:                    </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>S<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">=</font>Directory <font color="#FF0000"><b>then
  begin
    </b></font>ValidExtention <font color="#000080">:= </font>true<font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FSplit<font color="#000080">(</font>S<font color="#000080">.</font>Name<font color="#000080">,</font>Junk1<font color="#000080">,</font>Junk2<font color="#000080">,</font>E<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>E<font color="#000080">=</font><font color="#800000">'.ZIP'</font><font color="#000080">) </font><font color="#FF0000"><b>then

  </b></font>ValidExtention <font color="#000080">:= </font>true <font color="#FF0000"><b>else </b></font>ValidExtention <font color="#000080">:= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SearchEngine<font color="#000080">(</font>M<font color="#000080">: </font>dirstr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">; </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">;
                       </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>S<font color="#000080">:                    </font>SearchRec<font color="#000080">;
  </font>P<font color="#000080">:                    </font>dirStr<font color="#000080">;
  </font>Ext<font color="#000080">:                  </font>ExtStr<font color="#000080">;
  </font>Mask<font color="#000080">:                 </font>Namestr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FSplit<font color="#000080">(</font>M<font color="#000080">, </font>P<font color="#000080">, </font>Mask<font color="#000080">, </font>Ext<font color="#000080">);
  </font>Mask <font color="#000080">:= </font>Mask<font color="#000080">+</font>Ext<font color="#000080">;
  </font>FindFirst<font color="#000080">(</font>P<font color="#000080">+</font>Mask<font color="#000080">,</font>Attr<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>ErrorCode <font color="#000080">:= </font>DosError<font color="#000080">;
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    if </b></font>ValidExtention<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Proc<font color="#000080">(</font>S<font color="#000080">, </font>P<font color="#000080">);
    </font>FindNext<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>DosError<font color="#000080">=</font><font color="#800000">18 </font><font color="#FF0000"><b>then </b></font>ErrorCode <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>else </b></font>ErrorCode <font color="#000080">:= </font>DosError<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GoodDirectory<font color="#000080">(</font>S<font color="#000080">: </font>SearchRec<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GoodDirectory <font color="#000080">:= (</font>S<font color="#000080">.</font>name<font color="#000080">&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>S<font color="#000080">.</font>Name<font color="#000080">&lt;&gt;</font><font color="#800000">'..'</font><font color="#000080">) </font><font color="#FF0000"><b>and
  </b></font><font color="#000080">(</font>S<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>Directory<font color="#000080">=</font>Directory<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SearchOneDir<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>SearchRec<font color="#000080">; </font>P<font color="#000080">: </font>PathStr<font color="#000080">); </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GoodDirectory<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>P <font color="#000080">:= </font>P<font color="#000080">+</font>S<font color="#000080">.</font>Name<font color="#000080">;
    </font>SearchEngine<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">+</font>EngineMask<font color="#000080">,</font>EngineAttr<font color="#000080">,</font>EngineProc<font color="#000080">,</font>EngineCode<font color="#000080">);
    </font>SearchEngine<font color="#000080">(</font>P<font color="#000080">+</font><font color="#800000">'\*.*'</font><font color="#000080">,</font>Directory <font color="#FF0000"><b>or </b></font>Archive<font color="#000080">, </font>SearchOneDir <font color="#000080">,</font>EngineCode<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SearchEngineAll<font color="#000080">(</font>Path<font color="#000080">: </font>PathStr<font color="#000080">; </font>Mask<font color="#000080">: </font>pathStr<font color="#000080">; </font>Attr<font color="#000080">: </font>byte<font color="#000080">;
                          </font>Proc<font color="#000080">: </font>ProcType<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ErrorCode<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>EngineMask <font color="#000080">:= </font>Mask<font color="#000080">;
  </font>EngineProc <font color="#000080">:= </font>Proc<font color="#000080">;
  </font>EngineAttr <font color="#000080">:= </font>Attr<font color="#000080">;
  </font>SearchEngine<font color="#000080">(</font>Path<font color="#000080">+</font>Mask<font color="#000080">,</font>Attr<font color="#000080">,</font>Proc<font color="#000080">,</font>ErrorCode<font color="#000080">);
  </font>SearchEngine<font color="#000080">(</font>Path<font color="#000080">+</font><font color="#800000">'*.*'</font><font color="#000080">,</font>Directory <font color="#FF0000"><b>or </b></font>Archive<font color="#000080">,</font>SearchOneDir<font color="#000080">,</font>ErrorCode<font color="#000080">);
  </font>ErrorCode <font color="#000080">:= </font>EngineCode<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(************** Thus ends the sneakly swiped code *************)
(**** We now return you to our regularly scheduled program ****)

</i></font><font color="#FF0000"><b>procedure </b></font>status<font color="#000080">(</font>p<font color="#000080">,</font>f<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>tt<font color="#000080">:</font>longint<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
 </font>textcolor<font color="#000080">(</font>cyan<font color="#000080">);
 </font>write<font color="#000080">(</font><font color="#800000">'File: '</font><font color="#000080">);
 </font>textcolor<font color="#000080">(</font>lightcyan<font color="#000080">);
 </font>write<font color="#000080">(</font>p<font color="#000080">,</font>f<font color="#000080">);
 </font>gotoxy<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">,</font>wherey<font color="#000080">);
 </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
 </font>write<font color="#000080">(</font><font color="#800000">'Time: '</font><font color="#000080">);
 </font>textcolor<font color="#000080">(</font>white<font color="#000080">);
 </font>tt<font color="#000080">:=(</font>NowSecondsSinceMidnight<font color="#000080">-</font>StartTime<font color="#000080">);
 </font>write<font color="#000080">(</font>tt<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">);
 </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
 </font>write<font color="#000080">(</font><font color="#800000">' / '</font><font color="#000080">);
 </font>write<font color="#000080">(</font>total<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:^</font>commentfiletype<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>AddComment<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">:</font>searchrec<font color="#000080">; </font>p<font color="#000080">:</font>pathstr<font color="#000080">); </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>type </b></font>bffrtype <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1500</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>f <font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
      </font>b <font color="#000080">:^</font>bffrtype<font color="#000080">;
      </font>ofs<font color="#000080">: </font>longint<font color="#000080">;
      </font>tv <font color="#000080">: </font>longint<font color="#000080">;
      </font>zd <font color="#000080">: </font>findziptype<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>inray<font color="#000080">:</font>word<font color="#000080">;
   </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;
   </font><font color="#FF0000"><b>begin
    </b></font>inray<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>tv <font color="#FF0000"><b>do
    begin
    </b></font>move<font color="#000080">(</font>b<font color="#000080">^[</font>i<font color="#000080">],</font>zd<font color="#000080">,</font>sizeof<font color="#000080">(</font>zd<font color="#000080">));
    </font><font color="#FF0000"><b>if </b></font>zd<font color="#000080">.</font>id<font color="#000080">= </font><font color="#800000">$06054b50 </font><font color="#FF0000"><b>then
      begin
      </b></font>inray<font color="#000080">:=</font>i<font color="#000080">;
      </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>p<font color="#000080">+</font>s<font color="#000080">.</font>name<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#008000"><i>{$I+}
  </i></font>new <font color="#000080">(</font>b<font color="#000080">);
  </font>fillchar<font color="#000080">(</font>b<font color="#000080">^,</font>sizeof<font color="#000080">(</font>b<font color="#000080">^),</font><font color="#800000">#0</font><font color="#000080">);
  </font>tv<font color="#000080">:=</font>filesize<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>tv<font color="#000080">&gt;</font>sizeof<font color="#000080">(</font>b<font color="#000080">^) </font><font color="#FF0000"><b>then </b></font>tv<font color="#000080">:=</font>sizeof<font color="#000080">(</font>b<font color="#000080">^);
  </font>seek<font color="#000080">(</font>f<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">)-</font>tv<font color="#000080">);
  </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>b<font color="#000080">^,</font>tv<font color="#000080">);
  </font>ofs<font color="#000080">:=</font>inray<font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font><font color="#000080">(</font>ofs<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
    </b></font>zd<font color="#000080">.</font>cl<font color="#000080">:=</font>c<font color="#000080">^.</font>len<font color="#000080">;
    </font>seek<font color="#000080">(</font>f<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">-</font>tv<font color="#000080">+</font>ofs<font color="#000080">);
    </font>blockwrite<font color="#000080">(</font>f<font color="#000080">,</font>zd<font color="#000080">,</font>sizeof<font color="#000080">(</font>zd<font color="#000080">));
    </font>blockwrite<font color="#000080">(</font>f<font color="#000080">,</font>c<font color="#000080">^.</font>data<font color="#000080">,</font>c<font color="#000080">^.</font>len<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>f<font color="#000080">);
  </font>dispose<font color="#000080">(</font>b<font color="#000080">);
  </font>inc<font color="#000080">(</font>total<font color="#000080">);
  </font>status<font color="#000080">(</font>p<font color="#000080">,</font>s<font color="#000080">.</font>name<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>loadcommentfile<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>getenv<font color="#000080">(</font><font color="#800000">'ZIPCOMNT'</font><font color="#000080">));
 </font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>c<font color="#000080">^.</font>data<font color="#000080">,</font>filesize<font color="#000080">(</font>f<font color="#000080">));
 </font>c<font color="#000080">^.</font>len<font color="#000080">:=</font>filesize<font color="#000080">(</font>f<font color="#000080">);
 </font>close<font color="#000080">(</font>f<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>var </b></font>err<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>total<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font>StartTime<font color="#000080">:=</font>NowSecondsSinceMidnight<font color="#000080">;
</font>writeln<font color="#000080">;
</font>writeln<font color="#000080">(</font><font color="#800000">'ZipC - Zak''s semiPersonal Hyper-Speed Zipfile Commenter'</font><font color="#000080">);
</font>writeln<font color="#000080">;
</font>directvideo<font color="#000080">:=</font>true<font color="#000080">;
</font>new<font color="#000080">(</font>c<font color="#000080">);
</font>loadcommentfile<font color="#000080">;
</font>SearchEngineAll <font color="#000080">(
  </font>fExpand<font color="#000080">(</font><font color="#800000">'.\'</font><font color="#000080">),
  </font><font color="#800000">'*.ZIP'</font><font color="#000080">,
  </font>anyfile<font color="#000080">,
  </font>AddComment<font color="#000080">,
  </font>err<font color="#000080">);

</font>writeln<font color="#000080">;
</font>writeln<font color="#000080">;
</font>writeln<font color="#000080">(</font><font color="#800000">'ZipC Done.'</font><font color="#000080">);
</font>dispose<font color="#000080">(</font>c<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

 </font>Specific ZIP data struct<font color="#000080">. </font>used here<font color="#000080">..

        </font><font color="#FF0000"><b>end of </b></font>central dir signature    <font color="#800000">4 </font>bytes  <font color="#000080">(</font><font color="#800000">0</font>x06054b50<font color="#000080">)
        </font>number <font color="#FF0000"><b>of </b></font>this disk             <font color="#800000">2 </font>bytes
        number <font color="#FF0000"><b>of </b></font>the disk <font color="#FF0000"><b>with </b></font>the
        start <font color="#FF0000"><b>of </b></font>the central directory  <font color="#800000">2 </font>bytes
        total number <font color="#FF0000"><b>of </b></font>entries <font color="#FF0000"><b>in
        </b></font>the central dir <font color="#FF0000"><b>on </b></font>this disk    <font color="#800000">2 </font>bytes
        total number <font color="#FF0000"><b>of </b></font>entries <font color="#FF0000"><b>in
        </b></font>the central dir                 <font color="#800000">2 </font>bytes
        size <font color="#FF0000"><b>of </b></font>the central directory   <font color="#800000">4 </font>bytes
        offset <font color="#FF0000"><b>of </b></font>start <font color="#FF0000"><b>of </b></font>central
        directory <font color="#FF0000"><b>with </b></font>respect <font color="#FF0000"><b>to
        </b></font>the starting disk number        <font color="#800000">4 </font>bytes
        zipfile comment length          <font color="#800000">2 </font>bytes
        zipfile comment <font color="#000080">(</font>variable size<font color="#000080">)

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p></body>
</html>
