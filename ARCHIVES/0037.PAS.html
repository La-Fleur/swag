<html>
<head><title> "Dealing with RAR files" by GEORGE ROBERTS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{Let me guess, you are trying to list out the files in the RAR archive,
correct?  Here's how I do it (this is rough, because I am cleaning it up
from my source because mine handles it a little differently): }

</i></font><font color="#FF0000"><b>CONST
  </b></font>errmsg<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">49</font><font color="#000080">] = (
    </font><font color="#800000">'Unable to access specified file'</font><font color="#000080">,
    </font><font color="#800000">'Unexpected end of file'</font><font color="#000080">,
    </font><font color="#800000">'Unexpected read error'</font><font color="#000080">,
    </font><font color="#800000">'Invalid header ID encountered'</font><font color="#000080">,
    </font><font color="#800000">'Can''t find next entry in archive'</font><font color="#000080">,
    </font><font color="#800000">'File is not in RAR archive format'</font><font color="#000080">);

  </font>method<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">21</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] = (
    </font><font color="#800000">'Directory'</font><font color="#000080">,  </font><font color="#008000"><i>{* Directory marker *}
    </i></font><font color="#800000">'Unknown! '</font><font color="#000080">,  </font><font color="#008000"><i>{* Unknown compression type *}
    </i></font><font color="#800000">'Stored   '</font><font color="#000080">,  </font><font color="#008000"><i>{* No compression *}
    </i></font><font color="#800000">'Packed   '</font><font color="#000080">,  </font><font color="#008000"><i>{* Repeat-byte compression *}
    </i></font><font color="#800000">'Squeezed '</font><font color="#000080">,  </font><font color="#008000"><i>{* Huffman with repeat-byte compression *}
    </i></font><font color="#800000">'crunched '</font><font color="#000080">,  </font><font color="#008000"><i>{* Obsolete LZW compression *}
    </i></font><font color="#800000">'Crunched '</font><font color="#000080">,  </font><font color="#008000"><i>{* LZW 9-12 bit with repeat-byte compression *}
    </i></font><font color="#800000">'Squashed '</font><font color="#000080">,  </font><font color="#008000"><i>{* LZW 9-13 bit compression *}
    </i></font><font color="#800000">'Crushed  '</font><font color="#000080">,  </font><font color="#008000"><i>{* LZW 2-13 bit compression *}
    </i></font><font color="#800000">'Shrunk   '</font><font color="#000080">,  </font><font color="#008000"><i>{* LZW 9-13 bit compression *}
    </i></font><font color="#800000">'Reduced 1'</font><font color="#000080">,  </font><font color="#008000"><i>{* Probabilistic factor 1 compression *}
    </i></font><font color="#800000">'Reduced 2'</font><font color="#000080">,  </font><font color="#008000"><i>{* Probabilistic factor 2 compression *}
    </i></font><font color="#800000">'Reduced 3'</font><font color="#000080">,  </font><font color="#008000"><i>{* Probabilistic factor 3 compression *}
    </i></font><font color="#800000">'Reduced 4'</font><font color="#000080">,  </font><font color="#008000"><i>{* Probabilistic factor 4 compression *}
    </i></font><font color="#800000">'Frozen   '</font><font color="#000080">,  </font><font color="#008000"><i>{* Modified LZW/Huffman compression *}
    </i></font><font color="#800000">'Imploded '</font><font color="#000080">,  </font><font color="#008000"><i>{* Shannon-Fano tree compression *}
    </i></font><font color="#800000">'Imploded '</font><font color="#000080">,  </font><font color="#008000"><i>{* Shannon-Fano tree compression *}
    </i></font><font color="#800000">'Fastest  '</font><font color="#000080">,
    </font><font color="#800000">'Fast     '</font><font color="#000080">,
    </font><font color="#800000">'Normal   '</font><font color="#000080">,
    </font><font color="#800000">'Good Comp'</font><font color="#000080">,
    </font><font color="#800000">'Best Comp'</font><font color="#000080">);

</font><font color="#FF0000"><b>TYPE
  </b></font>outrec<font color="#000080">=</font><font color="#FF0000"><b>record   </b></font><font color="#008000"><i>{* output information structure *}
           </i></font>filename<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];             </font><font color="#008000"><i>{* output filename *}
           </i></font>date<font color="#000080">:</font>integer<font color="#000080">;                     </font><font color="#008000"><i>{* output date *}
           </i></font>time<font color="#000080">:</font>integer<font color="#000080">;                     </font><font color="#008000"><i>{* output time *}
           </i></font>typ<font color="#000080">:</font>integer<font color="#000080">;                      </font><font color="#008000"><i>{* output storage type *}
           </i></font>csize<font color="#000080">:</font>longint<font color="#000080">;                    </font><font color="#008000"><i>{* output compressed size *}
           </i></font>usize<font color="#000080">:</font>longint<font color="#000080">;                    </font><font color="#008000"><i>{* output uncompressed size *}
         </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>rarheaderrec<font color="#000080">=</font><font color="#FF0000"><b>record
              </b></font>b<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>rarfilerec<font color="#000080">=</font><font color="#FF0000"><b>record
            </b></font>packsize<font color="#000080">:</font>longint<font color="#000080">;
            </font>unpacksize<font color="#000080">:</font>longint<font color="#000080">;
            </font>HostOS<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#008000"><i>{ 0 dos 1 os/2 }
            </i></font>FileCRC<font color="#000080">:</font>longint<font color="#000080">;
            </font>mod_time<font color="#000080">:</font>integer<font color="#000080">;
            </font>mod_date<font color="#000080">:</font>integer<font color="#000080">;
            </font>rarver<font color="#000080">:</font>byte<font color="#000080">;
            </font>method<font color="#000080">:</font>byte<font color="#000080">;
            </font>fnamesize<font color="#000080">:</font>integer<font color="#000080">;
            </font>attr<font color="#000080">:</font>longint<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR out</b></font><font color="#000080">:</font>outrec<font color="#000080">;
    </font>aborted<font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>emsg<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{*  emsg - Display error message
   *}

  </i></font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'* '</font><font color="#000080">+</font><font color="#FF0000"><b>message</b></font><font color="#000080">);
  </font>aborted<font color="#000080">:=</font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getbyte<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>fp<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">):</font>char<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>buf<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>numread<font color="#000080">:</font>word<font color="#000080">;
    </font>c<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>c<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>numread<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>close<font color="#000080">(</font>fp<font color="#000080">);
      </font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>getbyte<font color="#000080">:=</font>c<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Process_RAR<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>fp<font color="#000080">:</font><font color="#FF0000"><b>file</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>rar<font color="#000080">:</font>rarfilerec<font color="#000080">;
    </font>rh<font color="#000080">:</font>rarheaderrec<font color="#000080">;
    </font>rha<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>buf<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
    </font>h<font color="#000080">:</font>integer<font color="#000080">;
    </font>ad<font color="#000080">:</font>longint<font color="#000080">;
    </font>numread<font color="#000080">:</font>word<font color="#000080">;
    </font>i<font color="#000080">,</font>stat<font color="#000080">:</font>integer<font color="#000080">;
    </font>add2<font color="#000080">:</font>word<font color="#000080">;
    </font>c<font color="#000080">:</font>char<font color="#000080">;
    </font>add<font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>begin

  while </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>aborted<font color="#000080">) </font><font color="#FF0000"><b>do begin
  </b></font><font color="#008000"><i>{* set up infinite loop (exit is within loop) *}
    </i></font>add<font color="#000080">:=</font>FALSE<font color="#000080">;
    </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>rh<font color="#000080">.</font>b<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font>numread<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font><font color="#800000">5 </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>if not</b></font><font color="#000080">(</font>rh<font color="#000080">.</font>b<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]=</font><font color="#800000">$74</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>h<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>numread<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>rar<font color="#000080">,</font>sizeof<font color="#000080">(</font>rar<font color="#000080">),</font>numread<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font>sizeof<font color="#000080">(</font>rar<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>rar<font color="#000080">.</font>fnamesize <font color="#FF0000"><b>do    </b></font><font color="#008000"><i>{* get filename *}
      </i></font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">[</font>i<font color="#000080">]:=</font>getbyte<font color="#000080">(</font>fp<font color="#000080">);
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>rar<font color="#000080">.</font>fnamesize<font color="#000080">);
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">:=</font>stripname<font color="#000080">(</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">);
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>date<font color="#000080">:=</font>rar<font color="#000080">.</font>mod_date<font color="#000080">;
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>time<font color="#000080">:=</font>rar<font color="#000080">.</font>mod_time<font color="#000080">;
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>csize<font color="#000080">:=</font>rar<font color="#000080">.</font>packsize<font color="#000080">;
    </font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>usize<font color="#000080">:=</font>rar<font color="#000080">.</font>unpacksize<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>rar<font color="#000080">.</font>method <font color="#FF0000"><b>of
      </b></font><font color="#800000">$30</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;    </font><font color="#008000"><i>{* Stored *}
      </i></font><font color="#800000">$31</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">17</font><font color="#000080">;    </font><font color="#008000"><i>{* Shrunk *}
      </i></font><font color="#800000">$32</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">18</font><font color="#000080">;
      </font><font color="#800000">$33</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">19</font><font color="#000080">;
      </font><font color="#800000">$34</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">20</font><font color="#000080">;
      </font><font color="#800000">$35</font><font color="#000080">:</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">21</font><font color="#000080">;
    </font><font color="#FF0000"><b>else begin
        out</b></font><font color="#000080">.</font>typ<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>{* Unknown! *}
        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#008000"><i>{place call to routine that displays one file list line using the
     &lt;out&gt; variable}

    {$I-} </i></font>seek<font color="#000080">(</font>fp<font color="#000080">,</font>filepos<font color="#000080">(</font>fp<font color="#000080">)+(</font>h<font color="#000080">-(</font>sizeof<font color="#000080">(</font>rar<font color="#000080">)+</font><font color="#800000">7</font><font color="#000080">+
                </font>length<font color="#000080">(</font><font color="#FF0000"><b>out</b></font><font color="#000080">.</font>filename<font color="#000080">)))); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
    </font><font color="#008000"><i>{$I-} </i></font>seek<font color="#000080">(</font>fp<font color="#000080">,</font>filepos<font color="#000080">(</font>fp<font color="#000080">)+(</font>rar<font color="#000080">.</font>packsize<font color="#000080">)); </font><font color="#008000"><i>{$I+}
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aborted<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>showrar<font color="#000080">(</font>infile<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var    </b></font>rha<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
         </font>c<font color="#000080">:</font>char<font color="#000080">;
         </font>h<font color="#000080">:</font>word<font color="#000080">;
   </font>numread<font color="#000080">:</font>word<font color="#000080">;

</font><font color="#FF0000"><b>begin
          </b></font>assign<font color="#000080">(</font>fp<font color="#000080">,</font>infile<font color="#000080">);
          </font><font color="#008000"><i>{$I-} </i></font>reset<font color="#000080">(</font>fp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
          </i></font><font color="#FF0000"><b>if </b></font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin end</b></font><font color="#000080">;

          </font>c<font color="#000080">:=</font>getbyte<font color="#000080">(</font>fp<font color="#000080">);  </font><font color="#008000"><i>{* determine type of archive *}
          </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>c<font color="#000080">=</font><font color="#800000">$52</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
                if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>getbyte<font color="#000080">(</font>fp<font color="#000080">))&lt;&gt;</font><font color="#800000">$61</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
                </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>getbyte<font color="#000080">(</font>fp<font color="#000080">))&lt;&gt;</font><font color="#800000">$72</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
                </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>getbyte<font color="#000080">(</font>fp<font color="#000080">))&lt;&gt;</font><font color="#800000">$21</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
                </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>getbyte<font color="#000080">(</font>fp<font color="#000080">))&lt;&gt;</font><font color="#800000">$1a</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]);
                </font>c<font color="#000080">:=</font>getbyte<font color="#000080">(</font>fp<font color="#000080">);
                </font>c<font color="#000080">:=</font>getbyte<font color="#000080">(</font>fp<font color="#000080">);
                </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>rha<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font>numread<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font><font color="#800000">5 </font><font color="#FF0000"><b>then
                        </b></font>abend<font color="#000080">(</font>abort<font color="#000080">,</font>next<font color="#000080">,</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font><font color="#FF0000"><b>if </b></font>rha<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]&lt;&gt;</font><font color="#800000">$73 </font><font color="#FF0000"><b>then begin
                   </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>h<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font>numread<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font>blockread<font color="#000080">(</font>fp<font color="#000080">,</font>rha<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">6</font><font color="#000080">,</font>numread<font color="#000080">);
                </font><font color="#FF0000"><b>if </b></font>numread<font color="#000080">&lt;&gt;</font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
                </font><font color="#008000"><i>{$I-} </i></font>seek<font color="#000080">(</font>fp<font color="#000080">,</font>filepos<font color="#000080">(</font>fp<font color="#000080">)+(</font>h<font color="#000080">-</font><font color="#800000">13</font><font color="#000080">)); </font><font color="#008000"><i>{$I+}
                </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ioresult<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>emsg<font color="#000080">(</font>errmsg<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
                </font>writeln<font color="#000080">(</font><font color="#800000">'Original Compress  %  Met'</font><font color="#000080">+
                        </font><font color="#800000">'hod    Date     Time   Filename'</font><font color="#000080">);
                </font>writeln<font color="#000080">(</font><font color="#800000">'-------- -------- --- '</font><font color="#000080">+
                        </font><font color="#800000">'--------- -------- ------ ------------'</font><font color="#000080">);
                </font>process_RAR<font color="#000080">(</font>fp<font color="#000080">);  </font><font color="#008000"><i>{* process RAR entry *}

                { place call to routine that displays any totals or anything
you          may have compiled }

          </i></font><font color="#FF0000"><b>end else </b></font>reset<font color="#000080">(</font>fp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);


          </font>close<font color="#000080">(</font>fp<font color="#000080">);              </font><font color="#008000"><i>{* close file *}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>This <font color="#FF0000"><b>is not </b></font>a complete <font color="#FF0000"><b>unit or program </b></font>because it <font color="#FF0000"><b>is </b></font>a cut <font color="#FF0000"><b>and </b></font>paste from
<font color="#000080">(</font>MANY<font color="#000080">) </font>different source files <font color="#FF0000"><b>of </b></font>mine<font color="#000080">... ;)  </font>I display a bunch <font color="#FF0000"><b>of </b></font>different
archive types <font color="#FF0000"><b>and </b></font>the display routines are all intertwined<font color="#000080">, </font>so I had <font color="#FF0000"><b>to </b></font>cut
<font color="#FF0000"><b>out </b></font>the RAR ones <font color="#FF0000"><b>to </b></font>show you here<font color="#000080">.  </font>I would <font color="#FF0000"><b>not </b></font>suggest reading the <font color="#FF0000"><b>file
</b></font>byte by byte <font color="#FF0000"><b>and </b></font>trying <font color="#FF0000"><b>to </b></font>convert it<font color="#000080">.  </font>I would simply <font color="#FF0000"><b>do </b></font>something like
what I have done here<font color="#000080">, (</font>I meant this <font color="#FF0000"><b>to </b></font>be an example<font color="#000080">... </font><font color="#FF0000"><b>not </b></font>necessarily a
cut <font color="#FF0000"><b>and </b></font>paste solution<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>use the <font color="#FF0000"><b>record and </b></font>blockread <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>record</b></font><font color="#000080">.

</font>Hope this helps somewhat<font color="#000080">! ;)


</font>George A<font color="#000080">. </font>Roberts IV
Intuitive Vision Software
ivsoft<font color="#000080">@</font>ripco<font color="#000080">.</font>com

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0037.PAS">Original</a><b>]</b></p></body>
</html>
