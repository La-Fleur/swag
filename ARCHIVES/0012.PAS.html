<html>
<head><title> "Zip File Viewer" by STEVE WIERENGA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Author: Steve Wierenga
ZIP Viewer
}

</i></font><font color="#FF0000"><b>Unit </b></font>ZipV<font color="#000080">;

</font><font color="#008000"><i>(**) </i></font><font color="#FF0000"><b>Interface </b></font><font color="#008000"><i>(**)

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">,</font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ZipView<font color="#000080">(</font>ZIPFile<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>GAN<font color="#000080">(</font>ZIPFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>(**) </i></font><font color="#FF0000"><b>Implementation </b></font><font color="#008000"><i>(**)

</i></font><font color="#FF0000"><b>Procedure </b></font>Terminate<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">'ARCHPEEK could not find specified File. Aborting...'</font><font color="#000080">);
  </font>Halt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ZipView<font color="#000080">(</font>ZIPFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);  </font><font color="#008000"><i>{ View the ZIP File }
</i></font><font color="#FF0000"><b>Const
  </b></font>SIG <font color="#000080">= </font><font color="#800000">$04034B50</font><font color="#000080">;                  </font><font color="#008000"><i>{ Signature }
</i></font><font color="#FF0000"><b>Type
  </b></font>ZFHeader <font color="#000080">= </font><font color="#FF0000"><b>Record                 </b></font><font color="#008000"><i>{ Zip File Header }
    </i></font>Signature  <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>Version<font color="#000080">,
    </font>GPBFlag<font color="#000080">,
    </font>Compress<font color="#000080">,
    </font>Date<font color="#000080">,</font>Time  <font color="#000080">: </font>Word<font color="#000080">;
    </font>CRC32<font color="#000080">,
    </font>CSize<font color="#000080">,
    </font>USize      <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>FNameLen<font color="#000080">,
    </font>ExtraField <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>z       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>x<font color="#000080">,
  </font>totalu<font color="#000080">,
  </font>totalc  <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Hdr     <font color="#000080">: ^</font>ZFHeader<font color="#000080">;
  </font>F       <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>S<font color="#000080">,</font>sss   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>own     <font color="#000080">: </font>Text<font color="#000080">;
  </font>dt1     <font color="#000080">: </font>DateTime<font color="#000080">;
  </font>l       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font>registered <font color="#000080">: </font>Boolean<font color="#000080">;  </font><font color="#008000"><i>{ Is registered? }

</i></font><font color="#FF0000"><b>Const
  </b></font>CompTypes <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =
              (</font><font color="#800000">'Stored '</font><font color="#000080">,</font><font color="#800000">'Shrunk   '</font><font color="#000080">,</font><font color="#800000">'Reduced1'</font><font color="#000080">,</font><font color="#800000">'Reduced2'</font><font color="#000080">,</font><font color="#800000">'Reduced3'</font><font color="#000080">,
               </font><font color="#800000">'Reduced4'</font><font color="#000080">,</font><font color="#800000">'Imploded '</font><font color="#000080">,</font><font color="#800000">'Deflated'</font><font color="#000080">);
  </font><font color="#008000"><i>{ Method used to compress }
  </i></font>r <font color="#000080">= </font><font color="#800000">#196</font><font color="#000080">;
  </font>q <font color="#000080">= </font><font color="#800000">#205</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>z <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>totalu <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>totalc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ Init Variables }
  </i></font>registered <font color="#000080">:= </font>False<font color="#000080">; </font><font color="#008000"><i>{ Unregistered }
  </i></font><font color="#FF0000"><b>if not </b></font>registered <font color="#FF0000"><b>then   </b></font><font color="#008000"><i>{ Is registered? }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'ArchPeek 0.01Alpha [UNREGISTERED] Copyright 1993 Steve Wierenga'</font><font color="#000080">);
    </font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>New<font color="#000080">(</font>Hdr<font color="#000080">);
  </font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>ZIPFile<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>Reset<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                   </font><font color="#008000"><i>{ Open File }
  {$I+}
  </i></font><font color="#FF0000"><b>If </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Terminate<font color="#000080">;  </font><font color="#008000"><i>{ Couldn't open Zip File }
  </i></font>sss <font color="#000080">:= </font>GAN<font color="#000080">(</font>ZipFile<font color="#000080">);              </font><font color="#008000"><i>{ Get the Zip Filename }
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'Zip FileName: '</font><font color="#000080">,</font>sss<font color="#000080">);
  </font>WriteLn<font color="#000080">( </font><font color="#800000">'   Name           Length      Size  Saved Method'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,
          </font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">,</font>r<font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>FillChar<font color="#000080">(</font>S<font color="#000080">,</font>SizeOf<font color="#000080">(</font>S<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);  </font><font color="#008000"><i>{ Pad With nulls }
    </i></font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>Hdr<font color="#000080">^,</font>SizeOf<font color="#000080">(</font>ZFHeader<font color="#000080">));
    </font><font color="#008000"><i>{ Read File Header }
    </i></font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>S<font color="#000080">) : </font>Ofs<font color="#000080">(</font>S<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">], </font>Hdr<font color="#000080">^.</font>FNameLen<font color="#000080">);
    </font>s<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>Hdr<font color="#000080">^.</font>FNameLen<font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>Of    </b></font><font color="#008000"><i>{ Straighten String }
     </i></font><font color="#800000">0  </font><font color="#000080">: </font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'            '</font><font color="#000080">;
     </font><font color="#800000">1  </font><font color="#000080">: </font>S <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'           '</font><font color="#000080">;
     </font><font color="#800000">2  </font><font color="#000080">: </font>s <font color="#000080">:= </font>s <font color="#000080">+ </font><font color="#800000">'          '</font><font color="#000080">;
     </font><font color="#800000">3  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'         '</font><font color="#000080">;
     </font><font color="#800000">4  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'        '</font><font color="#000080">;
     </font><font color="#800000">5  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'       '</font><font color="#000080">;
     </font><font color="#800000">6  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'      '</font><font color="#000080">;
     </font><font color="#800000">7  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'     '</font><font color="#000080">;
     </font><font color="#800000">8  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'    '</font><font color="#000080">;
     </font><font color="#800000">9  </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'   '</font><font color="#000080">;
     </font><font color="#800000">10 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'  '</font><font color="#000080">;
     </font><font color="#800000">11 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
     </font><font color="#800000">12 </font><font color="#000080">: </font>S <font color="#000080">:= </font>S<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Hdr<font color="#000080">^.</font>Signature <font color="#000080">= </font>Sig<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ Is a header }
    </i></font><font color="#FF0000"><b>begin
      </b></font>z <font color="#000080">:= </font>z <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>WriteLn<font color="#000080">(</font>S<font color="#000080">,</font>Hdr<font color="#000080">^.</font>USize<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,</font>Hdr<font color="#000080">^.</font>CSize<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,(</font><font color="#800000">100</font><font color="#000080">-</font>Hdr<font color="#000080">^.</font>CSize<font color="#000080">/</font>Hdr<font color="#000080">^.</font>USize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">5</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">,
              </font>CompTypes<font color="#000080">[</font>Hdr<font color="#000080">^.</font>Compress<font color="#000080">]:</font><font color="#800000">16</font><font color="#000080">);
      </font>Inc<font color="#000080">(</font>TotalU<font color="#000080">,</font>Hdr<font color="#000080">^.</font>USize<font color="#000080">);  </font><font color="#008000"><i>{ Increment size uncompressed }
      </i></font>Inc<font color="#000080">(</font>TotalC<font color="#000080">,</font>Hdr<font color="#000080">^.</font>CSize<font color="#000080">);  </font><font color="#008000"><i>{ Increment size compressed }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Seek<font color="#000080">(</font>F<font color="#000080">,</font>FilePos<font color="#000080">(</font>F<font color="#000080">) + </font>Hdr<font color="#000080">^.</font>CSize <font color="#000080">+ </font>Hdr<font color="#000080">^.</font>ExtraField<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>Hdr<font color="#000080">^.</font>Signature <font color="#000080">&lt;&gt; </font>SIG<font color="#000080">; </font><font color="#008000"><i>{ No more Files }
  </i></font>GetFTime<font color="#000080">(</font>F<font color="#000080">,</font>x<font color="#000080">);
  </font>UnPackTime<font color="#000080">(</font>x<font color="#000080">,</font>DT1<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,
          </font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">,</font>q<font color="#000080">);
  </font>Write<font color="#000080">( </font>z<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' Files '</font><font color="#000080">,</font>TotalU<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>TotalC<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,(</font><font color="#800000">100</font><font color="#000080">-</font>TotalC<font color="#000080">/</font>TotalU<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">):</font><font color="#800000">5</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>month <font color="#FF0000"><b>of        </b></font><font color="#008000"><i>{ Get Zip File date and time }
    </i></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font>dt1<font color="#000080">.</font>month<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">12 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>month<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>day <font color="#FF0000"><b>of
    </b></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>day<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">31 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>day<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Write<font color="#000080">( </font><font color="#800000">'/'</font><font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>year <font color="#FF0000"><b>of
    </b></font><font color="#800000">1980 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'80'</font><font color="#000080">);
    </font><font color="#800000">1981 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'81'</font><font color="#000080">);
    </font><font color="#800000">1982 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'82'</font><font color="#000080">);
    </font><font color="#800000">1983 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'83'</font><font color="#000080">);
    </font><font color="#800000">1984 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'84'</font><font color="#000080">);
    </font><font color="#800000">1985 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'85'</font><font color="#000080">);
    </font><font color="#800000">1986 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'86'</font><font color="#000080">);
    </font><font color="#800000">1987 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'87'</font><font color="#000080">);
    </font><font color="#800000">1988 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'88'</font><font color="#000080">);
    </font><font color="#800000">1989 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'89'</font><font color="#000080">);
    </font><font color="#800000">1990 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'90'</font><font color="#000080">);
    </font><font color="#800000">1991 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'91'</font><font color="#000080">);
    </font><font color="#800000">1992 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'92'</font><font color="#000080">);
    </font><font color="#800000">1993 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'93'</font><font color="#000080">);
    </font><font color="#800000">1994 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'94'</font><font color="#000080">);
    </font><font color="#800000">1995 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'95'</font><font color="#000080">);
    </font><font color="#800000">1996 </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'96'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>hour <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font>dt1<font color="#000080">.</font>hour<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">23 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>hour<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>min <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Write<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Write<font color="#000080">( </font>dt1<font color="#000080">.</font>min<font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>dt1<font color="#000080">.</font>sec <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">9   </font><font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'0'</font><font color="#000080">,</font>dt1<font color="#000080">.</font>sec<font color="#000080">);
    </font><font color="#800000">10</font><font color="#000080">..</font><font color="#800000">59 </font><font color="#000080">: </font>Writeln<font color="#000080">( </font>dt1<font color="#000080">.</font>sec<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>F<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>Hdr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GAN<font color="#000080">(</font>ZIPFile<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Dir  <font color="#000080">: </font>DirStr<font color="#000080">;
  </font>Name <font color="#000080">: </font>NameStr<font color="#000080">;
  </font>Exts <font color="#000080">: </font>ExtStr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FSplit<font color="#000080">(</font>ZIPFile<font color="#000080">,</font>Dir<font color="#000080">,</font>Name<font color="#000080">,</font>Exts<font color="#000080">);
  </font>GAN <font color="#000080">:= </font>Name <font color="#000080">+ </font>Exts<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
