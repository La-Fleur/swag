<html>
<head><title> "Display Archive Files" by MIKE COPELAND</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
   Hmmmm, I thought I responded to you on this before.  Whether I did or
not, I will post what I did before (in the next two messages), but I
don't want to post the entire Program - I'm building a ShareWare
progream I plan to market, and I don't think I should give it _all_
away.  The code I post is pertinent to reading the headers and Filename
info in the Various archive Types, and I Really think you can work out
the rest without much trouble.  If you can't, please post a specific
question...
}

</i></font><font color="#FF0000"><b>Const
      </b></font>BSize    <font color="#000080">= </font><font color="#800000">4096</font><font color="#000080">;                                      </font><font color="#008000"><i>{ I/O Buffer Size }
      </i></font>HMax     <font color="#000080">= </font><font color="#800000">512</font><font color="#000080">;                                   </font><font color="#008000"><i>{ Header Maximum Size }
</i></font><font color="#FF0000"><b>Var
      </b></font>I<font color="#000080">,</font>J<font color="#000080">,</font>K        <font color="#000080">: </font>Integer<font color="#000080">;
      </font>CT<font color="#000080">,</font>RC<font color="#000080">,</font>TC     <font color="#000080">: </font>Integer<font color="#000080">;
      </font>RES          <font color="#000080">: </font>Word<font color="#000080">;                                   </font><font color="#008000"><i>{ Buffer Residue }
      </i></font>N<font color="#000080">,</font>P<font color="#000080">,</font>Q        <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>C            <font color="#000080">: </font>LongInt<font color="#000080">;                                 </font><font color="#008000"><i>{ Buffer Offset }
      </i></font>FSize        <font color="#000080">: </font>LongInt<font color="#000080">;                                     </font><font color="#008000"><i>{ File Size }
      </i></font>DEVICE       <font color="#000080">: </font>Char<font color="#000080">;                                      </font><font color="#008000"><i>{ Disk Device }
      </i></font>F            <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
      </font>SNAME        <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>DATE         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];                  </font><font color="#008000"><i>{ formatted date as YY/MM/DD }
      </i></font>TIME         <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];                  </font><font color="#008000"><i>{     &quot;     time as HH:MM    }
      </i></font>DirInfo      <font color="#000080">: </font>SearchRec<font color="#000080">;                       </font><font color="#008000"><i>{ File name search Type }
      </i></font>SR           <font color="#000080">: </font>SearchRec<font color="#000080">;                       </font><font color="#008000"><i>{ File name search Type }
      </i></font>DT           <font color="#000080">: </font>DateTime<font color="#000080">;
      </font>PATH         <font color="#000080">: </font>PathStr<font color="#000080">;
      </font>DIR          <font color="#000080">: </font>DirStr<font color="#000080">;
      </font>FNAME        <font color="#000080">: </font>NameStr<font color="#000080">;
      </font>EXT          <font color="#000080">: </font>ExtStr<font color="#000080">;
      </font>Regs         <font color="#000080">: </font>Registers<font color="#000080">;
      </font>BUFF         <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>BSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FDT <font color="#000080">(</font>LI <font color="#000080">: </font>LongInt<font color="#000080">);                       </font><font color="#008000"><i>{ Format Date/Time fields }
</i></font><font color="#FF0000"><b>begin
  </b></font>UnPackTime <font color="#000080">(</font>LI<font color="#000080">,</font>DT<font color="#000080">);
  </font>DATE <font color="#000080">:= </font>FSI<font color="#000080">(</font>DT<font color="#000080">.</font>Month<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'/'</font><font color="#000080">+</font>FSI<font color="#000080">(</font>DT<font color="#000080">.</font>Day<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'/'</font><font color="#000080">+</font>Copy<font color="#000080">(</font>FSI<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>DATE<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>DATE<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>DATE<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>DATE<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
  </font>TIME <font color="#000080">:= </font>FSI<font color="#000080">(</font>DT<font color="#000080">.</font>Hour<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font>FSI<font color="#000080">(</font>DT<font color="#000080">.</font>Min<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>TIME<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>TIME<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ FDT }

</i></font><font color="#FF0000"><b>Procedure  </b></font>MY_FFF<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">,</font>J<font color="#000080">,</font>K <font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#008000"><i>(**************************** ARJ Files Processing ***************************)
</i></font><font color="#FF0000"><b>Type </b></font>ARJHead <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>FHeadSize <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>ArcVer1<font color="#000080">,
                 </font>ArcVer2   <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>HostOS<font color="#000080">,
                 </font>ARJFlags<font color="#000080">,
                 </font>Method    <font color="#000080">: </font>Byte<font color="#000080">;   </font><font color="#008000"><i>{ MethodType = (Stored, LZMost, LZFast); }
                 </i></font>R1<font color="#000080">,</font>R2     <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Dos_DT    <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>CompSize<font color="#000080">,
                 </font>UCompSize<font color="#000080">,
                 </font>CRC       <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>ENP<font color="#000080">, </font>FM<font color="#000080">,
                 </font>HostData  <font color="#000080">: </font>Word<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>ARJ1     <font color="#000080">: </font>ARJHead<font color="#000080">;
    </font>ARJId    <font color="#000080">: </font>Word<font color="#000080">;                                     </font><font color="#008000"><i>{ 60000, if ARJ File }
    </i></font>HSize    <font color="#000080">: </font>Word<font color="#000080">;                                            </font><font color="#008000"><i>{ Header Size }
</i></font><font color="#FF0000"><b>Procedure </b></font>GET_ARJ_ENTRY<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>ARJ1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ARJHead<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font>FillChar<font color="#000080">(</font>BUFF<font color="#000080">,</font>BSize<font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);
  </font>Seek <font color="#000080">(</font>F<font color="#000080">,</font>C<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">); </font>BlockRead<font color="#000080">(</font>F<font color="#000080">,</font>BUFF<font color="#000080">,</font>BSIZE<font color="#000080">,</font>RES<font color="#000080">);        </font><font color="#008000"><i>{ read header into buffer }
  </i></font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>ARJId<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);  </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font>HSize<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>HSize <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    With </b></font>ARJ1 <font color="#FF0000"><b>do
      begin
        </b></font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">],</font>ARJ1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ARJHead<font color="#000080">));
        </font>I <font color="#000080">:= </font>FHeadSize<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">; </font>SNAME <font color="#000080">:= </font>B40<font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font>BUFF<font color="#000080">[</font>I<font color="#000080">] &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>Inc <font color="#000080">(</font>I<font color="#000080">);
        </font>I <font color="#000080">:= </font>I<font color="#000080">-</font>FHeadSize<font color="#000080">-</font><font color="#800000">5</font><font color="#000080">;
        </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font>FHeadSize<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">],</font>SNAME<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>I<font color="#000080">); </font>SNAME<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>I<font color="#000080">);
        </font>FSize <font color="#000080">:= </font>CompSize<font color="#000080">; </font>Inc <font color="#000080">(</font>C<font color="#000080">,</font>HSIZE<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ GET_ARJ_ENTRY }

</i></font><font color="#FF0000"><b>Procedure </b></font>DO_ARJ <font color="#000080">(</font>FN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FN<font color="#000080">); </font>Reset <font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>C <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>GET_ARJ_ENTRY<font color="#000080">;                                            </font><font color="#008000"><i>{ Process File
Header }
  </i></font><font color="#FF0000"><b>Repeat
    </b></font>Inc<font color="#000080">(</font>C<font color="#000080">,</font>FSize<font color="#000080">+</font><font color="#800000">10</font><font color="#000080">);
    </font>GET_ARJ_ENTRY<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>HSize <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>Inc <font color="#000080">(</font>WPX<font color="#000080">); </font>New<font color="#000080">(</font>SW<font color="#000080">[</font>WPX<font color="#000080">]);       </font><font color="#008000"><i>{ store Filename info in dynamic Array }
        </i></font><font color="#FF0000"><b>With </b></font>SW<font color="#000080">[</font>WPX<font color="#000080">]^ </font><font color="#FF0000"><b>do
          begin
            </b></font>FSplit <font color="#000080">(</font>SNAME<font color="#000080">,</font>DIR<font color="#000080">,</font>FNAME<font color="#000080">,</font>EXT<font color="#000080">); </font>F <font color="#000080">:= </font>FNAME<font color="#000080">; </font>E <font color="#000080">:= </font>Copy<font color="#000080">(</font>EXT<font color="#000080">+</font><font color="#800000">'    '</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)
            </font>SIZE <font color="#000080">:= </font>ARJ1<font color="#000080">.</font>UCompSize<font color="#000080">;
            </font>RType <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">; </font>D_T <font color="#000080">:= </font>ARJ1<font color="#000080">.</font>Dos_DT<font color="#000080">; </font>ANUM <font color="#000080">:= </font>ADX<font color="#000080">; </font>VNUM <font color="#000080">:= </font>VDX<font color="#000080">;
            </font>ADD_CNAME<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Inc <font color="#000080">(</font>CCT<font color="#000080">); </font>SSL<font color="#000080">; </font>Inc <font color="#000080">(</font>ARCS<font color="#000080">[</font>ADX<font color="#000080">]^.</font>COUNT<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>HSize <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">;
  </font>Close <font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ DO_ARJ }

(**************************** ZIP Files Processing ***************************)
</i></font><font color="#FF0000"><b>Type </b></font>ZIPHead <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>ExtVer <font color="#000080">: </font>Word<font color="#000080">;
                 </font>Flags  <font color="#000080">: </font>Word<font color="#000080">;
                 </font>Method <font color="#000080">: </font>Word<font color="#000080">;
                 </font>Fill1  <font color="#000080">: </font>Word<font color="#000080">;
                 </font>Dos_DT        <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>CRC32         <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>CompSize      <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>UCompSize     <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>FileNameLen   <font color="#000080">: </font>Word<font color="#000080">;
                 </font>ExtraFieldLen <font color="#000080">: </font>Word<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>ZIPCSize <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>ZIPId    <font color="#000080">: </font>Word<font color="#000080">;
    </font>ZIP1     <font color="#000080">: </font>ZIPHead<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>GET_ZIP_ENTRY<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>ZIP1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ZIPHead<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font>C<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>ZIPId<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ZIPId <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font>C<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>ZIP1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ZIPHead<font color="#000080">));
      </font>Inc <font color="#000080">(</font>C<font color="#000080">,</font><font color="#800000">43</font><font color="#000080">); </font>SNAME <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>With </b></font>ZIP1 <font color="#FF0000"><b>do
        begin
          </b></font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font>C<font color="#000080">],</font>SNAME<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>FileNameLen<font color="#000080">); </font>SNAME<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>FileNameLen<font color="#000080">);
          </font>FSize <font color="#000080">:= </font>CompSize<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ GET_ZIP_ENTRY }

</i></font><font color="#FF0000"><b>Procedure </b></font>DO_ZIP <font color="#000080">(</font>FN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Const </b></font>CFHS <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'PK'#01#02</font><font color="#000080">;          </font><font color="#008000"><i>{ CENTRAL_File_HEADER_SIGNATURE }
      </i></font>ECDS <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'PK'#05#06</font><font color="#000080">;        </font><font color="#008000"><i>{ end_CENTRAL_DIRECTORY_SIGNATURE }
</i></font><font color="#FF0000"><b>Var </b></font>S4     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>FOUND  <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>QUIT   <font color="#000080">: </font>Boolean<font color="#000080">;                            </font><font color="#008000"><i>{ &quot;end&quot; sentinel encountered }
</i></font><font color="#FF0000"><b>begin
</b></font><font color="#000080">--- </font>GOMail v1<font color="#000080">.</font><font color="#800000">1 </font><font color="#000080">[</font>DEMO<font color="#000080">] </font><font color="#800000">03</font><font color="#000080">-</font><font color="#800000">09</font><font color="#000080">-</font><font color="#800000">93
 </font><font color="#000080">* </font>Origin<font color="#000080">: </font>The <font color="#FF0000"><b>Private </b></font>Reserve <font color="#000080">- </font>Phoenix<font color="#000080">, </font>AZ <font color="#000080">(</font><font color="#800000">602</font><font color="#000080">) </font><font color="#800000">997</font><font color="#000080">-</font><font color="#800000">9323 </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">114</font><font color="#000080">/</font><font color="#800000">151</font><font color="#000080">)
&lt;&lt;&lt;&gt;&gt;&gt;


</font>Date<font color="#000080">: </font><font color="#800000">03</font><font color="#000080">-</font><font color="#800000">23</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">22</font><font color="#000080">:</font><font color="#800000">30</font><font color="#000080">)              </font>Number<font color="#000080">: </font><font color="#800000">16806 </font><font color="#FF0000"><b>of </b></font><font color="#800000">16859 </font><font color="#000080">(</font>Echo<font color="#000080">)
  </font><font color="#FF0000"><b>To</b></font><font color="#000080">: </font>EDDIE BRAITER                 Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
From<font color="#000080">: </font>MIKE COPELAND                   Read<font color="#000080">: </font>NO
Subj<font color="#000080">: </font>FORMAT VIEWER <font color="#000080">- </font>PART <font color="#800000">2 </font><font color="#FF0000"><b>of     </b></font>Status<font color="#000080">: </font><font color="#FF0000"><b>PUBLIC MESSAGE
</b></font>Conf<font color="#000080">: </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL </b></font><font color="#000080">(</font><font color="#800000">1221</font><font color="#000080">)            </font>Read <font color="#FF0000"><b>Type</b></font><font color="#000080">: </font>GENERAL <font color="#000080">(+)

</font><font color="#008000"><i>(**************************** ARC Files Processing ***************************)
</i></font><font color="#FF0000"><b>Type </b></font>ARCHead <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>ARCMark   <font color="#000080">: </font>Char<font color="#000080">;
                 </font>ARCVer    <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>FN        <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">13</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
                 </font>CompSize  <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>Dos_DT    <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>CRC       <font color="#000080">: </font>Word<font color="#000080">;
                 </font>UCompSize <font color="#000080">: </font>LongInt<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>ARCFlag <font color="#000080">: </font>Char <font color="#000080">= </font><font color="#800000">#26</font><font color="#000080">;                                        </font><font color="#008000"><i>{ ARC mark }
</i></font><font color="#FF0000"><b>Var </b></font>WLV   <font color="#000080">: </font>LongInt<font color="#000080">;                               </font><font color="#008000"><i>{ Working LongInt Variable }
    </i></font>ARC1  <font color="#000080">: </font>ARCHead<font color="#000080">;
    </font>QUIT  <font color="#000080">: </font>Boolean<font color="#000080">;                             </font><font color="#008000"><i>{ &quot;end&quot; sentinel encountered }

</i></font><font color="#FF0000"><b>Procedure </b></font>GET_ARC_ENTRY<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>ARC1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>ARCHead<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font>L <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>ARCHead<font color="#000080">);
  </font>Seek <font color="#000080">(</font>F<font color="#000080">,</font>C<font color="#000080">); </font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BUFF<font color="#000080">,</font>L<font color="#000080">,</font>RES<font color="#000080">);
  </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>ARC1<font color="#000080">,</font>L<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>ARC1 <font color="#FF0000"><b>do
    if </b></font><font color="#000080">(</font>ARCMark <font color="#000080">= </font>ARCFlag<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ARCVer <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>SNAME <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">; </font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font>FN<font color="#000080">[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">#0 </font><font color="#FF0000"><b>do
          begin
            </b></font>SNAME <font color="#000080">:= </font>SNAME<font color="#000080">+</font>FN<font color="#000080">[</font>I<font color="#000080">]; </font>Inc<font color="#000080">(</font>I<font color="#000080">)
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>WLV <font color="#000080">:= (</font>Dos_DT <font color="#FF0000"><b>Shr </b></font><font color="#800000">16</font><font color="#000080">)+(</font>Dos_DT <font color="#FF0000"><b>Shl </b></font><font color="#800000">16</font><font color="#000080">);              </font><font color="#008000"><i>{ flip Date/Time }
        </i></font>FSize <font color="#000080">:= </font>CompSize<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>QUIT <font color="#000080">:= </font>ARC1<font color="#000080">.</font>ARCVer <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ GET_ARC_ENTRY }

</i></font><font color="#FF0000"><b>Procedure </b></font>DO_ARC <font color="#000080">(</font>FN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FN<font color="#000080">); </font>Reset <font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font>C <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>GET_ARC_ENTRY<font color="#000080">;
    </font><font color="#FF0000"><b>if not </b></font>QUIT <font color="#FF0000"><b>then
      begin
        </b></font>Inc <font color="#000080">(</font>WPX<font color="#000080">); </font>New<font color="#000080">(</font>SW<font color="#000080">[</font>WPX<font color="#000080">]);       </font><font color="#008000"><i>{ store Filename info in dynamic Array }
        </i></font><font color="#FF0000"><b>With </b></font>SW<font color="#000080">[</font>WPX<font color="#000080">]^ </font><font color="#FF0000"><b>do
          begin
            </b></font>FSplit <font color="#000080">(</font>SNAME<font color="#000080">,</font>DIR<font color="#000080">,</font>FNAME<font color="#000080">,</font>EXT<font color="#000080">); </font>F <font color="#000080">:= </font>FNAME<font color="#000080">; </font>E <font color="#000080">:= </font>Copy<font color="#000080">(</font>EXT<font color="#000080">+</font><font color="#800000">'    '</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)
            </font>SIZE <font color="#000080">:= </font>ARC1<font color="#000080">.</font>UCompSize<font color="#000080">; </font>RType <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;                   </font><font color="#008000"><i>{ comp File }
            </i></font>D_T <font color="#000080">:= </font>WLV<font color="#000080">; </font>ANUM <font color="#000080">:= </font>ADX<font color="#000080">; </font>VNUM <font color="#000080">:= </font>VDX<font color="#000080">;
            </font>ADD_CNAME<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Inc <font color="#000080">(</font>CCT<font color="#000080">); </font>SSL<font color="#000080">; </font>Inc <font color="#000080">(</font>ARCS<font color="#000080">[</font>ADX<font color="#000080">]^.</font>COUNT<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc <font color="#000080">(</font>C<font color="#000080">,</font>FSize<font color="#000080">+</font>SizeOf<font color="#000080">(</font>ARCHead<font color="#000080">))
  </font><font color="#FF0000"><b>Until </b></font>QUIT<font color="#000080">;
  </font>Close <font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ DO_ARC }

(************************* LZH Files Processing ******************************)
</i></font><font color="#FF0000"><b>Type </b></font>LZHHead <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>HSize       <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Fill1       <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Method      <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
                 </font>CompSize    <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>UCompSize   <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>Dos_DT      <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>Fill2       <font color="#000080">: </font>Word<font color="#000080">;
                 </font>FileNameLen <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>FileName    <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>LZH1     <font color="#000080">: </font>LZHHead<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GET_LZH_ENTRY<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>LZH1<font color="#000080">,</font>SizeOf<font color="#000080">(</font>LZHHead<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">); </font>FillChar <font color="#000080">(</font>DT<font color="#000080">,</font>SizeOf<font color="#000080">(</font>DT<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
  </font>L <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>LZHHead<font color="#000080">);
  </font>Seek <font color="#000080">(</font>F<font color="#000080">,</font>C<font color="#000080">); </font>BlockRead <font color="#000080">(</font>F<font color="#000080">,</font>BUFF<font color="#000080">,</font>L<font color="#000080">,</font>RES<font color="#000080">);
  </font>Move <font color="#000080">(</font>BUFF<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>LZH1<font color="#000080">,</font>L<font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>LZH1 <font color="#FF0000"><b>do
    if </b></font>HSize <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>Move <font color="#000080">(</font>FileNameLen<font color="#000080">,</font>SNAME<font color="#000080">,</font>FileNameLen<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
        </font>UnPackTime <font color="#000080">(</font>Dos_DT<font color="#000080">,</font>DT<font color="#000080">);
        </font>FSize <font color="#000080">:= </font>CompSize<font color="#000080">;
      </font><font color="#FF0000"><b>end
    else </b></font>QUIT <font color="#000080">:= </font>True
<font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ GET_LZH_ENTRY }

</i></font><font color="#FF0000"><b>Procedure </b></font>DO_LZH <font color="#000080">(</font>FN <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Assign <font color="#000080">(</font>F<font color="#000080">,</font>FN<font color="#000080">); </font>Reset <font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>FSize <font color="#000080">:= </font>FileSize<font color="#000080">(</font>F<font color="#000080">); </font>C <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>QUIT <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>GET_LZH_ENTRY<font color="#000080">;
    </font><font color="#FF0000"><b>if not </b></font>QUIT <font color="#FF0000"><b>then
      begin
        </b></font>Inc <font color="#000080">(</font>WPX<font color="#000080">); </font>New<font color="#000080">(</font>SW<font color="#000080">[</font>WPX<font color="#000080">]);       </font><font color="#008000"><i>{ store Filename info in dynamic Array }
        </i></font><font color="#FF0000"><b>With </b></font>SW<font color="#000080">[</font>WPX<font color="#000080">]^ </font><font color="#FF0000"><b>do
          begin
            </b></font>FSplit <font color="#000080">(</font>SNAME<font color="#000080">,</font>DIR<font color="#000080">,</font>FNAME<font color="#000080">,</font>EXT<font color="#000080">); </font>F <font color="#000080">:= </font>FNAME<font color="#000080">; </font>E <font color="#000080">:= </font>Copy<font color="#000080">(</font>EXT<font color="#000080">+</font><font color="#800000">'    '</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)
            </font>SIZE <font color="#000080">:= </font>LZH1<font color="#000080">.</font>UCompSize<font color="#000080">;
            </font>RType <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">; </font>ANUM <font color="#000080">:= </font>ADX<font color="#000080">; </font>VNUM <font color="#000080">:= </font>VDX<font color="#000080">; </font>D_T <font color="#000080">:= </font>LZH1<font color="#000080">.</font>Dos_DT<font color="#000080">;
            </font>ADD_CNAME<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Inc <font color="#000080">(</font>CCT<font color="#000080">); </font>SSL<font color="#000080">; </font>Inc <font color="#000080">(</font>ARCS<font color="#000080">[</font>ADX<font color="#000080">]^.</font>COUNT<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc <font color="#000080">(</font>C<font color="#000080">,</font>FSize<font color="#000080">+</font>LZH1<font color="#000080">.</font>HSize<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">)
  </font><font color="#FF0000"><b>Until </b></font>QUIT<font color="#000080">;
  </font>Close <font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{ DO_LZH }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
