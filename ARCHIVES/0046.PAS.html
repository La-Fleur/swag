<html>
<head><title> "Handling teh PAC file format" by TIM GORDON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>Tpac<font color="#000080">; </font><font color="#008000"><i>{ TPAC v1.7 by Tim Gordon 18/06/97 }
{ Updated and Commented for September Computer Project  14/09/97 }
{ Updated for submission to SWAG 20/09/97 }

{----------------------------------------------------------------------------}
{- TPAC v1.7   Public Domain Release  By Tim Gordon -------------------------}
{----------------------------------------------------------------------------}

{ A Quick note on the PAC File format :-

 &lt;- PAC File header/version -&gt;
 &lt;- 1st File header (Name/size) -&gt;
 &lt;- 1st File Contents - &gt;
 &lt;- 2nd File header -&gt;
 ...

}

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>dos<font color="#000080">;

</font><font color="#FF0000"><b>type
    </b></font>FileHeaderType <font color="#000080">= </font><font color="#FF0000"><b>record </b></font><font color="#008000"><i>{ Header for individual files in PAC File }
                   </i></font>Fname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]; </font><font color="#008000"><i>{ name of file }
                   </i></font>Fsize <font color="#000080">: </font>longint<font color="#000080">; </font><font color="#008000"><i>{ size of file }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
     </b></font>PacHeader <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'TPAC'</font><font color="#000080">; </font><font color="#008000"><i>{ Pac File header }
     </i></font>PacVersion <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">= </font><font color="#800000">'1.7'</font><font color="#000080">; </font><font color="#008000"><i>{ Pac file version }

</i></font><font color="#FF0000"><b>var
   </b></font>extractfile <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">]; </font><font color="#008000"><i>{ List of file specs to extract }
   </i></font>buf         <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10240</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">; </font><font color="#008000"><i>{ Input Buffer }
   </i></font>Header      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]; </font><font color="#008000"><i>{ PAC File Header }
   </i></font>version     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]; </font><font color="#008000"><i>{ PAC File Version }
   </i></font>x           <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ Counter }
   </i></font>Fileheader  <font color="#000080">: </font>fileheadertype<font color="#000080">; </font><font color="#008000"><i>{ File Header }

</i></font><font color="#FF0000"><b>procedure </b></font>DrawPercentage<font color="#000080">(</font>x1<font color="#000080">,</font>y1 <font color="#000080">: </font>integer<font color="#000080">;</font>num <font color="#000080">: </font>real<font color="#000080">);
</font><font color="#008000"><i>{ Draw Percentage Complete as a Bar }
{ &sup2;&sup2;&sup2;&sup2;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg; }
</i></font><font color="#FF0000"><b>var
   </b></font>yy<font color="#000080">,</font>z    <font color="#000080">: </font>integer<font color="#000080">;
   </font>percentage <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>num <font color="#000080">:= </font>num <font color="#000080">/ </font><font color="#800000">100</font><font color="#000080">;
     </font>percentage <font color="#000080">:= </font>round<font color="#000080">(</font>num<font color="#000080">*</font><font color="#800000">11</font><font color="#000080">);
     </font><font color="#008000"><i>{ Work out percentage out of 11 }
     </i></font>textbackground<font color="#000080">(</font>black<font color="#000080">);
     </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
     </font>gotoxy<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">);
     </font>write<font color="#000080">(</font><font color="#800000">'('</font><font color="#000080">);
     </font><font color="#FF0000"><b>for </b></font>z <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>percentage <font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&sup2;'</font><font color="#000080">);
     </font><font color="#FF0000"><b>for </b></font>yy <font color="#000080">:= </font>percentage <font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>write<font color="#000080">(</font><font color="#800000">'&deg;'</font><font color="#000080">);
     </font><font color="#008000"><i>{ Draw up percentage }
     </i></font>write<font color="#000080">(</font><font color="#800000">')'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DisplayHelp<font color="#000080">;
</font><font color="#008000"><i>{ Show Command Line Help }
</i></font><font color="#FF0000"><b>begin
     </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage : '</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' TPAC.EXE [pac_file] [option]... [filename]'</font><font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Valid Options are :'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' -a    Add Files'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' -e    Extract Files'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' -x    Extract Files (too)'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' -l    View Files'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">' -?    This Help'</font><font color="#000080">);
     </font>halt<font color="#000080">; </font><font color="#008000"><i>{ Halt program }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WildCardMatch<font color="#000080">(</font>filename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>Wildcard <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{ Check if filename matches with wildcard - where wildcard can contain
  *'s and ?'s.
  Eg. timothy.tim = tim*.t?? = *t?y.*im = *.*
  and timothy.tim &lt;&gt; h*.??h
}
</i></font><font color="#FF0000"><b>var
   </b></font>MainPart       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]; </font><font color="#008000"><i>{ Actual name of file - before the '.' }
   </i></font>Extention      <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]; </font><font color="#008000"><i>{ last part of filename }
   </i></font>x              <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ counter }
   </i></font>Wild_MP        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]; </font><font color="#008000"><i>{ Wildcard Main Part }
   </i></font>Wild_Ex        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]; </font><font color="#008000"><i>{ Wildcard Extention }
</i></font><font color="#FF0000"><b>begin
     </b></font>wildcardmatch <font color="#000080">:= </font>false<font color="#000080">; </font><font color="#008000"><i>{ Default }
     </i></font><font color="#FF0000"><b>if </b></font>wildcard <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">; </font><font color="#008000"><i>{ Wont match if there isn't a filespec! }
     { First... Convert to caps! }
     </i></font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>filename<font color="#000080">[</font>x<font color="#000080">] := </font>upcase<font color="#000080">(</font>filename<font color="#000080">[</font>x<font color="#000080">]);
     </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">12 </font><font color="#FF0000"><b>do </b></font>wildcard<font color="#000080">[</font>x<font color="#000080">] := </font>upcase<font color="#000080">(</font>wildcard<font color="#000080">[</font>x<font color="#000080">]);
     </font><font color="#008000"><i>{ Check if our file names are complete }
     </i></font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>filename<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>filename <font color="#000080">:= </font>filename <font color="#000080">+ </font><font color="#800000">'.???'</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>wildcard<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>wildcard <font color="#000080">:= </font>wildcard <font color="#000080">+ </font><font color="#800000">'.   '</font><font color="#000080">;
     </font><font color="#008000"><i>{ Now, Split our filename into its main part, and extention }
     </i></font>mainpart <font color="#000080">:= </font>copy<font color="#000080">(</font>filename<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>filename<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
     </font>extention <font color="#000080">:= </font>copy<font color="#000080">(</font>filename<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>filename<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
     </font>wild_mp <font color="#000080">:= </font>copy<font color="#000080">(</font>wildcard<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>wildcard<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">);
     </font>wild_ex <font color="#000080">:= </font>copy<font color="#000080">(</font>wildcard<font color="#000080">,</font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>wildcard<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
     </font><font color="#008000"><i>{ And Check that they are the right length }
     </i></font><font color="#FF0000"><b>while </b></font>length<font color="#000080">(</font>mainpart<font color="#000080">) &lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>do
           </b></font>mainpart <font color="#000080">:= </font>mainpart <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>length<font color="#000080">(</font>extention<font color="#000080">) &lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>do
           </b></font>extention <font color="#000080">:= </font>extention <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
     </font><font color="#008000"><i>{ Remeber - an asterisk fills a string out with ?s }
     </i></font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_mp<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      while </b></font>length<font color="#000080">(</font>wild_mp<font color="#000080">) &lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>do
       </b></font>wild_mp <font color="#000080">:= </font>wild_mp <font color="#000080">+ </font><font color="#800000">' '
     </font><font color="#FF0000"><b>else
      while </b></font>length<font color="#000080">(</font>wild_mp<font color="#000080">) &lt; </font><font color="#800000">8 </font><font color="#FF0000"><b>do
       </b></font>wild_mp <font color="#000080">:= </font>wild_mp <font color="#000080">+ </font><font color="#800000">'?'</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_ex<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      while </b></font>length<font color="#000080">(</font>wild_ex<font color="#000080">) &lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>do
       </b></font>wild_ex <font color="#000080">:= </font>wild_ex <font color="#000080">+ </font><font color="#800000">' '
     </font><font color="#FF0000"><b>else
      while </b></font>length<font color="#000080">(</font>wild_ex<font color="#000080">) &lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>do
       </b></font>wild_ex <font color="#000080">:= </font>wild_ex <font color="#000080">+ </font><font color="#800000">'?'</font><font color="#000080">;
     </font><font color="#008000"><i>{ Now to organize our asterisks... }
     </i></font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_mp<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
      </b></font>wild_mp<font color="#000080">[</font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_mp<font color="#000080">)] := </font><font color="#800000">'?'</font><font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_ex<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
      </b></font>wild_ex<font color="#000080">[</font>pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>wild_ex<font color="#000080">)] := </font><font color="#800000">'?'</font><font color="#000080">;
     </font><font color="#008000"><i>{ Now we need to check if they are compatible :) }
     </i></font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do
         if </b></font>wild_mp<font color="#000080">[</font>x<font color="#000080">] = </font><font color="#800000">'?' </font><font color="#FF0000"><b>then
            </b></font>wild_mp<font color="#000080">[</font>x<font color="#000080">] := </font>mainpart<font color="#000080">[</font>x<font color="#000080">];
     </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
         if </b></font>wild_ex<font color="#000080">[</font>x<font color="#000080">] = </font><font color="#800000">'?' </font><font color="#FF0000"><b>then
            </b></font>wild_ex<font color="#000080">[</font>x<font color="#000080">] := </font>extention<font color="#000080">[</font>x<font color="#000080">];
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>mainpart <font color="#000080">= </font>wild_mp<font color="#000080">) </font><font color="#FF0000"><b>and
        </b></font><font color="#000080">(</font>extention <font color="#000080">= </font>wild_ex<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>wildcardmatch <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CheckHeader<font color="#000080">(</font>fname <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#008000"><i>{ Check if 'fname' is a valid PAC file }
</i></font><font color="#FF0000"><b>var
   </b></font>infile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>fsearch<font color="#000080">(</font>fname<font color="#000080">,</font>getenv<font color="#000080">(</font><font color="#800000">'name'</font><font color="#000080">)) = </font><font color="#800000">'' </font><font color="#FF0000"><b>then
     begin
          </b></font>checkheader <font color="#000080">:= </font>false<font color="#000080">;
          </font>exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>assign<font color="#000080">(</font>infile<font color="#000080">,</font>fname<font color="#000080">);
     </font>reset<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>blockread<font color="#000080">(</font>infile<font color="#000080">,</font>header<font color="#000080">,</font>sizeof<font color="#000080">(</font>header<font color="#000080">));
     </font>blockread<font color="#000080">(</font>infile<font color="#000080">,</font>version<font color="#000080">,</font>sizeof<font color="#000080">(</font>version<font color="#000080">));
     </font>close<font color="#000080">(</font>infile<font color="#000080">);
     </font><font color="#008000"><i>{ Read in header/version }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>header <font color="#000080">= </font>pacheader<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>version <font color="#000080">= </font>pacversion<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>checkheader <font color="#000080">:= </font>true
     <font color="#FF0000"><b>else
         </b></font>checkheader <font color="#000080">:= </font>false<font color="#000080">;
     </font><font color="#008000"><i>{ Validate }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>version <font color="#000080">&lt;&gt; </font>pacversion<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>header <font color="#000080">= </font>pacheader<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>writeln<font color="#000080">(</font><font color="#800000">'Version Mismatch!'</font><font color="#000080">);
          </font>writeln<font color="#000080">(</font><font color="#800000">'Expected Version : '</font><font color="#000080">,</font>pacversion<font color="#000080">);
          </font>writeln<font color="#000080">(</font><font color="#800000">'Version Received : '</font><font color="#000080">,</font>version<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{ Show Error/wotever }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Extractfiles<font color="#000080">(</font>pacfilename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>outfile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#008000"><i>{ Output File }
   </i></font>pacfile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">; </font><font color="#008000"><i>{ .PAC File }
   </i></font>extractit <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#008000"><i>{ Used insead of ifs+elses }
   </i></font>numread<font color="#000080">,
   </font>numwrote  <font color="#000080">: </font>word<font color="#000080">; </font><font color="#008000"><i>{ amount of file read/written }
   </i></font>xpos<font color="#000080">,</font>ypos <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{ x/y positions on screen - for neatness }
</i></font><font color="#FF0000"><b>begin
     </b></font>extractit <font color="#000080">:= </font>false<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Searching Archive : '</font><font color="#000080">,</font>pacfilename<font color="#000080">);
     </font>assign<font color="#000080">(</font>pacfile<font color="#000080">,</font>pacfilename<font color="#000080">);
     </font>reset<font color="#000080">(</font>pacfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>header<font color="#000080">,</font>sizeof<font color="#000080">(</font>header<font color="#000080">));
     </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>version<font color="#000080">,</font>sizeof<font color="#000080">(</font>version<font color="#000080">));
     </font><font color="#008000"><i>{ Read header/version }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>header <font color="#000080">&lt;&gt; </font>pacheader<font color="#000080">) </font><font color="#FF0000"><b>or
        </b></font><font color="#000080">(</font>version <font color="#000080">&lt;&gt; </font>pacversion<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>writeln<font color="#000080">(</font><font color="#800000">'Major Stuff-up! : Header/version mismatch!'</font><font color="#000080">);
          </font>close<font color="#000080">(</font>pacfile<font color="#000080">);
          </font>halt<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{ validate header/version }
     </i></font><font color="#FF0000"><b>repeat
           </b></font>extractit <font color="#000080">:= </font>false<font color="#000080">;
           </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>fileheader<font color="#000080">,</font>sizeof<font color="#000080">(</font>fileheader<font color="#000080">));
           </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">20 </font><font color="#FF0000"><b>do
               if </b></font>wildcardmatch<font color="#000080">(</font>fileheader<font color="#000080">.</font>fname<font color="#000080">,</font>extractfile<font color="#000080">[</font>x<font color="#000080">]) </font><font color="#FF0000"><b>then
                  </b></font>extractit <font color="#000080">:= </font>true<font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font>extractit <font color="#FF0000"><b>then
           begin
                </b></font>writeln<font color="#000080">(</font><font color="#800000">'Extracting: '</font><font color="#000080">,</font>fileheader<font color="#000080">.</font>fname<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
                </font>xpos <font color="#000080">:= </font>wherex<font color="#000080">;
                </font>ypos <font color="#000080">:= </font>wherey<font color="#000080">;
                </font>assign<font color="#000080">(</font>outfile<font color="#000080">,</font>fileheader<font color="#000080">.</font>fname<font color="#000080">);
                </font>rewrite<font color="#000080">(</font>outfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font>extractit <font color="#FF0000"><b>then
           for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>fileheader<font color="#000080">.</font>fsize <font color="#FF0000"><b>div </b></font><font color="#800000">10240 </font><font color="#FF0000"><b>do
           begin
                </b></font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf<font color="#000080">),</font>numread<font color="#000080">);
                </font>blockwrite<font color="#000080">(</font>outfile<font color="#000080">,</font>buf<font color="#000080">,</font>numread<font color="#000080">,</font>numwrote<font color="#000080">);
           </font><font color="#FF0000"><b>end
           else
               </b></font>seek<font color="#000080">(</font>pacfile<font color="#000080">,</font>filepos<font color="#000080">(</font>pacfile<font color="#000080">)+</font>fileheader<font color="#000080">.</font>fsize<font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>extractit <font color="#FF0000"><b>then
           begin
                </b></font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>buf<font color="#000080">,(</font>fileheader<font color="#000080">.</font>fsize <font color="#FF0000"><b>mod </b></font><font color="#800000">10240</font><font color="#000080">),</font>numread<font color="#000080">);
                </font>blockwrite<font color="#000080">(</font>outfile<font color="#000080">,</font>buf<font color="#000080">,</font>numread<font color="#000080">);
                </font>close<font color="#000080">(</font>outfile<font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>until </b></font>eof<font color="#000080">(</font>pacfile<font color="#000080">);
     </font>close<font color="#000080">(</font>pacfile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Addfiles<font color="#000080">(</font>pacfilename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>Infile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
   </font>Pacfile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
   </font>numread<font color="#000080">,
   </font>numwrote  <font color="#000080">: </font>word<font color="#000080">;
   </font>DirInfo   <font color="#000080">: </font>SearchRec<font color="#000080">;
   </font>x<font color="#000080">,</font>y       <font color="#000080">: </font>integer<font color="#000080">;
   </font>xpos<font color="#000080">,</font>ypos <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>assign<font color="#000080">(</font>pacfile<font color="#000080">,</font>pacfilename<font color="#000080">);
     </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>pacfilename<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>pacfilename<font color="#000080">[</font>x<font color="#000080">] := </font>upcasE<font color="#000080">(</font>pacfilename<font color="#000080">[</font>x<font color="#000080">]);
     </font><font color="#FF0000"><b>if </b></font>fsearch<font color="#000080">(</font>pacfilename<font color="#000080">,</font>getenv<font color="#000080">(</font><font color="#800000">'name'</font><font color="#000080">)) = </font><font color="#800000">'' </font><font color="#FF0000"><b>then
     begin
          </b></font>rewrite<font color="#000080">(</font>pacfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font>header <font color="#000080">:= </font>pacheader<font color="#000080">;
          </font>version <font color="#000080">:= </font>pacversion<font color="#000080">;
          </font>blockwrite<font color="#000080">(</font>pacfile<font color="#000080">,</font>header<font color="#000080">,</font>sizeof<font color="#000080">(</font>header<font color="#000080">));
          </font>blockwrite<font color="#000080">(</font>pacfile<font color="#000080">,</font>version<font color="#000080">,</font>sizeof<font color="#000080">(</font>version<font color="#000080">));
          </font>writeln<font color="#000080">(</font><font color="#800000">'Creating PAC: '</font><font color="#000080">,</font>pacfilename<font color="#000080">);
     </font><font color="#FF0000"><b>end
     else
     begin
          </b></font>writeln<font color="#000080">(</font><font color="#800000">'Updating PAC: '</font><font color="#000080">,</font>pacfilename<font color="#000080">);
          </font>reset<font color="#000080">(</font>pacfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font>seek<font color="#000080">(</font>pacfile<font color="#000080">,</font>filesize<font color="#000080">(</font>pacfile<font color="#000080">));
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>FindFirst<font color="#000080">(</font><font color="#800000">'*.*'</font><font color="#000080">, </font>Archive<font color="#000080">, </font>DirInfo<font color="#000080">);
     </font><font color="#FF0000"><b>while </b></font>DosError <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
     begin
          for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do
              if </b></font>wildcardmatch<font color="#000080">(</font>dirinfo<font color="#000080">.</font>name<font color="#000080">,</font>extractfile<font color="#000080">[</font>x<font color="#000080">]) </font><font color="#FF0000"><b>then
               if </b></font>dirinfo<font color="#000080">.</font>name <font color="#000080">&lt;&gt; </font>pacfilename <font color="#FF0000"><b>then
                 begin
                      </b></font>x <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
                      </font>assign<font color="#000080">(</font>infile<font color="#000080">,</font>dirinfo<font color="#000080">.</font>name<font color="#000080">);
                      </font>reset<font color="#000080">(</font>infile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                      </font>fileheader<font color="#000080">.</font>fname <font color="#000080">:= </font>dirinfo<font color="#000080">.</font>name<font color="#000080">;
                      </font>fileheader<font color="#000080">.</font>fsize <font color="#000080">:= </font>filesize<font color="#000080">(</font>infile<font color="#000080">);
                      </font>blockwrite<font color="#000080">(</font>pacfile<font color="#000080">,</font>fileheader<font color="#000080">,</font>sizeof<font color="#000080">(</font>fileheader<font color="#000080">));
                      </font>write<font color="#000080">(</font><font color="#800000">'Adding: '</font><font color="#000080">,</font>fileheader<font color="#000080">.</font>fname<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
                      </font>xpos <font color="#000080">:= </font>wherex<font color="#000080">;
                      </font>ypos <font color="#000080">:= </font>wherey<font color="#000080">;
                      </font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                      </font><font color="#FF0000"><b>repeat
                                 </b></font>drawpercentage<font color="#000080">(</font>xpos<font color="#000080">,</font>ypos<font color="#000080">,</font>round<font color="#000080">(</font>filepos<font color="#000080">(</font>infile<font color="#000080">) / </font>fileheader<font color="#000080">.</font>fsize<font color="#000080">*</font><font color="#800000">100</font><font color="#000080">));
                                 </font><font color="#008000"><i>{writeln(round(filepos(infile) / fileheader.fsize*100));}
                            </i></font>blockread<font color="#000080">(</font>infile<font color="#000080">,</font>buf<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf<font color="#000080">),</font>numread<font color="#000080">);
                            </font>blockwrite<font color="#000080">(</font>pacfile<font color="#000080">,</font>buf<font color="#000080">,</font>numread<font color="#000080">,</font>numwrote<font color="#000080">);
                            </font>inc<font color="#000080">(</font>Y<font color="#000080">);
                      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>numread <font color="#000080">&lt;&gt; </font>numwrote<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>numread <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
                      </font>gotoxy<font color="#000080">(</font>xpos<font color="#000080">,</font>ypos<font color="#000080">);
                      </font><font color="#008000"><i>{write('[',filepos(infile) / fileheader.fsize*100:3:0,'%],Done.');}
                      </i></font>writeln<font color="#000080">;
                      </font>close<font color="#000080">(</font>infile<font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>FindNext<font color="#000080">(</font>DirInfo<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>close<font color="#000080">(</font>pacfile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ListFiles<font color="#000080">(</font>pacfilename <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>pacfile <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
   </font>numread<font color="#000080">,
   </font>numwrote <font color="#000080">: </font>word<font color="#000080">;
   </font>y         <font color="#000080">: </font>integer<font color="#000080">;
   </font>totalsize <font color="#000080">: </font>longint<font color="#000080">;
   </font>numfiles  <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>numfiles <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>totalsize <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>y <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'Searching Archive : '</font><font color="#000080">,</font>pacfilename<font color="#000080">);
     </font>assign<font color="#000080">(</font>pacfile<font color="#000080">,</font>pacfilename<font color="#000080">);
     </font>reset<font color="#000080">(</font>pacfile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>header<font color="#000080">,</font>sizeof<font color="#000080">(</font>header<font color="#000080">));
     </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>version<font color="#000080">,</font>sizeof<font color="#000080">(</font>version<font color="#000080">));
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>header <font color="#000080">&lt;&gt; </font>pacheader<font color="#000080">) </font><font color="#FF0000"><b>or
        </b></font><font color="#000080">(</font>version <font color="#000080">&lt;&gt; </font>pacversion<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>writeln<font color="#000080">(</font><font color="#800000">'Major Stuff-up! : Header/Version Mismatch!'</font><font color="#000080">);
          </font>close<font color="#000080">(</font>pacfile<font color="#000080">);
          </font>halt<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">' Filename                             Size'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'------------------------------------------'</font><font color="#000080">);
     </font><font color="#FF0000"><b>repeat
           </b></font>inc<font color="#000080">(</font>y<font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font>y <font color="#000080">= </font><font color="#800000">24 </font><font color="#FF0000"><b>then
           begin
                </b></font>write<font color="#000080">(</font><font color="#800000">'Press any key to continue.'</font><font color="#000080">);
                </font>readln<font color="#000080">;
                </font>y <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font>blockread<font color="#000080">(</font>pacfile<font color="#000080">,</font>fileheader<font color="#000080">,</font>sizeof<font color="#000080">(</font>fileheader<font color="#000080">));
           </font>writeln<font color="#000080">(</font>fileheader<font color="#000080">.</font>fname<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>fileheader<font color="#000080">.</font>fsize<font color="#000080">:</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">' bytes'</font><font color="#000080">);
           </font>seek<font color="#000080">(</font>pacfile<font color="#000080">,</font>filepos<font color="#000080">(</font>pacfile<font color="#000080">)+</font>fileheader<font color="#000080">.</font>fsize<font color="#000080">);
           </font>inc<font color="#000080">(</font>totalsize<font color="#000080">,</font>fileheader<font color="#000080">.</font>fsize<font color="#000080">);
           </font>inc<font color="#000080">(</font>numfiles<font color="#000080">);
           </font><font color="#008000"><i>{ Move past current file in pacfile, to next file header }
     </i></font><font color="#FF0000"><b>until </b></font>eof<font color="#000080">(</font>pacfile<font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'------------------------------------------'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font>numfiles<font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">' Files'</font><font color="#000080">,</font>totalsize<font color="#000080">:</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">' bytes'</font><font color="#000080">);
     </font>close<font color="#000080">(</font>pacfile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RunProgram<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>PacFileName <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>param        <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>PacFilename <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Pacfilename<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>Pacfilename <font color="#000080">:= </font>Pacfilename <font color="#000080">+ </font><font color="#800000">'.pac'</font><font color="#000080">;
     </font>param <font color="#000080">:= </font>paramstr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
     </font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>upcase<font color="#000080">(</font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>param<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>param<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>writeln<font color="#000080">(</font><font color="#800000">'And... what am I supposed to do now???'</font><font color="#000080">);
          </font>halt<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">'X'</font><font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          if </b></font>fsearch<font color="#000080">(</font>Pacfilename<font color="#000080">,</font>getenv<font color="#000080">(</font><font color="#800000">'name'</font><font color="#000080">)) = </font><font color="#800000">'' </font><font color="#FF0000"><b>then
          begin
               </b></font>writeln<font color="#000080">(</font><font color="#800000">'PAC File : '</font><font color="#000080">,</font>Pacfilename<font color="#000080">,</font><font color="#800000">' isn''t there, stupid!'</font><font color="#000080">);
               </font>halt<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
          begin
               </b></font>writeln<font color="#000080">(</font><font color="#800000">'No FileSpec... Assuming *.*'</font><font color="#000080">);
               </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
               </font>extractfile<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'*.*'</font><font color="#000080">;
          </font><font color="#FF0000"><b>end
          else
          begin
               for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
               </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>paramcount<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
                   </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font>paramstr<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>ExtractFiles<font color="#000080">(</font>Pacfilename<font color="#000080">); </font><font color="#008000"><i>{ procedure uses &quot;extractfile&quot; var }
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">'A' </font><font color="#FF0000"><b>then
     begin
          if </b></font>paramcount <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
          begin
               </b></font>writeln<font color="#000080">(</font><font color="#800000">'No Filespec... Assuming *.*'</font><font color="#000080">);
               </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
               </font>extractfile<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">'*.*'</font><font color="#000080">;
          </font><font color="#FF0000"><b>end
          else
          begin
               for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">10 </font><font color="#FF0000"><b>do </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
               </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>paramcount<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
                   </b></font>extractfile<font color="#000080">[</font>x<font color="#000080">] := </font>paramstr<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>AddFiles<font color="#000080">(</font>Pacfilename<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>param<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">'L' </font><font color="#FF0000"><b>then
     begin
          if </b></font>fsearch<font color="#000080">(</font>Pacfilename<font color="#000080">,</font>getenv<font color="#000080">(</font><font color="#800000">'name'</font><font color="#000080">)) = </font><font color="#800000">'' </font><font color="#FF0000"><b>then
          begin
               </b></font>writeln<font color="#000080">(</font><font color="#800000">'PAC File : '</font><font color="#000080">,</font>Pacfilename<font color="#000080">,</font><font color="#800000">' isn''t there, stupid!'</font><font color="#000080">);
               </font>halt<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>ListFiles<font color="#000080">(</font>Pacfilename<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{- Main Program -------------------------------------------------------------}

</i></font><font color="#FF0000"><b>begin
     </b></font>textbackground<font color="#000080">(</font>black<font color="#000080">);
     </font>clrscr<font color="#000080">;
     </font>writeln<font color="#000080">(</font><font color="#800000">'TPAC v1.7 by Tim Gordon  (This one uses wildcards!)'</font><font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'---------------------------------------------------'</font><font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>paramstr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'-?' </font><font color="#FF0000"><b>then
        </b></font>displayhelp<font color="#000080">; </font><font color="#008000"><i>{ Displays Help if -? parameter is used }
     </i></font><font color="#FF0000"><b>if </b></font>paramcount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>displayhelp<font color="#000080">; </font><font color="#008000"><i>{ Displays help if no parameters were used }
     </i></font>RunProgram<font color="#000080">; </font><font color="#008000"><i>{ Run Main program }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to ARCHIVES SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p></body>
</html>
