<html>
<head><title> "Character Case" by BO BENDTSEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to CHARS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
BO BendTSEN

  Upper/lower changing of Strings are always a difficult problem,
  but as a person living in Denmark i must normally care about
  danish Characters, i know a lot of developers does not care about
  international Character and just use the normal UPCASE routines.
  I advise you to use these routines or make some that has the
  same effect, so we will not have any problems when searching for
  uppercased Strings.

  Made available to everyone 1993 by Bo Bendtsen 2:231/111 +4542643827

     Lowcase   Upper/high/capital letters
              í
     õ         ù
     Ü         è
     Ñ         é
     á         &euro;
     Ç         ê
     î         &trade;
     &curren;         &yen;
     Å         ö

}

</i></font><font color="#FF0000"><b>Function </b></font>UpChar<font color="#000080">(</font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font>Char<font color="#000080">;
</font><font color="#008000"><i>{ Uppercase a Char }
</i></font><font color="#FF0000"><b>begin
  If </b></font>Ord<font color="#000080">(</font>Ch<font color="#000080">) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">97</font><font color="#000080">..</font><font color="#800000">122</font><font color="#000080">] </font><font color="#FF0000"><b>Then </b></font>Ch <font color="#000080">:= </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>Ch<font color="#000080">) - </font><font color="#800000">32</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else If </b></font>Ord<font color="#000080">(</font>Ch<font color="#000080">) &gt; </font><font color="#800000">90 </font><font color="#FF0000"><b>Then
    If </b></font>Ch<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'í'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'õ' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'ù' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'Ü' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'è'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'Ñ' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'é' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'á' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'&euro;'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'Ç' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'ê' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'î' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'&trade;'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'&curren;' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'&yen;' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'Å' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'ö'</font><font color="#000080">;
  </font>UpChar<font color="#000080">:=</font>Ch<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StUpCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Uppercase a String }
</i></font><font color="#FF0000"><b>Var
  </b></font>SLen <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>S<font color="#000080">;
  </font>x    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>SLen <font color="#FF0000"><b>Do </b></font>S<font color="#000080">[</font>x<font color="#000080">]:=</font>UpChar<font color="#000080">(</font>S<font color="#000080">[</font>x<font color="#000080">]);
  </font>StUpCase <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LowChar<font color="#000080">(</font>Ch <font color="#000080">: </font>Char<font color="#000080">) : </font>Char<font color="#000080">;
</font><font color="#008000"><i>{ lowercase a Char }
</i></font><font color="#FF0000"><b>begin
  If </b></font>Ord<font color="#000080">(</font>Ch<font color="#000080">) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">65</font><font color="#000080">..</font><font color="#800000">90</font><font color="#000080">] </font><font color="#FF0000"><b>Then </b></font>Ch <font color="#000080">:= </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>Ch<font color="#000080">) + </font><font color="#800000">32</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else If </b></font>Ord<font color="#000080">(</font>Ch<font color="#000080">) &gt; </font><font color="#800000">122 </font><font color="#FF0000"><b>Then
    If </b></font>Ch<font color="#000080">=</font><font color="#800000">'í' </font><font color="#FF0000"><b>Then </b></font>Ch <font color="#000080">:= </font><font color="#800000">' '
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'ù' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'õ' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'è' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'Ü'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'é' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'Ñ' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'&euro;' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'á'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'ê' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'Ç' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'&trade;' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'î'
    </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'&yen;' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'&curren;' </font><font color="#FF0000"><b>Else If </b></font>Ch<font color="#000080">=</font><font color="#800000">'ö' </font><font color="#FF0000"><b>Then </b></font>Ch<font color="#000080">:=</font><font color="#800000">'Å'</font><font color="#000080">;
  </font>LowChar <font color="#000080">:= </font>Ch<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StLowCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Lowercase a String }
</i></font><font color="#FF0000"><b>Var
  </b></font>SLen <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>S<font color="#000080">;
  </font>i    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>SLen <font color="#FF0000"><b>Do </b></font>S<font color="#000080">[</font>i<font color="#000080">]:=</font>LowChar<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]);
  </font>StLowCase <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StToggleCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ lower = upper and upper = lower }
</i></font><font color="#FF0000"><b>Var
  </b></font>SLen <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>S<font color="#000080">;
  </font>i    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>SLen <font color="#FF0000"><b>Do
  begin
    If </b></font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">65</font><font color="#000080">..</font><font color="#800000">90</font><font color="#000080">] </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font>i<font color="#000080">] := </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]) + </font><font color="#800000">32</font><font color="#000080">)
    </font><font color="#FF0000"><b>Else If </b></font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">97</font><font color="#000080">..</font><font color="#800000">122</font><font color="#000080">] </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font>i<font color="#000080">] := </font>Chr<font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]) - </font><font color="#800000">32</font><font color="#000080">)
    </font><font color="#FF0000"><b>Else If </b></font>Pos<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">],</font><font color="#800000">'õÜÑáÇî&curren;Å'</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font>i<font color="#000080">]:=</font>UpChar<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">])
    </font><font color="#FF0000"><b>Else If </b></font>Pos<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">],</font><font color="#800000">'íèù&euro;é&trade;êö&yen;'</font><font color="#000080">)&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font>i<font color="#000080">]:=</font>LowChar<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StToggleCase <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StSmartCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{ bO bEnDTSen will be converted into : Bo Bendtsen }
</i></font><font color="#FF0000"><b>Var
  </b></font>SLen <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font>S<font color="#000080">;
  </font>i    <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>s<font color="#000080">:=</font>StLowCase<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>SLen <font color="#FF0000"><b>Do
  begin
    If </b></font>i<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>UpChar<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])
    </font><font color="#FF0000"><b>Else if </b></font>S<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>S<font color="#000080">[</font>i<font color="#000080">]:=</font>UpChar<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">])
    </font><font color="#FF0000"><b>Else if </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">32</font><font color="#000080">..</font><font color="#800000">64</font><font color="#000080">]) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>Then
</b></font>S<font color="#000080">[</font>i<font color="#000080">]:=</font>UpChar<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StSmartCase <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to CHARS SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
