<html>
<head><title> "Parsing SubStrings" by THOMAS SCHEFFCZYK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">I don<font color="#800000">'t know if this will help you, but the following (simple) functions
</font>helped me handling substrings<font color="#000080">. </font>Perhaps you can use them <font color="#FF0000"><b>to </b></font>seperate
the text <font color="#FF0000"><b>for </b></font>each field <font color="#000080">(</font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NumToken <font color="#FF0000"><b>do </b></font><font color="#000080">...) </font><font color="#FF0000"><b>and </b></font>store it
seperatly <font color="#FF0000"><b>in </b></font>the database<font color="#000080">-</font>fields<font color="#000080">.

</font><font color="#FF0000"><b>function </b></font>GetToken<font color="#000080">(</font>aString<font color="#000080">, </font>SepChar<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>TokenNum<font color="#000080">: </font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{
parameters: aString : the complete string
            SepChar : a single character used as separator 
                      between the substrings
            TokenNum: the number of the substring you want
result    : the substring or an empty string if the are less then
            'TokenNum' substrings
}
</i></font><font color="#FF0000"><b>var
   </b></font>Token     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>StrLen    <font color="#000080">: </font>Byte<font color="#000080">;
   </font>TNum      <font color="#000080">: </font>Byte<font color="#000080">;
   </font>TEnd      <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>StrLen <font color="#000080">:= </font>Length<font color="#000080">(</font>aString<font color="#000080">);
     </font>TNum   <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>TEnd   <font color="#000080">:= </font>StrLen<font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>TNum <font color="#000080">&lt;= </font>TokenNum<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>TEnd <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>do
     begin
          </b></font>TEnd <font color="#000080">:= </font>Pos<font color="#000080">(</font>SepChar<font color="#000080">,</font>aString<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>TEnd <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          begin
               </b></font>Token <font color="#000080">:= </font>Copy<font color="#000080">(</font>aString<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TEnd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
               </font>Delete<font color="#000080">(</font>aString<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TEnd<font color="#000080">);
               </font>Inc<font color="#000080">(</font>TNum<font color="#000080">);
          </font><font color="#FF0000"><b>end
          else
          begin
               </b></font>Token <font color="#000080">:= </font>aString<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>TNum <font color="#000080">&gt;= </font>TokenNum <font color="#FF0000"><b>then
     begin
          </b></font>GetToken1 <font color="#000080">:= </font>Token<font color="#000080">;
     </font><font color="#FF0000"><b>end
     else
     begin
          </b></font>GetToken1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>NumToken<font color="#000080">(</font>aString<font color="#000080">, </font>SepChar<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Byte<font color="#000080">;
</font><font color="#008000"><i>{
parameters: aString : the complete string
            SepChar : a single character used as separator 
                      between the substrings
result    : the number of substrings
}

</i></font><font color="#FF0000"><b>var
   </b></font>RChar     <font color="#000080">: </font>Char<font color="#000080">;
   </font>StrLen    <font color="#000080">: </font>Byte<font color="#000080">;
   </font>TNum      <font color="#000080">: </font>Byte<font color="#000080">;
   </font>TEnd      <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
     if </b></font>SepChar <font color="#000080">= </font><font color="#800000">'#' </font><font color="#FF0000"><b>then
     begin
          </b></font>RChar <font color="#000080">:= </font><font color="#800000">'*'
     </font><font color="#FF0000"><b>end
     else
     begin
         </b></font>RChar <font color="#000080">:= </font><font color="#800000">'#'
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>StrLen <font color="#000080">:= </font>Length<font color="#000080">(</font>aString<font color="#000080">);
     </font>TNum   <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font>TEnd   <font color="#000080">:= </font>StrLen<font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>TEnd <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
     begin
          </b></font>Inc<font color="#000080">(</font>TNum<font color="#000080">);
          </font>TEnd <font color="#000080">:= </font>Pos<font color="#000080">(</font>SepChar<font color="#000080">,</font>aString<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>TEnd <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          begin
               </b></font>aString<font color="#000080">[</font>TEnd<font color="#000080">] := </font>RChar<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>NumToken1 <font color="#000080">:= </font>TNum<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
