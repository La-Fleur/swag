<html>
<head><title> "Command Line Parsing" by RYAN THOMPSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{===========================================================================
 BBS: Canada Remote Systems
From: RYAN THOMPSON
Subj: RE: COMMAND LINE PARSING

&gt;&gt;&gt; Quoting from Chet Kress to Frans Van Duinen about Command Line Parsing

CK&gt;  FVD&gt;I want to pass to my BP 7 program a few parameters, one of which
CK&gt;  FVD&gt;has embedded (or even trailing) blanks.  The naive approach of
CK&gt;  FVD&gt;PROCFAX  PROCFAX.CFG \PCB\MAIN\MSGS58  &quot;FAX MAIL&quot; does not work.
CK&gt;  FVD&gt;Currently  I pick up FAX and MAIL as two parameters and
CK&gt;  FVD&gt;string, but I want to allow multiple embedded/trailing blanks.

  Here's a set of routines to do just what you want.

  Parameters      Returns the number of parameters on the command line.  Does
                   not include switches.
  Parameter(n)    Returns the nth parameter, ignoring switches and passing
                   strings in quotes as &quot; or ' followed by the entire string
                   including any imbedded spaces.
  SwitchThere(x)  Returns True if the switch specified by the character
                   passed is present on the command line.
  SwitchData(x)   Returns the data following the switch character if the
                   switch character specified is present on the command line.
  SwitchNum(x)    Returns the position on the command line of the switch
                   specified.  Skips parameters. }


  </i></font><font color="#FF0000"><b>Function </b></font>SwitchNum<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>X<font color="#000080">,
      </font>Y <font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Temp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>X<font color="#000080">:= </font>ParamCount<font color="#000080">;
      </font>Y<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>X <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
        </b></font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>then
          if </b></font>UpCase<font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) = </font>UpString<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Y<font color="#000080">:= </font>X<font color="#000080">;
        </font>Dec<font color="#000080">(</font>X<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>SwitchNum<font color="#000080">:= </font>Y<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>SwitchThere<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>SwitchThere<font color="#000080">:= </font><font color="#FF0000"><b>not </b></font><font color="#000080">(</font>SwitchNum<font color="#000080">(</font>S<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>SwitchData<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      If </b></font>SwitchNum<font color="#000080">(</font>S<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>SwitchNum<font color="#000080">(</font>S<font color="#000080">));
        </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
      else </b></font>Temp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>SwitchData<font color="#000080">:= </font>Temp<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>Parameter<font color="#000080">(</font>N <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>X<font color="#000080">,
      </font>Count <font color="#000080">: </font>Byte<font color="#000080">;
      </font>Parm<font color="#000080">,
      </font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>X<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Count<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Parm<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then repeat
        </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
        </font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'&quot;'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>Parm<font color="#000080">:= </font>Temp<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&lt; </font>ParamCount <font color="#FF0000"><b>then repeat
            </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
            </font>Parm<font color="#000080">:= </font>Parm <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
          </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>Parm<font color="#000080">[</font>Length<font color="#000080">(</font>Parm<font color="#000080">)] = </font><font color="#800000">'&quot;'</font><font color="#000080">) </font><font color="#FF0000"><b>or
                </b></font><font color="#000080">(</font>Parm<font color="#000080">[</font>Length<font color="#000080">(</font>Parm<font color="#000080">)] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>X <font color="#000080">= </font>ParamCount<font color="#000080">);
          </font>Inc<font color="#000080">(</font>Count<font color="#000080">);
        </font><font color="#FF0000"><b>end
        else if </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'-'</font><font color="#000080">)
        </font><font color="#FF0000"><b>then begin
          </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
          </font>Parm<font color="#000080">:= </font>Temp<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>X <font color="#000080">= </font>ParamCount<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Count <font color="#000080">= </font>N<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Count <font color="#000080">= </font>N <font color="#FF0000"><b>then </b></font>Parameter<font color="#000080">:= </font>Parm
      <font color="#FF0000"><b>else </b></font>Parameter<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>Parameters <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Var
      </b></font>X <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>X<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        Repeat
          </b></font>Inc<font color="#000080">(</font>X<font color="#000080">)
        </font><font color="#FF0000"><b>Until </b></font>Parameter<font color="#000080">(</font>X<font color="#000080">) = </font><font color="#800000">''</font><font color="#000080">;
        </font>Parameters<font color="#000080">:= </font>X <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end
      else </b></font>Parameters<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{
  For example, the command line:

TESTPRG /C INPUT.DAT /X67 &quot;first one&quot;

        Parameters  returns  2
      Parameter(1)  returns  INPUT.DAT
      Parameter(2)  returns  &quot;first one
  SwitchThere('F')  returns  false
   SwitchData('X')  returns  67

  Notice that in quoted parameters, the first quote is returned- this allows
you to check for &quot; vs. ', which you could use as the difference between case
sensitive and non-case-sensitive.  A simple Delete(S,1,1) can remove it from
the string for use. }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0006.PAS">Original</a><b>]</b></p></body>
</html>
