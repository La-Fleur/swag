<html>
<head><title> "Command Line Parsing" by RYAN THOMPSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">08</font><font color="#000080">-</font><font color="#800000">10</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">01</font><font color="#000080">:</font><font color="#800000">00</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">33744
</font>From<font color="#000080">: </font>RYAN THOMPSON                Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>TERRY GRANT <font color="#000080">@ </font><font color="#800000">912</font><font color="#000080">/</font><font color="#800000">701         </font>Recvd<font color="#000080">: </font>NO  
Subj<font color="#000080">: </font>RE<font color="#000080">: </font>COMMAND LINE PARSING       Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
&gt;&gt;&gt; </font>Quoting <font color="#FF0000"><b>message </b></font>from Terry Grant <font color="#000080">@ </font><font color="#800000">912</font><font color="#000080">/</font><font color="#800000">701 </font><font color="#FF0000"><b>to </b></font>All
<font color="#000080">&gt;&gt;&gt; </font>Original sent <font color="#800000">07 </font>Aug <font color="#800000">93  20</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">:</font><font color="#800000">00 </font>about Command Line Parsing

TG<font color="#000080">&gt; </font>Hello All<font color="#000080">!
</font>TG<font color="#000080">&gt;
</font>TG<font color="#000080">&gt;  </font>After working <font color="#FF0000"><b>on </b></font>this <font color="#FF0000"><b>for </b></font>awhile<font color="#000080">, </font>I thought mabe someone <font color="#FF0000"><b>else </b></font>could help
TG<font color="#000080">&gt; </font>me <font color="#FF0000"><b>out </b></font>a little here<font color="#000080">. </font>All I need this <font color="#FF0000"><b>to do is </b></font>Parse the command line <font color="#FF0000"><b>for
</b></font>TG<font color="#000080">&gt; </font>seven parameters<font color="#000080">,
</font>TG<font color="#000080">&gt;
</font>TG<font color="#000080">&gt; </font>The BaudRate     <font color="#000080">(/</font>B<font color="#000080">),
</font>TG<font color="#000080">&gt; :
</font>TG<font color="#000080">&gt; </font><font color="#FF0000"><b>and </b></font>Overlay Size <font color="#000080">(/</font>O<font color="#000080">).
</font>TG<font color="#000080">&gt;
</font>TG<font color="#000080">&gt;  </font>My Main problem here <font color="#FF0000"><b>is</b></font><font color="#000080">, </font>it will SEE the command line<font color="#000080">, </font>But WILL <font color="#FF0000"><b>NOT </b></font>allow
TG<font color="#000080">&gt; </font>me <font color="#FF0000"><b>to </b></font>use anything AFTER the Switch <font color="#000080">? </font>Like <font color="#000080">/</font>B2400 <font color="#000080">!

  </font>Sure thing<font color="#000080">!  </font>I once wrote a <font color="#FF0000"><b>unit </b></font>which among other things has some neat
parsing <font color="#FF0000"><b>for </b></font>the command line<font color="#000080">.  </font>Here<font color="#800000">'s a snippet:

</font><font color="#008000"><i>{- Top -}

  </i></font><font color="#FF0000"><b>Function </b></font>SwitchNum<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
           </font><font color="#008000"><i>{ If a switch character specified exists, return which position }
           { it is in on the command line.  Used internally. }
    </i></font><font color="#FF0000"><b>Var
      </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>X<font color="#000080">,
      </font>Y <font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>Temp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>X<font color="#000080">:= </font>ParamCount<font color="#000080">;
      </font>Y<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>X <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
        </b></font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>then
          if </b></font>UpCase<font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) = </font>UpString<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Y<font color="#000080">:= </font>X<font color="#000080">;
        </font>Dec<font color="#000080">(</font>X<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>SwitchNum<font color="#000080">:= </font>Y<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>SwitchThere<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
           </font><font color="#008000"><i>{ Returns TRUE if a switch of the character specified exists. }
    </i></font><font color="#FF0000"><b>Begin
      If </b></font>SwitchNum<font color="#000080">(</font>S<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>SwitchThere<font color="#000080">:= </font>False
      <font color="#FF0000"><b>else </b></font>SwitchThere<font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>SwitchData<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
           </font><font color="#008000"><i>{ Return the data following a switch: /B2400 returns 2400. }
    </i></font><font color="#FF0000"><b>Var
      </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      If </b></font>SwitchNum<font color="#000080">(</font>S<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>SwitchNum<font color="#000080">(</font>S<font color="#000080">));
        </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
      else </b></font>Temp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>SwitchData<font color="#000080">:= </font>Temp<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>Parameter<font color="#000080">(</font>N <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
           </font><font color="#008000"><i>{ Returns the Nth command line parameter.  Parameters in quotes }
           { are returned with the spaces in between:  /D Test &quot;One Two&quot; }
           { Returns &gt;Test&lt; for Parameter(1) and &gt;&quot;One Two&lt; for Parameter(2) }
           { This allows you to, if you like, see what type of quote was }
           { used, for perhaps literal vs. translate to ALL CAPS. }
    </i></font><font color="#FF0000"><b>Var
      </b></font>X<font color="#000080">,
      </font>Count <font color="#000080">: </font>Byte<font color="#000080">;
      </font>Parm<font color="#000080">,
      </font>Temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>X<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Count<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Parm<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then repeat
        </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
        </font>Temp<font color="#000080">:= </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'&quot;'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>Parm<font color="#000080">:= </font>Temp<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>X <font color="#000080">&lt; </font>ParamCount <font color="#FF0000"><b>then repeat
            </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
            </font>Parm<font color="#000080">:= </font>Parm <font color="#000080">+ </font><font color="#800000">' ' </font><font color="#000080">+ </font>ParamStr<font color="#000080">(</font>X<font color="#000080">);
          </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>Parm<font color="#000080">[</font>Length<font color="#000080">(</font>Parm<font color="#000080">)] = </font><font color="#800000">'&quot;'</font><font color="#000080">) </font><font color="#FF0000"><b>or
                </b></font><font color="#000080">(</font>Parm<font color="#000080">[</font>Length<font color="#000080">(</font>Parm<font color="#000080">)] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>X <font color="#000080">= </font>ParamCount<font color="#000080">);
          </font>Inc<font color="#000080">(</font>Count<font color="#000080">);
        </font><font color="#FF0000"><b>end
        else if </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'/'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'-'</font><font color="#000080">)
        </font><font color="#FF0000"><b>then begin
          </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
          </font>Parm<font color="#000080">:= </font>Temp<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>X <font color="#000080">= </font>ParamCount<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Count <font color="#000080">= </font>N<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Count <font color="#000080">= </font>N <font color="#FF0000"><b>then </b></font>Parameter<font color="#000080">:= </font>Parm
      <font color="#FF0000"><b>else </b></font>Parameter<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>Function </b></font>Parameters <font color="#000080">: </font>Byte<font color="#000080">;
           </font><font color="#008000"><i>{ Return the number of non-switch parameters on the command line. }
    </i></font><font color="#FF0000"><b>Var
      </b></font>X <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>Begin
      </b></font>X<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        Repeat
          </b></font>Inc<font color="#000080">(</font>X<font color="#000080">)
        </font><font color="#FF0000"><b>Until </b></font>Parameter<font color="#000080">(</font>X<font color="#000080">) = </font><font color="#800000">''</font><font color="#000080">;
        </font>Parameters<font color="#000080">:= </font>X <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end
      else </b></font>Parameters<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{- Fin -}

  </i></font>A few examples<font color="#000080">:

  </font><font color="#FF0000"><b>If </b></font>SwitchThere<font color="#000080">(</font><font color="#800000">'?'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>DisplayHelp<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>SwitchThere<font color="#000080">(</font><font color="#800000">'B'</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>BaudString<font color="#000080">:= </font>SwitchData<font color="#000080">(</font><font color="#800000">'B'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Parameters <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then begin </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Too few parms'</font><font color="#000080">); </font>Halt<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>X<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Parameters <font color="#FF0000"><b>do
  begin
    </b></font>Param<font color="#000080">[</font>X<font color="#000080">]:= </font>Parameter<font color="#000080">(</font>X<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Sample command lines<font color="#000080">:

  </font>TESTPROG <font color="#000080">/</font>D <font color="#000080">/</font>F TEST <font color="#000080">/</font>B2400 <font color="#000080">&quot;</font>This <font color="#FF0000"><b>is </b></font>a test<font color="#000080">&quot; /</font>M<font color="#000080">-

  </font>Parameters returns <font color="#800000">2</font><font color="#000080">,
  </font>Parameter<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) </font>returns TEST
  Parameter<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) </font>returns <font color="#000080">&quot;</font>This <font color="#FF0000"><b>is </b></font>a test
  SwitchThere<font color="#000080">(</font><font color="#800000">'L'</font><font color="#000080">) </font>returns False
  SwitchData<font color="#000080">(</font><font color="#800000">'M'</font><font color="#000080">) </font>returns <font color="#000080">-
  </font>SwitchData<font color="#000080">(</font><font color="#800000">'G'</font><font color="#000080">) </font>returns null<font color="#000080">.

  </font>I hope this helps you <font color="#FF0000"><b>out</b></font><font color="#000080">!  </font>It could be optimized a lot by simply reading
all <font color="#FF0000"><b>of </b></font>the parameters into an <font color="#FF0000"><b>array in </b></font>your <font color="#FF0000"><b>initialization </b></font>code<font color="#000080">, </font><font color="#FF0000"><b>to </b></font>eliminate
all <font color="#FF0000"><b>of </b></font>the redundant parsing<font color="#000080">, </font>but I don<font color="#800000">'t think that parsing time for a few
</font>hundred characters at most <font color="#FF0000"><b>is </b></font>a limiting factor <font color="#FF0000"><b>of </b></font>any sort<font color="#000080">.  ;-)

</font>bye
Ryan

<font color="#000080">--- </font>Renegade v07<font color="#000080">-</font><font color="#800000">17 </font>Beta

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
