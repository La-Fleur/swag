<html>
<head><title> "Pattern Matching and checking" by FERNAND LEMOINE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>UNIT </b></font>match<font color="#000080">;

 </font><font color="#008000"><i>(*  DESCRIPTION :
  * 12 tests of character sets
  * 8  new string operators
  * Pattern matching  and mask checking

     RELEASE     :  2.0
     DATE        :  09/08/93
     AUTHOR      :  Fernand LEMOINE
                    rue du Colläge 34
                    B-6200 CHATELET
                    BELGIQUE
     All code granted to the public domain
     Questions and comments are welcome
     REQUIREMENT :  Turbo Pascal 4.0 or later
                    OPSTRING,OPABSFLD (Object Professional) from
                       Turbo Power Software
     Compatible with Borland Pascal protected mode
  *)


</i></font><font color="#FF0000"><b>INTERFACE
CONST
  </b></font>NullNumber <font color="#000080">= - </font>MaxInt<font color="#000080">;      </font><font color="#008000"><i>(* reserved for future use *)
  </i></font>BlankChar      <font color="#000080">: </font><font color="#FF0000"><b>SET OF </b></font>Char <font color="#000080">= [</font><font color="#800000">#32</font><font color="#000080">];
  </font>UpperOnlyset   <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font><font color="#800000">#128</font><font color="#000080">,</font><font color="#800000">#142</font><font color="#000080">..</font><font color="#800000">#144</font><font color="#000080">,
                                  </font><font color="#800000">#153</font><font color="#000080">,</font><font color="#800000">#154</font><font color="#000080">,</font><font color="#800000">#165</font><font color="#000080">];
  </font>LowerOnlyset   <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font><font color="#800000">#129</font><font color="#000080">..</font><font color="#800000">#141</font><font color="#000080">,</font><font color="#800000">#145</font><font color="#000080">,</font><font color="#800000">#147</font><font color="#000080">..</font><font color="#800000">#152</font><font color="#000080">,
                                 </font><font color="#800000">#160</font><font color="#000080">..</font><font color="#800000">#164</font><font color="#000080">];
  </font>ForeignSet     <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">#128</font><font color="#000080">..</font><font color="#800000">#154</font><font color="#000080">,</font><font color="#800000">#160</font><font color="#000080">..</font><font color="#800000">#167</font><font color="#000080">];
  </font>CntrlSet       <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">#0</font><font color="#000080">..</font><font color="#800000">#31</font><font color="#000080">,</font><font color="#800000">#127</font><font color="#000080">];
  </font>PunctSet       <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">#33</font><font color="#000080">,</font><font color="#800000">#39</font><font color="#000080">..</font><font color="#800000">#41</font><font color="#000080">,</font><font color="#800000">#44</font><font color="#000080">..</font><font color="#800000">#47</font><font color="#000080">,</font><font color="#800000">#58</font><font color="#000080">..</font><font color="#800000">#59</font><font color="#000080">,</font><font color="#800000">#63</font><font color="#000080">];
  </font>GraphicSet     <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">#176</font><font color="#000080">..</font><font color="#800000">#223</font><font color="#000080">];
  </font>PrintOnlyset   <font color="#000080">: </font><font color="#FF0000"><b>SET of </b></font>Char <font color="#000080">= [</font><font color="#800000">#32</font><font color="#000080">..</font><font color="#800000">#126</font><font color="#000080">,</font><font color="#800000">#128</font><font color="#000080">..</font><font color="#800000">#254</font><font color="#000080">];
  </font>SpecificSet <font color="#000080">:    </font><font color="#FF0000"><b>SET OF </b></font>Char <font color="#000080">= []; </font><font color="#008000"><i>(* must be modified by user *)
  </i></font>Delims <font color="#000080">:         </font><font color="#FF0000"><b>SET OF </b></font>Char <font color="#000080">= [</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">','</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">];
  </font>ProperSet <font color="#000080">:      </font><font color="#FF0000"><b>SET OF </b></font>Char <font color="#000080">= [</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">];

</font><font color="#FF0000"><b>TYPE
  </b></font>MatchOperator <font color="#000080">= (</font>like<font color="#000080">, </font>nsequal<font color="#000080">, </font>between<font color="#000080">, </font>not_between<font color="#000080">,
                   </font>into<font color="#000080">, </font>not_into<font color="#000080">, </font>pattern<font color="#000080">, </font>mask<font color="#000080">);

</font><font color="#008000"><i>(* Does the string S contain ONLY Alphabetic characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsAlphabetic<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY upper case characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsUpperCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY lower case characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsLowerCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Are the first characters of a name or a first name into S
    a upper case  character,
    and the others  lower case  characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsMixedCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY a space    character  ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsSpace<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY a null character ('') ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsNullString<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY a null     number     ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsNullNumber<font color="#000080">(</font>N <font color="#000080">: </font>Real<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY a number ('0'.. '9'   ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsNumber<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY number
                                 space, minus and comma characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsDigit<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY number,space, minus and comma
                                 'E' or 'e'  characters  ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsScientific<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY number and 'A'..'F' characters ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsXdigit<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>(* Does the string S contain ONLY characters in an user-defined set ? *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IsSpecific<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;

</font><font color="#008000"><i>(*      The string S is compared  with the string P  by a match operator :

    like        : phonetic comparison
    nsequal     : not strictly equal ---&gt; no difference between upper and
                  lower case, neither trailing nor leading spaces
    between     : between lower and upper limit
    not_between : negation of BETWEEN
    into        : selection in a value list
    not_into    : negation of INTO
    pattern     : matching a pattern with wildcards
                  * : any single character
                  ? : any series of characters
                  ~ : NOT
    mask;       : enables selected position of a field to be checked for a
                  specific content
      '-' : position that is not to be checked
      'A' : check for alphabetic characters ( upper or lower case)
      'a' : check for upper case alphabetic characters
      'l' : check for lower case alphabetic characters
      'K' : check for hexadecimal content
      '@' : check for number;
      '#' : check for digit;
      'E' : check for number in exponential notation
      'B' : check for blank
      '%' : check for percent
      'f' : check for foreign characters
      'u' : check for punctuation ! ' ( ) , - . / : ; ?
      'g' : check for semi-graphic characters
      'o' : check for control characters
      'p' : check for any printing characters
      'B' : check for characters in BooleanSet
      'Y' : check for characters in YesNoSet
 *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>DMatch<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>op <font color="#000080">: </font>MatchOperator<font color="#000080">; </font>P <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION
USES </b></font>opstring<font color="#000080">, </font>opabsfld<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>tmp <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>errormask <font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#008000"><i>(*-------------------------   String handling  ------------------------------------------------*)

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>IsAlphabetic<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>AlphaOnlySet<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsAlphabetic <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsUpperCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>UpperOnlyset<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsUpperCase <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsLowerCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>LowerOnlyset<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsLowerCase <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsMixedCase<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>noword<font color="#000080">, </font>nopos1<font color="#000080">, </font>nopos2<font color="#000080">, </font>i <font color="#000080">: </font>Byte<font color="#000080">;
    </font>inter <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>noword <font color="#000080">:= </font>WordCount<font color="#000080">(</font>S<font color="#000080">, </font>ProperSet<font color="#000080">);
    </font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>noword<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>nopos1 <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>i<font color="#000080">, </font>S<font color="#000080">, </font>ProperSet<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt; </font>noword <font color="#FF0000"><b>THEN
        </b></font>nopos2 <font color="#000080">:= (</font>WordPosition<font color="#000080">(</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>S<font color="#000080">, </font>ProperSet<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">)
      </font><font color="#FF0000"><b>ELSE
        </b></font>nopos2 <font color="#000080">:= </font>Length<font color="#000080">(</font>S<font color="#000080">);
      </font>inter <font color="#000080">:= </font>Copy<font color="#000080">(</font>S<font color="#000080">, </font>nopos1<font color="#000080">, </font>nopos2<font color="#000080">);
      </font>tmp <font color="#000080">:= </font>IsUpperCase<font color="#000080">(</font>inter<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>IF </b></font>tmp <font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Delete<font color="#000080">(</font>inter<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>tmp <font color="#000080">:= </font>IsLowerCase<font color="#000080">(</font>inter<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsMixedCase <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsSpace<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF </b></font>S <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>THEN
      </b></font>IsSpace <font color="#000080">:= </font>S <font color="#000080">= </font>CharStr<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Length<font color="#000080">(</font>S<font color="#000080">))
    </font><font color="#FF0000"><b>ELSE
      </b></font>IsSpace <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsNullString<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>IsNullString <font color="#000080">:= </font>S <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>FUNCTION </b></font>IsNullNumber<font color="#000080">(</font>N <font color="#000080">: </font>Real<font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>IsNullNumber <font color="#000080">:= </font>N <font color="#000080">= </font>NullNumber<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsNumber<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">(</font>NumberOnlySet <font color="#000080">- </font>BlankChar<font color="#000080">); </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsNumber <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsDigit<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>DigitOnlySet<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsDigit <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsScientific<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>ScientificSet<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsScientific <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsXdigit<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>HexOnlySet<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsXdigit <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>IsSpecific<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
    BEGIN
      </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>SpecificSet<font color="#000080">; </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>IsSpecific <font color="#000080">:= </font>tmp<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#008000"><i>(*-------------------------   Pattern matching ------------------------------------------------*)

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>DMatch<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>op <font color="#000080">: </font>MatchOperator<font color="#000080">; </font>P <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>S1<font color="#000080">, </font>S2<font color="#000080">, </font>S3 <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>Compar <font color="#000080">: </font>compareType<font color="#000080">;
    </font>Ind<font color="#000080">, </font>J<font color="#000080">, </font>N<font color="#000080">, </font>Nprime <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>except </b></font><font color="#000080">: </font>Boolean<font color="#000080">;


    </font><font color="#FF0000"><b>FUNCTION </b></font>PtInterr<font color="#000080">(</font>S<font color="#000080">, </font>P <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>VAR
      </b></font>tmp <font color="#000080">: </font>Boolean<font color="#000080">;
      </font>i <font color="#000080">: </font>Byte<font color="#000080">;

    </font><font color="#FF0000"><b>BEGIN
      </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
      BEGIN
        IF </b></font>P<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'?' </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">] = </font>P<font color="#000080">[</font>i<font color="#000080">];
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>Inc<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>PtInterr <font color="#000080">:= </font>tmp<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>FUNCTION </b></font>Aster<font color="#000080">(</font>S<font color="#000080">, </font>P <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>VAR </b></font>N <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>BEGIN
      </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">;
      </font>N <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">, </font>P<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>N <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Delete<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>tmp <font color="#000080">:= </font>PtInterr<font color="#000080">(</font>Copy<font color="#000080">(</font>S<font color="#000080">, </font>Length<font color="#000080">(</font>S<font color="#000080">) -
                             </font>Length<font color="#000080">(</font>P<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>P<font color="#000080">)), </font>P<font color="#000080">);
        </font>Aster <font color="#000080">:= </font>tmp<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>IF </b></font>N <font color="#000080">= </font>Length<font color="#000080">(</font>P<font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Delete<font color="#000080">(</font>P<font color="#000080">, </font>Length<font color="#000080">(</font>P<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
        </font>tmp <font color="#000080">:= </font>PtInterr<font color="#000080">(</font>Copy<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>P<font color="#000080">)), </font>P<font color="#000080">);
        </font>Aster <font color="#000080">:= </font>tmp<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>BEGIN
    </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>op <font color="#FF0000"><b>OF
      </b></font>like <font color="#000080">: </font>DMatch <font color="#000080">:= </font>Soundex<font color="#000080">(</font>S<font color="#000080">) = </font>Soundex<font color="#000080">(</font>P<font color="#000080">);
      </font>nsequal <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>S1 <font color="#000080">:= </font>Trim<font color="#000080">(</font>S<font color="#000080">); </font>S2 <font color="#000080">:= </font>Trim<font color="#000080">(</font>P<font color="#000080">);
          </font>Compar <font color="#000080">:= </font>CompUCString<font color="#000080">(</font>S1<font color="#000080">, </font>S2<font color="#000080">);
          </font>DMatch <font color="#000080">:= </font>Compar <font color="#000080">= </font>equal<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>between <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>N <font color="#000080">:= </font>WordPosition<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
          </font>DMatch <font color="#000080">:= (</font>Copy<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>N <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">) &lt; </font>S<font color="#000080">)
          </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>S <font color="#000080">&lt; </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, (</font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)));
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>not_between <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>N <font color="#000080">:= </font>WordPosition<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
          </font>DMatch <font color="#000080">:= (</font>S <font color="#000080">&lt; </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>N <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">))
          </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>S <font color="#000080">&gt; </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, (</font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)));
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font>into <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>tmp <font color="#000080">:= </font>False<font color="#000080">; </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>Ind <font color="#000080">:= </font>WordCount<font color="#000080">(</font>P<font color="#000080">, </font>Delims<font color="#000080">);
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>J <font color="#000080">&lt;= </font>Ind<font color="#000080">) </font><font color="#FF0000"><b>AND NOT </b></font>tmp <font color="#FF0000"><b>DO
          BEGIN
            </b></font>N <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>J<font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>J <font color="#000080">&lt; </font>Ind <font color="#FF0000"><b>THEN
            BEGIN
              </b></font>Nprime <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
              </font>tmp <font color="#000080">:= </font>S <font color="#000080">= </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, </font>Nprime <font color="#000080">- </font>N <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
            </font><font color="#FF0000"><b>END
            ELSE
              </b></font>tmp <font color="#000080">:= </font>S <font color="#000080">= </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, (</font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
            </font>Inc<font color="#000080">(</font>J<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>DMatch <font color="#000080">:= </font>tmp<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font>not_into <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>Ind <font color="#000080">:= </font>WordCount<font color="#000080">(</font>P<font color="#000080">, </font>Delims<font color="#000080">);
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>J <font color="#000080">&lt;= </font>Ind<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
          BEGIN
            </b></font>N <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>J<font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>J <font color="#000080">&lt; </font>Ind <font color="#FF0000"><b>THEN
            BEGIN
              </b></font>Nprime <font color="#000080">:= </font>WordPosition<font color="#000080">(</font>J <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>P<font color="#000080">, </font>Delims<font color="#000080">);
              </font>tmp <font color="#000080">:= </font>S <font color="#000080">&lt;&gt; </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, </font>Nprime <font color="#000080">- </font>N <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
            </font><font color="#FF0000"><b>END
            ELSE
              </b></font>tmp <font color="#000080">:= </font>S <font color="#000080">&lt;&gt; </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N<font color="#000080">, (</font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">));
            </font>Inc<font color="#000080">(</font>J<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>DMatch <font color="#000080">:= </font>tmp<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font>pattern <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN

          except </b></font><font color="#000080">:= </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">'~'</font><font color="#000080">;
          </font><font color="#FF0000"><b>IF except THEN </b></font>Delete<font color="#000080">(</font>P<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
          </font>N <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">, </font>P<font color="#000080">);
          </font>Nprime <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">, </font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>P<font color="#000080">) - </font>N<font color="#000080">)) + </font>N<font color="#000080">;
          </font><font color="#FF0000"><b>IF </b></font>Nprime <font color="#000080">&gt; </font>N <font color="#FF0000"><b>THEN
            </b></font>tmp <font color="#000080">:= </font>Pos<font color="#000080">(</font>Copy<font color="#000080">(</font>P<font color="#000080">, </font>N <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Nprime <font color="#000080">- </font>N <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">), </font>S<font color="#000080">) &lt;&gt; </font><font color="#800000">0
          </font><font color="#FF0000"><b>ELSE
            IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">, </font>P<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
              </b></font>tmp <font color="#000080">:= </font>Aster<font color="#000080">(</font>S<font color="#000080">, </font>P<font color="#000080">)
          </font><font color="#FF0000"><b>ELSE
            IF </b></font>Pos<font color="#000080">(</font><font color="#800000">'?'</font><font color="#000080">, </font>P<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
              </b></font>tmp <font color="#000080">:= </font>PtInterr<font color="#000080">(</font>S<font color="#000080">, </font>P<font color="#000080">)
          </font><font color="#FF0000"><b>ELSE
            </b></font>tmp <font color="#000080">:= </font>S <font color="#000080">= </font>P<font color="#000080">;
          </font><font color="#FF0000"><b>IF except THEN </b></font>DMatch <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>tmp
          <font color="#FF0000"><b>ELSE </b></font>DMatch <font color="#000080">:= </font>tmp<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font>mask <font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>tmp <font color="#000080">:= </font>True<font color="#000080">; </font>J <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>errormask <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>J <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>P<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font>tmp <font color="#FF0000"><b>DO
          BEGIN
            CASE </b></font>P<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>OF
              </b></font><font color="#800000">'-' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN END</b></font><font color="#000080">;
              </font><font color="#800000">'A' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>AlphaOnlySet<font color="#000080">;
              </font><font color="#800000">'a' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>UpperOnlyset<font color="#000080">;
              </font><font color="#800000">'l' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>LowerOnlyset<font color="#000080">;
              </font><font color="#800000">'K' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>HexOnlySet<font color="#000080">;
              </font><font color="#800000">'@' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>NumberOnlySet <font color="#000080">- </font>BlankChar<font color="#000080">;
              </font><font color="#800000">'#' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>DigitOnlySet<font color="#000080">;
              </font><font color="#800000">'E' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>ScientificSet<font color="#000080">;
              </font><font color="#800000">'B' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>BlankChar<font color="#000080">;
              </font><font color="#800000">'%' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] = </font><font color="#800000">'%'</font><font color="#000080">;
              </font><font color="#800000">'f' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>ForeignSet<font color="#000080">;
              </font><font color="#800000">'u' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>PunctSet<font color="#000080">;
              </font><font color="#800000">'g' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>GraphicSet<font color="#000080">;
              </font><font color="#800000">'o' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>CntrlSet<font color="#000080">;
              </font><font color="#800000">'p' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>PrintOnlyset<font color="#000080">;
              </font><font color="#800000">'B' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>BooleanSet<font color="#000080">;
              </font><font color="#800000">'Y' </font><font color="#000080">: </font>tmp <font color="#000080">:= </font>S<font color="#000080">[</font>J<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font>YesNoSet<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font>tmp <font color="#000080">= </font>False <font color="#FF0000"><b>THEN </b></font>errormask <font color="#000080">:= </font>J<font color="#000080">;
            </font>Inc<font color="#000080">(</font>J<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>DMatch <font color="#000080">:= </font>tmp<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{  ----------------  DEMO PROGRAM ------------- }

</i></font><font color="#FF0000"><b>program </b></font>demmatch<font color="#000080">;
</font><font color="#008000"><i>(* Demonstration program for use of match unit *)

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>match<font color="#000080">;
</font><font color="#FF0000"><b>var

  </b></font>S<font color="#000080">,</font>S1<font color="#000080">,</font>S2  <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>OK <font color="#000080">: </font>boolean<font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>clrscr<font color="#000080">;
  </font>S <font color="#000080">:= </font><font color="#800000">'Jean Lemonier'</font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Demo match unit '</font><font color="#000080">);</font>writeln<font color="#000080">;
  </font>Writeln <font color="#000080">(</font><font color="#800000">' Jean Lemonier'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Alphabetic ? '</font><font color="#000080">,</font>IsAlphabetic <font color="#000080">(</font>S<font color="#000080">));
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Upper case ? '</font><font color="#000080">,</font>IsUpperCase  <font color="#000080">(</font>S<font color="#000080">));
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Mixed case ? '</font><font color="#000080">,</font>IsMixedcase  <font color="#000080">(</font>S<font color="#000080">));

  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">( </font><font color="#800000">'154.5'</font><font color="#000080">);</font>writeln<font color="#000080">;
  </font>S2 <font color="#000080">:=  </font><font color="#800000">'154.5'</font><font color="#000080">;
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Number ? '</font><font color="#000080">,</font>IsNumber <font color="#000080">(</font>S2<font color="#000080">));
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Digit  ? '</font><font color="#000080">,</font>IsDigit  <font color="#000080">(</font>S2<font color="#000080">));

  </font>S1<font color="#000080">:= </font><font color="#800000">' Jean LEMONIER  '</font><font color="#000080">; </font>S2 <font color="#000080">:= </font><font color="#800000">'Je'</font><font color="#000080">;
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Equivalent '</font><font color="#000080">,</font>S<font color="#000080">, </font><font color="#800000">' '</font><font color="#000080">,</font>S1 <font color="#000080">,</font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>nsequal<font color="#000080">,</font>S1<font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Je*,pattern,'</font><font color="#000080">,</font>s<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>pattern<font color="#000080">,</font><font color="#800000">'Je*'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'De*,pattern,'</font><font color="#000080">,</font>s<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>pattern<font color="#000080">,</font><font color="#800000">'De*'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'*er,pattern,'</font><font color="#000080">,</font>s<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>pattern<font color="#000080">,</font><font color="#800000">'*er'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'????? Lemonier,pattern,'</font><font color="#000080">,</font>s<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,
          </font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>pattern<font color="#000080">,</font><font color="#800000">'????? Lemonier'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'???? Lemonier,pattern,'</font><font color="#000080">,</font>s<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,
          </font>Dmatch<font color="#000080">(</font>S<font color="#000080">,</font>pattern<font color="#000080">,</font><font color="#800000">'???? Lemonier'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'ll,mask '</font><font color="#000080">,</font>s2<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S2<font color="#000080">,</font>mask<font color="#000080">,</font><font color="#800000">'ll'</font><font color="#000080">));
  </font>Writeln<font color="#000080">(</font><font color="#800000">'al,mask '</font><font color="#000080">,</font>s2<font color="#000080">, </font><font color="#800000">'? '</font><font color="#000080">,</font>Dmatch<font color="#000080">(</font>S2<font color="#000080">,</font>mask<font color="#000080">,</font><font color="#800000">'al'</font><font color="#000080">));
  </font>delay<font color="#000080">(</font><font color="#800000">2500</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to PARSING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0009.PAS">Original</a><b>]</b></p></body>
</html>
