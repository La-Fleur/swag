<html>
<head><title> "Read CTRL/ALT/SHIFT Keys" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I was sitting here thinking about how usefull it would be to be able
&gt; to check the status of the different Locks (eg. scroll lock, num lock
&gt; or how to do it.  I think it is some sort of Bios or Dos service??
&gt; Any help would be greatly appreciated.

The easiest way is to access BIOS memory at address 40h:17h

}
</i></font><font color="#FF0000"><b>Procedure </b></font>TestKeys<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Scroll_Lock<font color="#000080">,
  </font>Caps_Lock<font color="#000080">,
  </font>Num_Lock<font color="#000080">,
  </font>Ins<font color="#000080">,
  </font>Alt<font color="#000080">,
  </font>Ctrl<font color="#000080">,
  </font>Left_Shift<font color="#000080">,
  </font>Right_Shift <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Bios_Keys   <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Ins           <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$80</font><font color="#000080">);
  </font>Caps_Lock     <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$40</font><font color="#000080">) = </font><font color="#800000">$40</font><font color="#000080">);
  </font>Num_Lock      <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$20</font><font color="#000080">) = </font><font color="#800000">$20</font><font color="#000080">);
  </font>Scroll_Lock   <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$10</font><font color="#000080">);
  </font>Alt           <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$8</font><font color="#000080">)  = </font><font color="#800000">$8</font><font color="#000080">);
  </font>Ctrl          <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$4</font><font color="#000080">)  = </font><font color="#800000">$4</font><font color="#000080">);
  </font>Left_Shift    <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$2</font><font color="#000080">)  = </font><font color="#800000">$2</font><font color="#000080">);
  </font>Right_Shift   <font color="#000080">:= ((</font>Bios_Keys <font color="#FF0000"><b>And </b></font><font color="#800000">$1</font><font color="#000080">)  = </font><font color="#800000">$1</font><font color="#000080">);

  </font>Writeln<font color="#000080">(</font><font color="#800000">'Insert      : '</font><font color="#000080">, </font>Ins<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'CapsLock    : '</font><font color="#000080">, </font>Caps_Lock<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'NumLock     : '</font><font color="#000080">, </font>Num_Lock<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'ScrollLock  : '</font><font color="#000080">, </font>Scroll_Lock<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Alt         : '</font><font color="#000080">, </font>Alt<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Control     : '</font><font color="#000080">, </font>Ctrl<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Left Shift  : '</font><font color="#000080">, </font>Left_Shift<font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Right Shift : '</font><font color="#000080">, </font>Right_Shift<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TestKeys<font color="#000080">;
  </font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
