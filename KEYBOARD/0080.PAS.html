<html>
<head><title> "Keyboard lights" by FLORIAN ANSORGE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 ER&gt; Anyway, Does anyone knows who to make the num/caps/scroll leds on the
 ER&gt; keyboard 'flicker' or just light up?
}

</i></font><font color="#FF0000"><b>PROGRAM </b></font>FlashLED<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>LOCKSOFF <font color="#000080">= </font><font color="#800000">$8F</font><font color="#000080">;  </font><font color="#008000"><i>{ Mask off all LEDs }
  </i></font>SCRLOCK  <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;
  </font>NUMLOCK  <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;
  </font>CAPLOCK  <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>KeyLocks  <font color="#000080">: </font>BYTE <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">;  </font><font color="#008000"><i>{ LED bits at this FAR address }
  </i></font>SaveLock  <font color="#000080">: </font>BYTE<font color="#000080">;                       </font><font color="#008000"><i>{ Used to save LED status bits }

{ To make DOS cause LED update }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>DummyDosCall<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah, 11
  int $21
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>Shift <font color="#000080">: </font>BYTE<font color="#000080">;                    </font><font color="#008000"><i>{ Used in bit shifting of LEDs }

</i></font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{ Store current state }
  </i></font>SaveLock <font color="#000080">:= </font>KeyLocks<font color="#000080">;
  </font>Shift    <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
    </b></font><font color="#008000"><i>{ Turn on the LED bit according to Shift }
    </i></font>KeyLocks <font color="#000080">:= (</font>SCRLOCK <font color="#FF0000"><b>SHL </b></font>Shift<font color="#000080">);

    </font><font color="#008000"><i>{ Set Shift to indicate the LED to the right }
    </i></font>Shift <font color="#000080">:= (</font>Shift <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>MOD </b></font><font color="#800000">3</font><font color="#000080">;

    </font><font color="#008000"><i>{ Allow DOS to update the LEDs }
    </i></font>DummyDosCall<font color="#000080">;

    </font><font color="#008000"><i>{ Simple pause }
    </i></font>Delay<font color="#000080">( </font><font color="#800000">200 </font><font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;

  </font><font color="#008000"><i>{ Restore original keyboard state }
  </i></font>KeyLocks <font color="#000080">:= </font>SaveLock<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p></body>
</html>
