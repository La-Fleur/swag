<html>
<head><title> "Stuff Program with Keyboard in EXEC" by BILL BRACHOLD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ from SWAG, STUFF KYBD BUF by Rob Perelman, at beginning of KEYBOARD.SWG
  section.  Modified by Bill Brachhold ( willie@hal.eng.ufl.edu ) to make
  into a pseudo-Exec command.  It is sorta like Exec but is NOT a
  shell-type like Exec. It basically stuffs the keyboard buffer with
  the name of the program you want to run, then exits to DOS where DOS
  'finds' the program name and executes it.  Its big advantage is that it
  consumes NO memory when the other program starts.  Obviously, to get back
  to the first program, you would have to 'ExecProg' to it also.

From: Bill Brachold &lt;willie@hal.eng.ufl.edu&gt;
}

</i></font><font color="#FF0000"><b>Unit </b></font>ExecNML<font color="#000080">; </font><font color="#008000"><i>{ EXEC with No Memory Loss }

</i></font><font color="#FF0000"><b>INTERFACE

Type
  </b></font>String80 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

</font><font color="#FF0000"><b>Procedure </b></font>ExecProg<font color="#000080">( </font>ProgNm <font color="#000080">: </font>string80 <font color="#000080">);
</font><font color="#008000"><i>{ Note: ProgNm can be full drive/path/filename if you want }

</i></font><font color="#FF0000"><b>IMPLEMENTATION

Uses
  </b></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ExecProg<font color="#000080">(</font>ProgNm <font color="#000080">: </font>string80 <font color="#000080">);
</font><font color="#008000"><i>{ Note: not set up to do EXTENDED keycodes but could easily be made to do so }
</i></font><font color="#FF0000"><b>Const
  </b></font>Code <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{ implies standard keys being passed, NOT extended keycodes }
</i></font><font color="#FF0000"><b>Type
  </b></font>BufType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">30</font><font color="#000080">..</font><font color="#800000">62</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Head    <font color="#000080">: </font>Integer <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041A</font><font color="#000080">; </font><font color="#008000"><i>{ Location of head of buffer }
  </i></font>Tail    <font color="#000080">: </font>Integer <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041C</font><font color="#000080">; </font><font color="#008000"><i>{ Location of tail of buffer }
  </i></font>KBDBuf  <font color="#000080">: </font>BufType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041E</font><font color="#000080">; </font><font color="#008000"><i>{ Absolute location of buffer }
  </i></font>i<font color="#000080">, </font>TempTail <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ Temporary holding of Tail  }
</i></font><font color="#FF0000"><b>Begin
  </b></font>ProgNm <font color="#000080">:= </font>ProgNm <font color="#000080">+ </font><font color="#800000">#13</font><font color="#000080">; </font><font color="#008000"><i>{ add CR to simulate USER pressing ENTER key }
  </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>ProgNm<font color="#000080">) </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{ stuff in program name + ENTER key }
    </i></font><font color="#FF0000"><b>begin
      </b></font>TempTail <font color="#000080">:= </font>Tail<font color="#000080">;     </font><font color="#008000"><i>{ Store the Temporary Tail   }
      </i></font>Tail <font color="#000080">:= </font>Tail <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;     </font><font color="#008000"><i>{ Increment Tail to next pos }
      </i></font><font color="#FF0000"><b>If </b></font>Head <font color="#000080">= </font>Tail <font color="#FF0000"><b>Then   </b></font><font color="#008000"><i>{ Is the buffer full?        }
        </i></font><font color="#FF0000"><b>Begin
          </b></font>Tail <font color="#000080">:= </font>TempTail<font color="#000080">; </font><font color="#008000"><i>{ Reset to previous value    }
          </i></font>Sound<font color="#000080">(</font><font color="#800000">440</font><font color="#000080">);       </font><font color="#008000"><i>{ Beep the user              }
          </i></font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);       </font><font color="#008000"><i>{ Delay for the beep         }
          </i></font>Sound<font color="#000080">(</font><font color="#800000">880</font><font color="#000080">);       </font><font color="#008000"><i>{ Beep the user              }
          </i></font>Delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);       </font><font color="#008000"><i>{ Delay for the beep         }
          </i></font>NoSound<font color="#000080">;          </font><font color="#008000"><i>{ Turn off the sound         }
        </i></font><font color="#FF0000"><b>End
      Else
        Begin
          </b></font>KBDBuf<font color="#000080">[</font>TempTail<font color="#000080">] := </font>Ord<font color="#000080">(</font>ProgNm<font color="#000080">[</font>i<font color="#000080">]);  </font><font color="#008000"><i>{ Put the ASCII value in buf }
          </i></font>KBDBuf<font color="#000080">[</font>TempTail <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>Code<font color="#000080">; </font><font color="#008000"><i>{ Put extended keypress valu }
          </i></font><font color="#FF0000"><b>If </b></font>Tail <font color="#000080">&gt; </font><font color="#800000">60 </font><font color="#FF0000"><b>then </b></font>Tail <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">; </font><font color="#008000"><i>{ Last position. Wrap to 1st position }
        </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ for }
  </i></font>Halt<font color="#000080">; </font><font color="#008000"><i>{ You must HALT, otherwise, DOS doesn't start scanning keyboard
          buffer to 'find' the command you just stuffed into it. }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p></body>
</html>
