<html>
<head><title> "Re: CapsLock" by ALEXANDER BEEFTINK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JR&gt;&gt; Does anyone have the code (probably ASM) to turn the
 JR&gt;&gt; CapsLock key of _and_ on as well?  Thanks in advance if you
 JR&gt;&gt; can help.
 SS&gt; Procedure TogLed (Lock: Integer);

That was a bit long for what you needed to do.  Here's what I got:

program capslock;
{This program is design to test the procedure capslock_on.}

</i></font><font color="#FF0000"><b>procedure </b></font>capslock_on<font color="#000080">(</font>caps<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>ASM
 </b></font><font color="#FF00FF">push ds                ; Save the data segment
 mov al, caps           ; Load in the boolean value of caps
 mov bx, 0040h          ; These two lines adjust the data segment
 mov ds, bx             ; to 40h
 mov bx, 17h            ; Point to address 17h
 mov ch, [bx]           ; Get the byte located there
 mov cl, 6h             ; Move 6 into cl
 shl al, cl             ; Shift the bit in al 6 bits to the left
 and ch, 10111111b      ; Reset the 6th bit at our memory location
 or al, ch              ; Stick in the caps bit
 mov [bx], al           ; Put the new byte back
 pop ds                 ; Restore the data segment
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>capslock_on<font color="#000080">(</font>true<font color="#000080">);
 </font>capslock_on<font color="#000080">(</font>false<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>You see<font color="#000080">, </font>there are a host <font color="#FF0000"><b>of </b></font>byte that contain information like whether <font color="#FF0000"><b>or not
</b></font>the capslock <font color="#FF0000"><b>is on</b></font><font color="#000080">.  </font>This <font color="#FF0000"><b>program </b></font>edits that information directly<font color="#000080">, </font><font color="#FF0000"><b>and is
</b></font>hence a lot smaller <font color="#FF0000"><b>and </b></font>easier <font color="#FF0000"><b>to </b></font>use<font color="#000080">.  </font>Hope this helps<font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p></body>
</html>
