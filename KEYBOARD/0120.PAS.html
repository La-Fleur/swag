<html>
<head><title> "Keyboard's LEDs ON/OFF" by SALVATORE MESCHINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0120.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Unit </b></font>LED<font color="#000080">;

</font><font color="#008000"><i>{The author: Salvatore Meschini
             E-MAIL : smeschini@ermes.it
             WWW : http://www.ermes.it/pws/mesk
             Version 1.1 }

 </i></font><font color="#FF0000"><b>Interface

 Procedure </b></font>Caps<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>NumLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>ScrLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);

 </font><font color="#FF0000"><b>Implementation

 Procedure </b></font>Caps<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1       </font><font color="#008000"><i>{Do you want CAPS ON?}
    </i></font><font color="#FF00FF">je @BeLight         </font><font color="#008000"><i>{If yes ...}
    </i></font><font color="#FF00FF">jmp @BeDarkness     </font><font color="#008000"><i>{Else...}
    </i></font><font color="#FF00FF">@BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,40h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0BFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
     MOV AH,1
     INT 16h
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>NumLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>Boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1
    je @BeLight
    jmp @BeDarkness
    @BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,20h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0DFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
     MOV AH,1
     INT 16h
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ScrLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>Boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1
    je @BeLight
    jmp @BeDarkness
    @BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,10h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0EFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
     MOV AH,1
     INT 16h
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>(* -------------------------- DEMO ---------------------------- *)

</i></font><font color="#FF0000"><b>USES </b></font>LED<font color="#000080">;

</font><font color="#008000"><i>{Make your own light effects!!!}

</i></font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#008000"><i>(* The following procedure isn't affected by hardware! *)
</i></font><font color="#FF0000"><b>procedure </b></font>Wait<font color="#000080">(</font>Ticks<font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>(* 18 Ticks = 1 second *)
</i></font><font color="#FF0000"><b>ASM
 </b></font><font color="#FF00FF">mov CX,Ticks
 @Attendi:
  push AX
  push ES
  mov AX,0000
  mov ES,AX
  mov AX,ES:[046Ch]
  @Lab1:
  cmp AX,ES:[046Ch]
  je @Lab1
  pop ES
  pop AX
  loop @Attendi
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>KeyPressed<font color="#000080">: </font>Boolean<font color="#000080">;
  
  </font><font color="#FF0000"><b>var
    </b></font>Premuto<font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    Inline</b></font><font color="#000080">(
      </font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$0B</font><font color="#000080">/               </font><font color="#008000"><i>{    MOV AH,+$0B         }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$21</font><font color="#000080">/               </font><font color="#008000"><i>{    INT $21             }
      </i></font><font color="#800000">$88</font><font color="#000080">/</font><font color="#800000">$86</font><font color="#000080">/&gt;</font>Premuto<font color="#000080">);     </font><font color="#008000"><i>{    MOV &gt;Premuto[BP],AL }
    </i></font>KeyPressed <font color="#000080">:= (</font>Premuto <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
repeat
      </b></font>NumLock<font color="#000080">(</font>TRUE<font color="#000080">);
       </font>wait<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>NumLock<font color="#000080">(</font>FALSE<font color="#000080">);
      </font>Caps<font color="#000080">(</font>TRUE<font color="#000080">);
       </font>wait<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>Caps<font color="#000080">(</font>FALSE<font color="#000080">);
      </font>ScrLock<font color="#000080">(</font>True<font color="#000080">);
       </font>wait<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>Scrlock<font color="#000080">(</font>false<font color="#000080">);
      </font>Caps<font color="#000080">(</font>TRUE<font color="#000080">);
       </font>wait<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>Caps<font color="#000080">(</font>FALSE<font color="#000080">);
</font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.



</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0120.PAS">Original</a><b>]</b></p></body>
</html>
