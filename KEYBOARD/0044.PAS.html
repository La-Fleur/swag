<html>
<head><title> "Another Readkey" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SEAN PALMER

&gt;I want to be able to transparently read a keypress.  In
&gt;other Words, I'd like to know what key is being pressed,
&gt;but allow the keypress to return to the keyboard buffer or
&gt;to be read by the Program that's reading it.  I'd like this
&gt;to Function as a TSR, and I need some way to Record the
&gt;keypresses.  This is a very complicated problem which I
&gt;have consulted many advanced Programmers With.  Please help
&gt;if you are able.  Thanks in advance!

It returns the Character part of the Char/scan code combo in the current
head of the keyboard buffer queue in the bios data area.
The scan code would be at the location $40:head+1.

It would probably be more efficient if you used $0:$41A instead of
$40:$1A, but that might cause problems With protected mode.
}

</i></font><font color="#FF0000"><b>Var
  </b></font>head <font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$1A</font><font color="#000080">;
  </font>tail <font color="#000080">: </font>Word <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$1C</font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>peekKey <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>head <font color="#000080">= </font>tail <font color="#FF0000"><b>then
    </b></font>peekKey <font color="#000080">:= </font><font color="#800000">#0
  </font><font color="#FF0000"><b>else
    </b></font>peekKey <font color="#000080">:= </font>Char<font color="#000080">(</font>mem<font color="#000080">[</font><font color="#800000">$40 </font><font color="#000080">: </font>head<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p></body>
</html>
