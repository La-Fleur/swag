<html>
<head><title> "Keyboard LED's On/Off" by SALVATORE MESCHINI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Unit </b></font>LED<font color="#000080">;

</font><font color="#008000"><i>{This unit is FREE, use it and COPY it...Good PASCAL programming!}

{The author: Salvatore Meschini
             E-MAIL : smeschini@ermes.it
             WWW : http://www.ermes.it/pws/mesk
             Version 1.0 30/06/1996 - Please report ANY bugs/suggestions/...}

{$G+}

 </i></font><font color="#FF0000"><b>Interface

 Procedure </b></font>Caps<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>NumLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);
 </font><font color="#FF0000"><b>Procedure </b></font>ScrLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);

 </font><font color="#FF0000"><b>Implementation

 Procedure </b></font>Caps<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1       </font><font color="#008000"><i>{Do you want CAPS ON?}
    </i></font><font color="#FF00FF">je @BeLight         </font><font color="#008000"><i>{If yes ...}
    </i></font><font color="#FF00FF">jmp @BeDarkness     </font><font color="#008000"><i>{Else...}
    </i></font><font color="#FF00FF">@BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,40h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0BFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>NumLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>Boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1
    je @BeLight
    jmp @BeDarkness
    @BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,20h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0DFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>ScrLock<font color="#000080">(</font>ONorOFF<font color="#000080">:</font>Boolean<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">cmp ONorOFF,1
    je @BeLight
    jmp @BeDarkness
    @BeLight:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     OR  AL,10h
     MOV ES,SI
     MOV ES:[0017h],AL
     jmp @FINISH
    @BeDarkness:
     MOV SI,40h
     MOV ES,SI
     MOV AL,ES:[0017h]
     AND AL,0EFh
     MOV ES,SI
     MOV ES:[0017h],AL
    @FINISH:
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.




</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p></body>
</html>
