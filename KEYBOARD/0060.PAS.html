<html>
<head><title> "Keyboard Handler" by FRED JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Can anyone shed some light on how to add characters to the keyboard
&gt;buffers so i can echo commands right after my program exits?
}

</i></font><font color="#FF0000"><b>unit </b></font>kb<font color="#000080">;

</font><font color="#FF0000"><b>interface

type

  </b></font>string16 <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">16</font><font color="#000080">];
</font><font color="#008000"><i>{
Procedure Name: StuffKBD();
Description   : Places a string of 16 chars or less into the
                keyboard buffer.
Returns       : Nothing
Calls         : Int 16h
}
</i></font><font color="#FF0000"><b>procedure </b></font>StuffKBD<font color="#000080">(</font>sCommand <font color="#000080">: </font>string16<font color="#000080">);

</font><font color="#FF0000"><b>implementation

procedure </b></font>StuffKBD<font color="#000080">(</font>sCommand <font color="#000080">: </font>string16<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>iStuff <font color="#000080">: </font>integer<font color="#000080">;
  </font>ucMove <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>iStuff <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>sCommand<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>ucMove <font color="#000080">:= </font>byte<font color="#000080">(</font>sCommand<font color="#000080">[</font>iStuff<font color="#000080">]);
    </font><font color="#FF0000"><b>asm
      </b></font><font color="#FF00FF">mov ah, $5;
      mov ch, $0;
      mov cl, ucMove;
      int     $16;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>program </b></font>kbstuff<font color="#000080">;
</font><font color="#FF0000"><b>uses
  </b></font>kb<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>StuffKBD<font color="#000080">(</font><font color="#800000">'kbstuff'</font><font color="#000080">);
   </font><font color="#008000"><i>{You can even add StuffKBD(#13);}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p></body>
</html>
