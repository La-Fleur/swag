<html>
<head><title> "Detecting special keys" by GREG VIGNEAULT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*******************************************************************)
 </i></font><font color="#FF0000"><b>PROGRAM </b></font>xKeys<font color="#000080">;     </font><font color="#008000"><i>{ test detecting shift/alt/ctrl/sysreq keys     }
                    { Turbo/Quick Pascal  Oct.1992 Greg Vigneault   }
 </i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">;          </font><font color="#008000"><i>{ import for ClrScr and KeyPressed              }
{-------------------------------------------------------------------}
 </i></font><font color="#FF0000"><b>TYPE </b></font>LockKey <font color="#000080">= ( </font>RShift<font color="#000080">,</font>LShift<font color="#000080">,</font>Ctrl<font color="#000080">,</font>Alt<font color="#000080">,</font>Scroll<font color="#000080">,</font>NumLock<font color="#000080">,</font>Caps<font color="#000080">,</font>Insert<font color="#000080">,
                  </font>RightAlt<font color="#000080">,</font>LeftAlt<font color="#000080">,</font>RightCtrl<font color="#000080">,</font>LeftCtrl<font color="#000080">,</font>SysReq <font color="#000080">);
 </font><font color="#FF0000"><b>VAR  </b></font>KeyByte1 <font color="#000080">: </font>BYTE <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">; </font><font color="#008000"><i>{ data maintained by BIOS }
      </i></font>KeyByte2 <font color="#000080">: </font>BYTE <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$18</font><font color="#000080">;
      </font>KeyByte3 <font color="#000080">: </font>BYTE <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$96</font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------}
 </i></font><font color="#FF0000"><b>FUNCTION </b></font>KeyOn<font color="#000080">( </font>xkey <font color="#000080">: </font>LockKey <font color="#000080">) : </font>BOOLEAN<font color="#000080">;   </font><font color="#008000"><i>{ TRUE if LockKey on }
    </i></font><font color="#FF0000"><b>BEGIN
    CASE </b></font>xkey <font color="#FF0000"><b>OF
     </b></font>RShift<font color="#000080">..</font>Insert <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte1 <font color="#FF0000"><b>SHR </b></font>ORD<font color="#000080">(</font>xkey<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">);
     </font>RightAlt       <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte3 <font color="#FF0000"><b>SHR </b></font><font color="#800000">3 </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);
     </font>LeftAlt        <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte2 <font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);
     </font>RightCtrl      <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte3 <font color="#FF0000"><b>SHR </b></font><font color="#800000">2 </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);
     </font>LeftCtrl       <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte2 <font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);
     </font>SysReq         <font color="#000080">: </font>KeyOn<font color="#000080">:=</font>BOOLEAN<font color="#000080">( </font>KeyByte2 <font color="#FF0000"><b>SHR </b></font><font color="#800000">2 </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------}
 </i></font><font color="#FF0000"><b>FUNCTION </b></font>Keyboard101 <font color="#000080">: </font>BOOLEAN<font color="#000080">;    </font><font color="#008000"><i>{ TRUE for 101/102-key kybd     }
    </i></font><font color="#FF0000"><b>BEGIN </b></font>KeyBoard101 <font color="#000080">:= </font>BOOLEAN<font color="#000080">( </font>KeyByte3 <font color="#FF0000"><b>SHR </b></font><font color="#800000">4 </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">);   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{-------------------------------------------------------------------}
 </i></font><font color="#FF0000"><b>VAR </b></font>xkey <font color="#000080">: </font>LockKey<font color="#000080">;
 </font><font color="#FF0000"><b>BEGIN
    REPEAT  </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Press any of...'</font><font color="#000080">);

    </font>Write<font color="#000080">(</font><font color="#800000">'Shifts: '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>LShift<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>KeyOn<font color="#000080">(</font>RShift<font color="#000080">)       </font><font color="#008000"><i>{ either shift down?    }
        </i></font><font color="#FF0000"><b>THEN BEGIN
                IF </b></font>KeyOn<font color="#000080">(</font>LShift<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'LEFT '</font><font color="#000080">);
                </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>RShift<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'RIGHT'</font><font color="#000080">);
                </font>WriteLn<font color="#000080">;
             </font><font color="#FF0000"><b>END
        ELSE    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'none'</font><font color="#000080">);                    </font><font color="#008000"><i>{ neither shift }

    </i></font>Write<font color="#000080">(</font><font color="#800000">'Controls: '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>Ctrl<font color="#000080">)                              </font><font color="#008000"><i>{ either ctrl down? }
        </i></font><font color="#FF0000"><b>THEN BEGIN
                IF </b></font>KeyOn<font color="#000080">(</font>LeftCtrl<font color="#000080">)  </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'LEFT '</font><font color="#000080">);
                </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>RightCtrl<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'RIGHT'</font><font color="#000080">);
                </font>WriteLn<font color="#000080">;
             </font><font color="#FF0000"><b>END
        ELSE    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'none'</font><font color="#000080">);                    </font><font color="#008000"><i>{ neither ctrl  }

    </i></font>Write<font color="#000080">(</font><font color="#800000">'Alt keys: '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>Alt<font color="#000080">)                               </font><font color="#008000"><i>{ either Alt down?  }
        </i></font><font color="#FF0000"><b>THEN BEGIN
                IF </b></font>KeyOn<font color="#000080">(</font>LeftAlt<font color="#000080">)  </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'LEFT '</font><font color="#000080">);
                </font><font color="#FF0000"><b>IF </b></font>KeyON<font color="#000080">(</font>RightAlt<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font><font color="#800000">'RIGHT'</font><font color="#000080">);
                </font>WriteLn<font color="#000080">;
             </font><font color="#FF0000"><b>END
        ELSE    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'none'</font><font color="#000080">);                    </font><font color="#008000"><i>{ neither alt   }

    </i></font><font color="#FF0000"><b>FOR </b></font>xkey <font color="#000080">:= </font>Scroll <font color="#FF0000"><b>TO </b></font>Insert                <font color="#008000"><i>{ check other keys  }
        </i></font><font color="#FF0000"><b>DO BEGIN
        CASE </b></font>xkey <font color="#FF0000"><b>OF
            </b></font>Scroll  <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'Scroll: '</font><font color="#000080">);
            </font>NumLock <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'NumLock: '</font><font color="#000080">);
            </font>Caps    <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'CapsLock: '</font><font color="#000080">);
            </font>Insert  <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'Insert: '</font><font color="#000080">);
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
        </i></font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>xkey<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ON'</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'OFF'</font><font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>IF </b></font>KeyBoard101
        <font color="#FF0000"><b>THEN BEGIN
            </b></font>Write<font color="#000080">(</font><font color="#800000">'SysReq: '</font><font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>KeyOn<font color="#000080">(</font>SysReq<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ON'</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'OFF'</font><font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>UNTIL </b></font>KeyPressed<font color="#000080">;

 </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{xKeys}</i></font><font color="#000080">.
</font><font color="#008000"><i>(*******************************************************************)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p></body>
</html>
