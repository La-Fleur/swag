<html>
<head><title> "Toggle Special Keys" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JR&gt; Does anyone have the code (probably ASM) to turn the CapsLock key of
 JR&gt; _and_ on as well?  Thanks in advance if you can help.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>TogLed <font color="#000080">(</font>Lock<font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>Const
     </b></font>Num<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
     </font>Caps<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;
     </font>Scroll<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;
     </font>AllOff<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
     </font>AllOn<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
    </b></font>BitMapByte<font color="#000080">=</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Boolean<font color="#000080">;


</font><font color="#FF0000"><b>Var
  </b></font>OldStatByte<font color="#000080">,
  </font>StatByte<font color="#000080">:  </font>Byte<font color="#000080">;
  </font>StatMap<font color="#000080">:  </font>BitMapByte<font color="#000080">;
  </font>OldTimerVec<font color="#000080">:  </font>Pointer<font color="#000080">;

</font><font color="#FF0000"><b>Label
     </b></font>Start<font color="#000080">,</font>GetOne<font color="#000080">,</font>Quit<font color="#000080">;

</font><font color="#008000"><i>{****************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>BitMap<font color="#000080">(</font>ToConvert<font color="#000080">:  </font>Byte<font color="#000080">;
                 </font><font color="#FF0000"><b>Var </b></font>Converted<font color="#000080">:  </font>BitMapByte<font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>Count<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>Temp<font color="#000080">:  </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{Procedure BitMap}
      </i></font><font color="#FF0000"><b>For </b></font>Count<font color="#000080">:=</font><font color="#800000">7 </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          Begin </b></font><font color="#008000"><i>{FOR Count}
          </i></font>Temp<font color="#000080">:=</font>PowerX<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>Count<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>ToConvert<font color="#000080">&gt;=</font>Temp
             <font color="#FF0000"><b>Then
             Begin </b></font><font color="#008000"><i>{If ToConvert&gt;=Temp}
                 </i></font>Converted<font color="#000080">[</font>Count<font color="#000080">]:=</font>True<font color="#000080">;
                 </font>ToConvert<font color="#000080">:=</font>ToConvert<font color="#000080">-</font>Temp
             <font color="#FF0000"><b>End   </b></font><font color="#008000"><i>{If ToConvert&gt;=Temp}
             </i></font><font color="#FF0000"><b>Else
             </b></font>Converted<font color="#000080">[</font>Count<font color="#000080">]:=</font>False
          <font color="#FF0000"><b>End </b></font><font color="#008000"><i>{FOR Count}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{Procedure BitMap}
{****************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>MapToByte<font color="#000080">(</font>ToConvert<font color="#000080">:  </font>BitMapByte<font color="#000080">;
                    </font><font color="#FF0000"><b>Var </b></font>Converted<font color="#000080">:  </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Var
   </b></font>Count<font color="#000080">:  </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{Procedure MapToByte}
     </i></font>Converted<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>Count<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">7 </font><font color="#FF0000"><b>Do
         If </b></font>ToConvert<font color="#000080">[</font>Count<font color="#000080">]
            </font><font color="#FF0000"><b>Then
            </b></font>Converted<font color="#000080">:=</font>Converted<font color="#000080">+</font>PowerX<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font>Count<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{Procedure MapToByte}
{****************************************************************************}
</i></font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{Procedure TogLed}
     </i></font>StatByte<font color="#000080">:=</font>Mem<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">$417</font><font color="#000080">];
     </font>BitMap<font color="#000080">(</font>StatByte<font color="#000080">,</font>StatMap<font color="#000080">);
     </font><font color="#FF0000"><b>Case </b></font>Lock <font color="#FF0000"><b>Of
          </b></font><font color="#800000">0</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                  </b></font>StatMap<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font>False<font color="#000080">;
                  </font>StatMap<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font>False<font color="#000080">;
                  </font>StatMap<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>False
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#800000">1</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                  If </b></font>StatMap<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]=</font>True
                     <font color="#FF0000"><b>Then
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font>False
                     <font color="#FF0000"><b>Else
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font>True
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#800000">2</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                  If </b></font>StatMap<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]=</font>True
                     <font color="#FF0000"><b>Then
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>False
                     <font color="#FF0000"><b>Else
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>True
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#800000">3</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                  If </b></font>StatMap<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]=</font>True
                     <font color="#FF0000"><b>Then
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font>False
                     <font color="#FF0000"><b>Else
                     </b></font>StatMap<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font>True
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font><font color="#800000">4</font><font color="#000080">: </font><font color="#FF0000"><b>Begin
                  </b></font>StatMap<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font>True<font color="#000080">;
                  </font>StatMap<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font>True<font color="#000080">;
                  </font>StatMap<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font>True
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Asm
        </b></font><font color="#FF00FF">Start:
        MOV AH,$05
        MOV CH,$00
        MOV CL,$00
        INT $16
        CMP AL,$1
        JE  GetOne
        JMP Quit
        GetOne:
        MOV AH,$00
        INT $16
        JMP Start
        Quit:
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font>MapTOByte<font color="#000080">(</font>StatMap<font color="#000080">,</font>StatByte<font color="#000080">);
     </font>Mem<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">$417</font><font color="#000080">]:=</font>StatByte<font color="#000080">;
     </font><font color="#FF0000"><b>Asm
        </b></font><font color="#FF00FF">MOV AH,$00
        INT $16
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{Procedure TogLed}


                 </i></font><font color="#000080">/ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- \
                 | </font>Steve_Schwarz<font color="#000080">@</font>f1244<font color="#000080">.</font>n141<font color="#000080">.</font>z1<font color="#000080">.</font>fidonet<font color="#000080">.</font>org <font color="#000080">|
                 |        </font>SysOp<font color="#000080">: </font>The RoadHouse BBS         <font color="#000080">|
                 |  (</font><font color="#800000">203</font><font color="#000080">) </font><font color="#800000">263</font><font color="#000080">-</font><font color="#800000">5922  </font><font color="#000080">-=</font>Home <font color="#FF0000"><b>of </b></font>the blues<font color="#000080">=-  |
                 \ -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=- /

</font><font color="#008000"><i>{ ---------------------------------------------------------------- }

</i></font><font color="#FF0000"><b>USES </b></font>DOS<font color="#000080">,</font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>Type

   </b></font>Toggles      <font color="#000080">= (</font>RShift<font color="#000080">, </font>LShift<font color="#000080">, </font>Ctrl<font color="#000080">, </font>Alt<font color="#000080">,
                   </font>ScrollLock<font color="#000080">, </font>NumLock<font color="#000080">, </font>CapsLock<font color="#000080">, </font>Insert<font color="#000080">);
   </font>Status       <font color="#000080">= </font><font color="#FF0000"><b>Set of </b></font>Toggles<font color="#000080">;

</font><font color="#FF0000"><b>Const
   </b></font>ToggleStr   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>Toggles<font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] = (
                 </font><font color="#800000">'RShift'</font><font color="#000080">,</font><font color="#800000">'LShift'</font><font color="#000080">,</font><font color="#800000">'Ctrl'</font><font color="#000080">,</font><font color="#800000">'Alt'</font><font color="#000080">,
                 </font><font color="#800000">'Scroll'</font><font color="#000080">,</font><font color="#800000">'Num'</font><font color="#000080">,</font><font color="#800000">'Caps'</font><font color="#000080">,</font><font color="#800000">'Insert'</font><font color="#000080">);

</font><font color="#FF0000"><b>Var
   </b></font>KeyStatus   <font color="#000080">: </font>Status <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;
   </font>OldStatus   <font color="#000080">: </font>Status<font color="#000080">;
   </font>Flip        <font color="#000080">: </font>BOOLEAN<font color="#000080">;
   </font>T           <font color="#000080">: </font>Toggles<font color="#000080">;


   </font><font color="#FF0000"><b>PROCEDURE </b></font>RandomRoutine<font color="#000080">;
   </font><font color="#FF0000"><b>VAR
        </b></font>R<font color="#000080">,</font>C <font color="#000080">: </font>BYTE<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
   </b></font>R <font color="#000080">:= </font>Random<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>C <font color="#000080">:= </font>Random<font color="#000080">(</font><font color="#800000">79</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
   </font>GoToXY<font color="#000080">(</font>C<font color="#000080">,</font>R<font color="#000080">);</font>Write<font color="#000080">(</font>ToggleStr<font color="#000080">[</font>T<font color="#000080">]);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


   </font><font color="#FF0000"><b>PROCEDURE </b></font>StatusFlasher <font color="#000080">( </font>D <font color="#000080">: </font>BYTE<font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN
   WHILE NOT </b></font>Keypressed <font color="#FF0000"><b>DO
      BEGIN
        IF </b></font>Flip <font color="#FF0000"><b>THEN </b></font>KeyStatus <font color="#000080">:= </font>KeyStatus <font color="#000080">+ [</font>T<font color="#000080">] </font><font color="#FF0000"><b>ELSE
                     </b></font>KeyStatus <font color="#000080">:= </font>KeyStatus <font color="#000080">- [</font>T<font color="#000080">];

        </font><font color="#008000"><i>{  Call another routine here if you like }
        </i></font>RandomRoutine<font color="#000080">;


        </font>DEC<font color="#000080">(</font>T<font color="#000080">);              </font><font color="#008000"><i>{ get the next toggle }
        </i></font>DELAY<font color="#000080">(</font>D<font color="#000080">);            </font><font color="#008000"><i>{ delay this long }
        </i></font>Flip <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>Flip<font color="#000080">;    </font><font color="#008000"><i>{ flip the on/off state }

        </i></font><font color="#FF0000"><b>IF </b></font>T <font color="#000080">= </font>ALT <font color="#FF0000"><b>THEN </b></font>T <font color="#000080">:= </font>CapsLock<font color="#000080">;  </font><font color="#008000"><i>{ limit the list to just the three }

      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
</b></font>CLRSCR<font color="#000080">;
</font>T         <font color="#000080">:= </font>Capslock<font color="#000080">;   </font><font color="#008000"><i>{ staring toggle          }
</i></font>OldStatus <font color="#000080">:= </font>KeyStatus<font color="#000080">;  </font><font color="#008000"><i>{ save the current Status }
</i></font>Flip      <font color="#000080">:= </font>TRUE<font color="#000080">;       </font><font color="#008000"><i>{ used to flip it off/on  }

</i></font>StatusFlasher<font color="#000080">( </font><font color="#800000">100 </font><font color="#000080">);           </font><font color="#008000"><i>{ the main procedure to make lights flash }

</i></font>KeyStatus <font color="#000080">:= </font>OldStatus<font color="#000080">;  </font><font color="#008000"><i>{ restore original status }

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>Martin Woods
martin<font color="#000080">@</font>nisa<font color="#000080">.</font>net

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0110.PAS">Original</a><b>]</b></p></body>
</html>
