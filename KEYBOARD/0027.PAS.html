<html>
<head><title> "OOP Keyboard Routines" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Keybd<font color="#000080">;  </font><font color="#008000"><i>{ Keybd.PAS / Keybd.TPU }

</i></font><font color="#FF0000"><b>INTERFACE

USES </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>CType <font color="#000080">= ( </font>UBAR<font color="#000080">, </font>BLOCK <font color="#000080">);
  </font>Keyboard <font color="#000080">= </font><font color="#FF0000"><b>OBJECT
    </b></font>ThisCursor<font color="#000080">: </font>CType<font color="#000080">;
    </font><font color="#FF0000"><b>PROCEDURE </b></font>InitKeyBd<font color="#000080">;
    </font><font color="#FF0000"><b>PROCEDURE </b></font>SetCursor<font color="#000080">( </font>Cursor<font color="#000080">: </font>CType <font color="#000080">);
    </font><font color="#FF0000"><b>FUNCTION  </b></font>GetCursor<font color="#000080">: </font>CType<font color="#000080">;
    </font><font color="#FF0000"><b>FUNCTION  </b></font>GetKbdFlags<font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>FUNCTION  </b></font>GetKey<font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>KeyFlags<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>FunctKey<font color="#000080">: </font>Boolean<font color="#000080">;
                                        </font><font color="#FF0000"><b>VAR </b></font>Ch<font color="#000080">: </font>Char <font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{***************************************************************}
                      </i></font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{***************************************************************}


{Keyboard}

{-------------------------------------------------
- Name   : InitKeyBd                             -
- Purpose: Set the cursor to underline style     -
-          and empty keyboard buffer             -
-------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Keyboard<font color="#000080">.</font>InitKeyBd<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Ch <font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>SetCursor<font color="#000080">( </font>UBAR <font color="#000080">);
    </font><font color="#FF0000"><b>WHILE</b></font><font color="#000080">( </font>KeyPressed <font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------
- Name   : SetCursor                             -
- Purpose: Modify number of lines for cursor     -
-------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Keyboard<font color="#000080">.</font>SetCursor<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    CASE </b></font>Cursor <font color="#FF0000"><b>OF
      </b></font>UBAR<font color="#000080">:  </font>Regs<font color="#000080">.</font>Ch <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
      </font>BLOCK<font color="#000080">: </font>Regs<font color="#000080">.</font>Ch <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>Regs<font color="#000080">.</font>CL <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
    </font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">, </font>Regs <font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------
- Name   : GetKbdFlags                           -
- Purpose: Monitor the Insert key                -
- Output : Shift key status flag byte            -
-------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Keyboard<font color="#000080">.</font>GetKbdFlags<font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font><font color="#008000"><i>(* FOR enhanced keyboards: AH := $12 *)
    (* FOR normal keyboards:   AH := $02 *)
    </i></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
    </font>Intr<font color="#000080">( </font><font color="#800000">$16</font><font color="#000080">, </font>Regs <font color="#000080">);
    </font><font color="#FF0000"><b>IF</b></font><font color="#000080">( </font>Regs<font color="#000080">.</font>AX <font color="#FF0000"><b>AND </b></font><font color="#800000">$80 </font><font color="#000080">= </font><font color="#800000">$80 </font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>SetCursor<font color="#000080">( </font>BLOCK <font color="#000080">)
                                </font><font color="#FF0000"><b>ELSE </b></font>SetCursor<font color="#000080">( </font>UBAR <font color="#000080">);
    </font>GetKbdFlags <font color="#000080">:= </font>Regs<font color="#000080">.</font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------
- Name   : GetCursor                             -
- Purpose: Query current cursor state            -
-------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Keyboard<font color="#000080">.</font>GetCursor<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>GetCursor <font color="#000080">:= </font>ThisCursor<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------------------
- Name   : GetKey                                -
- Purpose: Get a keypress contents if any        -
-          Updates a function keypressed flag    -
-------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Keyboard<font color="#000080">.</font>GetKey<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>Result <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Result <font color="#000080">:= </font>KeyPressed<font color="#000080">;
    </font>FunctKey <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font>Ch <font color="#000080">:= </font><font color="#800000">#$00</font><font color="#000080">;       </font><font color="#008000"><i>{Use this to check for Function key press}
    </i></font><font color="#FF0000"><b>IF </b></font>Result <font color="#FF0000"><b>THEN BEGIN
      </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
      </font><font color="#FF0000"><b>IF</b></font><font color="#000080">( </font>KeyPressed <font color="#FF0000"><b>AND </b></font><font color="#000080">( </font>Ch <font color="#000080">= </font><font color="#800000">#$00 </font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN BEGIN
        </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
        </font>FunctKey <font color="#000080">:= </font>TRUE<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>KeyFlags <font color="#000080">:= </font>GetKbdFlags<font color="#000080">;
    </font>GetKey <font color="#000080">:= </font>Result<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
