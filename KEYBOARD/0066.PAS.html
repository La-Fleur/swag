<html>
<head><title> "Detect Status Keys" by GREG ESTABROOKS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0066.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{***********************************************************************}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>KeyStatDemo<font color="#000080">;            </font><font color="#008000"><i>{ Dec 09/93, Greg Estabrooks.           }
</i></font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">;                       </font><font color="#008000"><i>{ Import Clrscr,Writeln,GotXY.          }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CapsOn <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                </font><font color="#008000"><i>{  Routine to determine if Caps Lock is on.             }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test the keyboard status bit for Caps.}
  </i></font>CapsOn <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$40</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{CapsOn}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>NumLockOn <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if Num Lock is on.             }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for NumLock. }
  </i></font>NumLockon <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$20</font><font color="#000080">) &lt;&gt;</font><font color="#800000">0
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{NumLockOn}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ScrollOn <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if Scroll Lock is on.          }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for S_Lock.  }
    </i></font>ScrollOn <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$10</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{ScrollOn}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>AltPressed <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if ALT key is being held down. }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for ALT.     }
  </i></font>AltPressed <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$08</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{AltPressed}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CtrlPressed <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if Ctrl key is being held down.}
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for Ctrl.    }
  </i></font>CtrlPressed <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$04</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{CtrlPressed}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>LeftShift <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if L_Shift is being held down. }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for L_Shift. }
  </i></font>LeftShift <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$02</font><font color="#000080">) &lt;&gt;  </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{LeftShift}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>RightShift <font color="#000080">:</font>BOOLEAN<font color="#000080">;
                 </font><font color="#008000"><i>{  Routine to determine if R_Shift is being held down. }
</i></font><font color="#FF0000"><b>BEGIN                           </b></font><font color="#008000"><i>{ Test keyboard status bit for R_Shift. }
  </i></font>RightShift <font color="#000080">:= (</font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$1</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;</font><font color="#008000"><i>{RightShift}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Clrscr<font color="#000080">;                       </font><font color="#008000"><i>{ Clear the screen of clutter.       }
  </i></font><font color="#FF0000"><b>REPEAT
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);                </font><font color="#008000"><i>{ Move Back to top of screen.        }
    </i></font>Writeln<font color="#000080">(</font><font color="#800000">'CapsLock   : '</font><font color="#000080">,</font>Capson<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'NumLock    : '</font><font color="#000080">,</font>NumLockOn<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Scroll Lock: '</font><font color="#000080">,</font>ScrollOn<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Alt Key    : '</font><font color="#000080">,</font>AltPressed<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Ctrl Key   : '</font><font color="#000080">,</font>CtrlPressed<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Right Shift: '</font><font color="#000080">,</font>RightShift<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Left Shift : '</font><font color="#000080">,</font>LeftShift<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font><font color="#FF0000"><b>UNTIL </b></font>KeyPressed<font color="#000080">;             </font><font color="#008000"><i>{ Loop until a key is pressed.       }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font><font color="#008000"><i>{KeyStatDemo}
{********************************************************************}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0066.PAS">Original</a><b>]</b></p></body>
</html>
