<html>
<head><title> "Stuffing Keyboard" by KEV1N@AOL.COM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0086.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; How do I stuff a string into the keyboard buffer?

I've got two things for you:

1:  Turbo Power's Object Professional's OpCRT unit has the following
useful routines:
procedure StuffKey(W : Word);
  {-Stuff one key into the keyboard buffer}

</i></font><font color="#FF0000"><b>procedure </b></font>StuffString<font color="#000080">(</font>S <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
  </font><font color="#008000"><i>{-Stuff the contents of S into the keyboard buffer}

{
2: If you don't have Object Professional (it's $895.00 but worth it)
Before I noticed that OpCRT would do what I needed, I sat down and
wrote the following code.  It's rough, but gives a pretty good idea
of how the keyboard buffer works, and there's a chance that you can
use it to create your own Stuffer
}
</i></font><font color="#FF0000"><b>program </b></font>ViewKbdBufr<font color="#000080">;

</font><font color="#008000"><i>(********************************************************************
***
   Written By Kevin R. Pierce - June 25, 1994
*********************************************************************
**)

</i></font><font color="#FF0000"><b>Uses
  </b></font>OpString<font color="#000080">,  </font><font color="#008000"><i>{This is where HexB is.  You can write your own easy
enough}
  </i></font>CRT<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Buffer_Head <font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$001A</font><font color="#000080">;
  </font>Buffer_Tail <font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$001C</font><font color="#000080">;
  </font>Buffer_Start<font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0080</font><font color="#000080">;
  </font>Buffer_End  <font color="#000080">: </font>Byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0082</font><font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>t <font color="#000080">: </font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>clrscr<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Buffer Head  = '</font><font color="#000080">,</font>HexB<font color="#000080">(</font>Buffer_Head<font color="#000080">));
    </font>writeln<font color="#000080">(</font><font color="#800000">'Buffer Tail  = '</font><font color="#000080">,</font>HexB<font color="#000080">(</font>Buffer_Tail<font color="#000080">));
    </font>writeln<font color="#000080">(</font><font color="#800000">'Buffer Start = '</font><font color="#000080">,</font>HexB<font color="#000080">(</font>Buffer_Start<font color="#000080">));
    </font>writeln<font color="#000080">(</font><font color="#800000">'Buffer End   = '</font><font color="#000080">,</font>HexB<font color="#000080">(</font>Buffer_End<font color="#000080">));
    </font>writeln<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Buffer_Tail <font color="#000080">&gt;</font>Buffer_Head <font color="#FF0000"><b>then </b></font><font color="#008000"><i>{simple list}
      </i></font><font color="#FF0000"><b>begin
        for </b></font>t<font color="#000080">:=</font>Buffer_Head <font color="#FF0000"><b>to </b></font>Buffer_Tail <font color="#FF0000"><b>do
          </b></font>write<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>t<font color="#000080">)^):</font><font color="#800000">4</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
     else  </b></font><font color="#008000"><i>{loop back to START}
      </i></font><font color="#FF0000"><b>if </b></font>Buffer_Head<font color="#000080">&lt;&gt;</font>Buffer_Tail <font color="#FF0000"><b>then
        begin
          for </b></font>t<font color="#000080">:=</font>Buffer_Head <font color="#FF0000"><b>to </b></font>Buffer_End <font color="#FF0000"><b>do
            </b></font>write<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>t<font color="#000080">)^):</font><font color="#800000">4</font><font color="#000080">);
          </font><font color="#FF0000"><b>for </b></font>t<font color="#000080">:=</font>Buffer_Start <font color="#FF0000"><b>to </b></font>Buffer_Tail <font color="#FF0000"><b>do
            </b></font>write<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>t<font color="#000080">)^):</font><font color="#800000">4</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>clreol<font color="#000080">;
    </font>writeln<font color="#000080">;
    </font>writeln<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>Buffer_Head<font color="#000080">)^):</font><font color="#800000">3</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>Buffer_Tail<font color="#000080">)^):</font><font color="#800000">3</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>Buffer_Start<font color="#000080">)^):</font><font color="#800000">3</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font>Buffer_End<font color="#000080">)^):</font><font color="#800000">3</font><font color="#000080">);

    </font>writeln<font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>t<font color="#000080">:=</font>ofs<font color="#000080">(</font>Buffer_Head<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>ofs<font color="#000080">(</font>Buffer_Tail<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>write<font color="#000080">(</font>Byte<font color="#000080">(</font>Ptr<font color="#000080">(</font>seg<font color="#000080">(</font>Buffer_Head<font color="#000080">),</font>t<font color="#000080">)^):</font><font color="#800000">3</font><font color="#000080">);

  </font><font color="#FF0000"><b>until </b></font>FALSE<font color="#000080">;
</font><font color="#008000"><i>{endless Loop - Use Ctrl-Break to stop (you might have to reboot if
you run BP under Windows.}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0086.PAS">Original</a><b>]</b></p></body>
</html>
