<html>
<head><title> "Stuff Keyboard Buffer" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ROB PERELMAN

&gt; I want to put the character and scan code for ALT-V in the keyboard buffer.
&gt; In fact I would like to put it in there twice. I need it to be in the
&gt; buffer so that when my program terminates the parent process will act on
&gt; that key.

{
 If this is being used with Turbo Pascal Version 3.0, you MUST set
 the C and U compiler directives to MINUS!
 If this is being used with Turbo Pascal Version 4.0, then set the
 CheckBreak variable  of the CRT unit to FALSE!
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>BufType <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">30</font><font color="#000080">..</font><font color="#800000">62</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Head    <font color="#000080">: </font>Integer <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041A</font><font color="#000080">;    </font><font color="#008000"><i>{ Location of head of buffer  }
  </i></font>Tail    <font color="#000080">: </font>Integer <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041C</font><font color="#000080">;    </font><font color="#008000"><i>{ Location of tail of buffer  }
  </i></font>KBDBuf  <font color="#000080">: </font>BufType <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$041E</font><font color="#000080">;    </font><font color="#008000"><i>{ Absolute location of buffer }
  </i></font>S       <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                        </font><font color="#008000"><i>{ Input string                }

</i></font><font color="#FF0000"><b>Procedure </b></font>StufftheBuff <font color="#000080">(</font>Ch <font color="#000080">: </font>Char<font color="#000080">; </font>Code <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>TempTail <font color="#000080">: </font>Integer<font color="#000080">;                          </font><font color="#008000"><i>{ Temporary holding of Tail  }
</i></font><font color="#FF0000"><b>Begin
  </b></font>TempTail <font color="#000080">:= </font>Tail<font color="#000080">;                           </font><font color="#008000"><i>{ Store the Temporary Tail   }
  </i></font>Tail <font color="#000080">:= </font>Tail <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;                           </font><font color="#008000"><i>{ Incriment Tail to next pos }
  </i></font><font color="#FF0000"><b>If </b></font>Head <font color="#000080">= </font>Tail <font color="#FF0000"><b>Then                         </b></font><font color="#008000"><i>{ Is the buffer full?        }
  </i></font><font color="#FF0000"><b>Begin
    </b></font>Tail <font color="#000080">:= </font>TempTail<font color="#000080">;                        </font><font color="#008000"><i>{ Reset to previos value     }
    </i></font>Sound<font color="#000080">(</font><font color="#800000">440</font><font color="#000080">);                              </font><font color="#008000"><i>{ Beep the user              }
    </i></font>Delay<font color="#000080">(</font><font color="#800000">400</font><font color="#000080">);                              </font><font color="#008000"><i>{ Delay for the beep         }
    </i></font>NoSound<font color="#000080">;                                 </font><font color="#008000"><i>{ Turn off the sound         }
  </i></font><font color="#FF0000"><b>End
  Else
  Begin
    </b></font>KBDBuf<font color="#000080">[</font>TempTail<font color="#000080">] := </font>Ord<font color="#000080">(</font>Ch<font color="#000080">);              </font><font color="#008000"><i>{ Put the ASCII value in buf }
    </i></font>KBDBuf<font color="#000080">[</font>TempTail <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>Code<font color="#000080">;             </font><font color="#008000"><i>{ Put extended keypress valu }
    </i></font><font color="#FF0000"><b>If </b></font>Tail <font color="#000080">&gt; </font><font color="#800000">60 </font><font color="#FF0000"><b>then                         </b></font><font color="#008000"><i>{ Last position. Wrap?       }
      </i></font>Tail <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;                             </font><font color="#008000"><i>{ Wrap to 1st position       }
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>ClrScr<font color="#000080">;                                     </font><font color="#008000"><i>{ Clear the Screen           }
  </i></font>StufftheBuff <font color="#000080">( </font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">0 </font><font color="#000080">);                     </font><font color="#008000"><i>{ Start stuffing the buffer  }
  </i></font>StufftheBuff <font color="#000080">( </font><font color="#800000">'I'</font><font color="#000080">,</font><font color="#800000">0 </font><font color="#000080">);                     </font><font color="#008000"><i>{ Another stuff of the Buffer}
  </i></font>StufftheBuff <font color="#000080">( </font><font color="#800000">'R'</font><font color="#000080">,</font><font color="#800000">0 </font><font color="#000080">);                     </font><font color="#008000"><i>{    &quot;      &quot;    &quot;  &quot;    &quot;   }
  </i></font>StufftheBuff <font color="#000080">( </font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">0 </font><font color="#000080">); </font><font color="#008000"><i>{ CR }              { Stuff a carriage return    }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0001.PAS">Original</a><b>]</b></p></body>
</html>
