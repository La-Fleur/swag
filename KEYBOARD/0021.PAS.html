<html>
<head><title> "Trap PAUSE Key" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{The problem is that the pause key actually paUses the Computer
via hardware.  to reset the pause, you can use the timer interrupt
to generate a reset process at every tick.  The method here
was taken from some Computer magazine.
}

</i></font><font color="#FF0000"><b>Program </b></font>TrapPause<font color="#000080">;
</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Timerint <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>PauseFlag <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PauseDetect<font color="#000080">(</font>flags<font color="#000080">,</font>CS<font color="#000080">,</font>IP<font color="#000080">,</font>AX<font color="#000080">,</font>BX<font color="#000080">,</font>CX<font color="#000080">,</font>DX<font color="#000080">,</font>SI<font color="#000080">,</font>DI<font color="#000080">,</font>DS<font color="#000080">,</font>ES<font color="#000080">,</font>BP<font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#008000"><i>{This latches on to the system timer interrupt to detect if the
   pause key has been pressed, and if so to reset the system to allow
   operation to continue and to set Pauseflag = True}
  </i></font>interrupt<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>memw<font color="#000080">[</font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$418</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8 </font><font color="#000080">= </font><font color="#800000">8 </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{Test bit 3}
    </i></font><font color="#FF0000"><b>begin
      </b></font>Pauseflag <font color="#000080">:= </font>True<font color="#000080">;
      </font>memw<font color="#000080">[</font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$418</font><font color="#000080">] := </font>memw<font color="#000080">[</font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$418</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F7</font><font color="#000080">; </font><font color="#008000"><i>{Set bit 3 = 0}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(</font><font color="#800000">$9C</font><font color="#000080">/              </font><font color="#008000"><i>{PushF}
           </i></font><font color="#800000">$3E</font><font color="#000080">/              </font><font color="#008000"><i>{DS}
           </i></font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$1E</font><font color="#000080">/</font>timerint<font color="#000080">);</font><font color="#008000"><i>{Far call to usual timer interrupt}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>Getintvec<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">,</font>Timerint<font color="#000080">);      </font><font color="#008000"><i>{Save old interrupt For timer}
  </i></font>Setintvec<font color="#000080">(</font><font color="#800000">$08</font><font color="#000080">,@</font>PauseDetect<font color="#000080">);  </font><font color="#008000"><i>{Redirect timer to PauseDetect}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0021.PAS">Original</a><b>]</b></p></body>
</html>
