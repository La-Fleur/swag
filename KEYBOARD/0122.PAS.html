<html>
<head><title> "Extended Keyboard unit" by PEDT SCRAGG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(* This keyboard input unit will compile on ALL versions of TP &amp; BP from
   Version 5.0 to Ver 7.0 - you can easily recode the interrupts in BASM
   for users of TP &amp; BP versions that support BASM *)

(* This unit provided by Pedt Scragg 101322,2153. Part of a forthcoming
   Pascal Toolbox for Real and Protected Mode programmers for Turbo &amp; 
   Borland Pascal Programmers - versions 5.0 to 8.0 *)

</i></font><font color="#FF0000"><b>unit </b></font>ExtKey<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>dos<font color="#000080">, </font>crt<font color="#000080">;

</font><font color="#008000"><i>(* No keyboard code*)

</i></font><font color="#FF0000"><b>Const   </b></font>KbNoKey         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);

</font><font color="#008000"><i>(* Keyboard Timeout *)

        </i></font>KbTimeOut       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);

</font><font color="#008000"><i>(* Normal Keycodes returned in FirstCode *)

        </i></font>KbCtrlA         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
        </font>KbCtrlB         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
        </font>KbCtrlC         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
        </font>KbCtrlD         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
        </font>KbCtrlE         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
        </font>KbCtrlF         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
        </font>KbCtrlG         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
        </font>KbCtrlH         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);
        </font>KbCtrlI         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);
        </font>KbTab           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);
        </font>KbCtrlJ         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
        </font>KbCtrlK         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">11</font><font color="#000080">);
        </font>KbCtrlL         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">);
        </font>KbCtrlM         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
        </font>KbEnter         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">);
        </font>KbCtrlN         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
        </font>KbCtrlO         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
        </font>KbCtrlP         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">);
        </font>KbCtrlQ         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">17</font><font color="#000080">);
        </font>KbCtrlR         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">);
        </font>KbCtrlS         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">19</font><font color="#000080">);
        </font>KbCtrlT         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
        </font>KbCtrlU         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">);
        </font>KbCtrlV         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">22</font><font color="#000080">);
        </font>KbCtrlW         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
        </font>KbCtrlX         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">);
        </font>KbCtrlY         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">);
        </font>KbCtrlZ         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">);
        </font>KbEsc           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">);
        </font>KbLeftBracket   <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">);
        </font>KbRightBracket  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">29</font><font color="#000080">);
        </font>KbCtrl6         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
        </font>KbCtrlMinus     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">);
        </font>KbSpace         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">);

</font><font color="#008000"><i>(* Extended Keycodes from all keyboards *)

        </i></font>KbCtrl2         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
        </font>KbShiftTab      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">);
        </font>KbAltQ          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">16</font><font color="#000080">);
        </font>KbAltW          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">17</font><font color="#000080">);
        </font>KbAltE          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">);
        </font>KbAltR          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">19</font><font color="#000080">);
        </font>KbAltT          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
        </font>KbAltY          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">);
        </font>KbAltU          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">22</font><font color="#000080">);
        </font>KbAltI          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">);
        </font>KbAltO          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">);
        </font>KbAltP          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">25</font><font color="#000080">);
        </font>KbAltA          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
        </font>KbAltS          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">);
        </font>KbAltD          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">);
        </font>KbAltF          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">33</font><font color="#000080">);
        </font>KbAltG          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">34</font><font color="#000080">);
        </font>KbAltH          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">35</font><font color="#000080">);
        </font>KbAltJ          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">36</font><font color="#000080">);
        </font>KbAltK          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">37</font><font color="#000080">);
        </font>KbAltL          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">38</font><font color="#000080">);
        </font>KbAltZ          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">44</font><font color="#000080">);
        </font>KbAltX          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">45</font><font color="#000080">);
        </font>KbAltC          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">46</font><font color="#000080">);
        </font>KbAltV          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">47</font><font color="#000080">);
        </font>KbAltB          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">48</font><font color="#000080">);
        </font>KbAltN          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">49</font><font color="#000080">);
        </font>KbAltM          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">50</font><font color="#000080">);
        </font>KbF1            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">59</font><font color="#000080">);
        </font>KbF2            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">60</font><font color="#000080">);
        </font>KbF3            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">61</font><font color="#000080">);
        </font>KbF4            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">62</font><font color="#000080">);
        </font>KbF5            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">);
        </font>KbF6            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">64</font><font color="#000080">);
        </font>KbF7            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">65</font><font color="#000080">);
        </font>KbF8            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">66</font><font color="#000080">);
        </font>KbF9            <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">67</font><font color="#000080">);
        </font>KbF10           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">68</font><font color="#000080">);
        </font>KbHome          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">71</font><font color="#000080">);
        </font>KbUpArrow       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">72</font><font color="#000080">);
        </font>KbPageUp        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">73</font><font color="#000080">);
        </font>KbLeftArrow     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">75</font><font color="#000080">);
        </font>KbRightArrow    <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">77</font><font color="#000080">);
        </font>KbEnd           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">79</font><font color="#000080">);
        </font>KbDownArrow     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">80</font><font color="#000080">);
        </font>KbPageDown      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">81</font><font color="#000080">);
        </font>KbInsert        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">82</font><font color="#000080">);
        </font>KbDelete        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">83</font><font color="#000080">);
        </font>KbShiftF1       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">84</font><font color="#000080">);
        </font>KbShiftF2       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">85</font><font color="#000080">);
        </font>KbShiftF3       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">86</font><font color="#000080">);
        </font>KbShiftF4       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">87</font><font color="#000080">);
        </font>KbShiftF5       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">88</font><font color="#000080">);
        </font>KbShiftF6       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">89</font><font color="#000080">);
        </font>KbShiftF7       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">90</font><font color="#000080">);
        </font>KbShiftF8       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">91</font><font color="#000080">);
        </font>KbShiftF9       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">92</font><font color="#000080">);
        </font>KbShiftF10      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">93</font><font color="#000080">);
        </font>KbCtrlF1        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">94</font><font color="#000080">);
        </font>KbCtrlF2        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">95</font><font color="#000080">);
        </font>KbCtrlF3        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">96</font><font color="#000080">);
        </font>KbCtrlF4        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">97</font><font color="#000080">);
        </font>KbCtrlF5        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">98</font><font color="#000080">);
        </font>KbCtrlF6        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">99</font><font color="#000080">);
        </font>KbCtrlF7        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">);
        </font>KbCtrlF8        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">101</font><font color="#000080">);
        </font>KbCtrlF9        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">102</font><font color="#000080">);
        </font>KbCtrlF10       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">103</font><font color="#000080">);
        </font>KbAltF1         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">104</font><font color="#000080">);
        </font>KbAltF2         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">105</font><font color="#000080">);
        </font>KbAltF3         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">106</font><font color="#000080">);
        </font>KbAltF4         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">107</font><font color="#000080">);
        </font>KbAltF5         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">108</font><font color="#000080">);
        </font>KbAltF6         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">109</font><font color="#000080">);
        </font>KbAltF7         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">110</font><font color="#000080">);
        </font>KbAltF8         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">111</font><font color="#000080">);
        </font>KbAltF9         <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">112</font><font color="#000080">);
        </font>KbAltF10        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">113</font><font color="#000080">);
        </font>KbCtrlPrint     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">114</font><font color="#000080">);
        </font>KbCtrlLeftArrow <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">115</font><font color="#000080">);
        </font>KbCtrlRightArrow<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">116</font><font color="#000080">);
        </font>KbCtrlEnd       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">117</font><font color="#000080">);
        </font>KbCtrlPageDown  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">118</font><font color="#000080">);
        </font>KbCtrlHome      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">119</font><font color="#000080">);
        </font>KbAlt1          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">120</font><font color="#000080">);
        </font>KbAlt2          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">121</font><font color="#000080">);
        </font>KbAlt3          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">122</font><font color="#000080">);
        </font>KbAlt4          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">123</font><font color="#000080">);
        </font>KbAlt5          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">124</font><font color="#000080">);
        </font>KbAlt6          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">125</font><font color="#000080">);
        </font>KbAlt7          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">126</font><font color="#000080">);
        </font>KbAlt8          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">127</font><font color="#000080">);
        </font>KbAlt9          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">128</font><font color="#000080">);
        </font>KbAlt0          <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">129</font><font color="#000080">);
        </font>KbAltMinus      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">130</font><font color="#000080">);
        </font>KbAltEquals     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">131</font><font color="#000080">);
        </font>KbCtrlPageUp    <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">132</font><font color="#000080">);

</font><font color="#008000"><i>(* Extended Keycodes from Enhanced Keyboards *)

        </i></font>KbAltBackSpace  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
        </font>KbAltLeftBracket<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">);
        </font>KbAltRightBracket<font color="#000080">=</font>chr<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">);
        </font>KbAltEnter      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">28</font><font color="#000080">);
        </font>KbAltSemiColon  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">39</font><font color="#000080">);
        </font>KbAltPound      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">43</font><font color="#000080">);
        </font>KbAltComma      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">51</font><font color="#000080">);
        </font>KbAltFullStop   <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">53</font><font color="#000080">);
        </font>KbAltKeyPadStar <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">55</font><font color="#000080">);
        </font>KbAltKeyPadMinus<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">74</font><font color="#000080">);
        </font>KbAltKeyPadPlus <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">78</font><font color="#000080">);
        </font>KbF11           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">133</font><font color="#000080">);
        </font>KbF12           <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">134</font><font color="#000080">);
        </font>KbShiftF11      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">135</font><font color="#000080">);
        </font>KbShiftF12      <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">136</font><font color="#000080">);
        </font>KbCtrlF11       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">137</font><font color="#000080">);
        </font>KbCtrlF12       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">138</font><font color="#000080">);
        </font>KbAltF11        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">139</font><font color="#000080">);
        </font>KbAltF12        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">140</font><font color="#000080">);
        </font>KbCtrlUpArrow   <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">141</font><font color="#000080">);
        </font>KbCtrlKeyPadMinus<font color="#000080">=</font>chr<font color="#000080">(</font><font color="#800000">142</font><font color="#000080">);
        </font>KbCtrlKeyPad5   <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">143</font><font color="#000080">);
        </font>KbCtrlKeyPadPlus<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">144</font><font color="#000080">);
        </font>KbCtrlDownArrow <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">145</font><font color="#000080">);
        </font>KbCtrlInsert    <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">146</font><font color="#000080">);
        </font>KbCtrlDelete    <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">147</font><font color="#000080">);
        </font>KbCtrlTab       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">148</font><font color="#000080">);
        </font>KbCtrlKeyPadSlash<font color="#000080">=</font>chr<font color="#000080">(</font><font color="#800000">149</font><font color="#000080">);
        </font>KbCtrlKeyPadStar<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">);
        </font>KbAltHome       <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">151</font><font color="#000080">);
        </font>KbAltUpArrow    <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">152</font><font color="#000080">);
        </font>KbAltPageUp     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">153</font><font color="#000080">);
        </font>KbAltLeftArrow  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">155</font><font color="#000080">);
        </font>KbAltRightArrow <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">157</font><font color="#000080">);
        </font>KbAltEnd        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">159</font><font color="#000080">);
        </font>KbAltDownArrow  <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">160</font><font color="#000080">);
        </font>KbAltPageDown   <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">161</font><font color="#000080">);
        </font>KbAltInsert     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">162</font><font color="#000080">);
        </font>KbAltDelete     <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">163</font><font color="#000080">);
        </font>KbAltKeyPadSlash<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">164</font><font color="#000080">);
        </font>KbAltTab        <font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">165</font><font color="#000080">);
        </font>KbAltKeyPadEnter<font color="#000080">= </font>chr<font color="#000080">(</font><font color="#800000">166</font><font color="#000080">);

</font><font color="#008000"><i>(* End of Enhanced Keycodes *)

        </i></font>keyb_head <font color="#000080">: ^</font>integer <font color="#000080">= </font>ptr<font color="#000080">(</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$1A</font><font color="#000080">);
        </font>keyb_tail <font color="#000080">: ^</font>Integer <font color="#000080">= </font>ptr<font color="#000080">(</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$1C</font><font color="#000080">);
        </font>keyb_buff <font color="#000080">: ^</font>char    <font color="#000080">= </font>ptr<font color="#000080">(</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$0</font><font color="#000080">);
        </font>keyb_start<font color="#000080">: ^</font>integer <font color="#000080">= </font>ptr<font color="#000080">(</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$80</font><font color="#000080">);
        </font>keyb_end  <font color="#000080">: ^</font>integer <font color="#000080">= </font>ptr<font color="#000080">(</font><font color="#800000">$40</font><font color="#000080">,</font><font color="#800000">$82</font><font color="#000080">);

</font><font color="#FF0000"><b>var     </b></font>IsEnhanced <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NextKey<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>FirstCode<font color="#000080">,</font>ExtendedCode<font color="#000080">:</font>char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>KeyCode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>FirstCode<font color="#000080">,</font>ExtendedCode<font color="#000080">:</font>char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Keywait<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>FlushKeys<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WaitKey<font color="#000080">(</font>Time<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>DelayKey<font color="#000080">(</font>Time<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Firstcode<font color="#000080">,</font>ExtendedCode<font color="#000080">:</font>Char<font color="#000080">);

</font><font color="#FF0000"><b>implementation

VAR
    </b></font>ShiftState <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;

</font><font color="#008000"><i>(* EnhancedKeyboard returns TRUE is an enhanced keyboard is present
   and FALSE if not present. Note this will return FALSE is an enhanced
   keyboard is present but the BIOS cannot handle it. The function result
   is available outside the unit in the IsEnhanced boolean variable *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>EnhancedKeyboard <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>StateFrom16 <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>regs <font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>EnhancedKeyboard <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>regs<font color="#000080">);
  </font>statefrom16 <font color="#000080">:= </font>regs<font color="#000080">.</font>al<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>StateFrom16 <font color="#000080">&lt;&gt; </font>ShiftState <font color="#FF0000"><b>THEN </b></font>Exit<font color="#000080">;
  </font>ShiftState <font color="#000080">:= </font>ShiftState <font color="#FF0000"><b>XOR </b></font><font color="#800000">$20</font><font color="#000080">;
  </font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>regs<font color="#000080">);
  </font>statefrom16 <font color="#000080">:= </font>regs<font color="#000080">.</font>al<font color="#000080">;
  </font>EnhancedKeyboard <font color="#000080">:= </font>StateFrom16 <font color="#000080">= </font>ShiftState<font color="#000080">;
  </font>ShiftState <font color="#000080">:= </font>ShiftState <font color="#FF0000"><b>XOR </b></font><font color="#800000">$20</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* KeyWait will wait for a keypress then discard it *)

</i></font><font color="#FF0000"><b>Procedure </b></font>KeyWait<font color="#000080">;
</font><font color="#FF0000"><b>begin
if </b></font>IsEnhanced <font color="#FF0000"><b>then Inline</b></font><font color="#000080">(</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font><font color="#800000">$74</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$F4</font><font color="#000080">/</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">) </font><font color="#FF0000"><b>else
                   Inline</b></font><font color="#000080">(</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font><font color="#800000">$74</font><font color="#000080">/</font><font color="#800000">$06</font><font color="#000080">/</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">/</font><font color="#800000">$EB</font><font color="#000080">/</font><font color="#800000">$F4</font><font color="#000080">/</font><font color="#800000">$B4</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$16</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* Keypress works like the crt unit keypressed function and, if an enhanced
   keyboard is not available, will call the crt unit. This was programmed
   in case there is an enhanced keyboard but the BIOS cannot handle it. The
   buffer *may* contain the extended keycode but the BIOS would never
   recognise it when the ReadKey or this unit's KeyCode procedure was called *)

</i></font><font color="#FF0000"><b>function </b></font>KeyPress <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fpkeyhead<font color="#000080">, </font>fpkeytail <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>IsEnhanced <font color="#FF0000"><b>then
     begin
          </b></font>fpkeyhead <font color="#000080">:= </font>keyb_head<font color="#000080">;
          </font>fpkeytail <font color="#000080">:= </font>keyb_tail<font color="#000080">;
          </font>KeyPress <font color="#000080">:= (</font>integer<font color="#000080">(</font>fpkeytail<font color="#000080">^) &lt;&gt; </font>integer<font color="#000080">(</font>fpkeyhead<font color="#000080">^));
     </font><font color="#FF0000"><b>end
     else
         </b></font>KeyPress <font color="#000080">:= </font>CRT<font color="#000080">.</font>KeyPressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* Quickest way to flush the keyboard buffer is to set the pointers
   to the keyboard to read the same value *)

</i></font><font color="#FF0000"><b>procedure </b></font>FlushKeys<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fpkeyhead<font color="#000080">, </font>fpkeytail <font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
      inline</b></font><font color="#000080">(</font><font color="#800000">$FA</font><font color="#000080">);
      </font>fpkeyhead <font color="#000080">:= </font>keyb_head<font color="#000080">;
      </font>fpkeytail <font color="#000080">:= </font>keyb_tail<font color="#000080">;
      </font>integer<font color="#000080">(</font>fpkeyhead<font color="#000080">^) := </font>integer<font color="#000080">(</font>fpkeytail<font color="#000080">^);
      </font><font color="#FF0000"><b>inline</b></font><font color="#000080">(</font><font color="#800000">$FB</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* KeyCode reads the keyboard for the next key pressed and returns the values
   in FirstCode and ExtendedCode. If the key is a normal key, then ExtendedCode
   is set to #0 and FirstCode contains the character from the keyboard.

   If FirstCode is #0 then an Extended Code has been input and the Scan Code
   will be found in the ExtendedCode variable

   If there is no key waiting, KeyCode will wait for the next key pressed.

   Note that this procedure returns both normal codes and extended codes
   within one procedure and you do not need to call the procedure twice to
   get extended codes like when using the CRT ReadKey function. *)

</i></font><font color="#FF0000"><b>procedure </b></font>KeyCode<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>FirstCode<font color="#000080">,</font>ExtendedCode <font color="#000080">: </font>char<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>regs<font color="#000080">:</font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>IsEnhanced <font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$10 </font><font color="#FF0000"><b>else </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font>Intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>regs<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">224 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>al <font color="#000080">&gt; </font><font color="#800000">$00 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">224</font><font color="#000080">;
     </font>FirstCode <font color="#000080">:= </font>chr<font color="#000080">(</font>regs<font color="#000080">.</font>al<font color="#000080">);
     </font>ExtendedCode <font color="#000080">:= </font>chr<font color="#000080">(</font>regs<font color="#000080">.</font>ah<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* NextKey will read the next key pressed as with the KeyCode procedure
   above. However, if there is no key waiting in the buffer, both
   FirstCode and ExtendedCode will be set to #255 *)

</i></font><font color="#FF0000"><b>Procedure </b></font>NextKey<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>FirstCode<font color="#000080">,</font>ExtendedCode<font color="#000080">:</font>char<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>regs<font color="#000080">:</font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font>IsEnhanced <font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$11 </font><font color="#FF0000"><b>else </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
     </font>Intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>regs<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>regs<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font>fzero <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>al <font color="#000080">= </font><font color="#800000">224 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>al <font color="#000080">&gt; </font><font color="#800000">$00 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>ah <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>regs<font color="#000080">.</font>al <font color="#000080">:= </font><font color="#800000">224</font><font color="#000080">;
     </font>FirstCode <font color="#000080">:= </font>chr<font color="#000080">(</font>regs<font color="#000080">.</font>al<font color="#000080">);
     </font>ExtendedCode <font color="#000080">:= </font>chr<font color="#000080">(</font>regs<font color="#000080">.</font>ah<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* DelayKey waits for specified time in milliseconds. If a key is pressed
   within the time specified then the FirstCode and ExtendedCode will
   have the Key pressed (see KeyCode above). If no key was pressed within the
   time, both FirstCode and ExtendedCode will have the #255 (KbTimeOut) code *)

</i></font><font color="#FF0000"><b>Procedure </b></font>DelayKey<font color="#000080">(</font>Time<font color="#000080">:</font>word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Firstcode<font color="#000080">,</font>ExtendedCode<font color="#000080">:</font>Char<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>count <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>FlushKeys<font color="#000080">;
     </font>Time <font color="#000080">:= </font>Time <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">;
     </font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>Firstcode <font color="#000080">:= </font><font color="#800000">#255</font><font color="#000080">; </font>ExtendedCode <font color="#000080">:= </font><font color="#800000">#255</font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>count <font color="#000080">&lt; </font>Time <font color="#FF0000"><b>do
     begin
         </b></font>Delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
         </font>inc<font color="#000080">(</font>count<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>KeyPress <font color="#FF0000"><b>then
         begin
             </b></font>count <font color="#000080">:= </font>Time<font color="#000080">;
             </font>KeyCode<font color="#000080">(</font>FirstCode<font color="#000080">,</font>ExtendedCode<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(* WaitKey waits for the specified time or when a key is pressed if the
   key is pressed earlier than the specified time in milliseconds. The
   keystroke is thrown away *)

</i></font><font color="#FF0000"><b>Procedure </b></font>WaitKey<font color="#000080">(</font>Time<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>count <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Flushkeys<font color="#000080">;
     </font>time <font color="#000080">:= </font>time <font color="#FF0000"><b>div </b></font><font color="#800000">10</font><font color="#000080">;
     </font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font>count <font color="#000080">&lt; </font>time <font color="#FF0000"><b>do
     begin
          </b></font>delay<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>count<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>KeyPress <font color="#FF0000"><b>then </b></font>count <font color="#000080">:= </font>time<font color="#000080">;
          </font>FlushKeys<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>IsEnhanced <font color="#000080">:= </font>EnhancedKeyboard<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------------- DEMO --------------- CUT HERE ---------- }
</i></font><font color="#FF0000"><b>program </b></font>KeyTest<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>ExtKey<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>Key1<font color="#000080">, </font>Key2 <font color="#000080">: </font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>Write<font color="#000080">(</font><font color="#800000">'Extended Keyboard is '</font><font color="#000080">);
     </font><font color="#FF0000"><b>If not </b></font>IsEnhanced <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font><font color="#800000">'not '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'available'</font><font color="#000080">);

     </font>Key1 <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
     </font>Key2 <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;

     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Press the ESC to end or press any key combination to get '</font><font color="#000080">+
             </font><font color="#800000">'Key pressed'</font><font color="#000080">);

     </font><font color="#FF0000"><b>While </b></font>Key1 <font color="#000080">&lt;&gt; </font>KbEsc <font color="#FF0000"><b>do
     begin
          </b></font>KeyCode<font color="#000080">(</font>Key1<font color="#000080">,</font>Key2<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>Key1 <font color="#000080">= </font>KbNoKey <font color="#FF0000"><b>then
               </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Extended Key, value = '</font><font color="#000080">,</font>ord<font color="#000080">(</font>Key2<font color="#000080">))
          </font><font color="#FF0000"><b>else
          if </b></font>Key1 <font color="#000080">&lt; </font>KbSpace <font color="#FF0000"><b>then
               </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Normal Key - Control Key, ESC or Bracket'</font><font color="#000080">)
          </font><font color="#FF0000"><b>else
               </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Normal Key - key is &quot;'</font><font color="#000080">,</font>Key1<font color="#000080">,</font><font color="#800000">'&quot;'</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p></body>
</html>
