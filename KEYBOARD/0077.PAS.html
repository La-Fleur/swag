<html>
<head><title> "pgdn/pgup" by DAVID KANDRAT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
Here is an (TP 5.5) atom that will help you grab &quot;extended&quot;
keyboard scancodes.  I think the problem you're having has to
do with the fact that you can't trap hot keys inside ReadLn,
yes?  You need to build a set of routines that support
a-key-at-a-time input into a string, echoing the keystrokes
to the screen as you go.  This &quot;atom&quot; just handles keystrokes-
the string handling is probably _WAY_ too long to list here.
}

</i></font><font color="#FF0000"><b>Program </b></font>_<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>KeyType <font color="#000080">= (</font>Ascii<font color="#000080">,</font>ExtendedKey<font color="#000080">,</font>Escape<font color="#000080">);

</font><font color="#FF0000"><b>Var
</b></font>KtGlb <font color="#000080">: </font>KeyType<font color="#000080">;
</font>ChGlb <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetExtKey<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>Ch<font color="#000080">:</font>Char<font color="#000080">;  </font><font color="#FF0000"><b>Var </b></font>Kt<font color="#000080">:</font>KeyType<font color="#000080">; );
</font><font color="#FF0000"><b>Begin
  Repeat
  Until </b></font>KeyPressed<font color="#000080">;
  </font>Kt <font color="#000080">:= </font>Ascii<font color="#000080">;
  </font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ch<font color="#000080">=</font><font color="#800000">#0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Ch<font color="#000080">)=</font><font color="#800000">27</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Kt <font color="#000080">:= </font>Escape <font color="#FF0000"><b>Else </b></font>Kt <font color="#000080">:= </font>ExtendedKey<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Main
<font color="#FF0000"><b>Begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">'Press a key.'</font><font color="#000080">);
  </font>ChGlb <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
  </font>KtGlb <font color="#000080">:= </font>Ascii<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>GotoXY<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font>GetExtKey<font color="#000080">(</font>ChGlb<font color="#000080">,</font>KtGlb<font color="#000080">);
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font>ClrEol<font color="#000080">;
    </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>KtGlb <font color="#FF0000"><b>Of
      </b></font>Ascii       <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'Ascii,    '</font><font color="#000080">);
      </font>ExtendedKey <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'Extended, '</font><font color="#000080">);
      </font>Escape      <font color="#000080">: </font>Write<font color="#000080">(</font><font color="#800000">'Escape,   '</font><font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">'Scancode = '</font><font color="#000080">,</font>Ord<font color="#000080">(</font>Ch<font color="#000080">));
  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Kt<font color="#000080">=</font>Escape<font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>ClrScr<font color="#000080">;
  </font>Main<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>This should help you capture _any_ extended scan code from the keyboard<font color="#000080">.
</font>PgUp<font color="#000080">, </font>PgDn<font color="#000080">, </font>Ctrl<font color="#000080">-</font>PgUp<font color="#000080">, </font>Alt<font color="#000080">-</font>Shft<font color="#000080">-</font>F5<font color="#000080">, </font>etc<font color="#000080">...  </font>Chapter Seventeen <font color="#FF0000"><b>of </b></font><font color="#000080">&quot;</font>Turbo
<font color="#FF0000"><b>Pascal </b></font><font color="#800000">5.5</font><font color="#000080">, </font>The Complete Reference<font color="#000080">&quot; </font>by O<font color="#800000">'Brien (Borland/Osborne/McGraw-
</font>Hill ISBN <font color="#800000">0</font><font color="#000080">-</font><font color="#800000">07</font><font color="#000080">-</font><font color="#800000">881501</font><font color="#000080">-</font><font color="#800000">0</font><font color="#000080">) </font>covers the issue <font color="#FF0000"><b>of </b></font>buffered <font color="#FF0000"><b>string </b></font>input pretty
well<font color="#000080">.

</font><font color="#FF0000"><b>And as for </b></font>your next berrage <font color="#FF0000"><b>of </b></font>questions<font color="#000080">, &quot;</font>Turbo <font color="#FF0000"><b>Pascal </b></font>Advanced
Techniques<font color="#000080">&quot; </font>by Ohlsen <font color="#000080">&amp; </font>Stoker <font color="#000080">(</font>Que Corp<font color="#000080">. </font>ISBN <font color="#800000">0</font><font color="#000080">-</font><font color="#800000">88022</font><font color="#000080">-</font><font color="#800000">432</font><font color="#000080">-</font><font color="#800000">0</font><font color="#000080">) </font>covers
DOS windowing very nicely<font color="#000080">.  (</font>Also many other goodies<font color="#000080">).

</font>Hope it helped a little<font color="#000080">.
</font>David Kandrat

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
