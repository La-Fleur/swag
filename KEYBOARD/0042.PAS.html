<html>
<head><title> "Stuffing Keyboard" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SEAN PALMER

&gt;&gt; I am assuming you already have a buffer-stuffer that takes a char and a
&gt;&gt; scan code as input, so I won't post mine.

&gt;No, I don't have a keyboard buffer-stuffer.

You said you wanted one that DIDN'T need you to tell it what a char's
scancode was. Well, this would basically require a lookup table of
possible scancodes for each ascii char... Plus some that don't have
corresponding scancodes. What you could try is to just send a null (#0)
to the routine as a scan code, I believe that's what happens when you
enter a keystroke using the Alt-Numeric Keypad method... so it'd work as
long as the program you're sending the keys to doesn't need the
scancode.

Here's an untested version of the method that other guy sent to you...:
}

</i></font><font color="#FF0000"><b>procedure </b></font>stuffKey<font color="#000080">(</font>c <font color="#000080">: </font>char<font color="#000080">; </font>scan <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov cl, c
  mov ch, scan
  mov ah, 5
  int $16
  </font><font color="#008000"><i>{al=0 if success, 1 if failed, but we just ignore that here}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>so here<font color="#800000">'s a call that just assumes a 0 scan code

</font><font color="#FF0000"><b>procedure </b></font>stuffChar<font color="#000080">(</font>c <font color="#000080">: </font>char<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov cl,c
  xor ch,ch
  mov ah,5
  int $16
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
If you don't wanna go through the BIOS you can do it directly like this:
(plus this is 'pure' Turbo Pascal code.. 8) }

</i></font><font color="#FF0000"><b>var
  </b></font>head     <font color="#000080">: </font>word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$1A</font><font color="#000080">;
  </font>tail     <font color="#000080">: </font>word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$1C</font><font color="#000080">;
  </font>bufStart <font color="#000080">: </font>word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$80</font><font color="#000080">;
  </font>bufEnd   <font color="#000080">: </font>word <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40 </font><font color="#000080">: </font><font color="#800000">$82</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>stuffKey<font color="#000080">(</font>c <font color="#000080">: </font>char<font color="#000080">; </font>scan <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>memW<font color="#000080">[</font><font color="#800000">$40 </font><font color="#000080">: </font>tail<font color="#000080">] := </font>word<font color="#000080">(</font>scan<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8 </font><font color="#000080">+ </font>byte<font color="#000080">(</font>c<font color="#000080">);
  </font>inc<font color="#000080">(</font>tail<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>tail <font color="#000080">= </font>bufEnd <font color="#FF0000"><b>then
    </b></font>tail <font color="#000080">:= </font>bufStart<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>clearBuffer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tail <font color="#000080">:= </font>head<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
