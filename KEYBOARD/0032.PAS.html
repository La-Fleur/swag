<html>
<head><title> "Set KBD delay/repeat rate" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{***********************************************
* KBSETUP - set the desired delay/repeat rate  *
* for the keyboard.                            *
***********************************************}

</i></font><font color="#FF0000"><b>USES
    </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Usage<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'KBSETUP Command format:'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'KBSETUP  n {A | B | C | D} '</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>Write  <font color="#000080">(</font><font color="#800000">'n            A number from 0 to 31'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' to set the keyboard repeat rate.'</font><font color="#000080">);
    </font>Write  <font color="#000080">(</font><font color="#800000">'             0 is the fastest and'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' 31 is the slowest.'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>Write  <font color="#000080">(</font><font color="#800000">'A,B,C or D   Sets the keyboard'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' delay before repeating'</font><font color="#000080">);
    </font>Write  <font color="#000080">(</font><font color="#800000">'             to 1/4, 1/2, 3/4 and'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' 1 second.'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>KBDelay<font color="#000080">, </font>KBRepeat<font color="#000080">, </font>I <font color="#000080">: </font>byte<font color="#000080">;
  </font>Code                 <font color="#000080">: </font>integer<font color="#000080">;
  </font>Regs                 <font color="#000080">: </font>Registers<font color="#000080">;
  </font>KeyString            <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];

</font><font color="#FF0000"><b>BEGIN

  </b></font>KBDelay <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>KBRepeat <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>Usage
  <font color="#FF0000"><b>ELSE
    BEGIN
      FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>ParamCount <font color="#FF0000"><b>DO
        BEGIN
          </b></font>KeyString <font color="#000080">:= </font>ParamStr<font color="#000080">(</font>I<font color="#000080">);
        </font><font color="#FF0000"><b>IF </b></font>UpCase<font color="#000080">(</font>KeyString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'D'</font><font color="#000080">] </font><font color="#FF0000"><b>THEN
          </b></font>KBDelay <font color="#000080">:= </font>Ord<font color="#000080">(</font>UpCase<font color="#000080">(</font>KeyString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]))
                       - </font>Ord<font color="#000080">(</font><font color="#800000">'A'</font><font color="#000080">)
        </font><font color="#FF0000"><b>ELSE
          BEGIN
             </b></font><font color="#008000"><i>{$R-}
            </i></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font>I<font color="#000080">),</font>KBRepeat<font color="#000080">,</font>Code<font color="#000080">);
             </font><font color="#008000"><i>{$R+}
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>KBRepeat <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or
               </b></font><font color="#000080">(</font>KBRepeat <font color="#000080">&gt; </font><font color="#800000">31</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
              BEGIN
                </b></font>Write<font color="#000080">(</font><font color="#800000">'-- Invalid Letter or'</font><font color="#000080">);
                </font>Write<font color="#000080">(</font><font color="#800000">' Number Entered --&gt; '</font><font color="#000080">);
                </font>WriteLn<font color="#000080">(</font>ParamStr<font color="#000080">(</font>I<font color="#000080">));
                </font>Usage
              <font color="#FF0000"><b>END
          END
        END</b></font><font color="#000080">;

        </font><font color="#008000"><i>{ Set the keyboard delay/repeat rate }

      </i></font><font color="#FF0000"><b>WITH </b></font>Regs <font color="#FF0000"><b>DO
        BEGIN
          </b></font>AX <font color="#000080">:= </font><font color="#800000">$0305</font><font color="#000080">;
          </font>BH <font color="#000080">:= </font>KBDelay<font color="#000080">;
          </font>BL <font color="#000080">:= </font>KBRepeat<font color="#000080">;
          </font>Intr<font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">,</font>Regs<font color="#000080">)
        </font><font color="#FF0000"><b>END
    END </b></font><font color="#008000"><i>{of the IF/THEN/ELSE instruction}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
