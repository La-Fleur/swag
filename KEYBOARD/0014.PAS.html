<html>
<head><title> "Read Keyboard STATE Keys" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Can someone give me some code to make the lights Num lock/caps
&gt;lock/scroll lock keys to turn on?
}

</i></font><font color="#FF0000"><b>Program </b></font>KeySet<font color="#000080">;
</font><font color="#FF0000"><b>Const
  </b></font>CapsState   <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">; </font><font color="#008000"><i>{ Mask For Caps Lock state }
  </i></font>NumState    <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">; </font><font color="#008000"><i>{ Mask For Num Lock state }
  </i></font>ScrollState <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">; </font><font color="#008000"><i>{ Mask For Scroll Lock state }
</i></font><font color="#FF0000"><b>Var
  </b></font>Kb <font color="#000080">: </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0017</font><font color="#000080">; </font><font color="#008000"><i>{ Address of keyboard flags }
  </i></font>I  <font color="#000080">: </font>Byte<font color="#000080">;
  </font>S  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' Command line options:'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' C toggle Cap lock state'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' N toggle Num lock state'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' S toggle Scroll lock state'</font><font color="#000080">);
    </font>WriteLn<font color="#000080">(</font><font color="#800000">' Add + to turn on and - to turn off'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>Do
  begin
    </b></font>S <font color="#000080">:= </font>ParamStr<font color="#000080">(</font>I<font color="#000080">);
    </font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>UpCase<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
    </font><font color="#008000"><i>{ toggle Caps Lock }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'C' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>xor </b></font>CapsState<font color="#000080">;
    </font><font color="#008000"><i>{ toggle Num Lock }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'N' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>xor </b></font>NumState<font color="#000080">;
    </font><font color="#008000"><i>{ toggle Scroll Lock }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'S' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>xor </b></font>ScrollState<font color="#000080">;
    </font><font color="#008000"><i>{ Set Caps Lock on }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'C+' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>or </b></font>CapsState<font color="#000080">;
    </font><font color="#008000"><i>{ Set Num Lock on }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'N+' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>or </b></font>NumState<font color="#000080">;
    </font><font color="#008000"><i>{ Set Scroll Lock on }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'S+' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>or </b></font>ScrollState<font color="#000080">;
    </font><font color="#008000"><i>{ Set Caps Lock off }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'C-' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>CapsState <font color="#FF0000"><b>or not </b></font>Kb<font color="#000080">);
    </font><font color="#008000"><i>{ Set Num Lock off }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'N-' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>NumState <font color="#FF0000"><b>or not </b></font>Kb<font color="#000080">);
    </font><font color="#008000"><i>{ Set Scroll Lock off }
    </i></font><font color="#FF0000"><b>if </b></font>S <font color="#000080">= </font><font color="#800000">'S-' </font><font color="#FF0000"><b>then </b></font>Kb <font color="#000080">:= </font>Kb <font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>ScrollState <font color="#FF0000"><b>or not </b></font>Kb<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Write<font color="#000080">(</font><font color="#800000">'Caps Lock  : '</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Kb <font color="#FF0000"><b>and </b></font>CapsState<font color="#000080">) = </font>CapsState <font color="#FF0000"><b>then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ON'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ofF'</font><font color="#000080">);

  </font>Write<font color="#000080">(</font><font color="#800000">'Num Lock   : '</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Kb <font color="#FF0000"><b>and </b></font>NumState<font color="#000080">) = </font>NumState <font color="#FF0000"><b>then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ON'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ofF'</font><font color="#000080">);

  </font>Write<font color="#000080">(</font><font color="#800000">'Scroll Lock: '</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Kb <font color="#FF0000"><b>and </b></font>ScrollState<font color="#000080">) = </font>ScrollState <font color="#FF0000"><b>then
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ON'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'ofF'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
This Program will toggle, Turn on, or Turn off the Caps Lock, Num
Lock, and Scroll Lock lights. and when its done it tells you the
state of each key.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
