<html>
<head><title> "Keyboard Simulation" by MARC BIR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
From: MARC BIR
Subj: KEYBOARD Simulation

{BW&gt;Ok, here is my problem...I am trying to read a string from a
file, poke it i the keyboard buffer, and then dump the contents of
the buffer, so as to simulate that the user actually typed the
string...This way the user doesnt have to type it all out..My
program works fine, except if the string is more than characters, and
if I try to clear the buffer after 16 characters, all I get the last
few characters in the string..Can anyone please help?  I would real
like to finish this dang project! :&gt;  Thank you.}

{This should work, tested it out.  If it returns a false, you have to
stop sending characters, until those that are in the buffer are used,
doesn't matter what scancode is if you don't use, ditto for asciicode }
*)

</i></font><font color="#FF0000"><b>Function </b></font>SimulateKey<font color="#000080">( </font>AsciiCode<font color="#000080">, </font>ScanCode <font color="#000080">: </font>Byte <font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler
Asm
 </b></font><font color="#FF00FF">Mov  AH, 05H
 Mov  CH, ScanCode
 Mov  CL, AsciiCode
 Int  16H
 XOR  AX, 1       </font><font color="#008000"><i>{ bios returns 1 = error, 0 = false, pascal opposite }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ Returns false if buffer is full }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p></body>
</html>
