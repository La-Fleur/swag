<html>
<head><title> "Key Input Unit" by JEFF FANJOY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>KeyInput<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES </b></font>CRT<font color="#000080">,           </font><font color="#008000"><i>{Import Sound function}
     </i></font>CURSOR<font color="#000080">;        </font><font color="#008000"><i>{Import ChangeCursor}

</i></font><font color="#FF0000"><b>CONST
   </b></font>StandardInput <font color="#000080">= </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV'
                  </font><font color="#000080">+</font><font color="#800000">'WXYZ1234567890~!@#$%^&amp;*()-+\[]{};:`''&quot;.,/&lt;&gt; =_?|'</font><font color="#000080">;
   </font>HighBitInput  <font color="#000080">= </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV'
                  </font><font color="#000080">+</font><font color="#800000">'WXYZ1234567890~!@#$%^&amp;*()-+\[]{};:`''&quot;.,/&lt;&gt; =_?|'
                  </font><font color="#000080">+</font><font color="#800000">'&euro;ÅÇÉÑÖÜáàâäãåçéèêëíìîïñóò&trade;öõúùûü†&iexcl;&cent;&pound;&curren;&yen;&brvbar;&sect;&uml;&copy;&ordf;&laquo;&shy;≠&reg;'
                  </font><font color="#000080">+</font><font color="#800000">'&macr;&deg;&plusmn;&sup2;&sup3;&acute;&micro;∂&ordm;&cedil;&sup1;&ordm;&raquo;&frac14;&frac12;&frac34;&iquest;&Agrave;&Aacute;&Acirc;&Atilde;&Auml;&Aring;&AElig;&Ccedil;&Egrave;&Eacute;&Ecirc;&Euml;&Igrave;&Iacute;&Icirc;&Iuml;&ETH;&Ntilde;&Ograve;&Oacute;&Ocirc;&Otilde;&Ouml;&times;&Oslash;&Ugrave;&Uacute;&Ucirc;&Uuml;&Yacute;&THORN;'
                  </font><font color="#000080">+</font><font color="#800000">'&szlig;&agrave;&aacute;&acirc;
</font><font color="#000080">&auml;&aring;&aelig;&ccedil;&egrave;&eacute;&ecirc;&euml;&igrave;&iacute;&icirc;&iuml;&eth;&ntilde;&ograve;&oacute;&ocirc;&otilde;&ouml;&divide&oslash;&ugrave;&uacute;&ucirc;&uuml;&yacute;&thorn;</font><font color="#800000">';
   </font>FilenameInput <font color="#000080">= </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV'
                  </font><font color="#000080">+</font><font color="#800000">'WXYZ1234567890~!@#$%^&amp;()-_{}.'</font><font color="#000080">;
   </font>FilespecInput <font color="#000080">= </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV'
                  </font><font color="#000080">+</font><font color="#800000">'WXYZ1234567890~!@#$%^&amp;()-_{}.?*'</font><font color="#000080">;
   </font>FilepathInput <font color="#000080">= </font><font color="#800000">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUV'
                  </font><font color="#000080">+</font><font color="#800000">'WXYZ1234567890~!@#$%^&amp;()-_{}.?*:\'</font><font color="#000080">;
   </font>NumberInput   <font color="#000080">= </font><font color="#800000">'123456790.-+'</font><font color="#000080">;

   </font>BackSpace <font color="#000080">= </font><font color="#800000">#8</font><font color="#000080">;
   </font>Space <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;


</font><font color="#FF0000"><b>TYPE
   </b></font>TInput <font color="#000080">= (</font>Standard<font color="#000080">,</font>HighBit<font color="#000080">,</font>Filename<font color="#000080">,</font>Filespec<font color="#000080">,</font>Filepath<font color="#000080">,</font>Number<font color="#000080">);


</font><font color="#FF0000"><b>VAR
   </b></font>MaskCh<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#008000"><i>{must be set before using}


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetInput<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>InStr<font color="#000080">;           </font><font color="#008000"><i>(* Variable being edited *)
                   </i></font>WhatWas<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;     </font><font color="#008000"><i>(* &quot;Old&quot; Value -- being edited *)
                   </i></font>InputType<font color="#000080">: </font>TInput<font color="#000080">;   </font><font color="#008000"><i>(* Input type -- from TInput *)
                   </i></font>Len<font color="#000080">,                 </font><font color="#008000"><i>(* Maximum Characters *)
                   </i></font>XPos<font color="#000080">,                </font><font color="#008000"><i>(* X Start Position *)
                   </i></font>YPos<font color="#000080">,                </font><font color="#008000"><i>(* Y Start Position *)
                   </i></font>Attr<font color="#000080">,                </font><font color="#008000"><i>(* Text Attribute while editing *)
                   </i></font>HighLightAttr<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>(* Attribute of Highlighted Text *)
                   </i></font>BackCh<font color="#000080">: </font>Char<font color="#000080">;        </font><font color="#008000"><i>(* Background Character *)
                   </i></font>MaskInput<font color="#000080">,           </font><font color="#008000"><i>(* Masked Input? -- Set &quot;MaskCh&quot; *)
                   </i></font>Caps<font color="#000080">: </font>Boolean<font color="#000080">);      </font><font color="#008000"><i>(* Force CAPS? *)


</i></font><font color="#FF0000"><b>IMPLEMENTATION


PROCEDURE </b></font>MY_Delay<font color="#000080">(</font>MS<font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
   </font><font color="#008000"><i>(* My Delay procedure, used instead of TP6.0's Delay procedure *)

</i></font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">MOV Ax, 1000;
   MUL MS;
   MOV Cx, Dx;
   MOV Dx, Ax;
   MOV Ah, $86;
   INT $15;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>GetInput<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>InStr<font color="#000080">;
                   </font>WhatWas<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                   </font>InputType<font color="#000080">: </font>TInput<font color="#000080">;
                   </font>Len<font color="#000080">,
                   </font>XPos<font color="#000080">,
                   </font>YPos<font color="#000080">,
                   </font>Attr<font color="#000080">,
                   </font>HighLightAttr<font color="#000080">: </font>Byte<font color="#000080">;
                   </font>BackCh<font color="#000080">: </font>Char<font color="#000080">;
                   </font>MaskInput<font color="#000080">,
                   </font>Caps<font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>TYPE
   </b></font>TInsert <font color="#000080">= (</font><font color="#FF0000"><b>On</b></font><font color="#000080">,</font>Off<font color="#000080">); </font><font color="#008000"><i>(* Insert On/Off Type *)

</i></font><font color="#FF0000"><b>VAR
   </b></font>Temp<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;                      </font><font color="#008000"><i>(* Temporary String Holder *)
   </i></font>Ch<font color="#000080">: </font>Char<font color="#000080">;                          </font><font color="#008000"><i>(* Reads Characters *)
   </i></font>A<font color="#000080">, </font>B<font color="#000080">, </font>U<font color="#000080">: </font>Byte<font color="#000080">;                     </font><font color="#008000"><i>(* Counters *)
   </i></font>ValidKey<font color="#000080">,                          </font><font color="#008000"><i>(* Whether is valid key *)
   </i></font>FirstChar<font color="#000080">,                         </font><font color="#008000"><i>(* Whether is first char entered *)
   </i></font>InsertOn<font color="#000080">,                          </font><font color="#008000"><i>(* Insert or overstrike mode *)
   </i></font>NoAdd<font color="#000080">: </font>Boolean<font color="#000080">;                    </font><font color="#008000"><i>(* Whether to add key to string *)
   </i></font>NewString<font color="#000080">: </font><font color="#FF0000"><b>String ABSOLUTE </b></font>InStr<font color="#000080">;  </font><font color="#008000"><i>(* String being edited *)


   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Ding<font color="#000080">;
      </font><font color="#008000"><i>(* Makes sound to tell user invalid key was pressed *)

   </i></font><font color="#FF0000"><b>BEGIN
      </b></font>Sound<font color="#000080">(</font><font color="#800000">300</font><font color="#000080">);
      </font>MY_Delay<font color="#000080">(</font><font color="#800000">30</font><font color="#000080">);
      </font>NoSound<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


   </font><font color="#FF0000"><b>PROCEDURE </b></font>ToggleInsert<font color="#000080">(</font>Ins<font color="#000080">: </font>TInsert<font color="#000080">);
      </font><font color="#008000"><i>(* Toggles Insert/Overstrike Mode via TInsert type *)

   </i></font><font color="#FF0000"><b>BEGIN
      IF </b></font>Ins <font color="#000080">= </font><font color="#FF0000"><b>On THEN
       BEGIN
          </b></font>InsertOn <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>ChangeCursor<font color="#000080">(</font>NormCursor<font color="#000080">);
       </font><font color="#FF0000"><b>END
      ELSE
       BEGIN
          </b></font>InsertOn <font color="#000080">:= </font>FALSE<font color="#000080">;
          </font>ChangeCursor<font color="#000080">(</font>BlockCursor<font color="#000080">);
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


   </font><font color="#FF0000"><b>PROCEDURE </b></font>FlushKBuff<font color="#000080">;
      </font><font color="#008000"><i>(* Flush keyboard buffer *)
   </i></font><font color="#FF0000"><b>VAR </b></font>Flush<font color="#000080">: </font>Char<font color="#000080">;

   </font><font color="#FF0000"><b>BEGIN
      WHILE </b></font>KeyPressed <font color="#FF0000"><b>DO </b></font>Flush <font color="#000080">:= </font>Readkey<font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN
   </b></font>ChangeCursor<font color="#000080">(</font>NormCursor<font color="#000080">); </font><font color="#008000"><i>(* Default to normal cursor *)
   </i></font>InsertOn <font color="#000080">:= </font>TRUE<font color="#000080">;         </font><font color="#008000"><i>(* Default to Insert Mode *)
   </i></font>FirstChar <font color="#000080">:= </font>TRUE<font color="#000080">;        </font><font color="#008000"><i>(* Set to first character being entered *)
   </i></font>NewString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;          </font><font color="#008000"><i>(* Null NewString *)
   </i></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;               </font><font color="#008000"><i>(* Null Temporary String *)
   </i></font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
   </font>TextAttr <font color="#000080">:= </font>Attr<font color="#000080">;
   </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>BackCh<font color="#000080">);
   </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
   </font>FlushKBuff<font color="#000080">;
   </font>Ch <font color="#000080">:= </font><font color="#800000">#0</font><font color="#000080">;
   </font>TextAttr <font color="#000080">:= </font>HighLightAttr<font color="#000080">;
   </font>NewString <font color="#000080">:= </font>WhatWas<font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
   </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>NewString<font color="#000080">);
   </font>B <font color="#000080">:= </font>Length<font color="#000080">(</font>WhatWas<font color="#000080">);
   </font>A <font color="#000080">:= </font>B<font color="#000080">;
      </font><font color="#008000"><i>(* &quot;A&quot; Counter = How many characters are in string *)
      (* &quot;B&quot; Counter = Current cursor placement in string *)
   </i></font>TextAttr <font color="#000080">:= </font>Attr<font color="#000080">;
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">#13</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">#27</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
       </b></font>NoAdd <font color="#000080">:= </font>FALSE<font color="#000080">;    </font><font color="#008000"><i>(* Default to add key to string *)
       </i></font>ValidKey <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>(* Default to invalid key unless proven valid *)
       </i></font><font color="#FF0000"><b>IF </b></font>Caps <font color="#FF0000"><b>THEN </b></font>Ch <font color="#000080">:= </font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">)
       </font><font color="#FF0000"><b>ELSE </b></font>Ch <font color="#000080">:= </font>ReadKey<font color="#000080">;
       </font><font color="#FF0000"><b>CASE </b></font>InputType <font color="#FF0000"><b>OF </b></font><font color="#008000"><i>(* Check if Ch is in the input list *)
          </i></font>Standard<font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>StandardInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>HighBit <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>HighBitInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>Filename<font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>FilenameInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>Filespec<font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>FilespecInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>Filepath<font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>FilepathInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>Number  <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>POS<font color="#000080">(</font>Ch<font color="#000080">,</font>NumberInput<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR
                       </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">,</font><font color="#800000">#25</font><font color="#000080">]) </font><font color="#FF0000"><b>THEN </b></font>ValidKey <font color="#000080">:= </font>TRUE<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>IF </b></font>ValidKey <font color="#FF0000"><b>THEN
        BEGIN
           CASE </b></font>Ch <font color="#FF0000"><b>OF
              </b></font><font color="#800000">#0 </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                      </b></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                      </font><font color="#FF0000"><b>IF </b></font>FirstChar <font color="#FF0000"><b>THEN
                       BEGIN
                          </b></font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                          </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                          </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
                          </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>NewString<font color="#000080">);
                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                      </font>Ch <font color="#000080">:= </font>UpCase<font color="#000080">(</font>ReadKey<font color="#000080">);
                      </font><font color="#FF0000"><b>CASE </b></font>Ch <font color="#FF0000"><b>OF
                         </b></font><font color="#800000">#77</font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>NewString<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{Right Arrow}
                               </i></font><font color="#FF0000"><b>BEGIN
                                  </b></font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>YPos<font color="#000080">);
                                  </font>Inc<font color="#000080">(</font>B<font color="#000080">);
                               </font><font color="#FF0000"><b>END
                              ELSE </b></font>Ding<font color="#000080">;
                         </font><font color="#800000">#75</font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{Left Arrow}
                               </i></font><font color="#FF0000"><b>BEGIN
                                  </b></font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>YPos<font color="#000080">);
                                  </font>Dec<font color="#000080">(</font>B<font color="#000080">);
                               </font><font color="#FF0000"><b>END
                              ELSE </b></font>Ding<font color="#000080">;
                         </font><font color="#800000">#71</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Home}
                                 </i></font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                                 </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                         </font><font color="#800000">#79</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{End}
                                 </i></font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>Length<font color="#000080">(</font>NewString<font color="#000080">),</font>YPos<font color="#000080">);
                                 </font>B <font color="#000080">:= </font>Length<font color="#000080">(</font>NewString<font color="#000080">);
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                         </font><font color="#800000">#82</font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>InsertOn <font color="#FF0000"><b>THEN </b></font>ToggleInsert<font color="#000080">(</font>Off<font color="#000080">) </font><font color="#008000"><i>{Ins}
                              </i></font><font color="#FF0000"><b>ELSE </b></font>ToggleInsert<font color="#000080">(</font><font color="#FF0000"><b>On</b></font><font color="#000080">);
                         </font><font color="#800000">#83</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Del}
                                 </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>B <font color="#000080">&lt; </font>Length<font color="#000080">(</font>NewString<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>B <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                  BEGIN
                                     </b></font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                                     </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                                      IF </b></font>MaskInput <font color="#FF0000"><b>THEN
                                       BEGIN
                                          IF </b></font>U <font color="#000080">&lt;&gt; </font>B <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>MaskCh
                                          <font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                                       </font><font color="#FF0000"><b>END
                                      ELSE
                                       BEGIN
                                          IF </b></font>U <font color="#000080">&lt;&gt; </font>B <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                                          </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                                     </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">,</font>YPos<font color="#000080">);
                                     </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
                                     </font>Write<font color="#000080">(</font>BackCh<font color="#000080">);
                                     </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">,</font>YPos<font color="#000080">);
                                     </font>Dec<font color="#000080">(</font>A<font color="#000080">);
                                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                         </font><font color="#FF0000"><b>ELSE </b></font>Ding<font color="#000080">;
                      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                      </font>FlushKBuff<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#800000">#8 </font><font color="#000080">: </font><font color="#FF0000"><b>IF </b></font>B <font color="#000080">&gt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{Backspace}
                    </i></font><font color="#FF0000"><b>BEGIN
                       IF </b></font>FirstChar <font color="#FF0000"><b>THEN
                        BEGIN
                           </b></font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                           </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                           </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
                           </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>NewString<font color="#000080">);
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font>Write<font color="#000080">(</font>Backspace<font color="#000080">,</font>BackCh<font color="#000080">,</font>Backspace<font color="#000080">);
                       </font>Dec<font color="#000080">(</font>B<font color="#000080">);
                       </font>Dec<font color="#000080">(</font>A<font color="#000080">);
                       </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">,</font>YPos<font color="#000080">);
                       </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                        IF </b></font>MaskInput <font color="#FF0000"><b>THEN
                         BEGIN
                            IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>MaskCh
                            <font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                         </font><font color="#FF0000"><b>END
                        ELSE
                         BEGIN
                            IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                            </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
                       </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>Length<font color="#000080">(</font>NewString<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>BackCh<font color="#000080">);
                       </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">,</font>YPos<font color="#000080">);
                       </font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                    </font><font color="#FF0000"><b>END
                   ELSE </b></font>Ding<font color="#000080">;
              </font><font color="#800000">#27</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{Esc}
                      </i></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                      </font>NewString <font color="#000080">:= </font>WhatWas<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#800000">#25</font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{CTRL+Y}
                      </i></font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
                      </font>NewString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                      </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>BackCh<font color="#000080">);
                      </font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                      </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                      </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                      </font>A <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#800000">#13</font><font color="#000080">: </font>NoAdd <font color="#000080">:= </font>TRUE<font color="#000080">;
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(((</font>A <font color="#000080">&lt; </font>Len<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>A <font color="#000080">&lt; </font>Len<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND NOT</b></font><font color="#000080">(</font>InsertOn<font color="#000080">))) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>NoAdd <font color="#000080">= </font>FALSE<font color="#000080">)
              </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">#8</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>FirstChar<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT</b></font><font color="#000080">(</font>NoAdd<font color="#000080">)) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Ch <font color="#000080">&lt;&gt; </font><font color="#800000">#8</font><font color="#000080">)) </font><font color="#FF0000"><b>THEN
            BEGIN
               IF </b></font>FirstChar <font color="#FF0000"><b>THEN
                BEGIN
                   </b></font>NewString <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                   </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                   </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                   </font>A <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                   </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Len <font color="#FF0000"><b>Do </b></font>Write<font color="#000080">(</font>BackCh<font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">,</font>YPos<font color="#000080">);
                   </font>FirstChar <font color="#000080">:= </font>FALSE<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>IF </b></font>InsertOn <font color="#FF0000"><b>THEN
                BEGIN
                   </b></font>Inc<font color="#000080">(</font>B<font color="#000080">);
                   </font>Inc<font color="#000080">(</font>A<font color="#000080">);
                   </font>Insert<font color="#000080">(</font>Ch<font color="#000080">,</font>NewString<font color="#000080">,</font>B<font color="#000080">);
                   </font><font color="#FF0000"><b>FOR </b></font>U <font color="#000080">:= </font>B <font color="#FF0000"><b>TO </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>DO
                    IF </b></font>MaskInput <font color="#FF0000"><b>THEN
                     BEGIN
                        IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>MaskCh
                        <font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END
                    ELSE
                     BEGIN
                        IF </b></font>B <font color="#000080">&lt;&gt; </font>U <font color="#FF0000"><b>THEN </b></font>Temp <font color="#000080">:= </font>Temp <font color="#000080">+ </font>NewString<font color="#000080">[</font>U<font color="#000080">]
                        </font><font color="#FF0000"><b>ELSE </b></font>Temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                   </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>YPos<font color="#000080">);
                   </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
                   </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>Ch<font color="#000080">);
                   </font>Write<font color="#000080">(</font>Temp<font color="#000080">);
                   </font>GotoXY<font color="#000080">(</font>XPos<font color="#000080">+</font>B<font color="#000080">,</font>YPos<font color="#000080">);
                </font><font color="#FF0000"><b>END
               ELSE
                BEGIN
                   IF </b></font>Length<font color="#000080">(</font>NewString<font color="#000080">) &lt; </font>Len <font color="#FF0000"><b>THEN
                    BEGIN
                       IF </b></font>B <font color="#000080">&gt;= </font>Length<font color="#000080">(</font>NewString<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Inc<font color="#000080">(</font>A<font color="#000080">);
                       </font>Inc<font color="#000080">(</font>B<font color="#000080">);
                       </font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font>Insert<font color="#000080">(</font>Ch<font color="#000080">,</font>NewString<font color="#000080">,</font>B<font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
                       </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>Ch<font color="#000080">);
                    </font><font color="#FF0000"><b>END
                   ELSE IF </b></font><font color="#000080">(</font>A <font color="#000080">= </font>Len<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>B <font color="#000080">&lt; </font>Len<font color="#000080">) </font><font color="#FF0000"><b>THEN
                    BEGIN
                       </b></font>Inc<font color="#000080">(</font>B<font color="#000080">);
                       </font>Delete<font color="#000080">(</font>NewString<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font>Insert<font color="#000080">(</font>Ch<font color="#000080">,</font>NewString<font color="#000080">,</font>B<font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>MaskInput <font color="#FF0000"><b>THEN </b></font>Write<font color="#000080">(</font>MaskCh<font color="#000080">)
                       </font><font color="#FF0000"><b>ELSE </b></font>Write<font color="#000080">(</font>Ch<font color="#000080">);
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END
       ELSE </b></font>Ding<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>FlushKBuff<font color="#000080">;
   </font>ChangeCursor<font color="#000080">(</font>NormCursor<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0078.PAS">Original</a><b>]</b></p></body>
</html>
