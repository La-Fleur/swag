<html>
<head><title> "Display MAKE/BREAK codes" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>ScanCode <font color="#000080">;      </font><font color="#008000"><i>{ display MAKE and BREAK scan codes }

</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">, </font>KeyIntr <font color="#000080">;      </font><font color="#008000"><i>{ keyboard interrupt support }

{ ----- this program will probably hang a debugger ----- }

</i></font><font color="#FF0000"><b>Var
   </b></font>OldInt09 <font color="#000080">: </font>Pointer <font color="#000080">;
   </font>ExitSave <font color="#000080">: </font>Pointer <font color="#000080">;

</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>Procedure </b></font>RestoreInt09 <font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>ExitProc <font color="#000080">:= </font>ExitSave <font color="#000080">;
   </font>SetIntVec<font color="#000080">( </font><font color="#800000">$09</font><font color="#000080">, </font>OldInt09 <font color="#000080">) ;
</font><font color="#FF0000"><b>End </b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+} </i></font><font color="#FF0000"><b>Procedure </b></font>NewInt09 <font color="#000080">; </font>Interrupt <font color="#000080">;   </font><font color="#008000"><i>{ return scan code as key's value }
</i></font><font color="#FF0000"><b>Var
   </b></font>ScanCode <font color="#000080">: </font>Byte <font color="#000080">;
   </font>BufferFull <font color="#000080">: </font>Boolean <font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>EnableInterrupts <font color="#000080">;
   </font>ScanCode <font color="#000080">:= </font>ReadScanCode <font color="#000080">;
   </font>ResetKeyboard <font color="#000080">;
   </font>BufferFull <font color="#000080">:= </font><font color="#FF0000"><b>Not </b></font>StoreKey<font color="#000080">( </font>ScanCode<font color="#000080">, </font>ScanCode <font color="#000080">) ;
   </font>EOI <font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>BufferFull <font color="#FF0000"><b>then
   Begin
      </b></font>Sound<font color="#000080">( </font><font color="#800000">880 </font><font color="#000080">) ;
      </font>Delay<font color="#000080">( </font><font color="#800000">100 </font><font color="#000080">) ;
      </font>Sound<font color="#000080">( </font><font color="#800000">440 </font><font color="#000080">) ;
      </font>Delay<font color="#000080">( </font><font color="#800000">100 </font><font color="#000080">) ;
      </font>NoSound <font color="#000080">;
   </font><font color="#FF0000"><b>End </b></font><font color="#000080">;
                </font><font color="#008000"><i>{ variation : move the EOI before the beep to after it }
                {      note the difference when the keyboard overflows }
</i></font><font color="#FF0000"><b>End </b></font><font color="#000080">;

</font><font color="#008000"><i>{ see Turbo Pascal 5.0 reference p 450 for a list of scan codes }
{                  6.0 programmers guide p 354                  }

</i></font><font color="#FF0000"><b>Var
   </b></font>N  <font color="#000080">: </font>Byte <font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
   </b></font>ExitSave <font color="#000080">:= </font>ExitProc <font color="#000080">;
   </font>ExitProc <font color="#000080">:= @</font>RestoreInt09 <font color="#000080">;
   </font>GetIntVec<font color="#000080">( </font><font color="#800000">$09</font><font color="#000080">, </font>OldInt09 <font color="#000080">) ;
   </font>SetIntVec<font color="#000080">( </font><font color="#800000">$09</font><font color="#000080">, @</font>NewInt09 <font color="#000080">) ;

   </font>WriteLn<font color="#000080">( </font><font color="#800000">'   Display &quot;make&quot; and &quot;break&quot; scan codes ' </font><font color="#000080">) ;
   </font>WriteLn <font color="#000080">;
   </font>WriteLn<font color="#000080">( </font><font color="#800000">'   Hit the &lt;Esc&gt; key to exit ' </font><font color="#000080">) ;
   </font><font color="#FF0000"><b>Repeat
      </b></font>Delay<font color="#000080">( </font><font color="#800000">400 </font><font color="#000080">) ;               </font><font color="#008000"><i>{ make it easy to overrun keyboard }
      </i></font>N <font color="#000080">:= </font>Ord<font color="#000080">( </font>ReadKey <font color="#000080">) ;        </font><font color="#008000"><i>{ n is the scan code from NewInt09 }
      </i></font><font color="#FF0000"><b>If </b></font>N <font color="#000080">&lt; </font><font color="#800000">128 </font><font color="#FF0000"><b>then
         </b></font>WriteLn<font color="#000080">( </font><font color="#800000">'Make  '</font><font color="#000080">, </font>n <font color="#000080">)
      </font><font color="#FF0000"><b>Else
         </b></font>WriteLn<font color="#000080">( </font><font color="#800000">'    Break  '</font><font color="#000080">, </font>n <font color="#000080">- </font><font color="#800000">128 </font><font color="#000080">) ;
   </font><font color="#FF0000"><b>Until </b></font>n <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">;      </font><font color="#008000"><i>{ the make code for Esc }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to KEYBOARD SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0017.PAS">Original</a><b>]</b></p></body>
</html>
