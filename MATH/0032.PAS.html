<html>
<head><title> "Math Parsing Unit" by RYAN THOMPSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
From: RYAN THOMPSON
Subj: RE: MATH PARSING
*)

</i></font><font color="#FF0000"><b>Function </b></font>Evaluate<font color="#000080">(</font>Equation <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Temp<font color="#000080">, </font>Operand<font color="#000080">, </font>Front<font color="#000080">, </font>Rear <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Par1<font color="#000080">, </font>Par2 <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Value1<font color="#000080">, </font>Value2<font color="#000080">, </font>Valtemp <font color="#000080">: </font>Real<font color="#000080">;
    </font>OperOK<font color="#000080">,
    </font>BadExp <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
    If </b></font>Equation <font color="#000080">= </font>Error <font color="#FF0000"><b>then begin
      </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Equation<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
      </b></font>Delete<font color="#000080">(</font>Equation<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Equation<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat
      </b></font>X<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>Par1<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Par2<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>repeat
          If </b></font>Equation<font color="#000080">[</font>X<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then </b></font>Par1<font color="#000080">:= </font>X<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>Equation<font color="#000080">[</font>X<font color="#000080">] = </font><font color="#800000">')' </font><font color="#FF0000"><b>then </b></font>Par2<font color="#000080">:= </font>X<font color="#000080">;
          </font>Inc<font color="#000080">(</font>X<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>X <font color="#000080">= </font>Length<font color="#000080">(</font>Equation<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>Par1 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Par2 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">));
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Par2 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Par2<font color="#000080">+</font><font color="#800000">1 </font><font color="#000080">&lt; </font>Length<font color="#000080">(</font>Equation<font color="#000080">)) </font><font color="#FF0000"><b>and
           </b></font><font color="#000080">(</font>Equation<font color="#000080">[</font>Par2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'('</font><font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Insert<font color="#000080">(</font><font color="#800000">'x'</font><font color="#000080">, </font>Equation<font color="#000080">, </font>Par2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Par2 <font color="#000080">&gt; </font>Par1<font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>Temp<font color="#000080">:= </font>Equation<font color="#000080">;
          </font>Rear<font color="#000080">:= </font>Copy<font color="#000080">(</font>Temp<font color="#000080">, </font>Par2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
         </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Par2<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
         </font>Front<font color="#000080">:= </font>Copy<font color="#000080">(</font>Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Par1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
          </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Par1<font color="#000080">);
        </font>Temp<font color="#000080">:= </font>Evaluate<font color="#000080">(</font>Temp<font color="#000080">);
        </font>Equation<font color="#000080">:= </font>Front <font color="#000080">+ </font>Temp <font color="#000080">+ </font>Rear<font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Equation<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
          </b></font>Delete<font color="#000080">(</font>Equation<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>Equation<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
      else if </b></font>Par2 <font color="#000080">&lt; </font>Par1 <font color="#FF0000"><b>then begin
         </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
        </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>Par2 <font color="#000080">&lt;= </font>Par1<font color="#000080">;
    </font>Value1<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Equation<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
        </b></font>Operand<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font>X<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>Equation<font color="#000080">[</font>X<font color="#000080">] &lt; </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Equation<font color="#000080">[</font>X<font color="#000080">] &gt; </font><font color="#800000">'9'</font><font color="#000080">))
            </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Equation<font color="#000080">[</font>X<font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">)
            </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>X <font color="#000080">&lt; </font>Length<font color="#000080">(</font>Equation<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">)
      </font><font color="#FF0000"><b>do begin
        </b></font>Operand<font color="#000080">:= </font>Operand <font color="#000080">+ </font>Equation<font color="#000080">[</font>X<font color="#000080">];
        </font>Inc<font color="#000080">(</font>X<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>Delete<font color="#000080">(</font>Equation<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>X <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>Equation<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>Temp<font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
      </font>X<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(((</font>Equation<font color="#000080">[</font>X<font color="#000080">] &lt;= </font><font color="#800000">'9'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Equation<font color="#000080">[</font>X<font color="#000080">] &gt;= </font><font color="#800000">'0'</font><font color="#000080">))
            </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Equation<font color="#000080">[</font>X<font color="#000080">] = </font><font color="#800000">'.'</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>X <font color="#000080">&lt; </font>Length<font color="#000080">(</font>Equation<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
      begin
          </b></font>Temp<font color="#000080">:= </font>Temp <font color="#000080">+ </font>Equation<font color="#000080">[</font>X<font color="#000080">];
        </font>Inc<font color="#000080">(</font>X<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>X <font color="#000080">&gt; </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Equation<font color="#000080">) &gt; </font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
          </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
          </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Delete<font color="#000080">(</font>Equation<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>X <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
      </font>Val<font color="#000080">(</font>Temp<font color="#000080">, </font>Value2<font color="#000080">, </font>Y<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Y <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
        </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Temp<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>Operand<font color="#000080">) &gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then begin
      </b></font>Temp<font color="#000080">:= </font>Operand<font color="#000080">;
         </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">, </font>Temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
        </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">, </font>Temp<font color="#000080">) &lt;&gt; </font>Length<font color="#000080">(</font>Temp<font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">, </font>Temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'x'</font><font color="#000080">, </font>Temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>Temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font>Delete<font color="#000080">(</font>Temp<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">'^'</font><font color="#000080">, </font>Temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">'+'</font><font color="#000080">, </font>Operand<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Operand<font color="#000080">:= </font><font color="#800000">'+'
      </font><font color="#FF0000"><b>else if </b></font>Pos<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">, </font>Operand<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Operand<font color="#000080">:= </font><font color="#800000">'-'
      </font><font color="#FF0000"><b>else if </b></font>Pos<font color="#000080">(</font><font color="#800000">'x'</font><font color="#000080">, </font>Operand<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Operand<font color="#000080">:= </font><font color="#800000">'x'
        </font><font color="#FF0000"><b>else if </b></font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>Operand<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Operand<font color="#000080">:= </font><font color="#800000">'/'
      </font><font color="#FF0000"><b>else if </b></font>Pos<font color="#000080">(</font><font color="#800000">'^'</font><font color="#000080">, </font>Operand<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Operand<font color="#000080">:= </font><font color="#800000">'^'
      </font><font color="#FF0000"><b>else </b></font>Operand<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>OperOK<font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'SIN' </font><font color="#FF0000"><b>then begin
      </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
      </font>Value2<font color="#000080">:= </font>Sin<font color="#000080">(</font>Rad<font color="#000080">(</font>Value2<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'COS' </font><font color="#FF0000"><b>then begin
        </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
        </font>Value2<font color="#000080">:= </font>Cos<font color="#000080">(</font>Rad<font color="#000080">(</font>Value2<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'TAN' </font><font color="#FF0000"><b>then if </b></font>Cos<font color="#000080">(</font>Rad<font color="#000080">(</font>Value2<font color="#000080">)) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
        </font>Value2<font color="#000080">:= (</font>Sin<font color="#000080">(</font>Rad<font color="#000080">(</font>Value2<font color="#000080">)) / </font>Cos<font color="#000080">(</font>Rad<font color="#000080">(</font>Value2<font color="#000080">)));
    </font><font color="#FF0000"><b>end
    else begin
        </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
        </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'SQR' </font><font color="#FF0000"><b>then begin
        </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
        </font>Value2<font color="#000080">:= </font>Sqrt<font color="#000080">(</font>Value2<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'ASIN' </font><font color="#FF0000"><b>then begin
        </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
        </font>Valtemp<font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">- </font>Sqr<font color="#000080">(</font>Value2<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>Valtemp <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
           </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
           </font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end
         else If </b></font>Sqrt<font color="#000080">(</font>Valtemp<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Value2<font color="#000080">:= </font><font color="#800000">90
         </font><font color="#FF0000"><b>else </b></font>Value2<font color="#000080">:= </font>Deg<font color="#000080">(</font>ArcTan<font color="#000080">(</font>Value2 <font color="#000080">/ </font>Sqrt<font color="#000080">(</font>Valtemp<font color="#000080">)));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">'ACOS' </font><font color="#FF0000"><b>then begin
      </b></font>OperOK<font color="#000080">:= </font>True<font color="#000080">;
      </font>Valtemp<font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">- </font>Sqr<font color="#000080">(</font>Value2<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>Valtemp <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
           </b></font>Evaluate<font color="#000080">:= </font>Error<font color="#000080">;
        </font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>end
         else If </b></font>Value2 <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Value2<font color="#000080">:= </font><font color="#800000">90
         </font><font color="#FF0000"><b>else </b></font>Value2<font color="#000080">:= </font>Deg<font color="#000080">(</font>Arctan<font color="#000080">(</font>Sqrt<font color="#000080">(</font>Valtemp<font color="#000080">) / </font>Value2<font color="#000080">))
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
