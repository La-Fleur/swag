<html>
<head><title> "Math Unit" by MARTIN PREISHUBER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: Martin Preishuber &lt;martin_p@efn.efn.org&gt;

mycalc.pas that is a unit with mathematical function. the numbers
  are based on 65536, so you can calculate with really
  huge numbers.
rabin.pas it's a demo program for mycalc. you can test large
  number,s whether it is a prime or not

both programs are documented in german, so i guess that documentation
won't help much :-(
}

(* ----------------------------------------------------------------------- *)
(* RabinTest prÅft, ob eine Zahl eine Primzahl ist                         *)
(* ----------------------------------------------------------------------- *)

{$M 65000, 0, 655360}                          (* Stack auf maximale Grî&aacute;e *)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>RabinTest<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">,                                         </font><font color="#008000"><i>(* Ein/Ausgabefunktionen *)
     </i></font>Extend<font color="#000080">,                                </font><font color="#008000"><i>(* erweiterte I/O - Funktionen *)
     </i></font>MyCalc<font color="#000080">;               </font><font color="#008000"><i>(* Funktionen fÅr das Rechnen mit gro&aacute;en Zahlen *)

(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Expt<font color="#000080">(</font>zahl <font color="#000080">: </font>Real<font color="#000080">; </font>hoch <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>Real<font color="#000080">;
    </font><font color="#008000"><i>(* Berechnung des Exponenten einer Realzahl (einfach, weil nur fÅr die *)
                                       (* Berechnung von AnzahlTests nîtig *)
</i></font><font color="#FF0000"><b>VAR </b></font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;                                       </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>hilfe <font color="#000080">: </font>Real<font color="#000080">;                        </font><font color="#008000"><i>(* Hilfsvariable fÅr das Ergebnis *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>hoch <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN                                         </b></font><font color="#008000"><i>(* Hochzahl = 0 *)
    </i></font>Expt <font color="#000080">:= </font><font color="#800000">1                                           </font><font color="#008000"><i>(* =&gt; Ergebnis = 1 *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>hilfe <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                         </font><font color="#008000"><i>(* Ergebnis mit 1 initialisieren *)
      </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>hoch <font color="#FF0000"><b>DO </b></font>hilfe <font color="#000080">:= </font>hilfe <font color="#000080">* </font>zahl<font color="#000080">;
                           </font><font color="#008000"><i>(* Zahl hoch mal mit sich selbst multiplizieren *)
      </i></font>Expt <font color="#000080">:= </font>hilfe<font color="#000080">;                             </font><font color="#008000"><i>(* Ergebnis zurÅckliefern *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>AnzahlTests<font color="#000080">(</font>wahrscheinlichkeit <font color="#000080">: </font>Real<font color="#000080">) : </font>INTEGER<font color="#000080">;
        </font><font color="#008000"><i>(* ermittelt die Anzahl Tests, welche nîtig sind um die gewÅnschte *)
                                        (* Wahrscheinlichkeit zu erreichen *)
</i></font><font color="#FF0000"><b>VAR </b></font>anzahl <font color="#000080">: </font>INTEGER<font color="#000080">;                          </font><font color="#008000"><i>(* Anzahl der nîtigen Tests *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>anzahl <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                              </font><font color="#008000"><i>(* Anzahl mit 0 initialisieren *)
  </i></font><font color="#FF0000"><b>REPEAT
    </b></font>INC<font color="#000080">(</font>anzahl<font color="#000080">);                                    </font><font color="#008000"><i>(* Anzahl um 1 erhîhen *)
  </i></font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">((</font><font color="#800000">1</font><font color="#000080">/(</font>Expt<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">,</font>anzahl<font color="#000080">))) &lt; </font>wahrscheinlichkeit<font color="#000080">);
                                   </font><font color="#008000"><i>(* solange wiederholen, bis W &gt; (1/4)^x *)
  </i></font>AnzahlTests <font color="#000080">:= </font>anzahl<font color="#000080">;                       </font><font color="#008000"><i>(* Anzahl Tests zurÅckgeben *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>EvenString<font color="#000080">(</font>zahl <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
                                        </font><font color="#008000"><i>(* prÅft, on ein String gerade ist *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>EvenString <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>Odd<font color="#000080">(</font>Ord<font color="#000080">(</font>zahl<font color="#000080">[</font>Length<font color="#000080">(</font>zahl<font color="#000080">)]) - </font><font color="#800000">48</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;                 </font><font color="#008000"><i>(* prÅft, ob die letzte Stelle des Strings gerade ist *)

(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Div5<font color="#000080">(</font>zahl <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
                           </font><font color="#008000"><i>(* prÅft, ob ein String durch 5 dividierbar ist *)
</i></font><font color="#FF0000"><b>VAR </b></font>last <font color="#000080">: </font>BYTE<font color="#000080">;                                 </font><font color="#008000"><i>(* letzte Stelle von zahl *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>last <font color="#000080">:= </font>Ord<font color="#000080">(</font>zahl<font color="#000080">[</font>Length<font color="#000080">(</font>zahl<font color="#000080">)]) - </font><font color="#800000">48</font><font color="#000080">;         </font><font color="#008000"><i>(* letzte Stelle ermitteln *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>last <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>last <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>THEN     </b></font><font color="#008000"><i>(* Falls letzte Stelle 0 oder 5 ist *)
    </i></font>Div5 <font color="#000080">:= </font>TRUE                       <font color="#008000"><i>(* ist die Zahl durch 5 dividierbar *)
  </i></font><font color="#FF0000"><b>ELSE
    </b></font>Div5 <font color="#000080">:= </font>FALSE<font color="#000080">;                                          </font><font color="#008000"><i>(* sonst nicht *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                 </font><font color="#008000"><i>(* prÅft, ob die letzte Stelle des Strings gerade ist *)

(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Div3<font color="#000080">(</font>zahl <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
                           </font><font color="#008000"><i>(* prÅft, ob ein String durch 5 dividierbar ist *)
</i></font><font color="#FF0000"><b>VAR </b></font>ziffernSumme <font color="#000080">: </font>WORD<font color="#000080">;                       </font><font color="#008000"><i>(* Ziffernsumme des Strings *)
    </i></font>laenge       <font color="#000080">: </font>BYTE<font color="#000080">;                             </font><font color="#008000"><i>(* Laenge des Strings *)
    </i></font>i            <font color="#000080">: </font>BYTE<font color="#000080">;                                   </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ziffernSumme <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                        </font><font color="#008000"><i>(* Ziffernsumme initialisieren *)
  </i></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zahl<font color="#000080">);                   </font><font color="#008000"><i>(* LÑnge des Strings ermitteln *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>laenge <font color="#FF0000"><b>DO                        </b></font><font color="#008000"><i>(* ZiffernSumme ermitteln *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>ziffernSumme <font color="#000080">:= </font>ziffernSumme <font color="#000080">+ (</font>Ord<font color="#000080">(</font>zahl<font color="#000080">[</font>i<font color="#000080">]) - </font><font color="#800000">48</font><font color="#000080">);
                                </font><font color="#008000"><i>(* aktuelle Zahl zur Ziffernsumme addieren *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ZiffernSumme <font color="#FF0000"><b>MOD </b></font><font color="#800000">3</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>(* Ziffernsumme durch 3 teilbar *)
    </i></font>Div3 <font color="#000080">:= </font>TRUE                                <font color="#008000"><i>(* =&gt; Zahl durch 3 teilbar *)
  </i></font><font color="#FF0000"><b>ELSE
    </b></font>Div3 <font color="#000080">:= </font>FALSE<font color="#000080">;                 </font><font color="#008000"><i>(* sonst ist Zahl nicht durch 3 teilbar *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Bedingung 1 beim Rabintest: b^v&eth;1 mod p                                 *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Bedingung1<font color="#000080">(</font>b<font color="#000080">, </font>v<font color="#000080">, </font>p<font color="#000080">, </font>pMinus1<font color="#000080">, </font>EINS <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>hilfe <font color="#000080">: </font>CalcStr<font color="#000080">;                                    </font><font color="#008000"><i>(* HilfsCalcString *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ExptModCalcStr<font color="#000080">(</font>b<font color="#000080">, </font>v<font color="#000080">, </font>p<font color="#000080">, </font>hilfe<font color="#000080">);                   </font><font color="#008000"><i>(* b^v mod p berechnen *)

  </i></font>Write<font color="#000080">(</font><font color="#800000">'b^v mod p = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>hilfe<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font>EqualCalcStr<font color="#000080">(</font>hilfe<font color="#000080">, </font>EINS<font color="#000080">) </font><font color="#FF0000"><b>THEN                  </b></font><font color="#008000"><i>(* Falls Ergebnis = 1 *)
    </i></font>Bedingung1 <font color="#000080">:= </font>TRUE                              <font color="#008000"><i>(* Bedingung 1 erfÅllt *)
  </i></font><font color="#FF0000"><b>ELSE
    IF </b></font>EqualCalcStr<font color="#000080">(</font>hilfe<font color="#000080">, </font>pMinus1<font color="#000080">) </font><font color="#FF0000"><b>THEN
      </b></font>Bedingung1 <font color="#000080">:= </font>TRUE                    <font color="#008000"><i>(* Bedingung 2 mit r=0 erfÅllt *)
    </i></font><font color="#FF0000"><b>ELSE
      </b></font>Bedingung1 <font color="#000080">:= </font>FALSE<font color="#000080">;          </font><font color="#008000"><i>(* sonst ist Bedingung 1 nicht erfÅllt *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Bedingung 2 beim Rabintest: b^(v^(2r)) &eth; -1 mod p                       *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Bedingung2<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>b<font color="#000080">, </font>v<font color="#000080">, </font>u<font color="#000080">, </font>p<font color="#000080">, </font>pMinus1<font color="#000080">, </font>EINS <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>r      <font color="#000080">: </font>CalcStr<font color="#000080">;                       </font><font color="#008000"><i>(* zu durchlaufende Hochzahlen *)
    </i></font>ZWEI   <font color="#000080">: </font>CalcStr<font color="#000080">;            </font><font color="#008000"><i>(* konstante CalcString-Darstellung fÅr 2 *)
    </i></font>hilfe1 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe2 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>InitCalcStr<font color="#000080">(</font>r<font color="#000080">);                                      </font><font color="#008000"><i>(* r initialisieren *)
  </i></font>r<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                 </font><font color="#008000"><i>(* r hat 1 Stelle, diese ist zu Beginn 0 *)
  </i></font>r<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>(* r lÑuft von 1 weg, weil Bedingung mit r=0 schon in *)
                                               (* Bedingung 1 geprÅft wird *)
  </i></font>WordToCalcStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>ZWEI<font color="#000080">);             </font><font color="#008000"><i>(* Zahl zwei in CalcString ermitteln *)
  </i></font><font color="#FF0000"><b>WHILE </b></font>LessCalcStr<font color="#000080">(</font>r<font color="#000080">, </font>u<font color="#000080">) </font><font color="#FF0000"><b>DO                              </b></font><font color="#008000"><i>(* solange r &lt; u *)
    </i></font><font color="#FF0000"><b>BEGIN

      </b></font>Write<font color="#000080">(</font><font color="#800000">'r = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>r<font color="#000080">);

      </font>ExptCalcStr<font color="#000080">(</font>ZWEI<font color="#000080">, </font>r<font color="#000080">, </font>hilfe1<font color="#000080">);                       </font><font color="#008000"><i>(* 2^r ermitteln *)
      </i></font>MulCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>v<font color="#000080">, </font>hilfe2<font color="#000080">);           </font><font color="#008000"><i>(* 2^r mit v multiplizieren *)
      </i></font>ExptModCalcStr<font color="#000080">(</font>b<font color="#000080">, </font>hilfe2<font color="#000080">, </font>p<font color="#000080">, </font>hilfe1<font color="#000080">);    </font><font color="#008000"><i>(* b^(v2^r) MOD p berechnen *)

      </i></font>Write<font color="#000080">(</font><font color="#800000">'b^(v2^r) mod p = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">);

      </font><font color="#FF0000"><b>IF </b></font>EqualCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>pMinus1<font color="#000080">) </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>(* Falls Ergebnis = -1 *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>Bedingung2 <font color="#000080">:= </font>TRUE<font color="#000080">;                       </font><font color="#008000"><i>(* Bedingung 2 erfÅllt *)
          </i></font>EXIT<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>AddCalcStr<font color="#000080">(</font>r<font color="#000080">, </font>EINS<font color="#000080">, </font>hilfe2<font color="#000080">);                       </font><font color="#008000"><i>(* r um 1 erhîhen *)
      </i></font>r <font color="#000080">:= </font>hilfe2<font color="#000080">;                                    </font><font color="#008000"><i>(* r wieder zuweisen *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Bedingung2 <font color="#000080">:= </font>FALSE<font color="#000080">;                       </font><font color="#008000"><i>(* 2. Bedingung nicht erfÅllt *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Rabin prÅft eine Zahl mit Hilfe des RabinTests                          *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Rabin<font color="#000080">(</font>primzahl <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>anzahl <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>p       <font color="#000080">: </font>CalcStr<font color="#000080">;                        </font><font color="#008000"><i>(* zu untersuchende Primzahl *)
    </i></font>pMinus1 <font color="#000080">: </font>CalcStr<font color="#000080">;                                     </font><font color="#008000"><i>(* Primzahl - 1 *)
    </i></font>EINS    <font color="#000080">: </font>CalcStr<font color="#000080">;                            </font><font color="#008000"><i>(* konstanter Wert fÅr 1 *)
    </i></font>u       <font color="#000080">: </font>CalcStr<font color="#000080">;                         </font><font color="#008000"><i>(* p-1 = 2^u*v (v ungerade) *)
    </i></font>v       <font color="#000080">: </font>CalcStr<font color="#000080">;                         </font><font color="#008000"><i>(* p-1 = 2^u*v (v ungerade) *)
    </i></font>b       <font color="#000080">: </font>CalcStr<font color="#000080">;                           </font><font color="#008000"><i>(* Basis bei Primzahltest *)
    </i></font>hilfe   <font color="#000080">: </font>CalcStr<font color="#000080">;                                  </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>i       <font color="#000080">: </font>BYTE<font color="#000080">;                                        </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>StrToCalcStr<font color="#000080">(</font>primzahl<font color="#000080">, </font>p<font color="#000080">);        </font><font color="#008000"><i>(* Primzahl ins 65536-System umwandeln *)
  </i></font>WordToCalcStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>EINS<font color="#000080">);                   </font><font color="#008000"><i>(* CalcStringdarstellung von 1 *)
  </i></font>SubCalcStr<font color="#000080">(</font>p<font color="#000080">, </font>EINS<font color="#000080">, </font>pMinus1<font color="#000080">);                     </font><font color="#008000"><i>(* vom pMinus1 = p - 1 *)
  </i></font>InitCalcStr<font color="#000080">(</font>u<font color="#000080">);                                      </font><font color="#008000"><i>(* u initialisieren *)
  </i></font>u<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                      </font><font color="#008000"><i>(* u besitzt 1 Stellen, diese ist 0 *)
  </i></font>v <font color="#000080">:= </font>pMinus1<font color="#000080">;                                     </font><font color="#008000"><i>(* v ist zu Beginn p-1 *)
  </i></font><font color="#FF0000"><b>REPEAT
    </b></font>AddCalcStr<font color="#000080">(</font>u<font color="#000080">, </font>EINS<font color="#000080">, </font>hilfe<font color="#000080">);                </font><font color="#008000"><i>(* 2^u, Potenz um 1 erhîhen *)
    </i></font>u <font color="#000080">:= </font>hilfe<font color="#000080">;                                   </font><font color="#008000"><i>(* und wieder u zuweisen *)
    </i></font>Div2CalcStr<font color="#000080">(</font>v<font color="#000080">);                                </font><font color="#008000"><i>(* v durch 2 dividieren *)
  </i></font><font color="#FF0000"><b>UNTIL </b></font>OddCalcStr<font color="#000080">(</font>v<font color="#000080">);                      </font><font color="#008000"><i>(* solange, bis v ungerade ist *)

  </i></font>Write<font color="#000080">(</font><font color="#800000">'p = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>p<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'u = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>u<font color="#000080">);
  </font>Write<font color="#000080">(</font><font color="#800000">'v = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>v<font color="#000080">);

  </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>anzahl <font color="#FF0000"><b>DO                      </b></font><font color="#008000"><i>(* Anzahl Tests durchfÅhren *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>RandomCalcStr<font color="#000080">(</font>p<font color="#000080">, </font>b<font color="#000080">);                    </font><font color="#008000"><i>(* zufÑllige Basis ermitteln *)

      </i></font>Write<font color="#000080">(</font><font color="#800000">'b = '</font><font color="#000080">); </font>PrintCalcStr<font color="#000080">(</font>b<font color="#000080">);

      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Bedingung1<font color="#000080">(</font>b<font color="#000080">, </font>v<font color="#000080">, </font>p<font color="#000080">, </font>pMinus1<font color="#000080">, </font>EINS<font color="#000080">) = </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>THEN
                                                    </b></font><font color="#008000"><i>(* 1. Bedingung prÅfen *)
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Bedingung2<font color="#000080">(</font>b<font color="#000080">, </font>v<font color="#000080">, </font>u<font color="#000080">, </font>p<font color="#000080">, </font>pMinus1<font color="#000080">, </font>EINS<font color="#000080">) = </font>FALSE<font color="#000080">) </font><font color="#FF0000"><b>THEN
          BEGIN                                     </b></font><font color="#008000"><i>(* 2. Bedingung prÅfen *)
            </i></font>Rabin <font color="#000080">:= </font>FALSE<font color="#000080">;
            </font>EXIT<font color="#000080">;     </font><font color="#008000"><i>(* beide Bedingungen nicht erfÅllt =&gt; keine Primzahl *)
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Rabin <font color="#000080">:= </font>TRUE<font color="#000080">;                                    </font><font color="#008000"><i>(* Rabintest bestanden *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* PrimeTest prÅft, ob Zahl eine Primzahl ist                              *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>PrimeTest<font color="#000080">(</font>zahl <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>anzahlTests <font color="#000080">: </font>INTEGER<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>meldung <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">)
: </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>EvenString<font color="#000080">(</font>zahl<font color="#000080">) </font><font color="#FF0000"><b>THEN                 </b></font><font color="#008000"><i>(* Zahl ist durch 2 dividierbar *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>PrimeTest <font color="#000080">:= </font>FALSE<font color="#000080">;                             </font><font color="#008000"><i>(* =&gt; keine Primzahl *)
      </i></font>meldung <font color="#000080">:= </font><font color="#800000">'gerade Zahl'</font><font color="#000080">;                     </font><font color="#008000"><i>(* Meldung zurÅckgeben *)
    </i></font><font color="#FF0000"><b>END
  ELSE
    IF </b></font>Div5<font color="#000080">(</font>zahl<font color="#000080">) </font><font color="#FF0000"><b>THEN               </b></font><font color="#008000"><i>(* Falls Zahl durch 5 dividierbar ist *)
      </i></font><font color="#FF0000"><b>BEGIN
        </b></font>PrimeTest <font color="#000080">:= </font>FALSE<font color="#000080">;                              </font><font color="#008000"><i>(* =&gt; keine Primzahl
*)
        </i></font>meldung <font color="#000080">:= </font><font color="#800000">'Zahl durch 5 dividierbar'</font><font color="#000080">;      </font><font color="#008000"><i>(* Meldung zurÅckgeben *)
      </i></font><font color="#FF0000"><b>END
    ELSE
      IF </b></font>Div3<font color="#000080">(</font>zahl<font color="#000080">) </font><font color="#FF0000"><b>THEN                       </b></font><font color="#008000"><i>(* Zahl durch 3 dividierbar *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>PrimeTest <font color="#000080">:= </font>FALSE<font color="#000080">;                         </font><font color="#008000"><i>(* =&gt; keine Primzahl *)
          </i></font>meldung <font color="#000080">:= </font><font color="#800000">'Zahl durch 3 dividierbar'</font><font color="#000080">;    </font><font color="#008000"><i>(* Meldung zurÅckgeben *)
        </i></font><font color="#FF0000"><b>END
      ELSE
        BEGIN
          IF NOT </b></font>Rabin<font color="#000080">(</font>zahl<font color="#000080">, </font>anzahlTests<font color="#000080">) </font><font color="#FF0000"><b>THEN  </b></font><font color="#008000"><i>(* Falls Rabintest negativ *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>PrimeTest <font color="#000080">:= </font>FALSE<font color="#000080">;                        </font><font color="#008000"><i>(* keine Primzahl *)
              </i></font>meldung <font color="#000080">:= </font><font color="#800000">'Rabintest'</font><font color="#000080">;               </font><font color="#008000"><i>(* Meldung zurÅckgeben *)
            </i></font><font color="#FF0000"><b>END
          ELSE
            </b></font>PrimeTest <font color="#000080">:= </font>TRUE<font color="#000080">;                  </font><font color="#008000"><i>(* sonst ist Zahl Primzahl *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Hauptprogramm erledigt die Ein/Ausgabe                                  *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Hauptprogramm<font color="#000080">;                </font><font color="#008000"><i>(* Hauptprogramm des Primzahltests *)
</i></font><font color="#FF0000"><b>VAR </b></font>anzahl             <font color="#000080">: </font>INTEGER<font color="#000080">;              </font><font color="#008000"><i>(* Anzahl notwendiger Tests *)
    </i></font>wahrscheinlichkeit <font color="#000080">: </font>Real<font color="#000080">;                 </font><font color="#008000"><i>(* Fehlerwahrscheinlichkeit *)
    </i></font>primzahl           <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                  </font><font color="#008000"><i>(* zu untersuchende Zahl *)
    </i></font>meldung            <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;          </font><font color="#008000"><i>(* Meldung, warum keine Primzahl *)
    </i></font>prim               <font color="#000080">: </font>BOOLEAN<font color="#000080">;           </font><font color="#008000"><i>(* ist sie Primzahl oder nicht *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ClrScr<font color="#000080">;                                            </font><font color="#008000"><i>(* Bildschirm lîschen *)
  </i></font>Frame<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">53</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">, </font>TRUE<font color="#000080">);                     </font><font color="#008000"><i>(* Rahmen ausgeben *)
  </i></font>WriteXY<font color="#000080">(</font><font color="#800000">29</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">'Primzahltest nach Rabin'</font><font color="#000080">);
  </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'1. Test: gerade Zahl'</font><font color="#000080">);                       </font><font color="#008000"><i>(* Tests anzeigen *)
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'2. Test: Zahl durch 5 dividierbar'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'3. Test: Ziffernsumme durch 3 dividerbar'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'4. Test: RabinTest'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Primzahl (p): '</font><font color="#000080">); </font>ReadLn<font color="#000080">(</font>primzahl<font color="#000080">);          </font><font color="#008000"><i>(* Primzahl eingeben *)
  </i></font>Write<font color="#000080">(</font><font color="#800000">'Fehlerwahrscheinlichkeit: '</font><font color="#000080">); </font>ReadLn<font color="#000080">(</font>wahrscheinlichkeit<font color="#000080">);
                                      </font><font color="#008000"><i>(* Fehlerwahrscheinlichkeit eingeben *)
  </i></font>anzahl <font color="#000080">:= </font>AnzahlTests<font color="#000080">(</font>wahrscheinlichkeit<font color="#000080">);       </font><font color="#008000"><i>(* Testanzahl ermitteln *)
  </i></font>WriteLn<font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Anzahl Tests: '</font><font color="#000080">, </font>anzahl<font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>prim <font color="#000080">:= </font>PrimeTest<font color="#000080">(</font>primzahl<font color="#000080">, </font>anzahl<font color="#000080">, </font>meldung<font color="#000080">);     </font><font color="#008000"><i>(* auf Primzahl testen *)
  </i></font>Write<font color="#000080">(</font>primzahl<font color="#000080">, </font><font color="#800000">' ist '</font><font color="#000080">);
  </font><font color="#FF0000"><b>IF NOT </b></font>prim <font color="#FF0000"><b>THEN
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'keine Primzahl ('</font><font color="#000080">,</font>meldung<font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">)            </font><font color="#008000"><i>(* Meldung ausgeben *)
  </i></font><font color="#FF0000"><b>ELSE
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Primzahl'</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Hauptprogramm<font color="#000080">;                                 </font><font color="#008000"><i>(* Hauptprogramm aufrufen *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)

(* ----------------------------------------------------------------------- *)
(* MyCalc stellt eine LongInteger-Arithmetik zur Verfuegung                *)
(* ----------------------------------------------------------------------- *)

{$M 65000, 0, 655360}                          (* Stack auf maximale Groesse *)

</i></font><font color="#FF0000"><b>UNIT </b></font>MyCalc<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

CONST </b></font>MAXCALCSTR <font color="#000080">= </font><font color="#800000">500</font><font color="#000080">;                         </font><font color="#008000"><i>(* maximal 500 Word-Zahlen *)

</i></font><font color="#FF0000"><b>TYPE </b></font>CalcStr <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                 </b></font>stellen    <font color="#000080">: </font>WORD<font color="#000080">;         </font><font color="#008000"><i>(* Anzahl der belegten Stellen *)
                 </i></font>zahl       <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXCALCSTR<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD<font color="#000080">;  </font><font color="#008000"><i>(* gro&aacute;e Zahl *)
               </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InitCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ReverseCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SwapCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PrintCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>StrToCalcStr<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WordToCalcStr<font color="#000080">(</font>zahl <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>AddCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SubCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Mul2CalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Div2CalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>MulCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ExptCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>basis<font color="#000080">, </font>exponent<font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>RandomCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl<font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>MulModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">, </font>modul <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">:
</font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ExptModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>basis<font color="#000080">, </font>exponent<font color="#000080">, </font>modul <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">:
</font>CalcStr<font color="#000080">);

</font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrLength<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrToStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrToWord<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>WORD<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>EqualCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GreaterCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>GreaterEqual<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>LessCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>LessEqual<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>EvenCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>OddCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>DivCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">) :
</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>ModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">) :
</font>BOOLEAN<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

USES </b></font>Crt<font color="#000080">;                                         </font><font color="#008000"><i>(* Ein/Ausgabefunktionen *)

</i></font><font color="#FF0000"><b>VAR </b></font>EMPTYCALCSTR <font color="#000080">: </font>CalcStr<font color="#000080">;                           </font><font color="#008000"><i>(* leerer CalcString *)
    </i></font>i            <font color="#000080">: </font>WORD<font color="#000080">;
                      </font><font color="#008000"><i>(* ZÑhlvariable zur Initialisierung von EMPTYCALCSTR *)

(* ======================================================================= *)
(* Bitmanipulationen                                                       *)

(* ----------------------------------------------------------------------- *)
(* SetBit setzt das BitNr.te Bit in Zahl                                   *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>SetBit<font color="#000080">(</font>zahl <font color="#000080">: </font>WORD<font color="#000080">; </font>bitNr <font color="#000080">: </font>BYTE<font color="#000080">): </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>SetBit <font color="#000080">:= </font>zahl <font color="#FF0000"><b>OR </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font>bitNr<font color="#000080">)
               </font><font color="#008000"><i>(* BitNr Stellen nach links shiften und mit oder verknÅpfen *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* TestBit prÅft, ob das BitNr.te Bit in Zahl gesetzt ist                  *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>TestBit<font color="#000080">(</font>zahl <font color="#000080">: </font>WORD<font color="#000080">; </font>bitNr<font color="#000080">: </font>BYTE<font color="#000080">): </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>TestBit <font color="#000080">:= (((</font>zahl <font color="#FF0000"><b>SHR </b></font>bitNr<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1</font><font color="#000080">)
             </font><font color="#008000"><i>(* Bit ist dann gesetzt, falls an der BitNr. Stelle bei einer *)
                              (* Und-VerknÅpfung wieder 1 das Ergebnis ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ======================================================================= *)
(* Hilfsfunktionen fÅr Strings                                             *)

(* ----------------------------------------------------------------------- *)
(* TestString prÅft, ob im String eine gÅltige Zahl enthalten ist          *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>TestString<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>laenge <font color="#000080">: </font>BYTE<font color="#000080">;                               </font><font color="#008000"><i>(* LÑnge der Zeichenkette *)
    </i></font>i      <font color="#000080">: </font>BYTE<font color="#000080">;                                         </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zeichenkette<font color="#000080">);      </font><font color="#008000"><i>(* LÑnge der Zeichenkette ermitteln *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>laenge <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font><font color="#000080">(</font>zeichenkette<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">])) </font><font color="#FF0000"><b>THEN            </b></font><font color="#008000"><i>(* keine Zahl *)
      </i></font><font color="#FF0000"><b>BEGIN
        </b></font>TestString <font color="#000080">:= </font>FALSE<font color="#000080">;                        </font><font color="#008000"><i>(* String ist ungÅltig *)
        </i></font>EXIT<font color="#000080">;                                        </font><font color="#008000"><i>(* Funktion verlassen *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>TestString <font color="#000080">:= </font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* OddString prÅft, ob ein String ungerade ist                             *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>OddString<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>zahl   <font color="#000080">: </font>BYTE<font color="#000080">;                          </font><font color="#008000"><i>(* Bytedarstellung von Zeichen *)
    </i></font>dummy  <font color="#000080">: </font>INTEGER<font color="#000080">;  </font><font color="#008000"><i>(* dient zur öberprÅfung von zeichen bei Umwandlung *)
    </i></font>last   <font color="#000080">: </font>CHAR<font color="#000080">;                      </font><font color="#008000"><i>(* letztes Zeichen in zeichenkette *)
    </i></font>laenge <font color="#000080">: </font>BYTE<font color="#000080">;                               </font><font color="#008000"><i>(* LÑnge der Zeichenkette *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zeichenkette<font color="#000080">);        </font><font color="#008000"><i>(* LÑnge mu&aacute; neu ermittelt werden *)
  </i></font>last <font color="#000080">:= </font>zeichenkette<font color="#000080">[</font>laenge<font color="#000080">];                         </font><font color="#008000"><i>(* letztes Zeichen *)
  </i></font>Val<font color="#000080">(</font>last<font color="#000080">, </font>zahl<font color="#000080">, </font>dummy<font color="#000080">);             </font><font color="#008000"><i>(* letztes Zeichen in zahl umwandeln *)
  </i></font>oddString <font color="#000080">:= </font>Odd<font color="#000080">(</font>zahl<font color="#000080">);                  </font><font color="#008000"><i>(* prÅfen, ob zahl ungerade ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* StrDiv2 dividiert einen String durch 2                                  *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>StrDiv2<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>hilfe      <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                   </font><font color="#008000"><i>(* Hilfsstring fÅr das Ergebnis *)
    </i></font>index      <font color="#000080">: </font>BYTE<font color="#000080">;               </font><font color="#008000"><i>(* Index fÅr Position in zeichenkette *)
    </i></font>laenge     <font color="#000080">: </font>BYTE<font color="#000080">;                           </font><font color="#008000"><i>(* LÑnge der Zeichenkette *)
    </i></font>zahl       <font color="#000080">: </font>BYTE<font color="#000080">;                          </font><font color="#008000"><i>(* zu dividierender Faktor *)
    </i></font>zeichen    <font color="#000080">: </font>CHAR<font color="#000080">;                      </font><font color="#008000"><i>(* Zeichendarstellung von Zahl *)
    </i></font>dummy      <font color="#000080">: </font>INTEGER<font color="#000080">;
                       </font><font color="#008000"><i>(* dient zur öberprÅfung von zeichen bei Umwandlung *)
    </i></font>uebertrag  <font color="#000080">: </font>BOOLEAN<font color="#000080">;                  </font><font color="#008000"><i>(* ist ein öbertrag aufgetreten *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>hilfe <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                                     </font><font color="#008000"><i>(* hilfe initialisieren *)
  </i></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zeichenkette<font color="#000080">);                </font><font color="#008000"><i>(* LÑnge der zeichenkette *)
  </i></font><font color="#FF0000"><b>IF </b></font>oddString<font color="#000080">(</font>zeichenkette<font color="#000080">) </font><font color="#FF0000"><b>THEN           </b></font><font color="#008000"><i>(* falls die Zahl ungerade ist *)
    </i></font>DEC<font color="#000080">(</font>zeichenkette<font color="#000080">[</font>laenge<font color="#000080">]);                 </font><font color="#008000"><i>(* Zahl um 1 dekrementieren *)
  </i></font>uebertrag <font color="#000080">:= </font>FALSE<font color="#000080">;                                     </font><font color="#008000"><i>(* kein öbertrag *)
  </i></font><font color="#FF0000"><b>IF </b></font>zeichenkette<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'1' </font><font color="#FF0000"><b>THEN               </b></font><font color="#008000"><i>(* falls an 1.Stelle ein 1er *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>index <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;                              </font><font color="#008000"><i>(* an 2.Stelle weitermachen *)
      </i></font>zahl <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;                     </font><font color="#008000"><i>(* öbertrag an 1.Stelle =&gt; zahl = 10 *)
    </i></font><font color="#FF0000"><b>END
  ELSE
    BEGIN
      </b></font>index <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                  </font><font color="#008000"><i>(* beginne bei 1.Stelle *)
      </i></font>zahl <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                            </font><font color="#008000"><i>(* =&gt; zahl = 0 *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>zahl <font color="#000080">:= </font>zahl <font color="#000080">+ </font>Ord<font color="#000080">(</font>zeichenkette<font color="#000080">[</font>index<font color="#000080">]) - </font><font color="#800000">48</font><font color="#000080">;        </font><font color="#008000"><i>(* Zahl ermitteln *)
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>uebertrag <font color="#000080">:= </font>TRUE<font color="#000080">;
                                              </font><font color="#008000"><i>(* ungerade zahl =&gt; öbertrag *)
    </i></font>zahl <font color="#000080">:= </font>zahl <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                         </font><font color="#008000"><i>(* zahl durch 2 dividieren *)
    </i></font>zeichen <font color="#000080">:= </font>Chr<font color="#000080">(</font>zahl <font color="#000080">+ </font><font color="#800000">48</font><font color="#000080">);   </font><font color="#008000"><i>(* Zahl wieder in ASCII-Zeichen umwandeln *)
    </i></font>hilfe <font color="#000080">:= </font>hilfe <font color="#000080">+ </font>zeichen<font color="#000080">;                     </font><font color="#008000"><i>(* und an hilfe anhÑngen *)
    </i></font>INC<font color="#000080">(</font>index<font color="#000080">);                                      </font><font color="#008000"><i>(* Index um 1 erhîhen *)
    </i></font><font color="#FF0000"><b>IF </b></font>uebertrag <font color="#FF0000"><b>THEN                                          </b></font><font color="#008000"><i>(* öbertrag *)
      </i></font>zahl <font color="#000080">:= </font><font color="#800000">10                               </font><font color="#008000"><i>(* öbertrag in zahl sichern *)
    </i></font><font color="#FF0000"><b>ELSE
      </b></font>zahl <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                         </font><font color="#008000"><i>(* sonst zahl = 0 *)
    </i></font>uebertrag <font color="#000080">:= </font>FALSE<font color="#000080">;                          </font><font color="#008000"><i>(* Annahme: kein öbertrag *)
  </i></font><font color="#FF0000"><b>UNTIL </b></font>index <font color="#000080">&gt; </font>laenge<font color="#000080">;               </font><font color="#008000"><i>(* keine Zeichen mehr zum dividieren *)
  </i></font>StrDiv2 <font color="#000080">:= </font>hilfe<font color="#000080">;                             </font><font color="#008000"><i>(* Ergebnis steht in Hilfe *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* StrMul2 multipliziert einen String mit 2                                *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>StrMul2<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>laenge     <font color="#000080">: </font>BYTE<font color="#000080">;                          </font><font color="#008000"><i>(* Laenge der zeichenkette *)
    </i></font>i          <font color="#000080">: </font>BYTE<font color="#000080">;                                     </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>hilfe      <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                       </font><font color="#008000"><i>(* Hilfsstring fÅr Ergebnis *)
    </i></font>dummyStr   <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;           </font><font color="#008000"><i>(* dient zur Umwandlung Zahl -&gt; Zeichen *)
    </i></font>uebertrag  <font color="#000080">: </font>BOOLEAN<font color="#000080">;                              </font><font color="#008000"><i>(* öbertrag ja/nein *)
    </i></font>zeichen    <font color="#000080">: </font>CHAR<font color="#000080">;                                </font><font color="#008000"><i>(* aktuelles Zeichen *)
    </i></font>zahl       <font color="#000080">: </font>BYTE<font color="#000080">;                     </font><font color="#008000"><i>(* Byte-Darstellung von zeichen *)
    </i></font>dummy      <font color="#000080">: </font>INTEGER<font color="#000080">;  </font><font color="#008000"><i>(* dient zur PrÅfung von zeichen bei Umwandlung *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zeichenkette<font color="#000080">);                       </font><font color="#008000"><i>(* LÑnge ermitteln *)
  </i></font>uebertrag <font color="#000080">:= </font>FALSE<font color="#000080">;                            </font><font color="#008000"><i>(* Annahme: kein öbertrag *)
  </i></font>hilfe <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;                               </font><font color="#008000"><i>(* Hilfsstring initialisieren *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font>laenge <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO        </b></font><font color="#008000"><i>(* zeichenkette rÅckwÑrts durchlaufen *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>zeichen <font color="#000080">:= </font>zeichenkette<font color="#000080">[</font>i<font color="#000080">];           </font><font color="#008000"><i>(* aktuelles Zeichen ermitteln *)
      </i></font>zahl <font color="#000080">:= </font>Ord<font color="#000080">(</font>zeichen<font color="#000080">) - </font><font color="#800000">48</font><font color="#000080">;                 </font><font color="#008000"><i>(* in eine Zahl umwandeln *)
      </i></font>zahl <font color="#000080">:= </font>zahl <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;                     </font><font color="#008000"><i>(* Zahl mit 2 multiplizieren *)
      </i></font><font color="#FF0000"><b>IF </b></font>uebertrag <font color="#FF0000"><b>THEN </b></font>INC<font color="#000080">(</font>zahl<font color="#000080">);              </font><font color="#008000"><i>(* bei öbertrag 1 addieren *)
      </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl <font color="#000080">&gt;= </font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>THEN                             </b></font><font color="#008000"><i>(* falls Zahl &gt;= 10 *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>uebertrag <font color="#000080">:= </font>TRUE<font color="#000080">;                       </font><font color="#008000"><i>(* öbertrag aufgetreten *)
          </i></font>zahl <font color="#000080">:= </font>zahl <font color="#000080">- </font><font color="#800000">10</font><font color="#000080">;                      </font><font color="#008000"><i>(* öbertrag wegschneiden *)
        </i></font><font color="#FF0000"><b>END
      ELSE
        </b></font>uebertrag <font color="#000080">:= </font>FALSE<font color="#000080">;                         </font><font color="#008000"><i>(* sonst kein öbertrag *)
      </i></font>zeichen <font color="#000080">:= </font>Chr<font color="#000080">(</font>zahl <font color="#000080">+ </font><font color="#800000">48</font><font color="#000080">);              </font><font color="#008000"><i>(* zahl in Zeichen umwandeln *)
      </i></font>hilfe <font color="#000080">:= </font>zeichen <font color="#000080">+ </font>hilfe<font color="#000080">;                   </font><font color="#008000"><i>(* und an Hilfe anhÑngen *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>uebertrag <font color="#FF0000"><b>THEN </b></font>hilfe <font color="#000080">:= </font><font color="#800000">'1' </font><font color="#000080">+ </font>hilfe<font color="#000080">;
                               </font><font color="#008000"><i>(* restlichen öbertrag noch berÅcksichtigen *)
  </i></font>StrMul2 <font color="#000080">:= </font>hilfe<font color="#000080">;                                   </font><font color="#008000"><i>(* Ergebnis zuweisen *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ======================================================================= *)
(* Operationen auf den Datentyp CalcString                                 *)

(* ----------------------------------------------------------------------- *)
(* InitCalcStr initialisiert einen CalcString:                             *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>calcZahl <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* leeren CalcStr zuweisen *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* CalcStrLength liefert die LÑnge des CalcStrings zurÅck                  *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrLength<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CalcStrLength <font color="#000080">:= </font>calcZahl<font color="#000080">.</font>stellen<font color="#000080">;   </font><font color="#008000"><i>(* LÑnge ist in stellen gespeichert *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* ReverseCalcStr dreht einen CalcString um                                *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ReverseCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>laenge <font color="#000080">: </font>WORD<font color="#000080">;                         </font><font color="#008000"><i>(* Anzahl Stellen im CalcString *)
    </i></font>i      <font color="#000080">: </font>WORD<font color="#000080">;                                         </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>anzahl <font color="#000080">: </font>WORD<font color="#000080">;                                </font><font color="#008000"><i>(* benîtigte Schrittzahl *)
    </i></font>hilfe  <font color="#000080">: </font>WORD<font color="#000080">;                                     </font><font color="#008000"><i>(* Zwischenspeicher *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>laenge <font color="#000080">:= </font>CalcStrLength<font color="#000080">(</font>ergebnis<font color="#000080">);    </font><font color="#008000"><i>(* LÑnge des CalcStrings ermitteln *)
  </i></font>anzahl <font color="#000080">:= </font>laenge <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;            </font><font color="#008000"><i>(* man benîtigt nur laenge/2 Schritte *)
  </i></font><font color="#FF0000"><b>WITH </b></font>ergebnis <font color="#FF0000"><b>DO                                    </b></font><font color="#008000"><i>(* Record abarbeiten *)
    </i></font><font color="#FF0000"><b>BEGIN
      FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>anzahl <font color="#FF0000"><b>DO
        BEGIN
          </b></font>hilfe <font color="#000080">:= </font>zahl<font color="#000080">[</font>i<font color="#000080">];                              </font><font color="#008000"><i>(* i. Zahl merken *)
          </i></font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>zahl<font color="#000080">[</font>laenge <font color="#000080">- (</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)];
                        </font><font color="#008000"><i>(* i. Zahl wird zur entsprechenden Zahl von hinten *)
          </i></font>zahl<font color="#000080">[</font>laenge <font color="#000080">- (</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)] := </font>hilfe<font color="#000080">;  </font><font color="#008000"><i>(* hintere Zahl wird i.te Zahl *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* SwapCalcStr vertauscht zwei CalcStrings                                 *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SwapCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>hilfe <font color="#000080">: </font>CalcStr<font color="#000080">;                       </font><font color="#008000"><i>(* HilfsString fÅr Vertauschung *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>hilfe <font color="#000080">:= </font>zahl1<font color="#000080">;                                </font><font color="#008000"><i>(* Hilfe auf Zahl1 setzen *)
  </i></font>zahl1 <font color="#000080">:= </font>zahl2<font color="#000080">;                                </font><font color="#008000"><i>(* Zahl1 auf Zahl2 setzen *)
  </i></font>zahl2 <font color="#000080">:= </font>hilfe<font color="#000080">;                                </font><font color="#008000"><i>(* Zahl2 auf Hilfe setzen *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* PrintCalcStr gibt einen CalcString als Vektor auf dem Bildschirm aus    *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>PrintCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;                                              </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ReverseCalcStr<font color="#000080">(</font>calcZahl<font color="#000080">);               </font><font color="#008000"><i>(* calcZahl mu&aacute; umgedreht werden *)
  </i></font><font color="#FF0000"><b>WITH </b></font>calcZahl <font color="#FF0000"><b>DO                              </b></font><font color="#008000"><i>(* Recordtyp als Grundlage *)
    </i></font><font color="#FF0000"><b>BEGIN
      IF </b></font>stellen <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN                        </b></font><font color="#008000"><i>(* Zahl darf nicht 0 sein *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>Write<font color="#000080">(</font><font color="#800000">'('</font><font color="#000080">);                              </font><font color="#008000"><i>(* positives Vorzeichen *)
          </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO        </b></font><font color="#008000"><i>(* alle Stellen abarbeiten *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>Write<font color="#000080">(</font>zahl<font color="#000080">[</font>i<font color="#000080">]);                             </font><font color="#008000"><i>(* Zahl ausgeben *)
              </i></font>Write<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">);                       </font><font color="#008000"><i>(* durch Beistrich trennen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Write<font color="#000080">(</font>zahl<font color="#000080">[</font>stellen<font color="#000080">]);                    </font><font color="#008000"><i>(* letzte Zahl ausgeben *)
          </i></font>WriteLn<font color="#000080">(</font><font color="#800000">')'</font><font color="#000080">);                   </font><font color="#008000"><i>(* Klammer des Vektors schlie&aacute;en *)
        </i></font><font color="#FF0000"><b>END
      ELSE
        </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'(0)'</font><font color="#000080">);                                </font><font color="#008000"><i>(* sonst 0 ausgeben *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>ReverseCalcStr<font color="#000080">(</font>calcZahl<font color="#000080">);        </font><font color="#008000"><i>(* calcZahl mu&aacute; wieder umgedreht werden *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* StrToCalcStr wandelt einen String in einen CalcString um                *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>StrToCalcStr<font color="#000080">(</font>zeichenkette <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>index  <font color="#000080">: </font>WORD<font color="#000080">;                          </font><font color="#008000"><i>(* Index im ErgebnisCalcString *)
    </i></font>bitnr  <font color="#000080">: </font>BYTE<font color="#000080">;                        </font><font color="#008000"><i>(* Nummer des zu setzenden Bit's *)
    </i></font>laenge <font color="#000080">: </font>BYTE<font color="#000080">;                               </font><font color="#008000"><i>(* LÑnge der Zeichenkette *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;               </font><font color="#008000"><i>(* ErgebnisString initialisieren *)
  </i></font>index <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                              </font><font color="#008000"><i>(* erstes Element im CalcString *)
  </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;       </font><font color="#008000"><i>(* LÑnge des CalcStrings wird auf 1 gesetzt *)
  </i></font>bitnr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                </font><font color="#008000"><i>(* zu Beginn wird Bit 0 gesetzt/nicht gesetzt *)
  </i></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>zeichenkette<font color="#000080">);      </font><font color="#008000"><i>(* LÑnge der Zeichenkette ermitteln *)
  </i></font><font color="#FF0000"><b>IF </b></font>TestString<font color="#000080">(</font>zeichenkette<font color="#000080">) </font><font color="#FF0000"><b>THEN   </b></font><font color="#008000"><i>(* ist zeichenkette eine gÅltige Zahl *)
    </i></font><font color="#FF0000"><b>WITH </b></font>ergebnis <font color="#FF0000"><b>DO                               </b></font><font color="#008000"><i>(* Record als Grundlage *)
      </i></font><font color="#FF0000"><b>BEGIN
        REPEAT
          IF </b></font>oddString<font color="#000080">(</font>zeichenkette<font color="#000080">) </font><font color="#FF0000"><b>THEN   </b></font><font color="#008000"><i>(* ist zeichenkette ungerade ? *)
            </i></font>zahl<font color="#000080">[</font>index<font color="#000080">] := </font>SetBit<font color="#000080">(</font>zahl<font color="#000080">[</font>index<font color="#000080">], </font>bitnr<font color="#000080">);       </font><font color="#008000"><i>(* Bit setzen *)
          </i></font>zeichenkette <font color="#000080">:= </font>StrDiv2<font color="#000080">(</font>zeichenkette<font color="#000080">);       </font><font color="#008000"><i>(* Zeichenkette / 2 *)
          </i></font><font color="#FF0000"><b>IF </b></font>zeichenkette <font color="#000080">&lt;&gt; </font><font color="#800000">'0' </font><font color="#FF0000"><b>THEN           </b></font><font color="#008000"><i>(* falls noch nicht fertig *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>INC<font color="#000080">(</font>bitnr<font color="#000080">);                            </font><font color="#008000"><i>(* BitNr um 1 erhîhen *)
              </i></font><font color="#FF0000"><b>IF </b></font>bitnr <font color="#000080">&gt;= </font><font color="#800000">16 </font><font color="#FF0000"><b>THEN                 </b></font><font color="#008000"><i>(* falls 1 Word voll ist *)
                </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>bitnr <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                       </font><font color="#008000"><i>(* BitNr wird wieder 0 *)
                  </i></font>INC<font color="#000080">(</font>index<font color="#000080">);          </font><font color="#008000"><i>(* ein Element im CalcString weiter *)
                  </i></font>INC<font color="#000080">(</font>stellen<font color="#000080">);  </font><font color="#008000"><i>(* LÑnge des CalcStrings wird um 1 erhîht *)
                </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>UNTIL </b></font>zeichenkette <font color="#000080">= </font><font color="#800000">'0'</font><font color="#000080">;      </font><font color="#008000"><i>(* bis zeichenkette auf 0 reduziert *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* CalcStrToStr wandelt eine CalcString um, falls er sich als String       *)
(* darstellen lÑ&aacute;t                                                         *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrToStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i      <font color="#000080">: </font>WORD<font color="#000080">;                                         </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>BitNr  <font color="#000080">: </font>BYTE<font color="#000080">;                            </font><font color="#008000"><i>(* Nummer des aktuellen Bits *)
    </i></font>anzahl <font color="#000080">: </font>WORD<font color="#000080">;                         </font><font color="#008000"><i>(* Anzahl Stellen im CalcString *)
    </i></font>laenge <font color="#000080">: </font>BYTE<font color="#000080">;                            </font><font color="#008000"><i>(* LÑnge des Ergebnisstrings *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>calcZahl<font color="#000080">.</font>Stellen <font color="#000080">&gt; </font><font color="#800000">50 </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>(* StringlÑnge wÅrde Åberschritten *)
    </i></font>CalcStrToStr <font color="#000080">:= </font>FALSE                                <font color="#008000"><i>(* StringÅberlauf *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN                                     </b></font><font color="#008000"><i>(* Zahl pa&aacute;t in einen String *)
      </i></font>ergebnis <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;                   </font><font color="#008000"><i>(* Ergebnisstring ist zu Beginn 0 *)
      </i></font>anzahl <font color="#000080">:= </font>CalcStrLength<font color="#000080">(</font>calcZahl<font color="#000080">);          </font><font color="#008000"><i>(* LÑnge des CalcStrings *)
      </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font>anzahl <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO
                               </b></font><font color="#008000"><i>(* alle Element des CalcStrings durchlaufen *)
        </i></font><font color="#FF0000"><b>FOR </b></font>BitNr <font color="#000080">:= </font><font color="#800000">15 </font><font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO                    </b></font><font color="#008000"><i>(* alle Bits prÅfen *)
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>ergebnis <font color="#000080">:= </font>StrMul2<font color="#000080">(</font>ergebnis<font color="#000080">);   </font><font color="#008000"><i>(* ErgebnisString mit 2 mult. *)
            </i></font><font color="#FF0000"><b>IF </b></font>TestBit<font color="#000080">(</font>calcZahl<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">], </font>BitNr<font color="#000080">) </font><font color="#FF0000"><b>THEN
                                                  </b></font><font color="#008000"><i>(* Ist das Bit gesetzt ? *)
              </i></font><font color="#FF0000"><b>BEGIN
                </b></font>laenge <font color="#000080">:= </font>Length<font color="#000080">(</font>ergebnis<font color="#000080">);             </font><font color="#008000"><i>(* LÑnge ermitteln *)
                </i></font>INC<font color="#000080">(</font>ergebnis<font color="#000080">[</font>laenge<font color="#000080">]);     </font><font color="#008000"><i>(* letztes Zeichen um 1 erhîhen *)
              </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>CalcStrToStr <font color="#000080">:= </font>TRUE<font color="#000080">;                         </font><font color="#008000"><i>(* Umwandlung geglÅckt *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* WordToCalcStr wandelt eine Wordzahl in einen CalcString um              *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WordToCalcStr<font color="#000080">(</font>zahl <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                           </font><font color="#008000"><i>(* 1 Stelle wird belegt *)
  </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>zahl<font color="#000080">;                    </font><font color="#008000"><i>(* Zahl in CalcZahl sichern *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* CalcStrToWord wandelt einen CalcString in eine Wordzahl um              *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CalcStrToWord<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>WORD<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>calcZahl<font color="#000080">.</font>Stellen <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            </b></font><font color="#008000"><i>(* Zahl mit mehr als 1 Stelle kînnen nicht  umgewandelt werden *)
    </i></font>CalcStrToWord <font color="#000080">:= </font>FALSE                             <font color="#008000"><i>(* keine Umwandlung *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>ergebnis <font color="#000080">:= </font>calcZahl<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];                </font><font color="#008000"><i>(* Ergebnis zurÅckgeben *)
      </i></font>CalcStrToWord <font color="#000080">:= </font>TRUE<font color="#000080">;                        </font><font color="#008000"><i>(* Umwandlung geglÅckt *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* EqualCalcStr prÅft, ob ein CalcStr1 = CalcStr2                          *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>EqualCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;                                              </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>stellen <font color="#000080">&lt;&gt; </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>EqualCalcStr <font color="#000080">:= </font>FALSE               <font color="#008000"><i>(* unterschiedliche Anzahl Stellen *)
  </i></font><font color="#FF0000"><b>ELSE                                               </b></font><font color="#008000"><i>(* Stellenzahl gleich *)
    </i></font><font color="#FF0000"><b>BEGIN
      FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>zahl1<font color="#000080">.</font>stellen <font color="#FF0000"><b>DO            </b></font><font color="#008000"><i>(* alle Stellen abarbeiten *)
        </i></font><font color="#FF0000"><b>IF </b></font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>THEN       </b></font><font color="#008000"><i>(* Zahlen verschieden *)
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>EqualCalcStr <font color="#000080">:= </font>FALSE<font color="#000080">;              </font><font color="#008000"><i>(* Zahlen sind verschieden *)
            </i></font>EXIT<font color="#000080">;                                    </font><font color="#008000"><i>(* Schleife verlassen *)
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>EqualCalcStr <font color="#000080">:= </font>TRUE<font color="#000080">;                          </font><font color="#008000"><i>(* Zahlen sind gleich *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* GreaterCalcStr prÅft, ob ein CalcStr1 &gt; CalcStr2                        *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GreaterCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i     <font color="#000080">: </font>WORD<font color="#000080">;                                          </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>hilfe <font color="#000080">: </font>BOOLEAN<font color="#000080">;                                      </font><font color="#008000"><i>(* Hilfsvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>stellen <font color="#000080">&gt; </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">) </font><font color="#FF0000"><b>THEN    </b></font><font color="#008000"><i>(* Zahl1 besitzt mehr Stellen *)
    </i></font>GreaterCalcStr <font color="#000080">:= </font>TRUE                             <font color="#008000"><i>(* =&gt; Zahl1 &gt; Zahl2 *)
  </i></font><font color="#FF0000"><b>ELSE
    IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>stellen <font color="#000080">&lt; </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">) </font><font color="#FF0000"><b>THEN
                                          </b></font><font color="#008000"><i>(* Zahl1 besitzt weniger Stellen *)
      </i></font>GreaterCalcStr <font color="#000080">:= </font>FALSE                    <font color="#008000"><i>(* =&gt; Zahl1 nicht &gt; Zahl2 *)
    </i></font><font color="#FF0000"><b>ELSE                                             </b></font><font color="#008000"><i>(* Stellenzahl gleich *)
      </i></font><font color="#FF0000"><b>BEGIN
        FOR </b></font>i <font color="#000080">:= </font>zahl1<font color="#000080">.</font>stellen <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO      </b></font><font color="#008000"><i>(* alle Stellen abarbeiten *)
          </i></font><font color="#FF0000"><b>IF </b></font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &gt; </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>THEN
                             </b></font><font color="#008000"><i>(* i.Stelle von Zahl1 &gt; i.te Stelle von Zahl2 *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>GreaterCalcStr <font color="#000080">:= </font>TRUE<font color="#000080">;                     </font><font color="#008000"><i>(* Zahl1 &gt; Zahl2 *)
              </i></font>EXIT<font color="#000080">;                                  </font><font color="#008000"><i>(* Schleife verlassen *)
            </i></font><font color="#FF0000"><b>END
          ELSE
            IF </b></font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &lt; </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>THEN
                             </b></font><font color="#008000"><i>(* i.Stelle von Zahl1 &lt; i.te Stelle von Zahl2 *)
              </i></font><font color="#FF0000"><b>BEGIN
                </b></font>GreaterCalcStr <font color="#000080">:= </font>FALSE<font color="#000080">;            </font><font color="#008000"><i>(* Zahl1 nicht &gt; Zahl2 *)
                </i></font>EXIT<font color="#000080">;                                </font><font color="#008000"><i>(* Schleife verlassen *)
              </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>GreaterCalcStr <font color="#000080">:= </font>FALSE<font color="#000080">;               </font><font color="#008000"><i>(* alle Stellen sind gleich *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* GreaterEqual prÅft, ob Zahl1 &gt;= Zahl2                                   *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GreaterEqual<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>GreaterEqual <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>LessCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">);
                 </font><font color="#008000"><i>(* Zahl1 &gt;= Zahl2, wenn Zahl1 nicht kleiner als Zahl2 ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* LessCalcStr prÅft, on Zahl1 &lt; Zahl2                                     *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>LessCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i     <font color="#000080">: </font>WORD<font color="#000080">;                                          </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>hilfe <font color="#000080">: </font>BOOLEAN<font color="#000080">;                                      </font><font color="#008000"><i>(* Hilfsvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>stellen <font color="#000080">&lt; </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>(* Zahl1 besitzt weniger Stellen *)
    </i></font>LessCalcStr <font color="#000080">:= </font>TRUE                                <font color="#008000"><i>(* =&gt; Zahl1 &lt; Zahl2 *)
  </i></font><font color="#FF0000"><b>ELSE
    IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>stellen <font color="#000080">&gt; </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">) </font><font color="#FF0000"><b>THEN  </b></font><font color="#008000"><i>(* Zahl1 besitzt mehr Stellen *)
      </i></font>LessCalcStr <font color="#000080">:= </font>FALSE                       <font color="#008000"><i>(* =&gt; Zahl1 nicht &lt; Zahl2 *)
    </i></font><font color="#FF0000"><b>ELSE                                             </b></font><font color="#008000"><i>(* Stellenzahl gleich *)
      </i></font><font color="#FF0000"><b>BEGIN
        FOR </b></font>i <font color="#000080">:= </font>zahl1<font color="#000080">.</font>stellen <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO      </b></font><font color="#008000"><i>(* alle Stellen abarbeiten *)
          </i></font><font color="#FF0000"><b>IF </b></font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &lt; </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>THEN
                             </b></font><font color="#008000"><i>(* i.Stelle von Zahl1 &lt; i.te Stelle von Zahl2 *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>LessCalcStr <font color="#000080">:= </font>TRUE<font color="#000080">;                        </font><font color="#008000"><i>(* Zahl1 &lt; Zahl2 *)
              </i></font>EXIT<font color="#000080">;                                  </font><font color="#008000"><i>(* Schleife verlassen *)
            </i></font><font color="#FF0000"><b>END
          ELSE
            IF </b></font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &gt; </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>THEN
                             </b></font><font color="#008000"><i>(* i.Stelle von Zahl1 &gt; i.te Stelle von Zahl2 *)
              </i></font><font color="#FF0000"><b>BEGIN
                </b></font>LessCalcStr <font color="#000080">:= </font>FALSE<font color="#000080">;               </font><font color="#008000"><i>(* Zahl1 nicht &lt; Zahl2 *)
                </i></font>EXIT<font color="#000080">;                                </font><font color="#008000"><i>(* Schleife verlassen *)
              </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>LessCalcStr <font color="#000080">:= </font>FALSE<font color="#000080">;                  </font><font color="#008000"><i>(* alle Stellen sind gleich *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* LessEqual prÅft, ob Zahl1 &lt;= Zahl2                                      *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>LessEqual<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>LessEqual <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>GreaterCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">);
                  </font><font color="#008000"><i>(* Zahl1 &lt;= Zahl2, wenn Zahl1 nicht grî&aacute;er als Zahl2 ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* EvenCalcStr prÅft, ob ein CalcString gerade ist                         *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>EvenCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>EvenCalcStr <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>Odd<font color="#000080">(</font>calcZahl<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
        </font><font color="#008000"><i>(* CalcZahl ist gerade, falls die letzte Stelle nicht ungerade ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* OddCalcStr prÅft, ob ein CalcString ungerade ist                        *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>OddCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>OddCalcStr <font color="#000080">:= </font>Odd<font color="#000080">(</font>calcZahl<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
            </font><font color="#008000"><i>(* CalcZahl ist ungerade, falls die letzte Stelle ungerade ist *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* AddCalcStr addiert zwei CalcStrings                                     *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>AddCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>anzahl    <font color="#000080">: </font>WORD<font color="#000080">;                       </font><font color="#008000"><i>(* Anzahl Stellen fÅr Addition *)
    </i></font>i         <font color="#000080">: </font>WORD<font color="#000080">;                                      </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>summe     <font color="#000080">: </font>LongInt<font color="#000080">;      </font><font color="#008000"><i>(* Hilfsvariable zur PrÅfung eines öbertrags *)
    </i></font>ueberlauf <font color="#000080">: </font>BYTE<font color="#000080">;                   </font><font color="#008000"><i>(* öberlauf = 1, kein öberlauf = 0 *)
    </i></font>addition  <font color="#000080">: </font>BOOLEAN<font color="#000080">;        </font><font color="#008000"><i>(* kînnen Zahlen addiert werden oder nicht *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{$Q-}                                     (* öberlaufprÅfung ausschalten *)
  </i></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>anzahl <font color="#000080">:= </font>zahl1<font color="#000080">.</font>stellen<font color="#000080">;                   </font><font color="#008000"><i>(* Annahme: Zahl 1 ist grî&aacute;er *)
  </i></font><font color="#FF0000"><b>IF </b></font>zahl2<font color="#000080">.</font>stellen <font color="#000080">&gt; </font>anzahl <font color="#FF0000"><b>THEN          </b></font><font color="#008000"><i>(* Falls doch 2. Zahl grî&aacute;er ist *)
    </i></font>anzahl <font color="#000080">:= </font>zahl2<font color="#000080">.</font>stellen<font color="#000080">;     </font><font color="#008000"><i>(* so viele Stellen mÅssen addiert werden *)
  </i></font>ueberlauf <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                               </font><font color="#008000"><i>(* zu Beginn kein öberlauf *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>anzahl <font color="#FF0000"><b>DO                     </b></font><font color="#008000"><i>(* anzahl Stellen abarbeiten *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] + </font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] + </font>ueberlauf<font color="#000080">;
                 </font><font color="#008000"><i>(* ergebnis ist die Summe der beiden Zahlen (kann einfach *)
                 (* addiert werden, weil öberlaufprÅfung ausgeschaltet ist *)
      </i></font>summe <font color="#000080">:= </font>LongInt<font color="#000080">(</font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">]) + </font>LongInt<font color="#000080">(</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">]) + </font>ueberlauf<font color="#000080">;
                                                    </font><font color="#008000"><i>(* Summe ohne öberlauf *)
      </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>summe <font color="#000080">&gt; </font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>THEN   </b></font><font color="#008000"><i>(* ist ein öberlauf aufgetreten *)
        </i></font>ueberlauf <font color="#000080">:= </font><font color="#800000">1                      </font><font color="#008000"><i>(* ja -&gt; öberlauf auf 1 setzen *)
      </i></font><font color="#FF0000"><b>ELSE
        </b></font>ueberlauf <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                          </font><font color="#008000"><i>(* nein -&gt; öberlauf ist 0 *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ueberlauf <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN           </b></font><font color="#008000"><i>(* letzter öberlauf mu&aacute; geprÅft werden *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font>anzahl <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>(* letzter öberlauf belegt 1 Feld *)
      </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>anzahl <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;      </font><font color="#008000"><i>(* Zahl 1 steht im letzten Feld *)
    </i></font><font color="#FF0000"><b>END
  ELSE
    </b></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font>anzahl<font color="#000080">;
                              </font><font color="#008000"><i>(* gleich viele Stellen wie die lÑngere Zahl *)
  {$Q+}                              (* öberlaufprÅfung wieder einschalten *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* SubCalcStr subtrahiert zahl2 von zahl1                                  *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SubCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>swapped   <font color="#000080">: </font>BOOLEAN<font color="#000080">;            </font><font color="#008000"><i>(* wurden Zahl1 und Zahl2 vertauscht ? *)
    </i></font>i         <font color="#000080">: </font>WORD<font color="#000080">;                                      </font><font color="#008000"><i>(* ZÑhlvariable *)
    </i></font>uebertrag <font color="#000080">: </font>BYTE<font color="#000080">;                     </font><font color="#008000"><i>(* öbertrag: 1, kein öbertrag: 0 *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>swapped <font color="#000080">:= </font>FALSE<font color="#000080">;                      </font><font color="#008000"><i>(* Zahlen wurden nicht vertauscht *)
  </i></font>uebertrag <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                         </font><font color="#008000"><i>(* kein öbertrag *)
  </i></font><font color="#FF0000"><b>IF </b></font>GreaterCalcStr<font color="#000080">(</font>zahl2<font color="#000080">, </font>zahl1<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>EXIT<font color="#000080">;              </font><font color="#008000"><i>(* Zahl2 &gt; Zahl1 *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>zahl1<font color="#000080">.</font>stellen <font color="#FF0000"><b>DO                </b></font><font color="#008000"><i>(* alle Stellen abarbeiten *)
    </i></font><font color="#FF0000"><b>BEGIN
      IF </b></font><font color="#000080">(</font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] &gt;= (</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] + </font>uebertrag<font color="#000080">)) </font><font color="#FF0000"><b>THEN
                </b></font><font color="#008000"><i>(* Zahl1[i] &gt;= Zahl2[i] mit BerÅcksichtigung des öbertrags *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] - (</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] + </font>uebertrag<font color="#000080">);
                                         </font><font color="#008000"><i>(* Differenz der Zahlen ermitteln *)
          </i></font>uebertrag <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                 </font><font color="#008000"><i>(* kein öbertrag *)
        </i></font><font color="#FF0000"><b>END
      ELSE
        BEGIN
          </b></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>LongInt<font color="#000080">(</font>zahl1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] + </font><font color="#800000">65536</font><font color="#000080">) - (</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] +
</font>uebertrag<font color="#000080">);
          </font>uebertrag <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font>zahl1<font color="#000080">.</font>stellen<font color="#000080">;
                                 </font><font color="#008000"><i>(* Annahme: gleich viel Stellen wie Zahl1 *)
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>ergebnis<font color="#000080">.</font>stellen<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>DEC<font color="#000080">(</font>ergebnis<font color="#000080">.</font>stellen<font color="#000080">);               </font><font color="#008000"><i>(* richtige Stellenzahl ermitteln *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Mul2CalcStr multipliziert einen CalcString mit 2                        *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Mul2CalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;                                              </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  WITH </b></font>calcZahl <font color="#FF0000"><b>DO                                 </b></font><font color="#008000"><i>(* Record als Grundlage *)
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    ELSE                               </b></font><font color="#008000"><i>(* CalcZahl ist 0 =&gt; Ergebnis ist 0 *)
      </i></font><font color="#FF0000"><b>BEGIN                                     </b></font><font color="#008000"><i>(* Sonst ist Ergebnis &lt;&gt; 0 *)
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font>stellen<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">32768</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
          BEGIN                 </b></font><font color="#008000"><i>(* Ist 16.Bit der letzten Stelle gesetzt ? *)
            </i></font>INC<font color="#000080">(</font>stellen<font color="#000080">);                      </font><font color="#008000"><i>(* Stellenzahl um 1 erhîhen *)
            </i></font>zahl<font color="#000080">[</font>stellen<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;                </font><font color="#008000"><i>(* und mit 0 initialisieren *)
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= (</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO              </b></font><font color="#008000"><i>(* Zahl abarbeiten *)
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>zahl<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>zahl<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>(* Zahl[i + 1] * 2 *)
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">32768</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>INC<font color="#000080">(</font>zahl<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;          </font><font color="#008000"><i>(* Bei öberlauf bei Zahl[i] =&gt; Zahl[i + 1] erhîhen *)
        </i></font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;          </font><font color="#008000"><i>(* 1. Zahl mit 2 multiplizieren *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* Div2CalcStr dividiert einen CalcString durch 2                          *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Div2CalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;                                              </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  WITH </b></font>calcZahl <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">((</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    ELSE                               </b></font><font color="#008000"><i>(* calcZahl = 0 =&gt; calcZahl * 2 = 0 *)
      </i></font><font color="#FF0000"><b>BEGIN
        FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO                  </b></font><font color="#008000"><i>(* Zahl abarbeiten *)
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                     </font><font color="#008000"><i>(* Zahl[i] DIV 2 *)
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                           </b></font><font color="#008000"><i>(* Falls bei Zahl[i + 1] ein Unterlauf auftritt *)
              </i></font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>zahl<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>OR </b></font><font color="#800000">32768</font><font color="#000080">;    </font><font color="#008000"><i>(* Bit 16 bei Zahl[i] setzen *)
          </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>zahl<font color="#000080">[</font>stellen<font color="#000080">] := </font>zahl<font color="#000080">[</font>stellen<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;       </font><font color="#008000"><i>(* letzte Stelle DIV 2 *)
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>zahl<font color="#000080">[</font>stellen<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>DEC<font color="#000080">(</font>stellen<font color="#000080">);
                  </font><font color="#008000"><i>(* Falls letzte Stelle 0 ist =&gt; Stellen um 1 erniedrigen *)
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* MulCalcStr multiplizier2 zahl1 mit zahl2                                *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MulCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>hilfe       <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe1      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe2      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>i<font color="#000080">, </font>j        <font color="#000080">: </font>WORD<font color="#000080">;                                   </font><font color="#008000"><i>(* ZÑhlvariablen *)
    </i></font>wert        <font color="#000080">: </font>WORD<font color="#000080">;               </font><font color="#008000"><i>(* Wert von Zahl an der i.ten Stelle *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>LessCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">) </font><font color="#FF0000"><b>THEN                 </b></font><font color="#008000"><i>(* Falls zahl1 &lt; zahl2 *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>hilfe1 <font color="#000080">:= </font>zahl1<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe1 wird Zahl1 zugewiesen *)
      </i></font>hilfe2 <font color="#000080">:= </font>zahl2<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe2 wird Zahl2 zugewiesen *)
    </i></font><font color="#FF0000"><b>END
  ELSE
    BEGIN
      </b></font>hilfe2 <font color="#000080">:= </font>zahl1<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe2 wird Zahl1 zugewiesen *)
      </i></font>hilfe1 <font color="#000080">:= </font>zahl2<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe1 wird Zahl2 zugewiesen *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>THEN
  ELSE                                       </b></font><font color="#008000"><i>(* Ergebnis=0, weil X * 0 = 0 *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                    </font><font color="#008000"><i>(* i mit 1 initialisieren *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= (</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>DO           </b></font><font color="#008000"><i>(* Hilfe 1 abarbeiten *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>wert <font color="#000080">:= </font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">];                         </font><font color="#008000"><i>(* Wert = i.Zahl *)
          </i></font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* j mit 1 initialisieren *)
          </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&lt;= </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>DO                       </b></font><font color="#008000"><i>(* alle Bits abarbeiten *)
            </i></font><font color="#FF0000"><b>BEGIN
              IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN              </b></font><font color="#008000"><i>(* Falls 1.Bit gesetzt *)
                </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);
                                           </font><font color="#008000"><i>(* Ergebnis und Hilfe2 addieren *)
                  </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;              </font><font color="#008000"><i>(* Ergebnis aus Addition *)
                </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                            </font><font color="#008000"><i>(* Wert DIV 2 *)
              </i></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);                           </font><font color="#008000"><i>(* Hilfe2 * 2 *)
              </i></font>INC<font color="#000080">(</font>j<font color="#000080">);                                    </font><font color="#008000"><i>(* j um 1 erhîhen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>INC<font color="#000080">(</font>i<font color="#000080">);                                        </font><font color="#008000"><i>(* i um 1 erhîhen *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>wert <font color="#000080">:= </font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font>hilfe1<font color="#000080">.</font>stellen<font color="#000080">];      </font><font color="#008000"><i>(* letzte Stelle behandeln *)
      </i></font><font color="#FF0000"><b>WHILE </b></font>wert <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO                  </b></font><font color="#008000"><i>(* Solange noch 1 Bit gesetzt ist *)
        </i></font><font color="#FF0000"><b>BEGIN
          IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN              </b></font><font color="#008000"><i>(* Falls Bit 1 gesetzt ist *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);
                                           </font><font color="#008000"><i>(* Ergebnis und Hilfe2 addieren *)
              </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;                  </font><font color="#008000"><i>(* Ergebnis aus Addition *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* Wert DIV 2 *)
          </i></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);                               </font><font color="#008000"><i>(* Hilfe2 * 2 *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* DivCalcStr dividiert einen CalcString durch einen anderen               *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>DivCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">) :
</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>hilfe       <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)

    </i></font>hilfe1      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe2      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>EINS        <font color="#000080">: </font>CalcStr<font color="#000080">;                 </font><font color="#008000"><i>(* konstanter HilfsString fÅr 1 *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">((</font>zahl2<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>zahl2<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>DivCalcStr <font color="#000080">:= </font>FALSE                  <font color="#008000"><i>(* Division durch 0 nicht mîglich *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>EINS <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                         </font><font color="#008000"><i>(* Eins initialisieren *)
      </i></font>EINS<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                          </font><font color="#008000"><i>(* Eins besitzt 1 Stelle *)
      </i></font>EINS<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;                        </font><font color="#008000"><i>(* diese wird mit 1 belegt *)
      </i></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                 </font><font color="#008000"><i>(* Ergebnis initialisieren *)
      </i></font>hilfe1 <font color="#000080">:= </font>zahl1<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe1 wird Zahl1 zugewiesen *)
      </i></font>hilfe2 <font color="#000080">:= </font>zahl2<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe2 wird Zahl2 zugewiesen *)
      </i></font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>GreaterCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>hilfe1<font color="#000080">)) </font><font color="#FF0000"><b>DO
        </b></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);
           </font><font color="#008000"><i>(* schiebe hilfe2 solange nach links, bis dividiert werden kann *)
      </i></font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>EqualCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>zahl2<font color="#000080">)) </font><font color="#FF0000"><b>DO       </b></font><font color="#008000"><i>(* Abbruchbedingung *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>Mul2CalcStr<font color="#000080">(</font>ergebnis<font color="#000080">);          </font><font color="#008000"><i>(* Ergebnis mit 2 multiplizieren *)
          </i></font>Div2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);                </font><font color="#008000"><i>(* Hilfe2 durch 2 dividieren *)
          </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>GreaterCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>hilfe1<font color="#000080">)) </font><font color="#FF0000"><b>THEN
                                            </b></font><font color="#008000"><i>(* falls hilfe2 nicht &gt; hilfe1 *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>SubCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);        </font><font color="#008000"><i>(* Hilfe1 - Hilfe2 *)
              </i></font>hilfe1 <font color="#000080">:= </font>hilfe<font color="#000080">;             </font><font color="#008000"><i>(* Hilfe1 wird Hilfe zugewiesen *)
              </i></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>EINS<font color="#000080">, </font>hilfe<font color="#000080">);</font><font color="#008000"><i>(* zum Ergebnis 1 addieren *)
              </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;         </font><font color="#008000"><i>(* Ergebnis wird hilfe zugewiesen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>DivCalcStr <font color="#000080">:= </font>TRUE<font color="#000080">;                          </font><font color="#008000"><i>(* Division erfolgreich *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* ModCalcStr berechnet den Rest bei Division von Zahl1 durch Zahl2        *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2 <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">) :
</font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>hilfe       <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe1      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe2      <font color="#000080">: </font>CalcStr<font color="#000080">;                              </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>EINS        <font color="#000080">: </font>CalcStr<font color="#000080">;                 </font><font color="#008000"><i>(* konstanter HilfsString fÅr 1 *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">((</font>zahl2<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>zahl2<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>zahl2<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    </b></font>ModCalcStr <font color="#000080">:= </font>FALSE                  <font color="#008000"><i>(* Division durch 0 nicht mîglich *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>EINS <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                         </font><font color="#008000"><i>(* Eins initialisieren *)
      </i></font>EINS<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                          </font><font color="#008000"><i>(* Eins besitzt 1 Stelle *)
      </i></font>EINS<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;                        </font><font color="#008000"><i>(* diese wird mit 1 belegt *)
      </i></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                 </font><font color="#008000"><i>(* Ergebnis initialisieren *)
      </i></font><font color="#FF0000"><b>IF </b></font>GreaterCalcStr<font color="#000080">(</font>zahl2<font color="#000080">, </font>zahl1<font color="#000080">) </font><font color="#FF0000"><b>THEN          </b></font><font color="#008000"><i>(* falls Zahl2 &gt; Zahl1 *)
        </i></font>ergebnis <font color="#000080">:= </font>zahl1                            <font color="#008000"><i>(* Ergebnis ist Zahl1 *)
      </i></font><font color="#FF0000"><b>ELSE
        BEGIN
          </b></font>hilfe1 <font color="#000080">:= </font>zahl1<font color="#000080">;                 </font><font color="#008000"><i>(* Hilfe1 wird Zahl1 zugewiesen *)
          </i></font>hilfe2 <font color="#000080">:= </font>zahl2<font color="#000080">;                 </font><font color="#008000"><i>(* Hilfe2 wird Zahl2 zugewiesen *)
          </i></font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>GreaterCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>hilfe1<font color="#000080">)) </font><font color="#FF0000"><b>DO
            </b></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);
           </font><font color="#008000"><i>(* schiebe hilfe2 solange nach links, bis dividiert werden kann *)
          </i></font><font color="#FF0000"><b>WHILE NOT </b></font><font color="#000080">(</font>EqualCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>zahl2<font color="#000080">)) </font><font color="#FF0000"><b>DO   </b></font><font color="#008000"><i>(* Abbruchbedingung *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>Mul2CalcStr<font color="#000080">(</font>ergebnis<font color="#000080">);      </font><font color="#008000"><i>(* Ergebnis mit 2 multiplizieren *)
              </i></font>Div2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);            </font><font color="#008000"><i>(* Hilfe2 durch 2 dividieren *)
              </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>GreaterCalcStr<font color="#000080">(</font>hilfe2<font color="#000080">, </font>hilfe1<font color="#000080">)) </font><font color="#FF0000"><b>THEN
                                            </b></font><font color="#008000"><i>(* falls hilfe2 nicht &gt; hilfe1 *)
                </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>SubCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);    </font><font color="#008000"><i>(* Hilfe1 - Hilfe2 *)
                  </i></font>hilfe1 <font color="#000080">:= </font>hilfe<font color="#000080">;         </font><font color="#008000"><i>(* Hilfe1 wird Hilfe zugewiesen *)
                  </i></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>EINS<font color="#000080">, </font>hilfe<font color="#000080">);
                                                </font><font color="#008000"><i>(* zum Ergebnis 1 addieren *)
                  </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;     </font><font color="#008000"><i>(* Ergebnis wird hilfe zugewiesen *)
                </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>ModCalcStr <font color="#000080">:= </font>TRUE<font color="#000080">;                      </font><font color="#008000"><i>(* Division erfolgreich *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* ExptCalcStr berechnet Basis^Exponent                                    *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ExptCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>basis<font color="#000080">, </font>exponent<font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>hilfe  <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe1 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>i<font color="#000080">, </font>j   <font color="#000080">: </font>WORD<font color="#000080">;                                        </font><font color="#008000"><i>(* ZÑhlvariablen *)
    </i></font>wert   <font color="#000080">: </font>WORD<font color="#000080">;              </font><font color="#008000"><i>(* Wert des Exponenten an der i.ten Stelle *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis hat min. 1 Stelle *)
  </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;                                  </font><font color="#008000"><i>(* Ergebnis &gt;= 1 *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>exponent<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>exponent<font color="#000080">.</font>stellen <font color="#000080">=
</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  ELSE                                     </b></font><font color="#008000"><i>(* Exponent = 0 =&gt; Ergebnis = 1 *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>hilfe1 <font color="#000080">:= </font>basis<font color="#000080">;                     </font><font color="#008000"><i>(* Hilfe1 wird Basis zugewiesen *)
      </i></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* i wird mit 1 initialisiert *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= (</font>exponent<font color="#000080">.</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>DO      </b></font><font color="#008000"><i>(* Exponenten abarbeiten *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>wert <font color="#000080">:= </font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">];          </font><font color="#008000"><i>(* i.te Stelle des Exponenten *)
          </i></font>INC<font color="#000080">(</font>i<font color="#000080">);                                        </font><font color="#008000"><i>(* i um 1 erhîhen *)
          </i></font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                            </font><font color="#008000"><i>(* j wird mit 1 initialisiert *)
          </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&lt;= </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>DO                       </b></font><font color="#008000"><i>(* alle Bits abarbeiten *)
            </i></font><font color="#FF0000"><b>BEGIN
              IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN         </b></font><font color="#008000"><i>(* falls 1. Bit gesetzt ist *)
                </i></font>MulCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe1<font color="#000080">, </font>ergebnis<font color="#000080">);
                                     </font><font color="#008000"><i>(* Ergebnis mit Hilfe1 multiplizieren *)
              </i></font>MulCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">);     </font><font color="#008000"><i>(* Hilfe1 quadrieren *)
              </i></font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                            </font><font color="#008000"><i>(* Wert DIV 2 *)
              </i></font>INC<font color="#000080">(</font>j<font color="#000080">);                                 </font><font color="#008000"><i>(* 1 Bit weitergehen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>wert <font color="#000080">:= </font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font>exponent<font color="#000080">.</font>stellen<font color="#000080">];  </font><font color="#008000"><i>(* letzte Stelle behandeln *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>wert <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO                   </b></font><font color="#008000"><i>(* solange noch 1 Bit gesetzt *)
        </i></font><font color="#FF0000"><b>BEGIN
          IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN             </b></font><font color="#008000"><i>(* falls 1. Bit gesetzt ist *)
            </i></font>MulCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe1<font color="#000080">, </font>ergebnis<font color="#000080">);
                                     </font><font color="#008000"><i>(* Ergebnis mit Hilfe1 multiplizieren *)
          </i></font>MulCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">);         </font><font color="#008000"><i>(* Hilfe1 quadrieren *)
          </i></font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* Wert DIV 2 *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* RandomCalcStr liefert eine Zufallszahl &lt; calcZahl                       *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RandomCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>calcZahl<font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">: </font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>WORD<font color="#000080">;                                              </font><font color="#008000"><i>(* ZÑhlvariable *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font>calcZahl<font color="#000080">.</font>stellen<font color="#000080">; </font><font color="#008000"><i>(* Annahme: Stellenzahl ist gleich *)
  </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>calcZahl<font color="#000080">.</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font>Random<font color="#000080">(</font><font color="#800000">65535</font><font color="#000080">);           </font><font color="#008000"><i>(* zufÑllige Zahl &lt; 65535 *)
  </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>ergebnis<font color="#000080">.</font>stellen<font color="#000080">] := </font>Random<font color="#000080">(</font>calcZahl<font color="#000080">.</font>zahl<font color="#000080">[</font>calcZahl<font color="#000080">.</font>stellen<font color="#000080">]);
                              </font><font color="#008000"><i>(* letzte Zahl mu&aacute; kleiner Ausgangszahl sein *)
  </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font>ergebnis<font color="#000080">.</font>stellen<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>DEC<font color="#000080">(</font>ergebnis<font color="#000080">.</font>stellen<font color="#000080">);                  </font><font color="#008000"><i>(* fÅhrende Nullen abschneiden *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">=
</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN                                    </b></font><font color="#008000"><i>(* Ergebnis darf nicht 0 sein *)
      </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                              </font><font color="#008000"><i>(* min. 1 Stelle *)
      </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;                       </font><font color="#008000"><i>(* diese mit 1 besetzen *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* MulModCalcStr multipliziert ein Zahl modulo modul                       *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MulModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">, </font>modul <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">:
</font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j   <font color="#000080">: </font>WORD<font color="#000080">;                                        </font><font color="#008000"><i>(* ZÑhlvariablen *)
    </i></font>wert   <font color="#000080">: </font>WORD<font color="#000080">;                        </font><font color="#008000"><i>(* Wert von Zahl an i.ter Stelle *)
    </i></font>hilfe  <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe1 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe2 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
</i></font><font color="#FF0000"><b>BEGIN
  IF </b></font>LessCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>zahl2<font color="#000080">) </font><font color="#FF0000"><b>THEN                 </b></font><font color="#008000"><i>(* Falls Zahl1 &lt; Zahl2 *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>ModCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe1<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest Zahl1/Modul *)
      </i></font>ModCalcStr<font color="#000080">(</font>zahl2<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe2<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest Zahl2/Modul *)
    </i></font><font color="#FF0000"><b>END
  ELSE
    BEGIN
      </b></font>ModCalcStr<font color="#000080">(</font>zahl1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe2<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest Zahl1/Modul *)
      </i></font>ModCalcStr<font color="#000080">(</font>zahl2<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe1<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest Zahl2/Modul *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;           </font><font color="#008000"><i>(* ErgebnisCalcString initialisieren *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
</font><font color="#FF0000"><b>THEN
                                             </b></font><font color="#008000"><i>(* Hilfe1 mu&aacute; ungleich 0 sein *)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                    </font><font color="#008000"><i>(* i mit 1 initialisieren *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= (</font>hilfe1<font color="#000080">.</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>DO
                                     </b></font><font color="#008000"><i>(* alle Stellen von Hilfe1 abarbeiten *)
        </i></font><font color="#FF0000"><b>BEGIN
          </b></font>wert <font color="#000080">:= </font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">];              </font><font color="#008000"><i>(* aktuellen Wert ermitteln *)
          </i></font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* j mit 1 initialisieren *)
          </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&lt;= </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>DO                       </b></font><font color="#008000"><i>(* alle Bits abarbeiten *)
            </i></font><font color="#FF0000"><b>BEGIN
              IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN          </b></font><font color="#008000"><i>(* Falls Bit 1 gesetzt ist *)
                </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);
                                           </font><font color="#008000"><i>(* Hilfe2 zum Ergebnis addieren *)
                  </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;          </font><font color="#008000"><i>(* und dem Ergebnis zuweisen *)
                </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;               </font><font color="#008000"><i>(* Wert durch 2 dividieren *)
              </i></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);          </font><font color="#008000"><i>(* Hilfe2 mit 2 multiplizieren *)
              </i></font>INC<font color="#000080">(</font>j<font color="#000080">);                                    </font><font color="#008000"><i>(* j um 1 erhîhen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>INC<font color="#000080">(</font>i<font color="#000080">);                                        </font><font color="#008000"><i>(* i um 1 erhîhen *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>wert <font color="#000080">:= </font>hilfe1<font color="#000080">.</font>zahl<font color="#000080">[</font>hilfe1<font color="#000080">.</font>stellen<font color="#000080">];
                                        </font><font color="#008000"><i>(* letzte Zahl gesondert behandeln *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>wert <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO                  </b></font><font color="#008000"><i>(* solange noch ein Bit gesetzt *)
        </i></font><font color="#FF0000"><b>BEGIN
          IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN             </b></font><font color="#008000"><i>(* Falls 1. Bit gesetzt ist *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>AddCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe2<font color="#000080">, </font>hilfe<font color="#000080">);
                                           </font><font color="#008000"><i>(* Hilfe2 zum Ergebnis addieren *)
              </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;              </font><font color="#008000"><i>(* und dem Ergebnis zuweisen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                   </font><font color="#008000"><i>(* Wert durch 2 dividieren *)
          </i></font>Mul2CalcStr<font color="#000080">(</font>hilfe2<font color="#000080">);              </font><font color="#008000"><i>(* Hilfe2 mit 2 multiplizieren *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>hilfe1 <font color="#000080">:= </font>ergebnis<font color="#000080">;                   </font><font color="#008000"><i>(* Hilfe1 wird Ergebnis zugewiesen *)
  </i></font>ModCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>modul<font color="#000080">, </font>ergebnis<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest hilfe1/Modul *)
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)
(* ExptModCalcStr berechnet basis^exponent MOD modul                       *)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ExptModCalcStr<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>basis<font color="#000080">, </font>exponent<font color="#000080">, </font>modul <font color="#000080">: </font>CalcStr<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>ergebnis <font color="#000080">:
</font>CalcStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j   <font color="#000080">: </font>WORD<font color="#000080">;                                        </font><font color="#008000"><i>(* ZÑhlvariablen *)
    </i></font>wert   <font color="#000080">: </font>WORD<font color="#000080">;                        </font><font color="#008000"><i>(* Wert von Zahl an i.ter Stelle *)
    </i></font>hilfe  <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
    </i></font>hilfe1 <font color="#000080">: </font>CalcStr<font color="#000080">;                                   </font><font color="#008000"><i>(* HilfsCalcString *)
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>ergebnis <font color="#000080">:= </font>EMPTYCALCSTR<font color="#000080">;                     </font><font color="#008000"><i>(* Ergebnis initialisieren *)
  </i></font>ergebnis<font color="#000080">.</font>stellen <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                 </font><font color="#008000"><i>(* Ergebnis besitzt min. 1 Stelle *)
  </i></font>ergebnis<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;                      </font><font color="#008000"><i>(* Ergebnis hat mind. Wert 1 *)
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">((</font>exponent<font color="#000080">.</font>stellen <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>exponent<font color="#000080">.</font>stellen <font color="#000080">=
</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
                                            </b></font><font color="#008000"><i>(* Exponent = 0 =&gt; Ergebnis = 1*)
  </i></font><font color="#FF0000"><b>ELSE
    BEGIN
      </b></font>ModCalcStr<font color="#000080">(</font>basis<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe1<font color="#000080">);       </font><font color="#008000"><i>(* Divisionsrest Basis/Modul *)
      </i></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                    </font><font color="#008000"><i>(* i mit 1 initialisieren *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= (</font>exponent<font color="#000080">.</font>stellen <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>DO
        BEGIN
          </b></font>wert <font color="#000080">:= </font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font>i<font color="#000080">];     </font><font color="#008000"><i>(* Wert = i.te Stelle von Exponent *)
          </i></font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                                </font><font color="#008000"><i>(* j mit 1 initialisieren *)
          </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&lt;= </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>DO                       </b></font><font color="#008000"><i>(* alle Bits abarbeiten *)
            </i></font><font color="#FF0000"><b>BEGIN
              IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN          </b></font><font color="#008000"><i>(* Falls Bit 1 gesetzt ist *)
                </i></font><font color="#FF0000"><b>BEGIN
                  </b></font>MulModCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe<font color="#000080">);
                                            </font><font color="#008000"><i>(* Ergebnis * Hilfe1 MOD Modul *)
                  </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;          </font><font color="#008000"><i>(* und dem Ergebnis zuweisen *)
                </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;               </font><font color="#008000"><i>(* Wert durch 2 dividieren *)
              </i></font>MulModCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe<font color="#000080">);
                                                </font><font color="#008000"><i>(* Hilfe1*Hilfe1 MOD Modul *)
              </i></font>hilfe1 <font color="#000080">:= </font>hilfe<font color="#000080">;               </font><font color="#008000"><i>(* und wieder Hilfe1 zuweisen *)
              </i></font>INC<font color="#000080">(</font>j<font color="#000080">);                                    </font><font color="#008000"><i>(* j um 1 erhîhen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>INC<font color="#000080">(</font>i<font color="#000080">);                                        </font><font color="#008000"><i>(* 1 um 1 erhîhen *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>wert <font color="#000080">:= </font>exponent<font color="#000080">.</font>zahl<font color="#000080">[</font>exponent<font color="#000080">.</font>stellen<font color="#000080">];
                                        </font><font color="#008000"><i>(* letzte Zahl gesondert behandeln *)
      </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>wert <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO                  </b></font><font color="#008000"><i>(* solange noch ein Bit gesetzt *)
        </i></font><font color="#FF0000"><b>BEGIN
          IF </b></font><font color="#000080">(</font>wert <font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN             </b></font><font color="#008000"><i>(* Falls 1. Bit gesetzt ist *)
            </i></font><font color="#FF0000"><b>BEGIN
              </b></font>MulModCalcStr<font color="#000080">(</font>ergebnis<font color="#000080">, </font>hilfe1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe<font color="#000080">);
                                              </font><font color="#008000"><i>(* Hilfe1*Ergebnis MOD Modul *)
              </i></font>ergebnis <font color="#000080">:= </font>hilfe<font color="#000080">;              </font><font color="#008000"><i>(* und dem Ergebnis zuweisen *)
            </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>wert <font color="#000080">:= </font>wert <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;                   </font><font color="#008000"><i>(* Wert durch 2 dividieren *)
          </i></font>MulModCalcStr<font color="#000080">(</font>hilfe1<font color="#000080">, </font>hilfe1<font color="#000080">, </font>modul<font color="#000080">, </font>hilfe<font color="#000080">);
                                                </font><font color="#008000"><i>(* Hilfe1*Hilfe1 MOD Modul *)
          </i></font>hilfe1 <font color="#000080">:= </font>hilfe<font color="#000080">;                   </font><font color="#008000"><i>(* und wieder hilfe1 zuweisen *)
        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(* ----------------------------------------------------------------------- *)

</i></font><font color="#FF0000"><b>BEGIN

  </b></font>Randomize<font color="#000080">;                               </font><font color="#008000"><i>(* Zufallsgenerator einschalten *)

  (* Initialiseren eines globalen Leerstrings *)
  </i></font><font color="#FF0000"><b>WITH </b></font>EMPTYCALCSTR <font color="#FF0000"><b>DO                             </b></font><font color="#008000"><i>(* Recordtyp abarbeiten *)
    </i></font><font color="#FF0000"><b>BEGIN
      </b></font>stellen <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                                         </font><font color="#008000"><i>(* LÑnge ist 0 *)
      </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>MAXCALCSTR <font color="#FF0000"><b>DO </b></font>zahl<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;     </font><font color="#008000"><i>(* zahl initialisieren *)
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(* Ende der Initialisierung *)

</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
