<html>
<head><title> "Still More Primes" by GUY MCLOUGHLIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
GUY MCLOUGHLIN

&gt;the way, it took about 20 mins. on my 386/40 to get prime numbers
&gt;through 20000. I tried to come up With code to do the same With
&gt;Turbo but it continues to elude me. Could anybody explain
&gt;how to Write such a routine in Pascal?

  ...The following PRIME routine should prove to be a bit faster:
}

{ Find the square-root of a LongInt. }
</i></font><font color="#FF0000"><b>Function </b></font>FindSqrt<font color="#000080">(</font>lo_IN <font color="#000080">: </font>LongInt<font color="#000080">) : </font>LongInt<font color="#000080">;

  </font><font color="#008000"><i>{ SUB : Find square-root For numbers less than 65536. }
  </i></font><font color="#FF0000"><b>Function </b></font>FS1<font color="#000080">(</font>wo_IN <font color="#000080">: </font>Word<font color="#000080">) : </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>wo_Temp1<font color="#000080">,
    </font>wo_Temp2 <font color="#000080">: </font>Word<font color="#000080">;
    </font>lo_Error <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>wo_IN <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>wo_Temp1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>wo_Temp2 <font color="#000080">:= </font>wo_IN<font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>wo_Temp1 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) &lt; </font>wo_Temp2<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>wo_Temp1 <font color="#000080">:= </font>wo_Temp1 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
        </font>wo_Temp2 <font color="#000080">:= </font>wo_Temp2 <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
        </b></font>wo_Temp1 <font color="#000080">:= (</font>wo_Temp1 <font color="#000080">+ </font>wo_Temp2<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
        </font>wo_Temp2 <font color="#000080">:= </font>wo_IN <font color="#FF0000"><b>div </b></font>wo_Temp1<font color="#000080">;
        </font>lo_Error <font color="#000080">:= (</font>LongInt<font color="#000080">(</font>wo_Temp1<font color="#000080">) - </font>wo_Temp2<font color="#000080">);
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>lo_Error <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">);
      </font>FS1 <font color="#000080">:= </font>wo_Temp1<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>FS1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ SUB : Find square-root For numbers greater than 65535. }
  </i></font><font color="#FF0000"><b>Function </b></font>FS2<font color="#000080">(</font>lo_IN <font color="#000080">: </font>longInt<font color="#000080">) : </font>longInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>lo_Temp1<font color="#000080">,
    </font>lo_Temp2<font color="#000080">,
    </font>lo_Error <font color="#000080">: </font>longInt<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>lo_IN <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>lo_Temp1 <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>lo_Temp2 <font color="#000080">:= </font>lo_IN<font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>lo_Temp1 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) &lt; </font>lo_Temp2<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>lo_Temp1 <font color="#000080">:= </font>lo_Temp1 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
        </font>lo_Temp2 <font color="#000080">:= </font>lo_Temp2 <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>Repeat
        </b></font>lo_Temp1 <font color="#000080">:= (</font>lo_Temp1 <font color="#000080">+ </font>lo_Temp2<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
        </font>lo_Temp2 <font color="#000080">:= </font>lo_IN <font color="#FF0000"><b>div </b></font>lo_Temp1<font color="#000080">;
        </font>lo_Error <font color="#000080">:= (</font>lo_Temp1 <font color="#000080">- </font>lo_Temp2<font color="#000080">);
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>lo_Error <font color="#000080">&lt;= </font><font color="#800000">0</font><font color="#000080">);
      </font>FS2 <font color="#000080">:= </font>lo_Temp1<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else
      </b></font>FS2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>lo_IN <font color="#000080">&lt; </font><font color="#800000">65536</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>FindSqrt <font color="#000080">:= </font>FS1<font color="#000080">(</font>lo_IN<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>FindSqrt <font color="#000080">:= </font>FS2<font color="#000080">(</font>lo_IN<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Check if a number is prime. }
</i></font><font color="#FF0000"><b>Function </b></font>Prime<font color="#000080">(</font>lo_IN <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>lo_Sqrt<font color="#000080">,
  </font>lo_Loop <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if not </b></font>odd<font color="#000080">(</font>lo_IN<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Prime <font color="#000080">:= (</font>lo_IN <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">);
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_IN <font color="#FF0000"><b>mod </b></font><font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Prime <font color="#000080">:= (</font>lo_IN <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">);
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_IN <font color="#FF0000"><b>mod </b></font><font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Prime <font color="#000080">:= (</font>lo_IN <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">);
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>lo_Sqrt <font color="#000080">:= </font>FindSqrt<font color="#000080">(</font>lo_IN<font color="#000080">);
  </font>lo_Loop <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>lo_Loop <font color="#000080">&lt; </font>lo_Sqrt<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>inc<font color="#000080">(</font>lo_Loop<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_IN <font color="#FF0000"><b>mod </b></font>lo_Loop <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Prime <font color="#000080">:= </font>False<font color="#000080">;
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Prime <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0029.PAS">Original</a><b>]</b></p></body>
</html>
