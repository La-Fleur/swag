<html>
<head><title> "EQUATION parser" by KD TART</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I'm currently working on a small program for a Turbo Pascal class
&gt; I am taking.  The assignment is to write a program that solves a system
&gt; of equations via Cramer's Rule.  For example:
&gt;
&gt; 4x - 3y + 9z = 21
&gt; 5x - 43y - 3z = 45
&gt; 34x - 394y + 32z = 9
&gt;
&gt; and then find values for x, y, and z.
&gt;
&gt;    Now this is no problem:  I simply get input into a 3 x 4 array, which
&gt; would look like this for the sample above:
&gt;
&gt; 4    -3     9     21
&gt; 5    -43    -3    45
&gt; 34   -394   32    9
&gt;
&gt;    The problem I am having is getting this input from the user.  Now I
&gt; have thought of a few ways to accomplish this, namely:
&gt;
&gt; (1) Ask the user to enter the coefficients and the answer on a line and
&gt; hit return, and do this for each equation--this method allows me to put the
&gt; data directly into the array.
&gt;
&gt; (2) Give a rigid example of how and where to enter the equation, for
&gt; example #####x(sign)#####y(sign)#####z = #####
&gt; so I know where to read for the values to put into the array.
&gt;
&gt; (3) Possibly use the Val procedure and ask the user to input all number
&gt; as in #1, but separate the numbers with dashes.
&gt;
&gt; (4) Possibly convert string values to their ascii equivalent, and see if
&gt; they are numbers, turning non numbers into spaces.
&gt;
&gt; But, what I would rather do is to prompt the user for the whole equation
&gt; and have him/her type it out naturally and then pick the numbers out of
&gt; it to put into the 3x4 array.  Example:
&gt;
&gt; Enter equation #1:
&gt; 3x + 4y - 8z = 45
&gt; ...
&gt;
&gt;    This would seem to require storing the input as a string, and as far
&gt; as I know, you can't pick values of a string (except in a limited sense
&gt; with the Val function as touched upon above).  But I think that it has
&gt; to be possible for me to process a naturally typed out equation!  And I
&gt; would appreciate pointers to that effect.

The following code, written in Turbo Pascal 6, should do what you
want. You may want to test it more thoroughly than I did, and tidy up
the code a bit. It checks for validity of input. Values are stored as
reals.

It reads in the equation, and puts the values into the global array
eq_array.
}

</i></font><font color="#FF0000"><b>program </b></font>input_equations<font color="#000080">(</font>input<font color="#000080">, </font>output<font color="#000080">);

</font><font color="#FF0000"><b>type
  </b></font>eq_string <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">40</font><font color="#000080">];

</font><font color="#FF0000"><b>var
  </b></font>instr <font color="#000080">:</font>eq_string<font color="#000080">;
  </font>eq_array <font color="#000080">:</font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>real<font color="#000080">;
  </font>eq_num <font color="#000080">:</font>byte<font color="#000080">;
  </font>x<font color="#000080">, </font>y<font color="#000080">, </font>z<font color="#000080">, </font>answer <font color="#000080">:</font>real<font color="#000080">;
  </font>eq_ok <font color="#000080">:</font>boolean<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>prepare_equation_string <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s <font color="#000080">:</font>eq_string<font color="#000080">);
</font><font color="#008000"><i>{ Removes spaces and converts all letter to upper case }
</i></font><font color="#FF0000"><b>var
  </b></font>tempstr <font color="#000080">:</font>eq_string<font color="#000080">;
  </font>n <font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tempstr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>s<font color="#000080">[</font>n<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>tempstr <font color="#000080">:= </font>tempstr <font color="#000080">+ </font>upcase<font color="#000080">(</font>s<font color="#000080">[</font>n<font color="#000080">]);
  </font>s <font color="#000080">:= </font>tempstr
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>get_arguments <font color="#000080">(</font>s <font color="#000080">:</font>eq_string<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>a1<font color="#000080">, </font>a2<font color="#000080">, </font>a3 <font color="#000080">:</font>eq_string<font color="#000080">) :</font>boolean<font color="#000080">;
</font><font color="#008000"><i>{ Splits equation into argument.
  eg, if s='3X+4Y-Z', then a1='3X', a2='+4Y', a3='-Z'.

If any argument is blank, or there are more than 3 arguments,
returns FALSE, otherwise returns TRUE }

  </i></font><font color="#FF0000"><b>function </b></font>next_arg <font color="#000080">(</font>s <font color="#000080">:</font>eq_string<font color="#000080">) :</font>eq_string<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>n <font color="#000080">:</font>byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>n <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>n <font color="#000080">&lt;= </font>length<font color="#000080">(</font>s<font color="#000080">)) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>s<font color="#000080">[</font>n<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>do
      </b></font>inc <font color="#000080">(</font>n<font color="#000080">);
    </font>next_arg <font color="#000080">:= </font>copy <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>a1 <font color="#000080">:= </font>next_arg <font color="#000080">(</font>s<font color="#000080">);
  </font>delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>a1<font color="#000080">));
  </font>a2 <font color="#000080">:= </font>next_arg <font color="#000080">(</font>s<font color="#000080">);
  </font>delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>a2<font color="#000080">));
  </font>a3 <font color="#000080">:= </font>next_arg <font color="#000080">(</font>s<font color="#000080">);
  </font>delete <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>a3<font color="#000080">));
  </font>get_arguments <font color="#000080">:= ((</font>length<font color="#000080">(</font>a1<font color="#000080">)*</font>length<font color="#000080">(</font>a2<font color="#000080">)*</font>length<font color="#000080">(</font>a3<font color="#000080">)) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
                   </b></font><font color="#000080">(</font>s <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>assign_values <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z <font color="#000080">:</font>real<font color="#000080">; </font>a1<font color="#000080">, </font>a2<font color="#000080">, </font>a3 <font color="#000080">:</font>eq_string<font color="#000080">) :</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>x_assigned<font color="#000080">, </font>y_assigned<font color="#000080">, </font>z_assigned<font color="#000080">, </font>ok_so_far <font color="#000080">:</font>boolean<font color="#000080">;

    </font><font color="#FF0000"><b>function </b></font>assign_value <font color="#000080">(</font>s <font color="#000080">:</font>eq_string<font color="#000080">) :</font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>id <font color="#000080">:</font>char<font color="#000080">;
      </font>value <font color="#000080">:</font>real<font color="#000080">;
      </font>resultcode <font color="#000080">:</font>integer<font color="#000080">;
      </font>ok <font color="#000080">:</font>boolean<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>id <font color="#000080">:= </font>s<font color="#000080">[</font>length<font color="#000080">(</font>s<font color="#000080">)];
      </font>delete <font color="#000080">(</font>s<font color="#000080">, </font>length<font color="#000080">(</font>s<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>s <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>s <font color="#000080">= </font><font color="#800000">'+'</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>s <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>s <font color="#000080">= </font><font color="#800000">'-' </font><font color="#FF0000"><b>then
        </b></font>s <font color="#000080">:= </font><font color="#800000">'-1'</font><font color="#000080">;
      </font>val <font color="#000080">(</font>s<font color="#000080">, </font>value<font color="#000080">, </font>resultcode<font color="#000080">);
      </font>ok <font color="#000080">:= (</font>resultcode <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>case </b></font>id <font color="#FF0000"><b>of
        </b></font><font color="#800000">'X' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                </b></font>x <font color="#000080">:= </font>value<font color="#000080">;
                </font>x_assigned <font color="#000080">:= </font>true
              <font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'Y' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                </b></font>y <font color="#000080">:= </font>value<font color="#000080">;
                </font>y_assigned <font color="#000080">:= </font>true
              <font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">'Z' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                </b></font>z <font color="#000080">:= </font>value<font color="#000080">;
                </font>z_assigned <font color="#000080">:= </font>true
              <font color="#FF0000"><b>end
      else
        </b></font>ok <font color="#000080">:= </font>false
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>assign_value <font color="#000080">:= </font>ok
    <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>x_assigned <font color="#000080">:= </font>false<font color="#000080">;
  </font>y_assigned <font color="#000080">:= </font>false<font color="#000080">;
  </font>z_assigned <font color="#000080">:= </font>false<font color="#000080">;
  </font>ok_so_far  <font color="#000080">:= </font>assign_value <font color="#000080">(</font>a1<font color="#000080">);
  </font>ok_so_far  <font color="#000080">:= </font>ok_so_far <font color="#FF0000"><b>and </b></font>assign_value <font color="#000080">(</font>a2<font color="#000080">);
  </font>ok_so_far  <font color="#000080">:= </font>ok_so_far <font color="#FF0000"><b>and </b></font>assign_value <font color="#000080">(</font>a3<font color="#000080">);
  </font>assign_values <font color="#000080">:= </font>ok_so_far <font color="#FF0000"><b>and </b></font>x_assigned <font color="#FF0000"><b>and </b></font>y_assigned <font color="#FF0000"><b>and </b></font>z_assigned<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>extract_values<font color="#000080">(</font>s <font color="#000080">: </font>eq_string<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z<font color="#000080">, </font>ans <font color="#000080">: </font>real<font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>ok_so_far <font color="#000080">: </font>boolean<font color="#000080">;
  </font>n <font color="#000080">: </font>byte<font color="#000080">;
  </font>lhs<font color="#000080">, </font>rhs<font color="#000080">,
  </font>a1<font color="#000080">, </font>a2<font color="#000080">, </font>a3 <font color="#000080">: </font>eq_string<font color="#000080">;
  </font>resultcode <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ok_so_far <font color="#000080">:= </font>true<font color="#000080">;
  </font>prepare_equation_string<font color="#000080">(</font>s<font color="#000080">);
  </font>n <font color="#000080">:= </font>pos <font color="#000080">(</font><font color="#800000">'='</font><font color="#000080">, </font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>n <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>ok_so_far <font color="#000080">:= </font>false                     <font color="#008000"><i>{ No = in equation }
  </i></font><font color="#FF0000"><b>else
  begin
    </b></font>rhs <font color="#000080">:= </font>copy <font color="#000080">(</font>s<font color="#000080">, </font>n<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>s<font color="#000080">)-</font>n<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>pos <font color="#000080">(</font><font color="#800000">'='</font><font color="#000080">, </font>rhs<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>ok_so_far <font color="#000080">:= </font>false                 <font color="#008000"><i>{ More than one = in equation }
    </i></font><font color="#FF0000"><b>else
    begin
      </b></font>lhs <font color="#000080">:= </font>copy <font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>n<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lhs <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>rhs <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>ok_so_far <font color="#000080">:= </font>false             <font color="#008000"><i>{ At least one side of equation }
      </i></font><font color="#FF0000"><b>else                             </b></font><font color="#008000"><i>{ is blank }
      </i></font><font color="#FF0000"><b>begin
        </b></font>ok_so_far <font color="#000080">:= </font>get_arguments <font color="#000080">(</font>lhs<font color="#000080">, </font>a1<font color="#000080">, </font>a2<font color="#000080">, </font>a3<font color="#000080">);
        </font>ok_so_far <font color="#000080">:= </font>ok_so_far <font color="#FF0000"><b>and </b></font>assign_values <font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>z<font color="#000080">, </font>a1<font color="#000080">, </font>a2<font color="#000080">, </font>a3<font color="#000080">);
        </font>val <font color="#000080">(</font>rhs<font color="#000080">, </font>ans<font color="#000080">, </font>resultcode<font color="#000080">);
        </font>ok_so_far <font color="#000080">:= </font>ok_so_far <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>resultcode <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>extract_values <font color="#000080">:= </font>ok_so_far<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  for </b></font>eq_num <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do
  begin
    repeat
      </b></font>write <font color="#000080">(</font><font color="#800000">'Equation '</font><font color="#000080">, </font>eq_num<font color="#000080">, </font><font color="#800000">': '</font><font color="#000080">);
      </font>readln <font color="#000080">(</font>instr<font color="#000080">);
      </font>eq_ok <font color="#000080">:= </font>extract_values <font color="#000080">(</font>instr<font color="#000080">, </font>x<font color="#000080">, </font>y<font color="#000080">, </font>z<font color="#000080">, </font>answer<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>eq_ok <font color="#FF0000"><b>then
        </b></font>writeln <font color="#000080">(</font><font color="#800000">'Equation not in suitable format, try again'</font><font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font>eq_ok<font color="#000080">;
    </font>eq_array <font color="#000080">[</font>eq_num<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">] := </font>x<font color="#000080">;
    </font>eq_array <font color="#000080">[</font>eq_num<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">] := </font>y<font color="#000080">;
    </font>eq_array <font color="#000080">[</font>eq_num<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">] := </font>z<font color="#000080">;
    </font>eq_array <font color="#000080">[</font>eq_num<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">] := </font>answer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0061.PAS">Original</a><b>]</b></p></body>
</html>
