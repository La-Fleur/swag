<html>
<head><title> "Matrix Algebra Unit" by VITUS WAGNER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: &quot;Victor B. Wagner&quot; &lt;vitus@agropc.msk.su&gt;
************************************************************
*                   ALGEBRA.PAS                            *
*           a simple matrix algebra unit                   *
*           Turbo Pascal 4.0 or higher                     *
*           Copyright (c) by Vitus Wagner,1990             *
************************************************************
}
</i></font><font color="#FF0000"><b>unit </b></font>algebra<font color="#000080">;
</font><font color="#FF0000"><b>interface
   const </b></font>MaxN<font color="#000080">=</font><font color="#800000">30</font><font color="#000080">;</font><font color="#008000"><i>{You can increase it up to 100,not greater
                 but each matrix variable would have size of
                 sqr(MaxN)*sizeof(Real). It is possible to write
                 unit for work with dinamically sized matrices,
                 but i have no needs to do this.
                 You can work with matrices with size less that MaxN,
                 but while you work with this unit you must allocate
                 memory for matrix MaxN x MaxN and leave rest of space
                 unised}
   </i></font><font color="#FF0000"><b>type </b></font>vector<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxN<font color="#000080">]</font><font color="#FF0000"><b>of </b></font>real<font color="#000080">;
        </font>matrix<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxN<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font>MaxN<font color="#000080">]</font><font color="#FF0000"><b>of </b></font>real<font color="#000080">;
        </font>sett<font color="#000080">=</font><font color="#FF0000"><b>set of </b></font><font color="#800000">1</font><font color="#000080">..</font>MaxN<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>algebrerr<font color="#000080">:</font>boolean<font color="#000080">;
 </font><font color="#FF0000"><b>function </b></font>scalar<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
 </font><font color="#008000"><i>{Scalar multiplication of vectors a and b of n components}
 </i></font><font color="#FF0000"><b>procedure </b></font>systeq<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>b<font color="#000080">:</font>vector<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ solving n line equation system A*X=B by Gauss method}
 { sets algebrerr to True if system cannot be solved}
 </i></font><font color="#FF0000"><b>procedure </b></font>matmult<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ multiplication of two NxN matrixs A and B.Result - matrix C AxB=C}
 </i></font><font color="#FF0000"><b>procedure </b></font>matadd<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c <font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ addition of two NxN matrixs A+B=C }
 </i></font><font color="#FF0000"><b>procedure </b></font>matconst<font color="#000080">(</font>c<font color="#000080">:</font>real<font color="#000080">;</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ multiplication matrix A on constant c  cxA=B }
 </i></font><font color="#FF0000"><b>procedure </b></font>matcadd<font color="#000080">(</font>c1<font color="#000080">:</font>real<font color="#000080">;</font>a1<font color="#000080">:</font>matrix<font color="#000080">;</font>c2<font color="#000080">:</font>real<font color="#000080">;</font>a2<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ addition of two NxN matrixs with multiplication each of them on constant
   c1xA1+c2xA2=B }
 </i></font><font color="#FF0000"><b>procedure </b></font>matinv<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>ainv<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ inversion of NxN matrix A}
 { sets algebrerr to True if matrix cannot be inverted}
 </i></font><font color="#FF0000"><b>procedure </b></font>matvec<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>b<font color="#000080">:</font>vector<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#008000"><i>{ multiplication NxN matrix A to N-component vector B AxB=C}
 </i></font><font color="#FF0000"><b>function </b></font>det<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
 </font><font color="#008000"><i>{ determinant of NxN matrix }
 </i></font><font color="#FF0000"><b>procedure </b></font>compress<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">;</font>s<font color="#000080">:</font>sett<font color="#000080">);
 </font><font color="#008000"><i>{ converse triangle matrix to simmetric,exclude rows and columns that is not
   in set s (type sett=set of 0..maxN)}
 </i></font><font color="#FF0000"><b>function </b></font>distance<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
 </font><font color="#008000"><i>{ Calculate Euclide distantion in N-dimensioned space between A &amp; B }
 </i></font><font color="#FF0000"><b>Procedure </b></font>Transpose<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Matrix<font color="#000080">;</font>M<font color="#000080">,</font>N<font color="#000080">:</font>Integer<font color="#000080">);
 </font><font color="#008000"><i>{ Transpose MxN Matrix. Put result in the same place}
 </i></font><font color="#FF0000"><b>Procedure </b></font>EMatrix<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Matrix<font color="#000080">;</font>N<font color="#000080">:</font>Integer<font color="#000080">);
 </font><font color="#008000"><i>{Fills matrix by 0 and main diagonal by 1}
</i></font><font color="#FF0000"><b>implementation
 function </b></font>scalar<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;
      </font>r<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   </b></font>r<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>r<font color="#000080">:=</font>r<font color="#000080">+</font>a<font color="#000080">[</font>i<font color="#000080">]*</font>b<font color="#000080">[</font>i<font color="#000080">];
   </font>scalar<font color="#000080">:=</font>r<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>systeq<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>b<font color="#000080">:</font>vector<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;
      </font>max<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  </b></font>algebrerr<font color="#000080">:=</font>false<font color="#000080">;
   </font><font color="#008000"><i>{ Conversion matrix to triangle }
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    begin
     </b></font>max<font color="#000080">:=</font>abs<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">]);</font>k<font color="#000080">:=</font>i<font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      if </b></font>abs<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">])&gt;</font>max <font color="#FF0000"><b>then
       begin
        </b></font>max<font color="#000080">:=</font>abs<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">]);</font>k<font color="#000080">:=</font>j
       <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>max<font color="#000080">&lt;</font><font color="#800000">1E</font><font color="#000080">-</font><font color="#800000">10 </font><font color="#FF0000"><b>then begin </b></font>algebrerr<font color="#000080">:=</font>true<font color="#000080">;</font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>k<font color="#000080">&lt;&gt;</font>i <font color="#FF0000"><b>then
       begin
        for  </b></font>j<font color="#000080">:=</font>i <font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
         begin
          </b></font>max<font color="#000080">:=</font>a<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">];
          </font>a<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
          </font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>max<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>max<font color="#000080">:=</font>b<font color="#000080">[</font>k<font color="#000080">];
        </font>b<font color="#000080">[</font>k<font color="#000080">]:=</font>b<font color="#000080">[</font>i<font color="#000080">];
        </font>b<font color="#000080">[</font>i<font color="#000080">]:=</font>max<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       </b></font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]/</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
       </font>b<font color="#000080">[</font>i<font color="#000080">]:=</font>b<font color="#000080">[</font>i<font color="#000080">]/</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       begin
        for </b></font>k<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
         </b></font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]:=</font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]-</font>a<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]*</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">];
        </font>b<font color="#000080">[</font>j<font color="#000080">]:=</font>b<font color="#000080">[</font>j<font color="#000080">]-</font>b<font color="#000080">[</font>i<font color="#000080">]*</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">];
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{ X calculation}
     </i></font>x<font color="#000080">[</font>n<font color="#000080">]:=</font>b<font color="#000080">[</font>n<font color="#000080">];
     </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>pred<font color="#000080">(</font>n<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
      begin
       </b></font>max<font color="#000080">:=</font>b<font color="#000080">[</font>i<font color="#000080">];
       </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
        </b></font>max<font color="#000080">:=</font>max<font color="#000080">-</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]*</font>x<font color="#000080">[</font>j<font color="#000080">];
       </font>x<font color="#000080">[</font>i<font color="#000080">]:=</font>max<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matmult<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;</font>r<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
     begin
      </b></font>r<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       </b></font>r<font color="#000080">:=</font>r<font color="#000080">+</font>a<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]*</font>b<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">];
      </font>c<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>r<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matadd<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c <font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
     </b></font>c<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]+</font>b<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matinv<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>ainv<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;
      </font>e<font color="#000080">:</font>matrix<font color="#000080">;
      </font>max<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   </b></font>algebrerr<font color="#000080">:=</font>false<font color="#000080">;
   </font><font color="#008000"><i>{ creating single matrix }
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
     </b></font>e<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>e<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">]:=</font><font color="#800000">1.0</font><font color="#000080">;
   </font><font color="#008000"><i>{ Conversion matrix to triangle }
   </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{1} </i></font><font color="#FF0000"><b>begin
     </b></font>max<font color="#000080">:=</font>abs<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">]);</font>k<font color="#000080">:=</font>i<font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      if </b></font>abs<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">])&gt;</font>max <font color="#FF0000"><b>then
</b></font><font color="#008000"><i>{2}    </i></font><font color="#FF0000"><b>begin
        </b></font>max<font color="#000080">:=</font>abs<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">]);</font>k<font color="#000080">:=</font>j
<font color="#008000"><i>{2}    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>max<font color="#000080">&lt;</font><font color="#800000">1E</font><font color="#000080">-</font><font color="#800000">10 </font><font color="#FF0000"><b>then begin </b></font>algebrerr<font color="#000080">:=</font>true<font color="#000080">;</font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>k<font color="#000080">&lt;&gt;</font>i <font color="#FF0000"><b>then
</b></font><font color="#008000"><i>{2}    </i></font><font color="#FF0000"><b>begin
        for  </b></font>j<font color="#000080">:=</font>i <font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{3}      </i></font><font color="#FF0000"><b>begin
          </b></font>max<font color="#000080">:=</font>a<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">];
          </font>a<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
          </font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>max<font color="#000080">;
</font><font color="#008000"><i>{3}      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{3}    </i></font><font color="#FF0000"><b>begin
        </b></font>max<font color="#000080">:=</font>e<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">];
        </font>e<font color="#000080">[</font>k<font color="#000080">,</font>j<font color="#000080">]:=</font>e<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
        </font>e<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>max<font color="#000080">;
</font><font color="#008000"><i>{3}    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{2}   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       </b></font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]/</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
       </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       </b></font>e<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]:=</font>e<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]/</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{2}    </i></font><font color="#FF0000"><b>begin
        for </b></font>k<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
         </b></font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]:=</font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]-</font>a<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]*</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">];
        </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
        </b></font>e<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]:=</font>e<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]-</font>e<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]*</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">];
</font><font color="#008000"><i>{2}    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{1} </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{ ainv calculation}
    </i></font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{1} </i></font><font color="#FF0000"><b>begin
     </b></font>ainv<font color="#000080">[</font>n<font color="#000080">,</font>k<font color="#000080">]:=</font>e<font color="#000080">[</font>n<font color="#000080">,</font>k<font color="#000080">];
     </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>pred<font color="#000080">(</font>n<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
</b></font><font color="#008000"><i>{2}   </i></font><font color="#FF0000"><b>begin
       </b></font>max<font color="#000080">:=</font>e<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">];
       </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
        </b></font>max<font color="#000080">:=</font>max<font color="#000080">-</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]*</font>ainv<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">];
       </font>ainv<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">]:=</font>max<font color="#000080">;
</font><font color="#008000"><i>{2}   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{1}  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matvec<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>b<font color="#000080">:</font>vector<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>c<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;</font>r<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    begin
     </b></font>r<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      </b></font>r<font color="#000080">:=</font>r<font color="#000080">+</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]*</font>b<font color="#000080">[</font>j<font color="#000080">];
     </font>c<font color="#000080">[</font>i<font color="#000080">]:=</font>r<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>function </b></font>det<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>integer<font color="#000080">;</font>d<font color="#000080">:</font>real<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>pred<font color="#000080">(</font>n<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
     if </b></font>abs<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">])&lt;</font><font color="#800000">1E</font><font color="#000080">-</font><font color="#800000">10 </font><font color="#FF0000"><b>then begin </b></font>det<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;</font>exit <font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      begin
       </b></font>d<font color="#000080">:=</font>a<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">]/</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
       </font><font color="#FF0000"><b>for </b></font>k<font color="#000080">:=</font>i <font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
        </b></font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]:=</font>a<font color="#000080">[</font>j<font color="#000080">,</font>k<font color="#000080">]-</font>d<font color="#000080">*</font>a<font color="#000080">[</font>i<font color="#000080">,</font>k<font color="#000080">];
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>d<font color="#000080">:=</font><font color="#800000">1.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>d<font color="#000080">:=</font>d<font color="#000080">*</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
   </font>det<font color="#000080">:=</font>d<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matconst<font color="#000080">(</font>c<font color="#000080">:</font>real<font color="#000080">;</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
   for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>b<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>c<font color="#000080">*</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>matcadd<font color="#000080">(</font>c1<font color="#000080">:</font>real<font color="#000080">;</font>a1<font color="#000080">:</font>matrix<font color="#000080">;</font>c2<font color="#000080">:</font>real<font color="#000080">;</font>a2<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
   for </b></font>j<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
    </b></font>b<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>c1<font color="#000080">*</font>a1<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]+</font>c2<font color="#000080">*</font>a2<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>procedure </b></font>compress<font color="#000080">(</font>a<font color="#000080">:</font>matrix<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>b<font color="#000080">:</font>matrix<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">;</font>s<font color="#000080">:</font>sett<font color="#000080">);
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>l<font color="#000080">:</font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
   </b></font>k<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>pred<font color="#000080">(</font>n<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>i <font color="#FF0000"><b>in </b></font>s <font color="#FF0000"><b>then
     begin
      </b></font>l<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font>b<font color="#000080">[</font>k<font color="#000080">,</font>k<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">];
      </font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
       if </b></font>j <font color="#FF0000"><b>in </b></font>s <font color="#FF0000"><b>then
        begin
         </b></font>b<font color="#000080">[</font>k<font color="#000080">,</font>l<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
         </font>b<font color="#000080">[</font>l<font color="#000080">,</font>k<font color="#000080">]:=</font>a<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
         </font>inc<font color="#000080">(</font>l<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>inc<font color="#000080">(</font>k<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>function </b></font>distance<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">:</font>vector<font color="#000080">;</font>n<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;
 </font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>integer<font color="#000080">;</font>r<font color="#000080">:</font>real<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  </b></font>r<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
   </b></font>r<font color="#000080">:=</font>r<font color="#000080">+</font>sqr<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">]-</font>b<font color="#000080">[</font>i<font color="#000080">]);
  </font>distance<font color="#000080">:=</font>sqrt<font color="#000080">(</font>r<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>Transpose<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Matrix<font color="#000080">;</font>M<font color="#000080">,</font>N<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>Integer<font color="#000080">;</font>Tmp<font color="#000080">:</font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
 For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
  for </b></font>j<font color="#000080">:=</font>i<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>m <font color="#FF0000"><b>do
   begin
    </b></font>Tmp<font color="#000080">:=</font>A<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">];
    </font>A<font color="#000080">[</font>i<font color="#000080">,</font>j<font color="#000080">]:=</font>A<font color="#000080">[</font>j<font color="#000080">,</font>i<font color="#000080">];
    </font>A<font color="#000080">[</font>J<font color="#000080">,</font>i<font color="#000080">]:=</font>Tmp<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>EMatrix<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>Matrix<font color="#000080">;</font>N<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>A<font color="#000080">,</font>SizeOf<font color="#000080">(</font>A<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
   </b></font>A<font color="#000080">[</font>i<font color="#000080">,</font>i<font color="#000080">]:=</font><font color="#800000">1.0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0080.PAS">Original</a><b>]</b></p></body>
</html>
