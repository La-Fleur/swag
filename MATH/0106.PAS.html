<html>
<head><title> "BCD Add & Subtract functions" by UNKNOWN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0106.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Depending on the application, BCD may solve your problem.  But if you
really need a _large_ binary integer you are going to have to use
multiple precision arithmetic.  This is relatively easy to do in assembler
and just a little more difficult in a high-level language.

You need to define your _integer_ as an array of 256 bytes, 128 words,
or 64 unsigned long integers.  So we're stuck with words.  So our bigint
is an array[0..127] of word;  We'll do it little-endian 0=least
significant word, 127 = most significant word.  Using words with a longint
intermediate value actually makes our task a little easier.
}

</i></font><font color="#FF0000"><b>CONST </b></font>MaxBIG  <font color="#000080">= </font><font color="#800000">127</font><font color="#000080">;
</font><font color="#FF0000"><b>TYPE  </b></font>tBigInt <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxBIG<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>BigAdd<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Op1<font color="#000080">, </font>Op2<font color="#000080">: </font>tBigInt<font color="#000080">);
</font><font color="#008000"><i>{ --------------------------------------------- }
{ Do multiprecision add:  Op1 := Op1 + Op2      }
{ --------------------------------------------- }
</i></font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
    </font>Temp<font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
    </b></font>Temp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                       </font><font color="#008000"><i>{ Clear carry }
    </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxBIG <font color="#FF0000"><b>Do Begin
       </b></font>Temp   <font color="#000080">:= </font>Longint<font color="#000080">(</font>Op1<font color="#000080">[</font>i<font color="#000080">]) + </font>Op2<font color="#000080">[</font>i<font color="#000080">] + </font>Temp<font color="#000080">;
       </font>Op1<font color="#000080">[</font>i<font color="#000080">] := </font>Word<font color="#000080">(</font>Temp<font color="#000080">);
       </font>Temp   <font color="#000080">:= </font>Temp <font color="#FF0000"><b>shr </b></font><font color="#800000">16</font><font color="#000080">;  </font><font color="#008000"><i>{ Carry = High word }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>BigSub<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Op1<font color="#000080">, </font>Op2<font color="#000080">: </font>tBigInt<font color="#000080">);
</font><font color="#008000"><i>{ --------------------------------------------- }
{ Do multiprecision Substract: Op1 := Op1 - Op2 }
{ --------------------------------------------- }
</i></font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
    </font>Temp<font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin
    </b></font>Temp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                       </font><font color="#008000"><i>{ Clear carry }
    </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxBIG <font color="#FF0000"><b>Do Begin
       </b></font>Temp   <font color="#000080">:= </font>Longint<font color="#000080">(</font>Op1<font color="#000080">[</font>i<font color="#000080">]) - </font>Op2<font color="#000080">[</font>i<font color="#000080">] - </font>Temp<font color="#000080">;
       </font>Op1<font color="#000080">[</font>i<font color="#000080">] := </font>Word<font color="#000080">(</font>Temp<font color="#000080">);
       </font>Temp   <font color="#000080">:= </font>Temp <font color="#FF0000"><b>shr </b></font><font color="#800000">16</font><font color="#000080">;  </font><font color="#008000"><i>{ Carry = High word }
    </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>I<font color="#800000">'ve done the easy part.  It'</font>s your turn <font color="#FF0000"><b>to </b></font>put together
the multiprecision multiply <font color="#FF0000"><b>and </b></font>divide<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>Op2 can be
an integer I<font color="#800000">'ll toss together an op1*Op2 and Op1 div Op2.
</font>But <font color="#FF0000"><b>for </b></font>a full version I<font color="#800000">'d have to crack the books :-)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0106.PAS">Original</a><b>]</b></p></body>
</html>
