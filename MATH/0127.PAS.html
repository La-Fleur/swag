<html>
<head><title> "Multilist implementation of a digraph" by WILLIAM HOBDAY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>Graph<font color="#000080">;  </font><font color="#008000"><i>{ see test program at the end of this unit !! }

(***************************************************************************)
(*   Name: Graph                                                           *)
(*   Written by: William Hobday                                            *)
(*   Last Modified: September 6, 1991                                      *)
(*                                                                         *)
(*   Description:   This unit is an multilist implementation of a digraph. *)
(*   Each header node contains two lists: one conatining the arcs          *)
(*   emanating from the vertex, and the other terminating at that vertex.  *)
(*   The unit consists of the following documented procedures and          *)
(*   functions:                                                            *)
(*                        NewGraph : Graph                                 *)
(*                        NewVrtx( graph,name ) : vrtx                     *)
(*                        FirstSuccessor( name ) : name                    *)
(*                        NextSuccessor( name,name ) : name                *)
(*                        Adjacent( vrtx,vrtx ) : boolean                  *)
(*                        ArcWeight( vrtx,vrtx ) : weight                  *)
(*                        WtdJoin( vrtx,vrtx,weight )                      *)
(*                        RemoveArc( vrtx,vrtx )                           *)
(*                        PrintGraph( graph )                              *)
(*                        PrintArc( vrtx,vrtx )                            *)
(*                                                                         *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Interface

type  </b></font>Vertex <font color="#000080">= ^</font>Vertexpointer<font color="#000080">;
      </font>Arc <font color="#000080">= ^</font>Arcpointer<font color="#000080">;

      </font>Arcpointer <font color="#000080">= </font><font color="#FF0000"><b>record
            </b></font>Weight<font color="#000080">: </font>integer<font color="#000080">;
            </font>Vertex1<font color="#000080">,
            </font>Vertex2<font color="#000080">: </font>char<font color="#000080">;
            </font>Emanate<font color="#000080">,
            </font>Terminate<font color="#000080">: </font>Arc
         <font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>Vertexpointer <font color="#000080">= </font><font color="#FF0000"><b>record
            </b></font>Name<font color="#000080">: </font>char<font color="#000080">;
            </font>Emanate<font color="#000080">,
            </font>Terminate<font color="#000080">: </font>Arc<font color="#000080">;
            </font>Next<font color="#000080">: </font>Vertex<font color="#000080">;
            </font>Visited <font color="#000080">: </font>boolean
         <font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>NewGraph <font color="#000080">: </font>Vertex<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>NewVrtx<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name<font color="#000080">: </font>Char <font color="#000080">): </font>Vertex<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>FirstSuccessor<font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char <font color="#000080">) : </font>char<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>NextSuccessor<font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char<font color="#000080">; </font>Successor <font color="#000080">: </font>char <font color="#000080">) : </font>char<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetVertex <font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char <font color="#000080">) : </font>Vertex<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>ArcWeight<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">): </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WtdJoin<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex<font color="#000080">; </font>Weight <font color="#000080">: </font>integer <font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>RemoveArc<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>PrintGraph<font color="#000080">( </font>G <font color="#000080">: </font>Vertex <font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>PrintArc<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">);


</font><font color="#FF0000"><b>Implementation

</b></font><font color="#008000"><i>(***************************************************************************)
(*   Name: NewGraph                                                        *)
(*                                                                         *)
(*   Purposse: This Function returns a pointer to a new empty graph        *)
(*   Input: None                                                           *)
(*   Ouput: A pointer to a new graph                                       *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>NewGraph <font color="#000080">: </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>NewGraph <font color="#000080">:= </font><font color="#FF0000"><b>nil
end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: NewVertex                                                       *)
(*                                                                         *)
(*   Purpose: Adds a new unconnected vertex to the graph                   *)
(*   Uses: NewV - New vertex to be created                                 *)
(*         Temp - Used to search for end of list                           *)
(*   Input: G - Pointer to Graph                                           *)
(*          Name - Name of new vertex                                      *)
(*   Output: Pointer to newly created vertex                               *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>NewVrtx<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char <font color="#000080">) : </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>NewV<font color="#000080">,</font>Temp<font color="#000080">: </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>new<font color="#000080">( </font>NewV <font color="#000080">);
   </font>NewV<font color="#000080">^.</font>Name <font color="#000080">:= </font>Name<font color="#000080">;
   </font>NewV<font color="#000080">^.</font>Emanate <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
   </font>NewV<font color="#000080">^.</font>Terminate <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
   </font>NewV<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
   </font>NewV<font color="#000080">^.</font>Visited <font color="#000080">:= </font>false<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>G <font color="#000080">= </font><font color="#FF0000"><b>nil
      then </b></font>G <font color="#000080">:= </font>NewV
      <font color="#FF0000"><b>else begin
              </b></font>Temp <font color="#000080">:= </font>G<font color="#000080">;
              </font><font color="#FF0000"><b>while </b></font>Temp<font color="#000080">^.</font>Next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                 </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Next<font color="#000080">;
              </font>Temp<font color="#000080">^.</font>Next <font color="#000080">:= </font>NewV
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>NewVrtx <font color="#000080">:= </font>NewV
<font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: GetVertex                                                       *)
(*                                                                         *)
(*   Purpose: Given a graph and a vertex name it returns a pointer to the  *)
(*            vertex. Returns nil if vvertex doesn't exist.                *)
(*   Input: G - the graph                                                  *)
(*          Name - Name of vertex to find                                  *)
(*   Output: pointer to vertex found                                       *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>GetVertex<font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char<font color="#000080">) : </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   while </b></font><font color="#000080">( </font>G <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>G<font color="#000080">^.</font>Name <font color="#000080">&lt;&gt; </font>Name <font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>G <font color="#000080">:= </font>G<font color="#000080">^.</font>Next<font color="#000080">;
   </font>GetVertex <font color="#000080">:= </font>G
<font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: First Successor                                                 *)
(*                                                                         *)
(*   Purpose: Returns the first successor of the given vertex if it exists *)
(*   otherwise it returns a nul(ASCII 0).                                  *)
(*   Input: Name - Name of vertex from which the 1st successor is taken    *)
(*   Output: FirstSuccessor - name to the 1st successor of vertex          *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>FirstSuccessor <font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char <font color="#000080">) : </font>char<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>V <font color="#000080">: </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>V <font color="#000080">:= </font>GetVertex<font color="#000080">( </font>G<font color="#000080">,</font>Name <font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>V <font color="#000080">= </font><font color="#FF0000"><b>nil
      then </b></font>FirstSuccessor <font color="#000080">:= </font><font color="#800000">#0
      </font><font color="#FF0000"><b>else if </b></font>V<font color="#000080">^.</font>Emanate <font color="#000080">= </font><font color="#FF0000"><b>nil
              then </b></font>FirstSuccessor <font color="#000080">:= </font><font color="#800000">#0
              </font><font color="#FF0000"><b>else </b></font>FirstSuccessor <font color="#000080">:= </font>V<font color="#000080">^.</font>Emanate<font color="#000080">^.</font>Vertex2
<font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: NextSuccessor                                                   *)
(*                                                                         *)
(*   Purpose: Given a vertex and a successor, this returns the next        *)
(*            successor.  Returns the first successor if input parameters  *)
(*            are identical.  Returns nul if does not exist.               *)
(*   Input: G - pointer to list of vertices                                *)
(*          V - Name of vertex from which to find next successor           *)
(*          Name - Name of vertex next successor is to follow              *)
(*   Output: NextSuccessor - Name of the next successor                    *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>NextSuccessor<font color="#000080">( </font>G <font color="#000080">: </font>Vertex<font color="#000080">; </font>Name <font color="#000080">: </font>char<font color="#000080">; </font>Successor <font color="#000080">: </font>char <font color="#000080">) : </font>char<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>TempArc <font color="#000080">: </font>Arc<font color="#000080">;
    </font>V <font color="#000080">: </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>V <font color="#000080">:= </font>GetVertex<font color="#000080">( </font>G<font color="#000080">,</font>Name <font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>v <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil
      then if </b></font>V<font color="#000080">^.</font>Name <font color="#000080">= </font>Successor
              <font color="#FF0000"><b>then </b></font>NextSuccessor <font color="#000080">:= </font>FirstSuccessor<font color="#000080">( </font>G<font color="#000080">,</font>Successor <font color="#000080">)
              </font><font color="#FF0000"><b>else begin
                      </b></font>TempArc <font color="#000080">:= </font>V<font color="#000080">^.</font>Emanate<font color="#000080">;
                      </font><font color="#FF0000"><b>while </b></font><font color="#000080">( </font>TempArc<font color="#000080">^.</font>Vertex2 <font color="#000080">&lt;&gt; </font>Successor <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>TempArc <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>do
                         </b></font>TempArc <font color="#000080">:=  </font>TempArc<font color="#000080">^.</font>Emanate<font color="#000080">;
                      </font><font color="#FF0000"><b>if </b></font>TempArc <font color="#000080">= </font><font color="#FF0000"><b>nil
                         then </b></font>NextSuccessor <font color="#000080">:= </font><font color="#800000">#0
                         </font><font color="#FF0000"><b>else if </b></font>TempArc<font color="#000080">^.</font>Emanate <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil
                                 then </b></font>NextSuccessor <font color="#000080">:= </font>TempArc<font color="#000080">^.</font>Emanate<font color="#000080">^.</font>Vertex2
                                 <font color="#FF0000"><b>else </b></font>NextSuccessor <font color="#000080">:= </font><font color="#800000">#0
                   </font><font color="#FF0000"><b>end
      else </b></font>NextSuccessor <font color="#000080">:= </font><font color="#800000">#0
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: Adjacent                                                        *)
(*                                                                         *)
(*   Purpose: Boolean function which returns true if given vertices are    *)
(*            adjacent.                                                    *)
(*   Input: V1,V2 - Vertices to check for arc                              *)
(*   Output: Adjacent - Result of function                                 *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">) : </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>TempArc <font color="#000080">: </font>Arc<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">( </font>V1<font color="#000080">^.</font>Emanate <font color="#000080">= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">)  </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>V2<font color="#000080">^.</font>Emanate <font color="#000080">= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>V1 <font color="#000080">= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>v2 <font color="#000080">=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>Adjacent <font color="#000080">:= </font>false
      <font color="#FF0000"><b>else begin
              </b></font>TempArc <font color="#000080">:= </font>V1<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>TempArc <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>V2<font color="#000080">^.</font>Name <font color="#000080">&lt;&gt; </font>TempArc<font color="#000080">^.</font>Vertex2<font color="#000080">) </font><font color="#FF0000"><b>do
                 </b></font>TempArc <font color="#000080">:= </font>TempArc<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>TempArc<font color="#000080">^.</font>Vertex2 <font color="#000080">= </font>V2<font color="#000080">^.</font>Name
                 <font color="#FF0000"><b>then </b></font>Adjacent <font color="#000080">:= </font>true
                 <font color="#FF0000"><b>else </b></font>Adjacent <font color="#000080">:= </font>false
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: ArcWeight                                                       *)
(*                                                                         *)
(*   Purpose: Returns the weight of the arc between V1 and V2 providing    *)
(*            that it exists.  Returns a Zero otherwise.                   *)
(*   Input: V1,V2 - vertices to check for arc                              *)
(*   Output: ArcWeight - the weight of the arc if it exists                *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Function </b></font>ArcWeight<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">) : </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>TempV <font color="#000080">: </font>Arc<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">( </font>V1<font color="#000080">^.</font>Emanate <font color="#000080">= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>V2<font color="#000080">^.</font>Terminate <font color="#000080">= </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font><font color="#FF0000"><b>not </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">) )
      </font><font color="#FF0000"><b>then </b></font>ArcWeight <font color="#000080">:= </font><font color="#800000">0
      </font><font color="#FF0000"><b>else begin
              </b></font>TempV <font color="#000080">:= </font>V1<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>V2<font color="#000080">^.</font>Name <font color="#000080">&lt;&gt; </font>TempV<font color="#000080">^.</font>Vertex2<font color="#000080">) </font><font color="#FF0000"><b>do
                 </b></font>TempV <font color="#000080">:= </font>TempV<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font>ArcWeight <font color="#000080">:= </font>TempV<font color="#000080">^.</font>Weight
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: WtdJoin                                                         *)
(*                                                                         *)
(*   Purpose: Creates a weighted arc between V1 and V2 of weight Weight    *)
(*   Input: V1,V2 - Vertices to connect                                    *)
(*          Weight - the weight of the new arc                             *)
(*   Output: None                                                          *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>WtdJoin<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex<font color="#000080">; </font>Weight <font color="#000080">: </font>Integer <font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>NewArc<font color="#000080">, </font>Temp <font color="#000080">: </font>Arc<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if not </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">)
      </font><font color="#FF0000"><b>then begin
              </b></font>New<font color="#000080">( </font>NewArc <font color="#000080">);
              </font>NewArc<font color="#000080">^.</font>Weight <font color="#000080">:= </font>Weight<font color="#000080">;
              </font>NewArc<font color="#000080">^.</font>Vertex1 <font color="#000080">:= </font>V1<font color="#000080">^.</font>Name<font color="#000080">;
              </font>NewArc<font color="#000080">^.</font>Vertex2 <font color="#000080">:= </font>V2<font color="#000080">^.</font>Name<font color="#000080">;
              </font>NewArc<font color="#000080">^.</font>Emanate <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font>NewArc<font color="#000080">^.</font>Terminate <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
              </font>Temp <font color="#000080">:= </font>V1<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>Temp <font color="#000080">= </font><font color="#FF0000"><b>nil
                 then </b></font>V1<font color="#000080">^.</font>Emanate <font color="#000080">:= </font>NewArc
                 <font color="#FF0000"><b>else begin
                         while </b></font>Temp<font color="#000080">^.</font>Emanate <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Emanate<font color="#000080">;
                         </font>Temp<font color="#000080">^.</font>Emanate <font color="#000080">:= </font>NewArc<font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>Temp <font color="#000080">:= </font>V2<font color="#000080">^.</font>Terminate<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>Temp <font color="#000080">= </font><font color="#FF0000"><b>nil
                 then </b></font>V2<font color="#000080">^.</font>Terminate <font color="#000080">:= </font>NewArc
                 <font color="#FF0000"><b>else begin
                         while </b></font>Temp<font color="#000080">^.</font>Terminate <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Terminate<font color="#000080">;
                         </font>Temp<font color="#000080">^.</font>Terminate <font color="#000080">:= </font>NewArc<font color="#000080">;
                      </font><font color="#FF0000"><b>end
           end
end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: RemoveArc                                                       *)
(*                                                                         *)
(*   Purpose: Removes the Arc from V1 to V2 if it exists                   *)
(*   Input: V1,V2 - Vertices of arc to be removed                          *)
(*   Output: None                                                          *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>RemoveArc<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Temp<font color="#000080">,</font>Temp2 <font color="#000080">: </font>Arc<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">)
      </font><font color="#FF0000"><b>then begin
              </b></font>Temp <font color="#000080">:= </font>V1<font color="#000080">^.</font>Emanate<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>Temp<font color="#000080">^.</font>Vertex2 <font color="#000080">= </font>V2<font color="#000080">^.</font>Name
                 <font color="#FF0000"><b>then </b></font>V1<font color="#000080">^.</font>Emanate <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Emanate
                 <font color="#FF0000"><b>else begin
                         while </b></font>Temp<font color="#000080">^.</font>Emanate<font color="#000080">^.</font>Vertex2 <font color="#000080">&lt;&gt; </font>V2<font color="#000080">^.</font>Name <font color="#FF0000"><b>do
                            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Emanate<font color="#000080">;
                         </font>Temp2 <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Emanate<font color="#000080">;
                         </font>Temp<font color="#000080">^.</font>Emanate <font color="#000080">:= </font>Temp2<font color="#000080">^.</font>Emanate
                      <font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>Temp <font color="#000080">:= </font>V2<font color="#000080">^.</font>Terminate<font color="#000080">;
              </font><font color="#FF0000"><b>if </b></font>Temp<font color="#000080">^.</font>Vertex1 <font color="#000080">= </font>V1<font color="#000080">^.</font>Name
                 <font color="#FF0000"><b>then </b></font>V2<font color="#000080">^.</font>Terminate <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Terminate
                 <font color="#FF0000"><b>else begin
                         while </b></font>Temp<font color="#000080">^.</font>Terminate<font color="#000080">^.</font>Vertex1 <font color="#000080">&lt;&gt; </font>V1<font color="#000080">^.</font>Name <font color="#FF0000"><b>do
                            </b></font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Terminate<font color="#000080">;
                         </font>Temp2 <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Terminate<font color="#000080">;
                         </font>Temp<font color="#000080">^.</font>Terminate <font color="#000080">:= </font>Temp2<font color="#000080">^.</font>Terminate
                      <font color="#FF0000"><b>end
           end
end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: PrintGraph                                                      *)
(*                                                                         *)
(*   Purpose: Prints an adjacency matrix for the graph                     *)
(*   Input: G - First Vertex in linked vertex list of graph                *)
(*   Output: Copy of the adjacency matrix for the graph                    *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>PrintGraph<font color="#000080">( </font>G<font color="#000080">: </font>Vertex <font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>Temp<font color="#000080">,</font>Temp2 <font color="#000080">: </font>Vertex<font color="#000080">;
    </font>Count<font color="#000080">,</font>Loop <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
   if </b></font>G <font color="#000080">= </font><font color="#FF0000"><b>nil
      then </b></font>writeln<font color="#000080">(</font><font color="#800000">'The Graph does not exist!'</font><font color="#000080">)
      </font><font color="#FF0000"><b>else begin
              </b></font>Count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
              </font>Temp <font color="#000080">:= </font>G<font color="#000080">;
              </font>write<font color="#000080">(</font><font color="#800000">'    '</font><font color="#000080">);
              </font><font color="#FF0000"><b>while </b></font>Temp <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                 begin
                    </b></font>write<font color="#000080">(</font>Temp<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
                    </font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Next<font color="#000080">;
                    </font>inc<font color="#000080">(</font>Count<font color="#000080">)
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>writeln<font color="#000080">;
              </font>write<font color="#000080">(</font><font color="#800000">'  &Uacute;&Auml;'</font><font color="#000080">);
              </font><font color="#FF0000"><b>for </b></font>Loop <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Count <font color="#FF0000"><b>do
                 </b></font>write<font color="#000080">(</font><font color="#800000">'&Auml;&Auml;'</font><font color="#000080">);
              </font>writeln<font color="#000080">;
              </font>Temp <font color="#000080">:= </font>G<font color="#000080">;
              </font><font color="#FF0000"><b>while </b></font>Temp <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                 begin
                    </b></font>Temp2 <font color="#000080">:= </font>G<font color="#000080">;
                    </font>write<font color="#000080">(</font>Temp<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">' &sup3;'</font><font color="#000080">);
                    </font><font color="#FF0000"><b>while </b></font>Temp2 <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
                       begin
                          if </b></font>adjacent<font color="#000080">( </font>Temp<font color="#000080">,</font>Temp2 <font color="#000080">)
                             </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">' 1'</font><font color="#000080">)
                             </font><font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font><font color="#800000">' 0'</font><font color="#000080">);
                          </font>Temp2 <font color="#000080">:= </font>Temp2<font color="#000080">^.</font>Next<font color="#000080">;
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                    </font>Temp <font color="#000080">:= </font>Temp<font color="#000080">^.</font>Next<font color="#000080">;
                    </font>writeln
                 <font color="#FF0000"><b>end
           end
end</b></font><font color="#000080">;



</font><font color="#008000"><i>(***************************************************************************)
(*   Name: PrintArc                                                        *)
(*                                                                         *)
(*   Purpose: Prints the name and weight of the arc between V1 and V2      *)
(*   Input: V1,V2 - Vertices of the arc to be printed                      *)
(*   Output: Name and weight of the arc                                    *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Procedure </b></font>PrintArc<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">: </font>Vertex <font color="#000080">);

</font><font color="#FF0000"><b>begin
   if </b></font>Adjacent<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">)
      </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">( </font>V1<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>V2<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>ArcWeight<font color="#000080">( </font>V1<font color="#000080">,</font>V2 <font color="#000080">))
      </font><font color="#FF0000"><b>else </b></font>writeln<font color="#000080">(</font><font color="#800000">'PrintArc Error --- Arc '</font><font color="#000080">,</font>V1<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>V2<font color="#000080">^.</font>Name<font color="#000080">,</font><font color="#800000">' does not exist ---'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------  DEMO  -----------  CUT HERE --------- }

</i></font><font color="#FF0000"><b>Program </b></font>Testgraph<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>graph<font color="#000080">,</font>crt<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">,</font>B<font color="#000080">,</font>C<font color="#000080">,</font>D<font color="#000080">,</font>E<font color="#000080">,</font>F<font color="#000080">,</font>Ga<font color="#000080">,</font>H<font color="#000080">,</font>I<font color="#000080">,</font>J<font color="#000080">,</font>temp <font color="#000080">: </font>Vertex<font color="#000080">;
    </font>sh <font color="#000080">: </font>arc<font color="#000080">;
    </font>ch <font color="#000080">: </font>char<font color="#000080">;
    </font>x<font color="#000080">: </font>integer<font color="#000080">;
    </font>G<font color="#000080">: </font>Vertex<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>clrscr<font color="#000080">;
   </font>G <font color="#000080">:= </font>NewGraph<font color="#000080">;
   </font>ch <font color="#000080">:= </font><font color="#800000">'A'</font><font color="#000080">;
   </font>A <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>G<font color="#000080">,</font>CH<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'B'</font><font color="#000080">;
   </font>B <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>G<font color="#000080">,</font>CH<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'C'</font><font color="#000080">;
   </font>C <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'D'</font><font color="#000080">;
   </font>D <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'E'</font><font color="#000080">;
   </font>E <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>G<font color="#000080">,</font>CH<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'F'</font><font color="#000080">;
   </font>F <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>G<font color="#000080">,</font>CH<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'G'</font><font color="#000080">;
   </font>Ga <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'H'</font><font color="#000080">;
   </font>H <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'I'</font><font color="#000080">;
   </font>I <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>ch <font color="#000080">:= </font><font color="#800000">'J'</font><font color="#000080">;
   </font>J <font color="#000080">:= </font>NewVrtx<font color="#000080">(</font>g<font color="#000080">,</font>ch<font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>A<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>B<font color="#000080">,</font>A<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>B<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>C<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>C<font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>D<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>E<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>F<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>Ga<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>Ga<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>H<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>I<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>A<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>E<font color="#000080">,</font>A<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>E<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>H<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>H<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>J<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>B<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>F<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>F<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>I<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>C<font color="#000080">,</font>Ga<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>Ga<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>D<font color="#000080">,</font>Ga<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>Ga<font color="#000080">,</font>D<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>Ga<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>I<font color="#000080">,</font>Ga<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>I<font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>J<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>C<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>F<font color="#000080">,</font>C<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>H<font color="#000080">,</font>F<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>F<font color="#000080">,</font>H<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
   </font>wtdjoin<font color="#000080">(</font>B<font color="#000080">,</font>E<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">);
   </font>WtdJoin<font color="#000080">(</font>e<font color="#000080">,</font>B<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">) ;
   </font>writeln<font color="#000080">(</font>FirstSuccessor<font color="#000080">(</font>G<font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">)^.</font>name<font color="#000080">);
   </font>writeln<font color="#000080">(</font>NextSuccessor<font color="#000080">(</font>G<font color="#000080">,</font>f<font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">)^.</font>name<font color="#000080">);
   </font>PrintGraph<font color="#000080">(</font>G<font color="#000080">);
</font><font color="#008000"><i>{   while G &lt;&gt; nil do
      begin
         writeln('Vertix ',G^.Name);
         sh:=g^.emanate;
         while sh&lt;&gt;nil do
            begin
               write(sh^.vertex1,',',sh^.vertex2,' ',sh^.weight,'   ');
               sh := sh^.emanate;
            end;
         Writeln;
         G := G^.Next
      end}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0127.PAS">Original</a><b>]</b></p></body>
</html>
