<html>
<head><title> "High Precision BCD Math" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>AJCBCD<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>Objects<font color="#000080">, </font>Strings<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>DigitSize <font color="#000080">= </font>SizeOf<font color="#000080">(</font>Byte<font color="#000080">);
  </font>bpw_Fixed <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>bpw_Variable <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>bpz_Blank <font color="#000080">= </font>True<font color="#000080">;
  </font>bpz_NotBlank <font color="#000080">= </font>False<font color="#000080">;
  </font>MaxBCDSize <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
  </font>st_Blanks25 <font color="#000080">= </font><font color="#800000">'                         '</font><font color="#000080">;
  </font>st_Blanks <font color="#000080">= </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25
            <font color="#000080">+ </font>st_Blanks25<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PBCDArray <font color="#000080">= ^</font>TBCDArray<font color="#000080">;
  </font>TBCDArray <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxBCDSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

  </font>TBCDSign <font color="#000080">= (</font>BCDNegative<font color="#000080">, </font>BCDPositive<font color="#000080">);

  </font>PBCD <font color="#000080">= ^</font>TBCD<font color="#000080">;
  </font>TBCD <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TObject<font color="#000080">)
    </font>BCDSize<font color="#000080">:  </font>Integer<font color="#000080">;
    </font>Sign<font color="#000080">:  </font>TBCDSign<font color="#000080">;
    </font>Value<font color="#000080">:  </font>PBCDArray<font color="#000080">;
    </font>Precision<font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>constructor </b></font>InitReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>constructor </b></font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Load<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Store<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>GetValue<font color="#000080">: </font>PBCDArray<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetSign<font color="#000080">: </font>TBCDSign<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetPrecision<font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetBCDSize<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetValueBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetValueReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetValuePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetSign<font color="#000080">(</font>ASign<font color="#000080">: </font>TBCDSign<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetPrecision<font color="#000080">(</font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetBCDSize<font color="#000080">(</font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AddBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AddReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AddPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SubtractBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SubtractReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SubtractPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>MultiplyByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>MultiplyByReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>MultiplyByPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>DivideByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>DivideByReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>DivideByPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AbsoluteValue<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Increment<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Decrement<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>ShiftLeft<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>ShiftRight<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>BCD2Int<font color="#000080">: </font>LongInt<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>BCD2Real<font color="#000080">: </font>Real<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>PicStr<font color="#000080">(</font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                    </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>StrPic<font color="#000080">(</font>dest<font color="#000080">: </font>PChar<font color="#000080">; </font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                    </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">;
                    </font>Size<font color="#000080">: </font>Integer<font color="#000080">): </font>PChar<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CompareBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">): </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CompareReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>ComparePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">): </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const

  </b></font>RBCD<font color="#000080">:  </font>TStreamRec <font color="#000080">= (</font>ObjType<font color="#000080">:  </font><font color="#800000">60000</font><font color="#000080">;
                       </font>VmtLink<font color="#000080">:  </font>Ofs<font color="#000080">(</font>TypeOf<font color="#000080">(</font>TBCD<font color="#000080">)^);
                       </font>Load<font color="#000080">:     @</font>TBCD<font color="#000080">.</font>Load<font color="#000080">;
                       </font>Store<font color="#000080">:    @</font>TBCD<font color="#000080">.</font>Store<font color="#000080">);

</font><font color="#FF0000"><b>var
  </b></font>BCDZero<font color="#000080">:  </font>PBCD<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{BCDAdd is a subroutine that adds the value in BCD2 to the value in   }
{BCD1.  It is a simple magnitude addition, as if the two numbers have }
{the same sign.  BCDAdd makes the following assumptions:              }
{  1) the calling routine will manage the proper sign of the result   }
{     of the addition.                                                }
{  2) the BCDSize of the two operands are equal                       }
{  3) the Precision of the two operands are equal                     }
</i></font><font color="#FF0000"><b>procedure </b></font>BCDAdd<font color="#000080">(</font>BCD1<font color="#000080">, </font>BCD2<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
  </font>Carry<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Carry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>BCD1<font color="#000080">^.</font>BCDSize <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] + </font>BCD2<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] + </font>Carry<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] &gt; </font><font color="#800000">9 </font><font color="#FF0000"><b>then
        begin
          </b></font>dec<font color="#000080">(</font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">], </font><font color="#800000">10</font><font color="#000080">);
          </font>Carry <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        </b></font>Carry <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{BCDSubtraction is a subroutine that subtracts the value in BCD2 from  }
{the value in BCD1.  It is a simple magnitude subtraction, without     }
{regard to the sign of the operands.  BCDSubtract makes the following  }
{assumptions:                                                          }
{  1) the calling routine will manage the proper sign of the result    }
{     of the subtraction.                                              }
{  2) the BCDSize of the two operands are equal                        }
{  3) the Precision of the two operands are equal                      }
{  4) the magnitude of the value in BCD2 is less than or equal to the  }
{     magnitude of the value in BCD1 so that the routine can perform   }
{     a simple byte by byte subtraction                                }
</i></font><font color="#FF0000"><b>procedure </b></font>BCDSubtract<font color="#000080">(</font>BCD1<font color="#000080">, </font>BCD2<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
  </font>Borrow<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Borrow <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>BCD1<font color="#000080">^.</font>GetBCDSize <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] + </font><font color="#800000">10 </font><font color="#000080">- </font>BCD2<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] - </font>Borrow<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] &gt;  </font><font color="#800000">9 </font><font color="#FF0000"><b>then
        begin
          </b></font>dec<font color="#000080">(</font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">], </font><font color="#800000">10</font><font color="#000080">);
          </font>Borrow <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        </b></font>Borrow <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TBCD<font color="#000080">.</font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Init<font color="#000080">;
  </font>BCDSize <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>Value<font color="#000080">, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>Precision <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetPrecision<font color="#000080">;
  </font>SetValueBCD<font color="#000080">(</font>AVal<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TBCD<font color="#000080">.</font>InitReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Init<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ASize <font color="#000080">&gt; </font>MaxBCDSize <font color="#FF0000"><b>then
    </b></font>BCDSize <font color="#000080">:= </font>MaxBCDSize
  <font color="#FF0000"><b>else
    </b></font>BCDSize <font color="#000080">:= </font>ASize<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>Value<font color="#000080">, </font>ASize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>Precision <font color="#000080">:= </font>APrec<font color="#000080">;
  </font>SetValueReal<font color="#000080">(</font>AVal<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TBCD<font color="#000080">.</font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Init<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ASize <font color="#000080">&gt; </font>MaxBCDSize <font color="#FF0000"><b>then
    </b></font>BCDSize <font color="#000080">:= </font>MaxBCDSize
  <font color="#FF0000"><b>else
    </b></font>BCDSize <font color="#000080">:= </font>ASize<font color="#000080">;
  </font>GetMem<font color="#000080">(</font>Value<font color="#000080">, </font>ASize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>Precision <font color="#000080">:= </font>APrec<font color="#000080">;
  </font>SetValuePChar<font color="#000080">(</font>AVal<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TBCD<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font><font color="#FF0000"><b>inherited </b></font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TBCD<font color="#000080">.</font>Load<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>S<font color="#000080">.</font>Read<font color="#000080">(</font>BCDSize<font color="#000080">, </font>SizeOf<font color="#000080">(</font>BCDSize<font color="#000080">));
  </font>S<font color="#000080">.</font>Read<font color="#000080">(</font>Sign<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Sign<font color="#000080">));
  </font>GetMem<font color="#000080">(</font>Value<font color="#000080">, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>S<font color="#000080">.</font>Read<font color="#000080">(</font>Value<font color="#000080">^, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>S<font color="#000080">.</font>Read<font color="#000080">(</font>Precision<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Precision<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>Store<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>S<font color="#000080">.</font>Write<font color="#000080">(</font>BCDSize<font color="#000080">, </font>SizeOf<font color="#000080">(</font>BCDSize<font color="#000080">));
  </font>S<font color="#000080">.</font>Write<font color="#000080">(</font>Sign<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Sign<font color="#000080">));
  </font>S<font color="#000080">.</font>Write<font color="#000080">(</font>Value<font color="#000080">^, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>S<font color="#000080">.</font>Write<font color="#000080">(</font>Precision<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Precision<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>GetValue<font color="#000080">: </font>PBCDArray<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">:  </font>PBCDArray<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetMem<font color="#000080">(</font>WrkValue<font color="#000080">, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>Move<font color="#000080">(</font>Value<font color="#000080">^, </font>WrkValue<font color="#000080">^, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>GetValue <font color="#000080">:= </font>WrkValue<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>GetSign<font color="#000080">: </font>TBCDSign<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetSign <font color="#000080">:= </font>Sign<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>GetPrecision<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetPrecision <font color="#000080">:= </font>Precision<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>GetBCDSize<font color="#000080">:  </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetBCDSize <font color="#000080">:= </font>BCDSize<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetValueBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>SaveSize<font color="#000080">:  </font>Integer<font color="#000080">;
  </font>SavePrecision<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);

  </font>SaveSize <font color="#000080">:= </font>GetBCDSize<font color="#000080">;
  </font>SavePrecision <font color="#000080">:= </font>GetPrecision<font color="#000080">;

  </font>Value <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetValue<font color="#000080">;
  </font>BCDSize <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">;
  </font>Precision <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetPrecision<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Precision <font color="#000080">&gt; </font>SavePrecision <font color="#FF0000"><b>then
    begin
      </b></font>SetBCDSize<font color="#000080">(</font>SaveSize<font color="#000080">);
      </font>SetPrecision<font color="#000080">(</font>SavePrecision<font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>SetPrecision<font color="#000080">(</font>SavePrecision<font color="#000080">);
      </font>SetBCDSize<font color="#000080">(</font>SaveSize<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>SetSign<font color="#000080">(</font>AVal<font color="#000080">^.</font>GetSign<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetSign<font color="#000080">(</font>ASign<font color="#000080">: </font>TBCDSign<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Sign <font color="#000080">:= </font>BCDPositive<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>ASign <font color="#000080">= </font>BCDPositive <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font><font color="#008000"><i>{allow negative sign only if value is non-zero}
  </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>GetBCDSize <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font>Value<font color="#000080">^[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      begin
        </b></font>Sign <font color="#000080">:= </font>BCDNegative<font color="#000080">;
        </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetValueReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>BCDIndex<font color="#000080">:  </font>integer<font color="#000080">;
  </font>ValStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Value<font color="#000080">^, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);

  </font>Str<font color="#000080">(</font>abs<font color="#000080">(</font>AVal<font color="#000080">):</font>BCDSize<font color="#000080">:</font>Precision<font color="#000080">, </font>ValStr<font color="#000080">);
  </font>BCDIndex <font color="#000080">:= </font>BCDSize<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:=</font>length<font color="#000080">(</font>ValStr<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font>ValStr<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      begin
        </b></font>Value<font color="#000080">^[</font>BCDIndex<font color="#000080">] := </font>ord<font color="#000080">(</font>ValStr<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
        </font>dec<font color="#000080">(</font>BCDIndex<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>AVal <font color="#000080">&lt; </font><font color="#800000">0.0 </font><font color="#FF0000"><b>then
    </b></font>SetSign<font color="#000080">(</font>BCDNegative<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetSign<font color="#000080">(</font>BCDPositive<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetValuePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>BCDIndex<font color="#000080">:  </font>integer<font color="#000080">;
  </font>SavePrec<font color="#000080">: </font>Byte<font color="#000080">;
  </font>SaveSign<font color="#000080">: </font>TBCDSign<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font>SaveSign <font color="#000080">:= </font>BCDPositive<font color="#000080">;
  </font>SavePrec <font color="#000080">:= </font>Precision<font color="#000080">;
  </font>Precision <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font>FillChar<font color="#000080">(</font>Value<font color="#000080">^, </font>BCDSize<font color="#000080">*</font>DigitSize<font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>StrLen<font color="#000080">(</font>AVal<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font>BCDIndex <font color="#000080">:= </font>BCDSize<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>StrLen<font color="#000080">(</font>AVal<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
    case </b></font>AVal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">:     </font><font color="#FF0000"><b>begin
                      </b></font>Value<font color="#000080">^[</font>BCDIndex<font color="#000080">] := </font>ord<font color="#000080">(</font>AVal<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
                      </font>dec<font color="#000080">(</font>BCDIndex<font color="#000080">);
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">'('</font><font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">:  </font><font color="#FF0000"><b>begin
                      </b></font>SaveSign <font color="#000080">:= </font>BCDNegative<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">'.'</font><font color="#000080">:          </font><font color="#FF0000"><b>begin
                      </b></font>Precision <font color="#000080">:= </font>BCDSize <font color="#000080">- </font>BCDIndex<font color="#000080">;
                    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{case}

  </i></font>SetPrecision<font color="#000080">(</font>SavePrec<font color="#000080">);
  </font>SetSign<font color="#000080">(</font>SaveSign<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetPrecision<font color="#000080">(</font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>APrec <font color="#000080">= </font>Precision <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>APrec <font color="#000080">&lt; </font>Precision <font color="#FF0000"><b>then
    </b></font>ShiftRight<font color="#000080">(</font>Precision <font color="#000080">- </font>APrec<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>ShiftLeft<font color="#000080">(</font>APrec <font color="#000080">- </font>Precision<font color="#000080">);
  </font>Precision <font color="#000080">:= </font>APrec<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SetBCDSize<font color="#000080">(</font>ASize<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>SaveSize<font color="#000080">:  </font>Integer<font color="#000080">;
  </font>WrkVal<font color="#000080">:  </font>PBCDArray<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ASize <font color="#000080">= </font>GetBCDSize <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>ASize <font color="#000080">&gt; </font>MaxBCDSize <font color="#FF0000"><b>then </b></font>ASize <font color="#000080">:= </font>MaxBCDSize<font color="#000080">;

  </font>GetMem<font color="#000080">(</font>WrkVal<font color="#000080">, </font>ASize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>FillChar<font color="#000080">(</font>WrkVal<font color="#000080">^, </font>ASize<font color="#000080">*</font>DigitSize<font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>ASize <font color="#000080">&lt; </font>GetBCDSize <font color="#FF0000"><b>then
    </b></font>Move<font color="#000080">(</font>Value<font color="#000080">^[(</font>GetBCDSize<font color="#000080">-</font>ASize<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">], </font>WrkVal<font color="#000080">^, </font>ASize<font color="#000080">*</font>DigitSize<font color="#000080">)
  </font><font color="#FF0000"><b>else if </b></font>ASize <font color="#000080">&gt; </font>GetBCDSize <font color="#FF0000"><b>then
    </b></font>Move<font color="#000080">(</font>Value<font color="#000080">^, </font>WrkVal<font color="#000080">^[(</font>ASize<font color="#000080">-</font>GetBCDSize<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">], </font>GetBCDSize<font color="#000080">);

  </font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>GetBCDSize<font color="#000080">*</font>DigitSize<font color="#000080">);
  </font>Value <font color="#000080">:= </font>WrkVal<font color="#000080">;
  </font>BCDSize <font color="#000080">:= </font>ASize<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>AddBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">:  </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">));
  </font>WrkValue<font color="#000080">^.</font>SetPrecision<font color="#000080">(</font>Precision<font color="#000080">);
  </font>WrkValue<font color="#000080">^.</font>SetBCDSize<font color="#000080">(</font>BCDSize<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">&lt;&gt; </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    if </b></font>AVal<font color="#000080">^.</font>GetSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
      begin
        </b></font>WrkValue<font color="#000080">^.</font>AbsoluteValue<font color="#000080">;
        </font>BCDSubtract<font color="#000080">(@</font>Self<font color="#000080">, </font>WrkValue<font color="#000080">);
        </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
        </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
      </b></font><font color="#008000"><i>{AVal^.GetSign = BCDPositive}
      </i></font><font color="#FF0000"><b>begin
        </b></font>AbsoluteValue<font color="#000080">;
        </font>BCDSubtract<font color="#000080">(</font>WrkValue<font color="#000080">, @</font>Self<font color="#000080">);
        </font>SetValueBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
        </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
        </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>BCDAdd<font color="#000080">(@</font>Self<font color="#000080">, </font>WrkValue<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>AddReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>AddBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>AddPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>WrkValue<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>AddBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SubtractBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">:  </font>PBCD<font color="#000080">;
  </font>SaveSign<font color="#000080">:  </font>TBCDSign<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">));
  </font>WrkValue<font color="#000080">^.</font>SetPrecision<font color="#000080">(</font>GetPrecision<font color="#000080">);
  </font>WrkValue<font color="#000080">^.</font>SetBCDSize<font color="#000080">(</font>GetBCDSize<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">&lt;&gt; </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    begin
      </b></font>WrkValue<font color="#000080">^.</font>SetSign<font color="#000080">(</font>Sign<font color="#000080">);
      </font>BCDAdd<font color="#000080">(@</font>Self<font color="#000080">, </font>WrkValue<font color="#000080">);
      </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>SaveSign <font color="#000080">:= </font>Sign<font color="#000080">;
  </font>AbsoluteValue<font color="#000080">;
  </font>WrkValue<font color="#000080">^.</font>AbsoluteValue<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>CompareBCD<font color="#000080">(</font>WrkValue<font color="#000080">) &lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>BCDSubtract<font color="#000080">(</font>WrkValue<font color="#000080">, @</font>Self<font color="#000080">);
      </font>SetValueBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>SaveSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
        </b></font>SetSign<font color="#000080">(</font>BCDPositive<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>SetSign<font color="#000080">(</font>BCDNegative<font color="#000080">);
    </font><font color="#FF0000"><b>end
  else
    begin
      </b></font>BCDSubtract<font color="#000080">(@</font>Self<font color="#000080">, </font>WrkValue<font color="#000080">);
      </font>SetSign<font color="#000080">(</font>SaveSign<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SubtractReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>SubtractBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>SubtractPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkValue<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>SubtractBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkValue<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>MultiplyByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>NewSign<font color="#000080">:  </font>TBCDSign<font color="#000080">;
  </font>WrkValue<font color="#000080">:  </font>PBCD<font color="#000080">;
  </font>HighDigit<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">:  </font>integer<font color="#000080">;
  </font>SavePrec<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">= </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    </b></font>NewSign <font color="#000080">:= </font>BCDPositive
  <font color="#FF0000"><b>else
    </b></font>NewSign <font color="#000080">:= </font>BCDNegative<font color="#000080">;
  </font>AbsoluteValue<font color="#000080">;

  </font>SavePrec <font color="#000080">:= </font>Precision<font color="#000080">;
  </font>WrkValue <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>GetBCDSize <font color="#000080">+ </font>AVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">));
  </font>Precision <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt; </font>AVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>AVal<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font>HighDigit <font color="#000080">:= </font>i<font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>AVal<font color="#000080">^.</font>GetBCDSize <font color="#FF0000"><b>downto </b></font>HighDigit <font color="#FF0000"><b>do
    begin
      if </b></font>AVal<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>AVal<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
          </b></font>WrkValue<font color="#000080">^.</font>AddBCD<font color="#000080">(@</font>Self<font color="#000080">);
      </font>ShiftLeft<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WrkValue<font color="#000080">^.</font>Precision <font color="#000080">:= </font>SavePrec <font color="#000080">+ </font>AVal<font color="#000080">^.</font>GetPrecision<font color="#000080">;
  </font>WrkValue<font color="#000080">^.</font>SetPrecision<font color="#000080">(</font>SavePrec<font color="#000080">);
  </font>Precision <font color="#000080">:= </font>SavePrec<font color="#000080">;
  </font>SetValueBCD<font color="#000080">(</font>WrkValue<font color="#000080">);
  </font>SetSign<font color="#000080">(</font>NewSign<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>MultiplyByReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">:  </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font>AVal<font color="#000080">, </font>APrec<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>MultiplyByBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>MultiplyByPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">:  </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">, </font>APrec<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>MultiplyByBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>DivideByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>NewSign<font color="#000080">:  </font>TBCDSign<font color="#000080">;
  </font>WrkVal<font color="#000080">, </font>WrkDiv<font color="#000080">, </font>WrkQuo<font color="#000080">:  </font>PBCD<font color="#000080">;
  </font>HighDigit<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>IterationCount<font color="#000080">:  </font>integer<font color="#000080">;
  </font>TempPrec<font color="#000080">, </font>QuotientPrec<font color="#000080">:  </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>AVal<font color="#000080">^.</font>CompareReal<font color="#000080">(</font><font color="#800000">0.0</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;  </font><font color="#008000"><i>{avoid zero divide}

  </i></font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">= </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    </b></font>NewSign <font color="#000080">:= </font>BCDPositive
  <font color="#FF0000"><b>else
    </b></font>NewSign <font color="#000080">:= </font>BCDNegative<font color="#000080">;

  </font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(@</font>Self<font color="#000080">));
  </font>WrkVal<font color="#000080">^.</font>AbsoluteValue<font color="#000080">;

  </font>WrkQuo <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>GetBCDSize<font color="#000080">));

  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt; </font>WrkVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>WrkVal<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font>HighDigit <font color="#000080">:= </font>i<font color="#000080">;
  </font>WrkVal<font color="#000080">^.</font>SetPrecision<font color="#000080">(</font>WrkVal<font color="#000080">^.</font>GetPrecision<font color="#000080">+(</font>HighDigit<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">));
  </font>TempPrec <font color="#000080">:= </font>WrkVal<font color="#000080">^.</font>GetPrecision<font color="#000080">;
  </font>WrkVal<font color="#000080">^.</font>Precision <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font>WrkDiv <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">));
  </font>WrkDiv<font color="#000080">^.</font>AbsoluteValue<font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt; </font>WrkDiv<font color="#000080">^.</font>GetBCDSize<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>WrkDiv<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font>HighDigit <font color="#000080">:= </font>i<font color="#000080">;
  </font>WrkDiv<font color="#000080">^.</font>ShiftLeft<font color="#000080">(</font>HighDigit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font>WrkDiv<font color="#000080">^.</font>Precision <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font>QuotientPrec <font color="#000080">:= </font>TempPrec <font color="#000080">- </font>AVal<font color="#000080">^.</font>GetPrecision<font color="#000080">;
  </font>IterationCount <font color="#000080">:= </font>WrkVal<font color="#000080">^.</font>GetBCDSize <font color="#000080">- </font>QuotientPrec <font color="#000080">+ </font>GetPrecision<font color="#000080">;

  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>IterationCount <font color="#FF0000"><b>do
    begin
      while </b></font>CompareBCD<font color="#000080">(</font>WrkDiv<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
        begin
          </b></font>WrkVal<font color="#000080">^.</font>SubtractBCD<font color="#000080">(</font>WrkDiv<font color="#000080">);
          </font>inc<font color="#000080">(</font>WrkQuo<font color="#000080">^.</font>Value<font color="#000080">^[</font>WrkQuo<font color="#000080">^.</font>GetBCDSize<font color="#000080">]);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>WrkDiv<font color="#000080">^.</font>ShiftRight<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>WrkQuo<font color="#000080">^.</font>ShiftLeft<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>WrkQuo<font color="#000080">^.</font>Precision <font color="#000080">:= </font>QuotientPrec<font color="#000080">;
  </font>SetValueBCD<font color="#000080">(</font>WrkQuo<font color="#000080">);
  </font>SetSign<font color="#000080">(</font>NewSign<font color="#000080">);

  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkQuo<font color="#000080">, </font>Done<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkDiv<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>DivideByReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">:  </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font>AVal<font color="#000080">, </font>APrec<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>DivideByBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>DivideByPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">, </font>APrec<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>DivideByBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>AbsoluteValue<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetSign<font color="#000080">(</font>BCDPositive<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>Increment<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AddReal<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>Decrement<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SubtractReal<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>ShiftLeft<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ShiftAmount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>BCDSize <font color="#000080">- </font>ShiftAmount<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font>Value<font color="#000080">^[</font>i<font color="#000080">+</font>ShiftAmount<font color="#000080">];
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= ((</font>BCDSize <font color="#000080">- </font>ShiftAmount<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font>BCDSize <font color="#FF0000"><b>do
    </b></font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBCD<font color="#000080">.</font>ShiftRight<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ShiftAmount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>BCDSize <font color="#FF0000"><b>downto </b></font><font color="#000080">(</font>ShiftAmount <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font>Value<font color="#000080">^[</font>i <font color="#000080">- </font>ShiftAmount<font color="#000080">];
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>ShiftAmount <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>Value<font color="#000080">^[</font>i<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>BCD2Int<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
  </font>wrkLongInt<font color="#000080">:  </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>BCD2Int <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Precision <font color="#000080">= </font>GetBCDSize <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font>wrkLongInt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>wrkLongInt <font color="#000080">:= </font>wrkLongInt <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">;
    </font>wrkLongInt <font color="#000080">:= </font>wrkLongInt <font color="#000080">+ </font>Value<font color="#000080">^[</font>i<font color="#000080">];
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">= (</font>GetBCDSize <font color="#000080">- </font>GetPrecision<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
    </b></font>BCD2Int <font color="#000080">:= -</font>wrkLongInt
  <font color="#FF0000"><b>else
    </b></font>BCD2Int <font color="#000080">:= </font>wrkLongInt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>BCD2Real<font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
  </font>wrkIntegerPart<font color="#000080">, </font>wrkFractionPart<font color="#000080">:  </font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>BCD2Real <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
  </font>wrkIntegerPart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>wrkFractionPart <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>GetPrecision <font color="#000080">&lt; </font>GetBCDSize <font color="#FF0000"><b>then
    begin
      </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        </b></font>wrkIntegerPart <font color="#000080">:= </font>wrkIntegerPart <font color="#000080">* </font><font color="#800000">10.0</font><font color="#000080">;
        </font>wrkIntegerPart <font color="#000080">:= </font>wrkIntegerPart <font color="#000080">+ </font>Value<font color="#000080">^[</font>i<font color="#000080">];
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">= (</font>GetBCDSize <font color="#000080">- </font>GetPrecision <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Precision <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>i <font color="#000080">:= </font>GetBCDSize<font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        </b></font>wrkFractionPart <font color="#000080">:= </font>wrkFractionPart <font color="#000080">+ </font>Value<font color="#000080">^[</font>i<font color="#000080">];
        </font>wrkFractionPart <font color="#000080">:= </font>wrkFractionPart <font color="#000080">/ </font><font color="#800000">10.0</font><font color="#000080">;
        </font>dec<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">= (</font>GetBCDSize <font color="#000080">- </font>GetPrecision<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
    </b></font>BCD2Real <font color="#000080">:= -(</font>wrkIntegerPart <font color="#000080">+ </font>wrkFractionPart<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>BCD2Real <font color="#000080">:= (</font>wrkIntegerPart <font color="#000080">+ </font>wrkFractionPart<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>PicStr<font color="#000080">(</font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                     </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>integer_str<font color="#000080">, </font>decimal_str<font color="#000080">, </font>pic_str<font color="#000080">, </font>val_str<font color="#000080">:  </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
   </font>decimal_encountered<font color="#000080">, </font>significant_digits_encountered<font color="#000080">:  </font>boolean<font color="#000080">;
   </font>number_of_digits<font color="#000080">, </font>number_of_integer_digits<font color="#000080">, </font>number_of_decimal_digits<font color="#000080">,
   </font>sub_pic<font color="#000080">, </font>sub_val<font color="#000080">, </font>i<font color="#000080">:  </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin    </b></font><font color="#008000"><i>{pic}
  </i></font>decimal_encountered <font color="#000080">:= </font>false<font color="#000080">;
  </font>number_of_digits <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>number_of_integer_digits <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>picture<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>upcase<font color="#000080">(</font>picture<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'$'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      begin
        </b></font>inc<font color="#000080">(</font>number_of_digits<font color="#000080">);
        </font><font color="#FF0000"><b>if not </b></font>decimal_encountered <font color="#FF0000"><b>then
          </b></font>inc<font color="#000080">(</font>number_of_integer_digits<font color="#000080">);
      </font><font color="#FF0000"><b>end
    else if </b></font>picture<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'.' </font><font color="#FF0000"><b>then
       </b></font>decimal_encountered <font color="#000080">:= </font>true<font color="#000080">;
  </font>number_of_decimal_digits <font color="#000080">:= </font>number_of_digits <font color="#000080">- </font>number_of_integer_digits<font color="#000080">;

  </font>integer_str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= (</font>GetBCDSize <font color="#000080">- </font>GetPrecision<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>integer_str <font color="#000080">:= </font>char<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">)+</font>Value<font color="#000080">^[</font>i<font color="#000080">]) + </font>integer_str<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>integer_str<font color="#000080">) &gt; </font>number_of_integer_digits <font color="#FF0000"><b>then
    </b></font>delete<font color="#000080">(</font>integer_str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>integer_str<font color="#000080">)-</font>number_of_integer_digits<font color="#000080">)
  </font><font color="#FF0000"><b>else
    while </b></font>length<font color="#000080">(</font>integer_str<font color="#000080">) &lt; </font>number_of_integer_digits <font color="#FF0000"><b>do
      </b></font>integer_str <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>integer_str<font color="#000080">;

  </font>decimal_str <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= (</font>GetBCDSize <font color="#000080">- </font>GetPrecision <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>to </b></font>GetBCDSize <font color="#FF0000"><b>do
    </b></font>decimal_str <font color="#000080">:= </font>decimal_str <font color="#000080">+ </font>char<font color="#000080">(</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">)+</font>Value<font color="#000080">^[</font>i<font color="#000080">]);
  </font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>decimal_str<font color="#000080">) &gt; </font>number_of_decimal_digits <font color="#FF0000"><b>then
    </b></font>delete<font color="#000080">(</font>decimal_str<font color="#000080">, </font>number_of_decimal_digits<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">255</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    while </b></font>length<font color="#000080">(</font>decimal_str<font color="#000080">) &lt; </font>number_of_decimal_digits <font color="#FF0000"><b>do
      </b></font>decimal_str <font color="#000080">:= </font>decimal_str <font color="#000080">+ </font><font color="#800000">'0'</font><font color="#000080">;

  </font>val_str <font color="#000080">:= </font>integer_str <font color="#000080">+ </font>decimal_str<font color="#000080">;

  </font>pic_str <font color="#000080">:= </font>copy<font color="#000080">(</font>st_Blanks<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>picture<font color="#000080">));

  </font>significant_digits_encountered <font color="#000080">:= </font>false<font color="#000080">;
  </font>sub_pic <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>sub_val <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>sub_pic <font color="#000080">&lt;= </font>length<font color="#000080">(</font>picture<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      if </b></font>val_str<font color="#000080">[</font>sub_val<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'1'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]</font><font color="#FF0000"><b>then
        </b></font>significant_digits_encountered <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>upcase<font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">]) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'('</font><font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">] </font><font color="#FF0000"><b>then
        if </b></font>Sign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
          begin
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font>upcase<font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">]);
            </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>end
        else
          begin
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
            </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>end
      else if </b></font>upcase<font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">]) </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Z'</font><font color="#000080">, </font><font color="#800000">'$'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">] </font><font color="#FF0000"><b>then
        begin
          if </b></font>significant_digits_encountered <font color="#FF0000"><b>then
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font>val_str<font color="#000080">[</font>sub_val<font color="#000080">]
          </font><font color="#FF0000"><b>else
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">;
          </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>sub_val <font color="#000080">:= </font>sub_val <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else if </b></font>picture<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">'.' </font><font color="#FF0000"><b>then
        begin
          </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">'.'</font><font color="#000080">;
          </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>significant_digits_encountered <font color="#000080">:= </font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end
      else if </b></font>picture<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">'9' </font><font color="#FF0000"><b>then
        begin
          </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font>val_str<font color="#000080">[</font>sub_val<font color="#000080">];
          </font><font color="#FF0000"><b>if </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
          </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>sub_val <font color="#000080">:= </font>sub_val <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
          </font>significant_digits_encountered <font color="#000080">:= </font>true<font color="#000080">;
        </font><font color="#FF0000"><b>end
      else if </b></font>picture<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">',' </font><font color="#FF0000"><b>then
        begin
          if </b></font>pic_str<font color="#000080">[</font>sub_pic <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">' '
          </font><font color="#FF0000"><b>else
            </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">','</font><font color="#000080">;
          </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font>upcase<font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">]);
          </font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Sign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
    begin
      </b></font>sub_pic <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&lt; </font>length<font color="#000080">(</font>picture<font color="#000080">)) </font><font color="#FF0000"><b>and
            </b></font><font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'('</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">','</font><font color="#000080">]) </font><font color="#FF0000"><b>do
        </b></font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
            </b></font><font color="#000080">(</font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
         </b></font><font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">'('</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">'-'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>sub_pic <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&lt; </font>length<font color="#000080">(</font>picture<font color="#000080">)) </font><font color="#FF0000"><b>and
        </b></font><font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'('</font><font color="#000080">, </font><font color="#800000">'$'</font><font color="#000080">, </font><font color="#800000">','</font><font color="#000080">]) </font><font color="#FF0000"><b>do
    </b></font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
        </b></font><font color="#000080">(</font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>sub_pic <font color="#000080">:= </font>sub_pic <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
     </b></font><font color="#000080">(</font>picture<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">'('</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] := </font><font color="#800000">'$'</font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>BlankWhenZero<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pic_str <font color="#000080">= </font>BCDZero<font color="#000080">^.</font>PicStr<font color="#000080">(</font>picture<font color="#000080">, </font>bpw_Fixed<font color="#000080">, </font>false<font color="#000080">)) </font><font color="#FF0000"><b>then
    </b></font>pic_str <font color="#000080">:= </font>copy<font color="#000080">(</font>st_Blanks<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>picture<font color="#000080">));

  </font><font color="#FF0000"><b>if </b></font>Width <font color="#000080">= </font>bpw_fixed <font color="#FF0000"><b>then
    </b></font>PicStr <font color="#000080">:= </font>pic_str
  <font color="#FF0000"><b>else
    begin
      if </b></font>pic_str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
        begin
          </b></font>sub_pic <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&lt; </font>length<font color="#000080">(</font>pic_str<font color="#000080">)) </font><font color="#FF0000"><b>and
                </b></font><font color="#000080">(</font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do
            </b></font>inc<font color="#000080">(</font>sub_pic<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>sub_pic<font color="#000080">);
          </font>delete<font color="#000080">(</font>pic_str<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>sub_pic<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>pic_str<font color="#000080">[</font>length<font color="#000080">(</font>pic_str<font color="#000080">)] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
        begin
          </b></font>sub_pic <font color="#000080">:= </font>length<font color="#000080">(</font>pic_str<font color="#000080">);
          </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>sub_pic <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                </b></font><font color="#000080">(</font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>do
            </b></font>dec<font color="#000080">(</font>sub_pic<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font>pic_str<font color="#000080">[</font>sub_pic<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>sub_pic<font color="#000080">);
          </font>delete<font color="#000080">(</font>pic_str<font color="#000080">, </font>sub_pic<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>PicStr <font color="#000080">:= </font>pic_str<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>StrPic<font color="#000080">(</font>dest<font color="#000080">: </font>PChar<font color="#000080">; </font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                     </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">;
                     </font>Size<font color="#000080">: </font>Integer<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>WrkStr<font color="#000080">:  </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">300</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>dest <font color="#000080">= </font><font color="#FF0000"><b>nil then
    begin
      </b></font>StrPic <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>StrPCopy<font color="#000080">(</font>WrkStr<font color="#000080">, </font>PicStr<font color="#000080">(</font>picture<font color="#000080">, </font>Width<font color="#000080">, </font>BlankWhenZero<font color="#000080">));
  </font>StrLCopy<font color="#000080">(</font>dest<font color="#000080">, </font>WrkStr<font color="#000080">, </font>Size<font color="#000080">);
  </font>StrPic <font color="#000080">:= </font>dest<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>CompareBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">:  </font>integer<font color="#000080">;
  </font>BCD1<font color="#000080">, </font>BCD2<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AVal <font color="#000080">= </font><font color="#FF0000"><b>nil then </b></font>exit<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>GetSign <font color="#000080">&lt; </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    begin
      </b></font>CompareBCD <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else if </b></font>GetSign <font color="#000080">&gt; </font>AVal<font color="#000080">^.</font>GetSign <font color="#FF0000"><b>then
    begin
      </b></font>CompareBCD <font color="#000080">:= +</font><font color="#800000">1</font><font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>BCD1 <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(@</font>Self<font color="#000080">));
  </font>BCD2 <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font>GetBCDSize <font color="#000080">&gt; </font>AVal<font color="#000080">^.</font>GetBCDSize <font color="#FF0000"><b>then
    </b></font>BCD2<font color="#000080">^.</font>SetBCDSize<font color="#000080">(</font>GetBCDSize<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>BCD1<font color="#000080">^.</font>SetBCDSize<font color="#000080">(</font>AVal<font color="#000080">^.</font>GetBCDSize<font color="#000080">);

  </font>CompareBCD <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>BCD1<font color="#000080">^.</font>GetBCDSize <font color="#FF0000"><b>do
    begin
      if </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] &lt; </font>BCD2<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then
        begin
          if </b></font>BCD1<font color="#000080">^.</font>GetSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
            </b></font>CompareBCD <font color="#000080">:= +</font><font color="#800000">1
          </font><font color="#FF0000"><b>else
            </b></font>CompareBCD <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
          </font>Dispose<font color="#000080">(</font>BCD1<font color="#000080">, </font>Done<font color="#000080">);
          </font>Dispose<font color="#000080">(</font>BCD2<font color="#000080">, </font>Done<font color="#000080">);
          </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end
      else if </b></font>BCD1<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] &gt; </font>BCD2<font color="#000080">^.</font>Value<font color="#000080">^[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then
        begin
          if </b></font>BCD1<font color="#000080">^.</font>GetSign <font color="#000080">= </font>BCDNegative <font color="#FF0000"><b>then
            </b></font>CompareBCD <font color="#000080">:= -</font><font color="#800000">1
          </font><font color="#FF0000"><b>else
            </b></font>CompareBCD <font color="#000080">:= +</font><font color="#800000">1</font><font color="#000080">;
          </font>Dispose<font color="#000080">(</font>BCD1<font color="#000080">, </font>Done<font color="#000080">);
          </font>Dispose<font color="#000080">(</font>BCD2<font color="#000080">, </font>Done<font color="#000080">);
          </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>CompareReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>CompareReal <font color="#000080">:= </font>CompareBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBCD<font color="#000080">.</font>ComparePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>WrkVal<font color="#000080">: </font>PBCD<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WrkVal <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">, </font>GetPrecision<font color="#000080">, </font>GetBCDSize<font color="#000080">));
  </font>ComparePChar <font color="#000080">:= </font>CompareBCD<font color="#000080">(</font>WrkVal<font color="#000080">);
  </font>Dispose<font color="#000080">(</font>WrkVal<font color="#000080">, </font>Done<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>BCDZero <font color="#000080">:= </font>new<font color="#000080">(</font>PBCD<font color="#000080">, </font>InitReal<font color="#000080">(</font><font color="#800000">0.0</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">));
  </font>RegisterType<font color="#000080">(</font>RBCD<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ DOCUMENTATION }

</i></font>AJCBCD <font color="#000080">- </font>Binary Coded Decimal <font color="#000080">(</font>BCD<font color="#000080">) </font><font color="#FF0000"><b>Unit


</b></font>This <font color="#FF0000"><b>unit </b></font>was written using Borland International<font color="#800000">'s Borland Pascal v7.0, and
</font>the <font color="#FF0000"><b>Object </b></font>Windows <font color="#FF0000"><b>Library </b></font><font color="#000080">(</font>OWL<font color="#000080">)/</font>Turbo Vision <font color="#000080">(</font>TV<font color="#000080">) </font><font color="#FF0000"><b>library </b></font>objects provided
<font color="#FF0000"><b>with </b></font>that product<font color="#000080">.



</font>I have <font color="#FF0000"><b>not </b></font>copyrighted this <font color="#FF0000"><b>program</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>donate it <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>public </b></font>domain<font color="#000080">.  </font>All
portions <font color="#FF0000"><b>of </b></font>this <font color="#FF0000"><b>program </b></font>may be used<font color="#000080">, </font>modified<font color="#000080">, </font><font color="#FF0000"><b>and</b></font><font color="#000080">/</font><font color="#FF0000"><b>or </b></font>distributed<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>whole
<font color="#FF0000"><b>or in </b></font>part<font color="#000080">.


</font>I wrote this <font color="#FF0000"><b>unit to </b></font>provide myself <font color="#FF0000"><b>with </b></font>some reusible functions that would
provide support <font color="#FF0000"><b>for </b></font>BCD math similar <font color="#FF0000"><b>to </b></font>what I<font color="#800000">'ve grown accustomed to with
</font>the COBOL <font color="#FF0000"><b>Packed </b></font>Decimal <font color="#000080">(</font>COMP<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">) </font>data <font color="#FF0000"><b>type</b></font><font color="#000080">.  </font>Note that <font color="#FF0000"><b>in </b></font>true <font color="#000080">&quot;</font><font color="#FF0000"><b>Packed
</b></font>Decimal<font color="#000080">&quot;, </font>two decimal digits are <font color="#000080">&quot;</font><font color="#FF0000"><b>packed</b></font><font color="#000080">&quot; </font>into each data byte<font color="#000080">.  </font>I chose <font color="#FF0000"><b>not
to </b></font>implement my BCD support <font color="#FF0000"><b>in </b></font>that manner<font color="#000080">.  </font>I may be less efficient <font color="#FF0000"><b>in </b></font>terms
<font color="#FF0000"><b>of </b></font>space<font color="#000080">, </font>but I simply placed a single decimal digit <font color="#FF0000"><b>in </b></font>each byte<font color="#000080">.

</font>I am just a <font color="#000080">&quot;</font>hobby<font color="#000080">&quot; </font>programmer<font color="#000080">, </font>having written nothing <font color="#FF0000"><b>for </b></font>anyone byt myself<font color="#000080">.
</font>Therefore<font color="#000080">, </font>this <font color="#FF0000"><b>unit </b></font>may <font color="#FF0000"><b>not </b></font>be <font color="#000080">&quot;</font>elegant<font color="#000080">&quot;; </font><font color="#FF0000"><b>and</b></font><font color="#000080">, </font>there are certainly better
ways <font color="#FF0000"><b>of </b></font>implementing some <font color="#FF0000"><b>of </b></font>the routines that I coded <font color="#000080">(</font>like perhaps coding
some <font color="#FF0000"><b>in assembler </b></font>which I<font color="#800000">'m NOT very good at).  However, it has met my own
</font>needs<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>I<font color="#800000">'m actually a little proud of what I accomplished here
</font><font color="#000080">(</font>especially <font color="#FF0000"><b>in </b></font>being able <font color="#FF0000"><b>to </b></font>figure <font color="#FF0000"><b>out </b></font>algorithms <font color="#FF0000"><b>to </b></font>multiply <font color="#FF0000"><b>and </b></font>divide<font color="#000080">!).
</font>By the way<font color="#000080">, </font>let me admit one thing right up front<font color="#000080">...</font>I have <font color="#FF0000"><b>NOT </b></font>tested ALL <font color="#FF0000"><b>of
</b></font>the routines <font color="#FF0000"><b>in </b></font>this <font color="#FF0000"><b>unit </b></font><font color="#000080">(</font><font color="#FF0000"><b>in </b></font>particular<font color="#000080">, </font>the Divide routine<font color="#000080">).  </font>I clearly
marked all <font color="#FF0000"><b>of </b></font>the routines that have <font color="#FF0000"><b>not </b></font>been fully tested<font color="#000080">.  </font>You can assume
that all other routines HAVE been tested<font color="#000080">, </font>because I used them <font color="#FF0000"><b>in </b></font>a real
application<font color="#000080">.

</font>This might <font color="#FF0000"><b>not </b></font>be the best BCD routines available<font color="#000080">, </font>but they might actually be
usefull <font color="#FF0000"><b>to </b></font>someone <font color="#FF0000"><b>else</b></font><font color="#000080">--</font>besides<font color="#000080">, </font>it<font color="#800000">'s free!  I am open to suggestions,
</font>comments<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>enhancements <font color="#000080">(</font>although<font color="#000080">, </font>I can<font color="#800000">'t promise quick turn around because
</font>I have a real job<font color="#000080">, </font>plus I teach<font color="#000080">, </font>plus I have a family<font color="#000080">--</font><font color="#FF0000"><b>then </b></font>I code <font color="#FF0000"><b>for </b></font>fun
<font color="#000080">--</font><font color="#FF0000"><b>in </b></font>that order <font color="#000080">&lt;</font>grin<font color="#000080">&gt;).  </font>My CompuServe ID <font color="#FF0000"><b>is </b></font><font color="#800000">71331</font><font color="#000080">,</font><font color="#800000">501.

</font>This <font color="#FF0000"><b>unit exports </b></font>some constants <font color="#000080">(</font>described below<font color="#000080">).  </font>But<font color="#000080">, </font>the big deal <font color="#FF0000"><b>in
</b></font>this <font color="#FF0000"><b>unit is </b></font>the Binary Coded Decimal <font color="#FF0000"><b>object </b></font>that this <font color="#FF0000"><b>unit </b></font>defines<font color="#000080">.  </font>This
<font color="#FF0000"><b>object </b></font><font color="#000080">(</font>TBCD<font color="#000080">) </font>allows you <font color="#FF0000"><b>to </b></font>allocate a BCD data <font color="#FF0000"><b>type of </b></font>any number <font color="#FF0000"><b>of </b></font>digits<font color="#000080">.
</font>This <font color="#FF0000"><b>object then </b></font>provides methods <font color="#FF0000"><b>for </b></font>adding<font color="#000080">, </font>subtracting<font color="#000080">, </font>multiplying<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>dividing <font color="#FF0000"><b>to</b></font><font color="#000080">/</font>from<font color="#000080">/</font>by other numbers<font color="#000080">.  </font>It also has methods <font color="#FF0000"><b>for </b></font>altering
the number <font color="#FF0000"><b>of </b></font>digits stored <font color="#FF0000"><b>as </b></font>well <font color="#FF0000"><b>as </b></font>the precision <font color="#000080">(</font>number <font color="#FF0000"><b>of </b></font>places after
the decimal place<font color="#000080">).


</font>Constants
<font color="#000080">---------
</font>DigitSize <font color="#000080">- </font>Stores the size<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>bytes<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>each individual digit <font color="#000080">(</font>currently
            one byte<font color="#000080">).

</font>bpw_Fixed <font color="#000080">- </font>Passed <font color="#FF0000"><b>to </b></font>the PicSTR <font color="#FF0000"><b>and </b></font>STRPic methods <font color="#000080">(</font>see the description <font color="#FF0000"><b>of
            </b></font>PicSTR <font color="#FF0000"><b>for </b></font>an explanation <font color="#FF0000"><b>of </b></font>how <font color="#FF0000"><b>to </b></font>use this constant<font color="#000080">).

</font>bpw_Variable <font color="#000080">- </font>See bpw_Fixed above<font color="#000080">.

</font>bpz_Blank <font color="#000080">- </font>See bpw_Fixed above<font color="#000080">.

</font>bpz_NotBlank <font color="#000080">- </font>See bpw_Fixed above<font color="#000080">.

</font>MaxBCDSize <font color="#000080">- </font>Limits the maximum number <font color="#FF0000"><b>of </b></font>BCD digits that can be allocated
             <font color="#FF0000"><b>for </b></font>a BCD <font color="#FF0000"><b>object</b></font><font color="#000080">.  </font>Arbitrarily <font color="#FF0000"><b>set to </b></font><font color="#800000">100.

</font>st_Blanks25 <font color="#000080">- </font>A <font color="#FF0000"><b>string </b></font>constant containing <font color="#800000">25 </font>blanks<font color="#000080">.  </font>Used just <font color="#FF0000"><b>as </b></font>a
              convenience <font color="#FF0000"><b>in </b></font>building the st_Blanks constant <font color="#000080">(</font>see below<font color="#000080">).

</font>st_Blanks <font color="#000080">- </font>A <font color="#FF0000"><b>String </b></font>constant containing <font color="#800000">255 </font>blanks<font color="#000080">.  </font>Used simply <font color="#FF0000"><b>as </b></font>a
            convenient reference<font color="#000080">/</font>resource <font color="#FF0000"><b>for </b></font>lots <font color="#FF0000"><b>of </b></font>blanks <font color="#000080">(</font>sort <font color="#FF0000"><b>of </b></font>like
            the <font color="#000080">&quot;</font>SPACES<font color="#000080">&quot; </font>constant <font color="#FF0000"><b>in </b></font>COBOL<font color="#000080">).

</font>RBCD <font color="#000080">- </font>TStreamRec used <font color="#FF0000"><b>for </b></font>registering the TBCD <font color="#FF0000"><b>object type for </b></font>use <font color="#FF0000"><b>with
       </b></font>streams<font color="#000080">.


</font><font color="#FF0000"><b>Var
</b></font><font color="#000080">---
</font>BCDZero <font color="#000080">- </font>A PBCD <font color="#FF0000"><b>object </b></font>that <font color="#FF0000"><b>is </b></font>initialized <font color="#FF0000"><b>to </b></font>a value <font color="#FF0000"><b>of </b></font>zero <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>unit</b></font><font color="#800000">'s
          </font><font color="#FF0000"><b>initialization </b></font>section<font color="#000080">.  </font>Used <font color="#FF0000"><b>as </b></font>a convenience whenever you need
          a BCD <font color="#FF0000"><b>object with </b></font>a value <font color="#FF0000"><b>of </b></font>zero<font color="#000080">.


</font><font color="#FF0000"><b>Type
</b></font><font color="#000080">----
</font>TBCDArray <font color="#000080">- </font>An <font color="#FF0000"><b>array of </b></font><font color="#000080">&quot;</font>MaxBCDSize<font color="#000080">&quot; (</font><font color="#800000">100</font><font color="#000080">) </font>bytes<font color="#000080">.  </font>Allocated by the TBCD
            <font color="#FF0000"><b>object to </b></font>store the BCD value<font color="#000080">.  </font>Each byte stores an individual
            digit <font color="#FF0000"><b>of </b></font>the value<font color="#000080">.

</font>TBCDSign <font color="#000080">- </font>An enumerated data <font color="#FF0000"><b>type </b></font>used by the TBCD <font color="#FF0000"><b>object to </b></font>represent the
           sign <font color="#FF0000"><b>of </b></font>the BCD value<font color="#000080">.  </font>Valid values are <font color="#000080">&quot;</font>BCDNegative<font color="#000080">&quot; </font><font color="#FF0000"><b>and
           </b></font><font color="#000080">&quot;</font>BCDPositive<font color="#000080">&quot;.




</font>TBCD
<font color="#000080">-----------------------------------------------------------------------------
 </font>TObject       TBCD
<font color="#000080">&Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest;      &Uacute;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&iquest;
&sup3;      &sup3;      &sup3; </font>BCDSize                         <font color="#000080">&sup3;
&Atilde;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&acute;      &sup3; </font>Sign                            <font color="#000080">&sup3;
&sup3; </font>Init <font color="#000080">&sup3;      &sup3; </font>Value                           <font color="#000080">&sup3;
&sup3;*</font>Done <font color="#000080">&sup3;      &sup3; </font>Precision                       <font color="#000080">&sup3;
&sup3; </font>Free <font color="#000080">&sup3;      &Atilde;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&acute;
&Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave;      &sup3; </font>InitBCD         MultiplyByBCD   <font color="#000080">&sup3;
              &sup3; </font>InitReal        MultiplyByReal  <font color="#000080">&sup3;
              &sup3; </font>InitPChar       MultiplyByPChar <font color="#000080">&sup3;
              &sup3; </font>Done            DivideByBCD     <font color="#000080">&sup3;
              &sup3; </font>Load            DivideByReal    <font color="#000080">&sup3;
              &sup3; </font>Store           DivideByPChar   <font color="#000080">&sup3;
              &sup3; </font>GetValue        AbsoluteValue   <font color="#000080">&sup3;
              &sup3; </font>GetSign         Increment       <font color="#000080">&sup3;
              &sup3; </font>GetPrecision    Decrement       <font color="#000080">&sup3;
              &sup3; </font>GetBCDSize      ShiftLeft       <font color="#000080">&sup3;
              &sup3; </font>SetValueBCD     ShiftRight      <font color="#000080">&sup3;
              &sup3; </font>SetValueReal    BCD2Int         <font color="#000080">&sup3;
              &sup3; </font>SetValuePChar   BCD2Real        <font color="#000080">&sup3;
              &sup3; </font>SetSign         PicStr          <font color="#000080">&sup3;
              &sup3; </font>SetPrecision    StrPic          <font color="#000080">&sup3;
              &sup3; </font>SetBCDSize      CompareBCD      <font color="#000080">&sup3;
              &sup3; </font>AddBCD          CompareReal     <font color="#000080">&sup3;
              &sup3; </font>AddReal         ComparePChar    <font color="#000080">&sup3;
              &sup3; </font>AddPChar                        <font color="#000080">&sup3;
              &sup3; </font>SubtractBCD                     <font color="#000080">&sup3;
              &sup3; </font>SubtractReal                    <font color="#000080">&sup3;
              &sup3; </font>SubtractPChar                   <font color="#000080">&sup3;
              &Agrave;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Ugrave;

</font>Fields <font color="#000080">---------------------------------------------------------------------

</font>BCDSize<font color="#000080">:  </font>Integer<font color="#000080">;                                                </font>Read Only

The size<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>number <font color="#FF0000"><b>of </b></font>digits<font color="#000080">, </font><font color="#FF0000"><b>of </b></font>the BCD number<font color="#000080">.  </font>Count represents the
available space <font color="#FF0000"><b>for </b></font>digits<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>does <font color="#FF0000"><b>NOT </b></font>include the decimal point<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>sign<font color="#000080">.


</font>Sign<font color="#000080">:  </font>TBCDSign<font color="#000080">;                                                  </font>Read Only

The mathmatical sign <font color="#FF0000"><b>of </b></font>the current value <font color="#000080">(</font>i<font color="#000080">.</font>e<font color="#000080">., </font>indicates whether the
current value <font color="#FF0000"><b>is </b></font>positive <font color="#FF0000"><b>or </b></font>negative<font color="#000080">).


</font>Value<font color="#000080">:  </font>PBCDArray<font color="#000080">;                                                </font>Read Only

A pointer <font color="#FF0000"><b>to </b></font>a TBCDArray <font color="#000080">(</font>an <font color="#FF0000"><b>array of </b></font>bytes<font color="#000080">) </font>used <font color="#FF0000"><b>to </b></font>store the value <font color="#FF0000"><b>of </b></font>the
BCD number<font color="#000080">.  </font>Even though TBCDArray <font color="#FF0000"><b>is </b></font>defined <font color="#FF0000"><b>with </b></font><font color="#000080">&quot;</font>MaxBCDSize<font color="#000080">&quot; </font>entries<font color="#000080">, </font>only
BCDSize bytes are actually allocated from memory<font color="#000080">.  </font>Therefore<font color="#000080">, </font>you must be
sure <font color="#FF0000"><b>to </b></font>be careful never <font color="#FF0000"><b>to </b></font>read <font color="#FF0000"><b>or </b></font>write <font color="#FF0000"><b>to </b></font>subscript values greater than
BCDSize<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you need <font color="#FF0000"><b>to </b></font>change the number <font color="#FF0000"><b>of </b></font>digits allocated you should use
the SetBCDSize method<font color="#000080">.  </font>The BCD value <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>array with </b></font>the lowest
order digit <font color="#FF0000"><b>in </b></font>the BCDSize position <font color="#FF0000"><b>and </b></font>the highest order digit <font color="#FF0000"><b>in </b></font>the <font color="#800000">1</font>st
position<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>BCDSize <font color="#FF0000"><b>is </b></font><font color="#800000">5</font><font color="#000080">, </font>Precision <font color="#FF0000"><b>is </b></font><font color="#800000">2</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the value being
stored <font color="#FF0000"><b>is </b></font><font color="#800000">2.35</font><font color="#000080">, </font><font color="#FF0000"><b>then </b></font>a <font color="#800000">5</font><font color="#000080">-</font>byte <font color="#FF0000"><b>array </b></font>would be allocated <font color="#FF0000"><b>on </b></font>the heap<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the
<font color="#FF0000"><b>array </b></font>values would be <font color="#000080">(</font><font color="#FF0000"><b>in </b></font>order from position <font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5</font><font color="#000080">) (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">5</font><font color="#000080">).


</font>Precision<font color="#000080">:  </font>Byte<font color="#000080">;                                                 </font>Read Only

This value represents the number <font color="#FF0000"><b>of </b></font>digits after the decimal point<font color="#000080">.  </font>Keep <font color="#FF0000"><b>in
</b></font>mind that there <font color="#FF0000"><b>is </b></font>no actual decimal point stored<font color="#000080">.


</font>Methods <font color="#000080">---------------------------------------------------------------------

</font>InitBCD

<font color="#FF0000"><b>constructor </b></font>InitBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font>Sets BCDSize<font color="#000080">, </font>Sign<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>Precision <font color="#FF0000"><b>to </b></font>the same values <font color="#FF0000"><b>as </b></font>the BCD <font color="#FF0000"><b>object
</b></font>referred <font color="#FF0000"><b>to </b></font>by AVal<font color="#000080">.  </font>It <font color="#FF0000"><b>then </b></font>calls SetValueBCD passing AVal <font color="#FF0000"><b>in </b></font>order <font color="#FF0000"><b>to
</b></font>allocate a TBCDArray <font color="#FF0000"><b>for </b></font>Value<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>copies the AVal<font color="#000080">^.</font>Value into this <font color="#FF0000"><b>object</b></font><font color="#800000">'s
</font>Value <font color="#FF0000"><b>array</b></font><font color="#000080">.


</font>InitReal

<font color="#FF0000"><b>constructor </b></font>InitReal<font color="#000080">(</font>AVal<font color="#000080">:  </font>Real<font color="#000080">; </font>APrec<font color="#000080">: </font>byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);

</font>Sets BCDSize <font color="#FF0000"><b>to </b></font>ASize<font color="#000080">, </font>Precision <font color="#FF0000"><b>to </b></font>APrec<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>calls SetValueReal<font color="#000080">(</font>AVal<font color="#000080">) </font><font color="#FF0000"><b>in
</b></font>order <font color="#FF0000"><b>to </b></font>allocate a Value <font color="#FF0000"><b>array and </b></font>initialize it <font color="#FF0000"><b>with </b></font>the value <font color="#FF0000"><b>in </b></font>AVal<font color="#000080">.


</font>InitPChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>constructor </b></font>InitPChar<font color="#000080">(</font>AVal<font color="#000080">:  </font>PChar<font color="#000080">; </font>APrec<font color="#000080">: </font>byte<font color="#000080">; </font>ASize<font color="#000080">: </font>Integer<font color="#000080">);

</font>Sets BCDSize <font color="#FF0000"><b>to </b></font>ASize<font color="#000080">, </font>Precision <font color="#FF0000"><b>to </b></font>APrec<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>calls SetValuePChar<font color="#000080">(</font>AVal<font color="#000080">)
</font><font color="#FF0000"><b>in </b></font>order <font color="#FF0000"><b>to </b></font>allocate a Value <font color="#FF0000"><b>array and </b></font>initialize it <font color="#FF0000"><b>with </b></font>the value <font color="#FF0000"><b>in </b></font>AVal<font color="#000080">.


</font>Done

<font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;

</font>Frees the memory allocated <font color="#FF0000"><b>for </b></font>the Value <font color="#FF0000"><b>array and </b></font>calls <font color="#000080">&quot;</font><font color="#FF0000"><b>inherited </b></font>Done<font color="#000080">&quot;.


</font>Load

<font color="#FF0000"><b>constructor </b></font>Load<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);

</font>constructs <font color="#FF0000"><b>and </b></font>loads a BCD <font color="#FF0000"><b>object </b></font>from the stream S by first loading BCDSize<font color="#000080">,
</font>Sign<font color="#000080">, </font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>last the Precision<font color="#000080">.


</font>Store

<font color="#FF0000"><b>procedure </b></font>Store<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font>TStream<font color="#000080">);

</font>Stores the BCD <font color="#FF0000"><b>object on </b></font>the stream S by storing the BCDSize<font color="#000080">, </font>Sign<font color="#000080">, </font>Value
<font color="#FF0000"><b>array</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the Precision<font color="#000080">.


</font>GetValue

<font color="#FF0000"><b>function </b></font>GetValue<font color="#000080">: </font>PBCDArray<font color="#000080">;

</font>Allocates a new TBCDArray <font color="#FF0000"><b>of </b></font>size BCDSize <font color="#FF0000"><b>and </b></font>copies the value <font color="#FF0000"><b>in </b></font>Value into
the new <font color="#FF0000"><b>array</b></font><font color="#000080">, </font><font color="#FF0000"><b>then </b></font>returns a pointer <font color="#FF0000"><b>to </b></font>the new <font color="#FF0000"><b>array</b></font><font color="#000080">.  </font>Note that it will
be the calling routine<font color="#800000">'s responsibility for disposing the array pointed to by
</font>the returned pointer <font color="#000080">(</font>use GetBCDSize <font color="#FF0000"><b>to </b></font>determine how much memory <font color="#FF0000"><b>to </b></font>free<font color="#000080">).
</font>FreeMem should be used <font color="#FF0000"><b>for </b></font>this disposal<font color="#000080">, </font><font color="#FF0000"><b>not </b></font>Dispose<font color="#000080">.


</font>GetSign

<font color="#FF0000"><b>function </b></font>GetSign<font color="#000080">: </font>TBCDSign<font color="#000080">;

</font>Returns the sign <font color="#FF0000"><b>of </b></font>the BCD value<font color="#000080">.  </font>The sign <font color="#FF0000"><b>is </b></font>returned <font color="#FF0000"><b>as </b></font>a TBCDSign
value<font color="#000080">; </font>either <font color="#000080">&quot;</font>BCDNegative<font color="#000080">&quot;, </font><font color="#FF0000"><b>or </b></font><font color="#000080">&quot;</font>BCDPositive<font color="#000080">&quot;.


</font>GetPrecision

<font color="#FF0000"><b>function </b></font>GetPrecision<font color="#000080">:  </font>Byte<font color="#000080">;

</font>Returns a byte value equal <font color="#FF0000"><b>to </b></font>the Precision <font color="#000080">(</font>number <font color="#FF0000"><b>of </b></font>decimal places<font color="#000080">) </font><font color="#FF0000"><b>of </b></font>the
BCD number<font color="#000080">.


</font>GetBCDSize

<font color="#FF0000"><b>function </b></font>GetBCDSize<font color="#000080">:  </font>Inteteger<font color="#000080">;

</font>Returns an integer value representing the number <font color="#FF0000"><b>of </b></font>BCD digits allocated <font color="#FF0000"><b>in
</b></font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">.


</font>SetValueBCD

<font color="#FF0000"><b>procedure </b></font>SetValueBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font><font color="#FF0000"><b>If </b></font>Value <font color="#FF0000"><b>is not nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the current Value <font color="#FF0000"><b>array is </b></font>freed<font color="#000080">.  </font>Next<font color="#000080">, </font>a new <font color="#FF0000"><b>array
of </b></font>size BCDSize <font color="#FF0000"><b>is </b></font>allocated <font color="#FF0000"><b>on </b></font>the heap<font color="#000080">, </font>by calling AVal<font color="#000080">^.</font>GetValue<font color="#000080">.  </font>Next<font color="#000080">,
</font>the copied value <font color="#FF0000"><b>array is </b></font>adjusted from the size <font color="#FF0000"><b>and </b></font>precision <font color="#FF0000"><b>of </b></font>AVal <font color="#FF0000"><b>to
</b></font>the BCDSize <font color="#FF0000"><b>and </b></font>Precision <font color="#FF0000"><b>of </b></font>this BCD <font color="#FF0000"><b>object </b></font><font color="#000080">(</font><font color="#FF0000"><b>if </b></font>different<font color="#000080">).  </font>Lastly<font color="#000080">, </font>the
sign <font color="#FF0000"><b>of </b></font>the value <font color="#FF0000"><b>is </b></font>copied by calling AVal<font color="#000080">^.</font>GetSign<font color="#000080">.


</font>SetValueReal

<font color="#FF0000"><b>procedure </b></font>SetValueReal<font color="#000080">(</font>AVal<font color="#000080">:  </font>Real<font color="#000080">);

</font>The current value <font color="#FF0000"><b>array is </b></font>initialized <font color="#FF0000"><b>to </b></font>all zero digits<font color="#000080">.  </font>AVal <font color="#FF0000"><b>is </b></font>converted
<font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>string</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>that <font color="#FF0000"><b>string is </b></font>copied digit by digit into the <font color="#FF0000"><b>array</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If
</b></font>AVal <font color="#FF0000"><b>is </b></font>less than zero <font color="#FF0000"><b>then </b></font>Sign <font color="#FF0000"><b>is set to </b></font>BCDNegative<font color="#000080">, </font>otherwise it <font color="#FF0000"><b>is set
to </b></font>BCDPositive<font color="#000080">.


</font>SetValuePChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>Tested Yet <font color="#000080">**

</font>procedcure SetValuePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);

</font>The current value <font color="#FF0000"><b>array is </b></font>initialized <font color="#FF0000"><b>to </b></font>all zero digits<font color="#000080">.  </font>AVal <font color="#FF0000"><b>is </b></font>copied
into the <font color="#FF0000"><b>array </b></font>digit by digit<font color="#000080">.  </font>This routine validity checking <font color="#FF0000"><b>to </b></font>verify that
the <font color="#FF0000"><b>string </b></font>actually represents a numeric value<font color="#000080">.  </font>The only character values
that are processed are<font color="#000080">:  </font><font color="#800000">1</font><font color="#000080">) </font>numbers <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">-</font><font color="#800000">9</font><font color="#000080">), </font><font color="#800000">2</font><font color="#000080">) </font>period <font color="#000080">(</font>locates decimal point<font color="#000080">),
</font><font color="#FF0000"><b>and </b></font><font color="#800000">3</font><font color="#000080">) </font>minus sign <font color="#FF0000"><b>or </b></font>parentheses <font color="#FF0000"><b>to </b></font>determine that the sign <font color="#FF0000"><b>is </b></font>negative<font color="#000080">.
</font>Examples<font color="#000080">:  &quot;(</font><font color="#800000">123.45</font><font color="#000080">)&quot; </font>would be interpreted <font color="#FF0000"><b>as </b></font>negative <font color="#800000">123.45</font><font color="#000080">; &quot;</font><font color="#800000">123.45</font><font color="#000080">&quot; </font>would
be interpreted <font color="#FF0000"><b>as </b></font>positive <font color="#800000">123.45</font><font color="#000080">; &quot;-</font><font color="#800000">123.45</font><font color="#000080">&quot; </font>would be interpreted <font color="#FF0000"><b>as </b></font>negative
<font color="#800000">123.45.  </font>Likewise<font color="#000080">, &quot;</font><font color="#800000">555</font><font color="#000080">-</font><font color="#800000">55</font><font color="#000080">-</font><font color="#800000">5555</font><font color="#000080">&quot; </font>would be interpreted <font color="#FF0000"><b>as </b></font>a negative
<font color="#800000">555555555</font><font color="#000080">; </font><font color="#FF0000"><b>and </b></font><font color="#000080">&quot;</font>I<font color="#800000">'ll have 2&quot; would be interpreted as a positive 2.  If there
</font>are no number characters <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>string </b></font>at all<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the resulting value <font color="#FF0000"><b>is
</b></font>zero<font color="#000080">.


</font>SetSign

<font color="#FF0000"><b>procedure </b></font>SetSign<font color="#000080">(</font>ASign<font color="#000080">: </font>TBCDSign<font color="#000080">);

</font>Sets Sign <font color="#FF0000"><b>to </b></font>ASign <font color="#000080">(</font>either BCDNegative <font color="#FF0000"><b>or </b></font>BCDPositive<font color="#000080">).  </font>Regardless <font color="#FF0000"><b>of </b></font>the
value <font color="#FF0000"><b>of </b></font>ASign<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>the Value <font color="#FF0000"><b>of </b></font>the BCD <font color="#FF0000"><b>is </b></font>zero<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>SetSign forces Sign <font color="#FF0000"><b>to
</b></font>be BCDPositive <font color="#000080">(</font><font color="#FF0000"><b>in </b></font>otherwords<font color="#000080">, </font>BCD never stores a negative zero<font color="#000080">).


</font>SetPrecision

<font color="#FF0000"><b>procedure </b></font>SetPrecision<font color="#000080">(</font>APrec<font color="#000080">: </font>Byte<font color="#000080">);

</font>Sets Precision <font color="#FF0000"><b>to </b></font>APrec<font color="#000080">.  </font>It also shifts the value <font color="#FF0000"><b>array </b></font>left <font color="#FF0000"><b>or </b></font>right<font color="#000080">,
</font>depending <font color="#FF0000"><b>on </b></font>whether the precision <font color="#FF0000"><b>is </b></font>being increased <font color="#FF0000"><b>or </b></font>decreased<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the
decimals are shifted left<font color="#000080">, </font>dropping high order digits <font color="#000080">(</font>hopefully zeros<font color="#000080">), </font><font color="#FF0000"><b>and
</b></font>padding zeros <font color="#FF0000"><b>on </b></font>the right<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the precision <font color="#FF0000"><b>is </b></font>being decreased<font color="#000080">, </font>the digits
are shifted <font color="#FF0000"><b>to </b></font>the right<font color="#000080">, </font>padding the high order digits <font color="#FF0000"><b>with </b></font>zeros<font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>dropping low order digits<font color="#000080">.  </font>Note that the size <font color="#FF0000"><b>of </b></font>the value <font color="#FF0000"><b>array is NOT
</b></font>changed by this method<font color="#000080">.


</font>SetBCDSize

<font color="#FF0000"><b>procedure </b></font>SetBCDSize<font color="#000080">(</font>ASize<font color="#000080">: </font>Integer<font color="#000080">);

</font>Sets BCDSize <font color="#FF0000"><b>to </b></font>ASize<font color="#000080">.  </font>It also allocates a new value <font color="#FF0000"><b>array of </b></font>the new size<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>copies value from the original value <font color="#FF0000"><b>array to </b></font>the new one<font color="#000080">.  </font>The value
<font color="#FF0000"><b>is </b></font>copied right justified <font color="#000080">(</font><font color="#FF0000"><b>in </b></font>otherwords<font color="#000080">, </font>high order digits are dropped
<font color="#FF0000"><b>or </b></font>padded <font color="#FF0000"><b>with </b></font>zeros depending <font color="#FF0000"><b>on </b></font>whether the new size <font color="#FF0000"><b>is </b></font>larger <font color="#FF0000"><b>or </b></font>smaller
than the old size<font color="#000080">).  </font>The original value <font color="#FF0000"><b>array is </b></font>freed<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>Value <font color="#FF0000"><b>is set to
</b></font>point <font color="#FF0000"><b>to </b></font>the new value <font color="#FF0000"><b>array</b></font><font color="#000080">.


</font>AddBCD

<font color="#FF0000"><b>procedure </b></font>AddBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font>Adds AVal<font color="#000080">^.</font>Value <font color="#FF0000"><b>to </b></font>Self<font color="#000080">.</font>Value<font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a <font color="#000080">&quot;</font>signed add<font color="#000080">&quot;.  </font>By that I mean that the
signs <font color="#FF0000"><b>of </b></font>the two operands ARE taken into account when adding the two values
together<font color="#000080">.  </font>The result <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">.  </font>Mathmatically<font color="#000080">, </font>it might
be represented by the following formula<font color="#000080">:  &quot;</font>Self <font color="#000080">:= </font>Self <font color="#000080">+ </font>AVal<font color="#000080">;&quot;


</font>AddReal

<font color="#FF0000"><b>procedure </b></font>AddReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls AddBCD <font color="#FF0000"><b>to </b></font>add that
temporary BCD number <font color="#FF0000"><b>to </b></font>Self<font color="#000080">.


</font>AddPChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>AddPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls AddBCD <font color="#FF0000"><b>to </b></font>add that
temporary BCD number <font color="#FF0000"><b>to </b></font>Self<font color="#000080">.


</font>SubtractBCD

<font color="#FF0000"><b>procedure </b></font>SubtractBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font>Subtracts AVal<font color="#000080">^.</font>Value from Self<font color="#000080">.</font>Value<font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a <font color="#000080">&quot;</font>signed subtract<font color="#000080">&quot;.  </font>By that
I mean that the signs <font color="#FF0000"><b>of </b></font>the two operands ARE taken into account when
subtracting the two values<font color="#000080">.  </font>The result <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">.
</font>Mathmatically<font color="#000080">, </font>it might be represented by the following formula<font color="#000080">:
&quot;</font>Self <font color="#000080">:= </font>Self <font color="#000080">- </font>AVal<font color="#000080">;&quot;


</font>SubtractReal  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>SubtractReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls SubtractBCD <font color="#FF0000"><b>to </b></font>subtract
that temporary BCD number from Self<font color="#000080">.


</font>SubtractPChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>SubtractPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls SubtractBCD <font color="#FF0000"><b>to </b></font>subtract
that temporary BCD number from Self<font color="#000080">.


</font>MultiplyByBCD

<font color="#FF0000"><b>procedure </b></font>MultiplyByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font>Multiplies Self<font color="#000080">.</font>Value by AVal<font color="#000080">^.</font>Value<font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a <font color="#000080">&quot;</font>signed multiply<font color="#000080">&quot;.  </font>By that
I mean that the signs <font color="#FF0000"><b>of </b></font>the two operands ARE taken into account when
multiplying the two values<font color="#000080">.  </font>The result <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">.
</font>Mathmatically<font color="#000080">, </font>it might be represented by the following formula<font color="#000080">:
&quot;</font>Self <font color="#000080">:= </font>Self <font color="#000080">* </font>AVal<font color="#000080">;&quot;


</font>MultiplyByReal  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>MultiplyByReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls MultiplyByBCD <font color="#FF0000"><b>to
</b></font>multiply Self by that temporary BCD number<font color="#000080">.


</font>MultiplyByPChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>MultiplyByPChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls MultiplyByBCD <font color="#FF0000"><b>to
</b></font>mulitiply Self by that temporary BCD number<font color="#000080">.


</font>DivideByBCD  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>DivideByBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">);

</font>Divides Self<font color="#000080">.</font>Value by  AVal<font color="#000080">^.</font>Value<font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a <font color="#000080">&quot;</font>signed divide<font color="#000080">&quot;.  </font>By that
I mean that the signs <font color="#FF0000"><b>of </b></font>the two operands ARE taken into account when
dividing the two values<font color="#000080">.  </font>The result <font color="#FF0000"><b>is </b></font>stored <font color="#FF0000"><b>in </b></font>the Value <font color="#FF0000"><b>array</b></font><font color="#000080">.
</font>Mathmatically<font color="#000080">, </font>it might be represented by the following formula<font color="#000080">:
&quot;</font>Self <font color="#000080">:= </font>Self<font color="#000080">/</font>AVal<font color="#000080">;&quot;


</font>DivideByReal  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>DivideByReal<font color="#000080">(</font>AVal<font color="#000080">:  </font>Real<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls DivideByBCD <font color="#FF0000"><b>to </b></font>divide
Self by that temporary BCD number<font color="#000080">.


</font>DivideByPChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>DivideByPChar<font color="#000080">(</font>AVal<font color="#000080">:  </font>Real<font color="#000080">);

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls DivideByBCD <font color="#FF0000"><b>to </b></font>divide
Self by that temporary BCD number<font color="#000080">.


</font>AbsoluteValue

<font color="#FF0000"><b>procedure </b></font>AbsoluteValue<font color="#000080">;

</font>Calls SetSign <font color="#FF0000"><b>to set </b></font>Sign <font color="#FF0000"><b>to </b></font>BCDPositive<font color="#000080">, </font>regardless <font color="#FF0000"><b>of </b></font>its current value<font color="#000080">.


</font>Increment  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>Increment<font color="#000080">;

</font>Adds <font color="#800000">1 </font>Value<font color="#000080">.


</font>Decrement  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>procedure </b></font>Decrement<font color="#000080">;

</font>Subtracts <font color="#800000">1 </font>from Value<font color="#000080">.


</font>ShiftLeft

<font color="#FF0000"><b>procedure </b></font>ShiftLeft<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);

</font>Shifts all <font color="#FF0000"><b>of </b></font>the digits left by ShiftAmount<font color="#000080">, </font>dropping high order digits<font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>padding the low order digits <font color="#FF0000"><b>with </b></font>zeros<font color="#000080">.  </font>The Precision <font color="#FF0000"><b>of </b></font>the number <font color="#FF0000"><b>is NOT
</b></font>altered<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font>effect<font color="#000080">, </font>ShiftLeft multiplies Value by a power <font color="#FF0000"><b>of </b></font><font color="#800000">10.


</font>ShiftRight

<font color="#FF0000"><b>procedure </b></font>ShiftRight<font color="#000080">(</font>ShiftAmount<font color="#000080">: </font>Byte<font color="#000080">);

</font>Shifts all <font color="#FF0000"><b>of </b></font>the digits right by ShiftAmount<font color="#000080">, </font>dropping low order digits<font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>padding the high order digits <font color="#FF0000"><b>with </b></font>zeros<font color="#000080">.  </font>The Precision <font color="#FF0000"><b>of </b></font>the number <font color="#FF0000"><b>is NOT
</b></font>altered<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font>effect<font color="#000080">, </font>ShiftRight divides Value by a power <font color="#FF0000"><b>of </b></font><font color="#800000">10.


</font>BCD2Int  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>function </b></font>BCD2Int<font color="#000080">: </font>LongInt<font color="#000080">;

</font>Converts the BCD value <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>it<font color="#800000">'s sign) to a LongInt data value.  Decimal
</font>positions are simply truncated<font color="#000080">, </font><font color="#FF0000"><b>not </b></font>rounded<font color="#000080">.  </font>Range checking <font color="#FF0000"><b>is not </b></font>performed<font color="#000080">.
</font><font color="#FF0000"><b>If </b></font>the number <font color="#FF0000"><b>of </b></font>significant digits <font color="#FF0000"><b>of </b></font>the BCD number <font color="#000080">(</font><font color="#FF0000"><b>not </b></font>counting decimal
positions<font color="#000080">) </font><font color="#FF0000"><b>is </b></font>too large <font color="#FF0000"><b>for </b></font>a LongInt number<font color="#000080">, </font>high order digits are lost<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>the resulting LongInt value will probably be meaningless<font color="#000080">.


</font>BCD2Real  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>function </b></font>BCD2Real<font color="#000080">:  </font>Real<font color="#000080">;

</font>Converts the BCD value <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>it<font color="#800000">'s sign) to a Real data value.  Range checking
</font><font color="#FF0000"><b>is not </b></font>performed<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the number <font color="#FF0000"><b>of </b></font>significant digits <font color="#FF0000"><b>of </b></font>the BCD number <font color="#FF0000"><b>is
</b></font>too loarge <font color="#FF0000"><b>for </b></font>a Real number<font color="#000080">, </font>the results are unpredictable<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>will
probably be meaningless<font color="#000080">.


</font>PicStr

<font color="#FF0000"><b>function </b></font>PicStr<font color="#000080">(</font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font>PicStr converts the BCD number into a formatted <font color="#FF0000"><b>Pascal string</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you are
familiar <font color="#FF0000"><b>with </b></font>the used <font color="#FF0000"><b>of </b></font>Edit Numeric Formatting <font color="#FF0000"><b>in </b></font>Cobol<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>you<font color="#800000">'re a
</font>long ways toward understanding how <font color="#FF0000"><b>to </b></font>use this routine<font color="#000080">.

</font>First<font color="#000080">, </font>let<font color="#800000">'s get the simple parameters out of the way...

</font>Width indicates whether <font color="#FF0000"><b>or not </b></font>insignificant leading <font color="#FF0000"><b>and </b></font>trailing blanks
should be removed from the resulting <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>Width <font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>to </b></font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>the
length <font color="#FF0000"><b>of </b></font>the resulting <font color="#FF0000"><b>string </b></font>will always equal the length <font color="#FF0000"><b>of </b></font>Picture<font color="#000080">,
</font>regardless <font color="#FF0000"><b>of </b></font>any leading <font color="#FF0000"><b>or </b></font>trailing blanks <font color="#FF0000"><b>in </b></font>the result <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>Width
<font color="#FF0000"><b>is </b></font>equal <font color="#FF0000"><b>to </b></font><font color="#800000">1</font><font color="#000080">, </font><font color="#FF0000"><b>then </b></font>any leading <font color="#FF0000"><b>and</b></font><font color="#000080">/</font><font color="#FF0000"><b>or </b></font>trailing blanks will be removed from
the resulting <font color="#FF0000"><b>string </b></font>before returning<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>your convenience<font color="#000080">, </font>two constants
have been defined <font color="#FF0000"><b>for </b></font>use <font color="#FF0000"><b>with </b></font>this parameter<font color="#000080">:  </font>bpw_Fixed <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>and
</b></font>bpw_Variable <font color="#000080">= </font><font color="#800000">1.

</font>BlankWhenZero indicates whether the entire result <font color="#FF0000"><b>string </b></font>should be forced <font color="#FF0000"><b>to
</b></font>completely blank<font color="#000080">, </font>regardless <font color="#FF0000"><b>of </b></font>any formatting characters <font color="#FF0000"><b>in </b></font>Picture<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>the
formatted value <font color="#FF0000"><b>is </b></font>logically equal <font color="#FF0000"><b>to </b></font>zero<font color="#000080">.  </font>The BCD value itself <font color="#FF0000"><b>is NOT </b></font>used
<font color="#FF0000"><b>to </b></font>make this determination<font color="#000080">.  </font>The determination <font color="#FF0000"><b>is </b></font>made by comparing the
result <font color="#FF0000"><b>string to </b></font>the <font color="#FF0000"><b>string </b></font>from formatting BCDZero <font color="#000080">(</font>zero value<font color="#000080">) </font><font color="#FF0000"><b>with </b></font>the
same Picture <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the two strings are equal<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>this result <font color="#FF0000"><b>string
is </b></font>considered <font color="#FF0000"><b>to </b></font>be equal <font color="#FF0000"><b>to </b></font>zero<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>BlankWhenZero <font color="#FF0000"><b>is </b></font>true<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>such zero
valued results are forced <font color="#FF0000"><b>to </b></font>all blanks<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>BlankWhenZero <font color="#FF0000"><b>is </b></font>false<font color="#000080">, </font>the
the result <font color="#FF0000"><b>string is </b></font>left <font color="#FF0000"><b>to </b></font>whatever it becomes based <font color="#FF0000"><b>on </b></font>the Picture <font color="#FF0000"><b>string</b></font><font color="#000080">.
</font><font color="#FF0000"><b>If </b></font>BlankWhenZero <font color="#FF0000"><b>is </b></font>true<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>Width <font color="#000080">= </font>bpw_Fixed<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the result <font color="#FF0000"><b>string is
</b></font>a <font color="#FF0000"><b>string of </b></font>blanks equal <font color="#FF0000"><b>in </b></font>length <font color="#FF0000"><b>to </b></font>the length <font color="#FF0000"><b>of </b></font>Picture<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>Width <font color="#000080">=
</font>bpw_Variable<font color="#000080">, </font>the the result will be an empty strint <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">).  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font><font color="#FF0000"><b>if
</b></font>the BCD number <font color="#000080">= </font><font color="#800000">0.0023</font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the formatted result <font color="#FF0000"><b>is </b></font><font color="#000080">&quot;</font><font color="#800000">0.00</font><font color="#000080">%&quot;, </font>BlankWhenZero <font color="#000080">=
</font>false would result <font color="#FF0000"><b>in </b></font><font color="#000080">&quot;</font><font color="#800000">0.00</font><font color="#000080">%&quot;, </font><font color="#FF0000"><b>while </b></font>BlankWhenZero <font color="#000080">= </font>true would result <font color="#FF0000"><b>in </b></font>a
blank <font color="#FF0000"><b>or </b></font>empty <font color="#FF0000"><b>string </b></font>depending <font color="#FF0000"><b>on </b></font>Width<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>your convenience<font color="#000080">, </font>two constants
have been defined <font color="#FF0000"><b>for </b></font>use <font color="#FF0000"><b>with </b></font>this parameter<font color="#000080">:  </font>bpz_Blank <font color="#000080">= </font>true<font color="#000080">, </font><font color="#FF0000"><b>and
</b></font>bpz_NotBlank <font color="#000080">= </font>false<font color="#000080">.

</font>Now<font color="#000080">, </font>the more complicated part<font color="#000080">...</font>picture<font color="#000080">...

</font>The <font color="#000080">&quot;</font>picture<font color="#000080">&quot; </font>parameter <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>string </b></font>that provides a template <font color="#FF0000"><b>for </b></font>formatting
the value <font color="#FF0000"><b>of </b></font>the BCDnumber<font color="#000080">.  </font>The possible template characters are<font color="#000080">...
  </font><font color="#800000">'9' </font><font color="#000080">- </font>Fills <font color="#FF0000"><b>with </b></font>a digit from the value <font color="#000080">(</font><font color="#FF0000"><b>or </b></font>zero <font color="#FF0000"><b>if </b></font>no digit position
        available <font color="#FF0000"><b>in </b></font>the BCD number<font color="#000080">)
  </font><font color="#800000">'Z' </font><font color="#000080">- </font>Just like <font color="#800000">'9'</font><font color="#000080">, </font><font color="#FF0000"><b>except </b></font>that insignificant zeros <font color="#000080">(</font>i<font color="#000080">.</font>e<font color="#000080">., </font>leading zeros<font color="#000080">)
        </font>are left blank<font color="#000080">.
  </font><font color="#800000">'z' </font><font color="#000080">- </font>Exactly the same <font color="#FF0000"><b>as </b></font>a capital <font color="#000080">&quot;</font>Z<font color="#000080">&quot;
  </font><font color="#800000">'$' </font><font color="#000080">- </font>Just like <font color="#800000">'Z'</font><font color="#000080">, </font><font color="#FF0000"><b>except </b></font>that the right most unused <font color="#000080">(</font>blank<font color="#000080">)
        </font>dollar<font color="#000080">-</font>sign position <font color="#FF0000"><b>is </b></font>filled <font color="#FF0000"><b>with </b></font>a <font color="#800000">'$'</font><font color="#000080">.  </font>COBOL afficianados will
        recognize this <font color="#FF0000"><b>as </b></font>a <font color="#000080">&quot;</font>floating dollar sign<font color="#000080">&quot;.
  </font><font color="#800000">'-' </font><font color="#000080">- </font>Just like <font color="#800000">'Z'</font><font color="#000080">, </font><font color="#FF0000"><b>except </b></font>that <font color="#FF0000"><b>if </b></font>the BCD number value <font color="#FF0000"><b>is </b></font>negative<font color="#000080">, </font><font color="#FF0000"><b>then
        </b></font>the right most unused <font color="#000080">(</font>blank<font color="#000080">) </font>dash position <font color="#FF0000"><b>is </b></font>filled <font color="#FF0000"><b>with </b></font>a <font color="#800000">'-'</font><font color="#000080">.
        </font>COBOL afficianoados will recognize this <font color="#FF0000"><b>as </b></font>a <font color="#000080">&quot;</font>floating negative sign<font color="#000080">&quot;.
  </font><font color="#800000">'(' </font><font color="#000080">- </font><font color="#FF0000"><b>If </b></font>the template <font color="#FF0000"><b>contains </b></font>a parenthesis<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the BCD number value <font color="#FF0000"><b>is
        </b></font>negative<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the result <font color="#FF0000"><b>string is </b></font>surrounded <font color="#FF0000"><b>with </b></font>parenthesis<font color="#000080">.
  </font><font color="#800000">')' </font><font color="#000080">- </font><font color="#FF0000"><b>If </b></font>the template <font color="#FF0000"><b>contains </b></font>a parenthesis<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the BCD number value <font color="#FF0000"><b>is
        </b></font>negative<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the result <font color="#FF0000"><b>string is </b></font>surrounded <font color="#FF0000"><b>with </b></font>parenthesis<font color="#000080">.
  </font><font color="#800000">'.' </font><font color="#000080">- </font>Indicates the decimal point position<font color="#000080">, </font><font color="#FF0000"><b>and is </b></font>included <font color="#FF0000"><b>in </b></font>the result
        <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the template does <font color="#FF0000"><b>not </b></font>contain a period<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>the decimal
        position <font color="#FF0000"><b>is </b></font>assumed <font color="#FF0000"><b>to </b></font>be at the right <font color="#FF0000"><b>end of </b></font>the template<font color="#000080">, </font>no
        decimal point <font color="#FF0000"><b>is </b></font>included <font color="#FF0000"><b>in </b></font>the result <font color="#FF0000"><b>string</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>no decimal place
        values are included <font color="#FF0000"><b>in </b></font>the result <font color="#FF0000"><b>string</b></font><font color="#000080">.
  </font><font color="#800000">',' </font><font color="#000080">- </font><font color="#FF0000"><b>If </b></font>any significant <font color="#000080">(</font>non<font color="#000080">-</font>zero<font color="#000080">) </font>value positions precede the comma
        position<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>a comma <font color="#FF0000"><b>is </b></font>inserted at this position <font color="#FF0000"><b>in </b></font>the result
        <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font>This would normally be used <font color="#FF0000"><b>to </b></font>format commas <font color="#FF0000"><b>to </b></font>separate
        thousands positions <font color="#FF0000"><b>in </b></font>large numbers<font color="#000080">.
  </font>ANY other characters are simply inserted into the result <font color="#FF0000"><b>string in </b></font>their
  relative position<font color="#000080">.

</font>Some examples might help<font color="#000080">...

    </font>Value         Picture <font color="#FF0000"><b>String         </b></font>Fixed Result       Variable Result
    <font color="#800000">123.45          '$$$$$9.99'           '  $123.45'        '$123.45'
    123456.78       '$$$$$9.99'           '123456.78'        '123456.78'
    123456.78       '$$$$$$9.99'          '$123456.78'       '$123456.78'
    123456.78       '$,$$$,$$9.99'        '$123,456.78'      '$123,456.78'
    123.45          '9999'                '0123'             '0123'
    </font><font color="#000080">-</font><font color="#800000">1234.6         '---,--9.99'          ' -1,234.60'       '-1,234.60'
    </font><font color="#000080">-</font><font color="#800000">10.15          '(99.99)'             '(10.15)'          '(10.15)'
    10.15           '(99.99)'             ' 10.15 '          '10.15'
    75              'z9.999%'             '75.000%'          '75.000%'

</font>Got the idea<font color="#000080">?  </font>I hope so<font color="#000080">.  </font>I have developed a similar stand<font color="#000080">-</font>alone routine
<font color="#FF0000"><b>for </b></font>formatting inteter <font color="#FF0000"><b>and </b></font>real numbers<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>find it <font color="#FF0000"><b>to </b></font>be a VERY handy way
<font color="#FF0000"><b>to </b></font>nicely format my number values <font color="#FF0000"><b>for </b></font>presentation <font color="#FF0000"><b>on </b></font>the screen <font color="#FF0000"><b>or on </b></font>a
paper report<font color="#000080">.


</font>StrPic  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>function </b></font>StrPic<font color="#000080">(</font>dest<font color="#000080">: </font>PChar<font color="#000080">; </font>picture<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
                </font>Width<font color="#000080">: </font>Integer<font color="#000080">; </font>BlankWhenZero<font color="#000080">: </font>Boolean<font color="#000080">): </font>PChar<font color="#000080">;

</font>Calls PicStr<font color="#000080">(</font>picture<font color="#000080">, </font>Width<font color="#000080">, </font>BlankWhenZero<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>get a formatted <font color="#FF0000"><b>Pascal string</b></font><font color="#000080">.
</font>This <font color="#FF0000"><b>string is </b></font>converted <font color="#FF0000"><b>to </b></font>an null terminated <font color="#FF0000"><b>string</b></font><font color="#000080">.  </font>StrLCopy <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to
</b></font>copy that null terminated <font color="#FF0000"><b>string to </b></font>Dest<font color="#000080">, </font>limited by Size<font color="#000080">.  </font>See PicStr <font color="#FF0000"><b>for </b></font>an
explanation <font color="#FF0000"><b>of </b></font>the use <font color="#FF0000"><b>of </b></font>picture<font color="#000080">, </font>Width<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>BlankWhenZero<font color="#000080">.  </font>StrPic returns
a pointer <font color="#FF0000"><b>to </b></font>dest<font color="#000080">.


</font>CompareBCD

<font color="#FF0000"><b>function </b></font>CompareBCD<font color="#000080">(</font>AVal<font color="#000080">: </font>PBCD<font color="#000080">): </font>Integer<font color="#000080">;

</font>Compares the signed values <font color="#FF0000"><b>of </b></font>Self <font color="#FF0000"><b>and </b></font>AVal<font color="#000080">.  </font>CompareBCD returns <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>if </b></font>Self
<font color="#FF0000"><b>is </b></font>less than AVal<font color="#000080">, </font>returns <font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>of </b></font>Self <font color="#FF0000"><b>is </b></font>greater than AVal<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>returns <font color="#800000">0 </font><font color="#FF0000"><b>if
</b></font>the two values are equal<font color="#000080">.


</font>CompareReal  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**

</font><font color="#FF0000"><b>function </b></font>CompareReal<font color="#000080">(</font>AVal<font color="#000080">: </font>Real<font color="#000080">): </font>Integer<font color="#000080">;

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls CompareBCD <font color="#FF0000"><b>to </b></font>perform the
actual comparison <font color="#FF0000"><b>with </b></font>that temporary BCD number<font color="#000080">.  </font>CompareReal returns the
value returned by CompareBCD<font color="#000080">.

</font>ComparePChar  <font color="#000080">** </font><font color="#FF0000"><b>Not </b></font>yet tested <font color="#000080">**


</font><font color="#FF0000"><b>function </b></font>ComparePChar<font color="#000080">(</font>AVal<font color="#000080">: </font>PChar<font color="#000080">): </font>Integer<font color="#000080">;

</font>Converts AVal <font color="#FF0000"><b>to </b></font>a temporary PBCD <font color="#FF0000"><b>object and </b></font>calls CompareBCD <font color="#FF0000"><b>to </b></font>perform the
actual comparison <font color="#FF0000"><b>with </b></font>that temporary BCD number<font color="#000080">.  </font>ComparePChar returns the
value returned by CompareBCD<font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0070.PAS">Original</a><b>]</b></p></body>
</html>
