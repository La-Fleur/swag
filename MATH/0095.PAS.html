<html>
<head><title> "Financial functions" by FERNAND LEMOINE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0095.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>UNIT </b></font>business<font color="#000080">;
  </font><font color="#008000"><i>{$N+}

 (*  DESCRIPTION :
   I.  Financial functions from spreadsheet - Fonctions financiŠres.
       Name of functions , number and order of arguments are based upon
       Lotus 1-2-3 and Quattro , which are different from Excel.
  II.  Conversion : anglo-saxon measure unit &lt;----&gt;  metric measure unit
       Conversion entre mesures anglo-saxonnes et m‚triques.
 III.  Percentage calculation - Calcul de pourcentage .

     RELEASE     :  2.0
     DATE        :  27/02/94
     AUTHOR      :  Fernand LEMOINE
                    rue du CollŠge 34
                    B-6200 CHATELET
                    BELGIQUE
     All code granted to the public domain
     Questions and comments are welcome
     REQUIREMENT :  Turbo Pascal 5.0 or later
     Compatible with Borland Pascal protected mode
     Compatible with Borland Pascal for Windows (Wincrt)
  *)

</i></font><font color="#FF0000"><b>INTERFACE
CONST
  </b></font>Max_Pmt <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
</font><font color="#FF0000"><b>TYPE
  </b></font>Currency <font color="#000080">= </font>Comp<font color="#000080">;
  </font>SeriesPmt <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Max_Pmt<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Currency<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>scale_currency <font color="#000080">: </font>Real<font color="#000080">;

</font><font color="#008000"><i>(* Interfaced only for use by other units
   Conversion  real ---&gt; currency        *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>ToCurrency<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Currency<font color="#000080">;

  </font><font color="#008000"><i>(* Set number of decimal  for currency type  *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Set_Dec_Prec<font color="#000080">(</font>value <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteCurrency<font color="#000080">(</font>width <font color="#000080">: </font>Byte<font color="#000080">; </font>value <font color="#000080">: </font>Currency<font color="#000080">);
</font><font color="#008000"><i>(*  width = total length ;
   number of decimals fixed by Set_Dec_Prec *)

(*-I-------------------- Financial functions -----------------------------
   Interest Rate is expressed as a decimal number, not as a percent.
   The Rate period must match the payment period.                     *)

  (* Straight line depreciation - Amortissement lin‚aire                *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Sln<font color="#000080">(</font>InitialValue<font color="#000080">, </font>Residue <font color="#000080">: </font>real<font color="#000080">; </font>Time <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#008000"><i>(* Sum of the year digits depreciation - Amortissement d‚gressif      *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Syd<font color="#000080">(</font>InitialValue<font color="#000080">, </font>Residue <font color="#000080">: </font>real<font color="#000080">; </font>Period<font color="#000080">, </font>Time <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#008000"><i>(* Number of compounding periods - Dur‚e de capitalisation            *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Cterm<font color="#000080">(</font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>FutureValue<font color="#000080">, </font>PresentValue <font color="#000080">: </font>real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(* Number of payments - Nombre de p‚riodes                            *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Term<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>FutureValue <font color="#000080">: </font>real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(* Payment - Remboursement                                            *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Pmt<font color="#000080">(</font>Principal <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#008000"><i>(* Periodic interest Rate - Taux d'int‚rˆt                            *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Rate<font color="#000080">(</font>FutureValue<font color="#000080">, </font>PresentValue <font color="#000080">: </font>real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(* Present value - Valeur actualis‚e                                  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Pv<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#008000"><i>(* Net present value  - Valeur actualis‚e d'une s‚rie                 *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Npv<font color="#000080">(</font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Series <font color="#000080">: </font>SeriesPmt<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#008000"><i>(* Future value - Valeur … terme                                      *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Fv<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;

  </font><font color="#008000"><i>(*  II - Conversion : anglo-saxon measure unit &lt;--&gt; metric measure unit ---*)

  (* &oslash; Celsius to &oslash; Fahrenheit  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CelsToFahr<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(* &oslash; Fahrenheit to &oslash; Celsius  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>FahrToCels<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  US Gallons  to litres  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>GalToL<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  Litres to US gallons   *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>LToGal<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  Inch  to cm            *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>InchToCm<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  Cm    to inch          *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CmToInch<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  Pounds to kilograms       *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>LbToKg<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(*  Kilograms to pounds       *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>KgToLb<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;

  </font><font color="#008000"><i>(* III ------------------ Percentage  calculation -----------------------*)

  (* Compute value2 % from value1  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Percent<font color="#000080">(</font>value1<font color="#000080">, </font>value2 <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>(* Per cent deviation between value1 and value2 . Result is lower than 1  *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>DeltaPercent<font color="#000080">(</font>value1<font color="#000080">, </font>value2 <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

VAR
  </b></font>decimal_currency <font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Power<font color="#000080">(</font>number<font color="#000080">, </font>exponent <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF </b></font>number <font color="#000080">&gt; </font><font color="#800000">0.0 </font><font color="#FF0000"><b>THEN
      </b></font>Power <font color="#000080">:= </font>Exp<font color="#000080">(</font>exponent <font color="#000080">* </font>ln<font color="#000080">(</font>number<font color="#000080">))
    </font><font color="#FF0000"><b>ELSE
      </b></font>Power <font color="#000080">:= </font><font color="#800000">0.0
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>Set_Dec_Prec<font color="#000080">(</font>value <font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>decimal_currency <font color="#000080">:= </font>value<font color="#000080">;
    </font>scale_currency <font color="#000080">:= </font>Power<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font>decimal_currency<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>ToCurrency<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>ToCurrency <font color="#000080">:= </font>value <font color="#000080">* </font>scale_currency<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>WriteCurrency<font color="#000080">(</font>width <font color="#000080">: </font>Byte<font color="#000080">; </font>value <font color="#000080">: </font>Currency<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>WriteLn<font color="#000080">(</font>value <font color="#000080">/ </font>scale_currency<font color="#000080">:</font>width<font color="#000080">:</font>decimal_currency<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>Sln<font color="#000080">(</font>InitialValue<font color="#000080">, </font>Residue <font color="#000080">: </font>real<font color="#000080">; </font>Time <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Sln <font color="#000080">:= (</font>ToCurrency<font color="#000080">(</font>InitialValue<font color="#000080">) - </font>ToCurrency<font color="#000080">(</font>Residue<font color="#000080">)) / </font>Time<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Syd<font color="#000080">(</font>InitialValue<font color="#000080">, </font>Residue <font color="#000080">: </font>real<font color="#000080">; </font>Period<font color="#000080">, </font>Time <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Syd <font color="#000080">:= (</font>ToCurrency<font color="#000080">(</font>InitialValue<font color="#000080">) - </font>ToCurrency<font color="#000080">(</font>Residue<font color="#000080">)) *
    ((</font>Period <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">- </font>Time<font color="#000080">) / (</font>Period <font color="#000080">* (</font>Period <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) / </font><font color="#800000">2</font><font color="#000080">));
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Cterm<font color="#000080">(</font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>FutureValue<font color="#000080">, </font>PresentValue <font color="#000080">: </font>real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Cterm <font color="#000080">:= (</font>ln<font color="#000080">(</font>ToCurrency<font color="#000080">(</font>FutureValue<font color="#000080">) / </font>ToCurrency<font color="#000080">(</font>PresentValue<font color="#000080">)) /
              </font>ln<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">));
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Term<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>FutureValue <font color="#000080">: </font>real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Term <font color="#000080">:= (</font>ln<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>ToCurrency<font color="#000080">(</font>FutureValue<font color="#000080">) * (</font>Rate <font color="#000080">/ </font>ToCurrency<font color="#000080">(</font>Payment<font color="#000080">))) /
             </font>ln<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">));
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Pmt<font color="#000080">(</font>Principal <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Pmt <font color="#000080">:= </font>ToCurrency<font color="#000080">(</font>Principal<font color="#000080">) * (</font>Rate <font color="#000080">/ (</font><font color="#800000">1 </font><font color="#000080">- </font>Power<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">, - </font>Term<font color="#000080">)));
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Rate<font color="#000080">(</font>FutureValue<font color="#000080">, </font>PresentValue <font color="#000080">: </font>real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Rate <font color="#000080">:= </font>Power<font color="#000080">((</font>FutureValue<font color="#000080">) / (</font>PresentValue<font color="#000080">), </font><font color="#800000">1 </font><font color="#000080">/ </font>Term<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Pv<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Pv <font color="#000080">:= (</font>ToCurrency<font color="#000080">(</font>Payment<font color="#000080">) * (</font><font color="#800000">1 </font><font color="#000080">- </font>Power<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">, - </font>Term<font color="#000080">)) / </font>Rate<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Npv<font color="#000080">(</font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Series <font color="#000080">: </font>SeriesPmt<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>i<font color="#000080">, </font>number <font color="#000080">: </font>Byte<font color="#000080">;
    </font>N <font color="#000080">: </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>N <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>number <font color="#000080">:= </font>Max_Pmt<font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      IF </b></font>Series<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>number <font color="#000080">:= </font>i<font color="#000080">;
      </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>i <font color="#000080">= </font>Max_Pmt<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Series<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">);

    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>number <font color="#FF0000"><b>DO
      </b></font>N <font color="#000080">:= </font>N <font color="#000080">+ (</font>ToCurrency<font color="#000080">(</font>Series<font color="#000080">[</font>i<font color="#000080">]) / </font>Power<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">, </font>i<font color="#000080">));
    </font>Npv <font color="#000080">:= </font>N<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Fv<font color="#000080">(</font>Payment <font color="#000080">: </font>real<font color="#000080">; </font>Rate <font color="#000080">: </font>Real<font color="#000080">; </font>Term <font color="#000080">: </font>Byte<font color="#000080">) : </font>Currency<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Fv <font color="#000080">:= </font>ToCurrency<font color="#000080">(</font>Payment<font color="#000080">) * (</font>Power<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">+ </font>Rate<font color="#000080">, </font>Term<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">) / </font>Rate<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>CelsToFahr<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CelsToFahr <font color="#000080">:= </font><font color="#800000">9 </font><font color="#000080">/ </font><font color="#800000">5 </font><font color="#000080">* </font>value <font color="#000080">+ </font><font color="#800000">32</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>FahrToCels<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>FahrToCels <font color="#000080">:= </font><font color="#800000">5 </font><font color="#000080">/ </font><font color="#800000">9 </font><font color="#000080">* (</font>value <font color="#000080">- </font><font color="#800000">32</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>GalToL<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>GalToL <font color="#000080">:= </font>value <font color="#000080">* </font><font color="#800000">3.785411784</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LToGal<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>LToGal <font color="#000080">:= </font>value <font color="#000080">/ </font><font color="#800000">3.785411784</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>InchToCm<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>InchToCm <font color="#000080">:= </font>value <font color="#000080">* </font><font color="#800000">2.54</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>CmToInch<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CmToInch <font color="#000080">:= </font>value <font color="#000080">/ </font><font color="#800000">2.54</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LbToKg<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>LbToKg <font color="#000080">:= </font>value <font color="#000080">* </font><font color="#800000">0.45359237</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>KgToLb<font color="#000080">(</font>value <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>KgToLb <font color="#000080">:= </font>value <font color="#000080">/ </font><font color="#800000">0.45359237</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>(*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*)
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>Percent<font color="#000080">(</font>value1<font color="#000080">, </font>value2 <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Percent <font color="#000080">:= (</font>value1 <font color="#000080">* </font>value2<font color="#000080">) / </font><font color="#800000">10000</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>DeltaPercent<font color="#000080">(</font>value1<font color="#000080">, </font>value2 <font color="#000080">: </font>Real<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF </b></font>value2 <font color="#000080">= </font><font color="#800000">0.0 </font><font color="#FF0000"><b>THEN </b></font>DeltaPercent <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>ELSE </b></font>DeltaPercent <font color="#000080">:= (</font>value1 <font color="#000080">- </font>value2<font color="#000080">) / </font>value2<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Set_Dec_Prec<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.


</font><font color="#008000"><i>{ ------------------------------   DEMO PROGRAM  ------------ }
</i></font><font color="#FF0000"><b>program </b></font>demobus<font color="#000080">;
</font><font color="#008000"><i>{$N+}  (* Necessary *)
{$IFNDEF CPU87}
{$E+}  (* if no coprocessor is present, emulation is used  *)
{$ENDIF}

(* Demonstration program for use of business unit *)

</i></font><font color="#FF0000"><b>uses </b></font>business<font color="#000080">,</font>crt<font color="#000080">;

</font><font color="#FF0000"><b>const
 </b></font>S <font color="#000080">: </font>SeriesPmt <font color="#000080">= (</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);

</font><font color="#FF0000"><b>var
 </b></font>R1<font color="#000080">,</font>R2 <font color="#000080">:</font>real<font color="#000080">;

 </font><font color="#FF0000"><b>begin
  </b></font>clrscr<font color="#000080">;

   </font>Set_Dec_Prec<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);

  </font>Writeln<font color="#000080">(</font><font color="#800000">'Demo business unit'</font><font color="#000080">);</font>writeln<font color="#000080">;

  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Sln<font color="#000080">(</font><font color="#800000">100000</font><font color="#000080">,</font><font color="#800000">30000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Syd<font color="#000080">(</font><font color="#800000">100000</font><font color="#000080">,</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">));
  </font>Writeln <font color="#000080">(</font>Cterm<font color="#000080">(</font><font color="#800000">0.03</font><font color="#000080">,</font><font color="#800000">200000</font><font color="#000080">,</font><font color="#800000">100000</font><font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font>Term<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">,</font><font color="#800000">0.075</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Pmt<font color="#000080">(</font><font color="#800000">300000</font><font color="#000080">,</font><font color="#800000">0.03</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">));
  </font>Writeln <font color="#000080">(</font>Rate<font color="#000080">(</font><font color="#800000">2159</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Pv<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">0.03</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">));
  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,</font>Npv<font color="#000080">(</font><font color="#800000">0.08</font><font color="#000080">,</font>S<font color="#000080">));
  </font>WriteCurrency <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Fv<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">0.03</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">));

  </font>R1 <font color="#000080">:= </font><font color="#800000">15.8</font><font color="#000080">;  </font>R2 <font color="#000080">:= </font><font color="#800000">60.4</font><font color="#000080">;
  </font>writeln<font color="#000080">(</font>CelsToFahr<font color="#000080">(</font>R1<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>FahrToCels<font color="#000080">(</font>R2<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>InchToCm<font color="#000080">(</font>R1<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>CmToInch<font color="#000080">(</font>R2<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>LbToKg<font color="#000080">(</font>R1<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>KgToLb<font color="#000080">(</font>R2<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>GalToL<font color="#000080">(</font>R1<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>LToGal<font color="#000080">(</font>R2<font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

  </font>writeln<font color="#000080">(</font>Percent<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">22</font><font color="#000080">):</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">2 </font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>DeltaPercent<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">):</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>DeltaPercent<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">):</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

  </font>delay<font color="#000080">(</font><font color="#800000">2500</font><font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0095.PAS">Original</a><b>]</b></p></body>
</html>
