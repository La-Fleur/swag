<html>
<head><title> "FFT algorithm" by MARCEL HOOGEVEEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0075.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: marcel.hoogeveen@hacom.wlink.nl (Marcel Hoogeveen)

GR&gt; FFT stands for Fast Fourier Transform.  It is a quick way to conver
GR&gt; time domain data (ie oscilliscopy data with time on the x-axis) to
GR&gt; frequency domain (frequency on the x-axis, like a frequency spectrum
GR&gt; analyzer).  This is a usefull data analysis method.  I would also like
GR&gt; to get some source for this.


This is what i have of FFT source code, it should work if you tweak it a bit.
(It did for me when i used it in my analasis program).
Don't ask me how it works, i know how a DFT works but a FFT well .. just use
the source. :)

}
</i></font><font color="#FF0000"><b>Program </b></font>FFT<font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>Twopi<font color="#000080">=</font><font color="#800000">6.283185303</font><font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>Curve<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>nfft<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>real<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font><font color="#008000"><i>{This is for you to find out}

{ Calculation of the Discrete Fourier Transfor }
{ Using a Fast Fourier Transform algorithm     }
{                                              }
{ XR and XI are array of reals !!!             }
{ They contain on entry the input sequence and }
{ on return the transfrom                      }
{ ISI defines the transform direction          }
{ If ISI=-1 then forward, if ISI=1 then invert }
{                                              }
{ The dimension is 2**M                        }

</i></font><font color="#FF0000"><b>Procedure </b></font>RFFT <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>XR<font color="#000080">,</font>XI<font color="#000080">:</font>Curve<font color="#000080">;  </font>N<font color="#000080">:</font>integer<font color="#000080">;  </font>ISI<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
</b></font>M<font color="#000080">,</font>NV2<font color="#000080">,</font>LE<font color="#000080">,</font>LE1<font color="#000080">,</font>IP<font color="#000080">,</font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>L<font color="#000080">: </font>Integer<font color="#000080">;
</font>C<font color="#000080">,</font>THETA<font color="#000080">,</font>UR<font color="#000080">,</font>UI<font color="#000080">,</font>TR<font color="#000080">,</font>TI<font color="#000080">:</font>Real<font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>M<font color="#000080">:=</font>Round<font color="#000080">(</font>LN<font color="#000080">(</font>N<font color="#000080">)/</font>LN<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
</font>NV2<font color="#000080">:= </font>N <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
</font>J<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
Begin
If </b></font><font color="#000080">(</font>I<font color="#000080">&lt;</font>J<font color="#000080">) </font><font color="#FF0000"><b>then
Begin
</b></font>TR<font color="#000080">:=</font>XR<font color="#000080">[</font>J<font color="#000080">];            </font>TI<font color="#000080">:=</font>X<font color="#000080">[</font>J<font color="#000080">];
</font>XR<font color="#000080">[</font>J<font color="#000080">]:=</font>XR<font color="#000080">[</font>I<font color="#000080">];         </font>XI<font color="#000080">[</font>J<font color="#000080">]:=</font>XI<font color="#000080">[</font>I<font color="#000080">];
</font>XR<font color="#000080">[</font>I<font color="#000080">]:=</font>TR<font color="#000080">;            </font>XI<font color="#000080">[</font>I<font color="#000080">]:=</font>TI<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>K<font color="#000080">:=</font>NV2<font color="#000080">;
</font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>K<font color="#000080">&lt;</font>J<font color="#000080">) </font><font color="#FF0000"><b>do
Begin
</b></font>J<font color="#000080">:=</font>J<font color="#000080">-</font>K<font color="#000080">;
</font>K<font color="#000080">:=</font>K <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>J<font color="#000080">:=</font>J<font color="#000080">+</font>K<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>LE<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font>C<font color="#000080">:=</font>ISI<font color="#000080">*</font>TWOPI<font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>L<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>M <font color="#FF0000"><b>do
Begin
</b></font>LE1<font color="#000080">:=</font>LE<font color="#000080">;
</font>LE<font color="#000080">:=</font>LE<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LE1 <font color="#FF0000"><b>do
Begin
</b></font>THETA<font color="#000080">:= </font>C<font color="#000080">*(</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)/</font>LE<font color="#000080">;
</font>UR<font color="#000080">:=</font>COS<font color="#000080">(</font>tHETA<font color="#000080">);
</font>UI<font color="#000080">:=</font>SIN<font color="#000080">(</font>THETA<font color="#000080">);
</font>I<font color="#000080">:=</font>J<font color="#000080">;
</font><font color="#FF0000"><b>Repeat
</b></font>IP<font color="#000080">:=</font>I<font color="#000080">+</font>LE1<font color="#000080">;
</font>TR<font color="#000080">:=</font>XR<font color="#000080">[</font>IP<font color="#000080">]*</font>UR<font color="#000080">-</font>XI<font color="#000080">[</font>IP<font color="#000080">]*</font>UI<font color="#000080">;
</font>TI<font color="#000080">:+</font>XR<font color="#000080">[</font>IP<font color="#000080">]*</font>UI<font color="#000080">+</font>XI<font color="#000080">[</font>IP<font color="#000080">]*</font>UR<font color="#000080">;
</font>XR<font color="#000080">[</font>IP<font color="#000080">]:=</font>XR<font color="#000080">[</font>I<font color="#000080">]-</font>TR<font color="#000080">;           </font>XI<font color="#000080">[</font>IP<font color="#000080">]:=</font>XI<font color="#000080">[</font>I<font color="#000080">]-</font>TP<font color="#000080">;
</font>XR<font color="#000080">[</font>I<font color="#000080">]:=</font>XR<font color="#000080">[</font>I<font color="#000080">]+</font>TR<font color="#000080">;            </font>XI<font color="#000080">[</font>I<font color="#000080">]:=</font>XI<font color="#000080">[</font>I<font color="#000080">]+</font>TI<font color="#000080">;
</font>I<font color="#000080">:=</font>I<font color="#000080">+</font>LE<font color="#000080">;
</font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>I<font color="#000080">&gt;=</font>N<font color="#000080">)
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>If </b></font>ISI<font color="#000080">=-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
Begin
For </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>N <font color="#FF0000"><b>do
Begin
</b></font>XR<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">*</font>XR<font color="#000080">[</font>I<font color="#000080">]/</font>N<font color="#000080">;             </font>XI<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">*</font>XI<font color="#000080">[</font>I<font color="#000080">]/</font>N<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NUMSAM <font color="#FF0000"><b>do
Begin
</b></font>FREAL<font color="#000080">[</font>I<font color="#000080">]:=</font>SAMPLEBUFFER<font color="#000080">[</font>I<font color="#000080">];
</font>FIMAG<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>RFFT<font color="#000080">(</font>FREAL<font color="#000080">,</font>FIMAG<font color="#000080">,</font>NUMSAM<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">);
</font>DC<font color="#000080">:=</font>FREAL<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]/</font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NUMSAM <font color="#FF0000"><b>dO
</b></font>FREAL<font color="#000080">[</font>I<font color="#000080">]:=</font>FREAL<font color="#000080">[</font>I<font color="#000080">]*</font>FREAL<font color="#000080">[</font>I<font color="#000080">]+</font>fIMAG<font color="#000080">[</font>I<font color="#000080">]*</font>FIMAG<font color="#000080">[</font>I<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0075.PAS">Original</a><b>]</b></p></body>
</html>
