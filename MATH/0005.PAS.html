<html>
<head><title> "GAUSS.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>Gauss_Elimination<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">,</font>Printer<font color="#000080">;

</font><font color="#008000"><i>(***************************************************************************)
(* STEPHEN ABRAHAM                                                         *)
(* MCEN 3030 Comp METHODS                                                  *)
(* ASSGN #3                                                                *)
(* DUE: 2-12-93                                                            *)
(*                                                                         *)
(* GAUSS ELIMinATION (TURBO PASCAL VERSION by STEPHEN ABRAHAM)             *)
(*                                                                         *)
(***************************************************************************)
{                                                                           }
{                                                                           }
{------------------VarIABLE DECLARATION and  DEFinITIONS--------------------}

</i></font><font color="#FF0000"><b>Const
  </b></font>MAXROW <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">; </font><font color="#008000"><i>(* Maximum # of rows in a matrix    *)
  </i></font>MAXCOL <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">; </font><font color="#008000"><i>(* Maximum # of columns in a matrix *)

</i></font><font color="#FF0000"><b>Type
  </b></font>Mat_Array <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXROW<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font>MAXCOL<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">; </font><font color="#008000"><i>(* 2-D Matrix of Reals *)
  </i></font>Col_Array <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXCOL<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">; </font><font color="#008000"><i>(* 1-D Matrix of Real numbers    *)
  </i></font>Int_Array <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAXCOL<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">; </font><font color="#008000"><i>(* 1-D Matrix of Integers     *)

</i></font><font color="#FF0000"><b>Var
  </b></font>N_EQNS      <font color="#000080">: </font>Integer<font color="#000080">;   </font><font color="#008000"><i>(* User Input : Number of equations in system  *)
  </i></font>COEFF_MAT   <font color="#000080">: </font>Mat_Array<font color="#000080">; </font><font color="#008000"><i>(* User Input : Coefficient Matrix of system   *)
  </i></font>COL_MAT     <font color="#000080">: </font>Col_Array<font color="#000080">; </font><font color="#008000"><i>(* User Input : Column matrix of Constants     *)
  </i></font>X_MAT       <font color="#000080">: </font>Col_Array<font color="#000080">; </font><font color="#008000"><i>(* OutPut : Solution matrix For unknowns       *)
  </i></font>orDER_VECT  <font color="#000080">: </font>Int_Array<font color="#000080">; </font><font color="#008000"><i>(* Defined to pivot rows where necessary       *)
  </i></font>SCALE_VECT  <font color="#000080">: </font>Col_Array<font color="#000080">; </font><font color="#008000"><i>(* Defined to divide by largest element in     *)
                           (* row For normalizing effect                  *)
  </i></font>I<font color="#000080">,</font>J<font color="#000080">,</font>K       <font color="#000080">: </font>Integer<font color="#000080">;   </font><font color="#008000"><i>(* Loop control and Array subscripts           *)
  </i></font>Ans         <font color="#000080">: </font>Char<font color="#000080">;      </font><font color="#008000"><i>(* Yes/No response to check inputted matrix    *)


{+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++}



{^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^}
{&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;   ProcedureS    &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;}
{...........................................................................}


</i></font><font color="#FF0000"><b>Procedure </b></font>Home<font color="#000080">;  </font><font color="#008000"><i>(* clears screen and positions cursor at (1,1)            *)
</i></font><font color="#FF0000"><b>begin
   </b></font>ClrScr<font color="#000080">;
   </font>GotoXY<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>(* Procedure Home *)

{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Instruct<font color="#000080">;  </font><font color="#008000"><i>(* provides user instructions if wanted               *)

</i></font><font color="#FF0000"><b>Var
  </b></font>Ans <font color="#000080">: </font>Char<font color="#000080">;  </font><font color="#008000"><i>(* Yes/No answer by user For instructions or not            *)

</i></font><font color="#FF0000"><b>begin
   </b></font>Home<font color="#000080">; </font><font color="#008000"><i>(* calls Home Procedure *)
   </i></font>GotoXY<font color="#000080">(</font><font color="#800000">22</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">); </font>Writeln<font color="#000080">(</font><font color="#800000">'STEVE`S GAUSSIAN ELIMinATION Program'</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">); </font>Writeln<font color="#000080">(</font><font color="#800000">'2-12-92'</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">18</font><font color="#000080">); </font>Write<font color="#000080">(</font><font color="#800000">'Instructions(Y/N):'</font><font color="#000080">);
   </font>GotoXY<font color="#000080">(</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">49</font><font color="#000080">); </font>readln<font color="#000080">(</font>Ans<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>Ans <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'y'</font><font color="#000080">] </font><font color="#FF0000"><b>then
   begin
     </b></font>Home<font color="#000080">; </font><font color="#008000"><i>(* calls Home Procedure *)
     </i></font>Writeln<font color="#000080">(</font><font color="#800000">'  Welcome to Steve`s Gaussian elimination Program.  With this'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Program you will be able to enter the augmented matrix of    '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'your system of liNear equations and have returned to you the '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'solutions For each unknown.  The Computer will ask you to    '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'input the number of equations in your system and will then   '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'have you input your coefficient matrix and then your column  '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'matrix.  Please remember For n unknowns, you will need to    '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'have n equations.  ThereFore you should be entering a square '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'(nxn) coefficient matrix.  Have FUN!!!!                      '</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'(hit &lt;enter&gt; to continue...)'</font><font color="#000080">);  </font><font color="#008000"><i>(* Delay *)
     </i></font>readln<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Initialize_Array<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>Coeff_Mat <font color="#000080">: </font>Mat_Array <font color="#000080">;
                            </font><font color="#FF0000"><b>Var </b></font>Col_Mat<font color="#000080">,</font>X_Mat<font color="#000080">, </font>Scale_Vect <font color="#000080">: </font>Col_Array<font color="#000080">;
                            </font><font color="#FF0000"><b>Var </b></font>order_Vect <font color="#000080">: </font>Int_Array<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure initializes all matrices to be used in Program       ***)
(*** ON ENTRY : Matrices have undefined values in them                   ***)
(*** ON Exit  : All Matrices are zero matrices                           ***)


</i></font><font color="#FF0000"><b>Const
  </b></font>MAXROW <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">; </font><font color="#008000"><i>{ maximum # of rows in matrix    }
  </i></font>MAXCOL <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">; </font><font color="#008000"><i>{ maximum # of columns in matrix }

</i></font><font color="#FF0000"><b>Var
  </b></font>I <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ I &amp; J are both loop control and Array subscripts }
  </i></font>J <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  For </b></font>I <font color="#000080">:=  </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxRow <font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ row indices }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Col_Mat<font color="#000080">[</font>I<font color="#000080">]    := </font><font color="#800000">0</font><font color="#000080">;
    </font>X_Mat<font color="#000080">[</font>I<font color="#000080">]      := </font><font color="#800000">0</font><font color="#000080">;
    </font>order_Vect<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font>Scale_Vect<font color="#000080">[</font>I<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxCol <font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ column indices }
      </i></font>Coeff_Mat<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>(* Procedure initialize_Array *)


{---------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Procedure </b></font>Input<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>N <font color="#000080">: </font>Integer<font color="#000080">;
                </font><font color="#FF0000"><b>Var </b></font>Coeff_Mat1 <font color="#000080">: </font>Mat_Array<font color="#000080">;
                </font><font color="#FF0000"><b>Var </b></font>Col_Mat1 <font color="#000080">: </font>Col_Array<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure lets the user input the number of equations and the  ***)
(*** augmented matrix of their system of equations                       ***)
(*** ON ENTRY : N =&gt; number of equations : UNDEFinED
                Coeff_Mat1 =&gt; coefficient matrix : UNDEFinED
                Col_Mat1 =&gt; column matrix :UNDEFinED
     ON Exit  : N =&gt; # of equations input by user
                Coeff_Mat1 =&gt; defined coefficient matrix
                Col_Mat1 =&gt; defined column matrix input by user          ***)



</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">,</font>J <font color="#000080">: </font>Integer<font color="#000080">;  </font><font color="#008000"><i>(* loop control and Array indices *)

</i></font><font color="#FF0000"><b>begin
  </b></font>Home<font color="#000080">; </font><font color="#008000"><i>(* calls Procedure Home *)
  </i></font>Write<font color="#000080">(</font><font color="#800000">'Enter the number of equations in your system: '</font><font color="#000080">);
  </font>readln<font color="#000080">(</font>N<font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Now you will enter your coefficient and column matrix:'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do     </b></font><font color="#008000"><i>{ row indice }
  </i></font><font color="#FF0000"><b>begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'ROW #'</font><font color="#000080">,</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{column indice }
    </i></font><font color="#FF0000"><b>begin
      </b></font>Write<font color="#000080">(</font><font color="#800000">'a('</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font>J<font color="#000080">,</font><font color="#800000">'):'</font><font color="#000080">);
      </font>readln<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]);    </font><font color="#008000"><i>{input of coefficient matrix}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">'c('</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">'):'</font><font color="#000080">);
    </font>readln<font color="#000080">(</font>Col_Mat1<font color="#000080">[</font>I<font color="#000080">]);          </font><font color="#008000"><i>{input of Constant matrix}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>(* Procedure Input *)


{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Check_Input<font color="#000080">( </font>Coeff_Mat1 <font color="#000080">: </font>Mat_Array<font color="#000080">;
                          </font>N <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Ans <font color="#000080">: </font>Char<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure displays the user's input matrix and asks if it is  ***)
(*** correct.                                                           ***)
(*** ON ENTRY : Coeff_Mat1 =&gt; inputted matrix
                N =&gt; inputted number of equations
                Ans =&gt; UNDEFinED                                        ***)
(*** ON Exit  : Coeff_Mat1 =&gt; n/a
                N =&gt; n/a
                Ans =&gt; Y,y or N,n                                       ***)


</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">,</font>J   <font color="#000080">: </font>Integer<font color="#000080">;  </font><font color="#008000"><i>(* loop control and Array indices *)

</i></font><font color="#FF0000"><b>begin
  </b></font>Home<font color="#000080">; </font><font color="#008000"><i>(* calls Home Procedure *)
  </i></font>Writeln<font color="#000080">; </font>Writeln<font color="#000080">(</font><font color="#800000">'Your inputted augmented matrix is:'</font><font color="#000080">);</font>Writeln<font color="#000080">;</font>Writeln<font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do   </b></font><font color="#008000"><i>{ row indice }
  </i></font><font color="#FF0000"><b>begin
    For </b></font>J <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do </b></font><font color="#008000"><i>{ column indice }
      </i></font>Write<font color="#000080">(</font>Coeff_Mat<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]:</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
    </font>Writeln<font color="#000080">(</font>Col_Mat<font color="#000080">[</font>I<font color="#000080">]:</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Writeln<font color="#000080">; </font>Write<font color="#000080">(</font><font color="#800000">'Is this your desired matrix?(Y/N):'</font><font color="#000080">); </font><font color="#008000"><i>(* Gets Answer *)
  </i></font>readln<font color="#000080">(</font>Ans<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>(* Procedure Check_Input *)


{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>order<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Scale_Vect1 <font color="#000080">: </font>Col_Array<font color="#000080">;
                </font><font color="#FF0000"><b>Var </b></font>order_Vect1 <font color="#000080">: </font>Int_Array<font color="#000080">;
                </font><font color="#FF0000"><b>Var </b></font>Coeff_Mat1  <font color="#000080">: </font>Mat_Array<font color="#000080">;
                    </font>N           <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure finds the order and scaling value For each row of the
     inputted coefficient matrix.                                        ***)
(*** ON ENTRY : Scale_Vect1 =&gt; UNDEFinED
                order_Vect1 =&gt; UNDEFinED
                Coeff_Mat1  =&gt; as inputted
                N           =&gt; # of equations
     ON Exit  : Scale_Vect1 =&gt; contains highest value For each row of the
                               coefficient matrix
                order_Vect1 =&gt; is assigned the row number of each row from
                               the coefficient matrix in order
                Coeff_Mat   =&gt; n/a
                N           =&gt; n/a                                      ***)


</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">,</font>J <font color="#000080">: </font>Integer<font color="#000080">;  </font><font color="#008000"><i>{loop control and Array indices}

</i></font><font color="#FF0000"><b>begin
For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
  begin
    </b></font>order_Vect1<font color="#000080">[</font>I<font color="#000080">] := </font>I<font color="#000080">;  </font><font color="#008000"><i>(* ordervect gets the row number of each row *)
    </i></font>Scale_Vect1<font color="#000080">[</font>I<font color="#000080">] := </font>Abs<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]); </font><font color="#008000"><i>(* gets the first number of each row *)
    </i></font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do </b></font><font color="#008000"><i>{ goes through the columns }
      </i></font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>(* Compares values in each row of the coefficient matrix and
                stores this value in scale_vect[i] *)
        </i></font><font color="#FF0000"><b>if </b></font>Abs<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]) &gt; </font>Scale_Vect1<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>then
           </b></font>Scale_Vect1<font color="#000080">[</font>I<font color="#000080">] := </font>Abs<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>(* Procedure order *)


{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Pivot<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Scale_Vect1 <font color="#000080">: </font>Col_Array<font color="#000080">;
                    </font>Coeff_Mat1  <font color="#000080">: </font>Mat_Array<font color="#000080">;
                </font><font color="#FF0000"><b>Var </b></font>order_Vect1 <font color="#000080">: </font>Int_Array<font color="#000080">;
                    </font>K<font color="#000080">,</font>N         <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure finds the largest number in each column after it has been
     scaled and Compares it With the number in the corresponding diagonal
     position. For example, in column one, a(1,1) is divided by the scaling
     factor of row one. then each value in the matrix that is in column one
     is divided by its own row's scaling vector and Compared With the
     position above it. So a(1,1)/scalevect[1] is Compared to a[2,1]/scalevect[2]
     and which ever is greater has its row number stored as pivot. Once the
     highest value For a column is found, rows will be switched so that the
     leading position has the highest possible value after being scaled. ***)

(*** ON ENTRY : Scale_Vect1 =&gt; the normalizing value of each row
                Coeff_Mat1  =&gt; the inputted coefficient matrix
                order_Vect1 =&gt; the row number of each row in original order
                K           =&gt; passed in from the eliminate Procedure
                N           =&gt; number of equations
     ON Exit  : Scale_Vect  =&gt; same
                Coeff_Mat1  =&gt; same
                order_Vect  =&gt; contains the row number With highest scaled
                               value
                k           =&gt; n/a
                N           =&gt; n/a                                      ***)

</i></font><font color="#FF0000"><b>Var
  </b></font>I           <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{loop control and Array indice }
  </i></font>Pivot<font color="#000080">, </font>Idum <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{holds temporary values For pivoting }
  </i></font>Big<font color="#000080">,</font>Dummy   <font color="#000080">: </font>Real<font color="#000080">; </font><font color="#008000"><i>{used to Compare values of each column }
</i></font><font color="#FF0000"><b>begin
  </b></font>Pivot <font color="#000080">:= </font>K<font color="#000080">;
  </font>Big <font color="#000080">:= </font>Abs<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>K<font color="#000080">],</font>K<font color="#000080">]/</font>Scale_Vect1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>K<font color="#000080">]]);
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>K<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
    begin
    </b></font>Dummy <font color="#000080">:= </font>Abs<font color="#000080">(</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>K<font color="#000080">]/</font>Scale_Vect1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">]]);
    </font><font color="#FF0000"><b>if </b></font>Dummy <font color="#000080">&gt; </font>Big <font color="#FF0000"><b>then
    begin
      </b></font>Big <font color="#000080">:= </font>Dummy<font color="#000080">;
      </font>Pivot <font color="#000080">:= </font>I<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Idum <font color="#000080">:= </font>order_Vect1<font color="#000080">[</font>Pivot<font color="#000080">];              </font><font color="#008000"><i>{ switching routine }
  </i></font>order_Vect1<font color="#000080">[</font>Pivot<font color="#000080">] := </font>order_Vect1<font color="#000080">[</font>K<font color="#000080">];
  </font>order_Vect1<font color="#000080">[</font>K<font color="#000080">] := </font>Idum<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Procedure pivot }


{---------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Procedure </b></font>Eliminate<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Col_Mat1<font color="#000080">, </font>Scale_Vect1 <font color="#000080">: </font>Col_Array<font color="#000080">;
                    </font><font color="#FF0000"><b>Var </b></font>Coeff_Mat1 <font color="#000080">: </font>Mat_Array<font color="#000080">;
                    </font><font color="#FF0000"><b>Var </b></font>order_Vect1 <font color="#000080">: </font>Int_Array<font color="#000080">;
                    </font>N <font color="#000080">: </font>Integer<font color="#000080">);


</font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">,</font>J<font color="#000080">,</font>K       <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Factor      <font color="#000080">: </font>Real<font color="#000080">;

</font><font color="#FF0000"><b>begin
 For </b></font>K <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
 begin
   </b></font>Pivot <font color="#000080">(</font>Scale_Vect1<font color="#000080">,</font>Coeff_Mat1<font color="#000080">,</font>order_Vect1<font color="#000080">,</font>K<font color="#000080">,</font>N<font color="#000080">);
   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>K<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
   begin
     </b></font>Factor <font color="#000080">:= </font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>K<font color="#000080">]/</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>K<font color="#000080">],</font>K<font color="#000080">];
     </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>K<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
     begin
       </b></font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>J<font color="#000080">] := </font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>J<font color="#000080">] -
                                        </font>Factor<font color="#000080">*</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>K<font color="#000080">],</font>J<font color="#000080">];
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Col_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">]] := </font>Col_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">]] - </font>Factor<font color="#000080">*</font>Col_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>K<font color="#000080">]];
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Substitute<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Col_Mat1<font color="#000080">, </font>X_Mat1 <font color="#000080">: </font>Col_Array<font color="#000080">;
                         </font>Coeff_Mat1 <font color="#000080">: </font>Mat_Array<font color="#000080">;
                     </font><font color="#FF0000"><b>Var </b></font>order_Vect1 <font color="#000080">: </font>Int_Array<font color="#000080">;
                     </font>N <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure will backsubstitute to find the solutions to your
     system of liNear equations.
     ON ENTRY : Col_Mat =&gt; your modified Constant column matrix
                X_Mat1  =&gt; UNDEFinED
                Coeff_Mat1 =&gt; modified into upper triangular matrix
                order_Vect =&gt; contains the order of your rows
                N          =&gt; number of equations
     ON Exit  : Col_Mat =&gt; n/a
                X_MAt1  =&gt; your solutions !!!!!!!!!!!!!
                Coeff_Mat1 =&gt; n/a
                order_Vect1 =&gt; who cares
                N           =&gt; n/a                                      ***)


</i></font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">, </font>J  <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>(* loop and indice of Array control *)
  </i></font>Sum   <font color="#000080">: </font>Real<font color="#000080">;    </font><font color="#008000"><i>(* used to sum each row's elements *)

</i></font><font color="#FF0000"><b>begin
  </b></font>X_Mat1<font color="#000080">[</font>N<font color="#000080">] := </font>Col_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>N<font color="#000080">]]/</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>N<font color="#000080">],</font>N<font color="#000080">];
  </font><font color="#008000"><i>(***** This gives you the value of x[n] *********)

  </i></font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>N<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    </b></font>Sum <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font>I<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
      </b></font>Sum <font color="#000080">:= </font>Sum <font color="#000080">+ </font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>J<font color="#000080">]*</font>X_Mat1<font color="#000080">[</font>J<font color="#000080">];
    </font>X_Mat1<font color="#000080">[</font>I<font color="#000080">] := (</font>Col_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">]] - </font>Sum<font color="#000080">)/</font>Coeff_Mat1<font color="#000080">[</font>order_Vect1<font color="#000080">[</font>I<font color="#000080">],</font>I<font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>(** Procedure substitute **)


{---------------------------------------------------------------------------}


</i></font><font color="#FF0000"><b>Procedure </b></font>Output<font color="#000080">(</font>X_Mat1<font color="#000080">: </font>Col_Array<font color="#000080">; </font>N <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#008000"><i>(*** This Procedure outputs the solutions to the inputted system of     ***)
(*** equations                                                          ***)
(*** ON ENTRY : X_Mat1 =&gt; the solutions to the system of equations
                N =&gt; the number of equations
     ON Exit  : X_Mat1 =&gt; n/a
                N =&gt; n/a                                                ***)


</i></font><font color="#FF0000"><b>Var
  </b></font>I    <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>(* loop control and Array indice *)

</i></font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">;</font>Writeln<font color="#000080">;</font>Writeln<font color="#000080">; </font><font color="#008000"><i>(* skips lines *)
  </i></font>Writeln<font color="#000080">(</font><font color="#800000">'The solutions to your sytem of equations are:'</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>N <font color="#FF0000"><b>do
  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'X('</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">') := '</font><font color="#000080">,</font>X_Mat1<font color="#000080">[</font>I<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;   </font><font color="#008000"><i>(* Procedure /output *)



{---------------------------------------------------------------------------}
(*                                                                         *)
(*                                                                         *)
(*                                                                         *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>begin

  Repeat
    </b></font>Instruct<font color="#000080">;  </font><font color="#008000"><i>(* calls Procedure Instruct *)
    </i></font>Initialize_Array<font color="#000080">(</font>Coeff_Mat<font color="#000080">, </font>Col_Mat<font color="#000080">, </font>X_Mat<font color="#000080">, </font>Scale_Vect<font color="#000080">, </font>order_Vect<font color="#000080">);
             </font><font color="#008000"><i>(* calls Procedure Initialize_Array *)
    </i></font><font color="#FF0000"><b>Repeat
      </b></font>Input<font color="#000080">(</font>N_EQNS<font color="#000080">, </font>Coeff_Mat<font color="#000080">, </font>Col_Mat<font color="#000080">); </font><font color="#008000"><i>(* calls Procedure Input *)
      </i></font>Check_Input<font color="#000080">(</font>Coeff_Mat<font color="#000080">,</font>N_EQNS<font color="#000080">,</font>Ans<font color="#000080">); </font><font color="#008000"><i>(* calls Procedure check_Input *)
    </i></font><font color="#FF0000"><b>Until </b></font>Ans <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'y'</font><font color="#000080">]; </font><font color="#008000"><i>(* loops Until user inputs correct matrix *)

    </i></font>order<font color="#000080">(</font>Scale_Vect<font color="#000080">,</font>order_Vect<font color="#000080">,</font>Coeff_Mat<font color="#000080">,</font>N_EQNS<font color="#000080">); </font><font color="#008000"><i>(* calls Procedure order *)
    </i></font>Eliminate<font color="#000080">(</font>Col_Mat<font color="#000080">,</font>Scale_Vect<font color="#000080">,</font>Coeff_Mat<font color="#000080">,</font>order_Vect<font color="#000080">,</font>N_EQNS<font color="#000080">);   </font><font color="#008000"><i>(*etc..*)
    </i></font>Substitute<font color="#000080">(</font>Col_Mat<font color="#000080">,</font>X_Mat<font color="#000080">,</font>Coeff_Mat<font color="#000080">,</font>order_Vect<font color="#000080">,</font>N_EQNS<font color="#000080">);       </font><font color="#008000"><i>(*etc..*)
    </i></font>Output<font color="#000080">(</font>X_Mat<font color="#000080">,</font>N_EQNS<font color="#000080">);                                        </font><font color="#008000"><i>(*etc..*)

    </i></font>Writeln<font color="#000080">;
    </font>Write<font color="#000080">(</font><font color="#800000">'Do you wish to solve another system of equations?(Y/N):'</font><font color="#000080">);
    </font>readln<font color="#000080">(</font>Ans<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>Ans <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'N'</font><font color="#000080">,</font><font color="#800000">'n'</font><font color="#000080">];


</font><font color="#FF0000"><b>end</b></font><font color="#000080">. </font><font color="#008000"><i>(*************** end of Program GAUSS_ELIMinATION *******************)
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0005.PAS">Original</a><b>]</b></p></body>
</html>
