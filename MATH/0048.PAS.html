<html>
<head><title> "Math Evaluations" by WARREN PORTER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: WARREN PORTER
Subj: eval
Program to evaluate expressions using a stack. }

</i></font><font color="#FF0000"><b>const
  </b></font>Maxstack <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;

</font><font color="#FF0000"><b>type

  </b></font>stack <font color="#000080">= </font><font color="#FF0000"><b>record
        </b></font>top <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">..</font>Maxstack<font color="#000080">;
        </font>Item <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxstack<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char
        <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>RealStack <font color="#000080">= </font><font color="#FF0000"><b>record
        </b></font>top<font color="#000080">: </font><font color="#800000">0</font><font color="#000080">..</font>Maxstack<font color="#000080">;
        </font>Item <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxstack<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>real
        <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>xptype <font color="#000080">= </font><font color="#FF0000"><b>record
        </b></font>oper <font color="#000080">: </font>char<font color="#000080">;
        </font>opnd <font color="#000080">: </font>real
        <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Empty<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>stack<font color="#000080">):</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Empty<font color="#000080">:= </font>A<font color="#000080">.</font>top <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Pop<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>stack<font color="#000080">):</font>char<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  if </b></font>A<font color="#000080">.</font>Top <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Attempt to pop an empty stack'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Pop<font color="#000080">:= </font>A<font color="#000080">.</font>item<font color="#000080">[</font>A<font color="#000080">.</font>top<font color="#000080">];
  </font>A<font color="#000080">.</font>top<font color="#000080">:= </font>A<font color="#000080">.</font>top <font color="#000080">- </font><font color="#800000">1
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Push<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>stack<font color="#000080">; </font>Nchar<font color="#000080">:</font>char<font color="#000080">);

</font><font color="#FF0000"><b>Begin
  if </b></font>A<font color="#000080">.</font>Top <font color="#000080">= </font>Maxstack <font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Stack already full'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>A<font color="#000080">.</font>top<font color="#000080">:= </font>A<font color="#000080">.</font>top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>A<font color="#000080">.</font>item<font color="#000080">[</font>A<font color="#000080">.</font>top<font color="#000080">]:=</font>Nchar
<font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#008000"><i>{The following functions are for the real stack only.}

</i></font><font color="#FF0000"><b>Function </b></font>REmpty<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>D<font color="#000080">:</font>RealStack<font color="#000080">):</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>REmpty<font color="#000080">:= </font>D<font color="#000080">.</font>top <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>RPop<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>D<font color="#000080">:</font>RealStack<font color="#000080">):</font>real<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  if </b></font>D<font color="#000080">.</font>Top <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Attempt to pop an empty RealStack'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>RPop<font color="#000080">:= </font>D<font color="#000080">.</font>item<font color="#000080">[</font>D<font color="#000080">.</font>top<font color="#000080">];
  </font>D<font color="#000080">.</font>top<font color="#000080">:= </font>D<font color="#000080">.</font>top <font color="#000080">- </font><font color="#800000">1
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RPush<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>D<font color="#000080">:</font>RealStack<font color="#000080">; </font>Nreal<font color="#000080">:</font>real<font color="#000080">);

</font><font color="#FF0000"><b>Begin
  if </b></font>D<font color="#000080">.</font>Top <font color="#000080">= </font>MaxStack <font color="#FF0000"><b>then
    begin
      </b></font>writeln<font color="#000080">(</font><font color="#800000">'Stack already full'</font><font color="#000080">);
      </font>halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>D<font color="#000080">.</font>top<font color="#000080">:= </font>D<font color="#000080">.</font>top <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>D<font color="#000080">.</font>item<font color="#000080">[</font>D<font color="#000080">.</font>top<font color="#000080">]:=</font>Nreal
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>pri<font color="#000080">(</font>op1<font color="#000080">, </font>op2<font color="#000080">:</font>char<font color="#000080">):</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>tpri<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  if </b></font>op2 <font color="#000080">= </font><font color="#800000">')' </font><font color="#FF0000"><b>then
    </b></font>tpri<font color="#000080">:= </font>true                            <font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>op1 <font color="#000080">= </font><font color="#800000">'$'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>op2 <font color="#000080">&lt;&gt; </font><font color="#800000">'$'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>op2 <font color="#000080">&lt;&gt; </font><font color="#800000">'('</font><font color="#000080">)  </font><font color="#FF0000"><b>then
    </b></font>tpri<font color="#000080">:= </font>true                            <font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>op1 <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'*'</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>op2 <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
    </b></font>tpri<font color="#000080">:= </font>true
  <font color="#FF0000"><b>else
    </b></font>tpri<font color="#000080">:= </font>false<font color="#000080">;
  </font>pri<font color="#000080">:= </font>tpri<font color="#008000"><i>{;
  write('Eval op 1= ',op1, ' op2 = ',op2);
  if tpri= false then
     writeln(' false')
  else
     writeln(' true')}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ConvReal<font color="#000080">(</font>a<font color="#000080">:</font>real<font color="#000080">;</font>NumDec<font color="#000080">:</font>integer<font color="#000080">):</font>real<font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>i<font color="#000080">, </font>tenpower<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>tenpower<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NumDec <font color="#FF0000"><b>do
      </b></font>tenpower<font color="#000080">:= </font>tenpower <font color="#000080">* </font><font color="#800000">10</font><font color="#000080">;
   </font>ConvReal<font color="#000080">:= </font>a <font color="#000080">/ </font>tenpower
<font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ROper<font color="#000080">(</font>opnd1<font color="#000080">, </font>opnd2<font color="#000080">: </font>real<font color="#000080">; </font>oper<font color="#000080">: </font>char<font color="#000080">):</font>real<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>temp<font color="#000080">: </font>real<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   Case </b></font>oper <font color="#FF0000"><b>of
      </b></font><font color="#800000">'+'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>opnd1 <font color="#000080">+ </font>opnd2<font color="#000080">;
      </font><font color="#800000">'-'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>opnd1 <font color="#000080">- </font>opnd2<font color="#000080">;
      </font><font color="#800000">'*'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>opnd1 <font color="#000080">* </font>opnd2<font color="#000080">;
      </font><font color="#800000">'/'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>opnd1 <font color="#000080">/ </font>opnd2<font color="#000080">;
      </font><font color="#800000">'$'</font><font color="#000080">: </font>temp<font color="#000080">:= </font>exp<font color="#000080">(</font>ln<font color="#000080">(</font>opnd1<font color="#000080">) * </font>opnd2<font color="#000080">)
   </font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{Case}     </i></font><font color="#000080">;
   </font><font color="#008000"><i>{Writeln(opnd1:6:3,' ',oper,' ',opnd2:6:3 ,' = ',temp:6:3);}
   </i></font>ROper <font color="#000080">:= </font>temp
<font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{R oper}

{Main procedure starts here}

</i></font><font color="#FF0000"><b>var
  </b></font>A<font color="#000080">: </font>stack<font color="#000080">;
  </font>Inbuff<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font>Maxstack<font color="#000080">];
  </font>len<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>NumDecPnt<font color="#000080">, </font>lenexp<font color="#000080">: </font>integer<font color="#000080">;
  </font>temp<font color="#000080">, </font>opnd1<font color="#000080">, </font>opnd2<font color="#000080">, </font>result <font color="#000080">: </font>real<font color="#000080">;
  </font>valid<font color="#000080">, </font>expdigit<font color="#000080">, </font>expdec<font color="#000080">, </font>isneg<font color="#000080">, </font>openok<font color="#000080">: </font>boolean<font color="#000080">;
  </font>operators<font color="#000080">, </font>digits <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>char<font color="#000080">;
  </font>HoldTop <font color="#000080">: </font>char<font color="#000080">;
  </font>B<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxstack<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>xptype<font color="#000080">;
  </font>C<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxstack<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>xptype<font color="#000080">;
  </font>D<font color="#000080">: </font>RealStack<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>digits<font color="#000080">:= [</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">];
  </font>operators<font color="#000080">:= [</font><font color="#800000">'$'</font><font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">,</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">'('</font><font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">];
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Enter expression to evaluate or RETURN to stop'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'A space should follow a minus sign unless it is used to'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'negate the following number.  Real numbers with multi-'</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font><font color="#800000">'digits and decimal point (if needed) may be entered.'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Readln<font color="#000080">(</font>Inbuff<font color="#000080">);
  </font>len<font color="#000080">:=</font>length<font color="#000080">(</font>Inbuff<font color="#000080">);

  </font><font color="#FF0000"><b>repeat
    </b></font>i<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>A<font color="#000080">.</font>top<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>valid<font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      if </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'('</font><font color="#000080">,</font><font color="#800000">'['</font><font color="#000080">,</font><font color="#800000">'{'</font><font color="#000080">] </font><font color="#FF0000"><b>then
        </b></font>push<font color="#000080">(</font>A<font color="#000080">,</font>Inbuff<font color="#000080">[</font>i<font color="#000080">])
      </font><font color="#FF0000"><b>else
        if </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">')'</font><font color="#000080">,</font><font color="#800000">']'</font><font color="#000080">,</font><font color="#800000">'}'</font><font color="#000080">] </font><font color="#FF0000"><b>then
          if </b></font>empty<font color="#000080">(</font>A<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>valid<font color="#000080">:= </font>false
          <font color="#FF0000"><b>else
            if </b></font><font color="#000080">(</font>ord<font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font>Pop<font color="#000080">(</font>A<font color="#000080">))) &gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
              </b></font>valid<font color="#000080">:= </font>false<font color="#000080">;
      </font>i<font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font>len<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>valid<font color="#000080">);
    </font><font color="#FF0000"><b>if not </b></font>empty<font color="#000080">(</font>A<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>valid<font color="#000080">:= </font>false<font color="#000080">;
    </font><font color="#FF0000"><b>if not </b></font>valid <font color="#FF0000"><b>then
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'The expression is invalid'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      Begin
         </b></font><font color="#008000"><i>{Change all groupings to parenthesis}
         </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>len <font color="#FF0000"><b>do Begin
           if </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'['</font><font color="#000080">,</font><font color="#800000">'{'</font><font color="#000080">] </font><font color="#FF0000"><b>then
              </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">'('  </font><font color="#FF0000"><b>else
           if </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">']'</font><font color="#000080">,</font><font color="#800000">'}'</font><font color="#000080">] </font><font color="#FF0000"><b>then
              </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">]:= </font><font color="#800000">')'</font><font color="#000080">;
           </font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
           </font>B<font color="#000080">[</font>i<font color="#000080">].</font>opnd<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
           </font>C<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
           </font>C<font color="#000080">[</font>i<font color="#000080">].</font>opnd<font color="#000080">:= </font><font color="#800000">0    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font><font color="#008000"><i>{ The B array will be the reformatted input string.
           The C array will be the postfix expression. }

         </i></font>i<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>j<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font>expdigit<font color="#000080">:= </font>false<font color="#000080">; </font>expdec<font color="#000080">:= </font>false<font color="#000080">; </font>isneg<font color="#000080">:= </font>false<font color="#000080">;
         </font><font color="#FF0000"><b>while </b></font>i <font color="#000080">&lt;= </font>len <font color="#FF0000"><b>do
            Begin
               if </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>then
                  Begin
                     </b></font>isneg<font color="#000080">:= </font>true<font color="#000080">;
                     </font>i<font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'.' </font><font color="#000080">) </font><font color="#FF0000"><b>then  Begin
                  </b></font>i<font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                  </font>expdec<font color="#000080">:= </font>true            <font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits <font color="#FF0000"><b>then
                  Begin
                     if </b></font>expdec <font color="#FF0000"><b>then
                        </b></font>NumDecPnt<font color="#000080">:= </font>NumDecPnt <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>if </b></font>expdigit <font color="#FF0000"><b>then
                        </b></font>temp<font color="#000080">:= </font>temp <font color="#000080">* </font><font color="#800000">10 </font><font color="#000080">+ </font>ord<font color="#000080">(</font>inbuff<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">)
                     </font><font color="#FF0000"><b>else                  Begin
                        </b></font>temp<font color="#000080">:= </font>ord<font color="#000080">(</font>inbuff<font color="#000080">[</font>i<font color="#000080">]) - </font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
                        </font>expdigit<font color="#000080">:= </font>true    <font color="#FF0000"><b>End
                  End
               else
                  if </b></font>expdigit <font color="#000080">= </font>true <font color="#FF0000"><b>then    Begin
                     if </b></font>isneg <font color="#FF0000"><b>then
                        </b></font>temp<font color="#000080">:= </font>temp <font color="#000080">* -</font><font color="#800000">1</font><font color="#000080">;
                     </font>B<font color="#000080">[</font>j<font color="#000080">].</font>opnd<font color="#000080">:= </font>ConvReal<font color="#000080">(</font>temp<font color="#000080">,</font>NumDecPnt<font color="#000080">);
                     </font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                     </font>expdigit <font color="#000080">:= </font>false<font color="#000080">;
                     </font>expdec   <font color="#000080">:= </font>false<font color="#000080">;
                     </font>NumDecPnt<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
                     </font>isneg<font color="#000080">:= </font>false           <font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#FF0000"><b>If </b></font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>operators     <font color="#FF0000"><b>then Begin
                  </b></font>B<font color="#000080">[</font>j<font color="#000080">].</font>oper<font color="#000080">:= </font>Inbuff<font color="#000080">[</font>i<font color="#000080">];
                  </font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1                       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font><font color="#FF0000"><b>if not </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">)    </font><font color="#FF0000"><b>and
                  not </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>operators<font color="#000080">) </font><font color="#FF0000"><b>and
                  not </b></font><font color="#000080">(</font>Inbuff<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>then                Begin
                  </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Found invalid operator: '</font><font color="#000080">,</font>Inbuff<font color="#000080">[</font>i<font color="#000080">]);
                  </font>valid<font color="#000080">:= </font>false                             <font color="#FF0000"><b>End</b></font><font color="#000080">;

               </font>i<font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;

            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;  </font><font color="#008000"><i>{While loop to parse string.}

            </i></font><font color="#FF0000"><b>if </b></font>expdigit <font color="#000080">= </font>true <font color="#FF0000"><b>then    Begin
               if </b></font>isneg <font color="#FF0000"><b>then
                  </b></font>temp<font color="#000080">:= </font>temp <font color="#000080">* -</font><font color="#800000">1</font><font color="#000080">;
               </font>B<font color="#000080">[</font>j<font color="#000080">].</font>opnd<font color="#000080">:= </font>ConvReal<font color="#000080">(</font>temp<font color="#000080">,</font>NumDecPnt<font color="#000080">);
               </font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
               </font>expdigit <font color="#000080">:= </font>false<font color="#000080">;
               </font>expdec   <font color="#000080">:= </font>false<font color="#000080">;
               </font>NumDecPnt<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
               </font>isneg<font color="#000080">:= </font>false           <font color="#FF0000"><b>End</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{First if valid loop.  Next one won't run if invalid operator}

    </i></font><font color="#FF0000"><b>if </b></font>valid <font color="#FF0000"><b>then
      Begin
         </b></font>lenexp<font color="#000080">:= </font>j <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>{Length of converted expression}
         </i></font>writeln<font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lenexp <font color="#FF0000"><b>do
            Begin
               if </b></font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper <font color="#000080">= </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
                  </b></font>write<font color="#000080">(</font>B<font color="#000080">[</font>i<font color="#000080">].</font>opnd<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">)
               </font><font color="#FF0000"><b>else
                  </b></font>write<font color="#000080">(</font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">);
               </font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">)
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font><font color="#008000"><i>{Ready to create postfix expression in array C }

         </i></font>A<font color="#000080">.</font>top<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
         </font>j<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

         </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lenexp <font color="#FF0000"><b>do
            Begin
               </b></font><font color="#008000"><i>{writeln('i = ',i);}
               </i></font><font color="#FF0000"><b>if </b></font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper <font color="#000080">= </font><font color="#800000">' ' </font><font color="#FF0000"><b>then       Begin
                  </b></font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                  </font>C<font color="#000080">[</font>j<font color="#000080">].</font>opnd<font color="#000080">:= </font>B<font color="#000080">[</font>i<font color="#000080">].</font>opnd      <font color="#FF0000"><b>End
               else
                  Begin
                  </b></font>openok <font color="#000080">:= </font>true<font color="#000080">;
                     </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>empty<font color="#000080">(</font>A<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>openok <font color="#FF0000"><b>and
                           </b></font>pri<font color="#000080">(</font>A<font color="#000080">.</font>item<font color="#000080">[</font>A<font color="#000080">.</font>top<font color="#000080">],</font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">)) </font><font color="#FF0000"><b>do
                        Begin
                           </b></font>HoldTop<font color="#000080">:= </font>pop<font color="#000080">(</font>A<font color="#000080">);
                           </font><font color="#FF0000"><b>if </b></font>HoldTop <font color="#000080">= </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
                              </b></font>openok<font color="#000080">:= </font>false
                           <font color="#FF0000"><b>else
                              Begin
                                 </b></font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                                 </font>C<font color="#000080">[</font>j<font color="#000080">].</font>oper<font color="#000080">:=</font>HoldTop
                              <font color="#FF0000"><b>End
                        End</b></font><font color="#000080">;
                     </font><font color="#FF0000"><b>if </b></font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper <font color="#000080">&lt;&gt; </font><font color="#800000">')' </font><font color="#FF0000"><b>then
                        </b></font>push<font color="#000080">(</font>A<font color="#000080">,</font>B<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">);
                  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{Else}
            </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{For loop}

            </i></font><font color="#FF0000"><b>while not </b></font>empty<font color="#000080">(</font>A<font color="#000080">) </font><font color="#FF0000"><b>do
               Begin
                  </b></font>HoldTop<font color="#000080">:= </font>pop<font color="#000080">(</font>A<font color="#000080">);
                  </font><font color="#FF0000"><b>if </b></font>HoldTop <font color="#000080">&lt;&gt; </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
                     Begin
                        </b></font>j<font color="#000080">:= </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
                        </font>C<font color="#000080">[</font>j<font color="#000080">].</font>oper<font color="#000080">:=</font>HoldTop
                     <font color="#FF0000"><b>End
               End</b></font><font color="#000080">;

         </font>lenexp<font color="#000080">:= </font>j<font color="#000080">;  </font><font color="#008000"><i>{Since parenthesis are not included in postfix.}

         </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lenexp <font color="#FF0000"><b>do
            Begin
               if </b></font>C<font color="#000080">[</font>i<font color="#000080">].</font>oper <font color="#000080">= </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
                  </b></font>write<font color="#000080">(</font>C<font color="#000080">[</font>i<font color="#000080">].</font>opnd<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">)
               </font><font color="#FF0000"><b>else
                  </b></font>write<font color="#000080">(</font>C<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">);
               </font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">)
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font><font color="#008000"><i>{The following evaluates the expression in the real stack}

         </i></font>D<font color="#000080">.</font>top<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lenexp <font color="#FF0000"><b>do
            Begin
               if </b></font>C<font color="#000080">[</font>i<font color="#000080">].</font>oper <font color="#000080">= </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
                  </b></font>Rpush<font color="#000080">(</font>D<font color="#000080">,</font>C<font color="#000080">[</font>i<font color="#000080">].</font>opnd<font color="#000080">)
               </font><font color="#FF0000"><b>else
                  Begin
                     </b></font>opnd2<font color="#000080">:= </font>Rpop<font color="#000080">(</font>D<font color="#000080">);
                     </font>opnd1<font color="#000080">:= </font>Rpop<font color="#000080">(</font>D<font color="#000080">);
                     </font>result<font color="#000080">:= </font>ROper<font color="#000080">(</font>opnd1<font color="#000080">,</font>opnd2<font color="#000080">,</font>C<font color="#000080">[</font>i<font color="#000080">].</font>oper<font color="#000080">);
                     </font>Rpush<font color="#000080">(</font>D<font color="#000080">,</font>result<font color="#000080">)
                  </font><font color="#FF0000"><b>End </b></font><font color="#008000"><i>{else}
            </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{for loop}
         </i></font>result<font color="#000080">:= </font>Rpop<font color="#000080">(</font>D<font color="#000080">);
         </font><font color="#FF0000"><b>if </b></font>Rempty<font color="#000080">(</font>D<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>writeln<font color="#000080">(</font><font color="#800000">'    = '</font><font color="#000080">,</font>result<font color="#000080">:</font><font color="#800000">2</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">)
         </font><font color="#FF0000"><b>else
            </b></font>writeln<font color="#000080">(</font><font color="#800000">'    Could not evaluate'</font><font color="#000080">,</font>chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">))
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font>Readln<font color="#000080">(</font>Inbuff<font color="#000080">);
    </font>len<font color="#000080">:= </font>length<font color="#000080">(</font>Inbuff<font color="#000080">)
  </font><font color="#FF0000"><b>until </b></font>len <font color="#000080">= </font><font color="#800000">0
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0048.PAS">Original</a><b>]</b></p></body>
</html>
