<html>
<head><title> "Factoral Program" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>PROGRAM </b></font>Fact<font color="#000080">;
</font><font color="#008000"><i>{************************************************
* FACTOR - Lookup table demonstration using the        *
* factorial series.                                                                      *
*                                               *
*************************************************}

{$N+,E+}     {Set so you can use other real types}
</i></font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">,</font>Dos<font color="#000080">,</font>Timer<font color="#000080">;   </font><font color="#008000"><i>{ t1Start, t1Get, t1Format }
</i></font><font color="#FF0000"><b>CONST
   </b></font>BigFact <font color="#000080">= </font><font color="#800000">500</font><font color="#000080">;  </font><font color="#008000"><i>{largest factorial is for 1754}
</i></font><font color="#FF0000"><b>TYPE   </b></font><font color="#008000"><i>{defined type for file definition later}
    </i></font>TableType <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>BigFact<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Extended<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>Table <font color="#000080">: </font>TableType<font color="#000080">;

</font><font color="#008000"><i>{************************************************
* factorial - compute the factorial of a number        *
*                                               *
* INP:        i - the # to compute the factorial of        *
* OUT:        The factorial of the number, unless a        *
*                number greater than BIG_FACT or less      *
*                than zero is passed in (which results     *
*                in 0.0).                                  *
*************************************************}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Factorial<font color="#000080">(</font>I<font color="#000080">: </font>Integer<font color="#000080">): </font>Extended<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>K <font color="#000080">: </font>Integer<font color="#000080">;
        </font>F <font color="#000080">: </font>Extended<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        IF </b></font>I <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                </b></font>F <font color="#000080">:= </font><font color="#800000">1
        </font><font color="#FF0000"><b>ELSE
       BEGIN
          IF </b></font><font color="#000080">(</font>I <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>I <font color="#000080">&lt;= </font>BigFact<font color="#000080">) </font><font color="#FF0000"><b>THEN
             BEGIN
                </b></font>F <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>FOR </b></font>K <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>I <font color="#FF0000"><b>DO
                   </b></font>F <font color="#000080">:= </font>F <font color="#000080">* </font>K
             <font color="#FF0000"><b>END
          ELSE
             </b></font>F <font color="#000080">:= </font><font color="#800000">0
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>Factorial <font color="#000080">:= </font>F
<font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{************************************************
* Main - generate &amp; save table of factorials    *
*************************************************}

</i></font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">, </font>J<font color="#000080">, </font>N            <font color="#000080">: </font>Integer<font color="#000080">;
   </font>F                  <font color="#000080">: </font>Extended<font color="#000080">;
   </font>T1<font color="#000080">, </font>T2<font color="#000080">, </font>T3         <font color="#000080">: </font>Longint<font color="#000080">;
   </font>Facts              <font color="#000080">: </font><font color="#FF0000"><b>FILE OF </b></font>TableType<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
        </b></font><font color="#008000"><i>{ STEP 1 - compute each factorial 5 times }
   </i></font>ClrScr<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Now computing each factorial 5 times'</font><font color="#000080">);
        </font>T1 <font color="#000080">:= </font>tStart<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
                FOR </b></font>J <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
                        </b></font>F <font color="#000080">:= </font>Factorial<font color="#000080">(</font>J<font color="#000080">);              </font><font color="#008000"><i>{ f=j! }
        </i></font>T2 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Computing all factorials from 0..n '</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'5 times took '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T2<font color="#000080">),
                </font><font color="#800000">' secs.'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">;
        </font><font color="#008000"><i>{ STEP 2 - compute the table, then look up
                                 each factorial 5 times.                        }
        </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'Now compute table and look up each '</font><font color="#000080">,
                </font><font color="#800000">'factorial 5 times.'</font><font color="#000080">);
        </font>T1 <font color="#000080">:= </font>tStart<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
                </b></font>Table<font color="#000080">[</font>I<font color="#000080">] := </font>Factorial<font color="#000080">(</font>I<font color="#000080">);
        </font>T2 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
                FOR </b></font>J <font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
                        </b></font>F <font color="#000080">:= </font>Table<font color="#000080">[</font>J<font color="#000080">]; </font><font color="#008000"><i>{ f=j! }
        </i></font>T3 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Computing table took '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T2<font color="#000080">),
                </font><font color="#800000">' seconds'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Looking up each factorial 5 times to'</font><font color="#000080">,
           </font><font color="#800000">'ok '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T2<font color="#000080">,</font>T3<font color="#000080">),</font><font color="#800000">' seconds'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Total: '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T3<font color="#000080">),</font><font color="#800000">' seconds'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">;
</font><font color="#008000"><i>{STEP 3 - Compute each factorial as it is needed}
        </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'Clearing the table,'</font><font color="#000080">,
                </font><font color="#800000">' and computing each '</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'factorial as it is needed'</font><font color="#000080">,
                </font><font color="#800000">' (for 5) lookups.'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">;
        </font>T1 <font color="#000080">:= </font>tStart<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
                </b></font>Table<font color="#000080">[</font>I<font color="#000080">] := -</font><font color="#800000">1</font><font color="#000080">;            </font><font color="#008000"><i>{ unknown Val }
        </i></font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
                FOR </b></font>J <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
           BEGIN
                        </b></font>F <font color="#000080">:= </font>Table<font color="#000080">[</font>J<font color="#000080">];
                        </font><font color="#FF0000"><b>IF </b></font>F <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                                BEGIN
                                  </b></font>F <font color="#000080">:= </font>Factorial<font color="#000080">(</font>J<font color="#000080">);
                        </font>Table<font color="#000080">[</font>J<font color="#000080">] := </font>F    <font color="#008000"><i>{ F = J! }
                </i></font><font color="#FF0000"><b>END
           END</b></font><font color="#000080">;
        </font>T2 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Clearing table and computing each'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">' factorial as it was needed for 5'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'lookups took '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T2<font color="#000080">),
           </font><font color="#800000">' secs.'</font><font color="#000080">);
        </font><font color="#008000"><i>{ STEP 4 - write the table to disk (we are
     not timing this step, because if you are
     loading it from disk,        you presumably do not
     care how long it took to compute it.      }
   </i></font>Assign<font color="#000080">(</font>Facts<font color="#000080">,</font><font color="#800000">'Fact_tbl.tmp'</font><font color="#000080">);
   </font>Rewrite<font color="#000080">(</font>Facts<font color="#000080">);
   </font>Write<font color="#000080">(</font>Facts<font color="#000080">,</font>Table<font color="#000080">);
        </font>Close<font color="#000080">(</font>Facts<font color="#000080">);
        </font><font color="#008000"><i>{ Flush the disk buffer, so that the time
          is not affected by having the data in a
          disk buffer.                                                                }
        </i></font>Exec<font color="#000080">(</font><font color="#800000">'C:\COMMAND.COM'</font><font color="#000080">,</font><font color="#800000">'/C CHKDSK'</font><font color="#000080">);
        </font><font color="#008000"><i>{ STEP 5 - read the table from disk, and
                                 use each factorial 5 times                }
        </i></font>T1 <font color="#000080">:= </font>tStart<font color="#000080">;
   </font>Assign<font color="#000080">(</font>Facts<font color="#000080">,</font><font color="#800000">'Fact_tbl.TMP'</font><font color="#000080">);
   </font>Reset<font color="#000080">(</font>Facts<font color="#000080">);
   </font>Read<font color="#000080">(</font>Facts<font color="#000080">,</font>Table<font color="#000080">);
   </font>Close<font color="#000080">(</font>Facts<font color="#000080">);
        </font>T2 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">4 </font><font color="#FF0000"><b>DO
                FOR </b></font>J <font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
           </b></font>F <font color="#000080">:= </font>Table<font color="#000080">[</font>J<font color="#000080">];                 </font><font color="#008000"><i>{ f=j! }
        </i></font>T3 <font color="#000080">:= </font>tGet<font color="#000080">;
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Reading the Table from disk took '</font><font color="#000080">,
                        </font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T2<font color="#000080">),</font><font color="#800000">' seconds.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Looking up each Factorial 5 times '</font><font color="#000080">,
        </font><font color="#800000">'to ok took '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T2<font color="#000080">,</font>T3<font color="#000080">),</font><font color="#800000">' seconds.'</font><font color="#000080">);
        </font>WriteLn<font color="#000080">(</font><font color="#800000">'Total: '</font><font color="#000080">,</font>tFormat<font color="#000080">(</font>T1<font color="#000080">,</font>T3<font color="#000080">),</font><font color="#800000">' seconds.'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">;
   </font>WriteLn<font color="#000080">(</font><font color="#800000">'Press Enter TO see the factorials'</font><font color="#000080">);
   </font>ReadLN<font color="#000080">;
   </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>BigFact <font color="#FF0000"><b>DO
      </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'['</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">'] = '</font><font color="#000080">,</font>Table<font color="#000080">[</font>I<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0022.PAS">Original</a><b>]</b></p></body>
</html>
