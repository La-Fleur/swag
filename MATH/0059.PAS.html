<html>
<head><title> "Text Formula Parser" by WIM VAN DER VEGT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&sup3; I've written a pwoerfull formula evaluator which can be extended
&sup3; during run-time by adding fuctions, vars and strings containing
&sup3; Because its not very small post me a message if you want to receive it.

Here it goes. It's a unit and an example/demo of some features.

{---------------------------------------------------------}
{  Project : Text Formula Parser                          }
{  Auteur  : G.W. van der Vegt                            }
{---------------------------------------------------------}
{  Datum .tijd  Revisie                                   }
{  900530.1900  Creatie (function call/exits removed)     }
{  900531.1900  Revisie (Boolean expressions)             }
{  900104.2100  Revisie (HEAP Function Storage)           }
{  910327.1345  External Real string vars (tfp_realstr)   }
{               are corrected the same way as the parser  }
{               corrects them before using TURBO's VAL    }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>UNIT </b></font>Tfp_01<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

</b></font><font color="#008000"><i>{---------------------------------------------------------}
{----Initializes function database                        }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_init<font color="#000080">(</font>no <font color="#000080">: </font>INTEGER<font color="#000080">);

</font><font color="#008000"><i>{---------------------------------------------------------}
{----Parses s and returns REAL or STR(REAL:m:n)           }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Tfp_parse2real<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>Tfp_parse2str<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;</font>m<font color="#000080">,</font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{----Tfp_errormsg(tfp_ernr) returns errormessage          }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>VAR
  </b></font>Tfp_ernr  <font color="#000080">: </font>BYTE<font color="#000080">;                     </font><font color="#008000"><i>{----Errorcode}

</i></font><font color="#FF0000"><b>FUNCTION  </b></font>Tfp_errormsg<font color="#000080">(</font>nr <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;


</font><font color="#008000"><i>{---------------------------------------------------------}
{----Internal structure for functions/vars                }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>TYPE
  </b></font>tfp_fname <font color="#000080">= </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">];               </font><font color="#008000"><i>{----String name                     }

  </i></font>tfp_ftype <font color="#000080">= (</font>tfp_noparm<font color="#000080">,              </font><font color="#008000"><i>{----Function or Function()          }
               </i></font>tfp_1real<font color="#000080">,               </font><font color="#008000"><i>{----Function(VAR r)                 }
               </i></font>tfp_2real<font color="#000080">,               </font><font color="#008000"><i>{----Function(VAR r1,r2)             }
               </i></font>tfp_nreal<font color="#000080">,               </font><font color="#008000"><i>{----Function(VAR r;n  INTEGER)      }
               </i></font>tfp_realvar<font color="#000080">,             </font><font color="#008000"><i>{----Real VAR                        }
               </i></font>tfp_intvar<font color="#000080">,              </font><font color="#008000"><i>{----Integer VAR                     }
               </i></font>tfp_boolvar<font color="#000080">,             </font><font color="#008000"><i>{----Boolean VAR                     }
               </i></font>tfp_realstr<font color="#000080">);            </font><font color="#008000"><i>{----Real String VAR                 }

</i></font><font color="#FF0000"><b>CONST
  </b></font>tfp_true  <font color="#000080">= </font><font color="#800000">1.0</font><font color="#000080">;                      </font><font color="#008000"><i>{----REAL value for BOOLEAN TRUE     }
  </i></font>tfp_false <font color="#000080">= </font><font color="#800000">0.0</font><font color="#000080">;                      </font><font color="#008000"><i>{----REAL value for BOOLEAN FALSE    }

{---------------------------------------------------------}
{----Adds own FUNCTION or VAR to the parser               }
{    All FUNCTIONS &amp; VARS must be compiled                }
{    with the FAR switch on                               }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addobj<font color="#000080">(</font>a <font color="#000080">: </font>pointer<font color="#000080">;</font>n <font color="#000080">: </font>tfp_fname<font color="#000080">;</font>t <font color="#000080">: </font>tfp_ftype<font color="#000080">);


</font><font color="#008000"><i>{---------------------------------------------------------}
{----Add Internal Function Packs                          }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addgonio<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addlogic<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addmath<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addmisc<font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>IMPLEMENTATION

CONST
  </b></font>maxreal  <font color="#000080">= +</font><font color="#800000">9.99999999e37</font><font color="#000080">;            </font><font color="#008000"><i>{----Internal maxreal                }
  </i></font>maxparm  <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;                        </font><font color="#008000"><i>{----Maximum number of parameters    }

</i></font><font color="#FF0000"><b>VAR
  </b></font>maxfie   <font color="#000080">: </font>INTEGER<font color="#000080">;                   </font><font color="#008000"><i>{----max no of functions &amp; vars      }
  </i></font>fiesiz   <font color="#000080">: </font>INTEGER<font color="#000080">;                   </font><font color="#008000"><i>{----current no of functions &amp; vars  }

</i></font><font color="#FF0000"><b>TYPE
  </b></font>fie      <font color="#000080">= </font><font color="#FF0000"><b>RECORD
               </b></font>fname <font color="#000080">: </font>tfp_fname<font color="#000080">;       </font><font color="#008000"><i>{----Name of function or var         }
               </i></font>faddr <font color="#000080">: </font>POINTER<font color="#000080">;         </font><font color="#008000"><i>{----FAR POINTER to function or var  }
               </i></font>ftype <font color="#000080">: </font>tfp_ftype<font color="#000080">;       </font><font color="#008000"><i>{----Type of entry                   }
             </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>fieptr   <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>fie<font color="#000080">;        </font><font color="#008000"><i>{----Will be used as [1..maxfie]     }

</i></font><font color="#FF0000"><b>VAR
  </b></font>fiearr   <font color="#000080">: ^</font>fieptr<font color="#000080">;                   </font><font color="#008000"><i>{----Array of functions &amp; vars       }

{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>VAR
  </b></font>Line     <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;                    </font><font color="#008000"><i>{----Internal copy of string to Parse}
  </i></font>Lp       <font color="#000080">: </font>INTEGER<font color="#000080">;                   </font><font color="#008000"><i>{----Parsing Pointer into Line       }
  </i></font>Nextchar <font color="#000080">: </font>CHAR<font color="#000080">;                      </font><font color="#008000"><i>{----Character at Lp Postion         }

{---------------------------------------------------------}
{----Tricky stuff to call FUNCTIONS                       }
{---------------------------------------------------------}

{$F+}

</i></font><font color="#FF0000"><b>VAR
  </b></font>GluePtr <font color="#000080">: </font>POINTER<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Call_noparm <font color="#000080">: </font>REAL<font color="#000080">;

 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$1E</font><font color="#000080">/</font>GluePtr<font color="#000080">);  </font><font color="#008000"><i>{CALL DWORD PTR GluePtr}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Call_1real<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">) : </font>REAL<font color="#000080">;

 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$1E</font><font color="#000080">/</font>GluePtr<font color="#000080">);  </font><font color="#008000"><i>{CALL DWORD PTR GluePtr}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Call_2real<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r1<font color="#000080">,</font>r2<font color="#000080">) : </font>REAL<font color="#000080">;

 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$1E</font><font color="#000080">/</font>GluePtr<font color="#000080">);  </font><font color="#008000"><i>{CALL DWORD PTR GluePtr}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Call_nreal<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">,</font>n<font color="#000080">) : </font>REAL<font color="#000080">;
 </font><font color="#FF0000"><b>INLINE</b></font><font color="#000080">(</font><font color="#800000">$FF</font><font color="#000080">/</font><font color="#800000">$1E</font><font color="#000080">/</font>GluePtr<font color="#000080">);  </font><font color="#008000"><i>{CALL DWORD PTR GluePtr}

{$F-}

{---------------------------------------------------------}
{----This routine skips one character                     }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Newchar<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>lp<font color="#000080">&lt;</font>LENGTH<font color="#000080">(</font>Line<font color="#000080">))
    </font><font color="#FF0000"><b>THEN </b></font>INC<font color="#000080">(</font>Lp<font color="#000080">);
  </font>Nextchar<font color="#000080">:=</font>UPCASE<font color="#000080">(</font>Line<font color="#000080">[</font>Lp<font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{----This routine skips one character and                 }
{    all folowing spaces from an expression               }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Skip<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  REPEAT
    </b></font>Newchar<font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{  Number     = Real    (Bv 23.4E-5)                      }
{               Integer (Bv -45)                          }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_number <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>Temp  <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font>Err   <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>value <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{----Correct .xx to 0.xx}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Nextchar<font color="#000080">=</font><font color="#800000">'.'</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Temp<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>Nextchar
    <font color="#FF0000"><b>ELSE </b></font>Temp<font color="#000080">:=</font>Nextchar<font color="#000080">;

  </font>Newchar<font color="#000080">;

</font><font color="#008000"><i>{----Correct &ntilde;.xx to &ntilde;0.xx}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>temp<font color="#000080">)=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Nextchar<font color="#000080">=</font><font color="#800000">'.'</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+</font><font color="#800000">'0'</font><font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">] </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+</font>Nextchar<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Nextchar<font color="#000080">=</font><font color="#800000">'E'</font><font color="#000080">)
        </font><font color="#FF0000"><b>THEN
          BEGIN
          </b></font><font color="#008000"><i>{----Correct &ntilde;xxx.E to &ntilde;xxx.0E}
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Temp<font color="#000080">[</font>LENGTH<font color="#000080">(</font>Temp<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'.'</font><font color="#000080">)
              </font><font color="#FF0000"><b>THEN </b></font>INSERT<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>Temp<font color="#000080">,</font>LENGTH<font color="#000080">(</font>Temp<font color="#000080">));
            </font>Newchar<font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">])
              </font><font color="#FF0000"><b>THEN
                BEGIN
                  </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+</font>Nextchar<font color="#000080">;
                  </font>Newchar<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END
        ELSE </b></font>Newchar<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{----Skip trailing spaces}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>line<font color="#000080">[</font>lp<font color="#000080">]=</font><font color="#800000">' '</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN WHILE </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>lp<font color="#000080">]=</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>INC<font color="#000080">(</font>lp<font color="#000080">);
  </font>nextchar<font color="#000080">:=</font>line<font color="#000080">[</font>lp<font color="#000080">];

</font><font color="#008000"><i>{----Correct &ntilde;xx. to &ntilde;xx.0 but NOT &ntilde;xxE&ntilde;yy.}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>temp<font color="#000080">[</font>LENGTH<font color="#000080">(</font>temp<font color="#000080">)]=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>AND
     </b></font><font color="#000080">(</font>POS<font color="#000080">(</font><font color="#800000">'E'</font><font color="#000080">,</font>temp<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+</font><font color="#800000">'0'</font><font color="#000080">;

  </font>VAL<font color="#000080">(</font>Temp<font color="#000080">,</font>value<font color="#000080">,</font>Err<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Err<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_number<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_number<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_b_expr <font color="#000080">: </font>REAL<font color="#000080">; </font><font color="#FF0000"><b>FORWARD</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{  Factor     = Number                                    }
{    (External) Function()                                }
{    (External) Function(Expr)                            }
{    (External) Function(Expr,Expr)                       }
{     External  Var Real                                  }
{     External  Var Integer                               }
{     External  Var Boolean                               }
{     External  Var realstring                            }
{               (R_Expr)                                  }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_factor <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>ferr    <font color="#000080">: </font>BOOLEAN<font color="#000080">;
  </font>param   <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>dummy   <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>maxparm<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>REAL<font color="#000080">;
  </font>value<font color="#000080">,
  </font>dummy1<font color="#000080">,
  </font>dummy2  <font color="#000080">: </font>REAL<font color="#000080">;
  </font>temp    <font color="#000080">: </font>tfp_fname<font color="#000080">;
  </font>e<font color="#000080">,
  </font>i<font color="#000080">,
  </font>index   <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>temps   <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  CASE </b></font>Nextchar <font color="#FF0000"><b>OF
    </b></font><font color="#800000">'+'  </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Newchar<font color="#000080">;
             </font>value<font color="#000080">:=+</font>Eval_factor<font color="#000080">;
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#800000">'-'  </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Newchar<font color="#000080">;
             </font>value<font color="#000080">:=-</font>Eval_factor<font color="#000080">;
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,
    </font><font color="#800000">'.'  </font><font color="#000080">: </font>value<font color="#000080">:=</font>Eval_number<font color="#000080">;
    </font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'
         </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>ferr<font color="#000080">:=</font>TRUE<font color="#000080">;
             </font>Temp<font color="#000080">:=</font>Nextchar<font color="#000080">;
             </font>Skip<font color="#000080">;
             </font><font color="#FF0000"><b>WHILE </b></font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'_'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>DO
               BEGIN
                 </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+</font>Nextchar<font color="#000080">;
                 </font>Skip<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

           </font><font color="#008000"><i>{----Seek function and CALL it}
             {$R-}
             </i></font><font color="#FF0000"><b>FOR </b></font>Index<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Fiesiz <font color="#FF0000"><b>DO
               WITH </b></font>fiearr<font color="#000080">^[</font>index<font color="#000080">] </font><font color="#FF0000"><b>DO
                 IF </b></font><font color="#000080">(</font>fname<font color="#000080">=</font>temp<font color="#000080">)
                   </font><font color="#FF0000"><b>THEN
                     BEGIN
                       </b></font>ferr<font color="#000080">:=</font>FALSE<font color="#000080">;

                       </font><font color="#FF0000"><b>CASE </b></font>ftype <font color="#FF0000"><b>OF

                       </b></font><font color="#008000"><i>{----Function or Function()}
                         </i></font>tfp_noparm  <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>nextchar<font color="#000080">=</font><font color="#800000">'('</font><font color="#000080">)
                                        </font><font color="#FF0000"><b>THEN
                                          BEGIN
                                            </b></font>Skip<font color="#000080">;

                                            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">')'</font><font color="#000080">)
                                              </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                                            </font>Skip<font color="#000080">;
                                          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

                       </font><font color="#008000"><i>{----Function(r)}
                         </i></font>tfp_1real   <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>nextchar<font color="#000080">=</font><font color="#800000">'('</font><font color="#000080">)
                                         </font><font color="#FF0000"><b>THEN
                                           BEGIN
                                             </b></font>Skip<font color="#000080">;

                                             </font>dummy1<font color="#000080">:=</font>Eval_b_expr<font color="#000080">;

                                             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">')'</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                                             </font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ')'}
                                           </i></font><font color="#FF0000"><b>END
                                         ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                       </font><font color="#008000"><i>{----Function(r1,r2)}
                         </i></font>tfp_2real   <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>nextchar<font color="#000080">=</font><font color="#800000">'('</font><font color="#000080">)
                                         </font><font color="#FF0000"><b>THEN
                                           BEGIN
                                             </b></font>Skip<font color="#000080">;

                                             </font>dummy1<font color="#000080">:=</font>Eval_b_expr<font color="#000080">;

                                             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">','</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                                             </font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ','}
                                             </i></font>dummy2<font color="#000080">:=</font>Eval_b_expr<font color="#000080">;

                                              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                 </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">')'</font><font color="#000080">)
                                                </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                                              </font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ')'}
                                            </i></font><font color="#FF0000"><b>END
                                          ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                       </font><font color="#008000"><i>{----Function(r,n)}
                         </i></font>tfp_nreal   <font color="#000080">: </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>nextchar<font color="#000080">=</font><font color="#800000">'('</font><font color="#000080">)
                                         </font><font color="#FF0000"><b>THEN
                                           BEGIN
                                             </b></font>param<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

                                             </font>Skip<font color="#000080">;
                                             </font>dummy<font color="#000080">[</font>param<font color="#000080">]:=</font>Eval_b_expr<font color="#000080">;

                                             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">','</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15
                                               </font><font color="#FF0000"><b>ELSE
                                                 WHILE </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                       </b></font><font color="#000080">(</font>nextchar<font color="#000080">=</font><font color="#800000">','</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                       </b></font><font color="#000080">(</font>param<font color="#000080">&lt;</font>maxparm<font color="#000080">) </font><font color="#FF0000"><b>DO
                                                   BEGIN
                                                     </b></font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ','}
                                                     </i></font>INC<font color="#000080">(</font>param<font color="#000080">);
                                                     </font>dummy<font color="#000080">[</font>param<font color="#000080">]:=</font>Eval_b_expr<font color="#000080">;
                                                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

                                             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">')'</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;

                                             </font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ')'}
                                           </i></font><font color="#FF0000"><b>END
                                         ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;
                       </font><font color="#008000"><i>{----Real Var}
                         </i></font>tfp_realvar    <font color="#000080">: </font>dummy1<font color="#000080">:=</font>REAL<font color="#000080">(</font>faddr<font color="#000080">^);

                       </font><font color="#008000"><i>{----Integer Var}
                         </i></font>tfp_intvar     <font color="#000080">: </font>dummy1<font color="#000080">:=</font><font color="#800000">1.0</font><font color="#000080">*</font>INTEGER<font color="#000080">(</font>faddr<font color="#000080">^);

                       </font><font color="#008000"><i>{----Boolean Var}
                         </i></font>tfp_boolvar    <font color="#000080">: </font>dummy1<font color="#000080">:=</font><font color="#800000">1.0</font><font color="#000080">*</font>ORD<font color="#000080">(</font>BOOLEAN<font color="#000080">(</font>faddr<font color="#000080">^));

                       </font><font color="#008000"><i>{----Real string Var}
                         </i></font>tfp_realstr    <font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                                             </b></font>temps<font color="#000080">:=</font><font color="#FF0000"><b>STRING</b></font><font color="#000080">(</font>faddr<font color="#000080">^);

                                           </font><font color="#008000"><i>{----Delete Leading Spaces}
                                             </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>temps<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                   </b></font><font color="#000080">(</font>temps<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                                               </b></font>Delete<font color="#000080">(</font>temps<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

                                           </font><font color="#008000"><i>{----Delete Trailing Spaces}
                                             </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>temps<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                   </b></font><font color="#000080">(</font>temps<font color="#000080">[</font>Length<font color="#000080">(</font>temps<font color="#000080">)]=</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Do
                                               </b></font>Delete<font color="#000080">(</font>temps<font color="#000080">,</font>Length<font color="#000080">(</font>temps<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);

                                          </font><font color="#008000"><i>{----Correct .xx to 0.xx}
                                             </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>temps<font color="#000080">)&gt;=</font><font color="#800000">1</font><font color="#000080">)  </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>temps<font color="#000080">)&lt;</font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>temps<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'.'</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>Insert<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>temps<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

                                           </font><font color="#008000"><i>{----Correct &ntilde;.xx to &ntilde;0.xx}
                                             </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>temps<font color="#000080">)&gt;=</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>temps<font color="#000080">)&lt;</font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>temps<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>temps<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]=</font><font color="#800000">'.'</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>Insert<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>temps<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);

                                           </font><font color="#008000"><i>{----Correct xx.Eyy to xx0.Exx}
                                             </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.E'</font><font color="#000080">,</font>temps<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>temps<font color="#000080">)&lt;</font><font color="#800000">255</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>Insert<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>temps<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.E'</font><font color="#000080">,</font>temps<font color="#000080">));

                                           </font><font color="#008000"><i>{----Correct xx.eyy to xx0.exx}
                                             </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'.e'</font><font color="#000080">,</font>temps<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>temps<font color="#000080">)&lt;</font><font color="#800000">255</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>Insert<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>temps<font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.e'</font><font color="#000080">,</font>temps<font color="#000080">));
                                           </font><font color="#008000"><i>{----Correct &ntilde;xx. to &ntilde;xx.0 but NOT &ntilde;}
                                             </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>temps<font color="#000080">[</font>LENGTH<font color="#000080">(</font>temps<font color="#000080">)]=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>POS<font color="#000080">(</font><font color="#800000">'E'</font><font color="#000080">,</font>temps<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>POS<font color="#000080">(</font><font color="#800000">'e'</font><font color="#000080">,</font>temps<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                                                </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>temps<font color="#000080">)&lt;</font><font color="#800000">255</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>Temps<font color="#000080">:=</font>Temps<font color="#000080">+</font><font color="#800000">'0'</font><font color="#000080">;

                                             </font>VAL<font color="#000080">(</font>temps<font color="#000080">,</font>dummy1<font color="#000080">,</font>e<font color="#000080">);
                                             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>e<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
                                               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

                       </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                         </font><font color="#FF0000"><b>THEN
                           BEGIN
                             </b></font>glueptr<font color="#000080">:=</font>faddr<font color="#000080">;

                             </font><font color="#FF0000"><b>CASE </b></font>ftype <font color="#FF0000"><b>OF
                               </b></font>tfp_noparm   <font color="#000080">: </font>value<font color="#000080">:=</font>call_noparm<font color="#000080">;
                               </font>tfp_1real    <font color="#000080">: </font>value<font color="#000080">:=</font>call_1real<font color="#000080">(</font>dummy1<font color="#000080">);
                               </font>tfp_2real    <font color="#000080">: </font>value<font color="#000080">:=</font>call_2real<font color="#000080">(</font>dummy1<font color="#000080">,</font>dummy2<font color="#000080">);
                               </font>tfp_nreal    <font color="#000080">: </font>value<font color="#000080">:=</font>call_nreal<font color="#000080">(</font>dummy<font color="#000080">,</font>param<font color="#000080">);
                               </font>tfp_realvar<font color="#000080">,
                               </font>tfp_intvar<font color="#000080">,
                               </font>tfp_boolvar<font color="#000080">,
                               </font>tfp_realstr  <font color="#000080">: </font>value<font color="#000080">:=</font>dummy1<font color="#000080">;
                             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ferr<font color="#000080">=</font>TRUE<font color="#000080">)
               </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;

             </font><font color="#008000"><i>{$R+}
           </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#800000">'('  </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
             </b></font>Skip<font color="#000080">;

             </font>value<font color="#000080">:=</font>Eval_b_expr<font color="#000080">;

             </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>nextchar<font color="#000080">&lt;&gt;</font><font color="#800000">')'</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;

             </font>Skip<font color="#000080">; </font><font color="#008000"><i>{----Dump the ')'}
           </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_factor<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_factor<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{  Term       = Factor ^ Factor                           }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_term <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>value<font color="#000080">,
  </font>Exponent<font color="#000080">,
  </font>dummy<font color="#000080">,
  </font>Base      <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>value<font color="#000080">:=</font>Eval_factor<font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Nextchar<font color="#000080">=</font><font color="#800000">'^'</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>Skip<font color="#000080">;

      </font>Exponent<font color="#000080">:=</font>Eval_factor<font color="#000080">;

      </font>Base<font color="#000080">:=</font>value<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Base<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
        </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font><font color="#800000">0
        </font><font color="#FF0000"><b>ELSE
          BEGIN

          </b></font><font color="#008000"><i>{----Over/Underflow Protected}
            </i></font>dummy<font color="#000080">:=</font>Exponent<font color="#000080">*</font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>Base<font color="#000080">));
            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>dummy<font color="#000080">&lt;=</font>LN<font color="#000080">(</font>MAXREAL<font color="#000080">))
               </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>EXP<font color="#000080">(</font>dummy<font color="#000080">)
               </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Base<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">)
        </font><font color="#FF0000"><b>THEN
          BEGIN
          </b></font><font color="#008000"><i>{----allow only whole number exponents}
            </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>INT<font color="#000080">(</font>Exponent<font color="#000080">)&lt;&gt;</font>Exponent<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;

            </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>ODD<font color="#000080">(</font>ROUND<font color="#000080">(</font>exponent<font color="#000080">)) </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=-</font>value<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_term<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_term<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{----Subterm  = Term * Term                               }
{               Term / Term                               }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_subterm <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>value<font color="#000080">,
  </font>dummy  <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>value<font color="#000080">:=</font>Eval_term<font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'*'</font><font color="#000080">,</font><font color="#800000">'/'</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
    CASE </b></font>Nextchar <font color="#FF0000"><b>OF

    </b></font><font color="#008000"><i>{----Over/Underflow Protected}
      </i></font><font color="#800000">'*' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              </b></font>Skip<font color="#000080">;

              </font>dummy<font color="#000080">:=</font>Eval_term<font color="#000080">;

              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>value<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>dummy<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font><font color="#800000">0
                </font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">(</font>ABS<font color="#000080">( </font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>value<font color="#000080">)) + </font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>dummy<font color="#000080">)) )&lt;</font>LN<font color="#000080">(</font>Maxreal<font color="#000080">))
                  </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:= </font>value <font color="#000080">* </font>dummy
                  <font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{----Over/Underflow Protected}
      </i></font><font color="#800000">'/' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              </b></font>Skip<font color="#000080">;

              </font>dummy<font color="#000080">:=</font>Eval_term<font color="#000080">;

              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>THEN
                  BEGIN

                  </b></font><font color="#008000"><i>{----Division by ZERO Protected}
                    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>dummy<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
                      </font><font color="#FF0000"><b>THEN
                        BEGIN
                        </b></font><font color="#008000"><i>{----Underflow Protected}
                          </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
                            </font><font color="#FF0000"><b>THEN
                              IF </b></font><font color="#000080">(</font>ABS<font color="#000080">( </font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>value<font color="#000080">))-</font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>dummy<font color="#000080">)) )
                                 &lt;</font>LN<font color="#000080">(</font>Maxreal<font color="#000080">))
                                </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>value<font color="#000080">/</font>dummy
                                <font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11
                        </font><font color="#FF0000"><b>END
                      ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">9</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_subterm<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_subterm<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{  Real Expr  = Subterm + Subterm                         }
{               Subterm - Subterm                         }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_r_expr <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>dummy<font color="#000080">,
  </font>dummy2<font color="#000080">,
  </font>value <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>value<font color="#000080">:=</font>Eval_subterm<font color="#000080">;

  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
    CASE </b></font>Nextchar <font color="#FF0000"><b>OF

      </b></font><font color="#800000">'+' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              </b></font>Skip<font color="#000080">;

              </font>dummy<font color="#000080">:=</font>Eval_subterm<font color="#000080">;

              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>THEN
                  BEGIN

                  </b></font><font color="#008000"><i>{----Overflow Protected}
                    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ABS<font color="#000080">( (</font>value<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)+(</font>dummy<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">) )&lt;(</font>Maxreal<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">))
                      </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>value<font color="#000080">+</font>dummy
                      <font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

      </font><font color="#800000">'-' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
              </b></font>Skip<font color="#000080">;
              </font>dummy2<font color="#000080">:=</font>value<font color="#000080">;

              </font>dummy<font color="#000080">:=</font>Eval_subterm<font color="#000080">;

              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
                </font><font color="#FF0000"><b>THEN
                  BEGIN

                  </b></font><font color="#008000"><i>{----Overflow Protected}
                    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ABS<font color="#000080">( (</font>value<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)-(</font>dummy<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">) )&lt;(</font>Maxreal<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">))
                      </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>value<font color="#000080">-</font>dummy
                      <font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;

                  </font><font color="#008000"><i>{----Underflow Protected}
                    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>dummy<font color="#000080">&lt;&gt;</font>dummy2<font color="#000080">)
                      </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{----At this point the current char must be
        1. the EOLN marker or
        2. a right bracket
        3. start of a boolean operator }

  </i></font><font color="#FF0000"><b>IF NOT </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">#00</font><font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">,</font><font color="#800000">'&gt;'</font><font color="#000080">,</font><font color="#800000">'&lt;'</font><font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">,</font><font color="#800000">','</font><font color="#000080">])
    </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_r_expr<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_r_expr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{  Boolean Expr  = R_Expr &lt;  R_Expr                       }
{                  R_Expr &lt;= R_Expr                       }
{                  R_Expr &lt;&gt; R_Expr                       }
{                  R_Expr =  R_Expr                       }
{                  R_Expr &gt;= R_Expr                       }
{                  R_Expr &gt;  R_Expr                       }
{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Eval_b_expr <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>value <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>value<font color="#000080">:=</font>Eval_r_expr<font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'&lt;'</font><font color="#000080">,</font><font color="#800000">'&gt;'</font><font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">])
    </font><font color="#FF0000"><b>THEN
      CASE </b></font>Nextchar <font color="#FF0000"><b>OF

        </b></font><font color="#800000">'&lt;' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>Skip<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Nextchar <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'&gt;'</font><font color="#000080">,</font><font color="#800000">'='</font><font color="#000080">])
                  </font><font color="#FF0000"><b>THEN
                    CASE </b></font>Nextchar <font color="#FF0000"><b>OF
                      </b></font><font color="#800000">'&gt;' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                              </b></font>Skip<font color="#000080">;
                              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">&lt;&gt;</font>Eval_r_expr<font color="#000080">)
                                </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                                <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
                            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                      </font><font color="#800000">'=' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                              </b></font>Skip<font color="#000080">;
                              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">&lt;=</font>Eval_r_expr<font color="#000080">)
                                </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                                <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
                            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                    </font><font color="#FF0000"><b>END
                  ELSE
                    BEGIN
                      IF </b></font><font color="#000080">(</font>value<font color="#000080">&lt;</font>Eval_r_expr<font color="#000080">)
                        </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                        <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

        </font><font color="#800000">'&gt;' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>Skip<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Nextchar<font color="#000080">=</font><font color="#800000">'='</font><font color="#000080">)
                  </font><font color="#FF0000"><b>THEN
                    BEGIN
                      </b></font>Skip<font color="#000080">;
                      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">&gt;=</font>Eval_r_expr<font color="#000080">)
                        </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                        <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
                    </font><font color="#FF0000"><b>END
                  ELSE
                    BEGIN
                      IF </b></font><font color="#000080">(</font>value<font color="#000080">&gt;</font>Eval_r_expr<font color="#000080">)
                        </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                        <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
                    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#800000">'=' </font><font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                </b></font>Skip<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>value<font color="#000080">=</font>Eval_r_expr<font color="#000080">)
                  </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>tfp_true
                  <font color="#FF0000"><b>ELSE </b></font>value<font color="#000080">:=</font>tfp_false<font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>Eval_b_expr<font color="#000080">:=</font>value
    <font color="#FF0000"><b>ELSE </b></font>Eval_b_expr<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_init<font color="#000080">(</font>no <font color="#000080">: </font>INTEGER<font color="#000080">);

</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>maxfie<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>FREEMEM<font color="#000080">(</font>fiearr<font color="#000080">,</font>maxfie<font color="#000080">*</font>SIZEOF<font color="#000080">(</font>fiearr<font color="#000080">^));

  </font>GETMEM<font color="#000080">(</font>fiearr<font color="#000080">,</font>no<font color="#000080">*</font>SIZEOF<font color="#000080">(</font>fiearr<font color="#000080">^));

  </font>maxfie<font color="#000080">:=</font>no<font color="#000080">;
  </font>fiesiz<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Tfp_parse2real<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>i<font color="#000080">,</font>h     <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>value   <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

</font><font color="#008000"><i>{----Test for match on numbers of ( and ) }
  </i></font>h<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>DO
    CASE </b></font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>OF
      </b></font><font color="#800000">'(' </font><font color="#000080">: </font>INC<font color="#000080">(</font>h<font color="#000080">);
      </font><font color="#800000">')' </font><font color="#000080">: </font>DEC<font color="#000080">(</font>h<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>h<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN
      BEGIN

      </b></font><font color="#008000"><i>{----Continue init}
        </i></font>lp<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

      </font><font color="#008000"><i>{----Add a CHR(0) as an EOLN marker}
        </i></font>line<font color="#000080">:=</font>S<font color="#000080">+</font><font color="#800000">#00</font><font color="#000080">;
        </font>Skip<font color="#000080">;

      </font><font color="#008000"><i>{----Try parsing if any characters left}
        </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Line<font color="#000080">[</font>Lp<font color="#000080">]&lt;&gt;</font><font color="#800000">#00</font><font color="#000080">)
          </font><font color="#FF0000"><b>THEN </b></font>value<font color="#000080">:=</font>Eval_b_expr
          <font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">6</font><font color="#000080">;
      </font><font color="#FF0000"><b>END
    ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>tfp_parse2real<font color="#000080">:=</font><font color="#800000">0.0
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_parse2real<font color="#000080">:=</font>value<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Tfp_parse2str<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;</font>m<font color="#000080">,</font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>r   <font color="#000080">: </font>REAL<font color="#000080">;
  </font>tmp <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>r<font color="#000080">:=</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>STR<font color="#000080">(</font>r<font color="#000080">:</font>m<font color="#000080">:</font>n<font color="#000080">,</font>tmp<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>tmp<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>Tfp_parse2str<font color="#000080">:=</font>tmp<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Tfp_errormsg<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  CASE </b></font>nr <font color="#FF0000"><b>OF
    </b></font><font color="#800000">0 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Correct resultaat'</font><font color="#000080">;                      </font><font color="#008000"><i>{Error 0 }
    </i></font><font color="#800000">1 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Ongeldig getal formaat'</font><font color="#000080">;                 </font><font color="#008000"><i>{Error 1 }
    </i></font><font color="#800000">2 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Onbekende functie'</font><font color="#000080">;                      </font><font color="#008000"><i>{Error 2 }
    </i></font><font color="#800000">3 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Een haakje mist'</font><font color="#000080">;                        </font><font color="#008000"><i>{Error 3 }
    </i></font><font color="#800000">4 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Reele exponent geeft een complex getal'</font><font color="#000080">; </font><font color="#008000"><i>{Error 4 }
    </i></font><font color="#800000">5 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'TAN( (2n+1)*PI/2 ) bestaat niet'</font><font color="#000080">;        </font><font color="#008000"><i>{Error 5 }
    </i></font><font color="#800000">6 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Lege string'</font><font color="#000080">;                            </font><font color="#008000"><i>{Error 6 }
    </i></font><font color="#800000">7 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'LN(x) of LOG(x) met x&lt;=0 bestaat niet'</font><font color="#000080">;  </font><font color="#008000"><i>{Error 7 }
    </i></font><font color="#800000">8 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'SQRT(x) met x&lt;0 bestaat niet'</font><font color="#000080">;           </font><font color="#008000"><i>{Error 8 }
    </i></font><font color="#800000">9 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Deling door nul'</font><font color="#000080">;                        </font><font color="#008000"><i>{Error 9 }
   </i></font><font color="#800000">10 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Teveel functies &amp; constanten'</font><font color="#000080">;           </font><font color="#008000"><i>{Error 10}
   </i></font><font color="#800000">11 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Tussenresultaat buiten getalbereik'</font><font color="#000080">;     </font><font color="#008000"><i>{Error 11}
   </i></font><font color="#800000">12 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Illegale tekens in functienaam'</font><font color="#000080">;         </font><font color="#008000"><i>{Error 12}
   </i></font><font color="#800000">13 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Geen (on)gelijkheid / te complex'</font><font color="#000080">;       </font><font color="#008000"><i>{Error 13}
   </i></font><font color="#800000">14 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Geen booleaanse expressie'</font><font color="#000080">;              </font><font color="#008000"><i>{Error 14}
   </i></font><font color="#800000">15 </font><font color="#000080">: </font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Verkeerd aantal parameters'</font><font color="#000080">;             </font><font color="#008000"><i>{Error 15}
  </i></font><font color="#FF0000"><b>ELSE  </b></font>Tfp_errormsg<font color="#000080">:=</font><font color="#800000">'Onbekende fout'</font><font color="#000080">;                         </font><font color="#008000"><i>{Error xx}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addobj<font color="#000080">(</font>a <font color="#000080">: </font>pointer<font color="#000080">;</font>n <font color="#000080">: </font>tfp_fname<font color="#000080">;</font>t <font color="#000080">: </font>tfp_ftype<font color="#000080">);

</font><font color="#FF0000"><b>VAR
  </b></font>i <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{$R-}
  </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>fiesiz<font color="#000080">&lt;</font>maxfie<font color="#000080">)
    </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>INC<font color="#000080">(</font>fiesiz<font color="#000080">);
        </font><font color="#FF0000"><b>WITH </b></font>fiearr<font color="#000080">^[</font>fiesiz<font color="#000080">] </font><font color="#FF0000"><b>DO
          BEGIN
            </b></font>faddr<font color="#000080">:=</font>a<font color="#000080">;
            </font>fname<font color="#000080">:=</font>n<font color="#000080">;
            </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH<font color="#000080">(</font>fname<font color="#000080">) </font><font color="#FF0000"><b>DO
              IF </b></font><font color="#000080">(</font>UPCASE<font color="#000080">(</font>fname<font color="#000080">[</font>i<font color="#000080">]) </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'_'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">])
                </font><font color="#FF0000"><b>THEN </b></font>fname<font color="#000080">[</font>i<font color="#000080">]:=</font>UPCASE<font color="#000080">(</font>fname<font color="#000080">[</font>i<font color="#000080">])
                </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">12</font><font color="#000080">;
              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>fname<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND
                 NOT </b></font><font color="#000080">(</font>fname<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">])
                </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">12</font><font color="#000080">;
              </font>ftype<font color="#000080">:=</font>t<font color="#000080">;
          </font><font color="#FF0000"><b>END
      END
    ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">10
  </font><font color="#008000"><i>{$R+}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}
{----Internal Functions                                   }
{---------------------------------------------------------}

{$F+}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>xABS<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>xabs<font color="#000080">:=</font>ABS<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xAND<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>tmp   <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>x     <font color="#000080">: </font>REAL<font color="#000080">;
  </font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{$R-}
  </i></font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&lt;&gt;</font>tfp_false<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&lt;&gt;</font>tfp_true<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
        BEGIN
          IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
            </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">14</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>n<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)
     </font><font color="#FF0000"><b>THEN
       BEGIN
         </b></font>x<font color="#000080">:=</font>tfp_true<font color="#000080">*</font>ORD<font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font><font color="#800000">0</font><font color="#000080">]=</font>tfp_true<font color="#000080">);
         </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
           </b></font>x<font color="#000080">:=</font>tfp_true<font color="#000080">*</font>ORD<font color="#000080">((</font>x<font color="#000080">=</font>tfp_true<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]=</font>tfp_true<font color="#000080">))
       </font><font color="#FF0000"><b>END
     ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>tfp_ernr<font color="#000080">=</font><font color="#800000">0
    </font><font color="#FF0000"><b>THEN </b></font>xAND<font color="#000080">:=</font>x
    <font color="#FF0000"><b>ELSE </b></font>xAND<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
</font><font color="#008000"><i>{$R+}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xARCTAN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xARCTAN<font color="#000080">:=</font>ARCTAN<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xCOS<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xCOS<font color="#000080">:=</font>COS<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xDEG<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xDEG<font color="#000080">:=(</font>r<font color="#000080">/</font>pi<font color="#000080">)*</font><font color="#800000">180</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xE <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xE<font color="#000080">:=</font>EXP<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xEXP<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xEXP<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ABS<font color="#000080">(</font>r<font color="#000080">)&lt;</font>LN<font color="#000080">(</font>MAXREAL<font color="#000080">))
    </font><font color="#FF0000"><b>THEN </b></font>xEXP<font color="#000080">:=</font>EXP<font color="#000080">(</font>r<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xFALSE <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xFALSE<font color="#000080">:=</font>tfp_false<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xFRAC<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xFRAC<font color="#000080">:=</font>FRAC<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xINT<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xINT<font color="#000080">:=</font>INT<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xLN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xLN<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>r<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xLN<font color="#000080">:=</font>LN<font color="#000080">(</font>r<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xLOG<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xLOG<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>r<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xLOG<font color="#000080">:=</font>LN<font color="#000080">(</font>r<font color="#000080">)/</font>LN<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xMAX<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>tmp   <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>max   <font color="#000080">: </font>REAL<font color="#000080">;
  </font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{$R-}
  </i></font>max<font color="#000080">:=</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font><font color="#800000">0</font><font color="#000080">];
  </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&gt;</font>max<font color="#000080">)
      </font><font color="#FF0000"><b>THEN </b></font>max<font color="#000080">:=</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">];
  </font>xMAX<font color="#000080">:=</font>max<font color="#000080">;
</font><font color="#008000"><i>{$R+}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xMIN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>tmp   <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>min   <font color="#000080">: </font>REAL<font color="#000080">;
  </font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{$R-}
  </i></font>min<font color="#000080">:=</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font><font color="#800000">0</font><font color="#000080">];
  </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&lt;</font>min<font color="#000080">)
      </font><font color="#FF0000"><b>THEN </b></font>min<font color="#000080">:=</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">];
  </font>xMIN<font color="#000080">:=</font>min<font color="#000080">;
</font><font color="#008000"><i>{$R+}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>xIOR<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r<font color="#000080">;</font><font color="#FF0000"><b>VAR </b></font>n <font color="#000080">: </font>INTEGER<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>tmp   <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>x     <font color="#000080">: </font>REAL<font color="#000080">;
  </font>i     <font color="#000080">: </font>INTEGER<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{$R-}
  </i></font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
    IF </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&lt;&gt;</font>tfp_false<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]&lt;&gt;</font>tfp_true<font color="#000080">)
      </font><font color="#FF0000"><b>THEN
        BEGIN
          IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
            </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">14</font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>n<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">)
     </font><font color="#FF0000"><b>THEN
       BEGIN
         </b></font>x<font color="#000080">:=</font>tfp_true<font color="#000080">*</font>ORD<font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font><font color="#800000">0</font><font color="#000080">]=</font>tfp_true<font color="#000080">);
         </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>n <font color="#FF0000"><b>DO
           </b></font>x<font color="#000080">:=</font>tfp_true<font color="#000080">*</font>ORD<font color="#000080">((</font>x<font color="#000080">=</font>tfp_true<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>tmp<font color="#000080">(</font>r<font color="#000080">)[</font>i<font color="#000080">]=</font>tfp_true<font color="#000080">))
       </font><font color="#FF0000"><b>END
     ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>tfp_ernr<font color="#000080">=</font><font color="#800000">0
    </font><font color="#FF0000"><b>THEN </b></font>xIOR<font color="#000080">:=</font>x
    <font color="#FF0000"><b>ELSE </b></font>xIOR<font color="#000080">:=</font><font color="#800000">0.0</font><font color="#000080">;
</font><font color="#008000"><i>{$R+}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xPI <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xPI<font color="#000080">:=</font>PI<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xRAD<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xRAD<font color="#000080">:=(</font>r<font color="#000080">/</font><font color="#800000">180</font><font color="#000080">)*</font>pi<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xROUND<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xROUND<font color="#000080">:=</font>ROUND<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xSGN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>r<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xSgn<font color="#000080">:=+</font><font color="#800000">1
    </font><font color="#FF0000"><b>ELSE </b></font>xSgn<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xSIN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xSIN<font color="#000080">:=</font>SIN<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xSQR<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xSQR<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( </font>ABS<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">*</font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>r<font color="#000080">))) )&lt;</font>LN<font color="#000080">(</font>MAXREAL<font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xSQR<font color="#000080">:=</font>EXP<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">*</font>LN<font color="#000080">(</font>ABS<font color="#000080">(</font>r<font color="#000080">)) )
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">11</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xSQRT<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xSQRT<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>r<font color="#000080">&gt;=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xSQRT<font color="#000080">:=</font>SQRT<font color="#000080">(</font>r<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xTAN<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xTAN<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>COS<font color="#000080">(</font>r<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">5
    </font><font color="#FF0000"><b>ELSE </b></font>xTAN<font color="#000080">:=</font>SIN<font color="#000080">(</font>r<font color="#000080">)/</font>COS<font color="#000080">(</font>r<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xTRUE <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>xTRUE<font color="#000080">:=</font>tfp_true<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xXOR<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r1<font color="#000080">,</font>r2 <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 IF </b></font><font color="#000080">((</font>r1<font color="#000080">&lt;&gt;</font>tfp_false<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>r1<font color="#000080">&lt;&gt;</font>tfp_true<font color="#000080">)) </font><font color="#FF0000"><b>OR
    </b></font><font color="#000080">((</font>r2<font color="#000080">&lt;&gt;</font>tfp_false<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>r2<font color="#000080">&lt;&gt;</font>tfp_true<font color="#000080">))
   </font><font color="#FF0000"><b>THEN
     BEGIN
       IF </b></font><font color="#000080">(</font>tfp_ernr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">)
         </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">14</font><font color="#000080">;
     </font><font color="#FF0000"><b>END
   ELSE </b></font>xxor<font color="#000080">:=</font>tfp_true<font color="#000080">*</font>ORD<font color="#000080">((</font>r1<font color="#000080">=</font>tfp_true<font color="#000080">) </font><font color="#FF0000"><b>XOR </b></font><font color="#000080">(</font>r2<font color="#000080">=</font>tfp_true<font color="#000080">));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F-}

{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addgonio<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Tfp_addobj<font color="#000080">(@</font>xARCTAN<font color="#000080">,</font><font color="#800000">'ARCTAN'</font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xCOS   <font color="#000080">,</font><font color="#800000">'COS'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xDEG   <font color="#000080">,</font><font color="#800000">'DEG'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xPI    <font color="#000080">,</font><font color="#800000">'PI'    </font><font color="#000080">,</font>tfp_noparm<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xRAD   <font color="#000080">,</font><font color="#800000">'RAD'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xSIN   <font color="#000080">,</font><font color="#800000">'SIN'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xTAN   <font color="#000080">,</font><font color="#800000">'TAN'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addlogic<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Tfp_addobj<font color="#000080">(@</font>xAND   <font color="#000080">,</font><font color="#800000">'AND'   </font><font color="#000080">,</font>tfp_nreal<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xFALSE <font color="#000080">,</font><font color="#800000">'FALSE' </font><font color="#000080">,</font>tfp_noparm<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xIOR   <font color="#000080">,</font><font color="#800000">'OR'    </font><font color="#000080">,</font>tfp_nreal<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xTRUE  <font color="#000080">,</font><font color="#800000">'TRUE'  </font><font color="#000080">,</font>tfp_noparm<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xXOR   <font color="#000080">,</font><font color="#800000">'XOR'   </font><font color="#000080">,</font>tfp_2real<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addmath<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Tfp_addobj<font color="#000080">(@</font>xABS   <font color="#000080">,</font><font color="#800000">'ABS'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xEXP   <font color="#000080">,</font><font color="#800000">'EXP'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xE     <font color="#000080">,</font><font color="#800000">'E'     </font><font color="#000080">,</font>tfp_noparm<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xLN    <font color="#000080">,</font><font color="#800000">'LN'    </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xLOG   <font color="#000080">,</font><font color="#800000">'LOG'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xSQR   <font color="#000080">,</font><font color="#800000">'SQR'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xSQRT  <font color="#000080">,</font><font color="#800000">'SQRT'  </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Tfp_addmisc<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Tfp_addobj<font color="#000080">(@</font>xFRAC  <font color="#000080">,</font><font color="#800000">'FRAC'  </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xINT   <font color="#000080">,</font><font color="#800000">'INT'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xMAX   <font color="#000080">,</font><font color="#800000">'MAX'   </font><font color="#000080">,</font>tfp_nreal<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xMIN   <font color="#000080">,</font><font color="#800000">'MIN'   </font><font color="#000080">,</font>tfp_nreal<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xROUND <font color="#000080">,</font><font color="#800000">'ROUND' </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xSGN   <font color="#000080">,</font><font color="#800000">'SGN'   </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{---------------------------------------------------------}

</i></font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{----Module Init}
  </i></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>fiesiz<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>maxfie<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>fiearr<font color="#000080">:=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

-------------------------------------------------------------&lt;</font>cut here

<font color="#FF0000"><b>Program </b></font>Tfptst<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>crt<font color="#000080">,
  </font>tfp_01<font color="#000080">;

</font><font color="#008000"><i>{$F+}  {----Important don't forget it !!!}

</i></font><font color="#FF0000"><b>Var
  </b></font>r <font color="#000080">: </font>real<font color="#000080">;
  </font>i <font color="#000080">: </font>Integer<font color="#000080">;
  </font>t<font color="#000080">,
  </font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>xFUZZY<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>r <font color="#000080">: </font>REAL<font color="#000080">) : </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  IF </b></font><font color="#000080">(</font>r<font color="#000080">&gt;</font><font color="#800000">0.5</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN </b></font>xFUZZY<font color="#000080">:=</font><font color="#800000">0.5
    </font><font color="#FF0000"><b>ELSE </b></font>xFUZZY<font color="#000080">:=</font><font color="#800000">0.4</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{of xFUZZY}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>xAGE <font color="#000080">: </font>REAL<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>s    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>e    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>r    <font color="#000080">: </font>Real<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font><font color="#008000"><i>{----default value in case of error}
  </i></font>xAGE<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

  </font>Write<font color="#000080">(</font><font color="#800000">'Enter your age : '</font><font color="#000080">); </font>Readln<font color="#000080">(</font>s<font color="#000080">);
  </font>Val<font color="#000080">(</font>s<font color="#000080">,</font>r<font color="#000080">,</font>e<font color="#000080">);

</font><font color="#008000"><i>{----Setting tfp_ernr will flag an error.
     Can be a user defined value}

  </i></font><font color="#FF0000"><b>IF </b></font>e<font color="#000080">&lt;&gt;</font><font color="#800000">0
    </font><font color="#FF0000"><b>THEN </b></font>tfp_ernr<font color="#000080">:=</font><font color="#800000">1
    </font><font color="#FF0000"><b>ELSE </b></font>xAGE<font color="#000080">:=</font>r<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{of xAge}
{$F-}

</i></font><font color="#FF0000"><b>Begin
  </b></font>Tfp_init<font color="#000080">(</font><font color="#800000">40</font><font color="#000080">);

</font><font color="#008000"><i>{----Add internal function packs}
  </i></font>Tfp_addgonio<font color="#000080">;
  </font>Tfp_addlogic<font color="#000080">;
  </font>Tfp_addmath<font color="#000080">;
  </font>Tfp_addmisc<font color="#000080">;

</font><font color="#008000"><i>{----Add external functions}
  </i></font>Tfp_addobj<font color="#000080">(@</font>r     <font color="#000080">,</font><font color="#800000">'TEMP'   </font><font color="#000080">,</font>tfp_realvar<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>i     <font color="#000080">,</font><font color="#800000">'COUNTER'</font><font color="#000080">,</font>tfp_intvar<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>t     <font color="#000080">,</font><font color="#800000">'USER'   </font><font color="#000080">,</font>tfp_realstr<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xfuzzy<font color="#000080">,</font><font color="#800000">'FUZZY'  </font><font color="#000080">,</font>tfp_1real<font color="#000080">);
  </font>Tfp_addobj<font color="#000080">(@</font>xage  <font color="#000080">,</font><font color="#800000">'AGE'    </font><font color="#000080">,</font>tfp_noparm<font color="#000080">);

  </font>i<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>t<font color="#000080">:=</font><font color="#800000">'1.25'</font><font color="#000080">;
  </font>s<font color="#000080">:=</font><font color="#800000">'2*COUNTER'</font><font color="#000080">;

  </font>Clrscr<font color="#000080">;

</font><font color="#008000"><i>{----Example #1 using FOR index in expression}
  </i></font>Writeln<font color="#000080">(</font>tfp_errormsg<font color="#000080">(</font>tfp_ernr<font color="#000080">));
  </font><font color="#FF0000"><b>FOR </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">3 </font><font color="#FF0000"><b>DO
    </b></font>Writeln<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">' := '</font><font color="#000080">,</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>Writeln<font color="#000080">(</font>tfp_errormsg<font color="#000080">(</font>tfp_ernr<font color="#000080">));

</font><font color="#008000"><i>{----Example #2 using a real from the main program}
  </i></font>r<font color="#000080">:=</font><font color="#800000">15</font><font color="#000080">;
  </font>s<font color="#000080">:=</font><font color="#800000">'TEMP'</font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font>r<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">' := '</font><font color="#000080">,</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

</font><font color="#008000"><i>{----Example #3 using a function that does something strange}
  </i></font>s<font color="#000080">:=</font><font color="#800000">'AGE-1'</font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Last years AGE := '</font><font color="#000080">,</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

</font><font color="#008000"><i>{----Example #4 using a number in a string
     This version doesn't allow recusive formula's yet
     Have a version that does!}
  </i></font>s<font color="#000080">:=</font><font color="#800000">'USER'</font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'USER := '</font><font color="#000080">,</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);

</font><font color="#008000"><i>{----All of the above + Internal function PI, &amp;
     Boolean expressions should return 1 because it can't be 1
     Booleans are reals with values of 1.0 and 0.0}
  </i></font>s<font color="#000080">:=</font><font color="#800000">'(SIN(COUNTER+TEMP*FUZZY(AGE)*PI)&lt;&gt;1)=TRUE'</font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'? := '</font><font color="#000080">,</font>Tfp_parse2real<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">0</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">);

</font><font color="#008000"><i>{----Your example goes here, try a readln(s)}

  </i></font>Writeln<font color="#000080">(</font>tfp_errormsg<font color="#000080">(</font>tfp_ernr<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p></body>
</html>
