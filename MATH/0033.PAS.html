<html>
<head><title> "CALCULUS" by LOU DUCHEZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Updated NUMBERS.SWG on November 2, 1993 }

{
LOU DUCHEZ

Hey everybody!  This unit performs calculus operations via basic numerical
methods : integrals, derivatives, and extrema.  By Lou DuChez.  I don't
want any money for this; please just leave my name in the source code
somewhere, since this is the closest I'll ever get to being famous.

All functions return real values.  The last parameter in each function is
a pointer to a &quot;real&quot; function that takes a single &quot;real&quot; parameter:
for example, y(x).  See prior message to Timothy C. Novak for sample prog }

</i></font><font color="#FF0000"><b>unit </b></font>calculus<font color="#000080">;
</font><font color="#FF0000"><b>interface

function </b></font>integral<font color="#000080">(</font>a<font color="#000080">, </font>b<font color="#000080">, </font>h <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>derivative<font color="#000080">(</font>x<font color="#000080">, </font>dx <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>extremum<font color="#000080">(</font>x<font color="#000080">, </font>dx<font color="#000080">, </font>tolerance <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;

</font><font color="#FF0000"><b>implementation

type
  </b></font>fofx <font color="#000080">= </font><font color="#FF0000"><b>function</b></font><font color="#000080">(</font>x <font color="#000080">: </font>real<font color="#000080">) : </font>real<font color="#000080">;     </font><font color="#008000"><i>{ needed for function-evaluating }

</i></font><font color="#FF0000"><b>function </b></font>integral<font color="#000080">(</font>a<font color="#000080">, </font>b<font color="#000080">, </font>h <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>x<font color="#000080">, </font>summation <font color="#000080">: </font>real<font color="#000080">;
  </font>y            <font color="#000080">: </font>fofx<font color="#000080">;
</font><font color="#FF0000"><b>begin                                 </b></font><font color="#008000"><i>{ Integrates function from a to b,  }
  </i></font><font color="#000080">@</font>y <font color="#000080">:= </font>f<font color="#000080">;                            </font><font color="#008000"><i>{ by approximating function with    }
  </i></font>summation <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;                     </font><font color="#008000"><i>{ rectangles of width h. }
  </i></font>x <font color="#000080">:= </font>a <font color="#000080">+ </font>h<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>x <font color="#000080">&lt; </font>b <font color="#FF0000"><b>do
  begin                               </b></font><font color="#008000"><i>{ Answer is sum of rectangle areas, }
    </i></font>summation <font color="#000080">:= </font>summation <font color="#000080">+ </font>h<font color="#000080">*</font>y<font color="#000080">(</font>x<font color="#000080">);  </font><font color="#008000"><i>{ each area being h*y(x).  X is at  }
    </i></font>x <font color="#000080">:= </font>x <font color="#000080">+ </font>h<font color="#000080">;                       </font><font color="#008000"><i>{ the middle of the rectangle.      }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>integral <font color="#000080">:= </font>summation<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>derivative<font color="#000080">(</font>x<font color="#000080">, </font>dx <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>y <font color="#000080">: </font>fofx<font color="#000080">;
</font><font color="#FF0000"><b>begin                 </b></font><font color="#008000"><i>{ Derivative of function at x: delta y over delta x }
  </i></font><font color="#000080">@</font>y <font color="#000080">:= </font>f<font color="#000080">;                                       </font><font color="#008000"><i>{ You supply x &amp; delta x }
  </i></font>derivative <font color="#000080">:= (</font>y<font color="#000080">(</font>x <font color="#000080">+ </font>dx<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">) - </font>y<font color="#000080">(</font>x <font color="#000080">- </font>dx<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">)) / </font>dx<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>extremum<font color="#000080">(</font>x<font color="#000080">, </font>dx<font color="#000080">, </font>tolerance <font color="#000080">: </font>real<font color="#000080">; </font>f <font color="#000080">: </font>pointer<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#008000"><i>{ This function uses DuChez's Method for finding extrema of a function (yes,
  I seem to have invented it): taking three points, finding the parabola
  that connects them, and hoping that an extremum of the function is near
  the vertex of the parabola.  If not, at least you have a new &quot;x&quot; to try...

  X is the initial value to go extremum-hunting at; dx is how far on either
  side of x to look.  &quot;Tolerance&quot; is a parameter: if two consecutive
  iterations provide x-values within &quot;tolerance&quot; of each other, the answer
  is the average of the two. }
</i></font><font color="#FF0000"><b>var
  </b></font>y           <font color="#000080">: </font>fofx<font color="#000080">;
  </font>gotanswer<font color="#000080">,
  </font>increasing<font color="#000080">,
  </font>decreasing  <font color="#000080">: </font>boolean<font color="#000080">;
  </font>oldx        <font color="#000080">: </font>real<font color="#000080">;
  </font>itercnt     <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#000080">@</font>y <font color="#000080">:= </font>f<font color="#000080">;
  </font>gotanswer <font color="#000080">:= </font>false<font color="#000080">;
  </font>increasing <font color="#000080">:= </font>false<font color="#000080">;
  </font>decreasing <font color="#000080">:= </font>false<font color="#000080">;
  </font>itercnt <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat                               </b></font><font color="#008000"><i>{ repeat until you have answer }
    </i></font>oldx <font color="#000080">:= </font>x<font color="#000080">;
    </font>x <font color="#000080">:= </font>oldx <font color="#000080">- </font>dx<font color="#000080">*(</font>y<font color="#000080">(</font>x<font color="#000080">+</font>dx<font color="#000080">) - </font>y<font color="#000080">(</font>x<font color="#000080">-</font>dx<font color="#000080">)) /    </font><font color="#008000"><i>{ this monster is the new value }
         </i></font><font color="#000080">(</font><font color="#800000">2</font><font color="#000080">*(</font>y<font color="#000080">(</font>x<font color="#000080">+</font>dx<font color="#000080">) - </font><font color="#800000">2</font><font color="#000080">*</font>y<font color="#000080">(</font>x<font color="#000080">) + </font>y<font color="#000080">(</font>x<font color="#000080">-</font>dx<font color="#000080">)));  </font><font color="#008000"><i>{ of &quot;x&quot; based DuChez's Method }
    </i></font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>x <font color="#000080">- </font>oldx<font color="#000080">) &lt;= </font>tolerance <font color="#FF0000"><b>then
      </b></font>gotanswer <font color="#000080">:= </font>true                     <font color="#008000"><i>{ within tolerance: got an answer }
    </i></font><font color="#FF0000"><b>else
    if </b></font><font color="#000080">(</font>x <font color="#000080">&gt; </font>oldx<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      if </b></font>decreasing <font color="#FF0000"><b>then
      begin              </b></font><font color="#008000"><i>{ If &quot;x&quot; is increasing but it }
        </i></font>decreasing <font color="#000080">:= </font>false<font color="#000080">;                </font><font color="#008000"><i>{ had been decreasing, we're }
        </i></font>dx <font color="#000080">:= </font>dx<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;                         </font><font color="#008000"><i>{ oscillating around the answer. }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;                                </font><font color="#008000"><i>{ Cut &quot;dx&quot; in half to home in on }
      </i></font>increasing <font color="#000080">:= </font>true<font color="#000080">;                   </font><font color="#008000"><i>{ the extremum. }
    </i></font><font color="#FF0000"><b>end
    else
    if </b></font><font color="#000080">(</font>x <font color="#000080">&lt; </font>oldx<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      if </b></font>increasing <font color="#FF0000"><b>then
      begin              </b></font><font color="#008000"><i>{ same thing here, except &quot;x&quot; }
        </i></font>increasing <font color="#000080">:= </font>false<font color="#000080">;                </font><font color="#008000"><i>{ is now decreasing but had }
        </i></font>dx <font color="#000080">:= </font>dx<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;                         </font><font color="#008000"><i>{ been increasing }
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>decreasing <font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>gotanswer<font color="#000080">;

  </font>extremum <font color="#000080">:= (</font>x <font color="#000080">+ </font>oldx<font color="#000080">) / </font><font color="#800000">2</font><font color="#000080">;               </font><font color="#008000"><i>{ spit out answer }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.



</font><font color="#008000"><i>{
I've put together a unit that does calculus.  This unit could be used, for
example, to approximate the area under a curve (like a circle).

Because of the funny way my offline reader breaks up messages, I'm going
to send you a &quot;test&quot; program first -- which just happens to calculate
the area under a quarter circle -- then the following message (I hope)
will be the unit source code.
}

</i></font><font color="#FF0000"><b>program </b></font>mathtest<font color="#000080">;
</font><font color="#FF0000"><b>uses
  </b></font>calculus<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>answer <font color="#000080">: </font>real<font color="#000080">;

</font><font color="#008000"><i>{$F+}                       { WARNING!  YOU NEED &quot;FAR&quot; FUNCTIONS! }
</i></font><font color="#FF0000"><b>function </b></font>y<font color="#000080">(</font>x <font color="#000080">: </font>real<font color="#000080">) : </font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>y <font color="#000080">:= </font><font color="#800000">4 </font><font color="#000080">* </font>sqrt<font color="#000080">(</font><font color="#800000">1 </font><font color="#000080">- </font>x <font color="#000080">* </font>x<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Function: y = (1 - x^2)^(1/2) (i.e., top half of a circle)'</font><font color="#000080">);
  </font>writeln<font color="#000080">;

</font><font color="#008000"><i>{ Calc operations here are: }

{ Integrate function from 0 to 1, in increments of 0.001. A quarter circle. }
{ Get slope of function at 0 by evaluating points 0.01 away from each other. }
{ Find extremum of function, starting at 0.4, initially looking at points
  0.1 on either side of 0.4, and not stopping until we have two x-values
  within 0.001 of each other. }

  </i></font>answer <font color="#000080">:= </font>integral<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0.001</font><font color="#000080">, @</font>y<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Integ: '</font><font color="#000080">, </font>answer<font color="#000080">:</font><font color="#800000">13</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);

  </font>answer <font color="#000080">:= </font>derivative <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0.01</font><font color="#000080">, @</font>y<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Deriv: '</font><font color="#000080">, </font>answer<font color="#000080">:</font><font color="#800000">13</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);

  </font>answer <font color="#000080">:= </font>extremum<font color="#000080">(</font><font color="#800000">0.4</font><font color="#000080">, </font><font color="#800000">0.1</font><font color="#000080">, </font><font color="#800000">0.001</font><font color="#000080">, @</font>y<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Extrm: '</font><font color="#000080">, </font>answer<font color="#000080">:</font><font color="#800000">13</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p></body>
</html>
