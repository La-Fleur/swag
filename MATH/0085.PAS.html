<html>
<head><title> "Gaussian Distribution" by RANDALL ELTON DING</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0085.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Now I need a fast way of generating random numbers in Gaussian Distribution

This is my code for gaussian and uniform distribution.
After the unit there is a graphic test program.

From: randyd@alpha2.csd.uwm.edu (Randall Elton Ding)
}

</i></font><font color="#FF0000"><b>unit </b></font>rndgauss<font color="#000080">;


</font><font color="#FF0000"><b>interface


function </b></font>rnd<font color="#000080">: </font>double<font color="#000080">;                  </font><font color="#008000"><i>{ returns uniform [0..1] }

</i></font><font color="#FF0000"><b>function </b></font>gauss<font color="#000080">(</font>a<font color="#000080">,</font>d<font color="#000080">: </font>double<font color="#000080">): </font>double<font color="#000080">;   </font><font color="#008000"><i>{ a is mean, d is std deviation }


</i></font><font color="#FF0000"><b>implementation


function </b></font>rnd<font color="#000080">: </font>double<font color="#000080">;
  </font><font color="#FF0000"><b>const
    </b></font>bias <font color="#000080">= </font><font color="#800000">1023</font><font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>data<font color="#000080">: </font><font color="#FF0000"><b>record
            </b></font>b<font color="#000080">: </font>byte<font color="#000080">;
            </font>d<font color="#000080">: </font>double<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>x<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#FF0000"><b>absolute </b></font>data<font color="#000080">;
    </font>e<font color="#000080">,</font>i<font color="#000080">,</font>j<font color="#000080">: </font>word<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do </b></font>x<font color="#000080">[</font>i<font color="#000080">]:= </font>lo<font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">));
    </font>e<font color="#000080">:= </font>bias<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      </b></font>j<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do begin
        </b></font>j<font color="#000080">:= (</font>x<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">) + </font>hi<font color="#000080">(</font>j<font color="#000080">);
        </font>x<font color="#000080">[</font>i<font color="#000080">]:= </font>lo<font color="#000080">(</font>j<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>e<font color="#000080">:= </font>e<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>bias<font color="#000080">-</font>e<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">8 </font><font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>x<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font>lo<font color="#000080">(</font>random<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">));
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>x<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$10</font><font color="#000080">;
    </font>x<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]:= (</font>x<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>lo<font color="#000080">(</font>e <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">);
    </font>x<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]:= </font>lo<font color="#000080">(</font>e <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">);
    </font>rnd<font color="#000080">:= </font>data<font color="#000080">.</font>d<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>gauss<font color="#000080">(</font>a<font color="#000080">,</font>d<font color="#000080">: </font>double<font color="#000080">): </font>double<font color="#000080">;
  </font><font color="#FF0000"><b>const
    </b></font>t<font color="#000080">: </font>double <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>var
    </b></font>v1<font color="#000080">,</font>v2<font color="#000080">,</font>r<font color="#000080">: </font>double<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    if </b></font>t<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      repeat
        </b></font>v1<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font>rnd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>v2<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font>rnd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>r<font color="#000080">:= </font>v1<font color="#000080">*</font>v1<font color="#000080">+</font>v2<font color="#000080">*</font>v2
      <font color="#FF0000"><b>until </b></font>r<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">;
      </font>r<font color="#000080">:= </font>sqrt<font color="#000080">((-</font><font color="#800000">2</font><font color="#000080">*</font>ln<font color="#000080">(</font>r<font color="#000080">))/</font>r<font color="#000080">);
      </font>t<font color="#000080">:= </font>v2<font color="#000080">*</font>r<font color="#000080">;
      </font>gauss<font color="#000080">:= </font>a<font color="#000080">+</font>v1<font color="#000080">*</font>r<font color="#000080">*</font>d<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else begin
      </b></font>gauss<font color="#000080">:= </font>a<font color="#000080">+</font>t<font color="#000080">*</font>d<font color="#000080">;
      </font>t<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>begin
end</b></font><font color="#000080">.


</font><font color="#008000"><i>{---------------------- cut ---------------------------------}


</i></font><font color="#FF0000"><b>program </b></font>gaussiantest<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>graph<font color="#000080">,</font>rndgauss<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>bgipath <font color="#000080">= </font><font color="#800000">'c:\bp\bgi'</font><font color="#000080">;
  </font>largestx <font color="#000080">= </font><font color="#800000">999</font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>testplot<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>htarry<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>largestx<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
    </font>x<font color="#000080">,</font>y<font color="#000080">,</font>w<font color="#000080">,</font>h<font color="#000080">,</font>m<font color="#000080">,</font>v<font color="#000080">: </font>word<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>fillchar<font color="#000080">(</font>htarry<font color="#000080">,</font>sizeof<font color="#000080">(</font>htarry<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
    </font>w<font color="#000080">:= </font>getmaxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>h<font color="#000080">:= </font>getmaxy<font color="#000080">;
    </font>m<font color="#000080">:= </font>getmaxx <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
    </font>v<font color="#000080">:= </font>getmaxx <font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">;
    </font><font color="#FF0000"><b>while not </b></font>keypressed <font color="#FF0000"><b>do begin
      </b></font>x<font color="#000080">:= </font>trunc<font color="#000080">(</font>gauss<font color="#000080">(</font>m<font color="#000080">,</font>v<font color="#000080">));
      </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;=</font>largestx <font color="#FF0000"><b>then begin
        </b></font>y<font color="#000080">:= </font>htarry<font color="#000080">[</font>x<font color="#000080">];
        </font><font color="#FF0000"><b>if </b></font>y<font color="#000080">&lt;=</font>h <font color="#FF0000"><b>then begin
          </b></font>putpixel<font color="#000080">(</font>x<font color="#000080">,</font>h<font color="#000080">-</font>y<font color="#000080">,</font>white<font color="#000080">);
          </font>htarry<font color="#000080">[</font>x<font color="#000080">]:= </font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>initbgi<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>errcode<font color="#000080">,</font>grmode<font color="#000080">,</font>grdriver<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>grdriver<font color="#000080">:= </font>detect<font color="#000080">;
    </font>initgraph <font color="#000080">(</font>grdriver<font color="#000080">,</font>grmode<font color="#000080">,</font>bgipath<font color="#000080">);
    </font>errcode<font color="#000080">:= </font>graphresult<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>errcode <font color="#000080">&lt;&gt; </font>grok <font color="#FF0000"><b>then begin
      </b></font>writeln <font color="#000080">(</font><font color="#800000">'Graphics error: '</font><font color="#000080">,</font>grapherrormsg <font color="#000080">(</font>errcode<font color="#000080">));
      </font>halt <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>begin
  </b></font>initbgi<font color="#000080">;
  </font>testplot<font color="#000080">;
  </font>closegraph<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0085.PAS">Original</a><b>]</b></p></body>
</html>
