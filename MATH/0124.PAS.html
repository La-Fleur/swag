<html>
<head><title> "Fixed point conversions" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0124.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Type </b></font>Fijo<font color="#000080">=</font><font color="#FF0000"><b>Record                </b></font><font color="#008000"><i>{estructura de un n&szlig; de coma fija}
            </i></font>Mantisa<font color="#000080">,
            </font>Decimal<font color="#000080">:</font>Integer
          <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Var1<font color="#000080">,                       </font><font color="#008000"><i>{variables de ejemplo}
    </i></font>Var2<font color="#000080">:</font>Fijo<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>Decimal_Max<font color="#000080">=</font><font color="#800000">100</font><font color="#000080">;            </font><font color="#008000"><i>{2 decimales}
      </i></font>Decimal_Stellen<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Strg<font color="#000080">(</font>NumF<font color="#000080">:</font>Fijo<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{convierte un n&szlig; de coma fija en una cadena}
</i></font><font color="#FF0000"><b>Var </b></font>Decimal_Str<font color="#000080">,                  </font><font color="#008000"><i>{cadena para formar los decimales}
    </i></font>Mantisa_Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;            </font><font color="#008000"><i>{cadena para formar la mantisa}
    </i></font>i<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>NumF<font color="#000080">.</font>Decimal <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then       </b></font><font color="#008000"><i>{parte decimal sin signo}
    </i></font>NumF<font color="#000080">.</font>Decimal<font color="#000080">:=-</font>NumF<font color="#000080">.</font>Decimal<font color="#000080">;
  </font>Str<font color="#000080">(</font>NumF<font color="#000080">.</font>Decimal<font color="#000080">:</font>Decimal_Stellen<font color="#000080">,</font>Decimal_Str<font color="#000080">);
                                </font><font color="#008000"><i>{generar cadena decimal}
  </i></font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Decimal_Stellen <font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{y sustituir blancos por 0en}
    </i></font><font color="#FF0000"><b>If </b></font>Decimal_Str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>Decimal_Str<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
  </font>Str<font color="#000080">(</font>NumF<font color="#000080">.</font>Mantisa<font color="#000080">,</font>Mantisa_Str<font color="#000080">);     </font><font color="#008000"><i>{generar cadena de mantisa}
  </i></font>Strg<font color="#000080">:=</font>Mantisa_Str<font color="#000080">+</font><font color="#800000">','</font><font color="#000080">+</font>Decimal_Str<font color="#000080">; </font><font color="#008000"><i>{componer cadena}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Convert<font color="#000080">(</font>RZahl<font color="#000080">:</font>Real<font color="#000080">;</font><font color="#FF0000"><b>Var </b></font>NumF<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{convierta real RZahl en n&szlig; coma fija NumF}
</i></font><font color="#FF0000"><b>Begin
  </b></font>NumF<font color="#000080">.</font>Mantisa<font color="#000080">:=</font>Trunc<font color="#000080">(</font>RZahl<font color="#000080">);
    </font><font color="#008000"><i>{determinar parte mantisa}
  </i></font>NumF<font color="#000080">.</font>Decimal<font color="#000080">:=</font>Trunc<font color="#000080">(</font>Round<font color="#000080">(</font>Frac<font color="#000080">(</font>RZahl<font color="#000080">)*</font>Decimal_Max<font color="#000080">));
    </font><font color="#008000"><i>{determinar parte decimal y guardar como n&szlig; entero}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Adjust<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>NumF<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{devuelve el n&pound;mero de coma fija en formato legal}
</i></font><font color="#FF0000"><b>Begin
  If </b></font>NumF<font color="#000080">.</font>Decimal <font color="#000080">&gt; </font>Decimal_Max <font color="#FF0000"><b>Then Begin
    </b></font>Dec<font color="#000080">(</font>NumF<font color="#000080">.</font>Decimal<font color="#000080">,</font>Decimal_Max<font color="#000080">); </font><font color="#008000"><i>{si parte decimal ha rebasado positivo}
    </i></font>Inc<font color="#000080">(</font>NumF<font color="#000080">.</font>Mantisa<font color="#000080">);            </font><font color="#008000"><i>{reponer y reducir mantisa}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>NumF<font color="#000080">.</font>Decimal <font color="#000080">&lt; -</font>Decimal_Max <font color="#FF0000"><b>Then Begin
    </b></font>Inc<font color="#000080">(</font>NumF<font color="#000080">.</font>Decimal<font color="#000080">,</font>Decimal_Max<font color="#000080">); </font><font color="#008000"><i>{si parte decimal ha rebasado negativo}
    </i></font>Dec<font color="#000080">(</font>NumF<font color="#000080">.</font>Mantisa<font color="#000080">);            </font><font color="#008000"><i>{reponer y aumentar mantisa}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Add<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Summe<font color="#000080">:</font>Fijo<font color="#000080">;</font>NumF1<font color="#000080">,</font>NumF2<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{Suma NumF1 y NumF2 y deposita resultado en ab}
</i></font><font color="#FF0000"><b>Var </b></font>Resultado<font color="#000080">:</font>Fijo<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Resultado<font color="#000080">.</font>Decimal<font color="#000080">:=</font>NumF1<font color="#000080">.</font>Decimal<font color="#000080">+</font>NumF2<font color="#000080">.</font>Decimal<font color="#000080">;
    </font><font color="#008000"><i>{sumar parte decimal}
  </i></font>Resultado<font color="#000080">.</font>Mantisa<font color="#000080">:=</font>NumF1<font color="#000080">.</font>Mantisa<font color="#000080">+</font>NumF2<font color="#000080">.</font>Mantisa<font color="#000080">;
    </font><font color="#008000"><i>{sumar mantisa}
  </i></font>Adjust<font color="#000080">(</font>Resultado<font color="#000080">);
    </font><font color="#008000"><i>{pasar resultado a formato correcto}
  </i></font>Summe<font color="#000080">:=</font>Resultado<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Sub<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Diferencia<font color="#000080">:</font>Fijo<font color="#000080">;</font>NumF1<font color="#000080">,</font>NumF2<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{resta NumF1 de NumF2 y deposita resultado en ab}
</i></font><font color="#FF0000"><b>Var </b></font>Resultado<font color="#000080">:</font>Fijo<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Resultado<font color="#000080">.</font>Decimal<font color="#000080">:=</font>NumF1<font color="#000080">.</font>Decimal<font color="#000080">-</font>NumF2<font color="#000080">.</font>Decimal<font color="#000080">;
    </font><font color="#008000"><i>{restar parte decimal}
  </i></font>Resultado<font color="#000080">.</font>Mantisa<font color="#000080">:=</font>NumF1<font color="#000080">.</font>Mantisa<font color="#000080">-</font>NumF2<font color="#000080">.</font>Mantisa<font color="#000080">;
    </font><font color="#008000"><i>{restar mantisa}
  </i></font>Adjust<font color="#000080">(</font>Resultado<font color="#000080">);
    </font><font color="#008000"><i>{pasar resultado a formato correcto}
  </i></font>Diferencia<font color="#000080">:=</font>Resultado<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Mul<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Producto<font color="#000080">:</font>Fijo<font color="#000080">;</font>NumF1<font color="#000080">,</font>NumF2<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{multiplica NumF1 y NumF y deposita el resultado en ab}
</i></font><font color="#FF0000"><b>Var </b></font>Resultado<font color="#000080">:</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Resultado<font color="#000080">:=</font>Var1<font color="#000080">.</font>Mantisa<font color="#000080">*</font>Decimal_Max <font color="#000080">+ </font>Var1<font color="#000080">.</font>Decimal<font color="#000080">;
    </font><font color="#008000"><i>{formar primer factor}
  </i></font>Resultado<font color="#000080">:=</font>Resultado <font color="#000080">* (</font>Var2<font color="#000080">.</font>Mantisa<font color="#000080">*</font>Decimal_Max <font color="#000080">+ </font>Var2<font color="#000080">.</font>Decimal<font color="#000080">);
    </font><font color="#008000"><i>{formar segundo factor}
  </i></font>Resultado<font color="#000080">:=</font>Resultado <font color="#FF0000"><b>div </b></font>Decimal_Max<font color="#000080">;
    </font><font color="#008000"><i>{compensar factor aux. Decimal_Max}
  </i></font>Producto<font color="#000080">.</font>Mantisa<font color="#000080">:=</font>Resultado <font color="#FF0000"><b>div </b></font>Decimal_Max<font color="#000080">;
    </font><font color="#008000"><i>{extraer mantisa y parte decimal}
  </i></font>Producto<font color="#000080">.</font>Decimal<font color="#000080">:=</font>Resultado <font color="#FF0000"><b>mod </b></font>Decimal_Max<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Divi<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Cociente<font color="#000080">:</font>Fijo<font color="#000080">;</font>NumF1<font color="#000080">,</font>NumF2<font color="#000080">:</font>Fijo<font color="#000080">);
</font><font color="#008000"><i>{divide NumF1 entre NumF2 y deposita el resultado en ab}
</i></font><font color="#FF0000"><b>Var </b></font>Resultado<font color="#000080">:</font>LongInt<font color="#000080">;           </font><font color="#008000"><i>{resultado intermedio}
</i></font><font color="#FF0000"><b>Begin
  </b></font>Resultado<font color="#000080">:=</font>NumF1<font color="#000080">.</font>Mantisa<font color="#000080">*</font>Decimal_Max <font color="#000080">+ </font>NumF1<font color="#000080">.</font>Decimal<font color="#000080">;
    </font><font color="#008000"><i>{formar contador}
  </i></font>Resultado<font color="#000080">:=</font>Resultado <font color="#000080">* </font>Decimal_Max <font color="#FF0000"><b>div
</b></font><font color="#000080">(</font>NumF2<font color="#000080">.</font>Mantisa<font color="#000080">*</font>Decimal_Max<font color="#000080">+</font>NumF2<font color="#000080">.</font>Decimal<font color="#000080">);
    </font><font color="#008000"><i>{dividir por el divisor, antes disponer de m&Yacute;s decimales}
  </i></font>Cociente<font color="#000080">.</font>Mantisa<font color="#000080">:=</font>Resultado <font color="#FF0000"><b>div </b></font>Decimal_Max<font color="#000080">;
    </font><font color="#008000"><i>{extraer parte decimal y mantisa}
  </i></font>Cociente<font color="#000080">.</font>Decimal<font color="#000080">:=</font>Resultado <font color="#FF0000"><b>mod </b></font>Decimal_Max<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>WriteLn<font color="#000080">;
  </font>Convert<font color="#000080">(-</font><font color="#800000">10.2</font><font color="#000080">,</font>Var1<font color="#000080">);          </font><font color="#008000"><i>{cargar dos n&pound;meros de demo}
  </i></font>Convert<font color="#000080">(</font><font color="#800000">25.3</font><font color="#000080">,</font>Var2<font color="#000080">);

  </font><font color="#008000"><i>{c&Yacute;lculos propios para demostraci&cent;n:}

  </i></font>Write<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">),</font><font color="#800000">'*'</font><font color="#000080">,</font>Strg<font color="#000080">(</font>Var2<font color="#000080">),</font><font color="#800000">'= '</font><font color="#000080">);
  </font>Mul<font color="#000080">(</font>Var1<font color="#000080">,</font>Var1<font color="#000080">,</font>Var2<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">));

  </font>Write<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">),</font><font color="#800000">'-'</font><font color="#000080">,</font>Strg<font color="#000080">(</font>Var2<font color="#000080">),</font><font color="#800000">'= '</font><font color="#000080">);
  </font>Sub<font color="#000080">(</font>Var1<font color="#000080">,</font>Var1<font color="#000080">,</font>Var2<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">));

  </font>Write<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">),</font><font color="#800000">'/'</font><font color="#000080">,</font>Strg<font color="#000080">(</font>Var2<font color="#000080">),</font><font color="#800000">'= '</font><font color="#000080">);
  </font>Divi<font color="#000080">(</font>Var1<font color="#000080">,</font>Var1<font color="#000080">,</font>Var2<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">));

  </font>Write<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">),</font><font color="#800000">'+'</font><font color="#000080">,</font>Strg<font color="#000080">(</font>Var2<font color="#000080">),</font><font color="#800000">'= '</font><font color="#000080">);
  </font>Add<font color="#000080">(</font>Var1<font color="#000080">,</font>Var1<font color="#000080">,</font>Var2<font color="#000080">);
  </font>WriteLn<font color="#000080">(</font>Strg<font color="#000080">(</font>Var1<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0124.PAS">Original</a><b>]</b></p></body>
</html>
