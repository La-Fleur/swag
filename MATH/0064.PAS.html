<html>
<head><title> "Financial Calulations" by J.W. RIDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>ufinance<font color="#000080">;                                      </font><font color="#008000"><i>{ last modified 920520 }

{ Math Routines for Finance Calculations in Turbo Pascal }
{ Copyright 1992, J. W. Rider                            }
{ CIS mail: [70007,4652]                                 }

{  These are pascal implementations some of the finance functions
   available for ObjectVision and Quattro Pro. They are intended to
   work exactly as described in the Quattro Pro 3.0 @Functions manual.

   The following are the Lotus 1-2-3 compatibility functions.

           CTERM ( Rate, FV,      PV)
           DDB   ( cost, salvage, life, period)
           FV    ( Pmt,  Rate,    Nper)
           PMT   ( PV,   RATE,    Nper)
           PV    ( Pmt,  Rate,    Nper)
           RATE  ( FV,   PV,      Nper)
           SLN   ( cost, salvage, life)
           SYD   ( cost, salvage, life, period)
           TERM  ( pmt,  rate,    fv)

   Also implemented are the extended versions of the routines that
   balance the following &quot;cash-flow&quot; equation:

 pval*(1+rate)^nper + paymt*(1+rate*ptype)*((1+rate)^nper-1)/rate + fval = 0

           IRATE (            nper, pmt, pv, fv, ptype)
           NPER  ( rate,            pmt, pv, fv, ptype)
           PAYMT ( rate,      nper,      pv, fv, ptype)
           PPAYMT( rate, per, nper,      pv, fv, ptype)
           IPAYMT( rate, per, nper,      pv, fv, ptype)
           PVAL  ( rate,      nper, pmt,     fv, ptype)
           FVAL  ( rate,      nper, pmt, pv,     ptype)

   In QPro and OV, the ptype code is either 0 or 1 to indicate that the
   is made at the end or beginning of the month respectively.  My preferred
   explanation is that &quot;ptype&quot; is the fraction of the interest rate that is
   applied to a payment in the period that it is paid.  This has the same
   effect when ptype is 0 or 1, but complicates the explanation for what is
   right when ptype=1. THE EXAMPLES IN THE QPRO AND OV MANUALS DO NOT AGREE
   FOR THE &quot;PPAYMT&quot; FUNCTION.  Someone needs to explain these discrepancies.
   UFinance follows the QPro3 style, but the formula is different than what
   QPro3 function reference says is used for IPaymt.

   The &quot;block&quot; financial functions from QPro3 are also implemented:

                   IRR ( guess, block)
                   NPV ( rate, block, ptype)

   These make use of the &quot;UBlock.BlockType&quot; object designed especially
   for these functions.  The BlockType object provides access to a list
   of indexed floating point numbers. See the test program FINTEST.PAS
   for an example of BlockType usage.

   Caveats:  under no circumstances will I be held responsible if someone
   misuses this code.  The code is provided for the convenience of other
   programmers.  It is the someone else's responsibility to ensure that
   these functions satisfy financial needs.

   While this is a relatively complete set of functions, it is not possible
   to calculate all desirved components in the compound interest equation
   directly.  In particular, there is no way provided to compute directly
   the interest rate on an annuity or loan that goes from &quot;pv&quot; to &quot;fv&quot; in
   &quot;nper&quot; intervals, paying &quot;pmt&quot; each period.  The &quot;RATE&quot; function
   provided only determines the rate at which a compounded amount grows.
   The &quot;IRATE&quot; function computes a value by successive approximation and
   is inherently unstable. (The &quot;IRR&quot; function is subject to similar
   instability.)

   One way in which programmers go wrong is misunderstanding the
   distinction between binary floating point representations of numbers and
   decimal floating point representation.  Turbo Pascal, as well as most
   other high speed number processing systems, uses the binary form.  While
   such binary operations give results that are close to their decimal
   counterparts, some differences may arise.  Especially, when you expect
   results to round one way versus the other.
}

</i></font><font color="#FF0000"><b>interface

uses </b></font>ublock<font color="#000080">; </font><font color="#008000"><i>{ for &quot;blocktype&quot; of NPV and IRR functions }

{ &quot;Extended&quot; math is used if $N+ is set.  Otherwise, use &quot;real&quot; math.}

{$ifopt N-}
</i></font><font color="#FF0000"><b>type </b></font>extended <font color="#000080">= </font>real<font color="#000080">;
</font><font color="#008000"><i>{$endif}

</i></font><font color="#FF0000"><b>function </b></font>CTERM <font color="#000080">( </font>Rate<font color="#000080">, </font>FV<font color="#000080">, </font>PV<font color="#000080">: </font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ number of compounding periods for initial amount &quot;PV&quot; to accumulate
    into amount &quot;FV&quot; at interest &quot;Rate&quot; }

</i></font><font color="#FF0000"><b>function </b></font>DDB   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">, </font>period<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ double declining balance depreciation for the &quot;period&quot; (should be a
    positive, whole number) interval on an item with initial &quot;cost&quot; and
    final &quot;salvage&quot; value at the end of &quot;life&quot; intervals }

</i></font><font color="#FF0000"><b>function </b></font>FV    <font color="#000080">( </font>Pmt<font color="#000080">, </font>Rate<font color="#000080">, </font>Nper<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ accumulated amount from making &quot;nper&quot; payments of amount &quot;pmt&quot; with
    interest accruing on the accumulated amount at interest &quot;rate&quot;
    compounded per interval }

</i></font><font color="#FF0000"><b>function </b></font>FVAL  <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ extended version of the FV function }

</i></font><font color="#FF0000"><b>function </b></font>IPAYMT<font color="#000080">(</font>rate<font color="#000080">, </font>per<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ computes the portion of a loan payment that is interest on the
    principal }

</i></font><font color="#FF0000"><b>function </b></font>IRATE <font color="#000080">( </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ extended version of the RATE function }

</i></font><font color="#FF0000"><b>function </b></font>IRR   <font color="#000080">( </font>guess<font color="#000080">: </font>extended<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>block<font color="#000080">: </font>blocktype<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ returns internal rate-of-return of sequence of cashflows }

</i></font><font color="#FF0000"><b>function </b></font>NPER  <font color="#000080">( </font>rate<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ extended version of the CTERM and TERM functions }

</i></font><font color="#FF0000"><b>function </b></font>NPV   <font color="#000080">(
  </font>rate<font color="#000080">: </font>extended<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>block<font color="#000080">: </font>blocktype<font color="#000080">; </font>ptype<font color="#000080">:</font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ return net present value of sequence of cash flows }

</i></font><font color="#FF0000"><b>function </b></font>PAYMT <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ extended version of the PMT function }

</i></font><font color="#FF0000"><b>function </b></font>PMT   <font color="#000080">( </font>PV<font color="#000080">, </font>RATE<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ payment amount per interval on loan or annuity of initial value &quot;PV&quot;
    with payments spread out over &quot;nper&quot; intervals and with interest
    accruing at &quot;rate&quot; per interval }

</i></font><font color="#FF0000"><b>function </b></font>PPAYMT<font color="#000080">( </font>rate<font color="#000080">, </font>per<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ computes the portion of a loan payment that reduces the principal }

</i></font><font color="#FF0000"><b>function </b></font>PV    <font color="#000080">( </font>Pmt<font color="#000080">, </font>Rate<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ initial value of loan or annuity that can be paid off by making &quot;nper&quot;
    payments of &quot;pmt&quot; which interest on the unpaid amount accrues at
    &quot;rate&quot; per interval }

</i></font><font color="#FF0000"><b>function </b></font>PVAL  <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ extended version of the PV function }

</i></font><font color="#FF0000"><b>function </b></font>RATE  <font color="#000080">( </font>FV<font color="#000080">, </font>PV<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ determines interest rate per interval when initial amount &quot;pv&quot;
    accumulates into amount &quot;fv&quot; by compounding over &quot;nper&quot; intervals }

</i></font><font color="#FF0000"><b>function </b></font>SLN   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ straight line depreciation per interval when item of initial value
    &quot;cost&quot; has a value of &quot;salvage&quot; after &quot;life&quot; intervals }

</i></font><font color="#FF0000"><b>function </b></font>SYD   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">, </font>period<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ sum-of-year-digits depreciation amount for the &quot;period&quot; (should be a
    positive, whole number) interval on a item with initial &quot;cost&quot; and
    final &quot;salvage&quot; value at the end of &quot;life&quot; intervals }

</i></font><font color="#FF0000"><b>function </b></font>TERM  <font color="#000080">( </font>pmt<font color="#000080">, </font>rate<font color="#000080">, </font>fv<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
  </font><font color="#008000"><i>{ number of compounding periods required to accumulate &quot;fv&quot; by making
    periodic deposits of &quot;pmt&quot; with interest accumulating at &quot;rate&quot; per
    period }

</i></font><font color="#FF0000"><b>implementation

function </b></font>CTERM <font color="#000080">( </font>Rate<font color="#000080">, </font>FV<font color="#000080">, </font>PV<font color="#000080">: </font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>cterm<font color="#000080">:=</font>ln<font color="#000080">(</font>fv<font color="#000080">/</font>pv<font color="#000080">)/</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DDB   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">, </font>period<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>extended<font color="#000080">; </font>n<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>n<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>period<font color="#000080">&gt;</font>n <font color="#FF0000"><b>do begin
    </b></font>x<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">*</font>cost<font color="#000080">/</font>life<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cost<font color="#000080">-</font>x<font color="#000080">)&lt;</font>salvage <font color="#FF0000"><b>then </b></font>x<font color="#000080">:=</font>cost<font color="#000080">-</font>salvage<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>cost<font color="#000080">:=</font>cost<font color="#000080">-</font>x<font color="#000080">; </font>inc<font color="#000080">(</font>n<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ddb<font color="#000080">:=</font>x<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FV    <font color="#000080">( </font>Pmt<font color="#000080">, </font>Rate<font color="#000080">, </font>Nper<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>fv<font color="#000080">:=</font>pmt<font color="#000080">*(</font>exp<font color="#000080">(</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">)/</font>rate
  <font color="#FF0000"><b>else                   </b></font>fv<font color="#000080">:=</font>pmt<font color="#000080">*</font>nper<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+(</font>nper<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font>rate<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FVAL  <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">: </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>f<font color="#000080">:=</font>exp<font color="#000080">(</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&lt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then
    </b></font>fval <font color="#000080">:=-</font>pmt<font color="#000080">*</font>nper<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+(</font>nper<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font>rate<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">*</font>ptype<font color="#000080">)-</font>pv<font color="#000080">*</font>f
  <font color="#FF0000"><b>else
    </b></font>fval <font color="#000080">:= </font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>f<font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">/</font>rate<font color="#000080">+</font>ptype<font color="#000080">)-</font>pv<font color="#000080">*</font>f<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IPAYMT<font color="#000080">(</font>rate<font color="#000080">, </font>per<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ipaymt <font color="#000080">:= </font>rate
    <font color="#000080">* </font>fval<font color="#000080">( </font>rate<font color="#000080">, </font>per<font color="#000080">-</font>ptype<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>paymt<font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">), </font>pv<font color="#000080">, </font>ptype<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IRATE <font color="#000080">( </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>rate<font color="#000080">,</font>x0<font color="#000080">,</font>x1<font color="#000080">,</font>y0<font color="#000080">,</font>y1<font color="#000080">:</font>extended<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>y<font color="#000080">:</font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&lt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>y<font color="#000080">:=</font>pv<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+</font>nper<font color="#000080">*</font>rate<font color="#000080">)+</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">*</font>ptype<font color="#000080">)*</font>nper<font color="#000080">+</font>fv
    <font color="#FF0000"><b>else begin
      </b></font>f<font color="#000080">:=</font>exp<font color="#000080">(</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">));
      </font>y<font color="#000080">:=</font>pv<font color="#000080">*</font>f<font color="#000080">+</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">/</font>rate<font color="#000080">+</font>ptype<font color="#000080">)*(</font>f<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)+</font>fv<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{irate}

  { JWR: There are two fundamental problems with solutions by successive
    approximation.  One is figuring out where you want to start; the
    other is figuring out where you want to stop.  If you don't set them
    right, then your solution will approximate successively forever.
    This is my guess, but there is no guarantee that the solution will
    even exist, much less converge. }

  </i></font>rate<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>y0<font color="#000080">:=</font>pv<font color="#000080">+</font>pmt<font color="#000080">*</font>nper<font color="#000080">+</font>fv<font color="#000080">; </font>x0<font color="#000080">:=</font>rate<font color="#000080">;
  </font>rate<font color="#000080">:=</font>exp<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">/</font>nper<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">; </font>y1<font color="#000080">:=</font>y<font color="#000080">; </font>x1<font color="#000080">:=</font>rate<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>abs<font color="#000080">(</font>y0<font color="#000080">-</font>y1<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>do begin </b></font><font color="#008000"><i>{ find root by secant method }
    </i></font>rate<font color="#000080">:=(</font>y1<font color="#000080">*</font>x0<font color="#000080">-</font>y0<font color="#000080">*</font>x1<font color="#000080">)/(</font>y1<font color="#000080">-</font>y0<font color="#000080">); </font>x0<font color="#000080">:=</font>x1<font color="#000080">; </font>x1<font color="#000080">:=</font>rate<font color="#000080">; </font>y0<font color="#000080">:=</font>y1<font color="#000080">; </font>y1<font color="#000080">:=</font>y<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>irate<font color="#000080">:=</font>rate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{irate}

</i></font><font color="#FF0000"><b>function </b></font>IRR<font color="#000080">( </font>guess<font color="#000080">: </font>extended<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>block<font color="#000080">: </font>blocktype<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>orate<font color="#000080">, </font>rate<font color="#000080">: </font>extended<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>drate<font color="#000080">(</font>rate<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>var </b></font>npv<font color="#000080">,</font>npvprime<font color="#000080">,</font>blockvaluei<font color="#000080">:</font>extended<font color="#000080">; </font>i<font color="#000080">:</font>longint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>npv<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>npvprime<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>rate<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">/(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font>block<font color="#000080">.</font>count <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
      </b></font>blockvaluei<font color="#000080">:=</font>block<font color="#000080">.</font>value<font color="#000080">(</font>i<font color="#000080">);
      </font>npv<font color="#000080">:=</font>npv<font color="#000080">*</font>rate<font color="#000080">+</font>blockvaluei<font color="#000080">;
      </font>npvprime<font color="#000080">:=(</font>npvprime<font color="#000080">+</font>blockvaluei<font color="#000080">*</font>i<font color="#000080">)*</font>rate<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>npvprime<font color="#000080">)&lt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then </b></font>drate<font color="#000080">:=</font>npv<font color="#000080">*</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#008000"><i>{ a guess }
    </i></font><font color="#FF0000"><b>else                       </b></font>drate<font color="#000080">:=</font>npv<font color="#000080">/</font>npvprime<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{IRR}

  { JWR: same caveats as for IRate }

  </i></font>orate<font color="#000080">:=</font>guess<font color="#000080">; </font>rate<font color="#000080">:=</font>orate<font color="#000080">+</font>drate<font color="#000080">(</font>orate<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>abs<font color="#000080">(</font>rate<font color="#000080">-</font>orate<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>do begin </b></font><font color="#008000"><i>{ find root by newton-raphson }
    </i></font>orate<font color="#000080">:=</font>rate<font color="#000080">; </font>rate<font color="#000080">:=</font>rate<font color="#000080">+</font>drate<font color="#000080">(</font>rate<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>irr<font color="#000080">:=</font>rate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>NPER  <font color="#000080">( </font>rate<font color="#000080">, </font>pmt<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>f<font color="#000080">:=</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">*</font>ptype<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then
    </b></font>nper<font color="#000080">:=</font>ln<font color="#000080">((</font>f<font color="#000080">-</font>rate<font color="#000080">*</font>fv<font color="#000080">)/(</font>pv<font color="#000080">*</font>rate<font color="#000080">+</font>f<font color="#000080">))/</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>nper<font color="#000080">:=-(</font>fv<font color="#000080">+</font>pv<font color="#000080">)/(</font>pv<font color="#000080">*</font>rate<font color="#000080">+</font>f<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>NPV   <font color="#000080">(
  </font>rate<font color="#000080">: </font>extended<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>block<font color="#000080">: </font>blocktype<font color="#000080">; </font>ptype<font color="#000080">:</font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">:</font>extended<font color="#000080">; </font>i<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>rate<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">/(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">); </font><font color="#008000"><i>{note: change in meaning of &quot;rate&quot;!}
  </i></font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font>block<font color="#000080">.</font>count <font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>x<font color="#000080">:=</font>x<font color="#000080">*</font>rate<font color="#000080">+</font>block<font color="#000080">.</font>value<font color="#000080">(</font>i<font color="#000080">);
  </font>npv<font color="#000080">:=</font>x<font color="#000080">*</font>exp<font color="#000080">((</font><font color="#800000">1</font><font color="#000080">-</font>ptype<font color="#000080">)*</font>ln<font color="#000080">(</font>rate<font color="#000080">)); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PAYMT <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>f<font color="#000080">:=</font>exp<font color="#000080">(</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">));
  </font>paymt<font color="#000080">:= (</font>fv<font color="#000080">+</font>pv<font color="#000080">*</font>f<font color="#000080">)*</font>rate<font color="#000080">/((</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">*</font>ptype<font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">-</font>f<font color="#000080">)); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PMT   <font color="#000080">( </font>PV<font color="#000080">, </font>RATE<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>pmt<font color="#000080">:=</font>pv<font color="#000080">*</font>rate<font color="#000080">/(</font><font color="#800000">1</font><font color="#000080">-</font>exp<font color="#000080">(-</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">))) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PPAYMT<font color="#000080">( </font>rate<font color="#000080">, </font>per<font color="#000080">, </font>nper<font color="#000080">, </font>pv<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>f<font color="#000080">:=</font>paymt<font color="#000080">(</font>rate<font color="#000080">,</font>nper<font color="#000080">,</font>pv<font color="#000080">,</font>fv<font color="#000080">,</font>ptype<font color="#000080">);
  </font>ppaymt<font color="#000080">:=</font>f<font color="#000080">-</font>rate<font color="#000080">*</font>fval<font color="#000080">(</font>rate<font color="#000080">,</font>per<font color="#000080">-</font>ptype<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>f<font color="#000080">,</font>pv<font color="#000080">,</font>ptype<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PV    <font color="#000080">( </font>Pmt<font color="#000080">, </font>Rate<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then
    </b></font>pv<font color="#000080">:=</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font>exp<font color="#000080">(-</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">)))/</font>rate
  <font color="#FF0000"><b>else
    </b></font>pv<font color="#000080">:=</font>pmt<font color="#000080">*</font>nper<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+(</font>nper<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font>rate<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">)/(</font><font color="#800000">1</font><font color="#000080">+</font>nper<font color="#000080">*</font>rate<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>PVAL  <font color="#000080">( </font>rate<font color="#000080">, </font>nper<font color="#000080">, </font>pmt<font color="#000080">, </font>fv<font color="#000080">, </font>ptype<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>f<font color="#000080">:</font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>abs<font color="#000080">(</font>rate<font color="#000080">)&gt;</font><font color="#800000">1e</font><font color="#000080">-</font><font color="#800000">6 </font><font color="#FF0000"><b>then begin
    </b></font>f<font color="#000080">:=</font>exp<font color="#000080">(</font>nper<font color="#000080">*</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">)); </font>pval <font color="#000080">:= (</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">/</font>rate<font color="#000080">+</font>ptype<font color="#000080">)*(</font><font color="#800000">1</font><font color="#000080">-</font>f<font color="#000080">)-</font>fv<font color="#000080">)/</font>f<font color="#000080">; </font><font color="#FF0000"><b>end
  else
    </b></font>pval<font color="#000080">:=-(</font>pmt<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">*</font>ptype<font color="#000080">)*</font>nper<font color="#000080">+</font>fv<font color="#000080">)/(</font><font color="#800000">1</font><font color="#000080">+</font>nper<font color="#000080">*</font>rate<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RATE  <font color="#000080">( </font>FV<font color="#000080">, </font>PV<font color="#000080">, </font>Nper<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>rate<font color="#000080">:=</font>exp<font color="#000080">(</font>ln<font color="#000080">(</font>fv<font color="#000080">/</font>pv<font color="#000080">)/</font>nper<font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SLN   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>sln<font color="#000080">:=(</font>cost<font color="#000080">-</font>salvage<font color="#000080">)/</font>life <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>SYD   <font color="#000080">( </font>cost<font color="#000080">, </font>salvage<font color="#000080">, </font>life<font color="#000080">, </font>period<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>syd<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">*(</font>cost<font color="#000080">-</font>salvage<font color="#000080">)*(</font>life<font color="#000080">-</font>period<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)/(</font>life<font color="#000080">*(</font>life<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TERM  <font color="#000080">( </font>pmt<font color="#000080">, </font>rate<font color="#000080">, </font>fv<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin  </b></font>term<font color="#000080">:=</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+(</font>fv<font color="#000080">/</font>pmt<font color="#000080">)*</font>rate<font color="#000080">)/</font>ln<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>rate<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ----------------------    CUT HERE -------------------------- }

</i></font><font color="#FF0000"><b>unit </b></font>ublock<font color="#000080">;

</font><font color="#008000"><i>{ defines the &quot;BlockType&quot; object used for the UFinance NPV and IRR functions }
{ Copyright 1992 by J. W. Rider }
{ CIS mail: [70007,4652] }

</i></font><font color="#FF0000"><b>interface

</b></font><font color="#008000"><i>{$ifopt N-}
</i></font><font color="#FF0000"><b>type
  </b></font>extended <font color="#000080">= </font>real<font color="#000080">;
</font><font color="#008000"><i>{$endif}

</i></font><font color="#FF0000"><b>type

  </b></font><font color="#008000"><i>{ the abstract &quot;block&quot;: this is the type that is used for the
    type of &quot;var&quot; parameters in procedures and functions }
  </i></font>BlockTypePtr <font color="#000080">= ^</font>BlockType<font color="#000080">;
  </font>BlockType <font color="#000080">= </font><font color="#FF0000"><b>object
    function </b></font>count<font color="#000080">: </font>longint<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;  </font><font color="#008000"><i>{ number of values in &quot;block&quot; }
    </i></font><font color="#FF0000"><b>function </b></font>value<font color="#000080">(</font>n<font color="#000080">:</font>longint<font color="#000080">):</font>extended<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#008000"><i>{ return nth value }
    </i></font><font color="#FF0000"><b>destructor </b></font>done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>ExtendedArrayPtr <font color="#000080">= ^</font>ExtendedArray<font color="#000080">;
  </font>ExtendedArray <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">$fff8 </font><font color="#FF0000"><b>div </b></font>sizeof<font color="#000080">(</font>extended<font color="#000080">)] </font><font color="#FF0000"><b>of </b></font>extended<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>{ a special-purpose block that extracts values from &quot;extended&quot; arrays.
    This is the type that would be declared as &quot;const&quot; or &quot;var&quot; or
    allocated on the heap in your program.  This one is very simple; you
    could easily extend the abstract block to other storage forms. }
  {  Note that &quot;extended&quot; means the same as &quot;real&quot; if $N-. }
  </i></font>ExtendedArrayBlockTypePtr <font color="#000080">= ^</font>ExtendedArrayBlockType<font color="#000080">;
  </font>ExtendedArrayBlockType <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>BlockType<font color="#000080">)
    </font>c<font color="#000080">: </font>word<font color="#000080">;
    </font>d<font color="#000080">: </font>extendedarrayptr<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>count<font color="#000080">:</font>longint<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>value<font color="#000080">(</font>n<font color="#000080">:</font>longint<font color="#000080">):</font>extended<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>init<font color="#000080">(</font>dim<font color="#000080">:</font>word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>firstvalue<font color="#000080">:</font>extended<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

function </b></font>blocktype<font color="#000080">.</font>count<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>count<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>extendedarrayblocktype<font color="#000080">.</font>count<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>count<font color="#000080">:=</font>c<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>blocktype<font color="#000080">.</font>done<font color="#000080">; </font><font color="#FF0000"><b>begin end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>extendedarrayblocktype<font color="#000080">.</font>init<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>c<font color="#000080">:=</font>dim<font color="#000080">; </font>d<font color="#000080">:=@</font>firstvalue<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>blocktype<font color="#000080">.</font>value<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>value<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>extendedarrayblocktype<font color="#000080">.</font>value<font color="#000080">; </font><font color="#FF0000"><b>begin </b></font>value<font color="#000080">:=</font>d<font color="#000080">^[</font>n<font color="#000080">] </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ========================   DEMO ============================= }

{JWR: The output scrolls without stopping.  You might want to replace
 &quot;writeln;&quot; with &quot;readln;&quot; so that you can follow along in the QPRO
 manual while you run the example. What I usually do for testing is
 just to redirect everything to a file from the command line and then
 examine the file.}

</i></font><font color="#FF0000"><b>program </b></font>fintest<font color="#000080">;
</font><font color="#FF0000"><b>uses </b></font>ufinance<font color="#000080">,</font>ublock<font color="#000080">;

</font><font color="#008000"><i>{ these types and consts are used for the IRR and NPV functions }

</i></font><font color="#FF0000"><b>type
  </b></font>xray3 <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>extended<font color="#000080">;
  </font>xray5 <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>extended<font color="#000080">;
  </font>xray7 <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>extended<font color="#000080">;
  </font>bt <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>extendedarrayblocktype<font color="#000080">) </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>x1<font color="#000080">: </font>xray3 <font color="#000080">= (-</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">150</font><font color="#000080">,-</font><font color="#800000">145</font><font color="#000080">);
  </font>x2<font color="#000080">: </font>xray3 <font color="#000080">= (-</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">150.1</font><font color="#000080">,-</font><font color="#800000">145</font><font color="#000080">);
  </font>a<font color="#000080">: </font>xray7 <font color="#000080">= (-</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">700</font><font color="#000080">,</font><font color="#800000">600</font><font color="#000080">,</font><font color="#800000">750</font><font color="#000080">,</font><font color="#800000">900</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">1400</font><font color="#000080">);
  </font>b<font color="#000080">: </font>xray7 <font color="#000080">= (-</font><font color="#800000">50000</font><font color="#000080">,-</font><font color="#800000">8000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">6000</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">4500</font><font color="#000080">);
  </font>c<font color="#000080">: </font>xray7 <font color="#000080">= (-</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">1200</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);
  </font>a2<font color="#000080">: </font>xray5 <font color="#000080">= (-</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">);
  </font>b2<font color="#000080">: </font>xray7 <font color="#000080">= (</font><font color="#800000">8000</font><font color="#000080">,</font><font color="#800000">9000</font><font color="#000080">,</font><font color="#800000">8500</font><font color="#000080">,</font><font color="#800000">9500</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">11000</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">);
  </font>c2<font color="#000080">: </font>xray7 <font color="#000080">= (</font><font color="#800000">200</font><font color="#000080">,</font><font color="#800000">350</font><font color="#000080">,-</font><font color="#800000">300</font><font color="#000080">,</font><font color="#800000">600</font><font color="#000080">,</font><font color="#800000">700</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">1200</font><font color="#000080">);
  </font>d2<font color="#000080">: </font>xray7 <font color="#000080">= (</font><font color="#800000">3500</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">6500</font><font color="#000080">,</font><font color="#800000">7000</font><font color="#000080">);

  </font>block1<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">; </font>d<font color="#000080">:@</font>x1<font color="#000080">);
  </font>block2<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">; </font>d<font color="#000080">:@</font>x2<font color="#000080">);
  </font>block3<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>a<font color="#000080">);
  </font>block4<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>b<font color="#000080">);
  </font>block5<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>c<font color="#000080">);
  </font>block6<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">5</font><font color="#000080">; </font>d<font color="#000080">:@</font>a2<font color="#000080">);
  </font>block7<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">; </font>d<font color="#000080">:@</font>a2<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
  </font>block8<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>b2<font color="#000080">);
  </font>block9<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>c2<font color="#000080">);
  </font>block10<font color="#000080">:</font>bt <font color="#000080">= (</font>c<font color="#000080">:</font><font color="#800000">7</font><font color="#000080">; </font>d<font color="#000080">:@</font>d2<font color="#000080">);

</font><font color="#FF0000"><b>begin

  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Test of UFinance unit.  Examples from'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'    Quattro Pro 3.0 @Functions and Macros manual'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 29 (CTERM):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>cterm<font color="#000080">(</font><font color="#800000">0.07</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>nper<font color="#000080">(</font><font color="#800000">0.07</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'(nper)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>cterm<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>cterm<font color="#000080">(</font><font color="#800000">0.12</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>cterm<font color="#000080">(</font><font color="#800000">0.12</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">7000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'pages 35-36 (DDB):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 48 (FV):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fv<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0.15</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fval<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,-</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'(fval)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fv<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">,</font><font color="#800000">0.12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fv<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0.9</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fv<font color="#000080">(</font><font color="#800000">800</font><font color="#000080">,</font><font color="#800000">0.9</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fv<font color="#000080">(</font><font color="#800000">800</font><font color="#000080">,</font><font color="#800000">0.9</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 49 (FVAL):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fval<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,-</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>fval<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,-</font><font color="#800000">500</font><font color="#000080">,-</font><font color="#800000">340</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 57 (IPAYMT):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ipaymt<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">100000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'pages 57-58 (IRATE):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irate<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,-</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irate<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">,-</font><font color="#800000">2000</font><font color="#000080">,-</font><font color="#800000">2.38</font><font color="#000080">,</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'pages 60-61 (IRR):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>block1<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>block1<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>block2<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>block2<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>block3<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>block4<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>irr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>block5<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 73 (NPER):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>nper<font color="#000080">(</font><font color="#800000">0.115</font><font color="#000080">,-</font><font color="#800000">2000</font><font color="#000080">,-</font><font color="#800000">633</font><font color="#000080">,</font><font color="#800000">50000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 75 (NPV):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>npv<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font>block6<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>a2<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>npv<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font>block7<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>npv<font color="#000080">(</font><font color="#800000">0.0125</font><font color="#000080">,</font>block8<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>npv<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font>block9<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>npv<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font>block10<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 77 (PAYMT):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>paymt<font color="#000080">(</font><font color="#800000">0.175</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">*</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">175000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>paymt<font color="#000080">(</font><font color="#800000">0.175</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">*</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">175000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>paymt<font color="#000080">(</font><font color="#800000">0.175</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">*</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">175000</font><font color="#000080">,-</font><font color="#800000">80000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'pages 78-79 (PMT)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pmt<font color="#000080">(</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0.15</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>paymt<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'(paymt)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pmt<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">0.12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pmt<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0.16</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pmt<font color="#000080">(</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">0.16</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pmt<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">0.11</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 79 (PPAYMT):'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ppaymt<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">100000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ppaymt<font color="#000080">(</font><font color="#800000">0.15</font><font color="#000080">/</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 81 (PV)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pv<font color="#000080">(</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">0.07</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pval<font color="#000080">(</font><font color="#800000">0.07</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">,-</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'(pval)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pv<font color="#000080">(</font><font color="#800000">277</font><font color="#000080">,</font><font color="#800000">0.12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pv<font color="#000080">(</font><font color="#800000">600</font><font color="#000080">,</font><font color="#800000">0.17</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pv<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">0.11</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 82 (PVAL)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pval<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>pval<font color="#000080">(</font><font color="#800000">0.1</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">30000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 84 (RATE)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>rate<font color="#000080">(</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>rate<font color="#000080">(</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">7000</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">*</font><font color="#800000">12</font><font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>rate<font color="#000080">(</font><font color="#800000">1200</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>rate<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'%'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 89 (SLN)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>sln<font color="#000080">(</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>sln<font color="#000080">(</font><font color="#800000">15000</font><font color="#000080">,</font><font color="#800000">3000</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>sln<font color="#000080">(</font><font color="#800000">5000</font><font color="#000080">,</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>sln<font color="#000080">(</font><font color="#800000">1800</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'pages 94-95 (SYD)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">350</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>syd<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'(ddb)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'(ddb)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'(ddb)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'(ddb)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>ddb<font color="#000080">(</font><font color="#800000">12000</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'(ddb)'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'page 96 (TERM)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">0.11</font><font color="#000080">,</font><font color="#800000">50000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>nper<font color="#000080">(</font><font color="#800000">0.11</font><font color="#000080">,-</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">50000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'(nper)'</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">300</font><font color="#000080">,</font><font color="#800000">0.06</font><font color="#000080">,</font><font color="#800000">5000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">1</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0.07</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">,</font><font color="#800000">0.07</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">0.10</font><font color="#000080">,</font><font color="#800000">50000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">1</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font>term<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">0.05</font><font color="#000080">,</font><font color="#800000">1000</font><font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p></body>
</html>
