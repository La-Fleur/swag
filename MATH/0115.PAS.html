<html>
<head><title> "Calculating a Factor using Gamma" by DANIEL DOUBROVKINE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0115.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
                Daniel Doubrovkine - dblock@infomaniak.ch
   part of the Expression Calculator 2.0 Multithread, destribute freely
              http://www.infomaniak.ch/~dblock/express.htm
  (ref. Wanner / Hairer - Analysis by it's History - University of Geneva)

  calculating a factor of any defined value inclusing negative and positive
      non integers! using Euler's (another swiss guy) Gamma function:
       n!=Gamma(n+1) and (n-1)!=Gamma(n)/(n-1) for negative values
        Gamma(Alpha):=Integral zero-&gt;infinity of x^(Alpha-1)*E^-x

 in GammaIntegral function TOTAL PRECISION (not just approx!) is reached by
   calculating an integral from 0 to 100 with a step if 0.01 from Gamma(4)
*)
</i></font><font color="#FF0000"><b>function </b></font>Gamma<font color="#000080">(</font>alpha<font color="#000080">,</font>step<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
 </font><font color="#FF0000"><b>function </b></font>GammaIntegral<font color="#000080">(</font>alpha<font color="#000080">:</font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#008000"><i>(*x^y:=e^(y*ln(x));*)
  </i></font><font color="#FF0000"><b>function </b></font>Power<font color="#000080">(</font>base<font color="#000080">, </font>exponent<font color="#000080">: </font>extended<font color="#000080">): </font>extended<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      </b></font>Power<font color="#000080">:=</font>exp<font color="#000080">(</font>exponent<font color="#000080">*</font>ln<font color="#000080">(</font>base<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>IntegralStep<font color="#000080">(</font>x<font color="#000080">: </font>extended<font color="#000080">):</font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>(*Gamma Integral Step...just to have less mess*)
     </i></font>IntegralStep<font color="#000080">:=</font>power<font color="#000080">(</font>x<font color="#000080">,</font>alpha<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)/</font>power<font color="#000080">(</font>Exp<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>x<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#008000"><i>(*Gamma Integral*)
 </i></font><font color="#FF0000"><b>var
   </b></font>GammaTempIntegral<font color="#000080">:</font>extended<font color="#000080">;
   </font>l<font color="#000080">: </font>extended<font color="#000080">;
 </font><font color="#FF0000"><b>begin
   </b></font>l<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>GammaTempIntegral<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font>l<font color="#000080">&lt;</font><font color="#800000">100 </font><font color="#FF0000"><b>do begin
         </b></font>l<font color="#000080">:=</font>l<font color="#000080">+</font>Step<font color="#000080">;
         </font>GammaTempIntegral<font color="#000080">:=</font>GammaTempIntegral<font color="#000080">+</font>IntegralStep<font color="#000080">(</font>l<font color="#000080">)*</font>step<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font>GammaIntegral<font color="#000080">:=</font>GammaTempIntegral<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>(*Gamma*)
</i></font><font color="#FF0000"><b>var
  </b></font>NewGamma<font color="#000080">: </font>extended<font color="#000080">;
  </font>i<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>alpha<font color="#000080">&lt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    if </b></font><font color="#000080">(</font>trunc<font color="#000080">(</font>alpha<font color="#000080">)=</font>alpha<font color="#000080">) </font><font color="#FF0000"><b>then begin
       </b></font>writeln<font color="#000080">(</font><font color="#800000">'factor results to infinite value'</font><font color="#000080">);
       </font>halt<font color="#000080">;
       </font><font color="#FF0000"><b>end
       else begin
            </b></font>NewGamma<font color="#000080">:=</font>GammaIntegral<font color="#000080">(</font>abs<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">+</font>frac<font color="#000080">(</font>alpha<font color="#000080">))+</font><font color="#800000">1</font><font color="#000080">);
            </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>trunc<font color="#000080">(</font>abs<font color="#000080">(</font>alpha<font color="#000080">))-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
                </b></font>NewGamma<font color="#000080">:=</font>NewGamma<font color="#000080">/(</font>frac<font color="#000080">(</font>alpha<font color="#000080">)-</font>i<font color="#000080">);
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font>Gamma<font color="#000080">:=</font>NewGamma<font color="#000080">;
            </font>exit<font color="#000080">;
            </font><font color="#FF0000"><b>end
  end  else begin
     </b></font><font color="#008000"><i>(*the following values return trailing decimals, this corrects it*)
     </i></font><font color="#FF0000"><b>if </b></font>alpha<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Gamma<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>else
     if </b></font>alpha<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>Gamma<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>else
     if </b></font>alpha<font color="#000080">=</font><font color="#800000">3 </font><font color="#FF0000"><b>then </b></font>Gamma<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>else
     </b></font>Gamma<font color="#000080">:=</font>GammaIntegral<font color="#000080">(</font>alpha<font color="#000080">);
     </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Factor<font color="#000080">(</font>n<font color="#000080">: </font>extended<font color="#000080">):</font>extended<font color="#000080">;
 </font><font color="#FF0000"><b>begin
   </b></font>Factor<font color="#000080">:=</font>Gamma<font color="#000080">(</font>n<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0.01</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font>writeln<font color="#000080">(</font>Factor<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">):</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0115.PAS">Original</a><b>]</b></p></body>
</html>
