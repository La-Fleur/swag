<html>
<head><title> "Simplex Method" by HOWARD KAPLAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
In response to a request from rfv@maties.sun.ac.za in sunny South
Africa, here is some code from snowy Toronto which implements the
simplex method:

{SIMPLEX.PAS -- Simplex routine adapted from FORTRAN version in
                Numerical Recipes, by Press, Flannery, Teukolsy, and
                Vetterling, 1986 edition.  Adaptation made by
                Howard L. Kaplan, Addiction Research Foundation,
                Toronto, Ontario in 1993.  If you have the right to
                use the FORTRAN original, then Howard Kaplan grants
                you the right to use this adaptation.}

{$N+}
{if you want a standalone test, then do not $define UnitMode}
{$define UnitMode}

{$ifdef UnitMode}
</i></font><font color="#FF0000"><b>unit    </b></font>SIMPLEX<font color="#000080">;

</font><font color="#FF0000"><b>interface
</b></font><font color="#008000"><i>{$endif}

</i></font><font color="#FF0000"><b>const   </b></font>MaxSimplexDimensions<font color="#000080">=</font><font color="#800000">10</font><font color="#000080">;
        </font>MaxIterations<font color="#000080">=</font><font color="#800000">200</font><font color="#000080">;

</font><font color="#FF0000"><b>type    </b></font>ParameterVector<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxSimplexDimensions<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single<font color="#000080">;
        </font>ParameterArray<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxSimplexDimensions<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
                       </b></font>ParameterVector<font color="#000080">;
        </font>EvaluationArray<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxSimplexDimensions<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>single<font color="#000080">;
        </font>String20<font color="#000080">=</font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
        </font>Evaluator<font color="#000080">=</font><font color="#FF0000"><b>function</b></font><font color="#000080">(</font>R<font color="#000080">: </font>ParameterVector<font color="#000080">;
                           </font><font color="#FF0000"><b>const </b></font>Why<font color="#000080">: </font>OpenString<font color="#000080">): </font>single<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Amoeba<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>P<font color="#000080">: </font>ParameterArray<font color="#000080">; </font><font color="#008000"><i>{starting vertices}
                 </i></font>NDim<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{N of elements of ParameterVector used}
                 </i></font>FTol<font color="#000080">: </font>single<font color="#000080">;  </font><font color="#008000"><i>{fractional convergence tolerance}
                 </i></font>Func<font color="#000080">: </font>Evaluator<font color="#000080">; </font><font color="#008000"><i>{fit evaluation function}
                 </i></font><font color="#FF0000"><b>var </b></font>Iter<font color="#000080">: </font>integer <font color="#008000"><i>{number of iterations used}</i></font><font color="#000080">);
</font><font color="#008000"><i>{$ifdef UnitMode}
</i></font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$else}
</i></font><font color="#FF0000"><b>forward</b></font><font color="#000080">;
</font><font color="#008000"><i>{$endif}

</i></font><font color="#FF0000"><b>procedure </b></font>Amoeba<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>P<font color="#000080">: </font>ParameterArray<font color="#000080">; </font><font color="#008000"><i>{starting vertices}
                 </i></font>NDim<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{N of elements of ParameterVector used}
                 </i></font>FTol<font color="#000080">: </font>single<font color="#000080">;  </font><font color="#008000"><i>{fractional convergence tolerance}
                 </i></font>Func<font color="#000080">: </font>Evaluator<font color="#000080">; </font><font color="#008000"><i>{fit evaluation function}
                 </i></font><font color="#FF0000"><b>var </b></font>Iter<font color="#000080">: </font>integer <font color="#008000"><i>{number of iterations used}</i></font><font color="#000080">);
</font><font color="#FF0000"><b>const </b></font>Alpha<font color="#000080">=</font><font color="#800000">1.0</font><font color="#000080">;
      </font>Beta<font color="#000080">=</font><font color="#800000">0.5</font><font color="#000080">;
      </font>Gamma<font color="#000080">=</font><font color="#800000">2.0</font><font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>Y<font color="#000080">:     </font>EvaluationArray<font color="#000080">;
      </font>PBar<font color="#000080">:  </font>ParameterVector<font color="#000080">; </font><font color="#008000"><i>{centroid without worst point}
      </i></font>PR<font color="#000080">,
      </font>PRR<font color="#000080">:   </font>ParameterVector<font color="#000080">; </font><font color="#008000"><i>{test points to be evaluated}
      </i></font>MPts<font color="#000080">,              </font><font color="#008000"><i>{number of points in the simplex}
      </i></font>I<font color="#000080">,</font>J<font color="#000080">,
      </font>IHi<font color="#000080">,               </font><font color="#008000"><i>{index of highest (worst) evaluation}
      </i></font>INHi<font color="#000080">,              </font><font color="#008000"><i>{index of next-highest evaluation}
      </i></font>ILo<font color="#000080">:   </font>integer<font color="#000080">;    </font><font color="#008000"><i>{index of lowest (best) evaluation}
      </i></font>YPr<font color="#000080">,               </font><font color="#008000"><i>{function evaluated at PR}
      </i></font>YPrr<font color="#000080">,              </font><font color="#008000"><i>{function evaluated at PRR}
      </i></font>STemp<font color="#000080">: </font>single<font color="#000080">;
      </font>Why<font color="#000080">:   </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
</font><font color="#008000"><i>{sub}</i></font><font color="#FF0000"><b>function </b></font>NString<font color="#000080">(</font>N<font color="#000080">: </font>integer<font color="#000080">): </font>string20<font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
     </b></font>Str<font color="#000080">(</font>N<font color="#000080">,</font>S<font color="#000080">);
     </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">)&lt;</font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>S<font color="#000080">:=</font><font color="#800000">' '</font><font color="#000080">+</font>S<font color="#000080">;
     </font>NString<font color="#000080">:=</font>S
<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>MPts<font color="#000080">:=</font>NDim<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{number of points in the simplex}
     </i></font>Iter<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>FillChar<font color="#000080">(</font>Y<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Y<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{facilitate debugging}
     </i></font><font color="#FF0000"><b>for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MPts <font color="#FF0000"><b>do
        </b></font>Y<font color="#000080">[</font>J<font color="#000080">]:=</font>Func<font color="#000080">(</font>P<font color="#000080">[</font>J<font color="#000080">],</font><font color="#800000">'Initial row '</font><font color="#000080">+</font>NString<font color="#000080">(</font>J<font color="#000080">)); </font><font color="#008000"><i>{initial simplex}
     </i></font><font color="#FF0000"><b>repeat
       </b></font><font color="#008000"><i>{Find the worst, next worst, and best vertices so far}
        </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Y<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&gt;</font>Y<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>then begin
           </b></font>IHi<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
           </font>INHi<font color="#000080">:=</font><font color="#800000">2
           </font><font color="#FF0000"><b>end
        else begin
           </b></font>IHi<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
           </font>INHi<font color="#000080">:=</font><font color="#800000">1
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>ILo<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MPts <font color="#FF0000"><b>do begin
           if </b></font><font color="#000080">(</font>Y<font color="#000080">[</font>I<font color="#000080">]&lt;</font>Y<font color="#000080">[</font>ILo<font color="#000080">]) </font><font color="#FF0000"><b>then
              </b></font>ILo<font color="#000080">:=</font>I<font color="#000080">;
           </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Y<font color="#000080">[</font>I<font color="#000080">]&gt;</font>Y<font color="#000080">[</font>IHi<font color="#000080">]) </font><font color="#FF0000"><b>then begin
              </b></font>INHi<font color="#000080">:=</font>IHi<font color="#000080">;
              </font>IHi<font color="#000080">:=</font>I
              <font color="#FF0000"><b>end
           else if </b></font><font color="#000080">(</font>Y<font color="#000080">[</font>I<font color="#000080">]&gt;</font>Y<font color="#000080">[</font>INHi<font color="#000080">]) </font><font color="#FF0000"><b>then
            if </b></font><font color="#000080">(</font>I<font color="#000080">&lt;&gt;</font>IHi<font color="#000080">) </font><font color="#FF0000"><b>then
              </b></font>INHi<font color="#000080">:=</font>I
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#008000"><i>{If the worst is 0 or close, return}
        </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Y<font color="#000080">[</font>IHi<font color="#000080">]&lt;=</font>FTol<font color="#000080">) </font><font color="#FF0000"><b>then
           </b></font>Exit<font color="#000080">;
       </font><font color="#008000"><i>{Compute the fractional range from worst to best, and return if
        satisfactory}
        </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font><font color="#800000">2</font><font color="#000080">*</font>Abs<font color="#000080">(</font>Y<font color="#000080">[</font>IHi<font color="#000080">]-</font>Y<font color="#000080">[</font>ILo<font color="#000080">])/(</font>Abs<font color="#000080">(</font>Y<font color="#000080">[</font>IHi<font color="#000080">])+</font>Abs<font color="#000080">(</font>Y<font color="#000080">[</font>ILo<font color="#000080">])))&lt;</font>FTol<font color="#000080">) </font><font color="#FF0000"><b>then
           </b></font>Exit<font color="#000080">;
       </font><font color="#008000"><i>{If we are not allowed to do any more work, return although
        unsatisfactory}
        </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Iter<font color="#000080">=</font>MaxIterations<font color="#000080">) </font><font color="#FF0000"><b>then
           </b></font>Exit<font color="#000080">;
       </font><font color="#008000"><i>{Do another iteration}
        </i></font>Inc<font color="#000080">(</font>Iter<font color="#000080">);
       </font><font color="#008000"><i>{Compute the centroid of the face that leaves out the
        one worst point}
        </i></font><font color="#FF0000"><b>for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NDim <font color="#FF0000"><b>do begin
           </b></font>STemp<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
           </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MPts <font color="#FF0000"><b>do
            if </b></font><font color="#000080">(</font>I<font color="#000080">&lt;&gt;</font>IHi<font color="#000080">) </font><font color="#FF0000"><b>then
              </b></font>STemp<font color="#000080">:=</font>STemp<font color="#000080">+</font>P<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">];
           </font>PBar<font color="#000080">[</font>J<font color="#000080">]:=</font>STemp<font color="#000080">/</font>NDim
           <font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#008000"><i>{Reflect the simplex from the worst point, and evaluate}
        </i></font><font color="#FF0000"><b>for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NDim <font color="#FF0000"><b>do
           </b></font>PR<font color="#000080">[</font>J<font color="#000080">]:=(</font><font color="#800000">1</font><font color="#000080">+</font>Alpha<font color="#000080">)*</font>PBar<font color="#000080">[</font>J<font color="#000080">]-</font>Alpha<font color="#000080">*</font>P<font color="#000080">[</font>IHi<font color="#000080">,</font>J<font color="#000080">];
        </font>YPr<font color="#000080">:=</font>Func<font color="#000080">(</font>PR<font color="#000080">,</font><font color="#800000">'Reflect worst'</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>YPr<font color="#000080">&lt;=</font>Y<font color="#000080">[</font>ILo<font color="#000080">]) </font><font color="#FF0000"><b>then begin
          </b></font><font color="#008000"><i>{This is better than the best so far, so try an additional
           extrapolation factor of Gamma}
           </i></font><font color="#FF0000"><b>for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NDim <font color="#FF0000"><b>do
              </b></font>PRR<font color="#000080">[</font>J<font color="#000080">]:=</font>Gamma<font color="#000080">*</font>Pr<font color="#000080">[</font>J<font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>Gamma<font color="#000080">)*</font>PBar<font color="#000080">[</font>J<font color="#000080">];
           </font>YPrr<font color="#000080">:=</font>Func<font color="#000080">(</font>PRR<font color="#000080">,</font><font color="#800000">'Extend reflection'</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>YPrr<font color="#000080">&lt;</font>Y<font color="#000080">[</font>ILo<font color="#000080">]) </font><font color="#FF0000"><b>then begin
             </b></font><font color="#008000"><i>{replace the highest point with PRR}
              </i></font>P<font color="#000080">[</font>IHi<font color="#000080">]:=</font>PRR<font color="#000080">;
              </font>Y<font color="#000080">[</font>IHi<font color="#000080">]:=</font>YPrr
              <font color="#FF0000"><b>end
           else begin
             </b></font><font color="#008000"><i>{replace the highest point with PR}
              </i></font>P<font color="#000080">[</font>IHI<font color="#000080">]:=</font>PR<font color="#000080">;
              </font>Y<font color="#000080">[</font>IHi<font color="#000080">]:=</font>YPr
              <font color="#FF0000"><b>end
           end </b></font><font color="#008000"><i>{YPr&lt;YLo}
        </i></font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>YPr<font color="#000080">&gt;=</font>Y<font color="#000080">[</font>INHi<font color="#000080">]) </font><font color="#FF0000"><b>then begin
          </b></font><font color="#008000"><i>{The new point is worse than the second highest, but it might
           still be better than the highest}
           </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>YPr<font color="#000080">&lt;</font>Y<font color="#000080">[</font>IHi<font color="#000080">]) </font><font color="#FF0000"><b>then begin
              </b></font>P<font color="#000080">[</font>IHi<font color="#000080">]:=</font>PR<font color="#000080">;
              </font>Y<font color="#000080">[</font>IHi<font color="#000080">]:=</font>YPr
              <font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#008000"><i>{Whether or not the new point replaced the highest, see
           whether a point of the interior, interpolating between
           the (possibly new) highest point and the old centroid,
           is better than the highest point, and if so, replace the
           highest point; if not, contract around the best point so
           far.}
           </i></font><font color="#FF0000"><b>for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NDim <font color="#FF0000"><b>do
              </b></font>PRR<font color="#000080">[</font>J<font color="#000080">]:=</font>Beta<font color="#000080">*</font>P<font color="#000080">[</font>IHi<font color="#000080">,</font>J<font color="#000080">]+(</font><font color="#800000">1</font><font color="#000080">-</font>Beta<font color="#000080">)*</font>PBar<font color="#000080">[</font>J<font color="#000080">];
           </font>YPrr<font color="#000080">:=</font>Func<font color="#000080">(</font>PRR<font color="#000080">,</font><font color="#800000">'Interp. reflection'</font><font color="#000080">);
           </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>YPrr<font color="#000080">&lt;</font>Y<font color="#000080">[</font>IHi<font color="#000080">]) </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{replace}
              </i></font>P<font color="#000080">[</font>IHi<font color="#000080">]:=</font>PRR<font color="#000080">;
              </font>Y<font color="#000080">[</font>IHi<font color="#000080">]:=</font>YPrr
              <font color="#FF0000"><b>end
           else </b></font><font color="#008000"><i>{contract}
              </i></font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MPts <font color="#FF0000"><b>do
               if </b></font><font color="#000080">(</font>I<font color="#000080">&lt;&gt;</font>ILo<font color="#000080">) </font><font color="#FF0000"><b>then begin
                 for </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>NDim <font color="#FF0000"><b>do
                    </b></font>P<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]:=(</font>P<font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">]+</font>P<font color="#000080">[</font>ILo<font color="#000080">,</font>J<font color="#000080">])/</font><font color="#800000">2</font><font color="#000080">;
                 </font>Y<font color="#000080">[</font>I<font color="#000080">]:=</font>Func<font color="#000080">(</font>P<font color="#000080">[</font>I<font color="#000080">],</font><font color="#800000">'Contract'</font><font color="#000080">)
                 </font><font color="#FF0000"><b>end
           end </b></font><font color="#008000"><i>{PRR was worse than the second-highest}
        </i></font><font color="#FF0000"><b>else begin
          </b></font><font color="#008000"><i>{PR was better than the second-highest, so we replace the old
           highest point}
           </i></font>P<font color="#000080">[</font>IHi<font color="#000080">]:=</font>PR<font color="#000080">;
           </font>Y<font color="#000080">[</font>IHi<font color="#000080">]:=</font>YPr
           <font color="#FF0000"><b>end
        until </b></font><font color="#000080">(</font>false<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ifndef UnitMode}

</i></font><font color="#FF0000"><b>function  </b></font>TestEvaluation<font color="#000080">(</font>R<font color="#000080">: </font>ParameterVector<font color="#000080">;
                         </font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font>OpenString<font color="#000080">): </font>single<font color="#000080">;
</font><font color="#008000"><i>{Try to fit Y=A*Sqr(X)+B*X+C, where A=20, B=3, C=16, for -30&lt;=X&lt;=30}
</i></font><font color="#FF0000"><b>var   </b></font>N<font color="#000080">:     </font>integer<font color="#000080">;
      </font>Sigma<font color="#000080">: </font>single<font color="#000080">;
</font><font color="#FF0000"><b>begin
      </b></font>Write<font color="#000080">(</font><font color="#800000">'Evaluating A='</font><font color="#000080">,</font>R<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">', B='</font><font color="#000080">,</font>R<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">', C='</font><font color="#000080">,</font>R<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">);
      </font>Sigma<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>N<font color="#000080">:=-</font><font color="#800000">30 </font><font color="#FF0000"><b>to </b></font><font color="#800000">30 </font><font color="#FF0000"><b>do
         </b></font>Sigma<font color="#000080">:=</font>Sigma<font color="#000080">+</font>Sqr<font color="#000080">((</font>R<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]*</font>N<font color="#000080">*</font>N<font color="#000080">+</font>R<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]*</font>N<font color="#000080">+</font>R<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">])-(</font><font color="#800000">20</font><font color="#000080">*</font>N<font color="#000080">*</font>N<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">*</font>N<font color="#000080">+</font><font color="#800000">16</font><font color="#000080">));
      </font>WriteLn<font color="#000080">(</font><font color="#800000">' : '</font><font color="#000080">,</font>Sigma<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">);
      </font>TestEvaluation<font color="#000080">:=</font>Sigma
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TestAmoeba<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>Dimensions<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;
</font><font color="#FF0000"><b>var   </b></font>Simplex<font color="#000080">: </font>ParameterArray<font color="#000080">;
      </font>Iter<font color="#000080">:    </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>WriteLn<font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=-</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=-</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]:=-</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">3</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">5</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">6</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">;
     </font>Simplex<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">7</font><font color="#000080">;
     </font>Amoeba<font color="#000080">(</font>Simplex<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0.00001</font><font color="#000080">,</font>TestEvaluation<font color="#000080">,</font>Iter<font color="#000080">);
     </font>WriteLn<font color="#000080">(</font><font color="#800000">'Converged to A='</font><font color="#000080">,</font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">', B='</font><font color="#000080">,</font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,
             </font><font color="#800000">', C='</font><font color="#000080">,</font>Simplex<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]:</font><font color="#800000">6</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' after '</font><font color="#000080">,</font>Iter<font color="#000080">,</font><font color="#800000">' iterations'</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$endif}

</i></font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{$ifndef UnitMode}
     </i></font>TestAmoeba
<font color="#008000"><i>{$endif}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0093.PAS">Original</a><b>]</b></p></body>
</html>
