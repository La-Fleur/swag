<html>
<head><title> "Calculate a formula using recursion" by COLIN LAMARRE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0130.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$S-}
{$M 65520,0,655360}
{$N+}

{ Cal.pas by Colin Lamarre, 1991
  Email: lamarre@vir.com

  This program calculates a formula using recursion.

}

</i></font><font color="#FF0000"><b>const
  </b></font>digits <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>char <font color="#000080">= [</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'.'</font><font color="#000080">, </font><font color="#800000">'E'</font><font color="#000080">];

</font><font color="#FF0000"><b>var
  </b></font>answer <font color="#000080">: </font>extended<font color="#000080">;
  </font>rcal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>print <font color="#000080">: </font>boolean<font color="#000080">;
  </font>i <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>error<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>print <font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font>copy<font color="#000080">(</font>cal<font color="#000080">, </font>i <font color="#000080">- </font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">) + </font><font color="#800000">' error.'</font><font color="#000080">);
    </font>print <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>i <font color="#000080">:= </font>length<font color="#000080">(</font>cal<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>clean<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>toupper <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>l<font color="#000080">, </font>r <font color="#000080">: </font>integer<font color="#000080">;
  </font>t <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>print <font color="#000080">:= </font>true<font color="#000080">;
  </font>t <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>l <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>r <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>toupper<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>toupper<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
    begin
      </b></font>t <font color="#000080">:= </font>t <font color="#000080">+ </font>upcase<font color="#000080">(</font>toupper<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>if </b></font>toupper<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
        </b></font>l <font color="#000080">:= </font>l <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>toupper<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')' </font><font color="#FF0000"><b>then
        </b></font>r <font color="#000080">:= </font>r <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>r <font color="#000080">&lt;&gt; </font>l <font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Missing brackets'</font><font color="#000080">);
    </font>clean <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    if </b></font>t <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
      </b></font>toupper <font color="#000080">:= </font><font color="#800000">'0'
    </font><font color="#FF0000"><b>else
      </b></font>toupper <font color="#000080">:= </font>t<font color="#000080">;
    </font>clean <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fstr<font color="#000080">(</font>x <font color="#000080">: </font>extended<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>str<font color="#000080">(</font>x<font color="#000080">:</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">, </font>s<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">' ' </font><font color="#FF0000"><b>then
    </b></font>delete<font color="#000080">(</font>s<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>fstr <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fval<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>x <font color="#000080">: </font>extended<font color="#000080">;
  </font>code <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>val<font color="#000080">(</font>s<font color="#000080">, </font>x<font color="#000080">, </font>code<font color="#000080">);
  </font>fval <font color="#000080">:= </font>x<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>prevnum<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>oldi <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>oldi <font color="#000080">:= </font>i<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>temp<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>temp<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>temp<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]))) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&gt;= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>temp<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>i <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>temp<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'*'</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">])) </font><font color="#FF0000"><b>then
    </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
  </font>prevnum <font color="#000080">:= </font>fval<font color="#000080">(</font>copy<font color="#000080">(</font>temp<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>oldi <font color="#000080">- </font>i<font color="#000080">));
  </font>delete<font color="#000080">(</font>temp<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>oldi <font color="#000080">- </font>i<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>signs<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>sign <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>sign <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'-' </font><font color="#FF0000"><b>then
    begin
      </b></font>sign <font color="#000080">:= </font>sign <font color="#000080">* -</font><font color="#800000">1</font><font color="#000080">;
      </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else
    if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'+' </font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>until not</b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'+'</font><font color="#000080">]);
  </font>signs <font color="#000080">:= </font>sign<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>nextnum<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>sign <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>sign <font color="#000080">:= </font>signs<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>cal<font color="#000080">)) </font><font color="#FF0000"><b>do
  begin
    </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
      </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>nextnum <font color="#000080">:= </font>sign <font color="#000080">* </font>fval<font color="#000080">(</font>temp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>getbrackets<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>count <font color="#000080">: </font>integer<font color="#000080">;
  </font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
      </b></font>count <font color="#000080">:= </font>count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')' </font><font color="#FF0000"><b>then
      </b></font>count <font color="#000080">:= </font>count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
    </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>count <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
  </font>delete<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
  </font>inc<font color="#000080">(</font>i<font color="#000080">);
  </font>getbrackets <font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>doadd<font color="#000080">(</font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
  </font>tot <font color="#000080">: </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>tot <font color="#000080">:= </font>nextnum<font color="#000080">(</font>temp<font color="#000080">, </font>i<font color="#000080">);
  </font><font color="#FF0000"><b>repeat
    </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>case </b></font>temp<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'+' </font><font color="#000080">: </font>tot <font color="#000080">:= </font>tot <font color="#000080">+ </font>nextnum<font color="#000080">(</font>temp<font color="#000080">, </font>i<font color="#000080">);
      </font><font color="#800000">'-' </font><font color="#000080">: </font>tot <font color="#000080">:= </font>tot <font color="#000080">- </font>nextnum<font color="#000080">(</font>temp<font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">&gt; </font>length<font color="#000080">(</font>temp<font color="#000080">);
  </font>doadd <font color="#000080">:= </font>tot<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>domuls<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>extended<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>sign <font color="#000080">: </font>integer<font color="#000080">;
  </font>temp<font color="#000080">, </font>s <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    case </b></font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                   </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                   </font>inc<font color="#000080">(</font>i<font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'*' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
              </font>sign <font color="#000080">:= </font>signs<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits <font color="#FF0000"><b>then
              begin
                </b></font>s <font color="#000080">:= </font>fstr<font color="#000080">(</font>sign <font color="#000080">* </font>prevnum<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">)) * </font>nextnum<font color="#000080">(</font>cal<font color="#000080">,</font>i<font color="#000080">));
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>end
              else
              if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
              begin
                </b></font>s <font color="#000080">:= </font>fstr<font color="#000080">(</font>sign <font color="#000080">* </font>prevnum<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">)) * </font>domuls<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">)));
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'/' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
              </font>sign <font color="#000080">:= </font>signs<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits <font color="#FF0000"><b>then
              begin
                </b></font>s <font color="#000080">:= </font>fstr<font color="#000080">(</font>sign <font color="#000080">* </font>prevnum<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">)) / </font>nextnum<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">));
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>end
              else
              if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
              begin
                </b></font>s <font color="#000080">:= </font>fstr<font color="#000080">(</font>prevnum<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">)) / (</font>sign <font color="#000080">* </font>domuls<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))));
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>s<font color="#000080">;
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'.' </font><font color="#000080">: </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>cal<font color="#000080">)) </font><font color="#FF0000"><b>do
                      begin
                        </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                        </font>inc<font color="#000080">(</font>i<font color="#000080">);
                        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                        begin
                          </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                          </font>inc<font color="#000080">(</font>i<font color="#000080">);
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'(' </font><font color="#000080">: </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>domuls<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">)));

      </font><font color="#FF0000"><b>else
        </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">&gt; </font>length<font color="#000080">(</font>cal<font color="#000080">);
  </font>domuls <font color="#000080">:= </font>doadd<font color="#000080">(</font>temp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dopowers<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>c <font color="#000080">: </font>integer<font color="#000080">;
  </font>x<font color="#000080">, </font>f <font color="#000080">: </font>extended<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>fcnt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>j <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'!' </font><font color="#FF0000"><b>do
    begin
      </b></font>inc<font color="#000080">(</font>j<font color="#000080">);
      </font>dec<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font>delete<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">);
    </font>fcnt <font color="#000080">:= </font>j<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>fact<font color="#000080">(</font>x <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>k<font color="#000080">, </font>n <font color="#000080">: </font>word<font color="#000080">;
    </font>ans <font color="#000080">: </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>ans <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>x <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>fact <font color="#000080">:= </font>ans <font color="#000080">/ (</font>x <font color="#000080">- </font>x<font color="#000080">);
    </font>n <font color="#000080">:= </font>trunc<font color="#000080">(</font>x<font color="#000080">);
    </font><font color="#FF0000"><b>for </b></font>k <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>n <font color="#FF0000"><b>do
      </b></font>ans <font color="#000080">:= </font>k <font color="#000080">* </font>ans<font color="#000080">;
    </font>fact <font color="#000080">:= </font>ans<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>getprev<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>oldi<font color="#000080">, </font>count <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
    </font>oldi <font color="#000080">:= </font>i<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">')' </font><font color="#FF0000"><b>then
    begin
      while </b></font><font color="#000080">((</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">((</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]))) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&gt;= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>i <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">, </font><font color="#800000">'*'</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">])) </font><font color="#FF0000"><b>then
        </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
      </font>getprev <font color="#000080">:= </font>fval<font color="#000080">(</font>copy<font color="#000080">(</font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>oldi <font color="#000080">- </font>i<font color="#000080">));
      </font>delete<font color="#000080">(</font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>oldi <font color="#000080">- </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'('</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>count <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&gt;= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')' </font><font color="#FF0000"><b>then
          </b></font>count <font color="#000080">:= </font>count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
          </b></font>count <font color="#000080">:= </font>count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>getprev <font color="#000080">:= </font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>copy<font color="#000080">(</font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>oldi <font color="#000080">- </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)));
      </font>delete<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">, </font>oldi <font color="#000080">- </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
      </font>dec<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>getnext<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>i <font color="#000080">: </font>integer<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>oldi<font color="#000080">, </font>sign<font color="#000080">, </font>count <font color="#000080">: </font>integer<font color="#000080">;
    </font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>oldi <font color="#000080">:= </font>i<font color="#000080">;
    </font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>sign <font color="#000080">:= </font>signs<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
    begin
      while </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>cal<font color="#000080">)) </font><font color="#FF0000"><b>do
      begin
        </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
        begin
          </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
          </font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>getnext <font color="#000080">:= </font>sign <font color="#000080">* </font>fval<font color="#000080">(</font>temp<font color="#000080">);
      </font>delete<font color="#000080">(</font>cal<font color="#000080">, </font>oldi<font color="#000080">, </font>i <font color="#000080">- </font>oldi<font color="#000080">);
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>count <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'(' </font><font color="#FF0000"><b>then
          </b></font>count <font color="#000080">:= </font>count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')' </font><font color="#FF0000"><b>then
          </b></font>count <font color="#000080">:= </font>count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
        </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
      </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">')'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>count <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
      </font>delete<font color="#000080">(</font>temp<font color="#000080">, </font>length<font color="#000080">(</font>temp<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">);
      </font>getnext <font color="#000080">:= </font>sign <font color="#000080">* </font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>temp<font color="#000080">));
      </font>delete<font color="#000080">(</font>cal<font color="#000080">, </font>oldi<font color="#000080">, </font>i <font color="#000080">- </font>oldi <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>i <font color="#000080">:= </font>length<font color="#000080">(</font>cal<font color="#000080">);
  </font><font color="#FF0000"><b>repeat
    case </b></font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'^' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>x <font color="#000080">:= </font>getnext<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'!' </font><font color="#FF0000"><b>then
              begin
                </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
                </font>c <font color="#000080">:= </font>fcnt<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
                </font>f <font color="#000080">:= </font>getprev<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
                </font><font color="#FF0000"><b>for </b></font>c <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>c <font color="#FF0000"><b>do
                  </b></font>f <font color="#000080">:= </font>fact<font color="#000080">(</font>f<font color="#000080">);
                </font>insert<font color="#000080">(</font>fstr<font color="#000080">(</font>exp<font color="#000080">(</font>x <font color="#000080">* </font>ln<font color="#000080">(</font>f<font color="#000080">))), </font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
              </font><font color="#FF0000"><b>end
              else
                </b></font>insert<font color="#000080">(</font>fstr<font color="#000080">(</font>exp<font color="#000080">(</font>x <font color="#000080">* </font>ln<font color="#000080">(</font>getprev<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">)))), </font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'!' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              </b></font>c <font color="#000080">:= </font>fcnt<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
              </font>f <font color="#000080">:= </font>getprev<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
              </font><font color="#FF0000"><b>for </b></font>c <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>c <font color="#FF0000"><b>do
                </b></font>f <font color="#000080">:= </font>fact<font color="#000080">(</font>f<font color="#000080">);
              </font>insert<font color="#000080">(</font>fstr<font color="#000080">(</font>f<font color="#000080">), </font>cal<font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>else
        </b></font>dec<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">;
  </font>dopowers <font color="#000080">:= </font>cal<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dofuncs<font color="#000080">(</font>cal <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
  </font>temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>next3 <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>next3 <font color="#000080">:= </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] + </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] + </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>asin<font color="#000080">(</font>ratio <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>asin <font color="#000080">:= </font>arctan<font color="#000080">(</font>ratio <font color="#000080">/ </font>sqrt<font color="#000080">((</font><font color="#800000">1 </font><font color="#000080">- </font>ratio<font color="#000080">) * (</font><font color="#800000">1 </font><font color="#000080">+ </font>ratio<font color="#000080">)));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>acos<font color="#000080">(</font>ratio <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>acos <font color="#000080">:= </font>arctan<font color="#000080">(</font>sqrt<font color="#000080">((</font><font color="#800000">1 </font><font color="#000080">- </font>ratio<font color="#000080">) * (</font><font color="#800000">1 </font><font color="#000080">+ </font>ratio<font color="#000080">)) / </font>ratio<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>atan<font color="#000080">(</font>ratio <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>atan <font color="#000080">:= </font>arctan<font color="#000080">(</font>ratio<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>tan<font color="#000080">(</font>angle <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>tan <font color="#000080">:= </font>sin<font color="#000080">(</font>angle<font color="#000080">) / </font>cos<font color="#000080">(</font>angle<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>cot<font color="#000080">(</font>angle <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>cot <font color="#000080">:= </font>cos<font color="#000080">(</font>angle<font color="#000080">) / </font>sin<font color="#000080">(</font>angle<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>log<font color="#000080">(</font>x <font color="#000080">: </font>extended<font color="#000080">) : </font>extended<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>log <font color="#000080">:= </font>ln<font color="#000080">(</font>x<font color="#000080">) / </font><font color="#800000">2.302585093</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    case </b></font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">,
      </font><font color="#800000">'*'</font><font color="#000080">, </font><font color="#800000">'/'</font><font color="#000080">,
      </font><font color="#800000">'('</font><font color="#000080">, </font><font color="#800000">')'</font><font color="#000080">,
      </font><font color="#800000">'^'</font><font color="#000080">, </font><font color="#800000">'!' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                   </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                   </font>inc<font color="#000080">(</font>i<font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'S' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'IN(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>sin<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>next3 <font color="#000080">+ </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'QRT(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>sqrt<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'C' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'OS(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>cos<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'OT(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>cot<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'T' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'AN(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>tan<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'A' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              if </b></font>next3 <font color="#000080">+ </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'TAN(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>atan<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>next3 <font color="#000080">+ </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'COS(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>acos<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>next3 <font color="#000080">+ </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">] = </font><font color="#800000">'SIN(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>asin<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'BS(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>abs<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'L' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
              if </b></font>next3 <font color="#000080">= </font><font color="#800000">'OG(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>log<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
              if </b></font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] + </font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] = </font><font color="#800000">'N(' </font><font color="#FF0000"><b>then
              begin
                </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
                </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>ln<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
              </font><font color="#FF0000"><b>end
              else
                </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'E' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>next3 <font color="#000080">= </font><font color="#800000">'XP(' </font><font color="#FF0000"><b>then
            begin
              </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
              </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>exp<font color="#000080">(</font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>getbrackets<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">))))));
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#800000">'P' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>cal<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'I' </font><font color="#FF0000"><b>then
            begin
              </b></font>inc<font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
              </font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>fstr<font color="#000080">(</font>pi<font color="#000080">);
            </font><font color="#FF0000"><b>end
            else
              </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);

      </font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'.' </font><font color="#000080">: </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>digits<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>length<font color="#000080">(</font>cal<font color="#000080">)) </font><font color="#FF0000"><b>do
                      begin
                        </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                        </font>inc<font color="#000080">(</font>i<font color="#000080">);
                        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'E'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>cal<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'+'</font><font color="#000080">, </font><font color="#800000">'-'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                        begin
                          </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font>cal<font color="#000080">[</font>i<font color="#000080">];
                          </font>inc<font color="#000080">(</font>i<font color="#000080">);
                        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>else
        </b></font>error<font color="#000080">(</font>cal<font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>i <font color="#000080">&gt; </font>length<font color="#000080">(</font>cal<font color="#000080">);
  </font>dofuncs <font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>rcal <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>paramcount <font color="#FF0000"><b>do
    </b></font>rcal <font color="#000080">:= </font>rcal <font color="#000080">+ </font>paramstr<font color="#000080">(</font>i<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>clean<font color="#000080">(</font>rcal<font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>answer <font color="#000080">:= </font>domuls<font color="#000080">(</font>dopowers<font color="#000080">(</font>dofuncs<font color="#000080">(</font>rcal<font color="#000080">)));
    </font><font color="#FF0000"><b>if </b></font>print <font color="#FF0000"><b>then
      </b></font>writeln<font color="#000080">(</font>answer<font color="#000080">:</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0130.PAS">Original</a><b>]</b></p></body>
</html>
