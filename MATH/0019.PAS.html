<html>
<head><title> "PRIMES3.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  Hi, to All:

   ...While recently &quot;tuning up&quot; one of my Programs I'm currently
   working on, I ran a little test to Compare the perfomance
   of the different versions of Turbo Pascal from 5.0 through
   to 7.0. The results were quite suprizing, and I thought I'd
   share this With you guys/gals.

   Here are the results of a &quot;sieve&quot; Program to find all the primes
   in 1 - 100,000, running on my AMI 386SX-25 CPU desktop PC:

      CompILER    EXECUTION TIME    RELATIVE TIME FACtoR
      ==================================================
       TP 7.0        46.7 sec              1.00
       TP 6.0       137.8 sec              2.95
       TP 5.5       137.5 sec              2.94
       TP 5.0       137.6 sec              2.95

   Running the same Program to find all the primes in 1 - 10,000,
   running on my 8086 - 9.54 Mhz NEC V20 CPU laptop PC:

      CompILER    EXECUTION TIME    RELATIVE TIME FACtoR
      ==================================================
       TP 7.0        14.1 sec              1.00
       TP 6.0        28.3 sec              2.00

  notE: This would seem to indicate that the TP 7.0 386 math-
        library is kicking in when run on a 386 CPU.

  Here is the source-code to my &quot;seive&quot; Program:
------------------------------------------------------------------------
}
 {.$DEFinE DebugMode}
 {$DEFinE SaveData}

 {$ifDEF DebugMode}
   {$ifDEF VER70}
     {$ifDEF DPMI}
       {$A+,B-,D+,E-,F-,G-,I+,L+,N-,P+,Q+,R+,S+,T+,V+,X-}
     {$else}
       {$A+,B-,D+,E-,F-,G-,I+,L+,N-,O-,P+,Q+,R+,S+,T+,V+,X-}
     {$endif}
   {$else}
     {$ifDEF VER60}
       {$A+,B-,D+,E-,F-,G-,I+,L+,N-,O-,R+,S+,V+,X-}
     {$else}
       {$A+,B-,D+,E-,F-,I+,L+,N-,O-,R+,S+,V+}
     {$endif}
   {$endif}
 {$else}
   {$ifDEF VER70}
     {$ifDEF DPMI}
       {$A+,B-,D-,E-,F-,G-,I-,L-,N-,P-,Q-,R-,S+,T-,V-,X-}
     {$else}
       {$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S+,T-,V-,X-}
     {$endif}
   {$else}
     {$ifDEF VER60}
       {$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,R-,S+,V-,X-}
     {$else}
       {$A+,B-,D-,E-,F-,I-,L-,N-,O-,R-,S+,V-}
     {$endif}
   {$endif}
 {$endif}

              (* Find prime numbers - Guy McLoughlin, 1993.           *)
</i></font><font color="#FF0000"><b>Program </b></font>Find_Primes<font color="#000080">;

  </font><font color="#008000"><i>(***** Check if a number is prime.                                  *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Function </b></font>Prime<font color="#000080">(</font><font color="#008000"><i>{input } </i></font>lo_in <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#008000"><i>{output} </i></font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>lo_Stop<font color="#000080">,
    </font>lo_Loop <font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>lo_in <font color="#FF0000"><b>mod </b></font><font color="#800000">2 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Prime <font color="#000080">:= (</font>lo_in <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">);
        </font>Exit
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_in <font color="#FF0000"><b>mod </b></font><font color="#800000">3 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Prime <font color="#000080">:= (</font>lo_in <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">);
        </font>Exit
      <font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_in <font color="#FF0000"><b>mod </b></font><font color="#800000">5 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Prime <font color="#000080">:= (</font>lo_in <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">);
        </font>Exit
      <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>lo_Stop <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>lo_Stop <font color="#000080">* </font>lo_Stop<font color="#000080">) &lt;= </font>lo_in<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>lo_Stop<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
    </font>lo_Loop <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>lo_Loop <font color="#000080">&lt; </font>lo_Stop<font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>inc<font color="#000080">(</font>lo_Loop<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>lo_in <font color="#FF0000"><b>mod </b></font>lo_Loop <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            </b></font>Prime <font color="#000080">:= </font>False<font color="#000080">;
            </font>Exit
          <font color="#FF0000"><b>end
      end</b></font><font color="#000080">;
    </font>Prime <font color="#000080">:= </font>True
  <font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Prime.                                               *)

  (***** Check For File IO errors.                                    *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Procedure </b></font>CheckIOerror<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>by_Error <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>by_Error <font color="#000080">:= </font>ioresult<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>by_Error <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'File Error = '</font><font color="#000080">, </font>by_Error<font color="#000080">);
        </font>halt
      <font color="#FF0000"><b>end
  end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* CheckIOerror.                                        *)

</i></font><font color="#FF0000"><b>Var
  </b></font>bo_Temp       <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>wo_PrimeCount <font color="#000080">: </font>Word<font color="#000080">;
  </font>lo_Temp<font color="#000080">,
  </font>lo_Loop       <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>fite_Data     <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>lo_Temp <font color="#000080">:= </font><font color="#800000">100000</font><font color="#000080">;
  </font><font color="#008000"><i>{$ifDEF SaveData}
    {$ifDEF VER50}
      </i></font>assign<font color="#000080">(</font>fite_Data<font color="#000080">, </font><font color="#800000">'PRIME.50'</font><font color="#000080">);
    </font><font color="#008000"><i>{$endif}
    {$ifDEF VER55}
      </i></font>assign<font color="#000080">(</font>fite_Data<font color="#000080">, </font><font color="#800000">'PRIME.55'</font><font color="#000080">);
    </font><font color="#008000"><i>{$endif}
    {$ifDEF VER60}
      </i></font>assign<font color="#000080">(</font>fite_Data<font color="#000080">, </font><font color="#800000">'PRIME.60'</font><font color="#000080">);
    </font><font color="#008000"><i>{$endif}
    {$ifDEF VER70}
      </i></font>assign<font color="#000080">(</font>fite_Data<font color="#000080">, </font><font color="#800000">'PRIME.70'</font><font color="#000080">);
    </font><font color="#008000"><i>{$endif}
    {$I-}
    </i></font>reWrite<font color="#000080">(</font>fite_Data<font color="#000080">);
    </font><font color="#008000"><i>{$I+}
    </i></font>CheckIOerror<font color="#000080">;
    </font><font color="#008000"><i>{$endif}
  </i></font>wo_PrimeCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>lo_Loop <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>lo_Temp <font color="#FF0000"><b>do
    if </b></font>Prime<font color="#000080">(</font>lo_Loop<font color="#000080">) </font><font color="#FF0000"><b>then
  </b></font><font color="#008000"><i>{$ifDEF SaveData}
      </i></font><font color="#FF0000"><b>begin
        </b></font>Write<font color="#000080">(</font>fite_Data<font color="#000080">, </font>lo_Loop<font color="#000080">:</font><font color="#800000">6</font><font color="#000080">);
        </font>Write<font color="#000080">(</font>fite_Data<font color="#000080">, </font><font color="#800000">', '</font><font color="#000080">);
        </font>inc<font color="#000080">(</font>wo_PrimeCount<font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>wo_PrimeCount <font color="#FF0000"><b>mod </b></font><font color="#800000">10</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>Writeln<font color="#000080">(</font>fite_Data<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>close<font color="#000080">(</font>fite_Data<font color="#000080">);
    </font>CheckIOerror<font color="#000080">;
  </font><font color="#008000"><i>{$else}
      </i></font>inc<font color="#000080">(</font>wo_PrimeCount<font color="#000080">);
  </font><font color="#008000"><i>{$endif}
    </i></font>Writeln<font color="#000080">(</font>wo_PrimeCount<font color="#000080">, </font><font color="#800000">' primes between: 1 - '</font><font color="#000080">, </font>lo_Temp<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
   ...This little test would put TP 7.0's .EXE's between 2 to 3
   times faster than TP4 - TP6 .EXE's. (I've found simmilar results
   in testing other Programs I've written.) I guess this is one more
   reason to upgrade to TP 7.0 .

   ...I'd be curious to see how StonyBrook's Pascal+ 6.1 Compares
   to TP 7.0, in terms of execution speed With this Program.

                               - Guy
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0019.PAS">Original</a><b>]</b></p></body>
</html>
