<html>
<head><title> "Random Gaussian Variables" by RANDALL ELTON DING</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
From: randyd@alpha2.csd.uwm.edu (Randall Elton Ding)

&gt;I a program I'm currently struggeling with, I need to get a random number
&gt;from a Gaussian distribution. Anybody got any ideas or anybody able to point
&gt;to something which does the job.

This does a pretty good job of generating a gaussian random variable
with mean `a` and standard deviation `d`.
This program also does a graphic plot to demonstrate the function.

First, here is the origional C source if the gaussian function
which I transcribed to beloved pascal..

/* ------------------------------------------------ *
 * gaussian -- generates a gaussian random variable *
 *             with mean a and standard deviation d *
 * ------------------------------------------------ */
 double gaussian(a,d)
 double a,d;
 {
   static double t = 0.0;
   double x,v1,v2,r;
   if (t == 0) {
     do {
       v1 = 2.0 * rnd() - 1.0;
       v2 = 2.0 * rnd() - 1.0;
       r = v1 * v1 + v2 * v2;
     } while (r&gt;=1.0);
     r = sqrt((-2.0*log(r))/r);
     t = v2*r;
     return(a+v1*r*d);
   }
   else {
     x = t;
     t = 0.0;
     return(a+x*d);
   }
 }


* ----------------------------------------------------------------------
* now, the same thing in pascal
* ----------------------------------------------------------------------
*)

{$N+}
</i></font><font color="#FF0000"><b>program </b></font>testgaussian<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>graph<font color="#000080">,</font>crt<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>bgipath <font color="#000080">= </font><font color="#800000">'e:\bp\bgi'</font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initbgi<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>errcode<font color="#000080">,</font>grdriver<font color="#000080">,</font>grmode<font color="#000080">: </font>integer<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>grdriver<font color="#000080">:= </font>detect<font color="#000080">;
    </font>grmode<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>initgraph <font color="#000080">(</font>grdriver<font color="#000080">,</font>grmode<font color="#000080">,</font>bgipath<font color="#000080">);
    </font>errcode<font color="#000080">:= </font>graphresult<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>errcode <font color="#000080">&lt;&gt; </font>grok <font color="#FF0000"><b>then begin
      </b></font>writeln <font color="#000080">(</font><font color="#800000">'Graphics error: '</font><font color="#000080">,</font>grapherrormsg <font color="#000080">(</font>errcode<font color="#000080">));
      </font>halt <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>rnd<font color="#000080">: </font>double<font color="#000080">;   </font><font color="#008000"><i>{ this isn't the best, but it works }
  </i></font><font color="#FF0000"><b>var                   </b></font><font color="#008000"><i>{ returns a random number between 0 and 1 }
    </i></font>i<font color="#000080">: </font>integer<font color="#000080">;
    </font>r<font color="#000080">: </font>double<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>r<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do begin
      </b></font>r<font color="#000080">:= </font>r <font color="#000080">+ </font>random<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
      </font>r<font color="#000080">:= </font>r<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>rnd<font color="#000080">:= </font>r<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>function </b></font>gaussian<font color="#000080">(</font>a<font color="#000080">,</font>d<font color="#000080">: </font>double<font color="#000080">): </font>double<font color="#000080">;      </font><font color="#008000"><i>{ a is mean }
  </i></font><font color="#FF0000"><b>const                                      </b></font><font color="#008000"><i>{ d is standard deviation }
    </i></font>t<font color="#000080">: </font>double <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;   </font><font color="#008000"><i>{ pascal's equivalent to C's static variable }

  </i></font><font color="#FF0000"><b>var
    </b></font>x<font color="#000080">,</font>v1<font color="#000080">,</font>v2<font color="#000080">,</font>r<font color="#000080">: </font>double<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    if </b></font>t<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      repeat
        </b></font>v1<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font>rnd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>v2<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">*</font>rnd<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
        </font>r<font color="#000080">:= </font>v1<font color="#000080">*</font>v1<font color="#000080">+</font>v2<font color="#000080">*</font>v2
      <font color="#FF0000"><b>until </b></font>r<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">;
      </font>r<font color="#000080">:= </font>sqrt<font color="#000080">((-</font><font color="#800000">2</font><font color="#000080">*</font>ln<font color="#000080">(</font>r<font color="#000080">))/</font>r<font color="#000080">);
      </font>t<font color="#000080">:= </font>v2<font color="#000080">*</font>r<font color="#000080">;
      </font>gaussian<font color="#000080">:= </font>a<font color="#000080">+</font>v1<font color="#000080">*</font>r<font color="#000080">*</font>d<font color="#000080">;
    </font><font color="#FF0000"><b>end
    else begin
      </b></font>x<font color="#000080">:= </font>t<font color="#000080">;
      </font>t<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>gaussian<font color="#000080">:= </font>a<font color="#000080">+</font>x<font color="#000080">*</font>d<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>testplot<font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>x<font color="#000080">,</font>mx<font color="#000080">,</font>my<font color="#000080">,</font>y1<font color="#000080">: </font>word<font color="#000080">;
    </font>y<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
              </font><font color="#008000"><i>{ ^^^ make this bigger if you have incredible graphics }
  </i></font><font color="#FF0000"><b>begin
    </b></font>initbgi<font color="#000080">;
    </font>mx<font color="#000080">:= </font>getmaxx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font>my<font color="#000080">:= </font>getmaxy<font color="#000080">;
    </font>fillchar<font color="#000080">(</font>y<font color="#000080">,</font>sizeof<font color="#000080">(</font>y<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
    </font><font color="#FF0000"><b>repeat
      </b></font>x<font color="#000080">:= </font>trunc<font color="#000080">(</font>gaussian<font color="#000080">(</font>mx<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">));
      </font>y1<font color="#000080">:= </font>y<font color="#000080">[</font>x<font color="#000080">];
      </font>putpixel<font color="#000080">(</font>x<font color="#000080">,</font>my<font color="#000080">-</font>y1<font color="#000080">,</font>white<font color="#000080">);
      </font>y<font color="#000080">[</font>x<font color="#000080">]:= </font>y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
    </font>closegraph<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>begin
  </b></font>randomize<font color="#000080">;
  </font>testplot<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p></body>
</html>
