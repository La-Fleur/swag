<html>
<head><title> "Euler's Indice to Prime Numbers" by DANIEL DOUBROVKINE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
                Daniel Doubrovkine - dblock@infomaniak.ch
   part of the Expression Calculator 2.0 Multithread, destribute freely
              http://www.infomaniak.ch/~dblock/express.htm
    (ref. Haussman, Simple Algebra course at the University of Geneva)

                            &quot;Euler's Indice&quot;
       euler's indice is a insomorphe function phi: Zm-&gt;Z1*Z2...Zn
    means the decomposition of a number into a primes product is unique
    with phi(n):=n*(1-1/p1)*...*(1-1/pn) where pi are primes taken once
    from the decomposition.
    ex: (following algorith steps):
       168=2*84
       168=2*2*42
       168=2*2*2*21
       168=2*2*2*3*7 where all are primes!
  now, phi(168)=168*(1-1/2)(1-1/3)(1-1/7)=48 (this is always an integer!)
       thus, 168 has 48 primes to it.
*)

(*defining a dynamic primes array, so this function will never be limited*)
</i></font><font color="#FF0000"><b>type
   </b></font>PPrimesArray<font color="#000080">=^</font>TPrimesArray<font color="#000080">;
   </font>TPrimesArray<font color="#000080">=</font><font color="#FF0000"><b>record
      </b></font>Prime<font color="#000080">:</font>longint<font color="#000080">;
      </font>NextPrime<font color="#000080">:</font>PPrimesArray<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font><font color="#008000"><i>(*adding a prime to the array*)
   </i></font><font color="#FF0000"><b>procedure </b></font>PrimesAdd<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AllPrimes<font color="#000080">: </font>PPrimesArray<font color="#000080">;</font>Prime<font color="#000080">:</font>longint<font color="#000080">);
   </font><font color="#FF0000"><b>var
      </b></font>TempPrimes<font color="#000080">:</font>PPrimesArray<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      </b></font>TempPrimes<font color="#000080">:=</font>AllPrimes<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>TempPrimes<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do begin
         if </b></font>TempPrimes<font color="#000080">^.</font>Prime<font color="#000080">=</font>Prime <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
         </font>TempPrimes<font color="#000080">:=</font>TempPrimes<font color="#000080">^.</font>NextPrime<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>new<font color="#000080">(</font>TempPrimes<font color="#000080">);
      </font>TempPrimes<font color="#000080">^.</font>Prime<font color="#000080">:=</font>Prime<font color="#000080">;
      </font>TempPrimes<font color="#000080">^.</font>NextPrime<font color="#000080">:=</font>AllPrimes<font color="#000080">;
      </font>AllPrimes<font color="#000080">:=</font>TempPrimes<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>(*removing the primes array*)
   </i></font><font color="#FF0000"><b>procedure </b></font>PrimesRemove<font color="#000080">(</font>AllPrimes<font color="#000080">: </font>PPrimesArray<font color="#000080">);
   </font><font color="#FF0000"><b>var
      </b></font>TempPrimes<font color="#000080">:</font>PPrimesArray<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      while </b></font>AllPrimes<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do begin
         </b></font>TempPrimes<font color="#000080">:=</font>AllPrimes<font color="#000080">;
         </font>AllPrimes<font color="#000080">:=</font>AllPrimes<font color="#000080">^.</font>NextPrime<font color="#000080">;
         </font>Dispose<font color="#000080">(</font>TempPrimes<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>(*by the way, this routine uses some code from swag*)
   </i></font><font color="#FF0000"><b>function </b></font>GeneratePrimes<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AllPrimes<font color="#000080">: </font>PPrimesArray<font color="#000080">;</font>n<font color="#000080">: </font>longint<font color="#000080">):</font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>CalculateTPrime<font color="#000080">(</font>n<font color="#000080">: </font>longint<font color="#000080">);
    </font><font color="#FF0000"><b>var
      </b></font>TempPrime<font color="#000080">: </font>PPrimesArray<font color="#000080">;
      </font>CurrentPrime<font color="#000080">: </font>LongInt<font color="#000080">;
      </font>prime<font color="#000080">:</font>boolean<font color="#000080">;
      </font>number<font color="#000080">,</font>max_div<font color="#000080">,</font>divisor<font color="#000080">,</font>lastprime<font color="#000080">:</font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>CurrentPrime<font color="#000080">:=</font>AllPrimes<font color="#000080">^.</font>Prime<font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>number<font color="#000080">:=</font>CurrentPrime <font color="#FF0000"><b>to </b></font>MaxLongInt <font color="#FF0000"><b>do begin
         </b></font>max_div<font color="#000080">:=</font>Round<font color="#000080">(</font>Sqrt<font color="#000080">(</font>number<font color="#000080">)+</font><font color="#800000">0.5</font><font color="#000080">);
         </font>prime<font color="#000080">:=</font>number <font color="#FF0000"><b>mod </b></font><font color="#800000">2 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
         </font>divisor<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
         </font><font color="#FF0000"><b>while </b></font>prime <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>divisor<font color="#000080">&lt;</font>max_div<font color="#000080">) </font><font color="#FF0000"><b>do begin
               </b></font>prime<font color="#000080">:=</font>number <font color="#FF0000"><b>mod </b></font>divisor <font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
               </font>divisor<font color="#000080">:=</font>divisor<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>prime <font color="#FF0000"><b>then begin
         if </b></font>AllPrimes<font color="#000080">^.</font>Prime<font color="#000080">&lt;</font>CurrentPrime <font color="#FF0000"><b>then </b></font>PrimesAdd<font color="#000080">(</font>AllPrimes<font color="#000080">,</font>CurrentPrime<font color="#000080">);
            </font>CurrentPrime<font color="#000080">:=</font>number<font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font>n<font color="#000080">&lt;</font>CurrentPrime <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>var
      </b></font>TempPrime<font color="#000080">: </font>PPrimesArray<font color="#000080">;
      </font>CurrentPrime<font color="#000080">: </font>LongInt<font color="#000080">;
      </font>prime<font color="#000080">:</font>boolean<font color="#000080">;
      </font>number<font color="#000080">,</font>max_div<font color="#000080">,</font>divisor<font color="#000080">,</font>lastprime<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>begin
     </b></font>PrimesAdd<font color="#000080">(</font>AllPrimes<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>PrimesAdd<font color="#000080">(</font>AllPrimes<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n<font color="#000080">&gt;-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>n<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>writeln<font color="#000080">(</font><font color="#800000">'Prime requires values |x|&gt;1'</font><font color="#000080">);
         </font>halt<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>n<font color="#000080">&gt;</font>maxlongint <font color="#FF0000"><b>then begin
         </b></font>writeln<font color="#000080">(</font><font color="#800000">'prime limit too large'</font><font color="#000080">);
         </font>halt<font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>n<font color="#000080">:=</font>abs<font color="#000080">(</font>n<font color="#000080">);

      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>n<font color="#000080">&lt;=</font>AllPrimes<font color="#000080">^.</font>Prime<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>TempPrime<font color="#000080">:=</font>AllPrimes<font color="#000080">;
         </font><font color="#FF0000"><b>while </b></font>TempPrime<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do begin
               </b></font>CurrentPrime<font color="#000080">:=</font>TempPrime<font color="#000080">^.</font>Prime<font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>n<font color="#000080">&gt;=</font>TempPrime<font color="#000080">^.</font>Prime <font color="#FF0000"><b>then begin
                  </b></font>GeneratePrimes<font color="#000080">:=</font>TempPrime<font color="#000080">^.</font>Prime<font color="#000080">;
                  </font>exit<font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font>TempPrime<font color="#000080">:=</font>TempPrime<font color="#000080">^.</font>NextPrime<font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>CalculateTPrime<font color="#000080">(</font>n<font color="#000080">);
      </font>GeneratePrimes<font color="#000080">:=</font>AllPrimes<font color="#000080">^.</font>Prime<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>phi<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AllPrimes<font color="#000080">:</font>PPrimesArray<font color="#000080">;</font>Value<font color="#000080">:</font>longint<font color="#000080">):</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>UsedPrimes<font color="#000080">:</font>PPrimesArray<font color="#000080">;
   </font><font color="#008000"><i>(*this is partailly from swag...*)
   </i></font><font color="#FF0000"><b>procedure </b></font>Factoring<font color="#000080">(</font>lin<font color="#000080">:</font>longint<font color="#000080">);
   </font><font color="#FF0000"><b>var
      </b></font>lcnt<font color="#000080">:</font>longint<font color="#000080">;
   </font><font color="#FF0000"><b>begin
      </b></font>lcnt<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>GeneratePrimes<font color="#000080">(</font>AllPrimes<font color="#000080">,</font>lin<font color="#000080">)=</font>lin <font color="#FF0000"><b>then begin
         </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>lin<font color="#000080">);
         </font>PrimesAdd<font color="#000080">(</font>UsedPrimes<font color="#000080">,</font>lin<font color="#000080">);
         </font><font color="#FF0000"><b>end else
         while</b></font><font color="#000080">(</font>lcnt<font color="#000080">*</font>lcnt<font color="#000080">&lt;=</font>lin<font color="#000080">) </font><font color="#FF0000"><b>do begin
            if </b></font><font color="#000080">(</font>lin <font color="#FF0000"><b>mod </b></font>lcnt<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
               if </b></font>GeneratePrimes<font color="#000080">(</font>AllPrimes<font color="#000080">,</font>lcnt<font color="#000080">)&lt;&gt;</font>lcnt <font color="#FF0000"><b>then </b></font>factoring<font color="#000080">(</font>lcnt<font color="#000080">)
                  </font><font color="#FF0000"><b>else begin
                     </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>lcnt<font color="#000080">);
                     </font>primesadd<font color="#000080">(</font>UsedPrimes<font color="#000080">,</font>lcnt<font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>GeneratePrimes<font color="#000080">(</font>AllPrimes<font color="#000080">,</font>lin <font color="#FF0000"><b>div </b></font>lcnt<font color="#000080">)&lt;&gt;(</font>lin <font color="#FF0000"><b>div </b></font>lcnt<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>factoring<font color="#000080">(</font>lin <font color="#FF0000"><b>div </b></font>lcnt<font color="#000080">)
                  </font><font color="#FF0000"><b>else begin
                     </b></font>write<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">,</font>lin <font color="#FF0000"><b>div </b></font>lcnt<font color="#000080">);
                     </font>primesadd<font color="#000080">(</font>UsedPrimes<font color="#000080">,</font>lin <font color="#FF0000"><b>div </b></font>lcnt<font color="#000080">);
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font>exit<font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>lcnt<font color="#000080">:=</font>lcnt<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>var
      </b></font>FinalResult<font color="#000080">:</font>real<font color="#000080">;
      </font>TempPrimes<font color="#000080">:</font>PPrimesArray<font color="#000080">;
   </font><font color="#FF0000"><b>begin
     if </b></font>Value<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font>Phi<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>Value<font color="#000080">:=</font>Abs<font color="#000080">(</font>Value<font color="#000080">);
     </font>FinalResult<font color="#000080">:=</font>Value<font color="#000080">;
     </font>UsedPrimes<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
     </font>write<font color="#000080">(</font><font color="#800000">'Decomposition of '</font><font color="#000080">,</font>Value<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">);
     </font>Factoring<font color="#000080">(</font>Value<font color="#000080">);
     </font>writeln<font color="#000080">;
     </font>TempPrimes<font color="#000080">:=</font>UsedPrimes<font color="#000080">;
     </font><font color="#FF0000"><b>while </b></font>TempPrimes<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>nil do begin
        </b></font>FinalResult<font color="#000080">:=</font>FinalResult<font color="#000080">*(</font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">/</font>TempPrimes<font color="#000080">^.</font>Prime<font color="#000080">);
        </font>TempPrimes<font color="#000080">:=</font>TempPrimes<font color="#000080">^.</font>NextPrime<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>phi<font color="#000080">:=</font>trunc<font color="#000080">(</font>FinalResult<font color="#000080">);
     </font>PrimesRemove<font color="#000080">(</font>UsedPrimes<font color="#000080">);
     </font>writeln<font color="#000080">(</font><font color="#800000">'Euler''s indice for '</font><font color="#000080">,</font>Value<font color="#000080">:</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">' is '</font><font color="#000080">,</font>trunc<font color="#000080">(</font>FinalResult<font color="#000080">));
     </font>writeln<font color="#000080">(</font><font color="#800000">'(there are '</font><font color="#000080">,</font>trunc<font color="#000080">(</font>FinalResult<font color="#000080">),</font><font color="#800000">' primes to '</font><font color="#000080">,</font>Value<font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>AllPrimes<font color="#000080">: </font>PPrimesArray<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Phi<font color="#000080">(</font>AllPrimes<font color="#000080">,</font><font color="#800000">168</font><font color="#000080">);
     </font>PrimesRemove<font color="#000080">(</font>AllPrimes<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0114.PAS">Original</a><b>]</b></p></body>
</html>
