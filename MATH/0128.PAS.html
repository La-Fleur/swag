<html>
<head><title> "Complex Number Component" by EARL F. GLYNN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0128.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$N+,E+} {Use math coprocessor, if any, emulate otherwise.}
</i></font><font color="#FF0000"><b>UNIT </b></font>ComplexOps<font color="#000080">;  </font><font color="#008000"><i>{ see demo at end }

 {This UNIT provides complex arithmetic and transcendental functions.

  (C) Copyright 1990, 1992, Earl F. Glynn, Overland Park, KS.  Compuserve 73257,3527.
  All rights reserved.  This program may be freely distributed only for
  non-commercial use.

  Some ideas in this UNIT were borrowed from &quot;A Pascal Tool for Complex
  Numbers&quot;, Journal of Pascal, Ada, &amp; Modula-2, May/June 1985, pp. 23-29.
  Many complex formulas were taken from Chapter 4, &quot;Handbook of Mathematical
  Functions&quot; (Ninth Printing), Abramowitz and Stegun (editors), Dover, 1972.}

</i></font><font color="#FF0000"><b>INTERFACE

  TYPE
    </b></font>RealType    <font color="#000080">= </font>DOUBLE<font color="#000080">;
    </font>ComplexForm <font color="#000080">= (</font>polar<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>Complex <font color="#000080">=
      </font><font color="#FF0000"><b>RECORD
        CASE </b></font>form<font color="#000080">:  </font>ComplexForm <font color="#FF0000"><b>OF
          </b></font>rectangular<font color="#000080">:  (</font>x<font color="#000080">,</font>y    <font color="#000080">:  </font>RealType<font color="#000080">);  </font><font color="#008000"><i>{z = x + y*i}
          </i></font>polar      <font color="#000080">:  (</font>r<font color="#000080">,</font>theta<font color="#000080">:  </font>RealType<font color="#000080">);  </font><font color="#008000"><i>{z = r*CIS(theta)}
      </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                 </font><font color="#008000"><i>{where CIS(theta) = COS(theta) + SIN(theta)*i}
                           {      theta = -PI..PI (in canonical form)}

  </i></font><font color="#FF0000"><b>CONST
    </b></font>MaxTerm    <font color="#000080">: </font>BYTE     <font color="#000080">= </font><font color="#800000">35</font><font color="#000080">;
    </font>EpsilonSqr <font color="#000080">: </font>RealType <font color="#000080">= </font><font color="#800000">1.0E</font><font color="#000080">-</font><font color="#800000">20</font><font color="#000080">;
    </font>Infinity   <font color="#000080">: </font>RealType <font color="#000080">= </font><font color="#800000">1.0E25</font><font color="#000080">;    </font><font color="#008000"><i>{virtual infinity}

                             {complex number definition/conversion/output}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CConvert <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">);
  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSet <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>RealType<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">);
  </font><font color="#FF0000"><b>FUNCTION  </b></font>CStr <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>w<font color="#000080">,</font>d<font color="#000080">:  </font>BYTE<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">):  </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;

                             </font><font color="#008000"><i>{complex arithmetic}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CAdd  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a + b}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CDiv  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a / b}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CMult <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a * b}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSub  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a - b}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CNeg  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a  <font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = -a   }

                             {complex natural log, exponential}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CLn   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>fn <font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);   </font><font color="#008000"><i>{fn  = ln(z) }
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CExp  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z  <font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);   </font><font color="#008000"><i>{z   = exp(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CPwr  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z  <font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">); </font><font color="#008000"><i>{z   = a^b   }

                             {complex trig functions}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCos  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cos(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSin  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sin(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CTan  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = tan(a)}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSec  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sec(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCsc  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = csc(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCot  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cot(a)}

                             {complex hyperbolic functions}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCosh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cosh(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSinh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sinh(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CTanh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = tanh(a)}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSech <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sech(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCsch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = csch(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCoth <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = coth(a)}

                             {miscellaneous complex functions}
  </i></font><font color="#FF0000"><b>FUNCTION  </b></font>CAbs <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">):  </font>RealType<font color="#000080">;                 </font><font color="#008000"><i>{CAbs = |z|}
  </i></font><font color="#FF0000"><b>FUNCTION  </b></font>CAbsSqr <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">):  </font>RealType<font color="#000080">;           </font><font color="#008000"><i>{CAbsSqr = |z|^2}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CIntPwr <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>n<font color="#000080">:  </font>INTEGER<font color="#000080">); </font><font color="#008000"><i>{z = a^n}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CRealPwr <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>x<font color="#000080">:  </font>RealType<font color="#000080">); </font><font color="#008000"><i>{z = a^x}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CConjugate <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);        </font><font color="#008000"><i>{z = a*}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CSqrt <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);      </font><font color="#008000"><i>{z = SQRT(a)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CRoot <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>k<font color="#000080">,</font>n<font color="#000080">:  </font>WORD<font color="#000080">); </font><font color="#008000"><i>{z = a^(1/n)}

                             {complex Bessel functions of order zero}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CI0   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>sum<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);  </font><font color="#008000"><i>{sum = I0(z)}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CJ0   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>sum<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);  </font><font color="#008000"><i>{sum = J0(z)}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CLnGamma <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);
  </font><font color="#FF0000"><b>PROCEDURE </b></font>CGamma   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);

                                  </font><font color="#008000"><i>{treat &quot;fuzz&quot; of real numbers}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CDeFuzz <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">);
  </font><font color="#FF0000"><b>FUNCTION  </b></font>DeFuzz <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>PROCEDURE </b></font>SetFuzz <font color="#000080">(</font>value<font color="#000080">:  </font>RealType<font color="#000080">);

                                  </font><font color="#008000"><i>{miscellaneous}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>FixAngle <font color="#000080">(</font>theta<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;    </font><font color="#008000"><i>{-PI &lt; theta &lt;= PI}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>Pwr <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;    </font><font color="#008000"><i>{Pwr = x^y}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>Log10 <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>FUNCTION </b></font>LongMod <font color="#000080">(</font>l1<font color="#000080">,</font>l2<font color="#000080">:  </font>LongInt<font color="#000080">):  </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>FUNCTION </b></font>Cosh <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>FUNCTION </b></font>Sinh <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

  VAR
    </b></font>fuzz     <font color="#000080">:  </font>RealType<font color="#000080">;
    </font>Cone     <font color="#000080">:  </font>Complex<font color="#000080">;
    </font>Cinfinity<font color="#000080">:  </font>Complex<font color="#000080">;
    </font>Czero    <font color="#000080">:  </font>Complex<font color="#000080">;
    </font>hLnPI    <font color="#000080">:  </font>RealType<font color="#000080">;
    </font>hLn2PI   <font color="#000080">:  </font>RealType<font color="#000080">;
    </font>ln2      <font color="#000080">:  </font>RealType<font color="#000080">;

                             </font><font color="#008000"><i>{complex number definition/conversion/output}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CConvert <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">);
    </font><font color="#FF0000"><b>VAR </b></font>a<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF   </b></font>z<font color="#000080">.</font>form <font color="#000080">= </font>f
    <font color="#FF0000"><b>THEN </b></font>CDeFuzz <font color="#000080">(</font>z<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE BEGIN
      CASE </b></font>z<font color="#000080">.</font>form <font color="#FF0000"><b>OF
        </b></font>polar<font color="#000080">:            </font><font color="#008000"><i>{polar-to-rectangular conversion}
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>a<font color="#000080">.</font>form <font color="#000080">:= </font>rectangular<font color="#000080">;
            </font>a<font color="#000080">.</font>x <font color="#000080">:= </font>z<font color="#000080">.</font>r <font color="#000080">* </font>COS<font color="#000080">(</font>z<font color="#000080">.</font>theta<font color="#000080">);
            </font>a<font color="#000080">.</font>y <font color="#000080">:= </font>z<font color="#000080">.</font>r <font color="#000080">* </font>SIN<font color="#000080">(</font>z<font color="#000080">.</font>theta<font color="#000080">)
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>rectangular<font color="#000080">:      </font><font color="#008000"><i>{rectangular-to-polar conversion}
          </i></font><font color="#FF0000"><b>BEGIN
            </b></font>a<font color="#000080">.</font>form <font color="#000080">:= </font>polar<font color="#000080">;
            </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>x<font color="#000080">) = </font><font color="#800000">0.0
            </font><font color="#FF0000"><b>THEN BEGIN
              IF   </b></font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">) = </font><font color="#800000">0.0
              </font><font color="#FF0000"><b>THEN BEGIN
                </b></font>a<font color="#000080">.</font>r     <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
                </font>a<font color="#000080">.</font>theta <font color="#000080">:= </font><font color="#800000">0.0
              </font><font color="#FF0000"><b>END
              ELSE
                IF   </b></font>z<font color="#000080">.</font>y <font color="#000080">&gt; </font><font color="#800000">0.0
                </font><font color="#FF0000"><b>THEN BEGIN
                  </b></font>a<font color="#000080">.</font>r <font color="#000080">:= </font>z<font color="#000080">.</font>y<font color="#000080">;
                  </font>a<font color="#000080">.</font>theta <font color="#000080">:= </font><font color="#800000">0.5</font><font color="#000080">*</font>PI
                <font color="#FF0000"><b>END
                ELSE BEGIN
                  </b></font>a<font color="#000080">.</font>r <font color="#000080">:= -</font>z<font color="#000080">.</font>y<font color="#000080">;
                  </font>a<font color="#000080">.</font>theta <font color="#000080">:= -</font><font color="#800000">0.5</font><font color="#000080">*</font>PI
                <font color="#FF0000"><b>END
            END
            ELSE BEGIN
              </b></font>a<font color="#000080">.</font>r <font color="#000080">:= </font>CAbs<font color="#000080">(</font>z<font color="#000080">);
              </font>a<font color="#000080">.</font>theta <font color="#000080">:= </font>ARCTAN<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">/</font>z<font color="#000080">.</font>x<font color="#000080">);   </font><font color="#008000"><i>{4th/1st quadrant -PI/2..PI/2}
              </i></font><font color="#FF0000"><b>IF   </b></font>z<font color="#000080">.</font>x <font color="#000080">&lt; </font><font color="#800000">0.0                </font><font color="#008000"><i>{2nd/3rd quadrants}
              </i></font><font color="#FF0000"><b>THEN
                IF   </b></font>z<font color="#000080">.</font>y <font color="#000080">&gt;= </font><font color="#800000">0.0
                </font><font color="#FF0000"><b>THEN </b></font>a<font color="#000080">.</font>theta <font color="#000080">:=  </font>PI <font color="#000080">+ </font>a<font color="#000080">.</font>theta <font color="#008000"><i>{2nd quadrant:  PI/2..PI}
                </i></font><font color="#FF0000"><b>ELSE </b></font>a<font color="#000080">.</font>theta <font color="#000080">:= -</font>PI <font color="#000080">+ </font>a<font color="#000080">.</font>theta <font color="#008000"><i>{3rd quadrant: -PI..-PI/2}
            </i></font><font color="#FF0000"><b>END
          END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>CDeFuzz <font color="#000080">(</font>a<font color="#000080">);
      </font>z <font color="#000080">:= </font>a
    <font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CConvert}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSet <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>RealType<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>z<font color="#000080">.</font>form <font color="#000080">:= </font>f<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>f <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>a<font color="#000080">;
          </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>b
        <font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>x <font color="#000080">:= </font>a<font color="#000080">;
          </font>z<font color="#000080">.</font>y <font color="#000080">:= </font>b
        <font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CSet}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION  </b></font>CStr <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>w<font color="#000080">,</font>d<font color="#000080">:  </font>BYTE<font color="#000080">; </font>f<font color="#000080">:  </font>ComplexForm<font color="#000080">):  </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>VAR </b></font>s1<font color="#000080">,</font>s2<font color="#000080">:  </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>z<font color="#000080">,</font>f<font color="#000080">);
    </font><font color="#FF0000"><b>CASE </b></font>f <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>Str <font color="#000080">(</font>z<font color="#000080">.</font>r<font color="#000080">:</font>w<font color="#000080">:</font>d<font color="#000080">, </font>s1<font color="#000080">);
          </font>Str <font color="#000080">(</font>z<font color="#000080">.</font>theta<font color="#000080">:</font>w<font color="#000080">:</font>d<font color="#000080">, </font>s2<font color="#000080">);
          </font>CStr <font color="#000080">:= </font>s1<font color="#000080">+</font><font color="#800000">'*CIS('</font><font color="#000080">+</font>s2<font color="#000080">+</font><font color="#800000">')'
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>Str <font color="#000080">(</font>z<font color="#000080">.</font>x<font color="#000080">:</font>w<font color="#000080">:</font>d<font color="#000080">, </font>s1<font color="#000080">);
          </font>Str <font color="#000080">(</font>ABS<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">):</font>w<font color="#000080">:</font>d<font color="#000080">, </font>s2<font color="#000080">);
          </font><font color="#FF0000"><b>IF   </b></font>z<font color="#000080">.</font>y <font color="#000080">&gt;= </font><font color="#800000">0
          </font><font color="#FF0000"><b>THEN </b></font>CStr <font color="#000080">:= </font>s1<font color="#000080">+</font><font color="#800000">' +'</font><font color="#000080">+</font>s2<font color="#000080">+</font><font color="#800000">'i'
          </font><font color="#FF0000"><b>ELSE </b></font>CStr <font color="#000080">:= </font>s1<font color="#000080">+</font><font color="#800000">' -'</font><font color="#000080">+</font>s2<font color="#000080">+</font><font color="#800000">'i'
        </font><font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CStr}</i></font><font color="#000080">;

                                  </font><font color="#008000"><i>{complex arithmetic}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CAdd  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a + b}
  </i></font><font color="#FF0000"><b>BEGIN                                               </b></font><font color="#008000"><i>{complex addition}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CConvert <font color="#000080">(</font>b<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>z<font color="#000080">.</font>form <font color="#000080">:= </font>rectangular<font color="#000080">;
    </font>z<font color="#000080">.</font>x <font color="#000080">:= </font>a<font color="#000080">.</font>x <font color="#000080">+ </font>b<font color="#000080">.</font>x<font color="#000080">;   </font><font color="#008000"><i>{real part}
    </i></font>z<font color="#000080">.</font>y <font color="#000080">:= </font>a<font color="#000080">.</font>y <font color="#000080">+ </font>b<font color="#000080">.</font>y<font color="#000080">;   </font><font color="#008000"><i>{imaginary part}
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CAdd}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CDiv  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a / b}
    </i></font><font color="#FF0000"><b>VAR </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>b<font color="#000080">,</font>a<font color="#000080">.</font>form<font color="#000080">);    </font><font color="#008000"><i>{arbitrarily convert one to type of other}
    </i></font>z<font color="#000080">.</font>form <font color="#000080">:= </font>a<font color="#000080">.</font>form<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>a<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>a<font color="#000080">.</font>r <font color="#000080">/ </font>b<font color="#000080">.</font>r<font color="#000080">;
          </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>a<font color="#000080">.</font>theta <font color="#000080">- </font>b<font color="#000080">.</font>theta<font color="#000080">)
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>temp <font color="#000080">:= </font>SQR<font color="#000080">(</font>b<font color="#000080">.</font>x<font color="#000080">) + </font>SQR<font color="#000080">(</font>b<font color="#000080">.</font>y<font color="#000080">);
          </font>z<font color="#000080">.</font>x <font color="#000080">:= (</font>a<font color="#000080">.</font>x<font color="#000080">*</font>b<font color="#000080">.</font>x <font color="#000080">+ </font>a<font color="#000080">.</font>y<font color="#000080">*</font>b<font color="#000080">.</font>y<font color="#000080">) / </font>temp<font color="#000080">;
          </font>z<font color="#000080">.</font>y <font color="#000080">:= (</font>a<font color="#000080">.</font>y<font color="#000080">*</font>b<font color="#000080">.</font>x <font color="#000080">- </font>a<font color="#000080">.</font>x<font color="#000080">*</font>b<font color="#000080">.</font>y<font color="#000080">) / </font>temp
        <font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CDiv}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CMult <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a * b}
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>b<font color="#000080">,</font>a<font color="#000080">.</font>form<font color="#000080">);    </font><font color="#008000"><i>{arbitrarily convert one to type of other}
    </i></font>z<font color="#000080">.</font>form <font color="#000080">:= </font>a<font color="#000080">.</font>form<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>a<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>a<font color="#000080">.</font>r <font color="#000080">* </font>b<font color="#000080">.</font>r<font color="#000080">;
          </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>a<font color="#000080">.</font>theta <font color="#000080">+ </font>b<font color="#000080">.</font>theta<font color="#000080">)
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>x <font color="#000080">:= </font>a<font color="#000080">.</font>x<font color="#000080">*</font>b<font color="#000080">.</font>x <font color="#000080">- </font>a<font color="#000080">.</font>y<font color="#000080">*</font>b<font color="#000080">.</font>y<font color="#000080">;
          </font>z<font color="#000080">.</font>y <font color="#000080">:= </font>a<font color="#000080">.</font>x<font color="#000080">*</font>b<font color="#000080">.</font>y <font color="#000080">+ </font>a<font color="#000080">.</font>y<font color="#000080">*</font>b<font color="#000080">.</font>x
        <font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CMult}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSub  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = a - b}
  </i></font><font color="#FF0000"><b>BEGIN                                               </b></font><font color="#008000"><i>{complex subtraction}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CConvert <font color="#000080">(</font>b<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>z<font color="#000080">.</font>form <font color="#000080">:= </font>rectangular<font color="#000080">;
    </font>z<font color="#000080">.</font>x <font color="#000080">:= </font>a<font color="#000080">.</font>x <font color="#000080">- </font>b<font color="#000080">.</font>x<font color="#000080">;   </font><font color="#008000"><i>{real part}
    </i></font>z<font color="#000080">.</font>y <font color="#000080">:= </font>a<font color="#000080">.</font>y <font color="#000080">- </font>b<font color="#000080">.</font>y<font color="#000080">;   </font><font color="#008000"><i>{imaginary part}
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSub}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CNeg  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a  <font color="#000080">:  </font>Complex<font color="#000080">);    </font><font color="#008000"><i>{z = -a   }
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>z<font color="#000080">.</font>form <font color="#000080">:= </font>a<font color="#000080">.</font>form<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>a<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>a<font color="#000080">.</font>r<font color="#000080">;
          </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>a<font color="#000080">.</font>theta <font color="#000080">+ </font>PI<font color="#000080">)
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>x <font color="#000080">:= -</font>a<font color="#000080">.</font>x<font color="#000080">;
          </font>z<font color="#000080">.</font>y <font color="#000080">:= -</font>a<font color="#000080">.</font>y
        <font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CNeg}</i></font><font color="#000080">;
                                  </font><font color="#008000"><i>{complex natural log, exponential}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CLn <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>fn<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);  </font><font color="#008000"><i>{fn  = ln(z)}
  </i></font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.1.2 on p. 67}
    </i></font>CConvert <font color="#000080">(</font>z<font color="#000080">,</font>polar<font color="#000080">);
    </font>fn<font color="#000080">.</font>form <font color="#000080">:= </font>rectangular<font color="#000080">;
    </font>fn<font color="#000080">.</font>x <font color="#000080">:= </font>LN<font color="#000080">(</font>z<font color="#000080">.</font>r<font color="#000080">);
    </font>fn<font color="#000080">.</font>y <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>z<font color="#000080">.</font>theta<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CLn}</i></font><font color="#000080">;  </font><font color="#008000"><i>{principal value only}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CExp  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z  <font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);   </font><font color="#008000"><i>{z   = exp(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Euler's Formula:  Abramowitz formula 4.3.47 on p. 74}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>temp <font color="#000080">:= </font>EXP<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">);
    </font>CSet <font color="#000080">(</font>z<font color="#000080">, </font>temp<font color="#000080">*</font>COS<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">),</font>temp<font color="#000080">*</font>SIN<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>rectangular<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CExp}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CPwr  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z  <font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">,</font>b<font color="#000080">:  </font>Complex<font color="#000080">); </font><font color="#008000"><i>{z   = a^b   }
    </i></font><font color="#FF0000"><b>VAR
      </b></font>blna<font color="#000080">,</font>lna<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.2.7 on p. 69}
    </i></font>CDeFuzz <font color="#000080">(</font>a<font color="#000080">);
    </font>CDeFuzz <font color="#000080">(</font>b<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>CAbsSqr<font color="#000080">(</font>a<font color="#000080">) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN
      IF    </b></font><font color="#000080">(</font>CAbsSqr<font color="#000080">(</font>b<font color="#000080">) = </font><font color="#800000">0.0</font><font color="#000080">)
      </font><font color="#FF0000"><b>THEN  </b></font>z <font color="#000080">:= </font>Cone                   <font color="#008000"><i>{lim a^a = 1 as a -&gt; 0}
      </i></font><font color="#FF0000"><b>ELSE  </b></font>z <font color="#000080">:= </font>Czero                  <font color="#008000"><i>{0^b = 0, b &lt;&gt; 0}
    </i></font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CLn <font color="#000080">(</font>lna<font color="#000080">,</font>a<font color="#000080">);
      </font>CMult <font color="#000080">(</font>blna<font color="#000080">,</font>b<font color="#000080">,</font>lna<font color="#000080">);
      </font>CExp <font color="#000080">(</font>z<font color="#000080">, </font>blna<font color="#000080">)
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CPwr}</i></font><font color="#000080">;
                                  </font><font color="#008000"><i>{complex trig functions}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCos  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cos(a)}
  </i></font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.56 on p. 74}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CSet <font color="#000080">(</font>z<font color="#000080">, </font>COS<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>COSH<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), -</font>SIN<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>SINH<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>rectangular<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCos}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSin  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sin(a)}
  </i></font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.55 on p. 74}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CSet <font color="#000080">(</font>z<font color="#000080">, </font>SIN<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>COSH<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>COS<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>SINH<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>rectangular<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSin}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CTan  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = tan(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.57 on p. 74}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>temp <font color="#000080">:= </font>COS<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">) + </font>COSH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">(</font>temp<font color="#000080">) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>CSet <font color="#000080">(</font>z<font color="#000080">,</font>SIN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">)/</font>temp<font color="#000080">,</font>SINH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">)/</font>temp<font color="#000080">,</font>rectangular<font color="#000080">)
    </font><font color="#FF0000"><b>END
    ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CTan}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSec  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sec(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.5 on p. 72}
    </i></font>CCos <font color="#000080">(</font>temp<font color="#000080">, </font>a<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">( </font>Cabs<font color="#000080">(</font>temp<font color="#000080">) ) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>CDiv <font color="#000080">(</font>z<font color="#000080">, </font>Cone<font color="#000080">,</font>temp<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSec}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CCsc  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = csc(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.4 on p. 72}
    </i></font>CSin <font color="#000080">(</font>temp<font color="#000080">, </font>a<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">( </font>Cabs<font color="#000080">(</font>temp<font color="#000080">) ) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>CDiv <font color="#000080">(</font>z<font color="#000080">, </font>Cone<font color="#000080">,</font>temp<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCsc}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CCot  <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cot(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.3.58 on p. 74}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>temp <font color="#000080">:= </font>COSH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">) - </font>COS<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">(</font>temp<font color="#000080">) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>CSet <font color="#000080">(</font>z<font color="#000080">,</font>SIN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">)/</font>temp<font color="#000080">,-</font>SINH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">)/</font>temp<font color="#000080">,</font>rectangular<font color="#000080">)
    </font><font color="#FF0000"><b>END
    ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCot}</i></font><font color="#000080">;

                                  </font><font color="#008000"><i>{complex hyperbolic functions}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CCosh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = cosh(a)}
  </i></font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.50 on p. 84}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CSet <font color="#000080">(</font>z<font color="#000080">, </font>COSH<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>COS<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>SINH<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>SIN<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>rectangular<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCosh}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSinh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sinh(a)}
  </i></font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.49 on p.84}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CSet <font color="#000080">(</font>z<font color="#000080">, </font>SINH<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>COS<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>COSH<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">)*</font>SIN<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">), </font>rectangular<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSinh}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CTanh <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = tanh(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.51 on p. 84}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>temp <font color="#000080">:= </font>COSH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">) + </font>COS<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">(</font>temp<font color="#000080">) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>CSet <font color="#000080">(</font>z<font color="#000080">,</font>SINH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">)/</font>temp<font color="#000080">,</font>SIN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">)/</font>temp<font color="#000080">,</font>rectangular<font color="#000080">)
    </font><font color="#FF0000"><b>END
    ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CTanh}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSech <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = sech(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.5 on p. 83}
    </i></font>CCosh <font color="#000080">(</font>temp<font color="#000080">, </font>a<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">( </font>Cabs<font color="#000080">(</font>temp<font color="#000080">) ) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>CDiv <font color="#000080">(</font>z<font color="#000080">, </font>Cone<font color="#000080">,</font>temp<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSec}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CCsch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = csch(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.4 on p. 83}
    </i></font>CSinh <font color="#000080">(</font>temp<font color="#000080">, </font>a<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">( </font>Cabs<font color="#000080">(</font>temp<font color="#000080">) ) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>CDiv <font color="#000080">(</font>z<font color="#000080">, </font>Cone<font color="#000080">,</font>temp<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCsch}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CCoth <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);     </font><font color="#008000"><i>{z   = coth(a)}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>temp<font color="#000080">:  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN  </b></font><font color="#008000"><i>{Abramowitz formula 4.5.52 on p. 84}
    </i></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>temp <font color="#000080">:= </font>COSH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">) - </font>COS<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>DeFuzz<font color="#000080">(</font>temp<font color="#000080">) &lt;&gt; </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN BEGIN
      </b></font>CSet <font color="#000080">(</font>z<font color="#000080">,</font>SINH<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>x<font color="#000080">)/</font>temp<font color="#000080">,-</font>SIN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>a<font color="#000080">.</font>y<font color="#000080">)/</font>temp<font color="#000080">,</font>rectangular<font color="#000080">)
    </font><font color="#FF0000"><b>END
    ELSE </b></font>z <font color="#000080">:= </font>Cinfinity
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CCoth}</i></font><font color="#000080">;

                                  </font><font color="#008000"><i>{miscellaneous complex functions}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>CAbs <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">):  </font>RealType<font color="#000080">;                  </font><font color="#008000"><i>{CAbs = |z|}
  </i></font><font color="#FF0000"><b>BEGIN
    CASE </b></font>z<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>rectangular<font color="#000080">:  </font>CAbs <font color="#000080">:= </font>SQRT<font color="#000080">( </font>SQR<font color="#000080">(</font>z<font color="#000080">.</font>x<font color="#000080">) + </font>SQR<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">) );
      </font>polar<font color="#000080">:        </font>CAbs <font color="#000080">:= </font>z<font color="#000080">.</font>r
    <font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CAbs}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>CAbsSqr <font color="#000080">(</font>z<font color="#000080">:  </font>Complex<font color="#000080">):  </font>RealType<font color="#000080">;            </font><font color="#008000"><i>{CAbsSqr = |z|^2}
  </i></font><font color="#FF0000"><b>BEGIN
    CASE </b></font>z<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>rectangular<font color="#000080">:  </font>CAbsSqr <font color="#000080">:= </font>SQR<font color="#000080">(</font>z<font color="#000080">.</font>x<font color="#000080">) + </font>SQR<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">);
      </font>polar<font color="#000080">:        </font>CAbsSqr <font color="#000080">:= </font>SQR<font color="#000080">(</font>z<font color="#000080">.</font>r<font color="#000080">)
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CAbsSqr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CIntPwr <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>n<font color="#000080">:  </font>INTEGER<font color="#000080">); </font><font color="#008000"><i>{z = a^n}
    {CIntPwr directly applies DeMoivre's theorem to calculate
     an integer power of a complex number.  The formula holds
     for both positive and negative values of 'n'.}
  </i></font><font color="#FF0000"><b>BEGIN
    IF   </b></font>CAbsSqr<font color="#000080">(</font>a<font color="#000080">) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN
      IF    </b></font>n <font color="#000080">= </font><font color="#800000">0
      </font><font color="#FF0000"><b>THEN  </b></font>z <font color="#000080">:= </font>Cone                   <font color="#008000"><i>{lim a^a = 1 as a -&gt; 0}
      </i></font><font color="#FF0000"><b>ELSE  </b></font>z <font color="#000080">:= </font>Czero                  <font color="#008000"><i>{0^n = 0, except for 0^0=1}
    </i></font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>polar<font color="#000080">);
      </font>z<font color="#000080">.</font>form <font color="#000080">:= </font>polar<font color="#000080">;
      </font>z<font color="#000080">.</font>r <font color="#000080">:= </font>Pwr<font color="#000080">(</font>a<font color="#000080">.</font>r<font color="#000080">,</font>n<font color="#000080">);
      </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>n<font color="#000080">*</font>a<font color="#000080">.</font>theta<font color="#000080">)
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CIntPwr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CRealPwr <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>x<font color="#000080">:  </font>RealType<font color="#000080">); </font><font color="#008000"><i>{z = a^x}
  </i></font><font color="#FF0000"><b>BEGIN
    IF   </b></font>CAbsSqr<font color="#000080">(</font>a<font color="#000080">) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN
      IF    </b></font>Defuzz<font color="#000080">(</font>x<font color="#000080">) = </font><font color="#800000">0.0
      </font><font color="#FF0000"><b>THEN  </b></font>z <font color="#000080">:= </font>Cone                   <font color="#008000"><i>{lim a^a = 1 as a -&gt; 0}
      </i></font><font color="#FF0000"><b>ELSE  </b></font>z <font color="#000080">:= </font>Czero                  <font color="#008000"><i>{0^n = 0, except for 0^0=1}
    </i></font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>polar<font color="#000080">);
      </font>z<font color="#000080">.</font>form <font color="#000080">:= </font>polar<font color="#000080">;
      </font>z<font color="#000080">.</font>r <font color="#000080">:= </font>Pwr<font color="#000080">(</font>a<font color="#000080">.</font>r<font color="#000080">,</font>x<font color="#000080">);
      </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>x<font color="#000080">*</font>a<font color="#000080">.</font>theta<font color="#000080">)
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CRealPwr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CConjugate <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);      </font><font color="#008000"><i>{z = a*}
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>z<font color="#000080">.</font>form <font color="#000080">:= </font>a<font color="#000080">.</font>form<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>a<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>a<font color="#000080">.</font>r<font color="#000080">;
          </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">(-</font>a<font color="#000080">.</font>theta<font color="#000080">)
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>x <font color="#000080">:= </font>a<font color="#000080">.</font>x<font color="#000080">;
          </font>z<font color="#000080">.</font>y <font color="#000080">:= -</font>a<font color="#000080">.</font>y
        <font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CConjugate}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CSqrt <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);      </font><font color="#008000"><i>{z = SQRT(a)}
  </i></font><font color="#FF0000"><b>BEGIN
    </b></font>CRoot <font color="#000080">(</font>z<font color="#000080">, </font>a<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)  </font><font color="#008000"><i>{return only one of the two values}
  </i></font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CSqrt}</i></font><font color="#000080">;
                                           </font><font color="#008000"><i>{z = a^(1/n), n &gt; 0}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CRoot <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">; </font>k<font color="#000080">,</font>n<font color="#000080">:  </font>WORD<font color="#000080">);
    </font><font color="#008000"><i>{CRoot can calculate all 'n' roots of 'a' by varying 'k' from 0..n-1.}
    {This is another application of DeMoivre's theorem.  See CIntPwr.}
  </i></font><font color="#FF0000"><b>BEGIN
    IF   </b></font>CAbs<font color="#000080">(</font>a<font color="#000080">) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>z <font color="#000080">:= </font>Czero                   <font color="#008000"><i>{0^z = 0, except 0^0 is undefined}
    </i></font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CConvert <font color="#000080">(</font>a<font color="#000080">,</font>polar<font color="#000080">);
      </font>z<font color="#000080">.</font>form <font color="#000080">:= </font>polar<font color="#000080">;
      </font>z<font color="#000080">.</font>r <font color="#000080">:= </font>Pwr<font color="#000080">(</font>a<font color="#000080">.</font>r<font color="#000080">,</font><font color="#800000">1.0</font><font color="#000080">/</font>n<font color="#000080">);
      </font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>FixAngle<font color="#000080">((</font>a<font color="#000080">.</font>theta <font color="#000080">+ </font>k<font color="#000080">*</font><font color="#800000">2.0</font><font color="#000080">*</font>PI<font color="#000080">)/</font>n<font color="#000080">)
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CRoot}</i></font><font color="#000080">;

                             </font><font color="#008000"><i>{complex Bessel functions of order zero}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CI0   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>sum<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);  </font><font color="#008000"><i>{sum = I0(z)}
    {I0(z) = &auml; ( (&shy;z^2)^k / (k!)^2 ), k=0,1,2,...,&igrave;}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>i      <font color="#000080">:  </font>BYTE<font color="#000080">;
      </font>SizeSqr<font color="#000080">:  </font>RealType<font color="#000080">;
      </font>term   <font color="#000080">:  </font>Complex<font color="#000080">;
      </font>zSQR25 <font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>z<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>sum <font color="#000080">:= </font>Cone<font color="#000080">;                       </font><font color="#008000"><i>{term 0}
    </i></font>Cmult <font color="#000080">(</font>zSQR25<font color="#000080">, </font>z<font color="#000080">,</font>z<font color="#000080">);
    </font>zSQR25<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0.25 </font><font color="#000080">* </font>zSQR25<font color="#000080">.</font>x<font color="#000080">;
    </font>zSQR25<font color="#000080">.</font>y <font color="#000080">:= </font><font color="#800000">0.25 </font><font color="#000080">* </font>zSQR25<font color="#000080">.</font>y<font color="#000080">;       </font><font color="#008000"><i>{&shy;z^2}
    </i></font>term <font color="#000080">:= </font>zSQR25<font color="#000080">;
    </font>CAdd <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>zSQR25<font color="#000080">);            </font><font color="#008000"><i>{term 1}
    </i></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      </b></font>CMult <font color="#000080">(</font>term<font color="#000080">,</font>zSQR25<font color="#000080">,</font>term<font color="#000080">);
      </font>INC <font color="#000080">(</font>i<font color="#000080">);
      </font>term<font color="#000080">.</font>x <font color="#000080">:= </font>term<font color="#000080">.</font>x <font color="#000080">/ </font>SQR<font color="#000080">(</font>i<font color="#000080">);
      </font>term<font color="#000080">.</font>y <font color="#000080">:= </font>term<font color="#000080">.</font>y <font color="#000080">/ </font>SQR<font color="#000080">(</font>i<font color="#000080">);
      </font>CAdd <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>term<font color="#000080">);       </font><font color="#008000"><i>{sum := sum + term}
      </i></font>SizeSqr <font color="#000080">:= </font>SQR<font color="#000080">(</font>term<font color="#000080">.</font>x<font color="#000080">) + </font>SQR<font color="#000080">(</font>term<font color="#000080">.</font>y<font color="#000080">)
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font>MaxTerm<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>SizeSqr <font color="#000080">&lt; </font>EpsilonSqr<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CI0}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CJ0   <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>sum<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);  </font><font color="#008000"><i>{sum = J0(z)}
    {J0(z) = &auml; ( (-1)^k * (&shy;z^2)^k / (k!)^2 ), k=0,1,2,...,&igrave;}
    </i></font><font color="#FF0000"><b>VAR
      </b></font>addflag<font color="#000080">:  </font>BOOLEAN<font color="#000080">;
      </font>i      <font color="#000080">:  </font>BYTE<font color="#000080">;
      </font>SizeSqr<font color="#000080">:  </font>RealType<font color="#000080">;
      </font>term   <font color="#000080">:  </font>Complex<font color="#000080">;
      </font>zSQR25 <font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>z<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>sum <font color="#000080">:= </font>Cone<font color="#000080">;                       </font><font color="#008000"><i>{term 0}
    </i></font>Cmult <font color="#000080">(</font>zSQR25<font color="#000080">, </font>z<font color="#000080">,</font>z<font color="#000080">);
    </font>zSQR25<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0.25 </font><font color="#000080">* </font>zSQR25<font color="#000080">.</font>x<font color="#000080">;
    </font>zSQR25<font color="#000080">.</font>y <font color="#000080">:= </font><font color="#800000">0.25 </font><font color="#000080">* </font>zSQR25<font color="#000080">.</font>y<font color="#000080">;       </font><font color="#008000"><i>{&shy;z^2}
    </i></font>term <font color="#000080">:= </font>zSQR25<font color="#000080">;
    </font>CSub <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>zSQR25<font color="#000080">);            </font><font color="#008000"><i>{term 1}
    </i></font>addflag <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      </b></font>CMult <font color="#000080">(</font>term<font color="#000080">,</font>zSQR25<font color="#000080">,</font>term<font color="#000080">);
      </font>INC <font color="#000080">(</font>i<font color="#000080">);
      </font>addflag <font color="#000080">:= </font><font color="#FF0000"><b>NOT </b></font>addflag<font color="#000080">;
      </font>term<font color="#000080">.</font>x <font color="#000080">:= </font>term<font color="#000080">.</font>x <font color="#000080">/ </font>SQR<font color="#000080">(</font>i<font color="#000080">);
      </font>term<font color="#000080">.</font>y <font color="#000080">:= </font>term<font color="#000080">.</font>y <font color="#000080">/ </font>SQR<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>IF   </b></font>addflag
      <font color="#FF0000"><b>THEN </b></font>CAdd <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>term<font color="#000080">)        </font><font color="#008000"><i>{sum := sum + term}
      </i></font><font color="#FF0000"><b>ELSE </b></font>CSub <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>term<font color="#000080">);       </font><font color="#008000"><i>{sum := sum - term}
      </i></font>SizeSqr <font color="#000080">:= </font>SQR<font color="#000080">(</font>term<font color="#000080">.</font>x<font color="#000080">) + </font>SQR<font color="#000080">(</font>term<font color="#000080">.</font>y<font color="#000080">)
    </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font>MaxTerm<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>SizeSqr <font color="#000080">&lt; </font>EpsilonSqr<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CJ0}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CApproxLnGamma <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>sum<font color="#000080">:  </font>Complex<font color="#000080">; </font>z<font color="#000080">:  </font>Complex<font color="#000080">);
    </font><font color="#008000"><i>{This is the approximation used in the National Bureau of
     Standards &quot;Table of the Gamma Function for Complex Arguments,&quot;
     Applied Mathematics Series 34, 1954.  The NBS table was created
     using this approximation over the area  9 &oacute; Re(z) &oacute; 10 and
     0 &oacute; Im(z) &oacute; 10.  Other table values were computed using the
     relationship ln &acirc;(z+1) = ln z + ln &acirc;(z).}
    </i></font><font color="#FF0000"><b>CONST
      </b></font>c<font color="#000080">:  </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>RealType
       <font color="#000080">=  (</font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">12</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">360</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">1260</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">1680</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">1188</font><font color="#000080">, -</font><font color="#800000">691</font><font color="#000080">/</font><font color="#800000">360360</font><font color="#000080">,
           </font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">156</font><font color="#000080">, -</font><font color="#800000">3617</font><font color="#000080">/</font><font color="#800000">122400</font><font color="#000080">);
    </font><font color="#FF0000"><b>VAR
      </b></font>i     <font color="#000080">:  </font>WORD<font color="#000080">;
      </font>powers<font color="#000080">:  </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Complex<font color="#000080">;
      </font>temp1 <font color="#000080">:  </font>Complex<font color="#000080">;
      </font>temp2 <font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>z<font color="#000080">,</font>rectangular<font color="#000080">);
    </font>CLn  <font color="#000080">(</font>temp1<font color="#000080">,</font>z<font color="#000080">);                              </font><font color="#008000"><i>{ln(z}
    </i></font>CSet <font color="#000080">(</font>temp2<font color="#000080">, </font>z<font color="#000080">.</font>x<font color="#000080">-</font><font color="#800000">0.5</font><font color="#000080">, </font>z<font color="#000080">.</font>y<font color="#000080">, </font>rectangular<font color="#000080">);     </font><font color="#008000"><i>{z - 0.5}
    </i></font>CMult <font color="#000080">(</font>sum<font color="#000080">, </font>temp1<font color="#000080">,</font>temp2<font color="#000080">);                    </font><font color="#008000"><i>{(z - 0.5)*ln(z)}
    </i></font>CSub <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>z<font color="#000080">);                           </font><font color="#008000"><i>{(z - 0.5)*ln(z) - z}
    </i></font>sum<font color="#000080">.</font>x <font color="#000080">:= </font>sum<font color="#000080">.</font>x <font color="#000080">+ </font>hLn2PI<font color="#000080">;

    </font>temp1 <font color="#000080">:= </font>Cone<font color="#000080">;
    </font>CDiv <font color="#000080">(</font>powers<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>temp1<font color="#000080">, </font>z<font color="#000080">);                  </font><font color="#008000"><i>{z^-1}
    </i></font>CMult <font color="#000080">(</font>temp2<font color="#000080">, </font>powers<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>powers<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);          </font><font color="#008000"><i>{z^-2}
    </i></font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO
      </b></font>CMult <font color="#000080">(</font>powers<font color="#000080">[</font>i<font color="#000080">], </font>powers<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">],</font>temp2<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO BEGIN
      </b></font>CSet <font color="#000080">(</font>temp1<font color="#000080">, </font>c<font color="#000080">[</font>i<font color="#000080">]*</font>powers<font color="#000080">[</font>i<font color="#000080">].</font>x<font color="#000080">, </font>c<font color="#000080">[</font>i<font color="#000080">]*</font>powers<font color="#000080">[</font>i<font color="#000080">].</font>y<font color="#000080">, </font>rectangular<font color="#000080">);
      </font>CAdd <font color="#000080">(</font>sum<font color="#000080">, </font>sum<font color="#000080">,</font>temp1<font color="#000080">);
    </font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CApproxLnGamma}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CLnGamma <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);
    </font><font color="#FF0000"><b>VAR
      </b></font>lna <font color="#000080">:  </font>Complex<font color="#000080">;
      </font>temp<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CConvert <font color="#000080">(</font>a<font color="#000080">, </font>rectangular<font color="#000080">);

    </font><font color="#FF0000"><b>IF   </b></font><font color="#000080">(</font>a<font color="#000080">.</font>x <font color="#000080">&lt;= </font><font color="#800000">0.0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>DeFuzz<font color="#000080">(</font>a<font color="#000080">.</font>y<font color="#000080">) = </font><font color="#800000">0.0</font><font color="#000080">)
    </font><font color="#FF0000"><b>THEN
      IF   </b></font>DeFuzz<font color="#000080">(</font>INT<font color="#000080">(</font>a<font color="#000080">.</font>x<font color="#000080">-</font><font color="#800000">1E</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">) - </font>a<font color="#000080">.</font>x<font color="#000080">) = </font><font color="#800000">0.0     </font><font color="#008000"><i>{negative integer?}
      </i></font><font color="#FF0000"><b>THEN BEGIN
        </b></font>z <font color="#000080">:= </font>Cinfinity<font color="#000080">;
        </font>EXIT
      <font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>IF   </b></font>a<font color="#000080">.</font>y <font color="#000080">&lt; </font><font color="#800000">0.0                     </font><font color="#008000"><i>{3rd or 4th quadrant?}
    </i></font><font color="#FF0000"><b>THEN BEGIN
      </b></font>CConjugate <font color="#000080">(</font>a<font color="#000080">, </font>a<font color="#000080">);
      </font>CLnGamma <font color="#000080">(</font>z<font color="#000080">, </font>a<font color="#000080">);                 </font><font color="#008000"><i>{try again in 1st or 2nd quadrant}
      </i></font>CConjugate <font color="#000080">(</font>z<font color="#000080">, </font>z<font color="#000080">)                </font><font color="#008000"><i>{left this out!  1/3/91}
    </i></font><font color="#FF0000"><b>END
    ELSE BEGIN
      IF   </b></font>a<font color="#000080">.</font>x <font color="#000080">&lt; </font><font color="#800000">9.0                   </font><font color="#008000"><i>{&quot;left&quot; of NBS table range}
      </i></font><font color="#FF0000"><b>THEN BEGIN
        </b></font>CLn <font color="#000080">(</font>lna<font color="#000080">, </font>a<font color="#000080">);
        </font>CSet <font color="#000080">(</font>a<font color="#000080">, </font>a<font color="#000080">.</font>x<font color="#000080">+</font><font color="#800000">1.0</font><font color="#000080">, </font>a<font color="#000080">.</font>y<font color="#000080">, </font>rectangular<font color="#000080">);
        </font>CLnGamma <font color="#000080">(</font>temp<font color="#000080">,</font>a<font color="#000080">);
        </font>CSub <font color="#000080">(</font>z<font color="#000080">, </font>temp<font color="#000080">,</font>lna<font color="#000080">)
      </font><font color="#FF0000"><b>END
      ELSE </b></font>CApproxLnGamma <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">)  </font><font color="#008000"><i>{NBS table range:  9 &oacute; Re(z) &oacute; 10}
    </i></font><font color="#FF0000"><b>END
  END </b></font><font color="#008000"><i>{CLnGamma}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>CGamma <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">; </font>a<font color="#000080">:  </font>Complex<font color="#000080">);
    </font><font color="#FF0000"><b>VAR
      </b></font>lnz<font color="#000080">:  </font>Complex<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>CLnGamma <font color="#000080">(</font>lnz<font color="#000080">,</font>a<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>lnz<font color="#000080">.</font>x <font color="#000080">&gt;= </font><font color="#800000">75.0       </font><font color="#008000"><i>{arbitrary cutoff for infinity}
    </i></font><font color="#FF0000"><b>THEN </b></font>z <font color="#000080">:= </font>Cinfinity
    <font color="#FF0000"><b>ELSE
      IF   </b></font>lnz<font color="#000080">.</font>x <font color="#000080">&lt; -</font><font color="#800000">200.0
      </font><font color="#FF0000"><b>THEN </b></font>z <font color="#000080">:= </font>Czero        <font color="#008000"><i>{avoid underflow}
      </i></font><font color="#FF0000"><b>ELSE </b></font>CExp <font color="#000080">(</font>z<font color="#000080">, </font>lnz<font color="#000080">);
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{CGamma}</i></font><font color="#000080">;

                                  </font><font color="#008000"><i>{treat &quot;fuzz&quot; of real numbers}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>CDeFuzz <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>z<font color="#000080">:  </font>Complex<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    CASE </b></font>z<font color="#000080">.</font>form <font color="#FF0000"><b>OF
      </b></font>rectangular<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>x <font color="#000080">:= </font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>x<font color="#000080">);
          </font>z<font color="#000080">.</font>y <font color="#000080">:= </font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>y<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>polar<font color="#000080">:
        </font><font color="#FF0000"><b>BEGIN
          </b></font>z<font color="#000080">.</font>r <font color="#000080">:= </font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>r<font color="#000080">);
          </font><font color="#FF0000"><b>IF   </b></font>z<font color="#000080">.</font>r <font color="#000080">= </font><font color="#800000">0.0
          </font><font color="#FF0000"><b>THEN </b></font>z<font color="#000080">.</font>theta <font color="#000080">:= </font><font color="#800000">0.0     </font><font color="#008000"><i>{canonical form when radius is zero}
          </i></font><font color="#FF0000"><b>ELSE </b></font>z<font color="#000080">.</font>theta <font color="#000080">:= </font>DeFuzz<font color="#000080">(</font>z<font color="#000080">.</font>theta<font color="#000080">)
        </font><font color="#FF0000"><b>END
    END
  END </b></font><font color="#008000"><i>{CDeFuzz}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION  </b></font>DeFuzz <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    IF   </b></font>ABS<font color="#000080">(</font>x<font color="#000080">) &lt; </font>fuzz
    <font color="#FF0000"><b>THEN </b></font>Defuzz <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>ELSE </b></font>Defuzz <font color="#000080">:= </font>x
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Defuzz}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>PROCEDURE </b></font>SetFuzz <font color="#000080">(</font>value<font color="#000080">:  </font>RealType<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>fuzz <font color="#000080">:= </font>value
  <font color="#FF0000"><b>END </b></font><font color="#008000"><i>{SetFuzz}</i></font><font color="#000080">;

                                  </font><font color="#008000"><i>{miscellaneous}
  </i></font><font color="#FF0000"><b>FUNCTION </b></font>FixAngle <font color="#000080">(</font>theta<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;    </font><font color="#008000"><i>{-PI &lt; theta &lt;= PI}
  </i></font><font color="#FF0000"><b>BEGIN
    WHILE </b></font>theta <font color="#000080">&gt; </font>PI <font color="#FF0000"><b>DO
      </b></font>theta <font color="#000080">:= </font>theta <font color="#000080">- </font><font color="#800000">2.0</font><font color="#000080">*</font>PI<font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font>theta <font color="#000080">&lt;= -</font>PI <font color="#FF0000"><b>DO
      </b></font>theta <font color="#000080">:= </font>theta <font color="#000080">+ </font><font color="#800000">2.0</font><font color="#000080">*</font>PI<font color="#000080">;
    </font>FixAngle <font color="#000080">:= </font>DeFuzz<font color="#000080">(</font>theta<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{FixAngle}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Pwr <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;        </font><font color="#008000"><i>{Pwr = x^y}
  </i></font><font color="#FF0000"><b>BEGIN
    IF   </b></font>DeFuzz<font color="#000080">(</font>x<font color="#000080">) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN
      IF   </b></font>DeFuzz<font color="#000080">(</font>y<font color="#000080">) = </font><font color="#800000">0.0
      </font><font color="#FF0000"><b>THEN </b></font>Pwr <font color="#000080">:= </font><font color="#800000">1.0    </font><font color="#008000"><i>{0^0 = 1 (i.e., lim x^x = 1 as x -&gt; 0)}
      </i></font><font color="#FF0000"><b>ELSE </b></font>Pwr <font color="#000080">:= </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>ELSE </b></font>Pwr <font color="#000080">:= </font>EXP<font color="#000080">( </font>LN<font color="#000080">(</font>x<font color="#000080">)*</font>y <font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Pwr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Log10 <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Log10 <font color="#000080">:= </font>LN<font color="#000080">(</font>x<font color="#000080">) / </font>LN<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Log10}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>LongMod <font color="#000080">(</font>l1<font color="#000080">,</font>l2<font color="#000080">:  </font>LongInt<font color="#000080">):  </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>LongMod <font color="#000080">:= </font>l1 <font color="#000080">- </font>l2<font color="#000080">*(</font>l1 <font color="#FF0000"><b>DIV </b></font>l2<font color="#000080">)
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{LongMod}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Cosh <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Cosh <font color="#000080">:= </font><font color="#800000">0.5</font><font color="#000080">*( </font>EXP<font color="#000080">(</font>x<font color="#000080">) + </font>EXP<font color="#000080">(-</font>x<font color="#000080">) )
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Cosh}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>FUNCTION </b></font>Sinh <font color="#000080">(</font>x<font color="#000080">:  </font>RealType<font color="#000080">):  </font>RealType<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Sinh <font color="#000080">:= </font><font color="#800000">0.5</font><font color="#000080">*( </font>EXP<font color="#000080">(</font>x<font color="#000080">) - </font>EXP<font color="#000080">(-</font>x<font color="#000080">) )
  </font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{Sinh}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>SetFuzz <font color="#000080">(</font><font color="#800000">1.0E</font><font color="#000080">-</font><font color="#800000">12</font><font color="#000080">);
  </font>CSet <font color="#000080">( </font>Cone<font color="#000080">, </font><font color="#800000">1.0</font><font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>Czero<font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>Cinfinity<font color="#000080">, </font>Infinity<font color="#000080">, </font>Infinity<font color="#000080">, </font>rectangular<font color="#000080">);
  </font>hLnPI <font color="#000080">:= </font><font color="#800000">0.5</font><font color="#000080">*(</font>LN<font color="#000080">(</font>PI<font color="#000080">));
  </font>hLn2PI <font color="#000080">:= </font><font color="#800000">0.5</font><font color="#000080">*(</font>LN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">*</font>PI<font color="#000080">));
  </font>ln2 <font color="#000080">:= </font>LN<font color="#000080">(</font><font color="#800000">2.0</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{-------------  DEMO ----  CUT HERE ------ }
{$N+,E+}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>cdemo<font color="#000080">;

 </font><font color="#008000"><i>{This PROGRAM demonstrates the use of the ComplexOps UNIT.

  (C) Copyright 1990, 1992, Earl F. Glynn, Overland Park, KS.  Compuserve 73257,3527.
  All rights reserved.  This program may be freely distributed only for
  non-commercial use.}


  </i></font><font color="#FF0000"><b>USES </b></font>ComplexOps<font color="#000080">;

  </font><font color="#FF0000"><b>VAR
    </b></font>a      <font color="#000080">:  </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">22</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Complex<font color="#000080">;
    </font>csave  <font color="#000080">:  </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">22</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Complex<font color="#000080">;
    </font>k<font color="#000080">,</font>m    <font color="#000080">:  </font>WORD<font color="#000080">;
    </font>n      <font color="#000080">:  </font>INTEGER<font color="#000080">;
    </font>x<font color="#000080">,</font>y    <font color="#000080">:  </font>RealType<font color="#000080">;
    </font>z<font color="#000080">,</font>z1<font color="#000080">,</font>z2<font color="#000080">:  </font>Complex<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN

  </b></font>WRITELN <font color="#000080">(</font><font color="#800000">'Demo ComplexOPs PROCEDUREs and FUNCTIONs'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'  Notes:  1.  CIS(w) = COS(w) + i*SIN(w), w = -PI..PI'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'          2.  z = x + i*y'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">],  </font><font color="#800000">0.0</font><font color="#000080">,  </font><font color="#800000">0.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">2</font><font color="#000080">],  </font><font color="#800000">0.5</font><font color="#000080">,  </font><font color="#800000">0.5</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">3</font><font color="#000080">], -</font><font color="#800000">0.5</font><font color="#000080">,  </font><font color="#800000">0.5</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">4</font><font color="#000080">], -</font><font color="#800000">0.5</font><font color="#000080">, -</font><font color="#800000">0.5</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">5</font><font color="#000080">],  </font><font color="#800000">0.5</font><font color="#000080">, -</font><font color="#800000">0.5</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">6</font><font color="#000080">],  </font><font color="#800000">1.0</font><font color="#000080">,  </font><font color="#800000">0.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">7</font><font color="#000080">],  </font><font color="#800000">1.0</font><font color="#000080">,  </font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">8</font><font color="#000080">],  </font><font color="#800000">0.0</font><font color="#000080">,  </font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[ </font><font color="#800000">9</font><font color="#000080">], -</font><font color="#800000">1.0</font><font color="#000080">,  </font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">], -</font><font color="#800000">1.0</font><font color="#000080">,  </font><font color="#800000">0.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">], -</font><font color="#800000">1.0</font><font color="#000080">, -</font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">12</font><font color="#000080">],  </font><font color="#800000">0.0</font><font color="#000080">, -</font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">13</font><font color="#000080">],  </font><font color="#800000">1.0</font><font color="#000080">, -</font><font color="#800000">1.0</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">14</font><font color="#000080">],   </font><font color="#800000">5.</font><font color="#000080">,   </font><font color="#800000">0.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">15</font><font color="#000080">],   </font><font color="#800000">5.</font><font color="#000080">,   </font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">16</font><font color="#000080">],   </font><font color="#800000">0.</font><font color="#000080">,   </font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">17</font><font color="#000080">],  -</font><font color="#800000">5.</font><font color="#000080">,   </font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">18</font><font color="#000080">],  -</font><font color="#800000">5.</font><font color="#000080">,   </font><font color="#800000">0.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">19</font><font color="#000080">],  -</font><font color="#800000">5.</font><font color="#000080">,  -</font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">20</font><font color="#000080">],   </font><font color="#800000">0.</font><font color="#000080">,  -</font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">21</font><font color="#000080">],  -</font><font color="#800000">5.</font><font color="#000080">,  -</font><font color="#800000">3.</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>CSet <font color="#000080">(</font>a<font color="#000080">[</font><font color="#800000">22</font><font color="#000080">], -</font><font color="#800000">20.</font><font color="#000080">,  </font><font color="#800000">20.</font><font color="#000080">, </font>rectangular<font color="#000080">);

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex number definition/conversion/output:  CSet/CConvert/CStr'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'   z rectangular'</font><font color="#000080">:</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">'z polar'</font><font color="#000080">:</font><font color="#800000">28</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ---------------------------   '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO
    </b></font>WRITELN <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,
                     </font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>polar<font color="#000080">));
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex arithmetic:  CAdd, CSub, CMult, CDiv'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;

  </font>CSet <font color="#000080">(</font>z1<font color="#000080">,  </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Let z1 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                      </font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));
  </font>CSet <font color="#000080">(</font>z2<font color="#000080">, </font>SQRT<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">), -</font><font color="#800000">1</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z2 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z2<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                      </font>CStr<font color="#000080">(</font>z2<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));
  </font>WRITELN<font color="#000080">;

  </font>CAdd  <font color="#000080">(</font>z<font color="#000080">,</font>z1<font color="#000080">,</font>z2<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z1 + z2 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                           </font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));

  </font>CSub  <font color="#000080">(</font>z<font color="#000080">,</font>z1<font color="#000080">,</font>z2<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z1 - z2 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                           </font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));

  </font>CMult <font color="#000080">(</font>z<font color="#000080">,</font>z1<font color="#000080">,</font>z2<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z1 * z2 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                           </font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));

  </font>CDiv  <font color="#000080">(</font>z<font color="#000080">,</font>z1<font color="#000080">,</font>z2<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z1 / z2 = '</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>rectangular<font color="#000080">):</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">' or '</font><font color="#000080">,
                           </font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>polar<font color="#000080">));
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex natural logarithm:  CLn = LN(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'  Notes:  1.  LN(z) is multivalued.'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">' 2.  Any multiple of 2*PI*i could be added to/'</font><font color="#000080">,
    </font><font color="#800000">'subtracted from LN(z).'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">' 3.  LN(1)=0; LN(-1)=PI*i; LN(+/-i)=+/-0.5*PI*i.'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'LN(z)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'EXP( LN(z) ) = z'</font><font color="#000080">:</font><font color="#800000">32</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'---------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">22 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">]) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>WRITELN <font color="#000080">(</font><font color="#800000">'undefined'</font><font color="#000080">:</font><font color="#800000">18</font><font color="#000080">)
    </font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CLn <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
      </font>CExp <font color="#000080">(</font>z1<font color="#000080">,</font>z<font color="#000080">);
      </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">))
    </font><font color="#FF0000"><b>END
  END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex exponential:  CExp = EXP(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'EXP(z)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'LN( EXP(z) ) = z'</font><font color="#000080">:</font><font color="#800000">32</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'---------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">22 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CExp <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>CLn <font color="#000080">(</font>z1<font color="#000080">,</font>z<font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex power:  CPwr = z1^z2'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z^(-1+i)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'z^(-1+i)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font>CSet <font color="#000080">(</font>z1<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">]) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>WRITELN <font color="#000080">(</font><font color="#800000">'undefined'</font><font color="#000080">:</font><font color="#800000">18</font><font color="#000080">)
    </font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CPwr <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">],</font>z1<font color="#000080">);
      </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>polar<font color="#000080">))
    </font><font color="#FF0000"><b>END
  END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex cosine:  CCos = COS(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'COS(z)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">'COS(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CCos <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>CIntPwr <font color="#000080">(</font>csave<font color="#000080">[</font>k<font color="#000080">], </font>z<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);  </font><font color="#008000"><i>{save COS^2}
    </i></font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex sine:  CSin = SIN(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'SIN(z)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'SIN^2(z)+COS^2(z)=1'</font><font color="#000080">:</font><font color="#800000">32</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'---------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CSin <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>CIntPwr <font color="#000080">(</font>z1<font color="#000080">, </font>z<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);      </font><font color="#008000"><i>{SIN^2}
    </i></font>CAdd <font color="#000080">(</font>z1<font color="#000080">, </font>z1<font color="#000080">,</font>csave<font color="#000080">[</font>k<font color="#000080">]); </font><font color="#008000"><i>{SIN^2 + COS^2}
    </i></font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex tangent:  CTan = TAN(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'TAN(z)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">'TAN(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CTan <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex hyperbolic cosine:  CCosh = COSH(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'COSH(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'COSH(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CCosh <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>CIntPwr <font color="#000080">(</font>csave<font color="#000080">[</font>k<font color="#000080">], </font>z<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);  </font><font color="#008000"><i>{save COSH^2}
    </i></font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex hyperbolic sine:  CSinh = SINH(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'SINH(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'COSH^2(z)-SINH^2(z)=1'</font><font color="#000080">:</font><font color="#800000">34</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'---------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CSinh <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>CIntPwr <font color="#000080">(</font>z1<font color="#000080">, </font>z<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);      </font><font color="#008000"><i>{SINH^2}
    </i></font>CSub <font color="#000080">(</font>z1<font color="#000080">, </font>csave<font color="#000080">[</font>k<font color="#000080">],</font>z1<font color="#000080">); </font><font color="#008000"><i>{COSH^2 - SINH^2}
    </i></font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex hyperbolic tangent:  CTanh = TANH(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'TANH(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'TANH(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CTanh <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">4
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Absolute value of complex number:  CAbs = ABS(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'ABS(z)'</font><font color="#000080">:</font><font color="#800000">17</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITELN <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CAbs<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">]):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex integer power:  CIntPwr = z^n  '</font><font color="#000080">,
    </font><font color="#800000">'(using DeMoivre''s Theorem)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z^3'</font><font color="#000080">:</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">'z^3'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">]) = </font><font color="#800000">0.0
    </font><font color="#FF0000"><b>THEN </b></font>WRITELN <font color="#000080">(</font><font color="#800000">'undefined'</font><font color="#000080">:</font><font color="#800000">18</font><font color="#000080">)
    </font><font color="#FF0000"><b>ELSE BEGIN
      </b></font>CIntPwr <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">3</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
      </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
      </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
      </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
    </font><font color="#FF0000"><b>END
  END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex conjugate:  CConjugate = z*'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z*'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">'z*'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CConjugate <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex square root:  CSqrt = SQRT(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'SQRT(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'SQRT(z)'</font><font color="#000080">:</font><font color="#800000">28</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'root 1'</font><font color="#000080">:</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">'root 2'</font><font color="#000080">:</font><font color="#800000">28</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'---------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CSqrt <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);       </font><font color="#008000"><i>{same as CRoot (z,a[k],0,2)}
    </i></font>CRoot <font color="#000080">(</font>z1<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'The three cube roots of -1+i:  (-1+i)^(1/3)'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'(See Schaum''s Outline Series &quot;Complex Variables&quot;, 1964, '</font><font color="#000080">,
    </font><font color="#800000">'p. 18, problem 29.)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z^(1/3)'</font><font color="#000080">:</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">'z^(1/3)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font>CSet <font color="#000080">(</font>z1<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">2 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z1<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CRoot <font color="#000080">(</font>z<font color="#000080">,</font>z1<font color="#000080">,</font>k<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex Bessel function:  CI0 = I0(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'I0(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'I0(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CI0 <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Complex Bessel function:  CJ0 = J0(z)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'J0(z)'</font><font color="#000080">:</font><font color="#800000">36</font><font color="#000080">,</font><font color="#800000">'J0(z)'</font><font color="#000080">:</font><font color="#800000">29</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'z'</font><font color="#000080">:</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">'rectangular'</font><font color="#000080">:</font><font color="#800000">27</font><font color="#000080">,</font><font color="#800000">'polar'</font><font color="#000080">:</font><font color="#800000">26</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     ------------  ---------------------------  '</font><font color="#000080">,
    </font><font color="#800000">'-----------------------------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>k <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">21 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>WRITE <font color="#000080">(</font>k<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>a<font color="#000080">[</font>k<font color="#000080">],</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">'  '</font><font color="#000080">);
    </font>CJ0 <font color="#000080">(</font>z<font color="#000080">,</font>a<font color="#000080">[</font>k<font color="#000080">]);
    </font><font color="#FF0000"><b>IF   </b></font>CAbs<font color="#000080">(</font>z<font color="#000080">) &gt; </font><font color="#800000">10.0
    </font><font color="#FF0000"><b>THEN </b></font>m <font color="#000080">:= </font><font color="#800000">7
    </font><font color="#FF0000"><b>ELSE </b></font>m <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
    </font>WRITELN <font color="#000080">(</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>rectangular<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>m<font color="#000080">,</font>polar<font color="#000080">))
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Removing &quot;Fuzz&quot; from real numbers for zero test:'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;  </font><font color="#008000"><i>{Note:  CStr calls CConvert that calls CDefuzz}
  </i></font>CSet <font color="#000080">(</font>z<font color="#000080">, -</font><font color="#800000">3.21E</font><font color="#000080">-</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">7.65E</font><font color="#000080">-</font><font color="#800000">14</font><font color="#000080">, </font>rectangular<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'  Before:  '</font><font color="#000080">,</font>z<font color="#000080">.</font>x<font color="#000080">:</font><font color="#800000">18</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">' +'</font><font color="#000080">,</font>z<font color="#000080">.</font>y<font color="#000080">:</font><font color="#800000">18</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">'i'</font><font color="#000080">);
  </font>CDeFuzz <font color="#000080">(</font>z<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'   After:  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font>rectangular<font color="#000080">));
  </font>WRITELN<font color="#000080">;
  </font>CSet <font color="#000080">(</font>z<font color="#000080">, -</font><font color="#800000">3.21E</font><font color="#000080">-</font><font color="#800000">14</font><font color="#000080">,</font>PI<font color="#000080">, </font>polar<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'  Before:  '</font><font color="#000080">,</font>z<font color="#000080">.</font>r<font color="#000080">:</font><font color="#800000">18</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">'*CIS('</font><font color="#000080">,</font>z<font color="#000080">.</font>theta<font color="#000080">:</font><font color="#800000">18</font><font color="#000080">:</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">);
  </font>CDeFuzz <font color="#000080">(</font>z<font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'   After:  '</font><font color="#000080">,</font>CStr<font color="#000080">(</font>z<font color="#000080">,</font><font color="#800000">18</font><font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font>polar<font color="#000080">));
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Miscellaneous:  FixAngle -- keep angle in interval (-PI..PI)'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'     radians FixAngle'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'    -------- --------'</font><font color="#000080">);
  </font><font color="#FF0000"><b>FOR </b></font>n <font color="#000080">:= -</font><font color="#800000">4 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO BEGIN
    </b></font>x <font color="#000080">:= </font>n<font color="#000080">*</font>PI<font color="#000080">/</font><font color="#800000">2.0</font><font color="#000080">;
    </font>y <font color="#000080">:= </font>FixAngle<font color="#000080">(</font>x<font color="#000080">);
    </font>WRITELN <font color="#000080">(</font>n<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>x<font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,</font>y<font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WRITELN<font color="#000080">;
  </font>WRITELN<font color="#000080">;

  </font>WRITELN <font color="#000080">(</font><font color="#800000">'Real power function:  Pwr = x^y'</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'        x        y         x^y'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">'    -------- -------- ------------'</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2.1</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">,-</font><font color="#800000">2.5</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Pwr<font color="#000080">(</font><font color="#800000">2.1</font><font color="#000080">,-</font><font color="#800000">2.5</font><font color="#000080">):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2.1</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">2.5</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Pwr<font color="#000080">(</font><font color="#800000">2.1</font><font color="#000080">, </font><font color="#800000">2.5</font><font color="#000080">):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">1.4</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">8.9</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Pwr<font color="#000080">(</font><font color="#800000">1.2</font><font color="#000080">, </font><font color="#800000">8.9</font><font color="#000080">):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">0.0</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">2.0</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Pwr<font color="#000080">(</font><font color="#800000">0.0</font><font color="#000080">, </font><font color="#800000">2.0</font><font color="#000080">):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font>WRITELN <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">4.2</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">:</font><font color="#800000">8</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">,</font>Pwr<font color="#000080">(</font><font color="#800000">4.2</font><font color="#000080">, </font><font color="#800000">0.0</font><font color="#000080">):</font><font color="#800000">12</font><font color="#000080">:</font><font color="#800000">9</font><font color="#000080">);
  </font>WRITELN<font color="#000080">;

</font><font color="#FF0000"><b>END </b></font><font color="#008000"><i>{cdemo}</i></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0128.PAS">Original</a><b>]</b></p></body>
</html>
