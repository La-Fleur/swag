<html>
<head><title> "Gaussian Distribution" by DR. JOHN STOCKTON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ From : Dr John Stockton (JRS@merlyn.demon.co.uk)

  Function RandomGaussianSD1 returns a number drawn from
  a Gaussian distribution with mean of zero, unit standard
  deviation, cutoff at +/- 4 ; I have taken it from another,
  working, program.

  It may very easily be amended for any distribution
  whatsoever, provided that the probability density may
  be sufficiently well represented by a known expression
  within a finite rectangular box;
  see RandomDistrib, which is but slightly tested.

  In each case, the probable time taken varies inversely with
  the fraction of the box area which is under the PD line. }


</i></font><font color="#FF0000"><b>program </b></font>Distribs <font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>RandomGaussianSD1 <font color="#000080">: </font>extended
  <font color="#008000"><i>{ Gaussian distribution, SD = 1, cutoff @ +/- 4.0 } </i></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>X <font color="#000080">: </font>extended <font color="#000080">;
</font><font color="#FF0000"><b>begin
  repeat </b></font>X <font color="#000080">:= (</font>Random<font color="#000080">-</font><font color="#800000">0.5</font><font color="#000080">)*</font><font color="#800000">8.0 </font><font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>Exp<font color="#000080">(-</font>Sqr<font color="#000080">(</font>X<font color="#000080">)*</font><font color="#800000">0.5</font><font color="#000080">)&gt;</font>Random <font color="#000080">;
  </font>RandomGaussianSD1 <font color="#000080">:= </font>X <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{RandomGaussianSD1} </i></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GaussTest <font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>j <font color="#000080">: </font>byte <font color="#000080">; </font>s<font color="#000080">, </font>t <font color="#000080">: </font>extended <font color="#000080">; </font><font color="#FF0000"><b>const </b></font>k <font color="#000080">= </font><font color="#800000">80 </font><font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>t <font color="#000080">:= </font><font color="#800000">0.0 </font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>k <font color="#FF0000"><b>do begin
    </b></font>s <font color="#000080">:= </font>RandomGaussianSD1 <font color="#000080">; </font>t <font color="#000080">:= </font>t <font color="#000080">+ </font>Sqr<font color="#000080">(</font>s<font color="#000080">) ;
    </font>Write<font color="#000080">(</font>s<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">) ; </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>j <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln <font color="#000080">;
    </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'RMS: '</font><font color="#000080">, </font>Sqrt<font color="#000080">(</font>t<font color="#000080">/</font>k<font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">'  ~ 1 ?  '</font><font color="#000080">^</font>G<font color="#000080">) ;
  </font>Write<font color="#000080">(</font><font color="#800000">'That should look Gaussian, mean 0, RMS 1 !'</font><font color="#000080">) ;
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{GaussTest} </i></font><font color="#000080">;


</font><font color="#008000"><i>{ The following more general form is less tested but should be OK : }

</i></font><font color="#FF0000"><b>type </b></font>func <font color="#000080">= </font><font color="#FF0000"><b>function </b></font><font color="#000080">(</font>X <font color="#000080">: </font>extended<font color="#000080">) : </font>extended
  <font color="#008000"><i>{ Normalised so that 0.0 &lt;= func &lt;= 1.0 } </i></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RandomDistrib<font color="#000080">(</font>Min<font color="#000080">, </font>Max <font color="#000080">: </font>extended <font color="#000080">; </font>Fn <font color="#000080">: </font>func<font color="#000080">) : </font>extended
  <font color="#008000"><i>{ Fn distribution from Min to Max } </i></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>X <font color="#000080">: </font>extended <font color="#000080">;
</font><font color="#FF0000"><b>begin repeat </b></font>X <font color="#000080">:= </font>Random<font color="#000080">*(</font>Max<font color="#000080">-</font>Min<font color="#000080">) + </font>Min <font color="#FF0000"><b>until </b></font>Fn<font color="#000080">(</font>X<font color="#000080">)&gt;</font>Random <font color="#000080">;
  </font>RandomDistrib <font color="#000080">:= </font>X <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{RandomDistrib} </i></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Gauss<font color="#000080">(</font>X <font color="#000080">: </font>extended<font color="#000080">) : </font>extended <font color="#000080">; </font><font color="#FF0000"><b>FAR </b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>Gauss <font color="#000080">:= </font>Exp<font color="#000080">(-</font>Sqr<font color="#000080">(</font>X<font color="#000080">)*</font><font color="#800000">2.0</font><font color="#000080">) </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{Gauss} </i></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GenTest <font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>j <font color="#000080">: </font>byte <font color="#000080">; </font>s<font color="#000080">, </font>t <font color="#000080">: </font>extended <font color="#000080">; </font><font color="#FF0000"><b>const </b></font>k <font color="#000080">= </font><font color="#800000">80 </font><font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>t <font color="#000080">:= </font><font color="#800000">0.0 </font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>j <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>k <font color="#FF0000"><b>do begin
    </b></font>s <font color="#000080">:= </font>RandomDistrib<font color="#000080">(-</font><font color="#800000">6.0</font><font color="#000080">, +</font><font color="#800000">6.0</font><font color="#000080">, </font>Gauss<font color="#000080">) ; </font>t <font color="#000080">:= </font>t <font color="#000080">+ </font>Sqr<font color="#000080">(</font>s<font color="#000080">) ;
    </font>Write<font color="#000080">(</font>s<font color="#000080">:</font><font color="#800000">9</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">) ; </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>j <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln <font color="#000080">;
    </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'RMS: '</font><font color="#000080">, </font>Sqrt<font color="#000080">(</font>t<font color="#000080">/</font>k<font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">'  ~ 1 ?  '</font><font color="#000080">^</font>G<font color="#000080">) ;
  </font>Write<font color="#000080">(</font><font color="#800000">'That should look Gaussian, mean 0, RMS 0.5 !'</font><font color="#000080">) ;
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{GenTest} </i></font><font color="#000080">;


</font><font color="#FF0000"><b>BEGIN </b></font><font color="#000080">;
</font>Writeln<font color="#000080">(</font><font color="#800000">'Distributions :'</font><font color="#000080">) ;
</font>Randomize <font color="#000080">;
</font>GaussTest <font color="#000080">; </font>Readln <font color="#000080">;
</font>GenTest <font color="#000080">; </font>Readln <font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.  </font>E<font color="#000080">&amp;</font>OE<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p></body>
</html>
