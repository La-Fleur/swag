<html>
<head><title> "Virtual Coords" by JAMIE MORTIMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
You can do a basic horizontal starfeild where all you need is an array of
x,y locations, a routine to draw the stars in the next position, a routine
to remove the old stars, and a routine to update the position array.  Or one
routine to do all that. That gets boring once you write one.  So you want one
you can fly into. Now you need x,y and a z coord.  To get the virtual x,y
screen coords for each point, take their 3d-x coord and divide by the 3d-z
coord, and do the same for the y.  This will give you a real number, and
reals are slow so here's an example of just that math using only integers.
}
  </i></font>X  <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{3d x coord  -maxint to maxint, left to right}
  </i></font>Y  <font color="#000080">: </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{y            &quot;         &quot;    top to bottom}
  </i></font>Z  <font color="#000080">: </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{z   -1..-1023 where '-' is into screen}
  </i></font>xx <font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{2d x coord}
  </i></font>yy <font color="#000080">: </font>integer<font color="#000080">;    </font><font color="#008000"><i>{y}

</i></font>xx<font color="#000080">:=</font>vidwidth <font color="#FF0000"><b>div </b></font><font color="#800000">2  </font><font color="#000080">+ </font>longint<font color="#000080">(</font>x<font color="#000080">)*</font><font color="#800000">1024 </font><font color="#FF0000"><b>div </b></font>z<font color="#000080">;
</font>yy<font color="#000080">:=</font>vidheight <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#000080">+ </font>longint<font color="#000080">(</font>y<font color="#000080">)*</font><font color="#800000">1024 </font><font color="#FF0000"><b>div </b></font>z<font color="#000080">;
</font><font color="#008000"><i>{
That'll give you just plain depth scaling for one star.  For many stars,
just keep an array like this for each of those:
}
  </i></font>X  <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>maxstars<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
</font><font color="#008000"><i>{
You'd basically follow this pattern:
}
 </i></font><font color="#FF0000"><b>for </b></font>t<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>maxstars <font color="#FF0000"><b>do
   begin
     </b></font><font color="#008000"><i>{if star is visible, clear it}
     </i></font><font color="#FF0000"><b>if </b></font>getpixel<font color="#000080">(</font>xx<font color="#000080">[</font>t<font color="#000080">],</font>yy<font color="#000080">[</font>t<font color="#000080">])=</font>starcolor <font color="#FF0000"><b>then
       </b></font>putpixel<font color="#000080">(</font>xx<font color="#000080">[</font>t<font color="#000080">],</font>yy<font color="#000080">[</font>t<font color="#000080">],</font>backgroundcolor<font color="#000080">);
     </font><font color="#008000"><i>{update star position}
     </i></font>whatever math you want<font color="#000080">.  </font>Maybe just<font color="#000080">:
     </font>inc<font color="#000080">(</font>z<font color="#000080">[</font>t<font color="#000080">]);
     </font><font color="#FF0000"><b>if </b></font>z<font color="#000080">&lt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
       begin
         </b></font>x<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">2048</font><font color="#000080">)-</font><font color="#800000">1024</font><font color="#000080">;
         </font>y<font color="#000080">:=</font>random<font color="#000080">(</font><font color="#800000">2048</font><font color="#000080">)-</font><font color="#800000">1024</font><font color="#000080">;
         </font>z<font color="#000080">:=-</font><font color="#800000">1024</font><font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{translate 3d to 2d}
     </i></font>xx<font color="#000080">[</font>tt<font color="#000080">]:= </font><font color="#008000"><i>{etc from above}
     {draw new points}
     </i></font><font color="#FF0000"><b>if </b></font>getpixel<font color="#000080">(</font>xx<font color="#000080">[</font>t<font color="#000080">],</font>yy<font color="#000080">[</font>t<font color="#000080">])=</font>backgroundcolor <font color="#FF0000"><b>then
       </b></font>putpixel<font color="#000080">(</font>xx<font color="#000080">[</font>t<font color="#000080">],</font>yy<font color="#000080">[</font>t<font color="#000080">],</font>starcolor<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
of course this won't compile, but I assume you like to code and so I'm
only giving you a general idea.  Then you can put another variable in, a
for example, which is not an array but just a constant which indicated
the &quot;angle&quot; of rotation around the z axis. (spinning)  it's easy to
implement that into the equation without any 3d math stuff.
}
</i></font>xx<font color="#000080">[</font>tt<font color="#000080">]:=</font>longint<font color="#000080">(</font>x<font color="#000080">[</font>t<font color="#000080">])*</font><font color="#800000">1024 </font><font color="#FF0000"><b>div </b></font>z<font color="#000080">[</font>t<font color="#000080">] * </font>sintable<font color="#000080">[</font>a <font color="#FF0000"><b>mod </b></font><font color="#800000">360</font><font color="#000080">]
        </font><font color="#FF0000"><b>div </b></font><font color="#000080">(</font>sin table precision constant<font color="#000080">, </font>usually <font color="#800000">256</font><font color="#000080">);

</font>yy<font color="#000080">[</font>tt<font color="#000080">]:=</font>longint<font color="#000080">(</font>y<font color="#000080">[</font>t<font color="#000080">])*</font><font color="#800000">1024 </font><font color="#FF0000"><b>div </b></font>z<font color="#000080">[</font>t<font color="#000080">] * </font>costable<font color="#000080">[</font>a <font color="#FF0000"><b>mod </b></font><font color="#800000">360</font><font color="#000080">]
        </font><font color="#FF0000"><b>div </b></font><font color="#800000">256</font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p></body>
</html>
