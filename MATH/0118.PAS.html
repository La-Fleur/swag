<html>
<head><title> "Convert true fractons to floating point" by CLIF PENN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0118.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Below <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>function </b></font>I<font color="#800000">'m using in a program I'</font>m writing<font color="#000080">.  </font>What it will <font color="#FF0000"><b>do is
</b></font>take a given <font color="#FF0000"><b>string in </b></font>the form <font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">2 </font><font color="#FF0000"><b>and </b></font>convert it from a mixed number
into a floating point number<font color="#000080">. (</font>e<font color="#000080">.</font>g<font color="#000080">. </font><font color="#800000">1</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">/</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1.5</font><font color="#000080">)  </font>I was wondering <font color="#FF0000"><b>if </b></font>there
was a better way <font color="#FF0000"><b>to </b></font>implement it than the way I have below<font color="#000080">.  (</font>It<font color="#800000">'s ugly, but
</font>it works<font color="#000080">.)  </font>The <font color="#FF0000"><b>program is </b></font>being written <font color="#FF0000"><b>in </b></font>Delphi <font color="#800000">1.02 </font><font color="#000080">(</font>but <font color="#FF0000"><b>Pascal is
Pascal</b></font><font color="#000080">, </font>no matter how one looks at it<font color="#000080">.  :-)

</font>I<font color="#800000">'d much rather force people to just input a friggin' </font>decimal<font color="#000080">,
</font>unfortunately<font color="#000080">, </font>the databases are old <font color="#FF0000"><b>and </b></font>have already been saved<font color="#000080">.  </font>Anyway<font color="#000080">,
</font>code snippet <font color="#FF0000"><b>to </b></font>follow<font color="#000080">.

 </font><font color="#FF0000"><b>Begin
  function </b></font>FracToFloat<font color="#000080">(</font>Incoming <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>Single<font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>Incoming <font color="#000080">:= </font>Trim<font color="#000080">(</font>Incoming<font color="#000080">);
      </font>i <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">,</font>Incoming<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        try </b></font>Result <font color="#000080">:= </font>StrToFloat<font color="#000080">(</font>Incoming<font color="#000080">);
        </font><font color="#FF0000"><b>except
          on </b></font>EConvertError <font color="#FF0000"><b>do </b></font>Result <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Result <font color="#000080">:= </font>StrToFloat<font color="#000080">(</font>Copy<font color="#000080">(</font>Incoming<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">));
      </font>Incoming <font color="#000080">:= </font>Copy<font color="#000080">(</font>Incoming<font color="#000080">,</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>Incoming<font color="#000080">)-</font>i<font color="#000080">);
      </font>i <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">,</font>Incoming<font color="#000080">);
      </font>Result <font color="#000080">:= </font>Result <font color="#000080">+ </font>StrToInt<font color="#000080">(</font>Copy<font color="#000080">(</font>Incoming<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">))/
</font>		StrToInt<font color="#000080">(</font>Copy<font color="#000080">(</font>Incoming<font color="#000080">,</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>Incoming<font color="#000080">)-</font>i<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End

</b></font>BTW<font color="#000080">, </font>the Trim <font color="#FF0000"><b>function </b></font><font color="#000080">(</font><font color="#FF0000"><b>in </b></font>the first line <font color="#FF0000"><b>of </b></font>the proc body<font color="#000080">) </font><font color="#FF0000"><b>is </b></font>my own
creation <font color="#FF0000"><b>for </b></font>Delphi<font color="#000080">.  </font>It yanks <font color="#FF0000"><b>out </b></font>ALL spaces<font color="#000080">, </font><font color="#FF0000"><b>not </b></font>just leading<font color="#000080">/</font>trailing<font color="#000080">.

</font><font color="#FF0000"><b>Program </b></font>FractionalStrings<font color="#000080">;
</font><font color="#008000"><i>{ written in Turbo v.6.0  &lt;clifpenn@airmail.net&gt;  Nov 3, 1996
  Accepts string input of the form 5-3/4 and converts to a floating
  point number. However, '  ab  cd.xx5nmjk---3   xxx///cc  4  ***'
will be cleaned up to show 5-3/4 = 5.75000, also. Will not convert
negative numbers as written but is trivial to change. }

</i></font><font color="#FF0000"><b>VAR
</b></font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font>p1<font color="#000080">, </font>p2<font color="#000080">:</font>Byte<font color="#000080">;
</font>proper<font color="#000080">:</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FracToFloat<font color="#000080">(</font>Incoming<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Single<font color="#000080">;
</font><font color="#FF0000"><b>VAR
      </b></font>frag<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
      </font>NumVal<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
      </font>p<font color="#000080">, </font>indx<font color="#000080">:</font>Byte<font color="#000080">;
      </font>code<font color="#000080">:</font>Integer<font color="#000080">;  </font><font color="#008000"><i>(* required for VAL *)
                     (* may be used for error checking *)
</i></font><font color="#FF0000"><b>Begin
     </b></font>Incoming <font color="#000080">:= </font>Incoming <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;   </font><font color="#008000"><i>(* for convenience *)
     (* remove non-numeric leading chars including spaces *)
     </i></font><font color="#FF0000"><b>While Not </b></font><font color="#000080">(</font>Incoming<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>Do
           </b></font>Delete<font color="#000080">(</font>Incoming<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

     </font>p <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>indx <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>Do
     Begin
          </b></font>frag<font color="#000080">[</font>indx<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
          </font><font color="#FF0000"><b>While </b></font>Incoming<font color="#000080">[</font>p<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">] </font><font color="#FF0000"><b>do
          Begin
               </b></font>frag<font color="#000080">[</font>indx<font color="#000080">] := </font>frag<font color="#000080">[</font>indx<font color="#000080">] + </font>Incoming<font color="#000080">[</font>p<font color="#000080">];
               </font>Inc<font color="#000080">(</font>p<font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>VAL<font color="#000080">(</font>frag<font color="#000080">[</font>indx<font color="#000080">], </font>NumVal<font color="#000080">[</font>indx<font color="#000080">], </font>code<font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>indx <font color="#000080">&lt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>(* skip non-numeric *)
              </i></font><font color="#FF0000"><b>While Not</b></font><font color="#000080">(</font>Incoming<font color="#000080">[</font>p<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>p<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#008000"><i>(* show cleaned input *)
     </i></font>Write<font color="#000080">(</font>frag<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">'-'</font><font color="#000080">, </font>frag<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font><font color="#800000">'/'</font><font color="#000080">, </font>frag<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font><font color="#800000">' = ' </font><font color="#000080">);
     </font>FracToFloat <font color="#000080">:= </font>NumVal<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] + </font>NumVal<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] / </font>NumVal<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">; </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Just press &lt;Enter&gt; to quit'</font><font color="#000080">);
</font><font color="#FF0000"><b>Repeat

     Repeat
           </b></font>Writeln<font color="#000080">;
           </font>Write<font color="#000080">(</font><font color="#800000">'Enter a mixed fraction such as 5-3/4: '</font><font color="#000080">);
           </font>Readln<font color="#000080">(</font>s<font color="#000080">);
           </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
           </font>p1 <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'-'</font><font color="#000080">, </font>s<font color="#000080">);
           </font>p2 <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>s<font color="#000080">);
           </font>proper <font color="#000080">:= (</font>p1 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>p2 <font color="#000080">&gt; </font>p1<font color="#000080">);
           </font><font color="#FF0000"><b>If not </b></font>proper <font color="#FF0000"><b>then </b></font>Write<font color="#000080">(</font>Chr<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">));  </font><font color="#008000"><i>(* beep *)
     </i></font><font color="#FF0000"><b>Until </b></font>proper<font color="#000080">;

     </font>Writeln<font color="#000080">(</font>FracToFloat<font color="#000080">(</font>s<font color="#000080">):</font><font color="#800000">10</font><font color="#000080">:</font><font color="#800000">5</font><font color="#000080">);
</font><font color="#FF0000"><b>Until </b></font>Length<font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MATH SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0118.PAS">Original</a><b>]</b></p></body>
</html>
