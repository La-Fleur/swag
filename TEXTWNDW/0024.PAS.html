<html>
<head><title> "Advanced Text Screen handling" by RICK HAINES</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{Here is a unit I wrote for a text game I'm working on... I'd like to know what
everybody thinks about it... All of the drawing routines use a small virtual
page, and some of them don't draw it to the real screen.  You can do that
yourself using DisplayScreen.  I'm gonna squash out a bunch of blank lines to
save space...
{ *********************************************************** }
{ ************************ Text Unit ************************ }
{ *********************************************************** }
{ ***************** Written by: Rick Haines ***************** }
{ ******************Snail-Mail: 1004 N. Alabama Ave. ******** }
{ ***************************** DeLand, FL 32724 ************ }
{ ***************** E-Mail: Keiichi@Dynasty.doi.com ********* }
{ *********************************************************** }
{ ****************** Last Revised 10/03/95 ****************** }
{ *********************************************************** }
{ ************** Copyright (C) 1995 Rick Haines ************* }
{ *********************************************************** }
{ ******** You may use this code in any way you wish ******** }
{ * I only &quot;request&quot; that you give me credit for writing it * }
{ *********************************************************** }

{$IfDef Debug }
 {$A+,B-,D+,E-,F-,G-,I+,L+,N-,O-,P-,Q+,R+,S+,T-,V+,X+,Y+}
{$Else}
 {$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S-,T-,V+,X+,Y-}
{$EndIf}

</i></font><font color="#FF0000"><b>Unit </b></font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Const
 </b></font>ScrlL <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
 </font>NumL  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
 </font>CapsL <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
</font><font color="#FF0000"><b>Const
 </b></font>Black   <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
 </font>Blue    <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
 </font>Green   <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
 </font>Cyan    <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
 </font>Red     <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
 </font>Violet  <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
 </font>Orange  <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
 </font>Gray    <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
 </font>LGray   <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
 </font>LBlue   <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
 </font>LGreen  <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
 </font>LCyan   <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
 </font>LRed    <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
 </font>LViolet <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
 </font>Yellow  <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
 </font>White   <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;
 </font>Blink   <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;
</font><font color="#FF0000"><b>Type
 </b></font>TBoxDef <font color="#000080">= </font><font color="#FF0000"><b>Record
   </b></font>VLine<font color="#000080">, </font>HLine<font color="#000080">,
   </font>X1Y1<font color="#000080">, </font>X1Y2<font color="#000080">,
   </font>X2Y1<font color="#000080">, </font>X2Y2<font color="#000080">: </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const
 </b></font>SingleLine<font color="#000080">: </font>TBoxDef <font color="#000080">=
  (</font>VLine<font color="#000080">:</font><font color="#800000">#179</font><font color="#000080">; </font>HLine<font color="#000080">:</font><font color="#800000">#196</font><font color="#000080">;
   </font>X1Y1<font color="#000080">:</font><font color="#800000">#218</font><font color="#000080">; </font>X1Y2<font color="#000080">:</font><font color="#800000">#192</font><font color="#000080">;
   </font>X2Y1<font color="#000080">:</font><font color="#800000">#191</font><font color="#000080">; </font>X2Y2<font color="#000080">:</font><font color="#800000">#217</font><font color="#000080">);
 </font>DoubleLine<font color="#000080">: </font>TBoxDef <font color="#000080">=
  (</font>VLine<font color="#000080">:</font><font color="#800000">#186</font><font color="#000080">; </font>HLine<font color="#000080">:</font><font color="#800000">#205</font><font color="#000080">;
   </font>X1Y1<font color="#000080">:</font><font color="#800000">#201</font><font color="#000080">; </font>X1Y2<font color="#000080">:</font><font color="#800000">#200</font><font color="#000080">;
   </font>X2Y1<font color="#000080">:</font><font color="#800000">#187</font><font color="#000080">; </font>X2Y2<font color="#000080">:</font><font color="#800000">#188</font><font color="#000080">);
 </font>SingleTop<font color="#000080">: </font>TBoxDef <font color="#000080">=
  (</font>VLine<font color="#000080">:</font><font color="#800000">#186</font><font color="#000080">; </font>HLine<font color="#000080">:</font><font color="#800000">#196</font><font color="#000080">;
   </font>X1Y1<font color="#000080">:</font><font color="#800000">#214</font><font color="#000080">; </font>X1Y2<font color="#000080">:</font><font color="#800000">#211</font><font color="#000080">;
   </font>X2Y1<font color="#000080">:</font><font color="#800000">#183</font><font color="#000080">; </font>X2Y2<font color="#000080">:</font><font color="#800000">#189</font><font color="#000080">);
 </font>DoubleTop<font color="#000080">: </font>TBoxDef <font color="#000080">=
  (</font>VLine<font color="#000080">:</font><font color="#800000">#179</font><font color="#000080">; </font>HLine<font color="#000080">:</font><font color="#800000">#205</font><font color="#000080">;
   </font>X1Y1<font color="#000080">:</font><font color="#800000">#213</font><font color="#000080">; </font>X1Y2<font color="#000080">:</font><font color="#800000">#212</font><font color="#000080">;
   </font>X2Y1<font color="#000080">:</font><font color="#800000">#184</font><font color="#000080">; </font>X2Y2<font color="#000080">:</font><font color="#800000">#190</font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>KeyBReset<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>KeyBEnable<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>KeyBDisable<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetLeds<font color="#000080">(</font>Leds<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ClearLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ToggleLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ClearKeyBuf<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetKey<font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ReadKey<font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PutKey<font color="#000080">(</font>Key<font color="#000080">: </font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GetScanCode<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ReadScanCode<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>KeyPressed<font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DisplayScreen<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearScreen<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearArea<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>SetColor<font color="#000080">(</font>Color<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetBGColor<font color="#000080">(</font>Color<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>WriteCharXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>WriteStrXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">; </font>TextStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>TWrite<font color="#000080">(</font>AString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>TWriteln<font color="#000080">(</font>AString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SDown<font color="#000080">(</font>NumOfLines<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>GetX<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetY<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>DrawHLine<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Length<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>DrawVLine<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Length<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>DrawBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>OpenBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>CloseBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>SaveScreen<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>LoadScreen<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Var
 </b></font>ExitSave<font color="#000080">,
 </font>Screen<font color="#000080">: </font>Pointer<font color="#000080">;
 </font>TextSeg<font color="#000080">: </font>Word<font color="#000080">;
 </font>CursorX<font color="#000080">,
 </font>CursorY<font color="#000080">: </font>Byte<font color="#000080">;
 </font>TextColor<font color="#000080">,
 </font>LastMode<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Const
 </b></font>VRTPort <font color="#000080">= </font><font color="#800000">$03DA</font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ScrollUp<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">ClD
  Push ds
  Les di, Screen
  Lds si, Screen
  Add si, 160
  Mov cx, 2000-80
  Rep MovSW
  Mov ax, 0
  Mov cx, 80
  Rep StoSW
  Pop ds
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ScrollDown<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">StD
  Push ds
  Les di, Screen
  Lds si, Screen
  Add di, 4000
  Add si, 4000-160
  Mov cx, 2000-79
  Rep MovSW
  Mov ax, 0
  Mov cx, 80
  Rep StoSW
  Pop ds
  ClD
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>H_CursorXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov dh, Y
  Mov dl, X
  Mov ah, 02h
  Xor bh, bh
  Int 10h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>KeyBReset<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov dx, 60h
  Mov al, 0FFh
  Out dx, al
  Jmp @@Delay
 @@Delay:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>KeyBEnable<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov dx, 60h
  Mov al, 0F4h
  Out dx, al
  Jmp @@Delay
 @@Delay:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>KeyBDisable<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov dx, 60h
  Mov al, 0F5h
  Out dx, al
  Jmp @@Delay
 @@Delay:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetLeds<font color="#000080">(</font>Leds<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov dx, 60h
  Mov al, 0EDh
  Out dx, al
  Jmp @@LightLeds
 @@LightLeds:
  Mov al, Leds
  Out dx, al
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 40h
  Mov es, ax
  Mov bx, 17h
  Mov ah, es:[bx]
  Mov al, Locks
  Mov cl, 4
  ShL al, cl
  Or ah, al
  Mov es:[bx], ah
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 40h
  Mov es, ax
  Mov bx, 17h
  Mov ah, es:[bx]
  Mov al, Locks
  Mov cl, 4
  ShL al, cl
  Not al
  And ah, al
  Mov es:[bx], ah
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ToggleLocks<font color="#000080">(</font>Locks<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 40h
  Mov es, ax
  Mov bx, 17h
  Mov ah, es:[bx]
  Mov al, Locks
  Mov cl, 4
  ShL al, cl
  Xor ah, al
  Mov es:[bx], ah
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearKeyBuf<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 0C02h
  Int 21h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetKey<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 1
  Int 16h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>ReadKey<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 0
  Int 16h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>PutKey<font color="#000080">(</font>Key<font color="#000080">: </font>Char<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 05h
  Mov cl, Key
  Xor ch, ch
  Int 16h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetScanCode<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 1
  Int 16h
  Mov al, ah
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>ReadScanCode<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 0
  Int 16h
  Mov al, ah
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>KeyPressed<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 01
  Int 16h
  JNZ @@Key
  Xor ax, ax
  Jmp @@Done
 @@Key:
  Mov ax, 01h
 @@Done:
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 01h
  Mov cx, 2000h
  Int 10h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ah, 01h
  Mov cx, 0607h
  Int 10h
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DisplayScreen<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">ClD
  Push ds
  Mov di, TextSeg
  Mov es, di
  Xor di, di
  Lds si, Screen
  Mov cx, 2000
</font><font color="#008000"><i>{ Wait for Vertical Retrace (So we don't shear) }
  </i></font><font color="#FF00FF">Mov  dx, VRTPort
 @@VRT:
  In al, dx
  Test al, 8
  JNZ @@VRT   </font><font color="#008000"><i>{ If VRT in progress, wait for it to stop }
 </i></font><font color="#FF00FF">@@NoVRT:
  In al, dx
  Test al, 8
  JZ @@NoVRT  </font><font color="#008000"><i>{ Wait for next VRT }
{ Copy the Screen }
  </i></font><font color="#FF00FF">Rep MovSW
  Pop ds
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearScreen<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">ClD
  Les di, Screen
  Xor ax, ax
  Mov ah, TextColor
  Mov cx, 2000
  Rep StoSW
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>ClearArea<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">ClD
  Les di, Screen
</font><font color="#008000"><i>{ Get Offset in Video Mem }
  </i></font><font color="#FF00FF">Xor ax, ax   </font><font color="#008000"><i>{ Offset = (Y * 180) + (X * 2) }
  </i></font><font color="#FF00FF">Mov al, Y1
  Mov cl, 7
  ShL ax, cl   </font><font color="#008000"><i>{ = (Y * 128) }
  </i></font><font color="#FF00FF">Mov bx, ax
  ShR ax, 1    </font><font color="#008000"><i>{ + (Y *  32) }
  </i></font><font color="#FF00FF">ShR ax, 1
  Add ax, bx
  Xor bx, bx
  Mov bl, X1
  ShL bx, 1    </font><font color="#008000"><i>{ + (X * 2) }
  </i></font><font color="#FF00FF">Add ax, bx
  Add di, ax
</font><font color="#008000"><i>{ Get X and Y Lengths }
  </i></font><font color="#FF00FF">Mov bl, X2
  Sub bl, X1
  Mov bh, Y2
  Sub bh, Y1
  Add bx, 0101h
</font><font color="#008000"><i>{ Get # to add for next line }
  </i></font><font color="#FF00FF">Xor dx, dx
  Mov dl, 80
  Sub dl, bl
  ShL dl, 1
</font><font color="#008000"><i>{ Clear Area }
  </i></font><font color="#FF00FF">Xor cx, cx
  Xor ax, ax
  Mov ah, TextColor
 @@YLoop:
  Mov cl, bl
  Rep StoSW
  Add di, dx
  Dec bh
  JNZ @@YLoop
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetColor<font color="#000080">(</font>Color<font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Begin
  </b></font>TextColor <font color="#000080">:= (</font>TextColor <font color="#FF0000"><b>And </b></font><font color="#800000">$70</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font>Color<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetBGColor<font color="#000080">(</font>Color<font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Begin
  If </b></font>Color <font color="#000080">&gt; </font><font color="#800000">8 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
  </font>TextColor <font color="#000080">:= (</font>TextColor <font color="#FF0000"><b>And </b></font><font color="#800000">$8F</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Color <font color="#FF0000"><b>ShL </b></font><font color="#800000">4</font><font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WriteCharXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Les di, Screen
</font><font color="#008000"><i>{ Get Offset in Video Mem }
  </i></font><font color="#FF00FF">Xor ax, ax   </font><font color="#008000"><i>{ Offset = (Y * 180) + (X * 2) }
  </i></font><font color="#FF00FF">Mov al, Y
  Mov cl, 7
  ShL ax, cl   </font><font color="#008000"><i>{ = (Y * 128) }
  </i></font><font color="#FF00FF">Mov bx, ax
  ShR ax, 1    </font><font color="#008000"><i>{ + (Y *  32) }
  </i></font><font color="#FF00FF">ShR ax, 1
  Add ax, bx
  Xor bx, bx
  Mov bl, X
  ShL bx, 1    </font><font color="#008000"><i>{ + (X * 2) }
  </i></font><font color="#FF00FF">Add ax, bx
  Add di, ax
</font><font color="#008000"><i>{ Write String }
  </i></font><font color="#FF00FF">Mov ah, TextColor     </font><font color="#008000"><i>{ ah = TextColor, al = Char }
  </i></font><font color="#FF00FF">Mov al, AChar
  Mov es:[di], ax
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>WriteStrXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">; </font>TextStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Les di, Screen
</font><font color="#008000"><i>{ Get Offset in Video Mem }
  </i></font><font color="#FF00FF">Xor ax, ax   </font><font color="#008000"><i>{ Offset = (Y * 180) + (X * 2) }
  </i></font><font color="#FF00FF">Mov al, Y
  Mov cl, 7
  ShL ax, cl   </font><font color="#008000"><i>{ = (Y * 128) }
  </i></font><font color="#FF00FF">Mov bx, ax
  ShR ax, 1    </font><font color="#008000"><i>{ + (Y *  32) }
  </i></font><font color="#FF00FF">ShR ax, 1
  Add ax, bx
  Xor bx, bx
  Mov bl, X
  ShL bx, 1    </font><font color="#008000"><i>{ + (X * 2) }
  </i></font><font color="#FF00FF">Add ax, bx
  Add di, ax
</font><font color="#008000"><i>{ Write String }
  </i></font><font color="#FF00FF">Push ds
  Mov ah, TextColor     </font><font color="#008000"><i>{ ah = TextColor, al = Char }
  </i></font><font color="#FF00FF">Lds si, TextStr       </font><font color="#008000"><i>{ will be reversed when written to mem }
  </i></font><font color="#FF00FF">Xor cx, cx
  Mov cl, [si]
  Inc si
 @@Repeat:
  Mov al, [si]
  Mov es:[di], ax
  Add di, 2
  Inc si
  Dec cl
  JNZ @@Repeat
  Mov al, 32
  Mov es:[di], ax
  Pop ds
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>TWrite<font color="#000080">(</font>AString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Begin
  If </b></font>CursorY <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>Then
   Begin
    </b></font>ScrollUp<font color="#000080">;
    </font>Dec<font color="#000080">(</font>CursorY<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>AString<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>WriteStrXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">, </font>AString<font color="#000080">);
  </font>Inc<font color="#000080">(</font>CursorX<font color="#000080">, </font>Length<font color="#000080">(</font>AString<font color="#000080">));
  </font><font color="#FF0000"><b>While </b></font>CursorX <font color="#000080">&gt; </font><font color="#800000">79 </font><font color="#FF0000"><b>Do
   Begin
    </b></font>Dec<font color="#000080">(</font>CursorX<font color="#000080">, </font><font color="#800000">80</font><font color="#000080">);
    </font>Inc<font color="#000080">(</font>CursorY<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>CursorY <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>Then
     Begin
      </b></font>ScrollUp<font color="#000080">;
      </font>Dec<font color="#000080">(</font>CursorY<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>H_CursorXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">);
  </font>DisplayScreen<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>TWriteln<font color="#000080">(</font>AString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Begin
  If </b></font>CursorY <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>Then
   Begin
    </b></font>ScrollUp<font color="#000080">;
    </font>Dec<font color="#000080">(</font>CursorY<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>AString<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>WriteStrXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">, </font>AString<font color="#000080">);
  </font>Inc<font color="#000080">(</font>CursorX<font color="#000080">, </font>Length<font color="#000080">(</font>AString<font color="#000080">));
  </font><font color="#FF0000"><b>While </b></font>CursorX <font color="#000080">&gt; </font><font color="#800000">79 </font><font color="#FF0000"><b>Do
   Begin
    </b></font>Dec<font color="#000080">(</font>CursorX<font color="#000080">, </font><font color="#800000">80</font><font color="#000080">);
    </font>Inc<font color="#000080">(</font>CursorY<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>CursorY <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>Then
     Begin
      </b></font>ScrollUp<font color="#000080">;
      </font>Dec<font color="#000080">(</font>CursorY<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Inc<font color="#000080">(</font>CursorY<font color="#000080">);
  </font>CursorX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>H_CursorXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">);
  </font>DisplayScreen<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SDown<font color="#000080">(</font>NumOfLines<font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>NumOfLines <font color="#FF0000"><b>Do
   Begin
    </b></font>Inc<font color="#000080">(</font>CursorY<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>CursorY <font color="#000080">&gt; </font><font color="#800000">24 </font><font color="#FF0000"><b>Then
     Begin
      </b></font>ScrollUp<font color="#000080">;
      </font>Dec<font color="#000080">(</font>CursorY<font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>H_CursorXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">);
    </font>DisplayScreen<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetX<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>GetX <font color="#000080">:= </font>CursorX<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetY<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>GetY <font color="#000080">:= </font>CursorY<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CursorXY<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">);
 </font><font color="#FF0000"><b>Begin
  </b></font>CursorX <font color="#000080">:= </font>X<font color="#000080">; </font>CursorY <font color="#000080">:= </font>Y<font color="#000080">;
  </font>H_CursorXY<font color="#000080">(</font>CursorX<font color="#000080">, </font>CursorY<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DrawHLine<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Length<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">ClD
  Les di, Screen
</font><font color="#008000"><i>{ Get Offset in Video Mem }
  </i></font><font color="#FF00FF">Xor ax, ax   </font><font color="#008000"><i>{ Offset = (Y * 180) + (X * 2) }
  </i></font><font color="#FF00FF">Mov al, Y
  Mov cl, 7
  ShL ax, cl   </font><font color="#008000"><i>{ = (Y * 128) }
  </i></font><font color="#FF00FF">Mov bx, ax
  ShR ax, 1    </font><font color="#008000"><i>{ + (Y *  32) }
  </i></font><font color="#FF00FF">ShR ax, 1
  Add ax, bx
  Xor bx, bx
  Mov bl, X
  ShL bx, 1    </font><font color="#008000"><i>{ + (X * 2) }
  </i></font><font color="#FF00FF">Add ax, bx
  Add di, ax
</font><font color="#008000"><i>{ Draw Line }
  </i></font><font color="#FF00FF">Mov ah, TextColor
  Mov al, AChar
  Xor cx, cx
  Mov cl, Length
  Rep StoSW
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DrawVLine<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Length<font color="#000080">: </font>Byte<font color="#000080">; </font>AChar<font color="#000080">: </font>Char<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
</b></font><font color="#008000"><i>{ Get Offset in Video Mem }
  </i></font><font color="#FF00FF">Xor ax, ax   </font><font color="#008000"><i>{ Offset = (Y * 180) + (X * 2) }
  </i></font><font color="#FF00FF">Mov al, Y
  Mov cl, 7
  ShL ax, cl   </font><font color="#008000"><i>{ = (Y * 128) }
  </i></font><font color="#FF00FF">Mov bx, ax
  ShR ax, 1    </font><font color="#008000"><i>{ + (Y *  32) }
  </i></font><font color="#FF00FF">ShR ax, 1
  Add ax, bx
  Xor bx, bx
  Mov bl, X
  ShL bx, 1    </font><font color="#008000"><i>{ + (X * 2) }
  </i></font><font color="#FF00FF">Add bx, ax
</font><font color="#008000"><i>{ Draw Line }
  </i></font><font color="#FF00FF">Mov ah, TextColor
  Mov al, AChar
  Mov cl, Length
  Push ds
  Lds di, Screen
  Add di, bx
 @@YLoop:
  Mov [di], ax
  Add di, 160    </font><font color="#008000"><i>{ Bytes per Text Line }
  </i></font><font color="#FF00FF">Dec cl
  JNZ @@YLoop
  Pop ds
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DrawBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>XLen<font color="#000080">, </font>YLen<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>XLen <font color="#000080">:= </font>X2 <font color="#000080">- </font>X1<font color="#000080">; </font>YLen <font color="#000080">:= </font>Y2 <font color="#000080">- </font>Y1<font color="#000080">;
  </font><font color="#FF0000"><b>With </b></font>Border <font color="#FF0000"><b>Do
   Begin
    </b></font>ClearArea<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
    </font>DrawHLine<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>XLen<font color="#000080">, </font>HLine<font color="#000080">);
    </font>DrawHLine<font color="#000080">(</font>X1<font color="#000080">, </font>Y2<font color="#000080">, </font>XLen<font color="#000080">, </font>HLine<font color="#000080">);
    </font>DrawVLine<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>YLen<font color="#000080">, </font>VLine<font color="#000080">);
    </font>DrawVLine<font color="#000080">(</font>X2<font color="#000080">, </font>Y1<font color="#000080">, </font>YLen<font color="#000080">, </font>VLine<font color="#000080">);
    </font>WriteCharXY<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X1Y1<font color="#000080">);
    </font>WriteCharXY<font color="#000080">(</font>X1<font color="#000080">, </font>Y2<font color="#000080">, </font>X1Y2<font color="#000080">);
    </font>WriteCharXY<font color="#000080">(</font>X2<font color="#000080">, </font>Y1<font color="#000080">, </font>X2Y1<font color="#000080">);
    </font>WriteCharXY<font color="#000080">(</font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>X2Y2<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>OpenBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>XLen<font color="#000080">, </font>YLen<font color="#000080">: </font>Byte<font color="#000080">;
  </font>I<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>XLen <font color="#000080">:= </font>X2 <font color="#000080">- </font>X1<font color="#000080">; </font>YLen <font color="#000080">:= </font>Y2 <font color="#000080">- </font>Y1<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= (</font>XLen<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">0 </font><font color="#FF0000"><b>Do
   Begin
    </b></font>DrawBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">-</font>I<font color="#000080">, </font>Y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>Border<font color="#000080">);
    </font>DisplayScreen<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= (</font>YLen<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DownTo </b></font><font color="#800000">0 </font><font color="#FF0000"><b>Do
   Begin
    </b></font>DrawBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">-</font>I<font color="#000080">, </font>Border<font color="#000080">);
    </font>DisplayScreen<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>CloseBox<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">: </font>Byte<font color="#000080">; </font>Border<font color="#000080">: </font>TBoxDef<font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>XLen<font color="#000080">, </font>YLen<font color="#000080">: </font>Byte<font color="#000080">;
  </font>I<font color="#000080">, </font>Temp<font color="#000080">: </font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>XLen <font color="#000080">:= </font>X2 <font color="#000080">- </font>X1<font color="#000080">; </font>YLen <font color="#000080">:= </font>Y2 <font color="#000080">- </font>Y1<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>XLen<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
   Begin
    </b></font>Temp <font color="#000080">:= </font>TextColor<font color="#000080">;
    </font>SetBGColor<font color="#000080">(</font>Black<font color="#000080">);
    </font>ClearArea<font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
    </font>TextColor <font color="#000080">:= </font>Temp<font color="#000080">;
    </font>DrawBox<font color="#000080">(</font>X1<font color="#000080">+</font>I<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>Border<font color="#000080">);
    </font>DisplayScreen<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#000080">(</font>YLen<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Do
   Begin
    </b></font>Temp <font color="#000080">:= </font>TextColor<font color="#000080">;
    </font>SetBGColor<font color="#000080">(</font>Black<font color="#000080">);
    </font>ClearArea<font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
    </font>TextColor <font color="#000080">:= </font>Temp<font color="#000080">;
    </font>DrawBox<font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>Y1<font color="#000080">+</font>I<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>Border<font color="#000080">);
    </font>DisplayScreen<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Temp <font color="#000080">:= </font>TextColor<font color="#000080">;
  </font>SetBGColor<font color="#000080">(</font>Black<font color="#000080">);
  </font>ClearArea<font color="#000080">(</font>X2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>Y2<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
  </font>TextColor <font color="#000080">:= </font>Temp<font color="#000080">;
  </font>DisplayScreen
 <font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SaveScreen<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>FileN<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  If </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Name<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Assign<font color="#000080">(</font>FileN<font color="#000080">, </font>Name <font color="#000080">+ </font><font color="#800000">'.SCR'</font><font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>FileN<font color="#000080">);               </font><font color="#008000"><i>{ 128 * 32 = 4096 }
  </i></font>BlockWrite<font color="#000080">(</font>FileN<font color="#000080">, </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Screen<font color="#000080">):</font>Ofs<font color="#000080">(</font>Screen<font color="#000080">)], </font><font color="#800000">32</font><font color="#000080">);
  </font>Close<font color="#000080">(</font>FileN<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LoadScreen<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>Var
  </b></font>FileN<font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  If </b></font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">, </font>Name<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Assign<font color="#000080">(</font>FileN<font color="#000080">, </font>Name <font color="#000080">+ </font><font color="#800000">'.SCR'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>FileN<font color="#000080">);                 </font><font color="#008000"><i>{ 128 * 32 = 4096 }
  </i></font>BlockRead<font color="#000080">(</font>FileN<font color="#000080">, </font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>Screen<font color="#000080">):</font>Ofs<font color="#000080">(</font>Screen<font color="#000080">)], </font><font color="#800000">32</font><font color="#000080">);
  </font>Close<font color="#000080">(</font>FileN<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>SetMode<font color="#000080">(</font>Mode<font color="#000080">: </font>Word<font color="#000080">): </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov ax, 0F00h
  Int 10h
  Push ax
  Mov ax, Mode
  Int 10h
  Pop ax
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>TextExit<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>Begin
  </b></font>ExitProc <font color="#000080">:= </font>ExitSave<font color="#000080">;
  </font>FreeMem<font color="#000080">(</font>Screen<font color="#000080">, </font><font color="#800000">4096</font><font color="#000080">);
  </font>SetMode<font color="#000080">(</font>LastMode<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
 </b></font>KeyBReset<font color="#000080">;
 </font>GetMem<font color="#000080">(</font>Screen<font color="#000080">, </font><font color="#800000">4096</font><font color="#000080">);
 </font>ExitSave <font color="#000080">:= </font>ExitProc<font color="#000080">;
 </font>ExitProc <font color="#000080">:= @</font>TextExit<font color="#000080">;
 </font>LastMode <font color="#000080">:= </font>SetMode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
 </font>TextSeg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;
 </font>CursorX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>CursorY <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>SetBGColor<font color="#000080">(</font>Black<font color="#000080">);
 </font>SetColor<font color="#000080">(</font>LGray<font color="#000080">);
 </font>ClearScreen<font color="#000080">;
 </font>DisplayScreen<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
