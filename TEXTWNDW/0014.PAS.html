<html>
<head><title> "Complete WINDOW unit" by GRANT BEATTIE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Win<font color="#000080">; </font><font color="#008000"><i>{ Win.Pas }

{$S-}{$I-}{$R-}

</i></font><font color="#FF0000"><b>INTERFACE

USES </b></font>Crt<font color="#000080">, </font>Cursor<font color="#000080">, </font>FadeUnit<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>PTitleStr <font color="#000080">= ^</font>TitleStr<font color="#000080">;
  </font>TitleStr <font color="#000080">= </font><font color="#FF0000"><b>STRING </b></font><font color="#000080">[</font><font color="#800000">63</font><font color="#000080">];

  </font>PFrame <font color="#000080">= ^</font>TFrame<font color="#000080">;
  </font>TFrame <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;

  </font>TVertFrameChars <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>CHAR<font color="#000080">;

  </font><font color="#008000"><i>{ Text color attr type }

  </i></font>PTextAttr <font color="#000080">= ^</font>TTextAttr<font color="#000080">;
  </font>TTextAttr <font color="#000080">= </font>BYTE<font color="#000080">;

  </font><font color="#008000"><i>{ Window rectangle type }

  </i></font>PRect <font color="#000080">= ^</font>TRect<font color="#000080">;
  </font>TRect <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom <font color="#000080">: </font>BYTE
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>PWinState <font color="#000080">= ^</font>TWinState<font color="#000080">;
  </font>TWinState <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>WindMin<font color="#000080">,
    </font>WindMax <font color="#000080">: </font>WORD<font color="#000080">;
    </font>WHEREX<font color="#000080">,
    </font>WHEREY <font color="#000080">: </font>BYTE<font color="#000080">;
    </font>TextAttr <font color="#000080">: </font>TTextAttr
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>PWinRec <font color="#000080">= ^</font>TWinRec<font color="#000080">;
  </font>TWinRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>Next <font color="#000080">: </font>PWinRec<font color="#000080">;
    </font>State <font color="#000080">: </font>TWinState<font color="#000080">;
    </font>Title <font color="#000080">: </font>PTitleStr<font color="#000080">;
    </font>TitleColor<font color="#000080">,
    </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">;
    </font>Size <font color="#000080">: </font>WORD<font color="#000080">;
    </font>Buffer <font color="#000080">: </font>POINTER
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>PWindowStruct <font color="#000080">= ^</font>TWindowStruct<font color="#000080">;
  </font>TWindowStruct <font color="#000080">= </font><font color="#FF0000"><b>RECORD
    </b></font>Rect <font color="#000080">: </font>TRect<font color="#000080">;
    </font>TitleColor<font color="#000080">,
    </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">;
    </font>Title <font color="#000080">: </font>TitleStr
  <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>None <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">;

  </font>VertFrame   <font color="#000080">: </font>TVertFrameChars <font color="#000080">= </font><font color="#800000">'&sup3;&ordm;&Ucirc;'</font><font color="#000080">;

  </font><font color="#008000"><i>{ Display combination codes returned by the GetDisplay function }

  </i></font>gdNoDisplay <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">; </font><font color="#008000"><i>{ No display }
  </i></font>gdMono      <font color="#000080">= </font><font color="#800000">$01</font><font color="#000080">; </font><font color="#008000"><i>{ Monochrome adapter w/ monochrome display }
  </i></font>gdCGA       <font color="#000080">= </font><font color="#800000">$02</font><font color="#000080">; </font><font color="#008000"><i>{ CGA w/ color display }
  </i></font>gdEGA       <font color="#000080">= </font><font color="#800000">$04</font><font color="#000080">; </font><font color="#008000"><i>{ EGA w/ color display }
  </i></font>gdEGAMono   <font color="#000080">= </font><font color="#800000">$05</font><font color="#000080">; </font><font color="#008000"><i>{ EGA w/ monochrome display }
  </i></font>gdPGA       <font color="#000080">= </font><font color="#800000">$06</font><font color="#000080">; </font><font color="#008000"><i>{ PGA w/ color display }
  </i></font>gdVGAMono   <font color="#000080">= </font><font color="#800000">$07</font><font color="#000080">; </font><font color="#008000"><i>{ VGA w/ monochrome analog display }
  </i></font>gdVGA       <font color="#000080">= </font><font color="#800000">$08</font><font color="#000080">; </font><font color="#008000"><i>{ VGA w/ color analog display }
  </i></font>gdMCGADig   <font color="#000080">= </font><font color="#800000">$0A</font><font color="#000080">; </font><font color="#008000"><i>{ MCGA w/ digital color display }
  </i></font>gdMCGAMono  <font color="#000080">= </font><font color="#800000">$0B</font><font color="#000080">; </font><font color="#008000"><i>{ MCGA w/ monochrome analog display }
  </i></font>gdMCGA      <font color="#000080">= </font><font color="#800000">$0C</font><font color="#000080">; </font><font color="#008000"><i>{ MCGA w/ color analog display }
  </i></font>gdUnknown   <font color="#000080">= </font><font color="#800000">$FF</font><font color="#000080">; </font><font color="#008000"><i>{ Unknown display type }

  { Window frame classes }

  </i></font>SingleFrame <font color="#000080">: </font>TFrame       <font color="#000080">= </font><font color="#800000">'&Uacute;&Auml;&iquest;&sup3;&sup3;&Agrave;&Auml;&Ugrave;'</font><font color="#000080">;
  </font>DoubleFrame <font color="#000080">: </font>TFrame       <font color="#000080">= </font><font color="#800000">'&Eacute;&Iacute;&raquo;&ordm;&ordm;&Egrave;&Iacute;&frac14;'</font><font color="#000080">;
  </font>SingleDoubleFrame <font color="#000080">: </font>TFrame <font color="#000080">= </font><font color="#800000">'&Ouml;&Auml;&middot;&ordm;&ordm;&Oacute;&Auml;&frac12;'</font><font color="#000080">;
  </font>DoubleSingleFrame <font color="#000080">: </font>TFrame <font color="#000080">= </font><font color="#800000">'&Otilde;&Iacute;&cedil;&sup3;&sup3;&Ocirc;&Iacute;&frac34;'</font><font color="#000080">;
  </font>BarFrame <font color="#000080">: </font>TFrame          <font color="#000080">= </font><font color="#800000">'&Ucirc;&szlig;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Uuml;&Ucirc;'</font><font color="#000080">;

  </font><font color="#008000"><i>{ Window frame constants }

  </i></font>frNone         <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has no frame }
  </i></font>frSingle       <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has single frame }
  </i></font>frSingleDouble <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has single (horiz) and double (vert) frames }
  </i></font>frDouble       <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has double frame }
  </i></font>frDoubleSingle <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has double (horiz) and single (vert) frames }
  </i></font>frBar          <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;  </font><font color="#008000"><i>{ Window has a rectangular bar frame }

  { Shadow color attributes }

  </i></font>winShadowAttr <font color="#000080">: </font>TTextAttr <font color="#000080">= </font><font color="#800000">$07</font><font color="#000080">;

  </font>FontOpenReg <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#000080">=
    (</font><font color="#800000">$02</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$07</font><font color="#000080">, </font><font color="#800000">$05</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">, </font><font color="#800000">$06</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$02</font><font color="#000080">);
  </font>FontCloseReg <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#000080">=
    (</font><font color="#800000">$02</font><font color="#000080">, </font><font color="#800000">$03</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$03</font><font color="#000080">, </font><font color="#800000">$05</font><font color="#000080">, </font><font color="#800000">$10</font><font color="#000080">, </font><font color="#800000">$06</font><font color="#000080">, </font><font color="#800000">$0E</font><font color="#000080">, </font><font color="#800000">$04</font><font color="#000080">, </font><font color="#800000">$00</font><font color="#000080">);

  </font>FadeDelay <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">; </font><font color="#008000"><i>{ Fade screen delay time for
    SaveDosScreen and RestoreDosScreen functions }

</i></font><font color="#FF0000"><b>VAR
  </b></font>WinShadow <font color="#000080">: </font>BOOLEAN<font color="#000080">;
  </font>WinCount <font color="#000080">: </font>INTEGER<font color="#000080">;
  </font>TopWindow <font color="#000080">: </font>PWinRec<font color="#000080">;
  </font>WinExplodeDelay<font color="#000080">, </font>ScreenHeight<font color="#000080">, </font>WinFrame <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>ScreenWidth <font color="#000080">: </font>WORD<font color="#000080">;
  </font>Screen <font color="#000080">: </font>POINTER<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION  </b></font>GetDisplay <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetTextFont <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Font<font color="#000080">; </font>StartChar<font color="#000080">, </font>BytePerChar<font color="#000080">, </font>CharCount <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>GetTextFont <font color="#000080">(</font>FontCode <font color="#000080">: </font>BYTE<font color="#000080">) : </font>POINTER<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteStr <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteStrV <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteChar <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Count <font color="#000080">: </font>BYTE<font color="#000080">; </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillWin <font color="#000080">(</font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ReadWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>WinSize <font color="#000080">: </font>WORD<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>TWinState<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>RestoreWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>TWinState<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetFrame <font color="#000080">(</font>FrameNum <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Frame <font color="#000080">: </font>TFrame<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FrameWin <font color="#000080">(</font>Title <font color="#000080">: </font>TitleStr<font color="#000080">;
                    </font>Frame <font color="#000080">: </font>TFrame<font color="#000080">; </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>UnFrameWin<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>ScrReadChar <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrWriteChar <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>ScrReadAttr <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">) : </font>TTextAttr<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrWriteAttr <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>WindowIndirect <font color="#000080">(</font>Rect <font color="#000080">: </font>TRect<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>PtInRect <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>Rect <font color="#000080">: </font>TRect<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetWindowRect <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Rect <font color="#000080">: </font>TRect<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetWindowRectExt <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Rect <font color="#000080">: </font>TRect<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ShadowWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>CreateWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">;
                    </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">; </font>Title <font color="#000080">: </font>TitleStr<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>CreateWinIndirect <font color="#000080">(</font>WS <font color="#000080">: </font>TWindowStruct<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>OpenWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">;
                  </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">; </font>Title <font color="#000080">: </font>TitleStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>OpenWinIndirect <font color="#000080">(</font>WS <font color="#000080">: </font>TWindowStruct<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>CloseWin <font color="#000080">: </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>MoveWin <font color="#000080">(</font>Left<font color="#000080">, </font>Top <font color="#000080">: </font>BYTE<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>SaveDOSScreen <font color="#000080">(</font>UseFade<font color="#000080">, </font>RestoreScreen <font color="#000080">: </font>BOOLEAN<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>RestoreDOSScreen <font color="#000080">(</font>UseFade <font color="#000080">: </font>BOOLEAN<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetBlink <font color="#000080">(</font>BlinkOn <font color="#000080">: </font>BOOLEAN<font color="#000080">);

</font><font color="#FF0000"><b>IMPLEMENTATION

</b></font><font color="#008000"><i>{$L win.obj}

</i></font><font color="#FF0000"><b>VAR </b></font>OldCursor <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>MakeWord <font color="#000080">(</font>HI<font color="#000080">, </font>LO <font color="#000080">: </font>BYTE<font color="#000080">) : </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AH, HI
  MOV AL, LO
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ MakeWord }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetDisplay<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
</b></font><font color="#FF00FF">MOV AX, 1A00h
  INT 10h
  MOV AL, BL
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetDisplay }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetRegisters<font color="#000080">; </font><font color="#FF0000"><b>near</b></font><font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">MOV AX, SEG @Data
  MOV DS, AX
  MOV CX, 0002h
  MOV DX, 03C4h
  CALL @@1
  MOV CX, 0003h
  MOV DL, 0CEh
@@1 :
  LODSB
  OUT DX, AL
INC DX
  LODSB
OUT DX, AL
  DEC DX
  LOOP @@1
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetRegisters }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetTextFont<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV BX, SegA000
  PUSH DS
  MOV AX, WORD PTR [Font + 2]
  MOV DS, AX
  XOR AX, AX
  MOV AL, StartChar
  MOV DI, AX
  MOV SI, WORD PTR [Font]
  MOV AX, BX
  MOV BL, BytePerChar
XOR BH, BH
  PUSH ES
MOV ES, AX
  MOV CL, 5
  SHL DI, CL
  PUSH SI
  PUSH DS
  CLI
  MOV SI, OFFSET FontOpenReg
  CALL SetRegisters
  POP DS
  POP SI
  MOV AX, DI
@@1 :
  MOV DI, AX
  MOV CX, BX
  REP MOVSB
  ADD AX, 0020h
  DEC CharCount
JNE @@1
  MOV SI, OFFSET FontCloseReg
CALL SetRegisters
  STI
  POP ES
  POP DS
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetTextFont }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetTextFont<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AX, 1130h
  MOV BH, FontCode
  INT 10h
  MOV AX, BP
  MOV DX, ES
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetTextFont }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteStr <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">); </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteStrV <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>Index <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>LENGTH <font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>DO
    </b></font>WriteChar <font color="#000080">(</font>X<font color="#000080">, </font>PRED <font color="#000080">(</font>Y <font color="#000080">+ </font>Index<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>S <font color="#000080">[</font>Index<font color="#000080">], </font>Color<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ WriteStrV }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WriteChar <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Count <font color="#000080">: </font>BYTE<font color="#000080">; </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">);
</font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillWin <font color="#000080">(</font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">); </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">); </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ReadWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">); </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>WinSize <font color="#000080">: </font>WORD<font color="#000080">; </font><font color="#FF0000"><b>EXTERNAL</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>TWinState<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>W<font color="#000080">.</font>WindMin <font color="#000080">:= </font>WindMin<font color="#000080">;
  </font>W<font color="#000080">.</font>WindMax <font color="#000080">:= </font>WindMax<font color="#000080">;
</font>W<font color="#000080">.</font>WHEREX <font color="#000080">:= </font>WHEREX<font color="#000080">;
  </font>W<font color="#000080">.</font>WHEREY <font color="#000080">:= </font>WHEREY<font color="#000080">;
</font>W<font color="#000080">.</font>TextAttr <font color="#000080">:= </font>TextAttr
<font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ SaveWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RestoreWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>TWinState<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>WindMin <font color="#000080">:= </font>W<font color="#000080">.</font>WindMin<font color="#000080">;
  </font>WindMax <font color="#000080">:= </font>W<font color="#000080">.</font>WindMax<font color="#000080">;
  </font>GOTOXY <font color="#000080">(</font>W<font color="#000080">.</font>WHEREX<font color="#000080">, </font>W<font color="#000080">.</font>WHEREY<font color="#000080">);
  </font>TextAttr <font color="#000080">:= </font>W<font color="#000080">.</font>TextAttr
<font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ RestoreWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetFrame <font color="#000080">(</font>FrameNum <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Frame <font color="#000080">: </font>TFrame<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  CASE </b></font>FrameNum <font color="#FF0000"><b>OF
    </b></font>frSingle <font color="#000080">: </font>Frame <font color="#000080">:= </font>SingleFrame<font color="#000080">;
    </font>frDouble <font color="#000080">: </font>Frame <font color="#000080">:= </font>DoubleFrame<font color="#000080">;
    </font>frSingleDouble <font color="#000080">: </font>Frame <font color="#000080">:= </font>SingleDoubleFrame<font color="#000080">;
</font>frDoubleSingle <font color="#000080">: </font>Frame <font color="#000080">:= </font>DoubleSingleFrame<font color="#000080">;
    </font>frBar <font color="#000080">: </font>Frame <font color="#000080">:= </font>BarFrame<font color="#000080">;
</font><font color="#FF0000"><b>ELSE </b></font>FILLCHAR <font color="#000080">(</font>Frame<font color="#000080">, </font>SIZEOF <font color="#000080">(</font>Frame<font color="#000080">), </font>BYTE <font color="#000080">( - </font><font color="#800000">1</font><font color="#000080">) )
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetFrame }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FrameWin <font color="#000080">(</font>Title <font color="#000080">: </font>TitleStr<font color="#000080">;
  </font>Frame <font color="#000080">: </font>TFrame<font color="#000080">; </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>W<font color="#000080">, </font>H<font color="#000080">, </font>Y <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
</b></font>W <font color="#000080">:= </font>LO <font color="#000080">(</font>WindMax<font color="#000080">) - </font>LO <font color="#000080">(</font>WindMin<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
</font>H <font color="#000080">:= </font>HI <font color="#000080">(</font>WindMax<font color="#000080">) - </font>HI <font color="#000080">(</font>WindMin<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
</font>WriteChar <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>FrameColor<font color="#000080">);
</font>WriteChar <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>W <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>FrameColor<font color="#000080">);
</font>WriteChar <font color="#000080">(</font>W<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>FrameColor<font color="#000080">);
</font><font color="#FF0000"><b>IF </b></font>LENGTH <font color="#000080">(</font>Title<font color="#000080">) &gt; </font>W <font color="#000080">- </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN </b></font>Title <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>CHR <font color="#000080">(</font>W <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">);
</font>WriteStr <font color="#000080">( (</font>W <font color="#000080">- </font>LENGTH <font color="#000080">(</font>Title<font color="#000080">) ), </font><font color="#800000">1</font><font color="#000080">, </font>Title<font color="#000080">, </font>TitleColor<font color="#000080">);

</font><font color="#FF0000"><b>FOR </b></font>Y <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>H <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
BEGIN
</b></font>WriteChar <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>Y<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">], </font>FrameColor<font color="#000080">);
    </font>WriteChar <font color="#000080">(</font>W<font color="#000080">, </font>Y<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">5</font><font color="#000080">], </font>FrameColor<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WriteChar <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>H<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">6</font><font color="#000080">], </font>FrameColor<font color="#000080">);
  </font>WriteChar <font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>H<font color="#000080">, </font>W <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">], </font>FrameColor<font color="#000080">);
  </font>WriteChar <font color="#000080">(</font>W<font color="#000080">, </font>H<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Frame <font color="#000080">[</font><font color="#800000">8</font><font color="#000080">], </font>FrameColor<font color="#000080">);
  </font>INC <font color="#000080">(</font>WindMin<font color="#000080">, </font><font color="#800000">$0101</font><font color="#000080">);
  </font>DEC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0101</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ FrameWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>UnFrameWin<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>DEC <font color="#000080">(</font>WindMin<font color="#000080">, </font><font color="#800000">$0101</font><font color="#000080">);
  </font>INC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0101</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ UnFrameWin }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ScrReadChar<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI, Screen
  XOR AH, AH
  MOV AL, Y
DEC AX
  MUL ScreenWidth
  SHL AX, 1
  XOR DH, DH
  MOV DL, X
  SHL DX, 1
  DEC DX
  DEC DX
  ADD AX, DX
  MOV DI, AX
  MOV AL, BYTE PTR [ES : DI]
  </font><font color="#008000"><i>{ScrReadChar := Char(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 2)^)}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrReadChar }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ScrWriteChar<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI, Screen
  XOR AH, AH
MOV AL, Y
  DEC AX
  MUL ScreenWidth
  SHL AX, 1
  XOR DH, DH
  MOV DL, X
  SHL DX, 1
  DEC DX
  DEC DX
  ADD AX, DX
  MOV DI, AX
  MOV AL, Ch
  MOV BYTE PTR [ES : DI], AL
  </font><font color="#008000"><i>{Char(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 2)^) := Ch}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrWriteChar }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ScrReadAttr<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
</b></font><font color="#FF00FF">LES DI, Screen
  XOR AH, AH
  MOV AL, Y
  DEC AX
  MUL ScreenWidth
  SHL AX, 1
  XOR DH, DH
  MOV DL, X
  SHL DX, 1
  DEC DX
  ADD AX, DX
  MOV DI, AX
  MOV AL, BYTE PTR [ES : DI]
  </font><font color="#008000"><i>{ScrReadAttr := TTextAttr(Ptr(Seg(Screen^),
    (Y - 1) * ScreenWidth * 2 + (X * 2) - 1)^)}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrReadAttr }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ScrWriteAttr<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
</b></font><font color="#FF00FF">LES DI, Screen
  XOR AH, AH
  MOV AL, Y
  DEC AX
  MUL ScreenWidth
  SHL AX, 1
  XOR DH, DH
  MOV DL, X
  SHL DX, 1
  DEC DX
  ADD AX, DX
  MOV DI, AX
  MOV AL, Color
  MOV BYTE PTR [ES : DI], AL
  </font><font color="#008000"><i>{TTextAttr(Ptr(Seg(Screen^),
(Y - 1) * ScreenWidth * 2 + (X * 2) - 1)^) := Color}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ScrWriteAttr }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>WindowIndirect <font color="#000080">(</font>Rect <font color="#000080">: </font>TRect<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>Rect <font color="#FF0000"><b>DO </b></font>WINDOW <font color="#000080">(</font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ WindowIndirect }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>PtInRect <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>Rect <font color="#000080">: </font>TRect<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>Rect <font color="#FF0000"><b>DO
    </b></font>PtInRect <font color="#000080">:= (</font>X <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font>Left<font color="#000080">..</font>Right<font color="#000080">]) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Y <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font>Top<font color="#000080">..</font>Bottom<font color="#000080">])
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ PtInRect }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetWindowRect <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Rect <font color="#000080">: </font>TRect<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI, Rect
  MOV AX, WindMin
  MOV BX, WindMax
INC AL
  INC AH
  INC BL
  INC BH
MOV [ES : DI] (TRect) .Left, AL
  MOV [ES : DI] (TRect) .Top, AH
  MOV [ES : DI] (TRect) .Right, BL
  MOV [ES : DI] (TRect) .Bottom, BH
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetWindowRect }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetWindowRectExt <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>Rect <font color="#000080">: </font>TRect<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">LES DI, Rect
  MOV AL, X1
  MOV AH, Y1
  MOV BL, X2
  MOV BH, Y2
  MOV [ES : DI] (TRect) .Left, AL
  MOV [ES : DI] (TRect) .Right, BL
MOV [ES : DI] (TRect) .Top, AH
  MOV [ES : DI] (TRect) .Bottom, BH
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetWindowRectExt }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ClearWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">; </font>Color <font color="#000080">: </font>TTextAttr<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AX, 0600h
  MOV BH, Color
  MOV CL, X1
  DEC CL
  MOV CH, Y1
  DEC CH
  MOV DL, X2
  DEC DL
  MOV DH, Y2
  DEC DH
  INT 10h
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ClearWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShadowWin<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">, </font>I <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>I <font color="#000080">:= </font>Y2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>FOR </b></font>P <font color="#000080">:= </font>X1 <font color="#000080">+ </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>X2 <font color="#000080">+ </font><font color="#800000">2 </font><font color="#FF0000"><b>DO
    </b></font>ScrWriteAttr <font color="#000080">(</font>P<font color="#000080">, </font>I<font color="#000080">, </font>ScrReadAttr <font color="#000080">(</font>P<font color="#000080">, </font>I<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>WinShadowAttr<font color="#000080">);
  </font>I <font color="#000080">:= </font>X2 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>P <font color="#000080">:= </font>Y1 <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Y2 <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>ScrWriteAttr <font color="#000080">(</font>I<font color="#000080">, </font>P<font color="#000080">, </font>ScrReadAttr <font color="#000080">(</font>I<font color="#000080">, </font>P<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>WinShadowAttr<font color="#000080">);
    </font>ScrWriteAttr <font color="#000080">(</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>P<font color="#000080">, </font>ScrReadAttr <font color="#000080">(</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>P<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>WinShadowAttr<font color="#000080">)
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ShadowWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CreateWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">; </font>Title <font color="#000080">: </font>TitleStr<font color="#000080">);
</font><font color="#FF0000"><b>VAR
</b></font>W<font color="#000080">, </font>H <font color="#000080">: </font>WORD<font color="#000080">;
</font>DX<font color="#000080">, </font>DY <font color="#000080">: </font>BYTE<font color="#000080">;
</font>F <font color="#000080">: </font>TFrame<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
IF </b></font>WinFrame <font color="#000080">&lt;&gt; </font>frNone <font color="#FF0000"><b>THEN
BEGIN
</b></font>GetFrame <font color="#000080">(</font>WinFrame<font color="#000080">, </font>F<font color="#000080">);
</font><font color="#FF0000"><b>IF </b></font>WinExplodeDelay <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
BEGIN
</b></font>DX <font color="#000080">:= </font>X1 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
</font>DY <font color="#000080">:= </font>Y1 <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>REPEAT
IF </b></font>WinShadow <font color="#000080">= </font>TRUE <font color="#FF0000"><b>THEN
</b></font>ShadowWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>DX<font color="#000080">, </font>DY<font color="#000080">);
</font>WINDOW <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>DX<font color="#000080">, </font>DY<font color="#000080">);
</font>FrameWin <font color="#000080">(</font>Title<font color="#000080">, </font>F<font color="#000080">, </font>TitleColor<font color="#000080">, </font>FrameColor<font color="#000080">);
</font>ClearWin <font color="#000080">(</font>X1 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Y1 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>DX <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>DY <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>FrameColor<font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font>DX <font color="#000080">&lt; </font>X2 <font color="#FF0000"><b>THEN </b></font>INC <font color="#000080">(</font>DX<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
 </font><font color="#FF0000"><b>IF </b></font>DX <font color="#000080">&gt; </font>X2 <font color="#FF0000"><b>THEN </b></font>DX <font color="#000080">:= </font>X2<font color="#000080">;
</font><font color="#FF0000"><b>IF </b></font>DY <font color="#000080">&lt; </font>Y2 <font color="#FF0000"><b>THEN </b></font>INC <font color="#000080">(</font>DY<font color="#000080">);
</font>DELAY <font color="#000080">(</font>WinExplodeDelay<font color="#000080">)
</font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>DX <font color="#000080">= </font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>DY <font color="#000080">= </font>Y2<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#000080">= </font>TRUE <font color="#FF0000"><b>THEN </b></font>ShadowWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
</font>WINDOW <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
</font>FrameWin <font color="#000080">(</font>Title<font color="#000080">, </font>F<font color="#000080">, </font>TitleColor<font color="#000080">, </font>FrameColor<font color="#000080">);
</font>ClearWin <font color="#000080">(</font>SUCC <font color="#000080">(</font>X1<font color="#000080">), </font>SUCC <font color="#000080">(</font>Y1<font color="#000080">), </font>PRED <font color="#000080">(</font>X2<font color="#000080">), </font>PRED <font color="#000080">(</font>Y2<font color="#000080">), </font>FrameColor<font color="#000080">)
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>WINDOW <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
  </font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#FF0000"><b>THEN </b></font>INC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ CreateWin }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CreateWinIndirect<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>WS<font color="#000080">, </font>WS<font color="#000080">.</font>Rect <font color="#FF0000"><b>DO
    </b></font>CreateWin <font color="#000080">(</font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom<font color="#000080">, </font>TitleColor<font color="#000080">, </font>FrameColor<font color="#000080">, </font>Title<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ CreateWinIndirect }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>OpenWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2 <font color="#000080">: </font>BYTE<font color="#000080">;
  </font>TitleColor<font color="#000080">, </font>FrameColor <font color="#000080">: </font>TTextAttr<font color="#000080">; </font>Title <font color="#000080">: </font>TitleStr<font color="#000080">) : </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>PWinRec<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>OpenWin <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>MAXAVAIL <font color="#000080">&gt; </font>SIZEOF <font color="#000080">(</font>TWinRec<font color="#000080">) </font><font color="#FF0000"><b>THEN
BEGIN
    </b></font>NEW <font color="#000080">(</font>W<font color="#000080">);
    </font>W<font color="#000080">^.</font>Next <font color="#000080">:= </font>TopWindow<font color="#000080">;
    </font>SaveWin <font color="#000080">(</font>W<font color="#000080">^.</font>State<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>MAXAVAIL <font color="#000080">&gt; </font>LENGTH <font color="#000080">(</font>Title<font color="#000080">) + </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>GETMEM <font color="#000080">(</font>W<font color="#000080">^.</font>Title<font color="#000080">, </font>LENGTH <font color="#000080">(</font>Title<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font>W<font color="#000080">^.</font>Title<font color="#000080">^ := </font>Title<font color="#000080">;
      </font>W<font color="#000080">^.</font>TitleColor <font color="#000080">:= </font>TitleColor<font color="#000080">;
      </font>W<font color="#000080">^.</font>FrameColor <font color="#000080">:= </font>FrameColor<font color="#000080">;
      </font>WINDOW <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#000080">= </font>TRUE <font color="#FF0000"><b>THEN </b></font>INC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>MAXAVAIL <font color="#000080">&gt; </font>WinSize <font color="#FF0000"><b>THEN
      BEGIN
</b></font>W<font color="#000080">^.</font>Size <font color="#000080">:= </font>WinSize<font color="#000080">;
</font>GETMEM <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">, </font>W<font color="#000080">^.</font>Size<font color="#000080">);
</font>ReadWin <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">^);
</font>CreateWin <font color="#000080">(</font>X1<font color="#000080">, </font>Y1<font color="#000080">, </font>X2<font color="#000080">, </font>Y2<font color="#000080">, </font>TitleColor<font color="#000080">, </font>FrameColor<font color="#000080">, </font>Title<font color="#000080">);
 </font>TopWindow <font color="#000080">:= </font>W<font color="#000080">;
</font>INC <font color="#000080">(</font>WinCount<font color="#000080">);
</font>OpenWin <font color="#000080">:= </font>TRUE
      <font color="#FF0000"><b>END
    END
  END
END</b></font><font color="#000080">; </font><font color="#008000"><i>{ OpenWin }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>OpenWinIndirect<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>WS<font color="#000080">, </font>WS<font color="#000080">.</font>Rect <font color="#FF0000"><b>DO </b></font>OpenWinIndirect <font color="#000080">:= </font>OpenWin <font color="#000080">(</font>Left<font color="#000080">,
    </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom<font color="#000080">, </font>TitleColor<font color="#000080">, </font>FrameColor<font color="#000080">, </font>Title<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ OpenWinIndirect }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>CloseWin <font color="#000080">: </font>BOOLEAN<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>PWinRec<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>CloseWin <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Assigned <font color="#000080">(</font>TopWindow<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>WinCount <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
</b></font>W <font color="#000080">:= </font>TopWindow<font color="#000080">;
    </font><font color="#FF0000"><b>WITH </b></font>W<font color="#000080">^ </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>WriteWin <font color="#000080">(</font>Buffer<font color="#000080">^);
      </font>FREEMEM <font color="#000080">(</font>Buffer<font color="#000080">, </font>W<font color="#000080">^.</font>Size<font color="#000080">);
      </font>FREEMEM <font color="#000080">(</font>Title<font color="#000080">, </font>LENGTH <font color="#000080">(</font>Title<font color="#000080">^) + </font><font color="#800000">1</font><font color="#000080">);
      </font>RestoreWin <font color="#000080">(</font>State<font color="#000080">);
      </font>TopWindow <font color="#000080">:= </font>Next
    <font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>DISPOSE <font color="#000080">(</font>W<font color="#000080">);
    </font>DEC <font color="#000080">(</font>WinCount<font color="#000080">);
    </font>CloseWin <font color="#000080">:= </font>TRUE
  <font color="#FF0000"><b>END
END</b></font><font color="#000080">; </font><font color="#008000"><i>{ CloseWin }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>MoveWin<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>W <font color="#000080">: </font>PWinRec<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>MoveWin <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>MAXAVAIL <font color="#000080">&gt; </font>SIZEOF <font color="#000080">(</font>TWinRec<font color="#000080">) ) </font><font color="#FF0000"><b>AND </b></font>Assigned <font color="#000080">(</font>TopWindow<font color="#000080">) </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>NEW <font color="#000080">(</font>W<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>MAXAVAIL <font color="#000080">&gt; </font>WinSize <font color="#FF0000"><b>THEN
    BEGIN
      </b></font>SaveWin <font color="#000080">(</font>W<font color="#000080">^.</font>State<font color="#000080">);
      </font>W<font color="#000080">^.</font>State<font color="#000080">.</font>WindMin <font color="#000080">:= </font>MakeWord <font color="#000080">(</font>Top<font color="#000080">, </font>Left<font color="#000080">) - </font><font color="#800000">$0101</font><font color="#000080">;
      </font>W<font color="#000080">^.</font>State<font color="#000080">.</font>WindMax <font color="#000080">:= </font>W<font color="#000080">^.</font>State<font color="#000080">.</font>WindMin <font color="#000080">+ </font>WindMax <font color="#000080">- </font>WindMin<font color="#000080">;

      </font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#FF0000"><b>THEN </b></font>DEC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">);
      </font>W<font color="#000080">^.</font>Size <font color="#000080">:= </font>WinSize<font color="#000080">;

      </font>GETMEM <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">, </font>W<font color="#000080">^.</font>Size<font color="#000080">);
      </font>ReadWin <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">^);

</font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#FF0000"><b>THEN </b></font>INC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">);
      </font>WriteWin <font color="#000080">(</font>TopWindow<font color="#000080">^.</font>Buffer<font color="#000080">^);

      </font>RestoreWin <font color="#000080">(</font>W<font color="#000080">^.</font>State<font color="#000080">);
</font>ReadWin <font color="#000080">(</font>TopWindow<font color="#000080">^.</font>Buffer<font color="#000080">^);

      </font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#FF0000"><b>THEN </b></font>DEC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">);
      </font>WriteWin <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">^);
      </font><font color="#FF0000"><b>IF </b></font>WinShadow <font color="#FF0000"><b>THEN
      BEGIN
</b></font>ShadowWin <font color="#000080">(</font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>SUCC <font color="#000080">(</font>LO <font color="#000080">(</font>WindMax<font color="#000080">) ), </font>SUCC <font color="#000080">(</font>HI <font color="#000080">(</font>WindMax<font color="#000080">) ) );
</font>INC <font color="#000080">(</font>WindMax<font color="#000080">, </font><font color="#800000">$0102</font><font color="#000080">)
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>FREEMEM <font color="#000080">(</font>W<font color="#000080">^.</font>Buffer<font color="#000080">, </font>W<font color="#000080">^.</font>Size<font color="#000080">);
      </font>MoveWin <font color="#000080">:= </font>TRUE
    <font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>DISPOSE <font color="#000080">(</font>W<font color="#000080">)
  </font><font color="#FF0000"><b>END
END</b></font><font color="#000080">; </font><font color="#008000"><i>{ MoveWin }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>SaveDOSScreen<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>GetDisplay <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font>gdEGA<font color="#000080">..</font>gdMCGA<font color="#000080">] </font><font color="#FF0000"><b>THEN </b></font>UseFade <font color="#000080">:= </font>FALSE<font color="#000080">;

  </font>OldCursor <font color="#000080">:= </font>GetCursorType<font color="#000080">;
  </font>SetCursor <font color="#000080">(</font>CursorOff<font color="#000080">);

  </font><font color="#FF0000"><b>IF </b></font>UseFade <font color="#FF0000"><b>THEN </b></font>FadeOut <font color="#000080">(</font>FadeDelay<font color="#000080">);

  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">PUSH WORD PTR [WinShadow]
    MOV WinShadow, FALSE
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>SaveDOSScreen <font color="#000080">:= </font>OpenWin <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">,
    </font>ScreenWidth<font color="#000080">, </font>ScreenHeight<font color="#000080">, </font>Black<font color="#000080">, </font>Black<font color="#000080">, </font>None<font color="#000080">);

  </font><font color="#FF0000"><b>asm
</b></font><font color="#FF00FF">POP WORD PTR [WinShadow]
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>RestoreScreen <font color="#FF0000"><b>THEN </b></font>WriteWin <font color="#000080">(</font>TopWindow<font color="#000080">^.</font>Buffer<font color="#000080">^);

  </font><font color="#FF0000"><b>IF </b></font>UseFade <font color="#FF0000"><b>THEN </b></font>FadeIn <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)

</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ SaveDOSScreen }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>RestoreDOSScreen<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>GetDisplay <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font>gdEGA<font color="#000080">..</font>gdMCGA<font color="#000080">] </font><font color="#FF0000"><b>THEN </b></font>UseFade <font color="#000080">:= </font>FALSE<font color="#000080">;

  </font>WINDOW <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>ScreenWidth<font color="#000080">, </font>ScreenHeight<font color="#000080">);
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">MOV WinShadow, FALSE
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>UseFade <font color="#FF0000"><b>THEN </b></font>SetBrightness <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>RestoreDOSScreen <font color="#000080">:= </font>CloseWin<font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>UseFade <font color="#FF0000"><b>THEN </b></font>FadeIn <font color="#000080">(</font>FadeDelay<font color="#000080">);

  </font>SetCursorType <font color="#000080">(</font>OldCursor<font color="#000080">);
</font>SetCursor <font color="#000080">(</font>CursorOn<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ RestoreDOSScreen }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetBlink <font color="#000080">(</font>BlinkOn <font color="#000080">: </font>BOOLEAN<font color="#000080">);
</font><font color="#FF0000"><b>CONST </b></font>PortVal <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#000080">= (</font><font color="#800000">$0C</font><font color="#000080">, </font><font color="#800000">$08</font><font color="#000080">, </font><font color="#800000">$0D</font><font color="#000080">, </font><font color="#800000">$09</font><font color="#000080">, </font><font color="#800000">$09</font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>PortNum <font color="#000080">: </font>WORD<font color="#000080">;
  </font>Index<font color="#000080">, </font>PVal <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>THEN
  BEGIN
    </b></font>PortNum <font color="#000080">:= </font><font color="#800000">$3B8</font><font color="#000080">;
    </font>Index <font color="#000080">:= </font><font color="#800000">4
  </font><font color="#FF0000"><b>END ELSE
    IF </b></font>GetDisplay <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font>gdEGA<font color="#000080">..</font>gdMCGA<font color="#000080">] </font><font color="#FF0000"><b>THEN
BEGIN
      INLINE </b></font><font color="#000080">(
</font><font color="#800000">$8A </font><font color="#000080">/ </font><font color="#800000">$5E </font><font color="#000080">/ &lt; </font>BlinkOn <font color="#000080">/     </font><font color="#008000"><i>{ MOV BL, [BP+&lt;BlinkOn] }
</i></font><font color="#800000">$B8 </font><font color="#000080">/ </font><font color="#800000">$03 </font><font color="#000080">/ </font><font color="#800000">$10 </font><font color="#000080">/          </font><font color="#008000"><i>{ MOV AX, $1003 }
</i></font><font color="#800000">$CD </font><font color="#000080">/ </font><font color="#800000">$10</font><font color="#000080">);             </font><font color="#008000"><i>{ MOV $10 }
      </i></font>EXIT
    <font color="#FF0000"><b>END ELSE
      BEGIN
</b></font>PortNum <font color="#000080">:= </font><font color="#800000">$3D8</font><font color="#000080">;
</font><font color="#FF0000"><b>CASE </b></font>LastMode <font color="#FF0000"><b>OF
  </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3 </font><font color="#000080">: </font>Index <font color="#000080">:= </font>LastMode<font color="#000080">;
  </font><font color="#FF0000"><b>ELSE </b></font>EXIT
<font color="#FF0000"><b>END
      END</b></font><font color="#000080">;
   </font>PVal <font color="#000080">:= </font>PortVal <font color="#000080">[</font>Index<font color="#000080">];
   </font><font color="#FF0000"><b>IF </b></font>BlinkOn <font color="#FF0000"><b>THEN
   </b></font>PVal <font color="#000080">:= </font>PVal <font color="#FF0000"><b>OR </b></font><font color="#800000">$20</font><font color="#000080">;
   </font>Port <font color="#000080">[</font>PortNum<font color="#000080">] := </font>PVal
<font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetBlink }

</i></font><font color="#FF0000"><b>FUNCTION </b></font>HeapFunc <font color="#000080">(</font>Size <font color="#000080">: </font>WORD<font color="#000080">) : </font>INTEGER<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AX, 1
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ HeapFunc }

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>HeapError <font color="#000080">:= @</font>HeapFunc<font color="#000080">;
  </font>WinCount <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>WinShadow <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>WinFrame <font color="#000080">:= </font>frSingle<font color="#000080">;
  </font>WinExplodeDelay <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">; </font><font color="#008000"><i>{ set no explode }
  </i></font>TopWindow <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>LastMode <font color="#000080">= </font>Mono <font color="#FF0000"><b>THEN
    </b></font>Screen <font color="#000080">:= </font>PTR <font color="#000080">(</font>SegB000<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>ELSE
  BEGIN
    </b></font>Screen <font color="#000080">:= </font>PTR <font color="#000080">(</font>SegB800<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>LastMode <font color="#FF0000"><b>AND </b></font>Font8x8<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
</b></font>ScreenHeight <font color="#000080">:= </font>Mem <font color="#000080">[</font>Seg0040 <font color="#000080">: </font><font color="#800000">$0084</font><font color="#000080">] </font><font color="#FF0000"><b>ELSE </b></font>ScreenHeight <font color="#000080">:= </font><font color="#800000">25
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>ScreenWidth <font color="#000080">:= </font>MemW <font color="#000080">[</font>Seg0040 <font color="#000080">: </font><font color="#800000">$004A</font><font color="#000080">];
</font>InitCol<font color="#000080">;       </font><font color="#008000"><i>{ Save original palette }
</i></font>SetBlink <font color="#000080">(</font>TRUE<font color="#000080">) </font><font color="#008000"><i>{ Set blinking }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{ Win.Pas }

{--------------------------------  XX3402 CODE ---------------------}
{ CUT OUT THE FOLLOWING AND USE XX3402 TO DECODE TO OBTAIN WIN.OBJ  }

</i></font><font color="#000080">* </font>XX3402 <font color="#000080">- </font><font color="#800000">000678 </font><font color="#000080">- </font><font color="#800000">090894 </font><font color="#000080">- - </font><font color="#800000">72 </font><font color="#000080">- - </font><font color="#800000">85 </font><font color="#000080">- </font><font color="#800000">53801 </font><font color="#000080">- - - - - - - - - </font>WIN<font color="#000080">.</font>OBJ <font color="#000080">- - </font><font color="#800000">1 </font><font color="#000080">- </font><font color="#FF0000"><b>OF </b></font><font color="#000080">- - </font><font color="#800000">1
</font>U <font color="#000080">+ </font>Y <font color="#000080">+ - </font>rRdPWt <font color="#000080">- </font>IooHW0 <font color="#000080">+ + + + + </font>QJ5JmMawUELBnNKpWP4Jm60 <font color="#000080">- </font>KNL7nOKxi61AiAda61k <font color="#000080">- + </font>uTBN
<font color="#800000">0</font>Fo5RqZi9Y3HHKe6 <font color="#000080">+ </font>k <font color="#000080">- + </font>uImK <font color="#000080">+ </font>U <font color="#000080">+ + </font>O6U1 <font color="#000080">+ </font><font color="#800000">20</font>VZ7M4 <font color="#000080">+ + </font>F2EJF <font color="#000080">- </font>FdU5 <font color="#000080">+ </font><font color="#800000">2</font>U <font color="#000080">+ + + </font><font color="#800000">6 </font><font color="#000080">- + </font>FKK <font color="#000080">- </font>U <font color="#000080">+ </font><font color="#800000">2E</font>ox2
FIKM <font color="#000080">- </font>k <font color="#000080">+ </font>cEE21 <font color="#000080">+ </font>E5mX <font color="#000080">- </font>s <font color="#000080">+ </font><font color="#800000">0</font>IB6FIB9IotDJk <font color="#000080">+ </font><font color="#800000">5</font>JoZCF2p7HU <font color="#000080">+ </font><font color="#800000">5</font>JoZCF2p <font color="#000080">- </font>K <font color="#000080">+ - </font>gY <font color="#000080">+ </font>w <font color="#000080">+ + + </font><font color="#800000">66</font>Jp77
J2JLGIsh <font color="#000080">+ + </font><font color="#800000">0</font>lY <font color="#000080">+ </font>s <font color="#000080">+ + + </font><font color="#800000">65</font>FYZAH3R7HWA <font color="#000080">+ + </font><font color="#800000">04E2 </font><font color="#000080">+ + + + </font>UZLIYZIFIB6EJ6H <font color="#000080">+ + </font><font color="#800000">0</font>NY <font color="#000080">+ </font>w <font color="#000080">+ + + </font><font color="#800000">66</font>Jp77
J2JHJ36 <font color="#000080">+ + + </font><font color="#800000">1</font>HY <font color="#000080">+ </font>s <font color="#000080">+ + + </font><font color="#800000">65</font>JoZCIoZOFH6 <font color="#000080">- + </font>DqE1U <font color="#000080">+ + + </font>URGFI32JoZC8 <font color="#000080">+ + + </font><font color="#800000">7</font>sU2 <font color="#000080">+ </font><font color="#800000">20</font>W <font color="#000080">+ </font>N4UFE20
<font color="#000080">+ + - </font>JWyn2LUUaWUyyJE1ckE <font color="#000080">- </font>RmUc <font color="#000080">+ </font>JMjgWYs8jbg <font color="#000080">+ </font>u92 <font color="#000080">+ </font>LQc8 <font color="#000080">+ </font><font color="#800000">9</font>tv <font color="#000080">+ </font>Cg6jdc <font color="#000080">+ </font>ukCyeU <font color="#000080">- </font>JWykn
mMgK <font color="#000080">+ + </font><font color="#800000">081</font>U <font color="#000080">+ + </font><font color="#800000">8</font>gd <font color="#000080">- </font>IJ7Ku9o <font color="#000080">+ </font>LZdNzgMuBU2 <font color="#000080">+ </font>RixRmUE <font color="#000080">+ </font><font color="#800000">5</font>cda <font color="#000080">- </font>gJq02Nm3em9qCmc <font color="#000080">+ </font>LLvyimc
<font color="#000080">+ </font>LHvWwCfyy9g5wCgey9w5wC8FUW8NUNm36jMv8U <font color="#000080">- </font>RTjuv8U <font color="#000080">- </font>RDi9kujvsiz1wuj15UMTWzT2
TUPc2E07TUMTklv3RUPc <font color="#000080">- </font>E07RUMTkr6JfMjMv8U <font color="#000080">- </font>RTjuv8U <font color="#000080">- </font>RDi9kujvsin1wuL1WZMCzgc0
<font color="#800000">3</font>U <font color="#000080">+ + </font>QZMu3U <font color="#000080">+ + </font>Rp08RUnynU6q <font color="#000080">+ </font>E <font color="#000080">- </font>mFHcq <font color="#000080">+ </font>E <font color="#000080">- </font>rDn9hsniU <font color="#000080">+ + + </font>ekjv <font color="#000080">+ </font>CgVm <font color="#000080">+ </font>cf6i2 <font color="#000080">+ + </font>Xg08lWPq
<font color="#800000">7</font>Yc <font color="#000080">+ </font>AjM1kh5UWzWs <font color="#000080">+ </font><font color="#800000">9</font>UaU1t7 <font color="#000080">+ + </font>Rp <font color="#000080">+ </font>fGkXg0uqUDwU1s <font color="#000080">+ + + </font><font color="#800000">5</font>ztgCV <font color="#000080">+ + + </font>f <font color="#000080">- </font>U <font color="#000080">+ + - </font>E2 <font color="#000080">- </font>xiHFsAja
b2k <font color="#000080">+ </font>l <font color="#000080">+ </font>dI <font color="#000080">+ </font>gEOJ <font color="#000080">+ </font><font color="#800000">9273E0</font>l0ZI <font color="#000080">+ </font>gEiJ <font color="#000080">+ </font><font color="#800000">92</font>BkM <font color="#000080">- + </font>gEv <font color="#000080">- </font>U21l2o4 <font color="#000080">+ </font>ED2pkM <font color="#000080">- + </font>gHR <font color="#000080">- </font>U21lCU4 <font color="#000080">+ </font>E92
vUM <font color="#000080">- + </font>wHr <font color="#000080">- </font>U21lGk4 <font color="#000080">+ </font>E53AkM <font color="#000080">- + </font>wIr <font color="#000080">- </font>U20Gcc0 <font color="#000080">+ + - </font>o
<font color="#000080">* * * * * </font><font color="#FF0000"><b>END OF </b></font>BLOCK <font color="#800000">1 </font><font color="#000080">* * * * *


</font><font color="#008000"><i>{--------------------------------   ASSEMBLY CODE ---------------------}
{ COMPILE THE FOLLOWING WITH TASM                                      }

</i></font><font color="#000080">; </font><font color="#008000"><i>{*** WIN.ASM ***}

        </i></font>TITLE   WIN

        LOCALS  <font color="#000080">@@
 </font>P286

<font color="#000080">; </font>Coordinate <font color="#FF0000"><b>RECORD

</b></font>X               EQU     <font color="#000080">(</font>BYTE PTR <font color="#800000">0</font><font color="#000080">)
</font>Y               EQU     <font color="#000080">(</font>BYTE PTR <font color="#800000">1</font><font color="#000080">)

; </font>BIOS workspace equates

CrtMode         EQU     <font color="#000080">(</font>BYTE PTR <font color="#800000">49</font>H<font color="#000080">)
</font>CrtWidth        EQU     <font color="#000080">(</font>BYTE PTR <font color="#800000">4</font>AH<font color="#000080">)

</font>DATA    SEGMENT WORD <font color="#FF0000"><b>PUBLIC

</b></font><font color="#000080">; </font>Externals from CRT <font color="#FF0000"><b>UNIT

        </b></font>EXTRN   CheckSnow <font color="#000080">: </font>BYTE<font color="#000080">, </font>WindMin <font color="#000080">: </font>WORD<font color="#000080">, </font>WindMax <font color="#000080">: </font>WORD

DATA    ENDS

CODE    SEGMENT BYTE <font color="#FF0000"><b>PUBLIC

        </b></font>ASSUME  CS <font color="#000080">: </font>CODE<font color="#000080">, </font>DS <font color="#000080">: </font>DATA

<font color="#000080">; </font><font color="#FF0000"><b>PROCEDURE </b></font>WriteStr <font color="#000080">(</font>X<font color="#000080">, </font>Y <font color="#000080">: </font>BYTE<font color="#000080">; </font>S <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">; </font>Attr <font color="#000080">: </font>BYTE<font color="#000080">);

        </font><font color="#FF0000"><b>PUBLIC  </b></font>WriteStr

WriteStr <font color="#000080">:

        </font>PUSH    BP
MOV     BP<font color="#000080">, </font>SP
        LES     BX<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">]
        </font>MOV     CL<font color="#000080">, </font>ES <font color="#000080">: [</font>BX<font color="#000080">]
        </font>MOV     SI<font color="#000080">, </font>OFFSET CS <font color="#000080">: </font>CrtWriteStr
        CALL    CrtWrite
        POP     BP
        RETF    <font color="#800000">10

</font><font color="#000080">; </font><font color="#FF0000"><b>PROCEDURE </b></font>WriteChar <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Count <font color="#000080">: </font>BYTE<font color="#000080">; </font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Attr <font color="#000080">: </font>BYTE<font color="#000080">);

        </font><font color="#FF0000"><b>PUBLIC  </b></font>WriteChar

WriteChar <font color="#000080">:

        </font>PUSH    BP
        MOV     BP<font color="#000080">, </font>SP
        MOV     CL<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">10</font><font color="#000080">]
        </font>MOV     SI<font color="#000080">, </font>OFFSET CS <font color="#000080">: </font>CrtWriteChar
CALL    CrtWrite
        POP     BP
        RETF    <font color="#800000">10

</font><font color="#000080">; </font><font color="#FF0000"><b>PROCEDURE </b></font>FillWin <font color="#000080">(</font>Ch <font color="#000080">: </font>CHAR<font color="#000080">; </font>Attr <font color="#000080">: </font>BYTE<font color="#000080">);

        </font><font color="#FF0000"><b>PUBLIC  </b></font>FillWin

FillWin <font color="#000080">:

        </font>MOV     SI<font color="#000080">, </font>OFFSET CS <font color="#000080">: </font>CrtWriteChar
        JMP     SHORT CommonWin

<font color="#000080">; </font><font color="#FF0000"><b>PROCEDURE </b></font>ReadWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">);

        </font><font color="#FF0000"><b>PUBLIC  </b></font>ReadWin

ReadWin <font color="#000080">:

        </font>MOV     SI<font color="#000080">, </font>OFFSET CS <font color="#000080">: </font>CrtReadWin
        JMP     SHORT CommonWin

<font color="#000080">; </font><font color="#FF0000"><b>PROCEDURE </b></font>WriteWin <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Buf<font color="#000080">);

        </font><font color="#FF0000"><b>PUBLIC  </b></font>WriteWin

WriteWin <font color="#000080">:

        </font>MOV     SI<font color="#000080">, </font>OFFSET CS <font color="#000080">: </font>CrtWriteWin

<font color="#000080">; </font>Common FillWin <font color="#000080">/ </font>ReadWin <font color="#000080">/ </font>WriteWin routine

CommonWin <font color="#000080">:

        </font>PUSH    BP
        MOV     BP<font color="#000080">, </font>SP
<font color="#FF0000"><b>XOR     </b></font>CX<font color="#000080">, </font>CX
        MOV     DX<font color="#000080">, </font>WindMin
        MOV     CL<font color="#000080">, </font>WindMax<font color="#000080">.</font>X
        SUB     CL<font color="#000080">, </font>DL
        INC     CX
<font color="#000080">@@</font><font color="#800000">1 </font><font color="#000080">:    </font>PUSH    CX
        PUSH    DX
        PUSH    SI
        CALL    CrtBlock
        POP     SI
        POP     DX
        POP     CX
        INC     DH
        CMP     DH<font color="#000080">, </font>WindMax<font color="#000080">.</font>Y
        JBE     <font color="#000080">@@</font><font color="#800000">1
        </font>POP     BP
        RETF    <font color="#800000">4

</font><font color="#000080">; </font>WRITE <font color="#FF0000"><b>STRING TO </b></font>screen

CrtWriteStr <font color="#000080">:

        </font>PUSH    DS
        MOV     AH<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]
        </font>LDS     SI<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">]
        </font>INC     SI
        JC      <font color="#000080">@@</font><font color="#800000">4
</font><font color="#000080">@@</font><font color="#800000">1 </font><font color="#000080">:    </font>LODSB
        MOV     BX<font color="#000080">, </font>AX
<font color="#000080">@@</font><font color="#800000">2 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
        TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JNE     <font color="#000080">@@</font><font color="#800000">2
        </font>CLI
<font color="#000080">@@</font><font color="#800000">3 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
        TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JE      <font color="#000080">@@</font><font color="#800000">3
</font>MOV     AX<font color="#000080">, </font>BX
        STOSW
        STI
        LOOP    <font color="#000080">@@</font><font color="#800000">1
        </font>POP     DS
        RET
<font color="#000080">@@</font><font color="#800000">4 </font><font color="#000080">:    </font>LODSB
        STOSW
        LOOP    <font color="#000080">@@</font><font color="#800000">4
        </font>POP     DS
        RET

<font color="#000080">; </font>WRITE characters <font color="#FF0000"><b>TO </b></font>screen

CrtWriteChar <font color="#000080">:

        </font>MOV     AL<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">8</font><font color="#000080">]
        </font>MOV     AH<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]
</font>JC      <font color="#000080">@@</font><font color="#800000">4
        </font>MOV     BX<font color="#000080">, </font>AX
<font color="#000080">@@</font><font color="#800000">1 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
        TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JNE     <font color="#000080">@@</font><font color="#800000">1
        </font>CLI
<font color="#000080">@@</font><font color="#800000">2 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
        TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JE      <font color="#000080">@@</font><font color="#800000">2
        </font>MOV     AX<font color="#000080">, </font>BX
        STOSW
        STI
        LOOP    <font color="#000080">@@</font><font color="#800000">1
        </font>RET
<font color="#000080">@@</font><font color="#800000">4 </font><font color="#000080">:    </font>REP     STOSW
        RET

<font color="#000080">; </font>READ WINDOW buffer from screen

CrtReadWin <font color="#000080">:

        </font>PUSH    DS
        PUSH    ES
        POP     DS
        MOV     SI<font color="#000080">, </font>DI
        LES     DI<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]
        </font>CALL    CrtCopyWin
        MOV     <font color="#000080">[</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">], </font>DI
        POP     DS
        RET

<font color="#000080">; </font>WRITE WINDOW buffer <font color="#FF0000"><b>TO </b></font>screen

CrtWriteWin <font color="#000080">:

        </font>PUSH    DS
LDS     SI<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]
        </font>CALL    CrtCopyWin
        MOV     <font color="#000080">[</font>BP <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">], </font>SI
        POP     DS
        RET

<font color="#000080">; </font>WINDOW buffer COPY routine

CrtCopyWin <font color="#000080">:

        </font>JC      <font color="#000080">@@</font><font color="#800000">4
</font><font color="#000080">@@</font><font color="#800000">1 </font><font color="#000080">:    </font>LODSW
        MOV     BX<font color="#000080">, </font>AX
<font color="#000080">@@</font><font color="#800000">2 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
        TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JNE     <font color="#000080">@@</font><font color="#800000">2
        </font>CLI
<font color="#000080">@@</font><font color="#800000">3 </font><font color="#000080">:    </font><font color="#FF0000"><b>IN      </b></font>AL<font color="#000080">, </font>DX
TEST    AL<font color="#000080">, </font><font color="#800000">1
        </font>JE      <font color="#000080">@@</font><font color="#800000">3
        </font>MOV     AX<font color="#000080">, </font>BX
        STOSW
        STI
        LOOP    <font color="#000080">@@</font><font color="#800000">1
        </font>RET
<font color="#000080">@@</font><font color="#800000">4 </font><font color="#000080">:    </font>REP     MOVSW
        RET

<font color="#000080">; </font><font color="#FF0000"><b>DO </b></font>screen operation
<font color="#000080">; </font><font color="#FF0000"><b>IN    </b></font>CL <font color="#000080">= </font>Buffer LENGTH
<font color="#000080">;       </font>SI <font color="#000080">= </font>WRITE <font color="#FF0000"><b>PROCEDURE </b></font>POINTER
<font color="#000080">;       </font>BP <font color="#000080">= </font>Stack frame POINTER

CrtWrite <font color="#000080">:

        </font>MOV     DL<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">14</font><font color="#000080">]
</font>DEC     DL
        ADD     DL<font color="#000080">, </font>WindMin<font color="#000080">.</font>X
        JC      CrtExit
        CMP     DL<font color="#000080">, </font>WindMax<font color="#000080">.</font>X
        JA      CrtExit
        MOV     DH<font color="#000080">, [</font>BP <font color="#000080">+ </font><font color="#800000">12</font><font color="#000080">]
        </font>DEC     DH
        ADD     DH<font color="#000080">, </font>WindMin<font color="#000080">.</font>Y
        JC      CrtExit
        CMP     DH<font color="#000080">, </font>WindMax<font color="#000080">.</font>Y
        JA      CrtExit
        <font color="#FF0000"><b>XOR     </b></font>CH<font color="#000080">, </font>CH
        JCXZ    CrtExit
        MOV     AL<font color="#000080">, </font>WindMax<font color="#000080">.</font>X
        SUB     AL<font color="#000080">, </font>DL
        INC     AL
        CMP     CL<font color="#000080">, </font>AL
        JB      CrtBlock
MOV     CL<font color="#000080">, </font>AL

<font color="#000080">; </font><font color="#FF0000"><b>DO </b></font>screen operation
<font color="#000080">; </font><font color="#FF0000"><b>IN    </b></font>CL <font color="#000080">= </font>Buffer LENGTH
<font color="#000080">;       </font>DX <font color="#000080">= </font>CRT coordinates
<font color="#000080">;       </font>SI <font color="#000080">= </font><font color="#FF0000"><b>PROCEDURE </b></font>POINTER

CrtBlock <font color="#000080">:

        </font>MOV     AX<font color="#000080">, </font><font color="#800000">40</font>H
        MOV     ES<font color="#000080">, </font>AX
        MOV     AL<font color="#000080">, </font>DH
        MUL     ES <font color="#000080">: </font>CrtWidth
        <font color="#FF0000"><b>XOR     </b></font>DH<font color="#000080">, </font>DH
        ADD     AX<font color="#000080">, </font>DX
        <font color="#FF0000"><b>SHL     </b></font>AX<font color="#000080">, </font><font color="#800000">1
        </font>MOV     DI<font color="#000080">, </font>AX
        MOV     AX<font color="#000080">, </font><font color="#800000">0</font>B800H
CMP     ES <font color="#000080">: </font>CrtMode<font color="#000080">, </font><font color="#800000">7
        </font>JNE     <font color="#000080">@@</font><font color="#800000">1
        </font>MOV     AH<font color="#000080">, </font><font color="#800000">0</font>B0H
<font color="#000080">@@</font><font color="#800000">1 </font><font color="#000080">:    </font>MOV     ES<font color="#000080">, </font>AX
        MOV     DX<font color="#000080">, </font><font color="#800000">03</font>DAH
        CLD
        CMP     CheckSnow<font color="#000080">, </font><font color="#800000">1
        </font>JMP     SI

<font color="#000080">; </font>EXIT from screen operation

CrtExit <font color="#000080">:

        </font>RET

<font color="#000080">; </font><font color="#FF0000"><b>FUNCTION </b></font>WinSize <font color="#000080">: </font>WORD<font color="#000080">;

        </font><font color="#FF0000"><b>PUBLIC  </b></font>WinSize

WinSize <font color="#000080">:

</font>MOV     AX<font color="#000080">, </font>WindMax
SUB     AX<font color="#000080">, </font>WindMin
ADD     AX<font color="#000080">, </font><font color="#800000">101</font>H
MUL     AH
<font color="#FF0000"><b>SHL     </b></font>AX<font color="#000080">, </font><font color="#800000">1
</font>RETF

CODE    ENDS

<font color="#FF0000"><b>END


</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
