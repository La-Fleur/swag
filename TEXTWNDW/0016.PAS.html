<html>
<head><title> "Pausing Text Output" by TODD JACOBS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I can't find a procedure to call and display a text
&gt; to the screen inside a window [window(1,2,80,24)] and be able to put pauses
&gt; scrolling into it if'n it takes up more than 23 lines of text.

I took a swing at this when I saw your message.  I wrote a little unit called
BuffrTxt that should be pretty self-explainatory, since I was so generous
with my comments.  Is this pretty much what you were looking for?

{ **********************************************************************
  *                           BufferText                               *
  *                               by                                   *
  *                         Todd A. Jacobs                            *
  *                                                                   *
  *        Buffers a text file to prevent a view port overflow.        *
  **********************************************************************

This code is hereby released into the public domain.  This program was an
excercise I did when someone asked about how to read a text file into a
text window without having it all scroll off the screen.

This unit buffers the text into an array which is based on how many lines
exist between the upper and lower boundaries of the window.  One of the
problems with doing it this way is that if the text read in is the same
width as the view port, it will wrap--thereby throwing off the buffer.  To
&quot;solve&quot; this, I elected to truncate the lines to prevent wrapping. }

</i></font><font color="#FF0000"><b>Unit </b></font>BuffrTxt<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Var
  </b></font>Lines <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#008000"><i>{Example parameters for DefineWindow:

    DefineWindow (10, 3, 70, 23, 1, 15);

The first four XY parameters are self-explanitory.  BG &amp; FG set the
background and foreground colors for the text viewport. }
</i></font><font color="#FF0000"><b>Procedure </b></font>DefineWindow <font color="#000080">(</font>ULeftX<font color="#000080">, </font>ULeftY<font color="#000080">, </font>LRightX<font color="#000080">, </font>LRightY<font color="#000080">, </font>BG<font color="#000080">, </font>FG <font color="#000080">: </font>BYTE<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>ReadFile <font color="#000080">(</font>FileName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#008000"><i>{By keeping all the details hidden inside the implementation, you won't
have to recompile every piece of source you have used this with if you
change one of the constants, because the interface will remain the same. }
</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>PauseStr <font color="#000080">= </font><font color="#800000">'-=[ Press any key to continue ]=-'</font><font color="#000080">;
  </font>MaxScrWidth <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;
  </font>MaxArraySize <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DefineWindow<font color="#000080">;
</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{DefineWindow}
  </i></font>Lines <font color="#000080">:= </font>LRightY <font color="#000080">- </font>ULeftY<font color="#000080">; </font><font color="#008000"><i>{Sets boundaries for use in ReadFile}
  </i></font>Window <font color="#000080">(</font>ULeftX<font color="#000080">, </font>ULeftY<font color="#000080">, </font>LRightX<font color="#000080">, </font>LRightY<font color="#000080">);
  </font>TextBackground <font color="#000080">(</font>BG<font color="#000080">);
  </font>TextColor <font color="#000080">(</font>FG<font color="#000080">);
  </font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{DefineWindow}

</i></font><font color="#FF0000"><b>Procedure </b></font>ReadFile<font color="#000080">;

</font><font color="#008000"><i>{Set the size of the array from the window boundaries as defined in
the constants}
</i></font><font color="#FF0000"><b>Type
  </b></font>StringArray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxArraySize<font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font>MaxScrWidth<font color="#000080">];
</font><font color="#FF0000"><b>Var
  </b></font>F<font color="#000080">: </font>Text<font color="#000080">;
  </font>TmpBuf<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font>MaxScrWidth<font color="#000080">]; </font><font color="#008000"><i>{Will truncate longer lines to prevent wrap}
  </i></font>StrBuf<font color="#000080">: </font>StringArray<font color="#000080">;  </font><font color="#008000"><i>{This buffer holds 25 lines of 80 cols each}
  </i></font>Counter1<font color="#000080">, </font>Counter2<font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{ReadFile}
  </i></font>Assign<font color="#000080">(</font>F<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>F<font color="#000080">);
  </font><font color="#FF0000"><b>While not </b></font>Eof<font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>do
  Begin
    </b></font><font color="#008000"><i>{Initialize the counters each time through the loop}
    </i></font>Counter1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Counter2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>Repeat  </b></font><font color="#008000"><i>{This is where the buffer is restricted to Y2 - Y1 Lines}
     </i></font>Inc <font color="#000080">(</font>Counter1<font color="#000080">);
     </font>Readln<font color="#000080">(</font>F<font color="#000080">, </font>TmpBuf<font color="#000080">);
     </font>StrBuf<font color="#000080">[</font>Counter1<font color="#000080">] := </font>TmpBuf<font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>Eof<font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Counter1 <font color="#000080">= </font>Lines<font color="#000080">);  </font><font color="#008000"><i>{Also prevents reading past EOF}

    {Write buffered lines to the screen}
    </i></font><font color="#FF0000"><b>For </b></font>Counter2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Counter1 <font color="#FF0000"><b>do
     </b></font>Writeln <font color="#000080">(</font>StrBuf<font color="#000080">[</font>Counter2<font color="#000080">]);
    </font>Write <font color="#000080">(</font>PauseStr<font color="#000080">);
    </font>Readln<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{Goes back for more buffering &quot;while not EOF&quot;}
  </i></font>Close<font color="#000080">(</font>F<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ReadFile}

</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">.  </font><font color="#008000"><i>{Unit}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0016.PAS">Original</a><b>]</b></p></body>
</html>
