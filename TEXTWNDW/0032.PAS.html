<html>
<head><title> "Textual Windows Unit" by ALEKSANDAR DLABAC</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">  <font color="#FF0000"><b>Unit </b></font>TextWin<font color="#000080">;
</font><font color="#008000"><i>{
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;          Textual windows unit        &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;           Aleksandar Dlabac          &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;    (C) 1992. Dlabac Bros. Company    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;    ------------------------------    &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.urc.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;      adlabac@urcpg.pmf.cg.ac.yu      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&Ucirc;&Ucirc;                                      &Ucirc;&Ucirc;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Yacute;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&THORN;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
             &Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&Ucirc;&plusmn;&plusmn;
               &plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;&plusmn;
}
   </i></font><font color="#FF0000"><b>Interface

   Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

   </font><font color="#FF0000"><b>Type </b></font>TextMem  <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">25</font><font color="#000080">] </font><font color="#FF0000"><b>of Record
                                           </b></font>Char<font color="#000080">, </font>Attr <font color="#000080">: </font>byte
                                         <font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font>MenuInfo <font color="#000080">= </font><font color="#FF0000"><b>Record
                     </b></font>Border<font color="#000080">, </font>Text<font color="#000080">, </font>Bar<font color="#000080">, </font>Hot <font color="#000080">: </font>byte
                   <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Const </b></font>MaxWindow <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
         </font>MaxDepth  <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
         </font>Save      <font color="#000080">= </font>True<font color="#000080">;  </font>DontSave    <font color="#000080">= </font>False<font color="#000080">;
         </font>LeftUp    <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">; </font>RightUp  <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">; </font>LeftDown  <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">; </font>RightDown  <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
         </font>ActivW    <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
         </font>ESC   <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">; </font>Up   <font color="#000080">= </font><font color="#800000">#72</font><font color="#000080">; </font>Down <font color="#000080">= </font><font color="#800000">#80</font><font color="#000080">; </font>CR    <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;
         </font>BAKSP <font color="#000080">= </font><font color="#800000">#8</font><font color="#000080">;  </font>Home <font color="#000080">= </font><font color="#800000">#71</font><font color="#000080">; </font>Endt <font color="#000080">= </font><font color="#800000">#79</font><font color="#000080">; </font>Empty <font color="#000080">= </font><font color="#800000">#255</font><font color="#000080">;

   </font><font color="#FF0000"><b>Var </b></font>MaxX<font color="#000080">, </font>MaxY   <font color="#000080">: </font>integer<font color="#000080">;
       </font>TextModeInfo <font color="#000080">: </font><font color="#FF0000"><b>Record
                        </b></font>Adress <font color="#000080">: </font>word<font color="#000080">;
                        </font>Wid    <font color="#000080">: </font>byte<font color="#000080">;
                        </font>CharH  <font color="#000080">: </font>byte
                      <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function  </b></font>InKey <font color="#000080">: </font>char<font color="#000080">;
   </font><font color="#008000"><i>{ InKey is similar to ReadKey, but do not wait if key is not pressed, in
     which case returns value &quot;Empty&quot; (#255). }

   </i></font><font color="#FF0000"><b>Function  </b></font>Attribute <font color="#000080">(</font>Color<font color="#000080">,</font>Background<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
   </font><font color="#008000"><i>{ Returns corresponding attribute for given color and backgroung. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>TestTextMode<font color="#000080">;
   </font><font color="#008000"><i>{ Gets informations about current text mode: number of collumns and
     video address segment. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">;
   </font><font color="#008000"><i>{ Make cursor invisible. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">;
   </font><font color="#008000"><i>{ Make cursor visible. }

   </i></font><font color="#FF0000"><b>Function  </b></font>GetChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
   </font><font color="#008000"><i>{ Returns ASCII code of character at screen position (X,Y) }

   </i></font><font color="#FF0000"><b>Function  </b></font>GetAttr <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
   </font><font color="#008000"><i>{ Returns attributes of character at screen position (X,Y) }

   </i></font><font color="#FF0000"><b>Procedure </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Char<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#008000"><i>{ Puts character on screen. Parameters are:
       X, Y - Screen coordinates where character will be placed.
       Char - ASCII code of character to write.
       Attr - Attribute of character to write. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>GetScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>TextMem<font color="#000080">);
   </font><font color="#008000"><i>{ Stores a part of screen to buffer. Parameters are:
       X, Y - Coordinates of upper left corner of rectangular area to
              be stored.
       W, H - Width and height of rectangular area to be sotred,
              respectivelly.
       A    - Buffer variable. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>PutScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font>A<font color="#000080">:</font>TextMem<font color="#000080">);
   </font><font color="#008000"><i>{ Restores a part of screen from buffer. Parameters are the same as
     in procedure GetScrPart. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>TextRectangle <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#008000"><i>{ Draws a rectangle. Parameters are:
       X, Y - Coordinates of upper left corner of rectangle.
       W, H - Width and height of rectangle, respectivelly. }

   </i></font><font color="#FF0000"><b>Function  </b></font>AvailableWindow <font color="#000080">: </font>byte<font color="#000080">;
   </font><font color="#008000"><i>{ AvailableWindow returns Number of first available window handle }

   </i></font><font color="#FF0000"><b>Procedure </b></font>OpenWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font>Attr<font color="#000080">:</font>byte<font color="#000080">; </font>SaveFlg<font color="#000080">:</font>Boolean<font color="#000080">);
   </font><font color="#008000"><i>{ Opens a new window. Parameters are:
       Wn      - window handle (0-MaxWindow) of new window. There must not be
                 another window with same handle. Recomended use od
                 AvailableWindow function.
       X, Y    - Coordinates of upper left corner of window.
       W, H    - Width and height of window.
       Attr    - Atributes of window border. Color inside window will be the
                 same color settled by TextColor/TextBackground procedures.
       SaveFlg - If set to True content of screen will be restored after
                 closing this window. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>ActiveWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#008000"><i>{ Sets active window to window which handle is Ws.
     WARNING: Should not be used if there is overlaped windows (except 0).
              Should be used for latest opened window only.}

   </i></font><font color="#FF0000"><b>Procedure </b></font>CloseWindow<font color="#000080">;
   </font><font color="#008000"><i>{ Closes active window }

   </i></font><font color="#FF0000"><b>Procedure </b></font>MoveWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">);
   </font><font color="#008000"><i>{ Moves window Wn to new coordinate (X,Y) }

   </i></font><font color="#FF0000"><b>Procedure </b></font>OpenMenu <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">; </font>Corn<font color="#000080">:</font>byte<font color="#000080">; </font>Menu<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Answer<font color="#000080">:</font>byte<font color="#000080">; </font>Info<font color="#000080">:</font>MenuInfo<font color="#000080">);
   </font><font color="#008000"><i>{ OpenMenu opens a menu. Parameters are:
       X, Y   - Coordinates of one corner.
       Corn   - Defines which corner is given by (X,Y). Values of Corn can be
                LeftUp, RightUp, LeftDown, RightDown.
       Menu   - String containing menu items. Items should be separated by
                comma (&quot;,&quot;). Maximum &quot;MaxOpt&quot; (20) options allowed. For
                example if Menu='First,Second,tHird', menu on screen will
                have three options:
                    First
                    Second
                    tHird
                First upper case in option is hotkey. Pressing &quot;H&quot; key when
                  menu is oppened will cause selecting of third option.
       Answer - If nonzero returns Number of selecter option, otherwise
                ESC taster is pressed, or clicked outside of the menu.
       Info   - Menu color informations. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>OpenBox <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Corn<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
   </font><font color="#008000"><i>{ Opens a temporary window (for messages, for example) with single border.
     Parameters are:
       X, Y, Corn - Same like in OpenMenu.
       W, H       - Width and height of box.
       Attr       - atributes of box. }

   </i></font><font color="#FF0000"><b>Procedure </b></font>CloseTemp<font color="#000080">;
   </font><font color="#008000"><i>{ Closes temporary window }

   </i></font><font color="#FF0000"><b>Implementation

   Const </b></font>Depth  <font color="#000080">: </font>shortint <font color="#000080">= -</font><font color="#800000">1</font><font color="#000080">;

   </font><font color="#FF0000"><b>Var   </b></font>Windat <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxWindow<font color="#000080">] </font><font color="#FF0000"><b>of Record
                                            </b></font>Open<font color="#000080">, </font>SaveFlag <font color="#000080">: </font>Boolean<font color="#000080">;
                                            </font>Xw<font color="#000080">, </font>Yw<font color="#000080">, </font>Ww<font color="#000080">, </font>Hw<font color="#000080">,
                                            </font>Xcur<font color="#000080">, </font>Ycur     <font color="#000080">: </font>integer<font color="#000080">;
                                            </font>TextBit        <font color="#000080">: </font>TextMem<font color="#000080">;
                                            </font>PrevWind       <font color="#000080">: </font>byte
                                          <font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font>Gd<font color="#000080">, </font>Gm <font color="#000080">: </font>integer<font color="#000080">;

   </font><font color="#FF0000"><b>Function </b></font>InKey <font color="#000080">: </font>char<font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>T <font color="#000080">: </font>char<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font>KeyPressed <font color="#FF0000"><b>then </b></font>T<font color="#000080">:=</font>ReadKey <font color="#FF0000"><b>else </b></font>T<font color="#000080">:=</font>Empty<font color="#000080">;
         </font>InKey<font color="#000080">:=</font>T
       <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function  </b></font>Attribute <font color="#000080">(</font>Color<font color="#000080">,</font>Background<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       </b></font>Attribute<font color="#000080">:=</font>Background <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">+</font>Color <font color="#FF0000"><b>and </b></font><font color="#800000">$0F
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>TestTextMode<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       With </b></font>TextModeInfo <font color="#FF0000"><b>do
         Begin
           If </b></font>Mem <font color="#000080">[</font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0449</font><font color="#000080">]=</font><font color="#800000">7 </font><font color="#FF0000"><b>then </b></font>Adress<font color="#000080">:=</font><font color="#800000">$B000
                                  </font><font color="#FF0000"><b>else </b></font>Adress<font color="#000080">:=</font><font color="#800000">$B800</font><font color="#000080">;
             </font><font color="#FF0000"><b>Case </b></font>Mem <font color="#000080">[</font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0449</font><font color="#000080">] </font><font color="#FF0000"><b>of
               </b></font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1    </font><font color="#000080">: </font>Wid<font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">;
               </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">7 </font><font color="#000080">: </font>Wid<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;
               </font><font color="#FF0000"><b>else      </b></font>Wid<font color="#000080">:=</font><font color="#800000">0
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font>CharH<font color="#000080">:=</font>Mem <font color="#000080">[</font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0485</font><font color="#000080">]
         </font><font color="#FF0000"><b>End
     End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Regs <font color="#000080">: </font>registers<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         With </b></font>Regs <font color="#FF0000"><b>do
           Begin
             </b></font>AH<font color="#000080">:=</font><font color="#800000">01</font><font color="#000080">;
             </font>CH<font color="#000080">:=</font><font color="#800000">$20</font><font color="#000080">;
             </font>CL<font color="#000080">:=</font><font color="#800000">$20
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>Intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">)
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Regs <font color="#000080">: </font>registers<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         With </b></font>Regs <font color="#FF0000"><b>do
           Begin
             </b></font>AH<font color="#000080">:=</font><font color="#800000">01</font><font color="#000080">;
             </font>CH<font color="#000080">:=</font>TextModeInfo<font color="#000080">.</font>CharH<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">;
             </font>CL<font color="#000080">:=</font>TextModeInfo<font color="#000080">.</font>CharH<font color="#000080">-</font><font color="#800000">2
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>Intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">)
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function  </b></font>GetChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       </b></font>GetChar<font color="#000080">:=</font>Mem <font color="#000080">[</font>TextModeInfo<font color="#000080">.</font>Adress<font color="#000080">:((</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function  </b></font>GetAttr <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>byte<font color="#000080">) : </font>byte<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       </b></font>GetAttr<font color="#000080">:=</font>Mem <font color="#000080">[</font>TextModeInfo<font color="#000080">.</font>Adress<font color="#000080">:((</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Char<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
     </font><font color="#FF0000"><b>Begin
       </b></font>Mem <font color="#000080">[</font>TextModeInfo<font color="#000080">.</font>Adress<font color="#000080">:((</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]:=</font>Char<font color="#000080">;
       </font>Mem <font color="#000080">[</font>TextModeInfo<font color="#000080">.</font>Adress<font color="#000080">:((</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+</font>X<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>Attr
     <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>GetScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>A<font color="#000080">:</font>TextMem<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>J <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         </b></font>Dec <font color="#000080">(</font>W<font color="#000080">);
         </font>Dec <font color="#000080">(</font>H<font color="#000080">);
         </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">80 </font><font color="#FF0000"><b>do
           For </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#FF0000"><b>do
             Begin
               </b></font>A <font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">].</font>Char<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>A <font color="#000080">[</font>I<font color="#000080">,</font>J<font color="#000080">].</font>Attr<font color="#000080">:=</font><font color="#800000">0
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>With </b></font>TextModeInfo <font color="#FF0000"><b>do
           Begin
             If </b></font><font color="#000080">(</font>X<font color="#000080">&lt;=</font>Wid<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y<font color="#000080">&lt;=</font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>then
               Begin
                 If </b></font>X<font color="#000080">+</font>W<font color="#000080">&gt;</font>Wid <font color="#FF0000"><b>then </b></font>W<font color="#000080">:=</font>Wid<font color="#000080">-</font>X<font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">+</font>H<font color="#000080">&gt;</font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>H<font color="#000080">:=</font><font color="#800000">25</font><font color="#000080">-</font>Y<font color="#000080">;
                 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>Y <font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>H <font color="#FF0000"><b>do
                   For </b></font>J<font color="#000080">:= </font>X <font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>W <font color="#FF0000"><b>do
                     With </b></font>A <font color="#000080">[</font>J<font color="#000080">-</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">-</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>do
                       Begin
                         </b></font>Char<font color="#000080">:=</font>GetChar <font color="#000080">(</font>J<font color="#000080">,</font>I<font color="#000080">);
                         </font>Attr<font color="#000080">:=</font>GetAttr <font color="#000080">(</font>J<font color="#000080">,</font>I<font color="#000080">);
                       </font><font color="#FF0000"><b>End
               End
           End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>PutScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font>A<font color="#000080">:</font>TextMem<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>J <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         </b></font>Dec <font color="#000080">(</font>W<font color="#000080">);
         </font>Dec <font color="#000080">(</font>H<font color="#000080">);
         </font><font color="#FF0000"><b>With </b></font>TextModeInfo <font color="#FF0000"><b>do
           Begin
             If </b></font><font color="#000080">(</font>X<font color="#000080">&lt;=</font>Wid<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Y<font color="#000080">&lt;=</font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>then
               Begin
                 If </b></font>X<font color="#000080">+</font>W<font color="#000080">&gt;</font>Wid <font color="#FF0000"><b>then </b></font>W<font color="#000080">:=</font>Wid<font color="#000080">-</font>X<font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">+</font>H<font color="#000080">&gt;</font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>H<font color="#000080">:=</font><font color="#800000">25</font><font color="#000080">-</font>Y<font color="#000080">;
                 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>Y <font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>H <font color="#FF0000"><b>do
                   For </b></font>J<font color="#000080">:= </font>X <font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>W <font color="#FF0000"><b>do
                     With </b></font>A <font color="#000080">[</font>J<font color="#000080">-</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">-</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>do
                       </b></font>PutChar <font color="#000080">(</font>J<font color="#000080">,</font>I<font color="#000080">,</font>Char<font color="#000080">,</font>Attr<font color="#000080">)
               </font><font color="#FF0000"><b>End
           End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>TextRectangle <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>I <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font>X<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>X<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Y<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>W<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>W<font color="#000080">:=-</font>W<font color="#000080">; </font>Dec <font color="#000080">(</font>X<font color="#000080">,</font>W<font color="#000080">);
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>H<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>H<font color="#000080">:=-</font>H<font color="#000080">; </font>Dec <font color="#000080">(</font>Y<font color="#000080">,</font>H<font color="#000080">);
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>X<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Y<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>W<font color="#000080">&lt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>H<font color="#000080">&lt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or
            </b></font><font color="#000080">(</font>W<font color="#000080">&gt;</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">-</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>H<font color="#000080">&gt;</font><font color="#800000">26</font><font color="#000080">-</font>Y<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>Y<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
           Begin
             </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">179</font><font color="#000080">,</font>Attr<font color="#000080">);
             </font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">179</font><font color="#000080">,</font>Attr<font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font>X<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
           Begin
             </b></font>PutChar <font color="#000080">(</font>I<font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">196</font><font color="#000080">,</font>Attr<font color="#000080">);
             </font>PutChar <font color="#000080">(</font>I<font color="#000080">,</font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">196</font><font color="#000080">,</font>Attr<font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>PutChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">218</font><font color="#000080">,</font>Attr<font color="#000080">);
         </font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">191</font><font color="#000080">,</font>Attr<font color="#000080">);
         </font>PutChar <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font>Attr<font color="#000080">);
         </font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">217</font><font color="#000080">,</font>Attr<font color="#000080">)
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function </b></font>AvailableWindow <font color="#000080">: </font>byte<font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Temp <font color="#000080">: </font>byte<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         </b></font>Temp<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Temp<font color="#000080">&lt;=</font>MaxWindow<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>WinDat <font color="#000080">[</font>Temp<font color="#000080">].</font>Open <font color="#FF0000"><b>do </b></font>Inc <font color="#000080">(</font>Temp<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>Temp<font color="#000080">&gt;</font>MaxWindow <font color="#FF0000"><b>then </b></font>Temp<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
         </font>AvailableWindow<font color="#000080">:=</font>Temp
       <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>OpenWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>integer<font color="#000080">; </font>Attr<font color="#000080">:</font>byte<font color="#000080">; </font>SaveFlg<font color="#000080">:</font>Boolean<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>J <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font><font color="#000080">(</font>W<font color="#000080">&gt;</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>H<font color="#000080">&gt;</font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>W<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>W<font color="#000080">:=-</font>W<font color="#000080">; </font>Dec <font color="#000080">(</font>X<font color="#000080">,</font>W<font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>H<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
           Begin
             </b></font>H<font color="#000080">:=-</font>H<font color="#000080">; </font>Dec <font color="#000080">(</font>Y<font color="#000080">,</font>H<font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>X<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>X<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>Y<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>With </b></font>TextModeInfo <font color="#FF0000"><b>do If </b></font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">&gt;</font>Wid <font color="#FF0000"><b>then </b></font>X<font color="#000080">:=</font>Wid<font color="#000080">-</font>W<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">&gt;</font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>Y<font color="#000080">:=</font><font color="#800000">26</font><font color="#000080">-</font>H<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Wn<font color="#000080">&lt;=</font>MaxWindow <font color="#FF0000"><b>then
           With </b></font>windat <font color="#000080">[</font>Wn<font color="#000080">] </font><font color="#FF0000"><b>do
             Begin
               With </b></font>windat <font color="#000080">[</font>ActivW<font color="#000080">] </font><font color="#FF0000"><b>do
                 Begin
                   </b></font>Xcur<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Ycur<font color="#000080">:=</font>WhereY
                 <font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font>PrevWind<font color="#000080">:=</font>ActivW<font color="#000080">;
               </font>ActivW<font color="#000080">:=</font>Wn<font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>W<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                 Begin
                   </b></font>W<font color="#000080">:=-</font>W<font color="#000080">; </font>Dec <font color="#000080">(</font>X<font color="#000080">,</font>W<font color="#000080">)
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>H<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                 Begin
                   </b></font>H<font color="#000080">:=-</font>H<font color="#000080">; </font>Dec <font color="#000080">(</font>Y<font color="#000080">,</font>H<font color="#000080">)
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font>MaxX<font color="#000080">:=</font>W<font color="#000080">; </font>MaxY<font color="#000080">:=</font>H<font color="#000080">; </font>Xw<font color="#000080">:=</font>X<font color="#000080">; </font>Yw<font color="#000080">:=</font>Y<font color="#000080">; </font>Hw<font color="#000080">:=</font>H<font color="#000080">; </font>Ww<font color="#000080">:=</font>W<font color="#000080">;
               </font>Xcur<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">; </font>Ycur<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
               </font>SaveFlag<font color="#000080">:=</font>SaveFlg<font color="#000080">;
               </font>Open<font color="#000080">:=</font>True<font color="#000080">;
               </font><font color="#FF0000"><b>If </b></font>SaveFlag<font color="#000080">=</font>Save <font color="#FF0000"><b>then </b></font>GetScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>TextBit<font color="#000080">);
             </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>TextRectangle <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Attr<font color="#000080">);
         </font>Window <font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
         </font>ClrScr
       <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>ActiveWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">);
     </font><font color="#FF0000"><b>Begin
       If </b></font>Wn<font color="#000080">&lt;=</font>MaxWindow <font color="#FF0000"><b>then
         Begin
           With </b></font>Windat <font color="#000080">[</font>ActivW<font color="#000080">] </font><font color="#FF0000"><b>do
             Begin
               </b></font>Xcur<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Ycur<font color="#000080">:=</font>WhereY
             <font color="#FF0000"><b>End</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>With </b></font>Windat <font color="#000080">[</font>Wn<font color="#000080">] </font><font color="#FF0000"><b>do
             If </b></font>Open <font color="#FF0000"><b>then
               Begin
                 </b></font>ActivW<font color="#000080">:=</font>Wn<font color="#000080">;
                 </font>Window <font color="#000080">(</font>Xw<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Yw<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Xw<font color="#000080">+</font>Ww<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Yw<font color="#000080">+</font>Hw<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">);
                 </font>MaxX<font color="#000080">:=</font>Ww<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>MaxY<font color="#000080">:=</font>Hw<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
                 </font>GoToXY <font color="#000080">(</font>Xcur<font color="#000080">,</font>Ycur<font color="#000080">)
               </font><font color="#FF0000"><b>End
         End
     End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>CloseWindow<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       With </b></font>Windat <font color="#000080">[</font>ActivW<font color="#000080">] </font><font color="#FF0000"><b>do
         If </b></font><font color="#000080">(</font>ActivW<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>Open <font color="#FF0000"><b>then
           Begin
             </b></font>Open<font color="#000080">:=</font>False<font color="#000080">;
             </font>Xcur<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Ycur<font color="#000080">:=</font>WhereY<font color="#000080">;
             </font>Window <font color="#000080">(</font>Xw<font color="#000080">,</font>Yw<font color="#000080">,</font>Xw<font color="#000080">+</font>Ww<font color="#000080">,</font>Yw<font color="#000080">+</font>Hw<font color="#000080">);
             </font><font color="#FF0000"><b>If </b></font>SaveFlag<font color="#000080">=</font>Save <font color="#FF0000"><b>then </b></font>PutScrPart <font color="#000080">(</font>Xw<font color="#000080">,</font>Yw<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>TextBit<font color="#000080">)
                              </font><font color="#FF0000"><b>else </b></font>ClrScr<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>Windat <font color="#000080">[</font>PrevWind<font color="#000080">].</font>Open <font color="#FF0000"><b>then </b></font>ActiveWindow <font color="#000080">(</font>PrevWind<font color="#000080">)
                                       </font><font color="#FF0000"><b>else </b></font>ActiveWindow <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
           </font><font color="#FF0000"><b>End
     End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>MoveWindow <font color="#000080">(</font>Wn<font color="#000080">:</font>byte<font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>P          <font color="#000080">: </font>TextMem<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font><font color="#000080">(</font>Wn<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Wn<font color="#000080">&lt;=</font>MaxWindow<font color="#000080">) </font><font color="#FF0000"><b>then
           with </b></font>windat <font color="#000080">[</font>Wn<font color="#000080">] </font><font color="#FF0000"><b>do
             If </b></font>Open <font color="#FF0000"><b>then
               Begin
                 If </b></font><font color="#000080">(</font>X<font color="#000080">+</font>Ww<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">&gt;</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Y<font color="#000080">+</font>Hw<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">&gt;</font><font color="#800000">25</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
                 </font>Xcur<font color="#000080">:=</font>WhereX<font color="#000080">; </font>Ycur<font color="#000080">:=</font>WhereY<font color="#000080">;
                 </font>GetScrPart <font color="#000080">(</font>Xw<font color="#000080">,</font>Yw<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>P<font color="#000080">);
                 </font><font color="#FF0000"><b>If </b></font>SaveFlag <font color="#FF0000"><b>then </b></font>PutScrPart <font color="#000080">(</font>Xw<font color="#000080">,</font>Yw<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>TextBit<font color="#000080">)
                             </font><font color="#FF0000"><b>else </b></font>ClrScr<font color="#000080">;
                 </font>Xw<font color="#000080">:=</font>X<font color="#000080">; </font>Yw<font color="#000080">:=</font>Y<font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>SaveFlag <font color="#FF0000"><b>then </b></font>GetScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>TextBit<font color="#000080">);
                 </font>PutScrPart <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Ww<font color="#000080">,</font>Hw<font color="#000080">,</font>P<font color="#000080">);
                 </font>Window <font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">+</font>Ww<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font>Hw<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
                 </font>GoToXY <font color="#000080">(</font>Xcur<font color="#000080">,</font>Ycur<font color="#000080">)
               </font><font color="#FF0000"><b>End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>OpenMenu <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>integer<font color="#000080">; </font>Corn<font color="#000080">:</font>byte<font color="#000080">; </font>Menu<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Answer<font color="#000080">:</font>byte<font color="#000080">; </font>Info<font color="#000080">:</font>MenuInfo<font color="#000080">);
     </font><font color="#FF0000"><b>Const </b></font>Maxopt <font color="#000080">= </font><font color="#800000">23</font><font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Posib                   <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maxopt<font color="#000080">] </font><font color="#FF0000"><b>of Record
                                                          </b></font>Beg<font color="#000080">, </font>Wid <font color="#000080">: </font>byte
                                                        <font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>Options                 <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">[</font>Maxopt<font color="#000080">];
         </font>I<font color="#000080">, </font>J<font color="#000080">, </font>W<font color="#000080">, </font>H<font color="#000080">, </font>Nopt<font color="#000080">, </font>Width <font color="#000080">: </font>byte<font color="#000080">;

       </font><font color="#FF0000"><b>Procedure </b></font>GetPossib<font color="#000080">;
         </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>J<font color="#000080">, </font>K <font color="#000080">: </font>byte<font color="#000080">;
           </font><font color="#FF0000"><b>Begin
             </b></font>Options<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
             </font>I<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>Width<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>Nopt<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
             </font><font color="#FF0000"><b>Repeat
               </b></font>J<font color="#000080">:=</font>Pos <font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>Menu<font color="#000080">);
               </font><font color="#FF0000"><b>If </b></font>J<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
                 Begin
                   </b></font>Inc <font color="#000080">(</font>Nopt<font color="#000080">);
                   </font>Menu <font color="#000080">[</font>J<font color="#000080">] := </font><font color="#800000">';'</font><font color="#000080">;
                   </font>Posib <font color="#000080">[</font>Nopt<font color="#000080">].</font>Beg <font color="#000080">:= </font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
                   </font>Posib <font color="#000080">[</font>Nopt<font color="#000080">].</font>Wid <font color="#000080">:= </font>J<font color="#000080">-</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
                   </font>K<font color="#000080">:=</font>I<font color="#000080">;
                   </font><font color="#FF0000"><b>Repeat
                     </b></font>Inc <font color="#000080">(</font>K<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font>Menu <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>Options<font color="#000080">:=</font>Options<font color="#000080">+</font>Menu <font color="#000080">[</font>K<font color="#000080">];
                   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>K<font color="#000080">=</font>J<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>menu <font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">]);
                   </font><font color="#FF0000"><b>If </b></font>K<font color="#000080">=</font>J <font color="#FF0000"><b>then </b></font>Options<font color="#000080">:=</font>Options<font color="#000080">+</font><font color="#800000">' '</font><font color="#000080">;
                   </font><font color="#FF0000"><b>With </b></font>Posib <font color="#000080">[</font>Nopt<font color="#000080">] </font><font color="#FF0000"><b>do If </b></font>Wid<font color="#000080">&gt;</font>Width <font color="#FF0000"><b>then </b></font>Width<font color="#000080">:=</font>Wid<font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font>I<font color="#000080">:=</font>J
             <font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>I<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Nopt<font color="#000080">=</font>MaxOpt<font color="#000080">)
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>Procedure </b></font>MakeChoice<font color="#000080">;
         </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>Lin    <font color="#000080">: </font>byte<font color="#000080">;
             </font>Key<font color="#000080">, </font>Ctrl <font color="#000080">: </font>char<font color="#000080">;
           </font><font color="#FF0000"><b>Begin
             </b></font>Window <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
             </font>GoToXY <font color="#000080">(</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
             </font>HideCursor<font color="#000080">;
             </font>Lin<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
             </font><font color="#FF0000"><b>With </b></font>Info <font color="#FF0000"><b>do
               Repeat
                 For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Width<font color="#000080">+</font><font color="#800000">2 </font><font color="#FF0000"><b>do
                   Begin
                     </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">,</font>GetChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">),</font>Bar<font color="#000080">);
                   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                   </font><font color="#FF0000"><b>Repeat
                     </b></font>Key<font color="#000080">:=</font>Upcase <font color="#000080">(</font>ReadKey<font color="#000080">)
                   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Pos <font color="#000080">(</font>Key<font color="#000080">, </font>CR<font color="#000080">+</font>ESC<font color="#000080">+</font>Options<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Key<font color="#000080">=</font><font color="#800000">#0</font><font color="#000080">);
                 </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Width<font color="#000080">+</font><font color="#800000">2 </font><font color="#FF0000"><b>do
                   If </b></font><font color="#000080">(</font>Options <font color="#000080">[</font>Lin<font color="#000080">]&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Options <font color="#000080">[</font>Lin<font color="#000080">]=</font>Menu <font color="#000080">[</font>Posib <font color="#000080">[</font>Lin<font color="#000080">].</font>Beg<font color="#000080">+</font>I<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                     </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">,</font>GetChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">),</font>Hot<font color="#000080">)
                                                                                      </font><font color="#FF0000"><b>else
                     </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">,</font>GetChar <font color="#000080">(</font>X<font color="#000080">+</font>I<font color="#000080">,</font>Lin<font color="#000080">+</font>Y<font color="#000080">),</font>Text<font color="#000080">);
                 </font><font color="#FF0000"><b>If </b></font>Key<font color="#000080">=</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
                   Begin
                     </b></font>Ctrl<font color="#000080">:=</font>ReadKey<font color="#000080">;
                     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ctrl<font color="#000080">=</font>Down<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Lin<font color="#000080">&lt;</font>Nopt<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Inc <font color="#000080">(</font>Lin<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Ctrl<font color="#000080">=</font>Up<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Lin<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Dec <font color="#000080">(</font>Lin<font color="#000080">);
                     </font><font color="#FF0000"><b>If </b></font>Ctrl<font color="#000080">=</font>Home <font color="#FF0000"><b>then </b></font>Lin<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>If </b></font>Ctrl<font color="#000080">=</font>Endt <font color="#FF0000"><b>then </b></font>Lin<font color="#000080">:=</font>Nopt
                   <font color="#FF0000"><b>End</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>Until </b></font>Key<font color="#000080">&gt;</font><font color="#800000">#0</font><font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>Key<font color="#000080">=</font>CR <font color="#FF0000"><b>then </b></font>Answer<font color="#000080">:=</font>Lin <font color="#FF0000"><b>else </b></font>Answer<font color="#000080">:=</font>Pos <font color="#000080">(</font>Key<font color="#000080">,</font>Options<font color="#000080">);
             </font>ShowCursor
           <font color="#FF0000"><b>End</b></font><font color="#000080">;

       </font><font color="#FF0000"><b>Begin
         If </b></font>Depth<font color="#000080">&lt;</font>MaxDepth<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
           Begin
             </b></font>Menu<font color="#000080">:=</font>Menu<font color="#000080">+</font><font color="#800000">','</font><font color="#000080">;
             </font>Inc <font color="#000080">(</font>Depth<font color="#000080">);
             </font>GetPossib<font color="#000080">;
             </font>H<font color="#000080">:=</font>Nopt<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">; </font>W<font color="#000080">:=</font>Width<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font>Corn<font color="#000080">&gt;</font>RightUp <font color="#FF0000"><b>then </b></font>H<font color="#000080">:=-</font>H<font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Corn<font color="#000080">=</font>RightUp<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Corn<font color="#000080">=</font>RightDown<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>W<font color="#000080">:=-</font>W<font color="#000080">;
             </font>TextColor <font color="#000080">(</font>Info<font color="#000080">.</font>Text <font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">);
             </font>TextBackground <font color="#000080">(</font>Info<font color="#000080">.</font>Text <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">);
             </font>OpenWindow <font color="#000080">(</font>MaxWindow<font color="#000080">-</font>Depth<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Info<font color="#000080">.</font>Border<font color="#000080">,</font>Save<font color="#000080">);
             </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Nopt <font color="#FF0000"><b>do
               With </b></font>Posib <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>do
                 For </b></font>J<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Width <font color="#FF0000"><b>do
                   If </b></font>J<font color="#000080">&lt;=</font>Wid <font color="#FF0000"><b>then
                   If </b></font><font color="#000080">(</font>Options <font color="#000080">[</font>I<font color="#000080">]&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Options <font color="#000080">[</font>I<font color="#000080">]=</font>Menu <font color="#000080">[</font>Beg<font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
                     </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">+</font>Y<font color="#000080">,</font>Ord <font color="#000080">(</font>Menu <font color="#000080">[</font>Beg<font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]),</font>Info<font color="#000080">.</font>Hot<font color="#000080">)
                                                                          </font><font color="#FF0000"><b>else
                       </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">+</font>Y<font color="#000080">,</font>Ord <font color="#000080">(</font>Menu <font color="#000080">[</font>Beg<font color="#000080">+</font>J<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]),</font>Info<font color="#000080">.</font>Text<font color="#000080">)
                            </font><font color="#FF0000"><b>else
                       </b></font>PutChar <font color="#000080">(</font>X<font color="#000080">+</font>J<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">+</font>Y<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">,</font>Info<font color="#000080">.</font>Text<font color="#000080">);
             </font>MakeChoice
           <font color="#FF0000"><b>End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>OpenBox <font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Corn<font color="#000080">,</font>Attr<font color="#000080">:</font>byte<font color="#000080">);
     </font><font color="#FF0000"><b>Var </b></font>Wsgn<font color="#000080">, </font>Hsgn <font color="#000080">: </font>integer<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font>Depth<font color="#000080">&lt;</font>MaxDepth<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
           Begin
             </b></font>Inc <font color="#000080">(</font>Depth<font color="#000080">);
             </font><font color="#FF0000"><b>If </b></font>Corn<font color="#000080">&gt;</font>RightUp <font color="#FF0000"><b>then </b></font>Hsgn<font color="#000080">:=-</font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>Hsgn<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
             </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Corn<font color="#000080">=</font>RightUp<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Corn<font color="#000080">=</font>RightDown<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Wsgn<font color="#000080">:=-</font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>Wsgn<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
             </font>OpenWindow <font color="#000080">(</font>MaxWindow<font color="#000080">-</font>Depth<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Wsgn<font color="#000080">*</font>W<font color="#000080">,</font>Hsgn<font color="#000080">*</font>H<font color="#000080">,</font>Attr<font color="#000080">,</font>Save<font color="#000080">)
           </font><font color="#FF0000"><b>End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>CloseTemp<font color="#000080">;
     </font><font color="#FF0000"><b>Var </b></font>Actual <font color="#000080">: </font>byte<font color="#000080">;
       </font><font color="#FF0000"><b>Begin
         If </b></font>Depth<font color="#000080">&gt;-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
           Begin
             If </b></font>ActivW<font color="#000080">&lt;&gt;</font>MaxWindow<font color="#000080">-</font>Depth <font color="#FF0000"><b>then
               Begin
                 </b></font>Actual<font color="#000080">:=</font>ActivW<font color="#000080">;
                 </font>ActiveWindow <font color="#000080">(</font>MaxWindow<font color="#000080">-</font>Depth<font color="#000080">);
                 </font>CloseWindow<font color="#000080">;
                 </font>ActiveWindow<font color="#000080">(</font>Actual<font color="#000080">)
               </font><font color="#FF0000"><b>End
                                        else
               </b></font>CloseWindow<font color="#000080">;
             </font>Dec <font color="#000080">(</font>Depth<font color="#000080">);
           </font><font color="#FF0000"><b>End
       End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Begin
     </b></font>TestTextMode
   <font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ---------------------- Demo program ---------------------- }

 </i></font><font color="#FF0000"><b>Program </b></font>TextWinDemo<font color="#000080">;

   </font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>TextWin<font color="#000080">;

   </font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">, </font>X<font color="#000080">, </font>Y <font color="#000080">: </font>integer<font color="#000080">;
       </font>Answer  <font color="#000080">: </font>byte<font color="#000080">;
       </font>S       <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
       </font>Info    <font color="#000080">: </font>MenuInfo<font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>WaitKey<font color="#000080">;
     </font><font color="#FF0000"><b>Begin
       Repeat Until </b></font>InKey<font color="#000080">&lt;&gt;</font>Empty
     <font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Procedure </b></font>WriteTitle <font color="#000080">(</font>Title<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
     </font><font color="#FF0000"><b>Begin
       </b></font>TextColor <font color="#000080">(</font>Yellow<font color="#000080">);
       </font>TextBackground <font color="#000080">(</font>Blue<font color="#000080">);
       </font>ClrScr<font color="#000080">;
       </font>GoToXY <font color="#000080">(</font><font color="#800000">40</font><font color="#000080">-</font>Length <font color="#000080">(</font>Title<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
       </font>Write <font color="#000080">(</font>Title<font color="#000080">)
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>Begin
       </b></font>TextColor <font color="#000080">(</font>Yellow<font color="#000080">);
       </font>TextBackground <font color="#000080">(</font>Blue<font color="#000080">);
       </font>OpenWindow <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font>Attribute <font color="#000080">(</font>White<font color="#000080">,</font>Green<font color="#000080">),</font>DontSave<font color="#000080">);
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'You can open up to 10 windows (or more if you change MaxWindow constant).'</font><font color="#000080">);
       </font>Randomize<font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxWindow <font color="#FF0000"><b>do
         Begin
           </b></font>Str <font color="#000080">(</font>I<font color="#000080">,</font>S<font color="#000080">);
           </font>TextColor <font color="#000080">(</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
           </font>TextBackground <font color="#000080">(</font><font color="#800000">7</font><font color="#000080">-(</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">);
           </font>OpenWindow <font color="#000080">(</font>I<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">30</font><font color="#000080">),</font><font color="#800000">5</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">5</font><font color="#000080">),</font><font color="#800000">12</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">30</font><font color="#000080">),</font><font color="#800000">7</font><font color="#000080">+</font>Random <font color="#000080">(</font><font color="#800000">8</font><font color="#000080">),</font>Attribute <font color="#000080">(</font>I<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">-</font>I <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">),</font>Save<font color="#000080">);
           </font>Writeln <font color="#000080">(</font><font color="#800000">'Window #'</font><font color="#000080">,</font>S<font color="#000080">);
           </font>Delay <font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>Writeln<font color="#000080">;
       </font>Write <font color="#000080">(</font><font color="#800000">'Any key...'</font><font color="#000080">);
       </font>WaitKey<font color="#000080">;
       </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MaxWindow <font color="#FF0000"><b>do
         Begin
           </b></font>CloseWindow<font color="#000080">;
           </font>Delay <font color="#000080">(</font><font color="#800000">100</font><font color="#000080">)
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'Press any key to hide cursor...'</font><font color="#000080">);
       </font>WaitKey<font color="#000080">;
       </font>HideCursor<font color="#000080">;
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'Press any key to show cursor...'</font><font color="#000080">);
       </font>WaitKey<font color="#000080">;
       </font>ShowCursor<font color="#000080">;
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'Menu demo'</font><font color="#000080">);
       </font><font color="#FF0000"><b>With </b></font>Info <font color="#FF0000"><b>do
         Begin
           </b></font>Border<font color="#000080">:=</font>Attribute <font color="#000080">(</font>Black<font color="#000080">,</font>LightGray<font color="#000080">);
           </font>Text<font color="#000080">:=</font>Attribute <font color="#000080">(</font>Black<font color="#000080">,</font>LightGray<font color="#000080">);
           </font>Bar<font color="#000080">:=</font>Attribute <font color="#000080">(</font>White<font color="#000080">,</font>Blue<font color="#000080">);
           </font>Hot<font color="#000080">:=</font>Attribute <font color="#000080">(</font>Red<font color="#000080">,</font>LightGray<font color="#000080">)
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>OpenMenu <font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font>LeftUp<font color="#000080">,</font><font color="#800000">'An item,Also an item,One more'</font><font color="#000080">,</font>Answer<font color="#000080">,</font>Info<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>Answer<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
         Begin
           </b></font>OpenMenu <font color="#000080">(</font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">+</font>Answer<font color="#000080">,</font>LeftUp<font color="#000080">,</font><font color="#800000">'New first option,New second option,New third option'</font><font color="#000080">,</font>Answer<font color="#000080">,</font>Info<font color="#000080">);
           </font>CloseTemp
         <font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>CloseTemp<font color="#000080">;
       </font>TextColor <font color="#000080">(</font>Yellow<font color="#000080">);
       </font>TextBackground <font color="#000080">(</font>Blue<font color="#000080">);
       </font>Writeln<font color="#000080">;
       </font>Writeln<font color="#000080">;
         </font><font color="#FF0000"><b>Case </b></font>Answer <font color="#FF0000"><b>of
           </b></font><font color="#800000">0 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'You choosed nothing...'</font><font color="#000080">);
           </font><font color="#800000">1 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'You choosed first option...'</font><font color="#000080">);
           </font><font color="#800000">2 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'You choosed second option...'</font><font color="#000080">);
           </font><font color="#800000">3 </font><font color="#000080">: </font>Write <font color="#000080">(</font><font color="#800000">'You choosed third option...'</font><font color="#000080">)
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>WaitKey<font color="#000080">;
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'Box demo...'</font><font color="#000080">);
       </font>OpenBox <font color="#000080">(</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font>LeftUp<font color="#000080">,</font>Attribute <font color="#000080">(</font>Black<font color="#000080">,</font>LightGray<font color="#000080">));
       </font>Write <font color="#000080">(</font><font color="#800000">' This is a box...'</font><font color="#000080">);
       </font>WaitKey<font color="#000080">;
       </font>CloseTemp<font color="#000080">;
       </font>WriteTitle <font color="#000080">(</font><font color="#800000">'Any key to exit...'</font><font color="#000080">);
       </font>WaitKey<font color="#000080">;
       </font>Window <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TextModeInfo<font color="#000080">.</font>Wid<font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
       </font>TextColor <font color="#000080">(</font>LightGray<font color="#000080">);
       </font>TextBackground <font color="#000080">(</font>Black<font color="#000080">);
       </font>ClrScr
     <font color="#FF0000"><b>End</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
