<html>
<head><title> "Text Scroller" by RODRIGO MOREIRA SILVEIRA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Program </b></font>txtscrooler<font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">,</font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>vidseg <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">;
  </font>ismono <font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;
  </font>txt <font color="#000080">= </font><font color="#800000">'Z&icirc;U$'</font><font color="#000080">;
  </font>tx <font color="#000080">= </font><font color="#800000">'WaS HeRe!'</font><font color="#000080">;
  </font>t <font color="#000080">= </font><font color="#800000">'Up ''n'' Down'</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>Windowrec <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4003</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>coded <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Y<font color="#000080">, </font>J<font color="#000080">: </font>integer<font color="#000080">;
  </font>CBuf<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">8191</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
  </font>NewWindow <font color="#000080">: </font>Windowrec<font color="#000080">;
  </font>kk<font color="#000080">,</font>oo<font color="#000080">,</font>ii <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>c <font color="#000080">: </font>Char<font color="#000080">;
  </font>i<font color="#000080">,</font>o<font color="#000080">,</font>k <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HideCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV   ax,$0100
  MOV   cx,$2607
  INT   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ShowCursor<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV   ax,$0100
  MOV   cx,$0506
  INT   $10
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CharGenModeOn<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">cli
  mov       dx,03C4h
  mov       ax,0100h
  out       dx,ax
  mov       ax,0402h
  out       dx,ax
  mov       ax,0704h
  out       dx,ax
  mov       ax,0300h
  out       dx,ax
  sti
  mov       dl,0CEh
  mov       ax,0204h
  out       dx,ax
  mov       ax,0005h
  out       dx,ax
  mov       ax,0006h
  out       dx,ax
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>CharGenModeOff<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">cli
  mov       dx,03C4h
  mov       ax,0100h
  out       dx,ax
  mov       ax,0302h
  out       dx,ax
  mov       ax,0304h
  out       dx,ax
  mov       ax,0300h
  out       dx,ax
  sti
  mov       dl,0CEh
  mov       ax,0004h
  out       dx,ax
  mov       ax,1005h
  out       dx,ax
  mov       ax,0E06h
  out       dx,ax
  mov       ah,0Fh
  int       10h
  cmp       al,7
  jne       @skip
  mov       ax,0806h
  out       dx,ax
@skip:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>checkvidseg<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>mem <font color="#000080">[</font><font color="#800000">$0000 </font><font color="#000080">: </font><font color="#800000">$0449</font><font color="#000080">] = </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>vidseg <font color="#000080">:= </font><font color="#800000">$B000
  </font><font color="#FF0000"><b>else </b></font>vidseg <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;
  </font>ismono <font color="#000080">:= (</font>vidseg <font color="#000080">= </font><font color="#800000">$B000</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>savescreen <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>wind <font color="#000080">: </font>Windowrec<font color="#000080">;
 </font>TLX<font color="#000080">, </font>TLY<font color="#000080">, </font>BRX<font color="#000080">, </font>BRY <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>checkvidseg<font color="#000080">;
  </font>wind <font color="#000080">[</font><font color="#800000">4000</font><font color="#000080">] := </font>TLX<font color="#000080">;
  </font>wind <font color="#000080">[</font><font color="#800000">4001</font><font color="#000080">] := </font>TLY<font color="#000080">;
  </font>wind <font color="#000080">[</font><font color="#800000">4002</font><font color="#000080">] := </font>BRX<font color="#000080">;
  </font>wind <font color="#000080">[</font><font color="#800000">4003</font><font color="#000080">] := </font>BRY<font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>y <font color="#000080">:= </font>TLY <font color="#FF0000"><b>to </b></font>BRY <font color="#FF0000"><b>Do
    For </b></font>x <font color="#000080">:= </font>TLX <font color="#FF0000"><b>to </b></font>BRX <font color="#FF0000"><b>Do
    begin
      InLine </b></font><font color="#000080">(</font><font color="#800000">$FA</font><font color="#000080">);
      </font>wind <font color="#000080">[</font>i<font color="#000080">] := </font>mem <font color="#000080">[</font>vidseg <font color="#000080">: (</font><font color="#800000">160 </font><font color="#000080">* (</font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">2 </font><font color="#000080">* (</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) ) ];
      </font>wind <font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>mem <font color="#000080">[</font>vidseg <font color="#000080">: (</font><font color="#800000">160 </font><font color="#000080">* (</font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">2 </font><font color="#000080">* (</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) ) + </font><font color="#800000">1</font><font color="#000080">];
      </font><font color="#FF0000"><b>InLine </b></font><font color="#000080">(</font><font color="#800000">$FB</font><font color="#000080">);
      </font>Inc <font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>setWindow <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>wind <font color="#000080">: </font>Windowrec<font color="#000080">; </font>TLX<font color="#000080">, </font>TLY<font color="#000080">, </font>BRX<font color="#000080">, </font>BRY <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>savescreen <font color="#000080">(</font>wind<font color="#000080">, </font>TLX<font color="#000080">, </font>TLY<font color="#000080">, </font>BRX<font color="#000080">, </font>BRY<font color="#000080">);
  </font>Window <font color="#000080">(</font>TLX<font color="#000080">, </font>TLY<font color="#000080">, </font>BRX<font color="#000080">, </font>BRY<font color="#000080">);
  </font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>removeWindow <font color="#000080">(</font>wind <font color="#000080">: </font>Windowrec<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>TLX<font color="#000080">, </font>TLY<font color="#000080">, </font>BRX<font color="#000080">, </font>BRY<font color="#000080">, </font>x<font color="#000080">, </font>y<font color="#000080">, </font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>checkvidseg<font color="#000080">;
  </font>Window <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
  </font>TLX <font color="#000080">:= </font>wind <font color="#000080">[</font><font color="#800000">4000</font><font color="#000080">];
  </font>TLY <font color="#000080">:= </font>wind <font color="#000080">[</font><font color="#800000">4001</font><font color="#000080">];
  </font>BRX <font color="#000080">:= </font>wind <font color="#000080">[</font><font color="#800000">4002</font><font color="#000080">];
  </font>BRY <font color="#000080">:= </font>wind <font color="#000080">[</font><font color="#800000">4003</font><font color="#000080">];
  </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>y <font color="#000080">:= </font>TLY <font color="#FF0000"><b>to </b></font>BRY <font color="#FF0000"><b>Do
    For </b></font>x <font color="#000080">:= </font>TLX <font color="#FF0000"><b>to </b></font>BRX <font color="#FF0000"><b>Do
    begin
      InLine </b></font><font color="#000080">(</font><font color="#800000">$FA</font><font color="#000080">);
      </font>mem <font color="#000080">[</font>vidseg <font color="#000080">: (</font><font color="#800000">160 </font><font color="#000080">* (</font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">2 </font><font color="#000080">* (</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) ) ] := </font>wind <font color="#000080">[</font>i<font color="#000080">];
      </font>mem <font color="#000080">[</font>vidseg <font color="#000080">: (</font><font color="#800000">160 </font><font color="#000080">* (</font>y <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) + </font><font color="#800000">2 </font><font color="#000080">* (</font>x <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) ) + </font><font color="#800000">1</font><font color="#000080">] := </font>wind <font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
      </font><font color="#FF0000"><b>InLine </b></font><font color="#000080">(</font><font color="#800000">$FB</font><font color="#000080">);
      </font>Inc <font color="#000080">(</font>i<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>setWindow <font color="#000080">(</font>NewWindow<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">, </font><font color="#800000">25</font><font color="#000080">);
  </font>Coded <font color="#000080">:= </font><font color="#800000">'CoDeD By Z&icirc;U$'</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>pos<font color="#000080">(</font><font color="#800000">'Z&icirc;U$'</font><font color="#000080">,</font>coded<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Do
  </b></font>HideCursor<font color="#000080">;
  </font>textbackground<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>textColor<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>o <font color="#000080">:= </font><font color="#800000">70</font><font color="#000080">;
  </font>k <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
      </b></font>gotoxy<font color="#000080">(</font>i<font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
      </font>inc <font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">76 </font><font color="#FF0000"><b>then </b></font>ii <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>ii <font color="#FF0000"><b>Then </b></font>i <font color="#000080">:= </font>i<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>ii <font color="#000080">:= </font>false<font color="#000080">;
      </font>write<font color="#000080">(</font>txt<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font>o<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">);
      </font>dec<font color="#000080">(</font>o<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>o <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>oo <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>oo <font color="#FF0000"><b>Then </b></font>o <font color="#000080">:= </font>o<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>o <font color="#000080">= </font><font color="#800000">72 </font><font color="#FF0000"><b>then </b></font>oo <font color="#000080">:= </font>false<font color="#000080">;
      </font>write<font color="#000080">(</font>tx<font color="#000080">);
      </font>gotoxy<font color="#000080">((</font><font color="#800000">80</font><font color="#000080">-</font>length<font color="#000080">(</font>t<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font>k<font color="#000080">);
      </font>inc<font color="#000080">(</font>k<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>k <font color="#000080">= </font><font color="#800000">25 </font><font color="#FF0000"><b>then </b></font>kk <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>kk <font color="#FF0000"><b>Then </b></font>k <font color="#000080">:= </font>k<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>k <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>kk <font color="#000080">:= </font>false<font color="#000080">;
      </font>write<font color="#000080">(</font>t<font color="#000080">);
      </font>delay<font color="#000080">(</font><font color="#800000">22</font><font color="#000080">);
      </font>clrscr<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>removeWindow <font color="#000080">(</font>NewWindow<font color="#000080">);
  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'C:\I\SAW\3\SCROOLERS\&gt;FORMAT C: /Q &gt;NOW!'</font><font color="#000080">);
  </font>write<font color="#000080">(</font>CoDeD<font color="#000080">);
  </font>CharGenModeOn<font color="#000080">;
  </font>move<font color="#000080">( </font>mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">: </font><font color="#800000">0</font><font color="#000080">], </font>CBuf<font color="#000080">, </font><font color="#800000">8192 </font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
    for </b></font>J <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do
      </b></font>mem<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:((</font>I<font color="#000080">*</font><font color="#800000">32</font><font color="#000080">) + </font>J<font color="#000080">)] := </font>CBuf<font color="#000080">[(</font>I<font color="#000080">*</font><font color="#800000">32</font><font color="#000080">) + (</font><font color="#800000">15 </font><font color="#000080">- </font>J<font color="#000080">)];
   </font>CharGenModeOff<font color="#000080">;
  </font>ShowCursor<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
