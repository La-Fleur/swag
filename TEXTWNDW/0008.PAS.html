<html>
<head><title> "Moving Text Images" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
SEAN PALMER

&gt;I was looking threw a Turbo C++ manual and noted some
&gt;Procedures that deal With the Text screen, such as
&gt;Get/PutTextImage. I was wondering if anyone has created one
&gt;for Pascal to move/save Text images around the screen like
&gt;in C++.

Copies a rectangular section from one video buffer (any size) to another
}

</i></font><font color="#FF0000"><b>Procedure </b></font>moveScr<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>srcBuf<font color="#000080">; </font>srcX<font color="#000080">, </font>srcY<font color="#000080">, </font>width<font color="#000080">, </font>height<font color="#000080">, </font>srcBufW<font color="#000080">,
                      </font>srcBufH <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>dstBuf<font color="#000080">; </font>dstX<font color="#000080">, </font>dstY<font color="#000080">, </font>dstBufW<font color="#000080">,
                      </font>dstBufH <font color="#000080">: </font>Word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">cld
  push ds
  lds  si, srcBuf    </font><font color="#008000"><i>{calc src adr}
  </i></font><font color="#FF00FF">mov  ax, srcBufW
  mul  srcY
  add  ax, srcX
  shl  ax, 1
  add  si, ax
  les  di, dstBuf    </font><font color="#008000"><i>{calc dst adr}
  </i></font><font color="#FF00FF">mov  ax, dstBufW
  mul  dstY
  add  ax, dstX
  shl  ax, 1
  add  di, ax
  mov  dx, height    </font><font color="#008000"><i>{num lines}
  </i></font><font color="#FF00FF">mov  ax, SrcBufW   </font><font color="#008000"><i>{calc ofs between src lines}
  </i></font><font color="#FF00FF">sub  ax, width
  shl  ax, 1
  mov  bx, dstBufW   </font><font color="#008000"><i>{calc ofs between dst lines}
  </i></font><font color="#FF00FF">sub  bx, width
  shl  bx, 1
 @L:
  mov  cx, width
  rep  movsw
  add  si, ax
  add  di, bx
  dec  dx
  jnz  @L
  pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">24</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">79</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$B800 </font><font color="#000080">: </font><font color="#800000">0</font><font color="#000080">;
  </font>d <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">39</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>i <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">25 </font><font color="#000080">* </font><font color="#800000">10 </font><font color="#FF0000"><b>do
    </b></font>Write<font color="#000080">(</font><font color="#800000">'(--)(--)'</font><font color="#000080">);
  </font>moveScr<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font>d<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">); </font><font color="#008000"><i>{copy 40x12 block to buf}
  </i></font>readln<font color="#000080">;
  </font>moveScr<font color="#000080">(</font>d<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">38</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font>s<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">); </font><font color="#008000"><i>{copy part back to screen}
  </i></font>readln<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to TEXTWNDW SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0008.PAS">Original</a><b>]</b></p></body>
</html>
