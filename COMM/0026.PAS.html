<html>
<head><title> "Detect Phone Ringing" by HERB BROWN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
HERB BROWN

Anybody using any of the public domain fossil units?  You are? Great! Here is
a procedure to add ring detection to them.

Fos_ringing works by &quot;peeking&quot; into the buffers for a carriage return. After
a ring is detected by your modem, the CR will be the last character in your
buffer.  You could re-write the following to retrieve a connect string, if
you wanted. Since the fossil takes care of the dirty bussiness, at the moment
I wasn't worried about it.

Once you establish the phone rang, simply send an ATA to the modem and delay
for about 11-15 seconds for connection. (maybe more for higher speed modems.)

What really has me puzzled, though, of all the PD code for fossils, nothing
like this was ever included.
}

</i></font><font color="#FF0000"><b>Function </b></font>Fos_Ringing<font color="#000080">(</font>ComPort <font color="#000080">: </font>Byte<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>CC <font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Fos_Ringing <font color="#000080">:= </font>False<font color="#000080">;
  </font>Regs<font color="#000080">.</font>Ah <font color="#000080">:= </font><font color="#800000">$0C</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>Dx <font color="#000080">:= </font>ComPort <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$14</font><font color="#000080">, </font>Regs<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>regs<font color="#000080">.</font>ax <font color="#000080">= </font><font color="#800000">$FFFF </font><font color="#FF0000"><b>then
    </b></font>Fos_ringing <font color="#000080">:= </font>false
  <font color="#FF0000"><b>else
  begin
    </b></font>cc <font color="#000080">:= </font>chr<font color="#000080">(</font>regs<font color="#000080">.</font>al<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>cc <font color="#000080">= </font><font color="#800000">#13 </font><font color="#FF0000"><b>then
      </b></font>Fos_ringing <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
