<html>
<head><title> "Fossil Interrupt" by GERHARD HOOGTERP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: gerhard@loipon.wlink.nl (Gerhard Hoogterp)

&gt; &gt; Anyhow, the point is usualy not which fossil is loaded but
&gt; &gt; if there is a fossil at all. And that's what the $1954 result is for.

&gt;I now realize that $1954 will be returned for either BNU/X00, but I would
&gt;still like to be able to list to screen &quot;which&quot; fossil has been detected,
&gt;and I cannot seem to figure it out.

}
</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>UsePort      <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;

</font><font color="#FF0000"><b>Type </b></font>InfoArray     <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
     </font>FossilInfo    <font color="#000080">= </font><font color="#FF0000"><b>Record
      </b></font>Size         <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ Record Size         }
      </i></font>MajVer       <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{ Major Version       }
      </i></font>MinVer       <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{ Minor Version       }
      </i></font>IndentPtr    <font color="#000080">: ^</font>InfoArray<font color="#000080">;  </font><font color="#008000"><i>{ Indentifier         }
      </i></font>InpSize      <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ Size inp. Buffer    }
      </i></font>InpFree      <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ Free in inp. buffer }
      </i></font>OutBuf       <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ Size out. Buffer    }
      </i></font>OutFree      <font color="#000080">: </font>Word<font color="#000080">;        </font><font color="#008000"><i>{ Free in out. Buffer }
      </i></font>SWidth       <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{ Screen width        }
      </i></font>SHeight      <font color="#000080">: </font>Byte<font color="#000080">;        </font><font color="#008000"><i>{ Screen height       }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Info <font color="#000080">: </font>FossilInfo<font color="#000080">;
    </font>C    <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitPort<font color="#000080">(</font>Port <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
With </b></font>Regs <font color="#FF0000"><b>Do
 Begin
 </b></font>AH<font color="#000080">:=</font><font color="#800000">$04</font><font color="#000080">;
 </font>DX <font color="#000080">:= </font>Port<font color="#000080">;
 </font>Intr<font color="#000080">(</font><font color="#800000">$14</font><font color="#000080">,</font>Regs<font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>AX<font color="#000080">&lt;&gt;</font><font color="#800000">$1954
    </font><font color="#FF0000"><b>Then </b></font>Halt<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>GrabPortInfo<font color="#000080">(</font>Port <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
With </b></font>Regs <font color="#FF0000"><b>Do
 Begin
 </b></font>AH<font color="#000080">:=</font><font color="#800000">$1B</font><font color="#000080">;
 </font>DX<font color="#000080">:=</font>Port<font color="#000080">;
 </font>CX<font color="#000080">:=</font>SizeOf<font color="#000080">(</font>Info<font color="#000080">);
 </font>ES<font color="#000080">:=</font>Seg<font color="#000080">(</font>Info<font color="#000080">);
 </font>DI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Info<font color="#000080">);
 </font>Intr<font color="#000080">(</font><font color="#800000">$14</font><font color="#000080">,</font>Regs<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>DonePort<font color="#000080">(</font>Port <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
With </b></font>Regs <font color="#FF0000"><b>Do
 Begin
 </b></font>AH<font color="#000080">:=</font><font color="#800000">$05</font><font color="#000080">;
 </font>DX<font color="#000080">:=</font>Port<font color="#000080">;
 </font>Intr<font color="#000080">(</font><font color="#800000">$14</font><font color="#000080">,</font>Regs<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
</b></font>FillChar<font color="#000080">(</font>Info<font color="#000080">,</font>SizeOf<font color="#000080">(</font>Info<font color="#000080">),</font><font color="#800000">#00</font><font color="#000080">);

</font>InitPort<font color="#000080">(</font>UsePort<font color="#000080">);
</font>GrabPortInfo<font color="#000080">(</font>UsePort<font color="#000080">);

</font>WriteLn<font color="#000080">(</font><font color="#800000">'Fossil ID:'</font><font color="#000080">);
</font>Write<font color="#000080">(</font><font color="#800000">'  '</font><font color="#000080">);

</font>C<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>C<font color="#000080">&lt;</font><font color="#800000">256</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Info<font color="#000080">.</font>IndentPtr<font color="#000080">^[</font>C<font color="#000080">]&lt;&gt;</font><font color="#800000">#00</font><font color="#000080">) </font><font color="#FF0000"><b>Do
 Begin
 </b></font>Write<font color="#000080">(</font>Info<font color="#000080">.</font>IndentPtr<font color="#000080">^[</font>C<font color="#000080">]);
 </font>Inc<font color="#000080">(</font>C<font color="#000080">);
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>Writeln<font color="#000080">;

</font>DonePort<font color="#000080">(</font>UsePort<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0056.PAS">Original</a><b>]</b></p></body>
</html>
