<html>
<head><title> "JsDoor Chat Door" by CJ CLIFFE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
This is a Unit for chat doors written in JsDoor, I've written my
own chat door, and I Really missed my old IceChat Tunes, So i've
Come up with a Note-By-Note Playing Routine for Icechat .ICE files..

This can be used Multi-Node, because it loads the file into memory..
Instead of reading it from disk..



Usage is easy, it's just

GETBANK('FILENAME.ICE');
and then just
PLAYNEXTNOTE;
as long as you want, it will only play one note at a time so you
can use it in a LOOP,  I use it to Display the moving Status Bar
while playing the note and watching for local/remote keys....


CJ Cliffe  *  Shareware Overload BBS  (613)382-1924 &amp; (613)382-8503
              Voice:  (613)382-4194

  Please feel free to use this anywhere you want...
     As long as someone gets good use out of it i'm happy..        }


</i></font><font color="#FF0000"><b>Unit </b></font>PlayIce<font color="#000080">;   </font><font color="#008000"><i>(* 1995 by CJ Cliffe *)
</i></font><font color="#FF0000"><b>Interface
Uses </b></font>Jsdoor<font color="#000080">,</font>Jsmisc<font color="#000080">,</font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Getbank<font color="#000080">(</font>filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>PlayNextNote<font color="#000080">;


</font><font color="#FF0000"><b>Implementation
Var
</b></font>Counter <font color="#000080">: </font>Integer<font color="#000080">;
</font>Cbank   <font color="#000080">: </font>Integer<font color="#000080">;
</font>Soundbnk<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1500</font><font color="#000080">] </font><font color="#FF0000"><b>of String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];     </font><font color="#008000"><i>{Loads To Memory for faster}
                                             {  or Multinode Operation  }


</i></font><font color="#FF0000"><b>Function </b></font>Str2Num<font color="#000080">(</font>Convertme<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;  </font><font color="#008000"><i>{Cheap Way Of Converting}
</i></font><font color="#FF0000"><b>Var
  </b></font>Counting<font color="#000080">: </font>Longint<font color="#000080">;                         </font><font color="#008000"><i>{a Numeric String to an }
</i></font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>{        Integer        }
</i></font><font color="#FF0000"><b>For </b></font>Counting <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1000000 </font><font color="#FF0000"><b>do
begin          </b></font><font color="#008000"><i>{ 1 Mil is High, But It }
</i></font><font color="#FF0000"><b>If </b></font>Convertme <font color="#000080">= </font>Strfunc<font color="#000080">(</font>Counting<font color="#000080">) </font><font color="#FF0000"><b>then
begin    </b></font><font color="#008000"><i>{ Will Stop Long before }
  </i></font>Str2Num <font color="#000080">:= </font>Counting<font color="#000080">;  </font><font color="#008000"><i>{   It Gets that far,   }
</i></font>Exit<font color="#000080">;                                          </font><font color="#008000"><i>{ Because of this
Exit; }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>Getbank<font color="#000080">(</font>filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>fil  <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Begin
</b></font>Counter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#008000"><i>{ Reset All Old Tones and Counter }
</i></font><font color="#FF0000"><b>For </b></font>Cbank <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">1500 </font><font color="#FF0000"><b>do begin
</b></font><font color="#008000"><i>{            If Any               }
</i></font>Soundbnk<font color="#000080">[</font>cbank<font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>cbank <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>Assign<font color="#000080">(</font>fil<font color="#000080">,</font>filename<font color="#000080">);                  </font><font color="#008000"><i>{ Get Filname }
</i></font>Reset<font color="#000080">(</font>Fil<font color="#000080">);
</font><font color="#FF0000"><b>Repeat
</b></font>inc<font color="#000080">(</font>cbank<font color="#000080">);
</font>Readln<font color="#000080">(</font>fil<font color="#000080">,</font>soundbnk<font color="#000080">[</font>cbank<font color="#000080">]);           </font><font color="#008000"><i>{ Load File Into Memory }
</i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>cbank <font color="#000080">= </font><font color="#800000">1500</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>EOF<font color="#000080">(</font>fil<font color="#000080">));</font>Close<font color="#000080">(</font>fil<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>PlayNextNote<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>func     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];     </font><font color="#008000"><i>{Function WAIT, TONE or Comment}
    </i></font>tone     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">5</font><font color="#000080">];     </font><font color="#008000"><i>{Tone In String Form}
    </i></font>dura     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];     </font><font color="#008000"><i>{String Form Of Duration / 10}
    </i></font>Temptone <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;        </font><font color="#008000"><i>{Temporary Storage String}

</i></font><font color="#FF0000"><b>Label </b></font>Top<font color="#000080">;

</font><font color="#FF0000"><b>Begin

</b></font>Nosound<font color="#000080">;                           </font><font color="#008000"><i>{Stop Sound }

</i></font>Top<font color="#000080">:                               </font><font color="#008000"><i>{Label for Non-Notes}

</i></font>Inc<font color="#000080">(</font>Counter<font color="#000080">);                      </font><font color="#008000"><i>{Update Note}

</i></font><font color="#FF0000"><b>If </b></font>counter <font color="#000080">= </font>cbank <font color="#FF0000"><b>then </b></font>counter <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;    </font><font color="#008000"><i>{Song Has Ended, Restart!}

</i></font>Temptone <font color="#000080">:= </font>SoundBnk<font color="#000080">[</font>Counter<font color="#000080">];     </font><font color="#008000"><i>{Make a Temporary Copy of the Note}

</i></font>Func <font color="#000080">:= </font>Temptone<font color="#000080">;                  </font><font color="#008000"><i>{Get All The Values}
</i></font>Tone <font color="#000080">:= </font>Copy<font color="#000080">(</font>Temptone<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);        </font><font color="#008000"><i>{Note Tone}
</i></font>Dura <font color="#000080">:= </font>Copy<font color="#000080">(</font>Temptone<font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);       </font><font color="#008000"><i>{Note Duration}

</i></font>Func <font color="#000080">:= </font>Ltrim<font color="#000080">(</font>Rtrim<font color="#000080">(</font>Func<font color="#000080">));        </font><font color="#008000"><i>{Strip Spaces For Number Conversion}
</i></font>Tone <font color="#000080">:= </font>Ltrim<font color="#000080">(</font>Rtrim<font color="#000080">(</font>Tone<font color="#000080">));
</font>Dura <font color="#000080">:= </font>Ltrim<font color="#000080">(</font>Rtrim<font color="#000080">(</font>Dura<font color="#000080">));


</font><font color="#FF0000"><b>If </b></font>Copy<font color="#000080">(</font>Func<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">) = </font><font color="#800000">';' </font><font color="#FF0000"><b>then Goto </b></font>Top<font color="#000080">;    </font><font color="#008000"><i>{Comment Found, Skip Note}

</i></font><font color="#FF0000"><b>If </b></font>Func <font color="#000080">= </font><font color="#800000">'WAIT' </font><font color="#FF0000"><b>then begin
</b></font><font color="#008000"><i>{WAIT found, Stop Sound and wait} </i></font>Nosound<font color="#000080">;
</font><font color="#008000"><i>{      Stop Sound For Wait      } </i></font>Delay<font color="#000080">(</font>Str2Num<font color="#000080">(</font>Tone<font color="#000080">)*</font><font color="#800000">10</font><font color="#000080">);
</font>Exit<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>If </b></font>Func <font color="#000080">= </font><font color="#800000">'TONE' </font><font color="#FF0000"><b>then begin         </b></font><font color="#008000"><i>{Tone Found, Play Note and Wait for}
</i></font>Sound<font color="#000080">(</font>Str2Num<font color="#000080">(</font>Tone<font color="#000080">));               </font><font color="#008000"><i>{            Dura(tion)            }
</i></font>Delay<font color="#000080">(</font>Str2Num<font color="#000080">(</font>Dura<font color="#000080">)*</font><font color="#800000">10</font><font color="#000080">);            </font><font color="#008000"><i>{Dura is in  / 10 format, * 10 for }
</i></font>NoSound<font color="#000080">;                            </font><font color="#008000"><i>{            Normal Play           }
</i></font>Exit<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
End</b></font><font color="#000080">.


</font><font color="#008000"><i>{ I'm Working on a keyboard for recording .ICE files,  Watch for it in this
 Echo...                                                                    }



{ -------------------------------------------------------------------------}

{ Example Usage Of PLAYICE.PAS }


{

Program IcePlay;
Uses PlayIce,Crt;


Begin
Clrscr;
Writeln('Playing Song, Any key to Stop');
GetBank('LARRY.ICE');
Repeat
PlayNextNote;
Until Keypressed;
End.


}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0081.PAS">Original</a><b>]</b></p></body>
</html>
