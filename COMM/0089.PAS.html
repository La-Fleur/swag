<html>
<head><title> "Serial Port Info" by JOSE ANTONIO NODA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0089.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
  Serial Ports Info v.1.0

  Jose Antonio Noda
  Compuserve :     100667,2523
*)

</i></font><font color="#FF0000"><b>Program </b></font>SerialPorts<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Regs                  <font color="#000080">: </font>Registers<font color="#000080">;
  </font>Com1<font color="#000080">,</font>Com2<font color="#000080">,</font>Com3<font color="#000080">,</font>Com4   <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Hex<font color="#000080">(</font>w<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>Cifra<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">=
    (</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">'1'</font><font color="#000080">,</font><font color="#800000">'2'</font><font color="#000080">,</font><font color="#800000">'3'</font><font color="#000080">,</font><font color="#800000">'4'</font><font color="#000080">,</font><font color="#800000">'5'</font><font color="#000080">,</font><font color="#800000">'6'</font><font color="#000080">,</font><font color="#800000">'7'</font><font color="#000080">,</font><font color="#800000">'8'</font><font color="#000080">,</font><font color="#800000">'9'</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">'B'</font><font color="#000080">,</font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>Hex<font color="#000080">:= </font>Cifra<font color="#000080">[</font>Hi<font color="#000080">(</font>w<font color="#000080">) </font><font color="#FF0000"><b>SHR  </b></font><font color="#800000">4</font><font color="#000080">] +
    </font>Cifra<font color="#000080">[</font>Hi<font color="#000080">(</font>w<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">15</font><font color="#000080">] +
    </font>Cifra<font color="#000080">[</font>Lo<font color="#000080">(</font>w<font color="#000080">) </font><font color="#FF0000"><b>SHR  </b></font><font color="#800000">4</font><font color="#000080">] +
    </font>Cifra<font color="#000080">[</font>Lo<font color="#000080">(</font>w<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">15</font><font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>NoZero<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WHILE </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>s<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>NoZero<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  Asm
    </b></font><font color="#FF00FF">push  es
    push  di
    mov   ax, 0040h
    xor   bx, bx
    mov   es, ax
    mov   di, bx
    mov   ax, es:[di]
    mov   Com1, ax
    mov   ax, es:[di+2]
    mov   Com2, ax
    mov   ax, es:[di+4]
    mov   Com3, ax
    mov   ax, es:[di+6]
    mov   Com4, ax
    pop   di
    pop   es;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Clrscr<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Ports Info v.1.0                               (C) Jose Antonio Noda'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Com1<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM1 not installed'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM1   : '</font><font color="#000080">,</font>NoZero<font color="#000080">(</font>Hex<font color="#000080">(</font>Com1<font color="#000080">)));
  </font><font color="#FF0000"><b>If </b></font>Com2<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM2 not installed'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM2   : '</font><font color="#000080">,</font>NoZero<font color="#000080">(</font>Hex<font color="#000080">(</font>Com2<font color="#000080">)));
  </font><font color="#FF0000"><b>If </b></font>Com3<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM3 not installed'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM3   : '</font><font color="#000080">,</font>NoZero<font color="#000080">(</font>Hex<font color="#000080">(</font>Com3<font color="#000080">)));
  </font><font color="#FF0000"><b>If </b></font>Com4<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM4 not installed'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Serial Port COM4   : '</font><font color="#000080">,</font>NoZero<font color="#000080">(</font>Hex<font color="#000080">(</font>Com4<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0089.PAS">Original</a><b>]</b></p></body>
</html>
