<html>
<head><title> "Dialing" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 GL&gt; I am writing a simple dialer and would like to know how do
 GL&gt; I recieve the mode String like &quot;BUSY&quot; and &quot;NO CARRIER&quot; , I
 GL&gt; tried opening the Comport For reading but i just hung the
 GL&gt; Computer. Could you please tell me how ?
 GL&gt; Regards , Gareth

  Gareth,
  I didn't see any replies to your message, but I've been looking
  For the same inFormation myself.  I saw the following code, based
  on a message from Norbert Igl, last year.  When I dial my own
  phone number, it gives me a busy signal For a second or two, and
  then hangs up.  I don't know what makes the busy signal stop.  and
  I don't know how to receive the modem String &quot;BUSY&quot; or &quot;NO CARRIER&quot;
  or &quot;NO DIALtoNE&quot;.

  I noticed in my modem manual that modem command X4 will
  generate the following responses:

  Number Response       Word Response
  (V0 command)           (V1 command)

     6                      NO DIALtoNE
     7                      BUSY
     8                      NO ANSWER
                            (The modem responds With 8 if you send
                            the @ command [Wait For Quiet Answer],
                            and it didn't subsequently detect 5
                            seconds of silence.)

     I wish I could figure out a way to &quot;capture&quot; the response, either the
     number (say, 7) or the Word ('BUSY').  if I could detect a busy
     signal, I could then create a loop that would make the
     Program continually redial if it detected busy signals.

     if you figure it out, could you post your solution?

     Here's how Norbert's code With a few modifications:

 Date: 29 Jun 92  23:15:00
 From: Norbert Igl
 to:   Jud Mccranie
 Subj: Dialing the phone

   here's a COM3-able version...(:-)}

   </i></font><font color="#FF0000"><b>Program </b></font>Dialing<font color="#000080">;
   </font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;
   </font><font color="#008000"><i>(* no error checking... *)

   </i></font><font color="#FF0000"><b>Var </b></font>ch <font color="#000080">: </font>Char<font color="#000080">;
       </font>num <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Function </b></font>Dial<font color="#000080">( </font>Nb<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>ComPort<font color="#000080">:</font>Byte <font color="#000080">):</font>Char<font color="#000080">;
            </font><font color="#FF0000"><b>Const  </b></font>DialCmd <font color="#000080">= </font><font color="#800000">'ATDT'</font><font color="#000080">;
                   </font>OnHook  <font color="#000080">= </font><font color="#800000">'ATH'</font><font color="#000080">;
                   </font>CR      <font color="#000080">=  </font><font color="#800000">#13</font><font color="#000080">;
                   </font>Status  <font color="#000080">=  </font><font color="#800000">5</font><font color="#000080">;
            </font><font color="#FF0000"><b>Var    </b></font>UserKey <font color="#000080">: </font>Char<font color="#000080">;
            </font>PortAdr <font color="#000080">: </font>Word<font color="#000080">;

            </font><font color="#FF0000"><b>Procedure </b></font>Com_Write<font color="#000080">( </font>S<font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">);
                      </font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">:</font>Byte<font color="#000080">;

                      </font><font color="#FF0000"><b>Function </b></font>OutputOk<font color="#000080">:</font>Boolean<font color="#000080">;
                          </font><font color="#FF0000"><b>begin
                          </b></font>OutPutOk <font color="#000080">:= ( </font>Port<font color="#000080">[</font>PortAdr<font color="#000080">+</font>Status<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$20</font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">;
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                      </font><font color="#FF0000"><b>Procedure </b></font>ComWriteCh<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>CH<font color="#000080">:</font>Char<font color="#000080">);
                          </font><font color="#FF0000"><b>begin
                          Repeat Until </b></font>OutPutOk<font color="#000080">;
                          </font>Port<font color="#000080">[</font>PortAdr<font color="#000080">] := </font>Byte<font color="#000080">(</font>CH<font color="#000080">);
                          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                      </font><font color="#FF0000"><b>begin
                      For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>ComWriteCh<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">]);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#FF0000"><b>Procedure </b></font>Com_Writeln<font color="#000080">( </font>S <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">);
                      </font><font color="#FF0000"><b>begin
                      </b></font>Com_Write<font color="#000080">( </font>S <font color="#000080">+ </font>CR <font color="#000080">)
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ DIAL.Main }
   </i></font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">(</font>ComPort <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">( </font>ComPort <font color="#000080">&gt; </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
   </font>PortAdr <font color="#000080">:= </font>MemW<font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">:(</font>ComPort<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2 </font><font color="#000080">];
   </font><font color="#FF0000"><b>if </b></font>PortAdr <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
       </b></font>Com_Writeln<font color="#000080">( </font>OnHook <font color="#000080">);
       </font>Delay<font color="#000080">( </font><font color="#800000">500 </font><font color="#000080">);
       </font>Com_Write  <font color="#000080">( </font>DialCmd <font color="#000080">);
       </font>Com_Writeln<font color="#000080">( </font>Nb <font color="#000080">);
       </font>UserKey <font color="#000080">:= </font>ReadKey<font color="#000080">;
       </font><font color="#FF0000"><b>Until </b></font>UserKey <font color="#000080">&lt;&gt; </font><font color="#800000">' '</font><font color="#000080">;         </font><font color="#008000"><i>{ Hit [SPACE] to redial ! }
   </i></font>Com_Writeln<font color="#000080">( </font>OnHook <font color="#000080">);        </font><font color="#008000"><i>{ switch the line to the handset ...}
   </i></font>Dial <font color="#000080">:= </font>UserKey<font color="#000080">;              </font><font color="#008000"><i>{ see what key the user pressed... }
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>ClrScr<font color="#000080">;
    </font>Write <font color="#000080">(</font><font color="#800000">'Enter your own phone number:  '</font><font color="#000080">);
    </font>Readln<font color="#000080">(</font>Num<font color="#000080">);
    </font>Writeln<font color="#000080">(</font><font color="#800000">'Dialing now... Should get a busy signal.'</font><font color="#000080">);
    </font>ch <font color="#000080">:= </font>dial<font color="#000080">(</font>Num<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0007.PAS">Original</a><b>]</b></p></body>
</html>
