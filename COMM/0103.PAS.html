<html>
<head><title> "Dialing phone using soundcard" by JES RAHBEK KLINKE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0103.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>program </b></font>SBDial<font color="#000080">;

</font><font color="#008000"><i>{ This program demonstrates how to use an Adlib or SoundBlaster card
  for automatically dialing a phone number. You just have to hold the
  microphone close to the speakers and run the program. If you have
  implemented your own address list you no longer have to read the
  phone number from the screen and dial it on the phone. }

{ This program was written by Jes R. Klinke, if you include it in your
  own creations a credit would be nice. }

</i></font><font color="#FF0000"><b>uses
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>NoteLength   <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;  </font><font color="#008000"><i>{ Length of each note in ms }
  </i></font>NoteDelay    <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">;   </font><font color="#008000"><i>{ Delay between two notes }
  </i></font>LongDelay    <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">; </font><font color="#008000"><i>{ Long delay between two notes indicated by
                         a hyphen in number }

{ Constants for MiscFlags }

  </i></font>mfAmpMod     <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">; </font><font color="#008000"><i>{ Amplitude modulation }
  </i></font>mfVibrato    <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;
  </font>mfShortNote  <font color="#000080">= </font><font color="#800000">$20</font><font color="#000080">; </font><font color="#008000"><i>{ No sustain, jump directly from decay to release }
  </i></font>mfShorten    <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">; </font><font color="#008000"><i>{ Shorten the note as its pitch rises }

{ Constants for ScalingLevel }
{ Causes output levels to decrease as the frequency rises }

  </i></font>slNo         <font color="#000080">= </font><font color="#800000">$00</font><font color="#000080">; </font><font color="#008000"><i>{ no change }
  </i></font>sl15db       <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">; </font><font color="#008000"><i>{ 1,5 db per octave }
  </i></font>sl3db        <font color="#000080">= </font><font color="#800000">$80</font><font color="#000080">; </font><font color="#008000"><i>{ 3 db per octave }
  </i></font>sl6db        <font color="#000080">= </font><font color="#800000">$C0</font><font color="#000080">; </font><font color="#008000"><i>{ 6 db per octave }

{ Sets specified FM register }
</i></font><font color="#FF0000"><b>procedure </b></font>SetSBReg<font color="#000080">(</font>Address<font color="#000080">, </font>Value<font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">MOV    DX,0388h
    MOV    AL,Address
    OUT    DX,AL
    MOV    CX,6
@@0:IN AL,DX
    LOOP   @@0
    INC    DX
    MOV    AL,Value
    OUT    DX,AL
    DEC    DX
    MOV    CX,35
@@1:IN AL,DX
    LOOP   @@1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Reads then FM status register }
</i></font><font color="#FF0000"><b>function </b></font>GetSBStatus<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">MOV    DX,0388h
    IN     AL,DX
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Resets the FM chips }
</i></font><font color="#FF0000"><b>procedure </b></font>ResetSB<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Adr<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>Adr <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">$F5 </font><font color="#FF0000"><b>do
    </b></font>SetSBReg<font color="#000080">(</font>Adr<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Calculates offset of the control byte for the given channel and operator }
</i></font><font color="#FF0000"><b>function </b></font>OperatorOffset<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">: </font>Byte<font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>OperatorOffset <font color="#000080">:= </font>Operator <font color="#000080">* </font><font color="#800000">3 </font><font color="#000080">+ </font>Channel <font color="#FF0000"><b>mod </b></font><font color="#800000">3 </font><font color="#000080">+ (</font>Channel <font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">) * </font><font color="#800000">8</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Sets miscellaneous flags and parameters }
</i></font><font color="#FF0000"><b>procedure </b></font>SetMiscParam<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">, </font>MiscFlag<font color="#000080">, </font>FreqvFaktor<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$20 </font><font color="#000080">+ </font>OperatorOffset<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">), </font>MiscFlag <font color="#FF0000"><b>or </b></font>FreqvFaktor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Sets volume and scaling level }
</i></font><font color="#FF0000"><b>procedure </b></font>SetVolume<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">, </font>ScalingLevel<font color="#000080">, </font>Volume<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$40 </font><font color="#000080">+ </font>OperatorOffset<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">), </font>ScalingLevel <font color="#FF0000"><b>or </b></font>Volume<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Sets attack, decay, sustain and release rates }
</i></font><font color="#FF0000"><b>procedure </b></font>SetADSR<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">, </font>Attack<font color="#000080">, </font>Decay<font color="#000080">, </font>Sustain<font color="#000080">, </font>Release<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$60 </font><font color="#000080">+ </font>OperatorOffset<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">), </font>Attack <font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#FF0000"><b>or </b></font>Decay<font color="#000080">);
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$80 </font><font color="#000080">+ </font>OperatorOffset<font color="#000080">(</font>Channel<font color="#000080">, </font>Operator<font color="#000080">), </font>Sustain <font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#FF0000"><b>or </b></font>Release<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Sets feedback 0..7, 0 being no feedback, 7 the most }
{ Also sets whether operator 0 modulates operator 2 or
  they produce sound individually }
</i></font><font color="#FF0000"><b>procedure </b></font>SetFeedback<font color="#000080">(</font>Channel<font color="#000080">, </font>Feedback<font color="#000080">: </font>Byte<font color="#000080">; </font>Separate<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$C0 </font><font color="#000080">+ </font>Channel<font color="#000080">, </font>Feedback <font color="#FF0000"><b>shl </b></font><font color="#800000">1 </font><font color="#FF0000"><b>or </b></font>Byte<font color="#000080">(</font>Separate<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Starts playing the note given by Octave and Freq }
</i></font><font color="#FF0000"><b>procedure </b></font>PlayNote<font color="#000080">(</font>Channel<font color="#000080">, </font>Octave<font color="#000080">: </font>Byte<font color="#000080">; </font>Freq<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$A0 </font><font color="#000080">+ </font>Channel<font color="#000080">, </font>Lo<font color="#000080">(</font>Freq<font color="#000080">));
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$B0 </font><font color="#000080">+ </font>Channel<font color="#000080">, </font><font color="#800000">$20 </font><font color="#FF0000"><b>or </b></font>Octave <font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#FF0000"><b>or </b></font>Hi<font color="#000080">(</font>Freq<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Stops playing }
</i></font><font color="#FF0000"><b>procedure </b></font>StopNote<font color="#000080">(</font>Channel<font color="#000080">, </font>Octave<font color="#000080">: </font>Byte<font color="#000080">; </font>Freq<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$A0 </font><font color="#000080">+ </font>Channel<font color="#000080">, </font>Lo<font color="#000080">(</font>Freq<font color="#000080">));
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$B0 </font><font color="#000080">+ </font>Channel<font color="#000080">, </font>Octave <font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#FF0000"><b>or </b></font>Hi<font color="#000080">(</font>Freq<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Detect if FM-chips i present }
</i></font><font color="#FF0000"><b>function </b></font>DetectSB<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Result1<font color="#000080">, </font>Result2<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetSBReg<font color="#000080">(</font><font color="#800000">$4</font><font color="#000080">, </font><font color="#800000">$60</font><font color="#000080">);
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$4</font><font color="#000080">, </font><font color="#800000">$80</font><font color="#000080">);
  </font>Result1 <font color="#000080">:= </font>GetSBStatus<font color="#000080">;
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$2</font><font color="#000080">, </font><font color="#800000">$FF</font><font color="#000080">);
  </font>SetSBReg<font color="#000080">(</font><font color="#800000">$4</font><font color="#000080">, </font><font color="#800000">$21</font><font color="#000080">);
  </font>Delay <font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font>Result2 <font color="#000080">:= </font>GetSBStatus<font color="#000080">;
  </font>DetectSB <font color="#000080">:= ((</font>Result1 <font color="#FF0000"><b>and </b></font><font color="#800000">$E0</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>Result2 <font color="#FF0000"><b>and </b></font><font color="#800000">$E0</font><font color="#000080">) = </font><font color="#800000">$C0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Dials the specified phone number }
</i></font><font color="#FF0000"><b>procedure </b></font>Dial<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>No<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>const
</b></font><font color="#008000"><i>{ Frequency combinations for the keys on a phone }
  </i></font>Tone<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">11</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (
    (</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),
    (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),
    (</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),
    (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),
    (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),
    (</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">),
    (</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),
    (</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">),
    (</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">));
</font><font color="#008000"><i>{ Low frequency of the pair }
  </i></font>LoFreq<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of
    record
      </b></font>O<font color="#000080">: </font>Byte<font color="#000080">;
      </font>F<font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>end </b></font><font color="#000080">= (
    (</font>O<font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">457</font><font color="#000080">),
    (</font>O<font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">505</font><font color="#000080">),
    (</font>O<font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">558</font><font color="#000080">),
    (</font>O<font color="#000080">: </font><font color="#800000">5</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">617</font><font color="#000080">));
</font><font color="#008000"><i>{ High frequency of the pair }
  </i></font>HiFreq<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of
    record
      </b></font>O<font color="#000080">: </font>Byte<font color="#000080">;
      </font>F<font color="#000080">: </font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>end </b></font><font color="#000080">= (
    (</font>O<font color="#000080">: </font><font color="#800000">6</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">396</font><font color="#000080">),
    (</font>O<font color="#000080">: </font><font color="#800000">6</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">438</font><font color="#000080">),
    (</font>O<font color="#000080">: </font><font color="#800000">6</font><font color="#000080">; </font>F<font color="#000080">: </font><font color="#800000">484</font><font color="#000080">));
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">, </font>ToneNo<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetMiscParam<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>SetVolume<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>SetADSR<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
  </font>SetFeedBack<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>True<font color="#000080">);
  </font>SetMiscParam<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>SetVolume<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>SetADSR<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
  </font>SetFeedBack<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>True<font color="#000080">);
  </font>SetMiscParam<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>SetVolume<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>SetADSR<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
  </font>SetMiscParam<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font>SetVolume<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">);
  </font>SetADSR<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>No<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    if </b></font>No<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">, </font><font color="#800000">'*'</font><font color="#000080">, </font><font color="#800000">'#'</font><font color="#000080">] </font><font color="#FF0000"><b>then
    begin
      </b></font><font color="#008000"><i>{ Determine the number of the key }
      </i></font><font color="#FF0000"><b>if </b></font>No<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'*' </font><font color="#FF0000"><b>then
        </b></font>ToneNo <font color="#000080">:= </font><font color="#800000">10
      </font><font color="#FF0000"><b>else if </b></font>No<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'#' </font><font color="#FF0000"><b>then
        </b></font>ToneNo <font color="#000080">:= </font><font color="#800000">11
      </font><font color="#FF0000"><b>else
        </b></font>ToneNo <font color="#000080">:= </font>Byte<font color="#000080">(</font>No<font color="#000080">[</font>I<font color="#000080">]) - </font>Byte<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
      </font><font color="#008000"><i>{ Play the two frequencies in channel 0 and 1}
      </i></font>PlayNote<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>LoFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">]].</font>O<font color="#000080">, </font>LoFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">]].</font>F<font color="#000080">);
      </font>PlayNote<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>HiFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">]].</font>O<font color="#000080">, </font>HiFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">]].</font>F<font color="#000080">);
      </font>Delay<font color="#000080">(</font>NoteLength<font color="#000080">);
      </font><font color="#008000"><i>{ The contral ought to have had enough time to recognize the keypress }
      </i></font>StopNote<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>LoFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">]].</font>O<font color="#000080">, </font>LoFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">]].</font>F<font color="#000080">);
      </font>StopNote<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">, </font>HiFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">]].</font>O<font color="#000080">, </font>HiFreq<font color="#000080">[</font>Tone<font color="#000080">[</font>ToneNo<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">]].</font>F<font color="#000080">);
      </font>Delay<font color="#000080">(</font>NoteDelay<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ a hyphen in the number indicates a longer delay between the keypresses }
    </i></font><font color="#FF0000"><b>if </b></font>No<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'-' </font><font color="#FF0000"><b>then
      </b></font>Delay<font color="#000080">(</font>LongDelay<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if not </b></font>DetectSB <font color="#FF0000"><b>then
  begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'This program requires an Adlib or compatible soundcard'</font><font color="#000080">);
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Dial<font color="#000080">(</font><font color="#800000">'875 8133'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0103.PAS">Original</a><b>]</b></p></body>
</html>
