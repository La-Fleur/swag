<html>
<head><title> "Chat" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Otherwise, how could I tell the difference between the local users input
&gt; and the remote users input??? If I knew that I guess I could Write my
&gt; own chat Procedure.

Well, I definately agree With you there.. Here's some ugly code
I put into my doors, it's a chat Procedure, not With all the features I'd like,
but it works, anyway..  (BTW, I'm working on a split screen version now, but
that'll take some time as I'm very busy these days..)  This is a dump from part
of my SYSKEY.INC include File..
}

{$F+}

(* This include File is where you will take actions you define when trapped
   keys such as ALT-keys, Function-keys, etc., are pressed.

   You will need to setup your Procedures here which in turn may call other
   Procedures within your code or you may do all you need to do right here.

   For example, if you wanted to trap For ALT-C being pressed on the local
   keyboard and then call the Procedure CHAT:

   Your main block of code might look like this:

   begin  {main}
      ASSIGN(Output,'') ;
      REWrite(Output) ;
      SysopKey[1] := #0 + #46 ;   {define ALT-C as one of twenty keys }
                                  {to trap                            }
      SysopProc[1] := ALT_C ;     {define Procedure as defined here   }
      SysopKey ;                  {setup For Far call to this File    }
   end ;

   Now, whenever ALT-C is pressed, the following Procedure will be called:

   Procedure ALT_C ;
   begin
      CHAT ;                      {call Procedure CHAT which is located }
   end ;                          {within your Program's code           }

   *)

(*
   The following Procedures are called when up/down arrows are pressed
   provided they are defined using SysopKey[] and SysopProc[] within
   the main Program code
*)

</i></font><font color="#FF0000"><b>Procedure </b></font>end_Chat<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Chatended <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#008000"><i>{ Do some other stuff here if you'd like }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Chat<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>FKeyCode          <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">;
  </font>Space             <font color="#000080">= </font><font color="#800000">' '</font><font color="#000080">;
  </font>Hyphen            <font color="#000080">= </font><font color="#800000">'-'</font><font color="#000080">;
  </font>BackSpace         <font color="#000080">= ^</font>H<font color="#000080">;
  </font>CarriageReturn    <font color="#000080">= ^</font>M<font color="#000080">;
  </font>MaxWordLineLength <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>WordLine  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font>MaxWordLineLength<font color="#000080">];
  </font>Index1    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Index2    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>InputChar <font color="#000080">: </font>Char<font color="#000080">;
  </font>F         <font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>Label </b></font>Get_Char<font color="#000080">;

</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{WordWrap}
  </i></font><font color="#FF0000"><b>If </b></font>LocalKey <font color="#FF0000"><b>Then
    </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>UserKeysOn <font color="#000080">:= </font>False<font color="#000080">;
  </font>WordLine  <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Index1    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Index2    <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>InputChar <font color="#000080">:= </font>Space<font color="#000080">;
  </font>ClearScreen<font color="#000080">;
  </font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Sysop Entering Chat Mode: '</font><font color="#000080">);
  </font>InputChar <font color="#000080">:= </font>GetChar<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>LocalKey <font color="#FF0000"><b>Then
    </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font>InactiveVal <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#FF0000"><b>While  </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>Chatended<font color="#000080">)
  </font><font color="#FF0000"><b>do begin
    If </b></font>LocalKey <font color="#FF0000"><b>Then
      </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
    </font><font color="#FF0000"><b>Else
      </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>InputChar <font color="#FF0000"><b>OF
      </b></font>BackSpace<font color="#000080">: </font><font color="#008000"><i>{Write destructive backspace &amp; remove Char from WordLine}
        </i></font><font color="#FF0000"><b>begin
          If </b></font>LocalKey <font color="#FF0000"><b>Then
            </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)
          </font><font color="#FF0000"><b>Else
            </b></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
          </font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BackSpace<font color="#000080">+</font>Space<font color="#000080">+</font>BackSpace<font color="#000080">);
          </font>DELETE<font color="#000080">(</font>WordLine<font color="#000080">,(</font>LENGTH<font color="#000080">(</font>WordLine<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">)
        </font><font color="#FF0000"><b>end
      else </b></font><font color="#008000"><i>{InputChar contains a valid Char, so deal With it}
      </i></font><font color="#FF0000"><b>begin
        If </b></font><font color="#000080">( </font>InPutChar <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) ) </font><font color="#FF0000"><b>Then
        begin
          If </b></font>LocalKey <font color="#FF0000"><b>Then
            </b></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>InputChar<font color="#000080">)
          </font><font color="#FF0000"><b>Else
            </b></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>InputChar<font color="#000080">);
        </font><font color="#FF0000"><b>end
        Else
        begin
          If </b></font>LocalKey <font color="#FF0000"><b>Then
            </b></font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>InputChar<font color="#000080">)
          </font><font color="#FF0000"><b>Else
            </b></font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>InputChar<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>InputChar <font color="#000080">&lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>Then
          </b></font>WordLine <font color="#000080">:= (</font>WordLine <font color="#000080">+ </font>InputChar<font color="#000080">)
        </font><font color="#FF0000"><b>Else
          </b></font>WordLine <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>LENGTH<font color="#000080">(</font>WordLine<font color="#000080">) &gt;= (</font>MaxWordLineLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{we have to do a Word-wrap}
        </i></font><font color="#FF0000"><b>begin
          </b></font>Index1 <font color="#000080">:= (</font>MaxWordLineLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>WordLine<font color="#000080">[</font>Index1<font color="#000080">] &lt;&gt; </font>Space<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>WordLine<font color="#000080">[</font>Index1<font color="#000080">] &lt;&gt; </font>Hyphen<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Index1 <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>DO
            </b></font>Index1 <font color="#000080">:= (</font>Index1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Index1 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#008000"><i>{whoah, no space was found to split line!} </i></font><font color="#FF0000"><b>then
            </b></font>Index1 <font color="#000080">:= (</font>MaxWordLineLength <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{forces split}
          </i></font>DELETE<font color="#000080">(</font>WordLine<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Index1<font color="#000080">);
          </font><font color="#FF0000"><b>For </b></font>Index2 <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>LENGTH<font color="#000080">(</font>WordLine<font color="#000080">) </font><font color="#FF0000"><b>DO
            </b></font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>BackSpace <font color="#000080">+ </font>Space <font color="#000080">+ </font>BackSpace<font color="#000080">);
          </font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
          </font><font color="#FF0000"><b>If </b></font>InPutChar <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>then
          begin
            If </b></font>LocalKey <font color="#FF0000"><b>Then
              </b></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>WordLine<font color="#000080">)
            </font><font color="#FF0000"><b>Else
              </b></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>WordLine<font color="#000080">);
          </font><font color="#FF0000"><b>end
          Else
          begin
            If </b></font>LocalKey <font color="#FF0000"><b>Then
              </b></font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>WordLine<font color="#000080">)
            </font><font color="#FF0000"><b>Else
              </b></font>sDisplay<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>WordLine<font color="#000080">);
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      end
    end</b></font><font color="#000080">; </font><font color="#008000"><i>{CASE InputChar}
    {Get next key from user.}
    </i></font>Get_Char<font color="#000080">:
    </font><font color="#FF0000"><b>begin
     </b></font>InputChar <font color="#000080">:= </font>GetChar<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>WordLine <font color="#000080">= </font><font color="#800000">'' </font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>InputChar <font color="#000080">= </font>Chr<font color="#000080">(</font><font color="#800000">13</font><font color="#000080">) ) </font><font color="#FF0000"><b>Then
      begin
       </b></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
       </font><font color="#FF0000"><b>Goto </b></font>Get_Char<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{WHILE ( not (Chatended) )}
  </i></font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">12</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'Sysop Left Chat Mode.'</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font><font color="#FF0000"><b>NOT </b></font>Registered<font color="#000080">) </font><font color="#FF0000"><b>Then
  </b></font>DisplayLoc<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'&thorn; If you find this Program of value, please register.'</font><font color="#000080">);
  </font>Delay<font color="#000080">(</font><font color="#800000">2500</font><font color="#000080">);
  </font>Display<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">15</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">'Press ( '</font><font color="#000080">+</font><font color="#800000">#17</font><font color="#000080">+</font><font color="#800000">'&Auml;&Auml;&Ugrave; ) to Continue . . .'</font><font color="#000080">);
  </font>ClearScreen<font color="#000080">;
  </font>Chatended <font color="#000080">:= </font>False<font color="#000080">;
  </font>InactiveVal <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
  </font>UserKeysOn <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{
There.. let me know if you need any clarification..  (BTW, you need global
Variables Chatended and Registered as Booleans in the main program..
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
