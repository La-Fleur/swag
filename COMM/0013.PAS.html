<html>
<head><title> "Is Modem Ringing ??" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Function </b></font>ModemRinging<font color="#000080">(</font>Port <font color="#000080">: </font>Word<font color="#000080">) : </font>Boolean<font color="#000080">;  </font><font color="#008000"><i>{ through the BIOS }
</i></font><font color="#FF0000"><b>Var
  </b></font>Dummy <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Asm
    </b></font><font color="#FF00FF">dec port
    mov ah,03h
    mov dx,port
    int 14h
    mov dummy,al
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ModemRinging <font color="#000080">:= (</font>Dummy <font color="#FF0000"><b>and </b></font>RI<font color="#000080">) = </font>RI       <font color="#008000"><i>{ ring indicated }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>or

Function </b></font>ModemRinging<font color="#000080">(</font>Port <font color="#000080">: </font>Byte<font color="#000080">) : </font>Boolean<font color="#000080">;  </font><font color="#008000"><i>{ direct port access }
</i></font><font color="#FF0000"><b>Const
  </b></font>RI <font color="#000080">= </font><font color="#800000">$40</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  Case </b></font>Port <font color="#FF0000"><b>of
    </b></font><font color="#800000">1 </font><font color="#000080">: </font>ModemRinging <font color="#000080">:= (</font><font color="#800000">$3FE </font><font color="#FF0000"><b>and </b></font>RI<font color="#000080">) = </font>RI<font color="#000080">;   </font><font color="#008000"><i>{ com 1 }
    </i></font><font color="#800000">2 </font><font color="#000080">: </font>ModemRinging <font color="#000080">:= (</font><font color="#800000">$2FE </font><font color="#FF0000"><b>and </b></font>RI<font color="#000080">) = </font>RI    <font color="#008000"><i>{ com 2 }
  </i></font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PhoneRinging<font color="#000080">(</font>ComPort<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
    Case </b></font>ComPort <font color="#FF0000"><b>Of
        </b></font><font color="#800000">1</font><font color="#000080">: </font>PhoneRinging <font color="#000080">:= (</font>Port<font color="#000080">[</font><font color="#800000">$3FE</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">64</font><font color="#000080">) = </font><font color="#800000">64</font><font color="#000080">;
        </font><font color="#800000">2</font><font color="#000080">: </font>PhoneRinging <font color="#000080">:= (</font>Port<font color="#000080">[</font><font color="#800000">$2FE</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">64</font><font color="#000080">) = </font><font color="#800000">64</font><font color="#000080">;
        </font><font color="#800000">3</font><font color="#000080">: </font>PhoneRinging <font color="#000080">:= (</font>Port<font color="#000080">[</font><font color="#800000">$3EE</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">64</font><font color="#000080">) = </font><font color="#800000">64</font><font color="#000080">;
        </font><font color="#800000">4</font><font color="#000080">: </font>PhoneRinging <font color="#000080">:= (</font>Port<font color="#000080">[</font><font color="#800000">$2EE</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">64</font><font color="#000080">) = </font><font color="#800000">64</font><font color="#000080">;
        </font><font color="#FF0000"><b>Else
            </b></font>PhoneRinging <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>returns True <font color="#FF0000"><b>if </b></font>phone <font color="#FF0000"><b>is </b></font>ringing<font color="#000080">. </font>Hope it helps<font color="#000080">.

</font><font color="#008000"><i>{
&gt; Function returns True if phone is ringing. Hope it helps.

Just nitpicking but...

 PhoneRinging:=(Port[$3FE] and 64)&lt;&gt;0

is more efficient, as is

 PhoneRinging:=Boolean(Port[$3FE] and 64)
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to COMM SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0013.PAS">Original</a><b>]</b></p></body>
</html>
