<html>
<head><title> "Complete Sorting Unit" by SWAG SUPPORT GROUP</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>Sort<font color="#000080">;

  </font><font color="#008000"><i>{ These sort routines are for arrays of Integers.  Count is the maximum }
  { number of items in the array.                                         }

{****************************************************************************}
                             </i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION  </b></font>BinarySearch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>X <font color="#000080">: </font>Integer<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>BubbleSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#008000"><i>{slow}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CombSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);  </font><font color="#008000"><i>{fast}
</i></font><font color="#FF0000"><b>FUNCTION  </b></font>SequentialSearch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>X <font color="#000080">: </font>Integer<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ShellSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);  </font><font color="#008000"><i>{moderate}
{****************************************************************************}
                             </i></font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>TYPE
  </b></font>SortArray <font color="#000080">= </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
{                                                                            }
{                   Local Procedures and Functions                           }
{                                                                            }
{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Swap <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">, </font>B <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>C <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   </b></font>C <font color="#000080">:= </font>A<font color="#000080">;
   </font>A <font color="#000080">:= </font>B<font color="#000080">;
   </font>B <font color="#000080">:= </font>C<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
{                                                                            }
{                   Global Procedures and Functions                          }
{                                                                            }
{****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>BinarySearch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>X <font color="#000080">: </font>Integer<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>High<font color="#000080">, </font>Low<font color="#000080">, </font>Mid <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Low <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>High <font color="#000080">:= </font>Count<font color="#000080">;
      </font><font color="#FF0000"><b>WHILE </b></font>High <font color="#000080">&gt;= </font>Low <font color="#FF0000"><b>DO
         BEGIN
            </b></font>Mid <font color="#000080">:= </font>Trunc<font color="#000080">(</font>High <font color="#000080">+ </font>Low<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
            </font><font color="#FF0000"><b>IF </b></font>X <font color="#000080">&gt; </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>mid<font color="#000080">]
               </font><font color="#FF0000"><b>THEN </b></font>Low <font color="#000080">:= </font>Mid <font color="#000080">+ </font><font color="#800000">1
               </font><font color="#FF0000"><b>ELSE IF </b></font>X <font color="#000080">&lt; </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>Mid<font color="#000080">]
                       </font><font color="#FF0000"><b>THEN </b></font>High <font color="#000080">:= </font>Mid <font color="#000080">- </font><font color="#800000">1
                       </font><font color="#FF0000"><b>ELSE </b></font>High <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>High <font color="#000080">= -</font><font color="#800000">1
         </font><font color="#FF0000"><b>THEN </b></font>BinarySearch <font color="#000080">:= </font>Mid
         <font color="#FF0000"><b>ELSE </b></font>BinarySearch <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>BubbleSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
   FOR </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>Count <font color="#FF0000"><b>DO
     FOR </b></font>j <font color="#000080">:= </font>Count <font color="#FF0000"><b>DOWNTO </b></font>i <font color="#FF0000"><b>DO
       IF </b></font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] &gt; </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">]
          </font><font color="#FF0000"><b>THEN </b></font>Swap<font color="#000080">(</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">],</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CombSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#008000"><i>{ The combsort is an optimised version of the bubble sort. It uses a     }
  { decreasing gap in order to compare values of more than one element     }
  { apart.  By decreasing the gap the array is gradually &quot;combed&quot; into     }
  { order ... like combing your hair. First you get rid of the large       }
  { tangles, then the smaller ones ...                                     }
  { There are a few particular things about the combsort.                  }
  { Firstly, the optimal shrink factor is 1.3 (worked out through a        }
  { process of exhaustion by the guys at BYTE magazine). Secondly, by      }
  { never having a gap of 9 or 10, but always using 11, the sort is        }
  { faster.                                                                }
  { This sort approximates an n log n sort - it's faster than any other    }
  { sort I've seen except the quicksort (and it beats that too sometimes). }
  { The combsort does not slow down under *any* circumstances. In fact, on }
  { partially sorted lists (including *reverse* sorted lists) it speeds up.}
</i></font><font color="#FF0000"><b>CONST </b></font>ShrinkFactor <font color="#000080">= </font><font color="#800000">1.3</font><font color="#000080">;  </font><font color="#008000"><i>{ Optimal shrink factor ...       }
</i></font><font color="#FF0000"><b>VAR
  </b></font>Gap<font color="#000080">, </font>i<font color="#000080">, </font>Temp <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Finished <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Gap <font color="#000080">:= </font>Trunc<font color="#000080">(</font>ShrinkFactor<font color="#000080">);
  </font><font color="#FF0000"><b>REPEAT
    </b></font>Finished <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font>Gap <font color="#000080">:= </font>Trunc<font color="#000080">(</font>Gap<font color="#000080">/</font>ShrinkFactor<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>Gap <font color="#000080">&lt; </font><font color="#800000">1
       </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Gap must *never* be less than 1 } </i></font>Gap <font color="#000080">:= </font><font color="#800000">1
       </font><font color="#FF0000"><b>ELSE IF </b></font>Gap <font color="#FF0000"><b>IN </b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">]
               </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Optimises the sort ... } </i></font>Gap <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>Count <font color="#000080">- </font>Gap<font color="#000080">) </font><font color="#FF0000"><b>DO
      IF </b></font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">] &lt; </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">+</font>gap<font color="#000080">]
         </font><font color="#FF0000"><b>THEN BEGIN
                </b></font>Swap<font color="#000080">(</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">],</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i <font color="#000080">+ </font>Gap<font color="#000080">]);
                </font>Finished <font color="#000080">:= </font>FALSE<font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Gap <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>Finished<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#008000"><i>{**************************************************************************}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>PartialSort<font color="#000080">(</font>LowerBoundary<font color="#000080">, </font>UpperBoundary <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>ii<font color="#000080">, </font>l1<font color="#000080">, </font>r1<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>k <font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>k <font color="#000080">:= (</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>LowerBoundary<font color="#000080">] + </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>UpperBoundary<font color="#000080">]) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
    </font>i <font color="#000080">:= </font>LowerBoundary<font color="#000080">;
    </font>j <font color="#000080">:= </font>UpperBoundary<font color="#000080">;
    </font><font color="#FF0000"><b>REPEAT
      WHILE </b></font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">] &lt; </font>k <font color="#FF0000"><b>DO </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>WHILE </b></font>k <font color="#000080">&lt; </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">] </font><font color="#FF0000"><b>DO </b></font>Dec<font color="#000080">(</font>j<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt;= </font>j
         <font color="#FF0000"><b>THEN BEGIN
                </b></font>Swap<font color="#000080">(</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">],</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">]);
                </font>Inc<font color="#000080">(</font>i<font color="#000080">);
                </font>Dec<font color="#000080">(</font>j<font color="#000080">);
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font>i <font color="#000080">&gt; </font>j<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>LowerBoundary <font color="#000080">&lt; </font>j
       <font color="#FF0000"><b>THEN </b></font>PartialSort<font color="#000080">(</font>LowerBoundary<font color="#000080">,</font>j<font color="#000080">,</font>A<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt; </font>UpperBoundary
       <font color="#FF0000"><b>THEN </b></font>PartialSort<font color="#000080">(</font>UpperBoundary<font color="#000080">,</font>i<font color="#000080">,</font>A<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>{*************************************************************************}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>PartialSort<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>Count<font color="#000080">,</font>A<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>SequentialSearch <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>X <font color="#000080">: </font>Integer<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Count <font color="#FF0000"><b>DO
    IF </b></font>X <font color="#000080">= </font>Sortarray<font color="#000080">(</font>A<font color="#000080">)[</font>i<font color="#000080">]
       </font><font color="#FF0000"><b>THEN BEGIN
              </b></font>SequentialSearch <font color="#000080">:= </font>i<font color="#000080">;
              </font>Exit<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>SequentialSearch <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShellSort <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>A<font color="#000080">; </font>Count <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>Gap<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>k <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Gap <font color="#000080">:= </font>Count <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>gap <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      FOR </b></font>i <font color="#000080">:= (</font>Gap <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>TO </b></font>Count <font color="#FF0000"><b>DO
        BEGIN
          </b></font>j <font color="#000080">:= </font>i <font color="#000080">- </font>Gap<font color="#000080">;
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
            BEGIN
              </b></font>k <font color="#000080">:= </font>j <font color="#000080">+ </font>gap<font color="#000080">;
              </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">] &lt;= </font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>k<font color="#000080">])
                 </font><font color="#FF0000"><b>THEN </b></font>j <font color="#000080">:= </font><font color="#800000">0
                 </font><font color="#FF0000"><b>ELSE </b></font>Swap<font color="#000080">(</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>j<font color="#000080">],</font>SortArray<font color="#000080">(</font>A<font color="#000080">)[</font>k<font color="#000080">]);
              </font>j <font color="#000080">:= </font>j <font color="#000080">- </font>Gap<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Gap <font color="#000080">:= </font>Gap <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
