<html>
<head><title> "SORT-LL.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I have a linked list structure that I would like to sort in one of
&gt; four different ways.  I can sort Arrays using QuickSort, etc., but have no
&gt; experience sorting linked lists.  Does anyone have any source code
&gt; (preferably) or any suggestions on how to proceed?  Any help would be
&gt; appreciated.

I got Modula-2 code I wrote about one year ago. I post an excerpt from
the Implementation MODULE. It should be no problem to convert it to
Pascal, since the languages are rather similar.
}
</i></font><font color="#FF0000"><b>Procedure </b></font>LISTSort<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>List     <font color="#000080">: </font>LISTType<font color="#000080">;
                       </font>Ascending<font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>Last  <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
  </font>Result<font color="#000080">: </font>LISTCompareResultType<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>TailIns<font color="#000080">(    </font>Rec  <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
                    </font><font color="#FF0000"><b>Var </b></font>First<font color="#000080">: </font>NodeTypePtr<font color="#000080">;
                    </font><font color="#FF0000"><b>Var </b></font>Last <font color="#000080">: </font>NodeTypePtr<font color="#000080">);

  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>First<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>First <font color="#000080">:= </font>Rec <font color="#FF0000"><b>else </b></font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>Rec <font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Last <font color="#000080">:= </font>Rec
  <font color="#FF0000"><b>end </b></font>TailIns<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>MergeLists<font color="#000080">(    </font>a<font color="#000080">: </font>NodeTypePtr<font color="#000080">;
                           </font>b<font color="#000080">: </font>NodeTypePtr<font color="#000080">): </font>NodeTypePtr<font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>First<font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>Last <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>Help <font color="#000080">: </font>NodeTypePtr<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>First <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>b<font color="#800000">#</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
      if </b></font><font color="#000080">(</font>a<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>a <font color="#000080">:= </font>b<font color="#000080">; </font>b <font color="#000080">:= </font><font color="#FF0000"><b>NIL
      else
        if </b></font><font color="#000080">(</font>Classes<font color="#000080">[</font>List<font color="#000080">^.</font>ClassID<font color="#000080">].</font>Cmp<font color="#000080">(</font>b<font color="#000080">^.</font>DataPtr<font color="#000080">,</font>a<font color="#000080">^.</font>DataPtr<font color="#000080">)=</font>Result<font color="#000080">)
        </font><font color="#FF0000"><b>then
          </b></font>Help <font color="#000080">:= </font>a<font color="#000080">; </font>a <font color="#000080">:= </font>a<font color="#000080">^.</font>Next
        <font color="#FF0000"><b>else
          </b></font>Help <font color="#000080">:= </font>b<font color="#000080">; </font>b <font color="#000080">:= </font>b<font color="#000080">^.</font>Next
        <font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>Help<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
        </font>TailIns<font color="#000080">(</font>Help<font color="#000080">,</font>First<font color="#000080">,</font>Last<font color="#000080">)
      </font><font color="#FF0000"><b>end
    end</b></font><font color="#000080">;
    </font>TailIns<font color="#000080">(</font>a<font color="#000080">,</font>First<font color="#000080">,</font>Last<font color="#000080">);
    </font>RETURN<font color="#000080">(</font>First<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font>MergeLists<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>MergeSort<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Root<font color="#000080">: </font>NodeTypePtr<font color="#000080">;
                          </font>N   <font color="#000080">: </font>CARDinAL<font color="#000080">): </font>NodeTypePtr<font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>Help<font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>a<font color="#000080">,</font>b <font color="#000080">: </font>NodeTypePtr<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>Root<font color="#000080">=</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>RETURN<font color="#000080">(</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">)
    </font>ELSif <font color="#000080">(</font>N<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>a <font color="#000080">:= </font>MergeSort<font color="#000080">(</font>Root<font color="#000080">,</font>N <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
      </font>b <font color="#000080">:= </font>MergeSort<font color="#000080">(</font>Root<font color="#000080">,(</font>N<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
      </font>RETURN<font color="#000080">(</font>MergeLists<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">))
    </font><font color="#FF0000"><b>else
      </b></font>Help <font color="#000080">:= </font>Root<font color="#000080">;
      </font>Root <font color="#000080">:= </font>Root<font color="#000080">^.</font>Next<font color="#000080">;
      </font>Help<font color="#000080">^.</font>Next <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
      </font>RETURN<font color="#000080">(</font>Help<font color="#000080">)
    </font><font color="#FF0000"><b>end
  end </b></font>MergeSort<font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>List<font color="#000080">^.</font>N<font color="#000080">&lt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>RETURN <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Ascending<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Result <font color="#000080">:= </font>LISTGreater <font color="#FF0000"><b>else </b></font>Result <font color="#000080">:= </font>LISTLess <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>List<font color="#000080">^.</font>top<font color="#000080">^.</font>Next <font color="#000080">:= </font>MergeSort<font color="#000080">(</font>List<font color="#000080">^.</font>top<font color="#000080">^.</font>Next<font color="#000080">,</font>List<font color="#000080">^.</font>N<font color="#000080">);
  </font>Last <font color="#000080">:= </font>List<font color="#000080">^.</font>top<font color="#000080">;
  </font>List<font color="#000080">^.</font>Cursor <font color="#000080">:= </font>List<font color="#000080">^.</font>top<font color="#000080">^.</font>Next<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>List<font color="#000080">^.</font>Cursor<font color="#800000">#</font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>List<font color="#000080">^.</font>Cursor<font color="#000080">^.</font>Prev <font color="#000080">:= </font>Last<font color="#000080">;
    </font>Last <font color="#000080">:= </font>List<font color="#000080">^.</font>Cursor<font color="#000080">;
    </font>List<font color="#000080">^.</font>Cursor <font color="#000080">:= </font>List<font color="#000080">^.</font>Cursor<font color="#000080">^.</font>Next
  <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Last<font color="#000080">^.</font>Next <font color="#000080">:= </font>List<font color="#000080">^.</font>Bottom<font color="#000080">;
  </font>List<font color="#000080">^.</font>Bottom<font color="#000080">^.</font>Prev <font color="#000080">:= </font>Last<font color="#000080">;
  </font>List<font color="#000080">^.</font>CurPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>List<font color="#000080">^.</font>Cursor <font color="#000080">:= </font>List<font color="#000080">^.</font>top<font color="#000080">^.</font>Next
<font color="#FF0000"><b>end </b></font>LISTSort<font color="#000080">;

</font><font color="#008000"><i>{
The basic data structure is defined as follows:
}

</i></font><font color="#FF0000"><b>Const
  </b></font>MaxClasses   <font color="#000080">= </font><font color="#800000">256</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>NodeTypePtr <font color="#000080">= </font>Pointer <font color="#FF0000"><b>to </b></font>NodeType<font color="#000080">;

  </font>NodeType <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Prev   <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>Next   <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>DataPtr<font color="#000080">: </font>ADDRESS
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>LISTType <font color="#000080">= </font>Pointer <font color="#FF0000"><b>to </b></font>ListType<font color="#000080">;

  </font>ListType <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>top    <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>Bottom <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>Cursor <font color="#000080">: </font>NodeTypePtr<font color="#000080">;
    </font>N      <font color="#000080">: </font>CARDinAL<font color="#000080">;
    </font>CurPos <font color="#000080">: </font>CARDinAL<font color="#000080">;
    </font>ClassID<font color="#000080">: </font>CARDinAL
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>ClassType <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Cmp  <font color="#000080">: </font>LISTCompareProcType<font color="#000080">;
    </font>Bytes<font color="#000080">: </font>CARDinAL
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Classes<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxClasses<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ClassType<font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
