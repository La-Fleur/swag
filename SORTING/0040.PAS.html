<html>
<head><title> "QUICK SORTER" by BOB SWART</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: BOB SWART
Subj: Sorting...
---------------------------------------------------------------------------
 Does anyone know of a VERY fast way to sort something?  I would
 really like  to view some source code on this if possible.  I need to
 sort over 1200  strings, and do it rather quickly.

 Try this, it uses a TStringCollection...
}

{$IFDEF VER70}
{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S+,T-,V-,X-}
{$ELSE}
{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,R-,S+,V-,X-}
{$ENDIF}
{$M 16384,0,655360}
{
  Sorteer 3.0
  Borland Pascal (Objects) 7.0.
  Copr. (c) 9-29-1993 DwarFools &amp; Consultancy drs. Robert E. Swart
                      P.O. box 799
                      5702 NP  Helmond
                      The Netherlands
  Code size: 5824 Bytes
  Data size: 1254 Bytes
  .EXE size: 4971 Bytes
  ----------------------------------------------------------------
  Authors: Bob Swart (2:281/256.12)
           Hans van der Veeke (2:282/517.2)
}
</i></font><font color="#FF0000"><b>uses </b></font><font color="#008000"><i>{$IFDEF WINDOWS}
     </i></font>WinCrt<font color="#000080">,
     </font><font color="#008000"><i>{$ENDIF}
     </i></font>Objects<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PStr <font color="#000080">= ^</font>TStr<font color="#000080">;
  </font>TStr <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TObject<font color="#000080">)
           </font>StrName<font color="#000080">: </font>PString<font color="#000080">;
           </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>_StrName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
         </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{TStr}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>constructor </b></font>TStr<font color="#000080">.</font>Init<font color="#000080">(</font>_StrName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>TObject<font color="#000080">.</font>Init<font color="#000080">;
    </font>StrName <font color="#000080">:= </font>NewStr<font color="#000080">(</font>_StrName<font color="#000080">)
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{Init}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>PStrColl <font color="#000080">= ^</font>TStrColl<font color="#000080">;
  </font>TStrColl <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TStringCollection<font color="#000080">)
               </font><font color="#FF0000"><b>function </b></font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{TStrColl}</i></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>TStrColl<font color="#000080">.</font>KeyOf<font color="#000080">(</font>Item<font color="#000080">: </font>Pointer<font color="#000080">): </font>Pointer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>KeyOf <font color="#000080">:= </font>PStr<font color="#000080">(</font>Item<font color="#000080">)^.</font>StrName
  <font color="#FF0000"><b>end </b></font><font color="#008000"><i>{KeyOf}</i></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>StrColl<font color="#000080">: </font>PStrColl<font color="#000080">;
    </font>Line<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>F<font color="#000080">: </font>Text<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'Sorteer - Sort strings (c) 1993 by Bob Swart &amp; Hans van der Veeke.'#13#10</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage: Sorteer [ASCII file to be sorted]'</font><font color="#000080">);
    </font>Halt<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>F<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
  </font>reset<font color="#000080">(</font>F<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Error - could not open file '</font><font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">));
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StrColl <font color="#000080">:= </font>New<font color="#000080">(</font>PStrColl<font color="#000080">,</font>Init<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">,</font><font color="#800000">500</font><font color="#000080">));
  </font>StrColl<font color="#000080">^.</font>Duplicates <font color="#000080">:= </font>True<font color="#000080">; </font><font color="#008000"><i>{ make False for NO duplicates }
  </i></font><font color="#FF0000"><b>while not </b></font>Eof<font color="#000080">(</font>F<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>readln<font color="#000080">(</font>F<font color="#000080">,</font>Line<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>Line<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>StrColl<font color="#000080">^.</font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PStr<font color="#000080">, </font>Init<font color="#000080">(</font>Line<font color="#000080">)))
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Close<font color="#000080">(</font>F<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>StrColl<font color="#000080">^.</font>Count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>writeln<font color="#000080">(</font>PStr<font color="#000080">(</font>StrColl<font color="#000080">^.</font>At<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">))^.</font>StrName<font color="#000080">^); </font><font color="#008000"><i>{ print first element }
    </i></font>StrColl<font color="#000080">^.</font>AtFree<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{ delete and dispose first element StrColl }
  </i></font><font color="#FF0000"><b>end
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p></body>
</html>
