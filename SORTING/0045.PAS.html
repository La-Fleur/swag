<html>
<head><title> "Turbovison Text Sort" by BRIAN RICHARDSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
    Here is an example of a TStringCollection decendant that sorts the
    strings by the 30th character and beyond.  The default
    TStringCollection sorts from the first character. }

    </i></font><font color="#FF0000"><b>uses </b></font>Objects<font color="#000080">;

    </font><font color="#FF0000"><b>type
        </b></font>PMyCollection   <font color="#000080">= ^</font>TMyCollection<font color="#000080">;
        </font>TMyCollection   <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TStringCollection<font color="#000080">)
            </font><font color="#FF0000"><b>function </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2 <font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>function </b></font>TMyCollection<font color="#000080">.</font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2 <font color="#000080">: </font>Pointer<font color="#000080">); </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>var </b></font>s<font color="#000080">, </font>t <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>begin
        </b></font><font color="#008000"><i>{ This is where you would sort two strings Compare must
          return -1 if Key1 &lt; Key2, 0 if Key1 = Key2, and
          1 if Key1 &gt; Key2 }
        </i></font>s <font color="#000080">:= </font>Copy<font color="#000080">(</font>Key1<font color="#000080">^, </font><font color="#800000">30</font><font color="#000080">, </font>Length<font color="#000080">(</font>Key1<font color="#000080">^) - </font><font color="#800000">30</font><font color="#000080">);
        </font>t <font color="#000080">:= </font>Copy<font color="#000080">(</font>Key2<font color="#000080">^, </font><font color="#800000">30</font><font color="#000080">, </font>Length<font color="#000080">(</font>Key2<font color="#000080">^) - </font><font color="#800000">30</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>s <font color="#000080">&lt; </font>t <font color="#FF0000"><b>then </b></font>Compare <font color="#000080">:= -</font><font color="#800000">1 </font><font color="#FF0000"><b>else
         if </b></font>s <font color="#000080">= </font>t <font color="#FF0000"><b>then </b></font>Compare <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>else
           </b></font>Compare <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>var </b></font>P <font color="#000080">: </font>PMyCollection<font color="#000080">;
    </font><font color="#FF0000"><b>begin
       </b></font>P <font color="#000080">:= </font>New<font color="#000080">(</font>PMyCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">));
       </font>ReadLineFromFile<font color="#000080">;
       </font>Insert<font color="#000080">(</font>NewStr<font color="#000080">(</font>LineFromFile<font color="#000080">));
       </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>P<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
        </b></font>writeln<font color="#000080">(</font>PString<font color="#000080">(</font>P<font color="#000080">^.</font>At<font color="#000080">(</font>x<font color="#000080">))^);
       </font>Dispose<font color="#000080">(</font>P<font color="#000080">, </font>Done<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
