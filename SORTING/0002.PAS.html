<html>
<head><title> "Anangram Sort" by GUY MCLOUGHLIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>(* Start of PART 1 of 7 *)

(***********************************************************************
          Contest 3 Entry : Anagram Sort by Guy McLoughlin
          Compiler        : Borland Pascal 7.0
***********************************************************************)

 {.$DEFINE DebugMode}

 {$IFDEF DebugMode}
   {$A+,B-,D+,E-,F-,G+,I+,L+,N-,O-,P-,Q+,R+,S+,T+,V+,X-}
 {$ELSE}
   {$A+,B-,D-,E-,F-,G+,I-,L-,N-,O-,P-,Q-,R-,S+,T-,V-,X-}
 {$endIF}

 {$M 16384,374784,655360}

</i></font><font color="#FF0000"><b>Program </b></font>Anagram_Sort<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>co_MaxWord  <font color="#000080">=  </font><font color="#800000">2500</font><font color="#000080">;
  </font>co_MaxSize  <font color="#000080">= </font><font color="#800000">65519</font><font color="#000080">;
  </font>co_SafeSize <font color="#000080">= </font><font color="#800000">64500</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>Char_12 <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

  </font>st_4    <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
  </font>st_10   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
  </font>st_80   <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];

  </font>byar_26 <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">97</font><font color="#000080">..</font><font color="#800000">122</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

  </font>po_Buff     <font color="#000080">= ^</font>byar_Buffer<font color="#000080">;
  </font>byar_Buffer <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>co_MaxSize<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

  </font>porc_Word <font color="#000080">= ^</font>rc_Word<font color="#000080">;
  </font>rc_Word   <font color="#000080">= </font><font color="#FF0000"><b>Record
                </b></font>wo_Pos    <font color="#000080">: </font>Word<font color="#000080">;
                </font>ar_LtrChk <font color="#000080">: </font>Char_12<font color="#000080">;
                </font>st_Word   <font color="#000080">: </font>st_10
              <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>poar_Word     <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>co_MaxWord<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>porc_Word<font color="#000080">;

  </font>porc_AnaGroup <font color="#000080">= ^</font>rc_AnaGroup<font color="#000080">;
  </font>rc_AnaGroup   <font color="#000080">= </font><font color="#FF0000"><b>Record
                    </b></font>wo_Pos   <font color="#000080">: </font>Word<font color="#000080">;
                    </font>st_Group <font color="#000080">: </font>st_80
                  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>poar_AnaGroup <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>co_MaxWord<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>porc_AnaGroup<font color="#000080">;
  </font>poar_Generic  <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>co_MaxWord<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Pointer<font color="#000080">;

  </font><font color="#008000"><i>(***** Check For I/O errors.                                        *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Procedure </b></font>CheckIOerror<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>by_Error <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>by_Error <font color="#000080">:= </font>ioresult<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>by_Error <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Input/Output error = '</font><font color="#000080">, </font>by_Error<font color="#000080">);
        </font>halt
      <font color="#FF0000"><b>end
  end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* CheckIOerror.                                        *)

  (***** Display HEAP error message.                                  *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Procedure </b></font>HeapError<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Insuficient free HEAP memory'</font><font color="#000080">);
    </font>halt
  <font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* HeapError.                                        *)

</i></font><font color="#FF0000"><b>Type
  </b></font>Item     <font color="#000080">= </font>Pointer<font color="#000080">;
  </font>ar_Item  <font color="#000080">= </font>poar_Generic<font color="#000080">;
  </font>CompFunc <font color="#000080">= </font><font color="#FF0000"><b>Function</b></font><font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Item<font color="#000080">) : </font>Boolean<font color="#000080">;

 </font><font color="#008000"><i>(* end of PART 1 of 7 *)
 (* Start of PART 2 of 7 *)

  (***** QuickSort routine.                                           *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Procedure </b></font>QuickSort<font color="#000080">(</font><font color="#008000"><i>{update} </i></font><font color="#FF0000"><b>Var </b></font>ar_Data  <font color="#000080">: </font>ar_Item<font color="#000080">;
                      </font><font color="#008000"><i>{input }     </i></font>wo_Left<font color="#000080">,
                                   </font>wo_Right <font color="#000080">: </font>Word<font color="#000080">;
                                   </font>LessThan <font color="#000080">: </font>CompFunc<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>Pivot<font color="#000080">,
    </font>TempItem <font color="#000080">: </font>Item<font color="#000080">;
    </font>wo_Index1<font color="#000080">,
    </font>wo_Index2 <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>wo_Index1 <font color="#000080">:= </font>wo_Left<font color="#000080">;
    </font>wo_Index2 <font color="#000080">:= </font>wo_Right<font color="#000080">;
    </font>Pivot <font color="#000080">:= </font>ar_Data<font color="#000080">[(</font>wo_Left <font color="#000080">+ </font>wo_Right<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">];
    </font><font color="#FF0000"><b>Repeat
      While </b></font>LessThan<font color="#000080">(</font>ar_Data<font color="#000080">[</font>wo_Index1<font color="#000080">], </font>Pivot<font color="#000080">) </font><font color="#FF0000"><b>do
        </b></font>inc<font color="#000080">(</font>wo_Index1<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font>LessThan<font color="#000080">(</font>Pivot<font color="#000080">, </font>ar_Data<font color="#000080">[</font>wo_Index2<font color="#000080">]) </font><font color="#FF0000"><b>do
        </b></font>dec<font color="#000080">(</font>wo_Index2<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>wo_Index1 <font color="#000080">&lt;= </font>wo_Index2<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>TempItem <font color="#000080">:= </font>ar_Data<font color="#000080">[</font>wo_Index1<font color="#000080">];
          </font>ar_Data<font color="#000080">[</font>wo_Index1<font color="#000080">] := </font>ar_Data<font color="#000080">[</font>wo_Index2<font color="#000080">];
          </font>ar_Data<font color="#000080">[</font>wo_Index2<font color="#000080">] := </font>TempItem<font color="#000080">;
          </font>inc<font color="#000080">(</font>wo_Index1<font color="#000080">);
          </font>dec<font color="#000080">(</font>wo_Index2<font color="#000080">)
        </font><font color="#FF0000"><b>end
      Until </b></font><font color="#000080">(</font>wo_Index1 <font color="#000080">&gt; </font>wo_Index2<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>wo_Left <font color="#000080">&lt; </font>wo_Index2<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>QuickSort<font color="#000080">(</font>ar_Data<font color="#000080">, </font>wo_Left<font color="#000080">, </font>wo_Index2<font color="#000080">, </font>LessThan<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>wo_Index1 <font color="#000080">&lt; </font>wo_Right<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>QuickSort<font color="#000080">(</font>ar_Data<font color="#000080">, </font>wo_Index1<font color="#000080">, </font>wo_Right<font color="#000080">, </font>LessThan<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* QuickSort.                                           *)

  (***** Sort Function to check if anagram-Word's are in sorted order *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Function </b></font>AlphaSort<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Item<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>AlphaSort <font color="#000080">:= (</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>st_Word <font color="#000080">&lt; </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>st_Word<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* AlphaSort.                                           *)

  (***** Sort Function to check:                                      *)
  (*                                                                  *)
  (*        1 - If anagram-Words are sorted by length.                *)
  (*        2 - If anagram-Words are sorted by anagram-group.         *)
  (*        3-  If anagram-Words are sorted alphabeticly.             *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Function </b></font>Sort1<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Item<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;&gt;
                                      </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>then
      </b></font>Sort1 <font color="#000080">:= (</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] &lt;
                                           </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])
    </font><font color="#FF0000"><b>else
      if </b></font><font color="#000080">(</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>ar_LtrChk <font color="#000080">&lt;&gt;
                                       </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>ar_LtrChk<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>Sort1 <font color="#000080">:= (</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>ar_LtrChk <font color="#000080">&lt;
                                            </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>ar_LtrChk<font color="#000080">)
      </font><font color="#FF0000"><b>else
        </b></font>Sort1 <font color="#000080">:= (</font>porc_Word<font color="#000080">(</font>Item1<font color="#000080">)^.</font>wo_Pos <font color="#000080">&lt; </font>porc_Word<font color="#000080">(</font>Item2<font color="#000080">)^.</font>wo_Pos<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Sort1.                                               *)

  (***** Sort Function to check:                                      *)
  (*                                                                  *)
  (*     If anagram-group Strings are sorted alphabeticly.            *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Function </b></font>Sort2<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Item<font color="#000080">) : </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Far</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Sort2 <font color="#000080">:= (</font>porc_AnaGroup<font color="#000080">(</font>Item1<font color="#000080">)^.</font>wo_Pos <font color="#000080">&lt;
                                           </font>porc_AnaGroup<font color="#000080">(</font>Item2<font color="#000080">)^.</font>wo_Pos<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* Sort2.                                               *)

 (* end of PART 2 of 7 *)
 (* Start of PART 3 of 7 *)

  (***** Check if the anagram-Word table is in sorted order.          *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Function </b></font>TableSorted<font color="#000080">(</font><font color="#008000"><i>{input } </i></font><font color="#FF0000"><b>Var </b></font>ar_Data  <font color="#000080">: </font>poar_Word<font color="#000080">;
                                    </font>wo_Left<font color="#000080">,
                                    </font>wo_Right <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#008000"><i>{output} </i></font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>wo_Index <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>begin
              </b></font><font color="#008000"><i>(* Set Function result to True.                         *)
    </i></font>TableSorted <font color="#000080">:= </font>True<font color="#000080">;

              </font><font color="#008000"><i>(* Loop through all but the last Word in the anagram-   *)
              (* Word &quot;table&quot;.                                        *)
    </i></font><font color="#FF0000"><b>For </b></font>wo_Index <font color="#000080">:= </font>wo_Left <font color="#FF0000"><b>to </b></font>pred<font color="#000080">(</font>wo_Right<font color="#000080">) </font><font color="#FF0000"><b>do
              </b></font><font color="#008000"><i>(* Check if the current and next anagram-Words are not  *)
              (* sorted.                                              *)
      </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ar_Data<font color="#000080">[</font>wo_Index<font color="#000080">]^.</font>st_Word <font color="#000080">&gt;
                                </font>ar_Data<font color="#000080">[</font>succ<font color="#000080">(</font>wo_Index<font color="#000080">)]^.</font>st_Word<font color="#000080">) </font><font color="#FF0000"><b>then
      begin
              </b></font><font color="#008000"><i>(* Set Function result to False, and break the &quot;for&quot;    *)
              (* loop.                                                *)
        </i></font>TableSorted <font color="#000080">:= </font>False<font color="#000080">;
        </font>break
      <font color="#FF0000"><b>end
  end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* TableSorted.                                         *)

  (***** Pack bits 0,1,2 of each Byte in 26 Byte Array into 10 Chars. *)
  (*                                                                  *)
  </i></font><font color="#FF0000"><b>Procedure </b></font>PackBits<font color="#000080">(</font><font color="#008000"><i>{input } </i></font><font color="#FF0000"><b>Var </b></font>byar_Temp <font color="#000080">: </font>byar_26<font color="#000080">;
                     </font><font color="#008000"><i>{output} </i></font><font color="#FF0000"><b>Var </b></font>Char_Temp <font color="#000080">: </font>Char_12<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>Char_Temp<font color="#000080">[ </font><font color="#800000">1</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[ </font><font color="#800000">97</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[ </font><font color="#800000">98</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[ </font><font color="#800000">99</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$6</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">2</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[ </font><font color="#800000">99</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">7 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">101</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">102</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$4</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">3</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">102</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">103</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">104</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">));
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">4</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">105</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">106</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">107</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$6</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">5</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">107</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">7 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">108</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">109</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">110</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$4</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">6</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">110</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">111</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">112</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">));
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">7</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">113</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">114</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">115</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$6</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">8</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">115</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$1</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">7 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">116</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">4 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">117</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">118</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$4</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">);
    </font>Char_Temp<font color="#000080">[ </font><font color="#800000">9</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">118</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">119</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">3 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">120</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">));
    </font>Char_Temp<font color="#000080">[</font><font color="#800000">10</font><font color="#000080">] := </font>chr<font color="#000080">((</font>byar_Temp<font color="#000080">[</font><font color="#800000">121</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">5 </font><font color="#000080">+
                         (</font>byar_Temp<font color="#000080">[</font><font color="#800000">122</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7</font><font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;        </font><font color="#008000"><i>(* PackBits.                                            *)

</i></font><font color="#FF0000"><b>Var
  </b></font>po_Buffer       <font color="#000080">: </font>po_Buff<font color="#000080">;

  </font>by_Index<font color="#000080">,
  </font>by_LastAnagram<font color="#000080">,
  </font>by_CurrentWord  <font color="#000080">: </font>Byte<font color="#000080">;

  </font>wo_Index<font color="#000080">,
  </font>wo_ReadIndex<font color="#000080">,
  </font>wo_TableIndex<font color="#000080">,
  </font>wo_BufferIndex<font color="#000080">,
  </font>wo_CurrentIndex <font color="#000080">: </font>Word<font color="#000080">;

 </font><font color="#008000"><i>(* end of PART 3 of 7 *)
 (* Start of PART 4 of 7 *)

  </i></font>st_Temp         <font color="#000080">: </font>st_4<font color="#000080">;

  </font>byar_LtrChk     <font color="#000080">: </font>byar_26<font color="#000080">;

  </font>fi_Temp         <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;

  </font>rcar_Table      <font color="#000080">: </font>poar_Word<font color="#000080">;

  </font>rcar_Groups     <font color="#000080">: </font>poar_AnaGroup<font color="#000080">;


              </font><font color="#008000"><i>(* Main Program execution block.                        *)
</i></font><font color="#FF0000"><b>begin
              </b></font><font color="#008000"><i>(* If there is sufficient room, allocate the main data- *)
              (* buffer on the HEAP.                                  *)
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>maxavail <font color="#000080">&gt; </font>co_MaxSize<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>new<font color="#000080">(</font>po_Buffer<font color="#000080">)
  </font><font color="#FF0000"><b>else
              </b></font><font color="#008000"><i>(* Else, inform user of insufficient HEAP memory, and   *)
              (* halt the Program.                                    *)
    </i></font>HeapError<font color="#000080">;

              </font><font color="#008000"><i>(* Clear the data-buffer.                               *)
  </i></font>fillChar<font color="#000080">(</font>po_Buffer<font color="#000080">^, </font>co_MaxSize<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);

              </font><font color="#008000"><i>(* Initialize counter Variable.                         *)
  </i></font>wo_Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#008000"><i>(* While the counter is less than co_MaxWord do...      *)
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>co_MaxWord <font color="#000080">&gt; </font>wo_Index<font color="#000080">) </font><font color="#FF0000"><b>do

              </b></font><font color="#008000"><i>(* If there is sufficient memory, allocate another      *)
              (* anagram-Word Record on the HEAP.                     *)
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>maxavail <font color="#000080">&gt; </font>sizeof<font color="#000080">(</font>rc_Word<font color="#000080">)) </font><font color="#FF0000"><b>then
      begin
        </b></font>inc<font color="#000080">(</font>wo_Index<font color="#000080">);
        </font>new<font color="#000080">(</font>rcar_Table<font color="#000080">[</font>wo_Index<font color="#000080">]);
        </font>fillChar<font color="#000080">(</font>rcar_Table<font color="#000080">[</font>wo_Index<font color="#000080">]^, </font>sizeof<font color="#000080">(</font>rc_Word<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
    else
              </b></font><font color="#008000"><i>(* Else, inform user of insufficient HEAP memory, and   *)
              (* halt the Program.                                    *)
      </i></font>HeapError<font color="#000080">;

              </font><font color="#008000"><i>(* Initialize counter Variable.                         *)
  </i></font>wo_Index <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#008000"><i>(* While the counter is less than co_MaxWord do...      *)
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>co_MaxWord <font color="#000080">&gt; </font>wo_Index<font color="#000080">) </font><font color="#FF0000"><b>do

              </b></font><font color="#008000"><i>(* If there is sufficient memory, allocate another      *)
              (* anagram-group String on the HEAP.                    *)
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>maxavail <font color="#000080">&gt; </font>sizeof<font color="#000080">(</font>rc_AnaGroup<font color="#000080">)) </font><font color="#FF0000"><b>then
      begin
        </b></font>inc<font color="#000080">(</font>wo_Index<font color="#000080">);
        </font>new<font color="#000080">(</font>rcar_Groups<font color="#000080">[</font>wo_Index<font color="#000080">]);
        </font>fillChar<font color="#000080">(</font>rcar_Groups<font color="#000080">[</font>wo_Index<font color="#000080">]^, </font>sizeof<font color="#000080">(</font>rc_AnaGroup<font color="#000080">), </font><font color="#800000">32</font><font color="#000080">);
      </font><font color="#FF0000"><b>end
    else
              </b></font><font color="#008000"><i>(* Else, inform user of insufficient HEAP memory, and   *)
              (* halt the Program.                                    *)
      </i></font>HeapError<font color="#000080">;

              </font><font color="#008000"><i>(* Attempt to open File containing the anagram-Words.   *)
  </i></font>assign<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">'WordLIST.DAT'</font><font color="#000080">);

              </font><font color="#008000"><i>(* Set Filemode to &quot;read-only&quot;.                         *)
  </i></font>Filemode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#008000"><i>{$I-}
  </i></font>reset<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
              (* Check For I/O errors.                                *)
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ioresult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Error opening anagram data File ---&gt; WordLIST.DAT'</font><font color="#000080">);
      </font>halt
    <font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#008000"><i>(* Read-in the entire anagram list into the data-buffer *)
  </i></font>blockread<font color="#000080">(</font>fi_Temp<font color="#000080">, </font>po_Buffer<font color="#000080">^, </font>co_MaxSize<font color="#000080">, </font>wo_ReadIndex<font color="#000080">);

 </font><font color="#008000"><i>(* end of PART 4 of 7 *)
 (* Start of PART 5 of 7 *)

              (* Check For I/O errors.                                *)
  </i></font>CheckIOerror<font color="#000080">;

  </font>close<font color="#000080">(</font>fi_Temp<font color="#000080">);

              </font><font color="#008000"><i>(* Check For I/O errors.                                *)
  </i></font>CheckIOerror<font color="#000080">;

              </font><font color="#008000"><i>(* Initialize index Variables.                          *)
  </i></font>wo_TableIndex  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>wo_BufferIndex <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#008000"><i>(* Repeat...Until all data in the data-buffer has been  *)
              (* processed.                                           *)
  </i></font><font color="#FF0000"><b>Repeat

              </b></font><font color="#008000"><i>(* Repeat...Until a valid anagram-Word Character has    *)
              (* been found, or the complete data-buffer has been     *)
              (* processed.                                           *)
    </i></font><font color="#FF0000"><b>Repeat
      </b></font>inc<font color="#000080">(</font>wo_BufferIndex<font color="#000080">)
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">((</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">] &gt; </font><font color="#800000">96</font><font color="#000080">)
      </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">] &lt; </font><font color="#800000">123</font><font color="#000080">))
       </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>wo_BufferIndex <font color="#000080">&gt; </font>wo_ReadIndex<font color="#000080">);

              </font><font color="#008000"><i>(* If the complete data-buffer has been processed then  *)
              (* break the Repeat...Until loop.                       *)
    </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>wo_BufferIndex <font color="#000080">&gt; </font>wo_ReadIndex<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>break<font color="#000080">;

              </font><font color="#008000"><i>(* Advance the anagram-Word &quot;table&quot; index.              *)
    </i></font>inc<font color="#000080">(</font>wo_TableIndex<font color="#000080">);

              </font><font color="#008000"><i>(* Clear the &quot;letter check&quot; Byte-Array Variable.        *)
    </i></font>fillChar<font color="#000080">(</font>byar_LtrChk<font color="#000080">, </font>sizeof<font color="#000080">(</font>byar_26<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);

              </font><font color="#008000"><i>(* Repeat...Until not an anagram-Word Character,  or    *)
              (* complete data-buffer has been processed.             *)
    </i></font><font color="#FF0000"><b>Repeat

              </b></font><font color="#008000"><i>(* With the current anagram-Word Record do...           *)
      </i></font><font color="#FF0000"><b>With </b></font>rcar_Table<font color="#000080">[</font>wo_TableIndex<font color="#000080">]^ </font><font color="#FF0000"><b>do
        begin
              </b></font><font color="#008000"><i>(* Record the number of each alphabetical Character in  *)
              (* the anagram-Word.                                    *)
          </i></font>inc<font color="#000080">(</font>byar_LtrChk<font color="#000080">[</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">]]);

              </font><font color="#008000"><i>(* Advance the String length-Character.                 *)
          </i></font>inc<font color="#000080">(</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);

              </font><font color="#008000"><i>(* Add the current anagram-Word Character to anagram-   *)
              (* Word String.                                         *)
          </i></font>st_Word<font color="#000080">[</font>ord<font color="#000080">(</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">])] :=
                                    </font>chr<font color="#000080">(</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">]);

              </font><font color="#008000"><i>(* Advance the data-buffer index.                       *)
          </i></font>inc<font color="#000080">(</font>wo_BufferIndex<font color="#000080">)

        </font><font color="#FF0000"><b>end
    Until </b></font><font color="#000080">(</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">] &lt; </font><font color="#800000">97</font><font color="#000080">)
       </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">] &gt; </font><font color="#800000">122</font><font color="#000080">)
       </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>wo_BufferIndex <font color="#000080">&gt; </font>wo_ReadIndex<font color="#000080">);

              </font><font color="#008000"><i>(* Pack bits 0,1,2 of each Character in &quot;letter-check&quot;  *)
              (* Variable, to store Variable as 10 Char data. This    *)
              (* reduces memory storage requirements by 16 Bytes For  *)
              (* each anagram-Word, and makes data faster to sort.    *)
    </i></font>PackBits<font color="#000080">(</font>byar_LtrChk<font color="#000080">, </font>rcar_Table<font color="#000080">[</font>wo_TableIndex<font color="#000080">]^.</font>ar_LtrChk<font color="#000080">);

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>wo_BufferIndex <font color="#000080">&gt; </font>wo_ReadIndex<font color="#000080">);

              </font><font color="#008000"><i>(* Check if the Array of anagram-Words in the &quot;table&quot;   *)
              (* Array are sorted. If not then sort them.             *)
  </i></font><font color="#FF0000"><b>if not </b></font>TableSorted<font color="#000080">(</font>rcar_Table<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>wo_TableIndex<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>QuickSort<font color="#000080">(</font>poar_Generic<font color="#000080">(</font>rcar_Table<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>wo_TableIndex<font color="#000080">, </font>AlphaSort<font color="#000080">);

              </font><font color="#008000"><i>(* Record the position of all the anagram-Words on the  *)
              (* &quot;table&quot; Array. This will be used as a faster sorting *)
              (* index.                                               *)
  </i></font><font color="#FF0000"><b>For </b></font>wo_Index <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>wo_TableIndex <font color="#FF0000"><b>do
    </b></font>rcar_Table<font color="#000080">[</font>wo_Index<font color="#000080">]^.</font>wo_Pos <font color="#000080">:= </font>wo_Index<font color="#000080">;

 </font><font color="#008000"><i>(* end of PART 5 of 7 *)
  (* Start of PART 6 of 7 *)

              (* QuickSort the &quot;table&quot; of anagram Words, using Sort1  *)
              (* routine.                                             *)
  </i></font>QuickSort<font color="#000080">(</font>poar_Generic<font color="#000080">(</font>rcar_Table<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>wo_TableIndex<font color="#000080">, </font>Sort1<font color="#000080">);

              </font><font color="#008000"><i>(* Attempt to open a File to Write sorted data to.      *)
  </i></font>assign<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">'SORTED.DAT'</font><font color="#000080">);
  </font><font color="#008000"><i>{$I-}
  </i></font>reWrite<font color="#000080">(</font>fi_Temp<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);

              </font><font color="#008000"><i>(* Check For I/O errors.                                *)
  </i></font>CheckIOerror<font color="#000080">;

              </font><font color="#008000"><i>(* Set the temporary String to ', ' + Cr + Lf.          *)
  </i></font>st_Temp <font color="#000080">:= </font><font color="#800000">', ' </font><font color="#000080">+ </font><font color="#800000">#13#10</font><font color="#000080">;

              </font><font color="#008000"><i>(* Reset the loop index.                                *)
  </i></font>wo_Index      <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

              </font><font color="#008000"><i>(* Repeat...Until all anagram-Word on &quot;table&quot; Array are *)
              (* processed.                                           *)
  </i></font><font color="#FF0000"><b>Repeat

              </b></font><font color="#008000"><i>(* Reset the counter Variables.                         *)
    </i></font>by_LastAnagram <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>by_CurrentWord <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

              </font><font color="#008000"><i>(* While the next anagram-Word belongs to the same      *)
              (* anagram-group, advance the by_LastAnagram Variable.  *)
    </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+ </font>by_LastAnagram<font color="#000080">)]^.</font>ar_LtrChk <font color="#000080">=
              </font>rcar_Table<font color="#000080">[</font>succ<font color="#000080">(</font>wo_Index <font color="#000080">+ </font>by_LastAnagram<font color="#000080">)]^.</font>ar_LtrChk<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>by_LastAnagram<font color="#000080">);

              </font><font color="#008000"><i>(* Repeat...Until next anagram-Word is not in the same  *)
              (* anagram group.                                       *)
    </i></font><font color="#FF0000"><b>Repeat

              </b></font><font color="#008000"><i>(* With current anagram group do...                     *)
      </i></font><font color="#FF0000"><b>With </b></font>rcar_Groups<font color="#000080">[(</font>wo_Index <font color="#000080">+ </font>by_CurrentWord<font color="#000080">)]^ </font><font color="#FF0000"><b>do
        begin

              </b></font><font color="#008000"><i>(* Move the first anagram-Word in &quot;table&quot; Array to the  *)
              (* current anagram group-String.                        *)
          </i></font>move<font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+ </font>by_CurrentWord<font color="#000080">)]^.</font>st_Word<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],
               </font>st_Group<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>ord<font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+
                                         </font>by_CurrentWord<font color="#000080">)]^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));

              </font><font color="#008000"><i>(* Set the length-Char of current anagram-String to 12. *)
          </i></font>st_Group<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#12</font><font color="#000080">;

              </font><font color="#008000"><i>(* Record the first anagram-Word position.              *)
          </i></font>wo_Pos <font color="#000080">:= </font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+ </font>by_CurrentWord<font color="#000080">)]^.</font>wo_Pos<font color="#000080">;

              </font><font color="#008000"><i>(* Loop from 0 to total number of anagrams in the group *)
          </i></font><font color="#FF0000"><b>For </b></font>by_Index <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>by_LastAnagram <font color="#FF0000"><b>do

              </b></font><font color="#008000"><i>(* If the loop index is not equal the the current       *)
              (* anagram-Word, then...                                *)
            </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>by_Index <font color="#000080">&lt;&gt; </font>by_CurrentWord<font color="#000080">) </font><font color="#FF0000"><b>then
              begin

              </b></font><font color="#008000"><i>(* Add the next anagram-Word to the anagram-String.     *)
                </i></font>move<font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+ </font>by_Index<font color="#000080">)]^.</font>st_Word<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],
                     </font>st_Group<font color="#000080">[</font>succ<font color="#000080">(</font>length<font color="#000080">(</font>st_Group<font color="#000080">))],
                     </font>ord<font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+
                                               </font>by_Index<font color="#000080">)]^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));

              </font><font color="#008000"><i>(* Record the length of the anagram-Word added to the   *)
              (* anagram-String.                                      *)
                </i></font>inc<font color="#000080">(</font>st_Group<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],
                    </font>ord<font color="#000080">(</font>rcar_Table<font color="#000080">[(</font>wo_Index <font color="#000080">+
                                               </font>by_Index<font color="#000080">)]^.</font>st_Word<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]));

              </font><font color="#008000"><i>(* If the current anagram-Word is not the last anagram- *)
              (* Word of the anagram-group, and the loop-index is     *)
              (* less than the last anagram-Word, or the loop-index   *)
              (* is less than the 2nd to last anagram-Word in group   *)
                </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>by_CurrentWord <font color="#000080">&lt;&gt; </font>by_LastAnagram<font color="#000080">) </font><font color="#FF0000"><b>and
                    </b></font><font color="#000080">(</font>by_Index <font color="#000080">&lt; </font>by_LastAnagram<font color="#000080">))
                </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>by_Index <font color="#000080">&lt; </font>pred<font color="#000080">(</font>by_LastAnagram<font color="#000080">)) </font><font color="#FF0000"><b>then
                  begin

 </b></font><font color="#008000"><i>(* end of PART 6 of 7 *)
 (* Start of PART 7 of 7 *)

              (* Add the comma and space Character to anagram-String. *)
                    </i></font>move<font color="#000080">(</font>st_Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],
                                   </font>st_Group<font color="#000080">[</font>succ<font color="#000080">(</font>length<font color="#000080">(</font>st_Group<font color="#000080">))], </font><font color="#800000">2</font><font color="#000080">);
                    </font>inc<font color="#000080">(</font>st_Group<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">2</font><font color="#000080">)
                  </font><font color="#FF0000"><b>end
              end</b></font><font color="#000080">;

              </font><font color="#008000"><i>(* Add the CR + Lf to anagram String.                   *)
          </i></font>move<font color="#000080">(</font>st_Temp<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>st_Group<font color="#000080">[</font>succ<font color="#000080">(</font>length<font color="#000080">(</font>st_Group<font color="#000080">))], </font><font color="#800000">2</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>st_Group<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">2</font><font color="#000080">);

              </font><font color="#008000"><i>(* Advance the currrent anagram-Word index.             *)
          </i></font>inc<font color="#000080">(</font>by_CurrentWord<font color="#000080">)

        </font><font color="#FF0000"><b>end
    Until </b></font><font color="#000080">(</font>by_CurrentWord <font color="#000080">&gt; </font>by_LastAnagram<font color="#000080">);

              </font><font color="#008000"><i>(* Advance the anagram-group index by the current       *)
              (* anagram-Word index.                                  *)
    </i></font>inc<font color="#000080">(</font>wo_Index<font color="#000080">, </font>by_CurrentWord<font color="#000080">);

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>wo_Index <font color="#000080">&gt; </font>wo_TableIndex<font color="#000080">);

              </font><font color="#008000"><i>(* QuickSort the anagram-Strings, using Sort2.          *)
  </i></font>QuickSort<font color="#000080">(</font>poar_Generic<font color="#000080">(</font>rcar_Groups<font color="#000080">), </font><font color="#800000">1</font><font color="#000080">, </font>wo_TableIndex<font color="#000080">, </font>Sort2<font color="#000080">);

              </font><font color="#008000"><i>(* Initialize loop control Variable.                    *)
  </i></font>wo_CurrentIndex <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

              </font><font color="#008000"><i>(* Repeat Until all the anagram Words in the &quot;table&quot;    *)
              (* Array have been processed.                           *)
  </i></font><font color="#FF0000"><b>Repeat

              </b></font><font color="#008000"><i>(* Initialize loop control Variable.                    *)
    </i></font>wo_BufferIndex <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

              </font><font color="#008000"><i>(* Place all the anagram-Strings in the data-buffer.    *)
    </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>wo_CurrentIndex <font color="#000080">&lt;= </font>wo_TableIndex<font color="#000080">)
    </font><font color="#FF0000"><b>and   </b></font><font color="#000080">(</font>wo_BufferIndex  <font color="#000080">&lt; </font>co_SafeSize<font color="#000080">) </font><font color="#FF0000"><b>do
      With </b></font>rcar_Groups<font color="#000080">[</font>wo_CurrentIndex<font color="#000080">]^ </font><font color="#FF0000"><b>do
        begin
              </b></font><font color="#008000"><i>(* Place current anagram-String in the data-buffer.     *)
          </i></font>move<font color="#000080">(</font>st_Group<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>po_Buffer<font color="#000080">^[</font>wo_BufferIndex<font color="#000080">],
                                                      </font>length<font color="#000080">(</font>st_Group<font color="#000080">));

              </font><font color="#008000"><i>(* Advance the data-buffer index by length of anagram-  *)
              (* String.                                              *)
          </i></font>inc<font color="#000080">(</font>wo_BufferIndex<font color="#000080">, </font>length<font color="#000080">(</font>st_Group<font color="#000080">));

              </font><font color="#008000"><i>(* Advance current anagram-String index.                *)
          </i></font>inc<font color="#000080">(</font>wo_CurrentIndex<font color="#000080">)

        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

              </font><font color="#008000"><i>(* Write the anagram Text data in the buffer to disk.   *)
    </i></font>blockWrite<font color="#000080">(</font>fi_Temp<font color="#000080">, </font>po_Buffer<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">], </font>pred<font color="#000080">(</font>wo_BufferIndex<font color="#000080">));

              </font><font color="#008000"><i>(* Check For I/O errors.                                *)
    </i></font>CheckIOerror<font color="#000080">;

  </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>wo_CurrentIndex <font color="#000080">&gt;= </font>wo_TableIndex<font color="#000080">);

              </font><font color="#008000"><i>(* Close the sorted anagram-Text File.                  *)
  </i></font>close<font color="#000080">(</font>fi_Temp<font color="#000080">);

              </font><font color="#008000"><i>(* Check For I/O errors.                                *)
  </i></font>CheckIOerror

<font color="#FF0000"><b>end</b></font><font color="#000080">.

 </font><font color="#008000"><i>(* end of PART 7 of 7 *)
{  Hi, to All:

  ...I gather that the 3rd Programming contest (Anagram Word sort)
  is officially over, and am now posting my entry's source-code.

  This Program should execute in well under 1 second on a 486-33
  ram-disk. (It's about 3.21 sec on my 386sx-25) The final compiled
  size of the .EXE is 7360 Bytes.

  ...I've commented the h*ll out of my source-code, so it's a bit
  on the big side.

  ...Here is a &quot;quick&quot; run-down of how it works:

      1- Creates a 60K buffer on the HEAP.

      2- Creates an Array table to store all the anagram Words
         and data about each Word, on the HEAP.

      3- Creates an Array of anagram-group Strings on the HEAP.

      4- Read the entire anagram-Word input File WordLIST.DAT
         into the 60K buffer in 1 big chunk.

      5- Finds all the anagram-Words in the buffer, and assigns
         their data to the anagram-Word table on the HEAP.

      6- Each letter of every anagram-Word is Recorded in an
         Array of 26 Bytes. Then the first 3 bits of each of
         the 26 Bytes is packed, so that this data can be
         stored in a 10 Character Array in each anagram-Word
         table Record. (The bits are packed to save space and
         to make the sorting faster.) This method allows for
         a maximum of 7 of the same letter in each Word, which
         should be sufficient For this contest.

      7- The table of anagram Records is then checked to see if
         the anagram-Words are in sorted order. (In this contest
         the original input File is in sorted order.) If they are
         not in sorted order, QuickSort is called to put the
         Words (actually Pointers to the Words) in order.

      8- Now that the anagram-Words are in sorted order, their
         position in the anagram-Word table is Recorded in a
         position field within each anagram-Word Record.

      9- The table of anagram-Word Records is now sorted using
         a multi-key QuickSort. This will sort the anagram-Word
         Records by:
                     1- Length of anagram-Word.
                     2- Letters that each anagram-Word contains.
                     3- Alphabeticly.

         ...This multi-key sort will establish the anagram groups,
         and sort the members of each group alphabeticly.

     10- Open the sorted output File.

     11- Create N number of anagram-Strings from N mumber of anagram-
         Words in each anagram-group. Keeping the anagram Words in
         the String in sorted order.

     12- QuickSort the anagram-group Strings into alphabetical order.

     13- Place all the sorted anagram-group Strings back into the
         60K buffer.

     14- Write the entire buffer to the SORTED.DAT File, and close
         this File.

   NOTES: Well this is the first time I've figured out how to do
          multi-key QuickSorts, which I wasn't sure was possible
          at first.

          I also tried using a 32-bit CRC value to identify the
          anagram-groups which ran even faster, but should not
          be considered a &quot;safe&quot; method, as it's accuracy is only
          guaranteed For 2-7 Character Words.

          File I/O and repetitive loops are usually the big speed
          killers in these Types of contests, so I always try to
          keep them to a minimum.

          ...My entry could possibly be tweaked further still,
          but I've got a life. &lt;g&gt;

}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0002.PAS">Original</a><b>]</b></p></body>
</html>
