<html>
<head><title> "Alphabetical Order" by CHRISTIAN TIBERG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ This unit will sort ANY type of data into ANY type of order. As an added
bonus, there are a routine to search through a sorted list of ANY type...
Credits go to Bj”rn Felten for his QSort unit, which inspired me to write this
routine }

</i></font><font color="#FF0000"><b>Unit </b></font>SortSrch<font color="#000080">;

</font><font color="#FF0000"><b>interface

Type
    </b></font>CompFunc <font color="#000080">= </font><font color="#FF0000"><b>Function</b></font><font color="#000080">(</font>Item1<font color="#000080">, </font>Item2<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
    </font>SwapProc <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>Item1<font color="#000080">, </font>Item2<font color="#000080">: </font>Integer<font color="#000080">);
    </font>CompOneFunc <font color="#000080">= </font><font color="#FF0000"><b>Function</b></font><font color="#000080">(</font>Item<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>QuickSort<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">: </font>Integer<font color="#000080">; </font>Comp<font color="#000080">: </font>CompFunc<font color="#000080">; </font>Swap<font color="#000080">: </font>SwapProc<font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>BinarySearch<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">: </font>Integer<font color="#000080">; </font>CompOne<font color="#000080">: </font>CompOneFunc<font color="#000080">): </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>implementation

Procedure </b></font>Partition<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>SplitIndex<font color="#000080">: </font>Integer<font color="#000080">;
          </font>Comp<font color="#000080">: </font>CompFunc<font color="#000080">; </font>Swap<font color="#000080">: </font>SwapProc<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Up<font color="#000080">, </font>Down<font color="#000080">, </font>Middle<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    </b></font>Middle <font color="#000080">:= ((</font>Last <font color="#000080">- </font>First<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2 </font><font color="#000080">) + </font>First<font color="#000080">;
    </font>Up <font color="#000080">:= </font>First<font color="#000080">;
    </font>Down <font color="#000080">:= </font>Last<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      While </b></font><font color="#000080">(</font>Comp<font color="#000080">(</font>Up<font color="#000080">, </font>Middle<font color="#000080">) &lt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Up <font color="#000080">&lt; </font>Last<font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>Up<font color="#000080">);
      </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Comp<font color="#000080">(</font>Down<font color="#000080">, </font>Middle<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Down <font color="#000080">&gt; </font>First<font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Dec<font color="#000080">(</font>Down<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Up <font color="#000080">&lt; </font>Down <font color="#FF0000"><b>Then
         </b></font>Swap<font color="#000080">(</font>Up<font color="#000080">, </font>Down<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>Up <font color="#000080">&gt;= </font>Down<font color="#000080">;
    </font>SplitIndex <font color="#000080">:= </font>Down<font color="#000080">;
    </font>Swap<font color="#000080">(</font>Middle<font color="#000080">, </font>SplitIndex<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>QuickSort<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">: </font>Integer<font color="#000080">; </font>Comp<font color="#000080">: </font>CompFunc<font color="#000080">; </font>Swap<font color="#000080">: </font>SwapProc<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>SplitIndex<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    If </b></font>First <font color="#000080">&lt; </font>Last <font color="#FF0000"><b>Then
      Begin
        </b></font>Partition<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">, </font>SplitIndex<font color="#000080">, </font>Comp<font color="#000080">, </font>Swap<font color="#000080">);
        </font>QuickSort<font color="#000080">(</font>First<font color="#000080">, </font>SplitIndex <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>Comp<font color="#000080">, </font>Swap<font color="#000080">);
        </font>QuickSort<font color="#000080">(</font>SplitIndex <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Last<font color="#000080">, </font>Comp<font color="#000080">, </font>Swap<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>BinarySearch<font color="#000080">(</font>First<font color="#000080">, </font>Last<font color="#000080">: </font>Integer<font color="#000080">; </font>CompOne<font color="#000080">: </font>CompOneFunc<font color="#000080">): </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>Middle<font color="#000080">, </font>Jfr<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
    Repeat
      </b></font>Middle <font color="#000080">:= ((</font>Last <font color="#000080">- </font>First<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2 </font><font color="#000080">) + </font>First<font color="#000080">;
      </font>Jfr <font color="#000080">:= </font>CompOne<font color="#000080">(</font>Middle<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Jfr <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        Begin
          </b></font>BinarySearch <font color="#000080">:= </font>Middle<font color="#000080">;
          </font>Exit<font color="#000080">;
        </font><font color="#FF0000"><b>End
      Else If </b></font>Jfr <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>First <font color="#000080">:= </font>Middle
      <font color="#FF0000"><b>Else
        </b></font>Last <font color="#000080">:= </font>Middle<font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>First <font color="#000080">= </font>Last<font color="#000080">;
    </font>BinarySearch <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0050.PAS">Original</a><b>]</b></p></body>
</html>
