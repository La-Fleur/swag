<html>
<head><title> "IMROVSRT.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MARK OUELLET

&gt; I code these things this way:
&gt;
&gt; for I := 1 to MAX-1 do
&gt; for J := I+1 to MAX do
&gt; if A[I] &lt; A[J] then
&gt; begin
&gt; ( swap code )
&gt; end

    this can be improved even more. By limiting the MAX value on each
successive loop by keeping track of the highest swaped pair.

    If on a particular loop, no swap is performed from element MAX-10
onto the end. Then the next loop does not need to go anyhigher than
MAX-11. Remember you are moving the highest value up, if no swap is
performed from MAX-10 on, it means all values above MAX-11 are in order
and all values below MAX-10 are smaller than MAX-10.
}

{$X+}
</i></font><font color="#FF0000"><b>program </b></font>MKOSort<font color="#000080">;

</font><font color="#FF0000"><b>USES
  </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>MAX <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>A <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MAX<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
  </font>Loops <font color="#000080">: </font>word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Swap<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>A1<font color="#000080">, </font>A2 <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Temp <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Temp <font color="#000080">:= </font>A1<font color="#000080">;
  </font>A1   <font color="#000080">:= </font>A2<font color="#000080">;
  </font>A2   <font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>working<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>cursor <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= </font><font color="#800000">'\|/-'</font><font color="#000080">;
  </font>CurrentCursor <font color="#000080">: </font>byte <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>Update <font color="#000080">: </font>word <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>update <font color="#000080">:= (</font>update <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">2500</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>update <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>DirectVideo <font color="#000080">:= </font>False<font color="#000080">;
    </font>write<font color="#000080">(</font>Cursor<font color="#000080">[</font>CurrentCursor<font color="#000080">], </font><font color="#800000">#13</font><font color="#000080">);
    </font>CurrentCursor <font color="#000080">:= ((</font>CurrentCursor <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">4</font><font color="#000080">);
    </font>DirectVideo <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Bubble<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Highest<font color="#000080">,
  </font>Limit<font color="#000080">, </font>I  <font color="#000080">: </font>word<font color="#000080">;
  </font>NotSwaped <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Limit <font color="#000080">:= </font>MAX<font color="#000080">;
  </font>Loops <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>Highest <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
    </font>NotSwaped <font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      </b></font>working<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>A<font color="#000080">[</font>I<font color="#000080">] &gt; </font>A<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>then
      begin
        </b></font>Highest <font color="#000080">:= </font>I<font color="#000080">;
        </font>NotSwaped <font color="#000080">:= </font>False<font color="#000080">;
        </font>Swap<font color="#000080">(</font>A<font color="#000080">[</font>I<font color="#000080">], </font>A<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>I<font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>I <font color="#000080">= </font>Limit<font color="#000080">);
    </font>Limit <font color="#000080">:= </font>Highest<font color="#000080">;
    </font>Inc<font color="#000080">(</font>Loops<font color="#000080">);
  </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>NotSwaped<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Limit <font color="#000080">&lt;= </font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InitArray<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">, </font>J <font color="#000080">: </font>word<font color="#000080">;
  </font>Temp <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>randomize<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAX <font color="#FF0000"><b>do
    </b></font>A<font color="#000080">[</font>I<font color="#000080">] := </font>I<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font>MAX <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    </b></font>J <font color="#000080">:= </font>random<font color="#000080">(</font>I<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
    </font>Swap<font color="#000080">(</font>A<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">], </font>A<font color="#000080">[</font>J<font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Pause<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Press any key to continue...'</font><font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do
    </b></font>readkey<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font>keypressed <font color="#FF0000"><b>do</b></font><font color="#000080">;
  </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>PrintOut<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>MAX <font color="#FF0000"><b>do
  begin
    if </b></font>WhereY <font color="#000080">&gt;= </font><font color="#800000">22 </font><font color="#FF0000"><b>then
    begin
      </b></font>Pause<font color="#000080">;
      </font>ClrScr<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>WhereX <font color="#000080">&gt;= </font><font color="#800000">70</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Writeln<font color="#000080">(</font>A<font color="#000080">[</font>I<font color="#000080">] : </font><font color="#800000">5</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>Write<font color="#000080">(</font>A<font color="#000080">[</font>I<font color="#000080">] : </font><font color="#800000">5</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>Pause<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ClrScr<font color="#000080">;
  </font>InitArray<font color="#000080">;
  </font>PrintOut<font color="#000080">;
  </font>Bubble<font color="#000080">;
  </font>PrintOut<font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Took '</font><font color="#000080">, </font>Loops<font color="#000080">, </font><font color="#800000">' Loops to complete'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0011.PAS">Original</a><b>]</b></p></body>
</html>
