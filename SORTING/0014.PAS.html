<html>
<head><title> "Pointer Sort" by REYNIR STEFANSSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
REYNIR STEFANSSON

Some time ago I wangled myself into a beta testing team For a floppy
disk catalogger called FlopiCat. This is a rather BASIC (in more than one
way) Program, but works well enough.

The built-in sorting routine was a bit quacked, so I wrote my own
external sorter, which is both more versatile and faster (by far) than the
internal one.

     Here it is, in Case someone can use the idea (and code):
}

</i></font><font color="#FF0000"><b>Program </b></font>FlopiSrt<font color="#000080">; </font><font color="#008000"><i>{ Sorts FlopiCat.Dat. }

</i></font><font color="#FF0000"><b>Const
  </b></font>Maximum <font color="#000080">= </font><font color="#800000">6000</font><font color="#000080">; </font><font color="#008000"><i>{ I don't need that many meself... }
  </i></font>FName   <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">] = </font><font color="#800000">'Flopicat.Dat'</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>fEntry <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>n <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>i <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">35</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>d <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">39</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>En1 <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">78</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>En2 <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>n <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>f <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>e <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>z <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>t <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
    </font>d <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">39</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>En3 <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>f<font color="#000080">, </font>d <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">39</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>pEntry <font color="#000080">= ^</font>fEntry<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>Entry        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Maximum<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pEntry<font color="#000080">;
  </font>fc           <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>fEntry<font color="#000080">;
  </font>Rev          <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>LoMem        <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>i<font color="#000080">,
  </font>NumOfEntries <font color="#000080">: </font>Integer<font color="#000080">;
  </font>nfd          <font color="#000080">: </font>Char<font color="#000080">;
  </font>s            <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ToSwap<font color="#000080">(</font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Swop <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Swop <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>Case </b></font>nfd <font color="#FF0000"><b>OF
    </b></font><font color="#008000"><i>{ Sorting by disk number: }
    </i></font><font color="#800000">'N' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>Entry<font color="#000080">[</font>i<font color="#000080">]^.</font>n <font color="#000080">&gt; </font>Entry<font color="#000080">[</font>j<font color="#000080">]^.</font>n <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by File information: }
    </i></font><font color="#800000">'I' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>Entry<font color="#000080">[</font>i<font color="#000080">]^.</font>i <font color="#000080">&gt; </font>Entry<font color="#000080">[</font>j<font color="#000080">]^.</font>i <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by description: }
    </i></font><font color="#800000">'D' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>Entry<font color="#000080">[</font>i<font color="#000080">]^.</font>d <font color="#000080">&gt; </font>Entry<font color="#000080">[</font>j<font color="#000080">]^.</font>d <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by all the String: }
    </i></font><font color="#800000">'A' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En1<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^) &gt; </font>En1<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^) </font><font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by File name only: }
    </i></font><font color="#800000">'F' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^).</font>f <font color="#000080">&gt; </font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^).</font>f <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by File extension only: }
    </i></font><font color="#800000">'E' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^).</font>e <font color="#000080">&gt; </font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^).</font>e <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by File size: }
    </i></font><font color="#800000">'Z' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^).</font>z <font color="#000080">&gt; </font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^).</font>z <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by date/time stamp: }
    </i></font><font color="#800000">'T' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^).</font>t <font color="#000080">&gt; </font>En2<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^).</font>t <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#008000"><i>{ Sorting by disk number/File info block: }
    </i></font><font color="#800000">'B' </font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>En3<font color="#000080">(</font>Entry<font color="#000080">[</font>i<font color="#000080">]^).</font>f <font color="#000080">&gt; </font>En3<font color="#000080">(</font>Entry<font color="#000080">[</font>j<font color="#000080">]^).</font>f <font color="#FF0000"><b>then
            </b></font>Swop <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>ToSwap <font color="#000080">:= </font>Swop <font color="#FF0000"><b>xor </b></font>Rev<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ if I remember correctly, I settled on using shaker/shuttle sort. }
</i></font><font color="#FF0000"><b>Procedure </b></font>SortIt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">,
  </font>pb<font color="#000080">, </font>pf<font color="#000080">,
  </font>pp<font color="#000080">, </font>pt <font color="#000080">: </font>Integer<font color="#000080">;
  </font>t      <font color="#000080">: </font>pEntry<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>SwapIt<font color="#000080">(</font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>t <font color="#000080">:= </font>Entry<font color="#000080">[</font>i<font color="#000080">];
    </font>Entry<font color="#000080">[</font>i<font color="#000080">] := </font>Entry<font color="#000080">[</font>j<font color="#000080">];
    </font>Entry<font color="#000080">[</font>j<font color="#000080">] := </font>t<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Write<font color="#000080">(</font><font color="#800000">'0    entries processed.'</font><font color="#000080">);
  </font>i  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>pt <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>pb <font color="#000080">:= </font>NumOfEntries<font color="#000080">;
  </font>pf <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    </b></font>pp <font color="#000080">:= </font>pt<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      if </b></font>ToSwap<font color="#000080">(</font>pp <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>pp<font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>SwapIt<font color="#000080">(</font>pp <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>pp<font color="#000080">);
        </font>pf <font color="#000080">:= </font>pp<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>pp<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>pp <font color="#000080">&gt; </font>pb<font color="#000080">;

    </font>pb <font color="#000080">:= </font>pf <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
    </font>j  <font color="#000080">:= </font>i<font color="#000080">;
    </font>i  <font color="#000080">:= </font>NumOfEntries <font color="#000080">- (</font>pb <font color="#000080">- </font>pt <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">) &lt; (</font>j <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Write<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">, </font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>pb <font color="#000080">&lt; </font>pt <font color="#FF0000"><b>then
      </b></font>Exit<font color="#000080">;
    </font>pp <font color="#000080">:= </font>pb<font color="#000080">;

    </font><font color="#FF0000"><b>Repeat
      if </b></font>ToSwap<font color="#000080">(</font>pp <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>pp<font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>SwapIt<font color="#000080">(</font>pp <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>pp<font color="#000080">);
        </font>pf <font color="#000080">:= </font>pp<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Dec<font color="#000080">(</font>pp<font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>pp <font color="#000080">&lt; </font>pt<font color="#000080">;

    </font>pt <font color="#000080">:= </font>pf <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>j  <font color="#000080">:= </font>i<font color="#000080">;
    </font>i  <font color="#000080">:= </font>NumOfEntries <font color="#000080">- (</font>pb <font color="#000080">- </font>pt <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>i <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">) &lt; (</font>j <font color="#FF0000"><b>MOD </b></font><font color="#800000">10</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Write<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">, </font>i<font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>pb <font color="#000080">&lt; </font>pt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0014.PAS">Original</a><b>]</b></p></body>
</html>
