<html>
<head><title> "ANAGRAM2.PAS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ ANAGRAM. --------------------------------------------------------------------
  Rapha‰l Vanney, 01/93

  Purpose : Reads a list of Words 4 to 10 Characters long from a File
            named 'LIST.#1', outputs a list of anagrams founds in a
            specified format to a File named 'ANAGRAM.RES'.

  Note    : I commented-out the source using a langage, say English, which
            I'm not Really fluent in ; please forgive mistakes.
------------------------------------------------------------------------------}

{$m 8192,65536,655360}
{$a+,d+,e-,f-,g+,i+,l+,n-,o-,q-,r-,s-,v+}

{$b-}     { Turns off complete Boolean evaluation ; this allows easiest
            combined Boolean tests. }

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">,
     </font>Objects <font color="#000080">;

</font><font color="#FF0000"><b>Const
     </b></font>MaxWordLen     <font color="#000080">= </font><font color="#800000">10 </font><font color="#000080">;              </font><font color="#008000"><i>{ Offically specified by GP !      }
     </i></font>CntAnagrams    <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">;        </font><font color="#008000"><i>{ Actually, this counter shows the }
                                        { number of Words found in the     }
                                        { output File.                     }
     </i></font>OutFileName    <font color="#000080">= </font><font color="#800000">'ANAGRAM.RES' </font><font color="#000080">;


</font><font color="#FF0000"><b>Type </b></font>TWordString    <font color="#000080">= </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font>MaxWordLen<font color="#000080">] ;

     </font><font color="#008000"><i>{ TWordCollection.
       This Object will be used to store the Words in a sorted fashion. As
       long as the input list is already sorted, it could have inherited
       from TCollection, put there is no big penalty using a sorted one.   }

     </i></font>TWordCollection <font color="#000080">=
     </font><font color="#FF0000"><b>Object </b></font><font color="#000080">(</font>TSortedCollection<font color="#000080">)
          </font><font color="#FF0000"><b>Function  </b></font>KeyOf<font color="#000080">(</font>Item <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Pointer <font color="#000080">; </font><font color="#FF0000"><b>Virtual </b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Function  </b></font>Compare<font color="#000080">(</font>Key1<font color="#000080">, </font>Key2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer <font color="#000080">; </font><font color="#FF0000"><b>Virtual </b></font><font color="#000080">;
          </font><font color="#FF0000"><b>Procedure </b></font>FreeItem<font color="#000080">(</font>Item <font color="#000080">: </font>Pointer<font color="#000080">) ; </font><font color="#FF0000"><b>Virtual </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font>PWordCollection <font color="#000080">= ^</font>TWordCollection <font color="#000080">;

     </font><font color="#008000"><i>{ TWord.
       This is the Object we'll use to store a Word. Each Word knows :
       - it's 'Textual form'  : It
       - the first of it's anagrams, if it has been found to be the
         anagram of another Word,
       - the next of it's anagrams, in the same condition.                 }

     </i></font>PWord     <font color="#000080">= ^</font>TWord <font color="#000080">;
     </font>TWord     <font color="#000080">=
     </font><font color="#FF0000"><b>Object
          </b></font>It             <font color="#000080">: </font>TWordString <font color="#000080">;
          </font>FirstAng       <font color="#000080">: </font>PWord <font color="#000080">;
          </font>NextAng        <font color="#000080">: </font>PWord <font color="#000080">;

          </font><font color="#FF0000"><b>Constructor    </b></font>Init<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Wrd  <font color="#000080">: </font>TWordString<font color="#000080">) ;
          </font><font color="#FF0000"><b>Destructor     </b></font>Done <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var  </b></font>WordsList <font color="#000080">: </font>PWordCollection <font color="#000080">;      </font><font color="#008000"><i>{ The main list of Words           }
     </i></font>OrgMem    <font color="#000080">: </font>LongInt <font color="#000080">;              </font><font color="#008000"><i>{ Original MemAvail                }
     </i></font>UsedMem   <font color="#000080">: </font>LongInt <font color="#000080">;              </font><font color="#008000"><i>{ Amount of RAM used               }

{-------------------------------------- TWord --------------------------------}

</i></font><font color="#FF0000"><b>Constructor </b></font>TWord<font color="#000080">.</font>Init <font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>It<font color="#000080">:=</font>Wrd <font color="#000080">;
     </font>FirstAng<font color="#000080">:=</font><font color="#FF0000"><b>Nil </b></font><font color="#000080">;
     </font>NextAng<font color="#000080">:=</font><font color="#FF0000"><b>Nil </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>TWord<font color="#000080">.</font>Done <font color="#000080">;
</font><font color="#FF0000"><b>begin
end </b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------- TWordCollection ----------------------}
{ The following methods are not commented out, since they already are in
  Turbo-Pascal's documentations, and they do nothing unusual.              }

</i></font><font color="#FF0000"><b>Function </b></font>TWordCollection<font color="#000080">.</font>KeyOf <font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>KeyOf<font color="#000080">:=</font>Addr<font color="#000080">(</font>PWord<font color="#000080">(</font>Item<font color="#000080">)^.</font>It<font color="#000080">) ;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TWordCollection<font color="#000080">.</font>Compare <font color="#000080">;
</font><font color="#FF0000"><b>Var  </b></font>k1   <font color="#000080">: </font>PString <font color="#FF0000"><b>Absolute </b></font>Key1 <font color="#000080">;
     </font>k2   <font color="#000080">: </font>PString <font color="#FF0000"><b>Absolute </b></font>Key2 <font color="#000080">;
</font><font color="#FF0000"><b>begin
     If </b></font>k1<font color="#000080">^&gt;</font>k2<font color="#000080">^
     </font><font color="#FF0000"><b>Then </b></font>Compare<font color="#000080">:=</font><font color="#800000">1
     </font><font color="#FF0000"><b>Else If </b></font>k1<font color="#000080">^&lt;</font>k2<font color="#000080">^
          </font><font color="#FF0000"><b>Then </b></font>Compare<font color="#000080">:=-</font><font color="#800000">1
          </font><font color="#FF0000"><b>Else </b></font>Compare<font color="#000080">:=</font><font color="#800000">0 </font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TWordCollection<font color="#000080">.</font>FreeItem <font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Dispose<font color="#000080">(</font>PWord<font color="#000080">(</font>Item<font color="#000080">), </font>Done<font color="#000080">) ;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#008000"><i>{-------------------------------------- Utilities ----------------------------}

</i></font><font color="#FF0000"><b>Procedure </b></font>CleanUp<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Wrd <font color="#000080">: </font>TWordString<font color="#000080">) ;
</font><font color="#008000"><i>{ Cleans-up a Word, in Case there would be dirty Characters in the input File }
</i></font><font color="#FF0000"><b>Var  </b></font>i    <font color="#000080">: </font>Integer <font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{ Removes trailing spaces ; not afraid of empty Strings }
     </i></font><font color="#FF0000"><b>While </b></font>Wrd<font color="#000080">[</font>Length<font color="#000080">(</font>Wrd<font color="#000080">)]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Do </b></font>Dec<font color="#000080">(</font>Wrd<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) ;
     </font><font color="#008000"><i>{ Removes any suspect Character }
     </i></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#000080">;
     </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>Wrd<font color="#000080">)) </font><font color="#FF0000"><b>Do
     begin
          If </b></font>Wrd<font color="#000080">[</font>i<font color="#000080">]&lt;</font><font color="#800000">#33 </font><font color="#FF0000"><b>Then </b></font>Delete<font color="#000080">(</font>Wrd<font color="#000080">, </font>i<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">)
                        </font><font color="#FF0000"><b>Else </b></font>Inc<font color="#000080">(</font>i<font color="#000080">) ;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PadStr<font color="#000080">(</font>St <font color="#000080">: </font>TWordString <font color="#000080">; </font>Len <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String </b></font><font color="#000080">;
</font><font color="#008000"><i>{ Returns a String padded With spaces, of the specified length }
</i></font><font color="#FF0000"><b>Var  </b></font>i    <font color="#000080">: </font>Integer <font color="#000080">;
     </font>Tmp  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Tmp<font color="#000080">:=</font>St <font color="#000080">;
     </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font>Length<font color="#000080">(</font>Tmp<font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Len <font color="#FF0000"><b>Do </b></font>Tmp<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">' ' </font><font color="#000080">;
     </font>Tmp<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>Len<font color="#000080">) ;
     </font>PadStr<font color="#000080">:=</font>Tmp <font color="#000080">;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#008000"><i>{-----------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Function </b></font>AreAnagrams<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>WordA<font color="#000080">, </font>WordB <font color="#000080">: </font>TWordString<font color="#000080">) : </font>Boolean <font color="#000080">;
</font><font color="#008000"><i>{ Tells whether two Words are anagrams of each other ; assumes the Words
  are 'clean' (No Up/Low Case checking, no dirty Characters...)

  Optimizing hint : Passing parameters by address _greatly_ enhances overall
  speed ; anyway, we'll use a local copy of one of the two, since the used
  algorithms needs to modify one of the two Words.                         }

</i></font><font color="#FF0000"><b>Assembler </b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var  </b></font>WordC     <font color="#000080">: </font>TWordString <font color="#000080">;          </font><font color="#008000"><i>{ Local copy of WordB              }
</i></font><font color="#FF0000"><b>Asm
     </b></font><font color="#FF00FF">Push DS                            </font><font color="#008000"><i>{ Let's save the Data segment...   }
     </i></font><font color="#FF00FF">LDS  SI, WordA                     </font><font color="#008000"><i>{ Load WordA's address in ES:DI    }
     </i></font><font color="#FF00FF">Mov  AL, [SI]                      </font><font color="#008000"><i>{ Load length Byte into AL         }
     </i></font><font color="#FF00FF">LDS  SI, WordB                     </font><font color="#008000"><i>{ Load WordB's address             }
     </i></font><font color="#FF00FF">Cmp  AL, [SI]                      </font><font color="#008000"><i>{ Compare lengthes                 }
     </i></font><font color="#FF00FF">JNE  @NotAng                       </font><font color="#008000"><i>{ &lt;&gt;lengthes, not anagrams         }

     </i></font><font color="#FF00FF">LDS  SI, WordB

     </font><font color="#008000"><i>{ Let's make a local copy of WordB ; enhanced version of TP's &quot;Move&quot;  }
     </i></font><font color="#FF00FF">ClD                                </font><font color="#008000"><i>{ Clear direction flag             }
     </i></font><font color="#FF00FF">Push SS
     Pop  ES                            </font><font color="#008000"><i>{ Segment part of WordC's address  }
     </i></font><font color="#FF00FF">LEA  DI, WordC                     </font><font color="#008000"><i>{ Offset part of it                }
     </i></font><font color="#FF00FF">Mov  CL, DS:[SI]                   </font><font color="#008000"><i>{ Get length Byte                  }
     </i></font><font color="#FF00FF">XOr  CH, CH                        </font><font color="#008000"><i>{ Make it a Word                   }
     </i></font><font color="#FF00FF">Mov  DL, CL                        </font><font color="#008000"><i>{ Save length For later use        }
     </i></font><font color="#FF00FF">Inc  CX                            </font><font color="#008000"><i>{ # of Bytes to store the String   }
     </i></font><font color="#FF00FF">ShR  CX, 1                         </font><font color="#008000"><i>{ We'll copy Words ; CF is importt }
     </i></font><font color="#FF00FF">Rep  MovSW                         </font><font color="#008000"><i>{ Copy WordB to WordC              }
     </i></font><font color="#FF00FF">JNC  @NoByte
     MovSB                              </font><font color="#008000"><i>{ Copy last Byte                   }
</i></font><font color="#FF00FF">@NoByte:
     LDS  SI, WordA                     </font><font color="#008000"><i>{ DS:SI contains WordA's address   }
     </i></font><font color="#FF00FF">Inc  SI                            </font><font color="#008000"><i>{ SI points to first Char of WordA }
     </i></font><font color="#FF00FF">Mov  DH, DL                        </font><font color="#008000"><i>{ Use DH as a loop counter         }
     </i></font><font color="#FF00FF">LEA  BX, WordC                     </font><font color="#008000"><i>{ Load offset of WordC in BX       }
     </i></font><font color="#FF00FF">Inc  BX                            </font><font color="#008000"><i>{ Skip length Byte                 }
     { For each letter in WordA, search it in WordB ; if found, mark it as
       'used' in WordB, then proceed With next.
       If a letter is not found, Words are not anagrams ; if all are
       found, Words are anagrams.                                          }
{ Registers usage :
     AL        : scratch For SCAS
     AH        : unused
     BX        : offset part of WordC's address
     CX        : will be used as a counter For SCAS
     DL        : contains length of Strings ; 'll be used to reset CX
     DH        : loop counter ; initially =DL
     ES        : segment part of WordC's address
     DI        : scratch For SCAS
     DS:SI     : Pointer to next Char to process in WordA
}
</i></font><font color="#FF00FF">@Bcle:
     LodSB                              </font><font color="#008000"><i>{ Load next Char of WordA in AL    }
     </i></font><font color="#FF00FF">Mov  CL, DL                        </font><font color="#008000"><i>{ Load length of String in CX      }
     </i></font><font color="#FF00FF">Mov  DI, BX                        </font><font color="#008000"><i>{ Copy offset of WordC to DI       }
     </i></font><font color="#FF00FF">RepNE ScaSB                        </font><font color="#008000"><i>{ Scan WordC For AL 'till found    }
     </i></font><font color="#FF00FF">JNE  @NotAng                       </font><font color="#008000"><i>{ Char not found, not anagrams     }
     </i></font><font color="#FF00FF">Dec  DI                            </font><font color="#008000"><i>{ Back-up to matching Char         }
     </i></font><font color="#FF00FF">Mov  Byte Ptr ES:[DI], '*'         </font><font color="#008000"><i>{ Mark the Character as 'used'     }
     </i></font><font color="#FF00FF">Dec  DH                            </font><font color="#008000"><i>{ Dec loop counter                 }
     </i></font><font color="#FF00FF">Or   DH, DH                        </font><font color="#008000"><i>{ Done all Chars ?                 }
     </i></font><font color="#FF00FF">JNZ  @Bcle                         </font><font color="#008000"><i>{ No, loop                         }

     { All Chars done, the Words are anagrams                              }
     </i></font><font color="#FF00FF">Mov  AL, 1                         </font><font color="#008000"><i>{ Result=True                      }
     </i></font><font color="#FF00FF">Or   AL, AL                        </font><font color="#008000"><i>{ Set accordingly the ZF           }
     </i></font><font color="#FF00FF">Jmp  @Done
@NotAng:
     XOr  AL, AL                        </font><font color="#008000"><i>{ Result=False                     }
</i></font><font color="#FF00FF">@Done:
     Pop  DS                            </font><font color="#008000"><i>{ Restore DS                       }
</i></font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ReadWordsFrom<font color="#000080">(</font>FName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean <font color="#000080">;
</font><font color="#FF0000"><b>Var  </b></font>InF  <font color="#000080">: </font>Text <font color="#000080">;                      </font><font color="#008000"><i>{ Input File                       }
     </i></font>Buf  <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte <font color="#000080">;    </font><font color="#008000"><i>{ Speed-up Text buffer             }
     </i></font>Lig  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">;                    </font><font color="#008000"><i>{ Read line                        }
     </i></font>Wrd  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">;                    </font><font color="#008000"><i>{ Word gotten from parsed Lig      }
     </i></font>WSt  <font color="#000080">: </font>TWordString <font color="#000080">;               </font><font color="#008000"><i>{ Checked version of Wrd           }
     </i></font>p    <font color="#000080">: </font>Integer <font color="#000080">;                   </font><font color="#008000"><i>{ Work                             }
     </i></font>Cnt  <font color="#000080">: </font>LongInt <font color="#000080">;                   </font><font color="#008000"><i>{ Line counter                     }
</i></font><font color="#FF0000"><b>begin
     </b></font>ReadWordsFrom<font color="#000080">:=</font>False <font color="#000080">;             </font><font color="#008000"><i>{ 'till now, at least !            }
     </i></font>WordsList<font color="#000080">:=</font>New<font color="#000080">(</font>PWordCollection<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">, </font><font color="#800000">20</font><font color="#000080">)) ;
     </font>Assign<font color="#000080">(</font>InF<font color="#000080">, </font>FName<font color="#000080">) ;
     </font><font color="#008000"><i>{$i-}
     </i></font>ReSet<font color="#000080">(</font>InF<font color="#000080">) ;
     </font><font color="#008000"><i>{$i+}
     </i></font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Exit <font color="#000080">;
     </font>SetTextBuf<font color="#000080">(</font>InF<font color="#000080">, </font>Buf<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Buf<font color="#000080">)) ;
     </font>Cnt<font color="#000080">:=</font><font color="#800000">0 </font><font color="#000080">;

     </font><font color="#FF0000"><b>While Not </b></font>EOF<font color="#000080">(</font>InF<font color="#000080">) </font><font color="#FF0000"><b>Do
     begin
          </b></font>Inc<font color="#000080">(</font>Cnt<font color="#000080">) ;
          </font>ReadLn<font color="#000080">(</font>InF<font color="#000080">, </font>Lig<font color="#000080">) ;
          </font><font color="#FF0000"><b>While </b></font>Lig<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>Do
          begin
               </b></font><font color="#008000"><i>{ Let's parse the read line into Words }
               </i></font>p<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>Lig<font color="#000080">) ;
               </font><font color="#FF0000"><b>If </b></font>p<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>p<font color="#000080">:=</font>Length<font color="#000080">(</font>Lig<font color="#000080">)+</font><font color="#800000">1 </font><font color="#000080">;
               </font>Wrd<font color="#000080">:=</font>Copy<font color="#000080">(</font>Lig<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>p<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) ;
               </font><font color="#008000"><i>{ Check of overflowing Word length }
               </i></font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>Wrd<font color="#000080">)&gt;</font>MaxWordLen <font color="#FF0000"><b>Then
                    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Word length &gt; '</font><font color="#000080">, </font>MaxWordLen<font color="#000080">, </font><font color="#800000">' : '</font><font color="#000080">, </font>Wrd<font color="#000080">) ;
               </font>WSt<font color="#000080">:=</font>Wrd <font color="#000080">;
               </font>CleanUp<font color="#000080">(</font>WSt<font color="#000080">) ;
               </font><font color="#FF0000"><b>If </b></font>WSt<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>WordsList<font color="#000080">^.</font>Insert<font color="#000080">(</font>New<font color="#000080">(</font>PWord<font color="#000080">, </font>Init<font color="#000080">(</font>WSt<font color="#000080">))) ;
               </font>Delete<font color="#000080">(</font>Lig<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>p<font color="#000080">) ;
          </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#008000"><i>{$i-}
     </i></font>Close<font color="#000080">(</font>InF<font color="#000080">) ;
     </font><font color="#008000"><i>{$i+}
     </i></font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font><font color="#000080">;
     </font>ReadWordsFrom<font color="#000080">:=</font>True <font color="#000080">;

     </font>WriteLn<font color="#000080">(</font>Cnt<font color="#000080">, </font><font color="#800000">' lines, '</font><font color="#000080">, </font>WordsList<font color="#000080">^.</font>Count<font color="#000080">, </font><font color="#800000">' Words found.'</font><font color="#000080">) ;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CheckAnagrams<font color="#000080">(</font>i <font color="#000080">: </font>Integer<font color="#000080">) ;
</font><font color="#008000"><i>{ This Procedure builds, if necessary (i.e. not already done), the anagrams
  list For Word #i of the list. }
</i></font><font color="#FF0000"><b>Var  </b></font>Org  <font color="#000080">: </font>PWord <font color="#000080">;                     </font><font color="#008000"><i>{ Original Word (1st of list)      }
     </i></font>j    <font color="#000080">: </font>Integer <font color="#000080">;                   </font><font color="#008000"><i>{ Work                             }
     </i></font>Last <font color="#000080">: </font>PWord <font color="#000080">;                     </font><font color="#008000"><i>{ Last anagram found               }
</i></font><font color="#FF0000"><b>begin
     </b></font>Org<font color="#000080">:=</font>WordsList<font color="#000080">^.</font>Items<font color="#000080">^[</font>i<font color="#000080">] ;
     </font><font color="#FF0000"><b>If </b></font>Org<font color="#000080">^.</font>FirstAng<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>Nil Then
     begin
          </b></font><font color="#008000"><i>{ This Word is already known to be the anagram of at least another
            one ; don't re-do the job. }
          { _or_ this Word is known to have no anagrams in the list }
          </i></font>Exit <font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

     </font><font color="#008000"><i>{ Search anagrams }
     </i></font>Last<font color="#000080">:=</font>Org <font color="#000080">;
     </font>Org<font color="#000080">^.</font>FirstAng<font color="#000080">:=</font>Org <font color="#000080">;               </font><font color="#008000"><i>{ This Word is the first of it's   }
                                        { own anagrams list ; normal, no ? }
     </i></font><font color="#FF0000"><b>For </b></font>j<font color="#000080">:=</font>Succ<font color="#000080">(</font>i<font color="#000080">) </font><font color="#FF0000"><b>To </b></font>Pred<font color="#000080">(</font>WordsList<font color="#000080">^.</font>Count<font color="#000080">) </font><font color="#FF0000"><b>Do
     </b></font><font color="#008000"><i>{ Don't search the begining of the list, of course ! }
     </i></font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{ Let's skip anagram checking if lengths are &lt;&gt; }
          </i></font><font color="#FF0000"><b>If </b></font>Org<font color="#000080">^.</font>It<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]=</font>PWord<font color="#000080">(</font>WordsList<font color="#000080">^.</font>Items<font color="#000080">^[</font>j<font color="#000080">])^.</font>It<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>Then
          If </b></font>AreAnagrams<font color="#000080">(</font>Org<font color="#000080">^.</font>It<font color="#000080">, </font>PWord<font color="#000080">(</font>WordsList<font color="#000080">^.</font>Items<font color="#000080">^[</font>j<font color="#000080">])^.</font>It<font color="#000080">) </font><font color="#FF0000"><b>Then
          begin
               </b></font><font color="#008000"><i>{ Build chained list of anagrams }
               </i></font>Last<font color="#000080">^.</font>NextAng<font color="#000080">:=</font>WordsList<font color="#000080">^.</font>Items<font color="#000080">^[</font>j<font color="#000080">] ;
               </font>Last<font color="#000080">:=</font>WordsList<font color="#000080">^.</font>Items<font color="#000080">^[</font>j<font color="#000080">] ;
               </font>Last<font color="#000080">^.</font>FirstAng<font color="#000080">:=</font>Org <font color="#000080">;
          </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font>Last<font color="#000080">^.</font>NextAng<font color="#000080">:=</font><font color="#FF0000"><b>Nil </b></font><font color="#000080">;               </font><font color="#008000"><i>{ Unusefull, but keep carefull     }
</i></font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ScanForAnagrams <font color="#000080">;
</font><font color="#008000"><i>{ This Procedure scans the list of Words For anagrams, and do the outputing
  to the 'ANAGRAM.RES' File. }

</i></font><font color="#FF0000"><b>Var  </b></font>i         <font color="#000080">: </font>Integer <font color="#000080">;              </font><font color="#008000"><i>{ Work                             }
     </i></font>Tmp       <font color="#000080">: </font>PWord <font color="#000080">;                </font><font color="#008000"><i>{ Temporary Word                   }
     </i></font><font color="#FF0000"><b>Out       </b></font><font color="#000080">: </font>Text <font color="#000080">;                 </font><font color="#008000"><i>{ Output File                      }
     </i></font>Comma     <font color="#000080">: </font>Boolean <font color="#000080">;              </font><font color="#008000"><i>{ Helps dealing With commas        }
     </i></font>Current   <font color="#000080">: </font>PWord <font color="#000080">;                </font><font color="#008000"><i>{ Currently handled Word           }
</i></font><font color="#FF0000"><b>begin
     </b></font>Assign<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>OutFileName<font color="#000080">) ;
     </font>ReWrite<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">) ;

     </font><font color="#FF0000"><b>With </b></font>WordsList<font color="#000080">^ </font><font color="#FF0000"><b>Do
     For </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font>Pred<font color="#000080">(</font>Count<font color="#000080">) </font><font color="#FF0000"><b>Do
     begin
          </b></font>Current<font color="#000080">:=</font>Items<font color="#000080">^[</font>i<font color="#000080">] ;
          </font>CheckAnagrams<font color="#000080">(</font>i<font color="#000080">) ;
          </font><font color="#008000"><i>{ We're now gonna scan the chained list of known anagrams for
            this Word. }
          </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Current<font color="#000080">^.</font>NextAng<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Current<font color="#000080">^.</font>FirstAng<font color="#000080">&lt;&gt;</font>Current<font color="#000080">) </font><font color="#FF0000"><b>Then
          </b></font><font color="#008000"><i>{ This Word has at least an anagram other than itself }
          </i></font><font color="#FF0000"><b>begin
               </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>PadStr<font color="#000080">(</font>Current<font color="#000080">^.</font>It<font color="#000080">, </font><font color="#800000">12</font><font color="#000080">)) ;
               </font>Inc<font color="#000080">(</font>CntAnagrams<font color="#000080">) ;
               </font>Comma<font color="#000080">:=</font>False <font color="#000080">;
               </font>Tmp<font color="#000080">:=</font>Current<font color="#000080">^.</font>FirstAng <font color="#000080">;
               </font><font color="#FF0000"><b>While </b></font>Tmp<font color="#000080">&lt;&gt;</font><font color="#FF0000"><b>Nil Do
               begin
                    If </b></font>Tmp<font color="#000080">&lt;&gt;</font>Current <font color="#FF0000"><b>Then </b></font><font color="#008000"><i>{ Don't reWrite it... }
                    </i></font><font color="#FF0000"><b>begin
                         If </b></font>Comma <font color="#FF0000"><b>Then </b></font>Write<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font><font color="#800000">', '</font><font color="#000080">) ;
                         </font>Comma<font color="#000080">:=</font>True <font color="#000080">;
                         </font>Write<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">, </font>Tmp<font color="#000080">^.</font>It<font color="#000080">) ;
                         </font>Inc<font color="#000080">(</font>CntAnagrams<font color="#000080">) ;
                    </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
                    </font>Tmp<font color="#000080">:=</font>Tmp<font color="#000080">^.</font>NextAng <font color="#000080">;
               </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
               </font>WriteLn<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">) ;
          </font><font color="#FF0000"><b>end </b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

     </font>Close<font color="#000080">(</font><font color="#FF0000"><b>Out</b></font><font color="#000080">) ;
</font><font color="#FF0000"><b>end </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var  </b></font>Tmp       <font color="#000080">: </font>LongInt <font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ Check command line parameter }

  </i></font><font color="#FF0000"><b>If </b></font>ParamCount<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>Then
  begin
    </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Anagram. Rapha‰l Vanney, 01/93 - Anagram''s contest entry.'</font><font color="#000080">);
    </font>WriteLn <font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Anagram &lt;input_File&gt;'</font><font color="#000080">) ;
    </font>WriteLn <font color="#000080">;
    </font>WriteLn<font color="#000080">(</font><font color="#800000">'Please specify input File name.'</font><font color="#000080">) ;
    </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ;
  </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

  </font>OrgMem<font color="#000080">:=</font>MemAvail <font color="#000080">;

  </font><font color="#008000"><i>{ Read Words list from input File }

  </i></font><font color="#FF0000"><b>If Not </b></font>ReadWordsFrom<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Then
  begin
       </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Error reading Words from input File.'</font><font color="#000080">) ;
       </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">) ;
  </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

  </font><font color="#008000"><i>{ Display statistics stuff }

  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'Reading and sorting done.'</font><font color="#000080">) ;
  </font>UsedMem<font color="#000080">:=</font>OrgMem<font color="#000080">-</font>MemAvail <font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Used RAM                       : '</font><font color="#000080">, </font>UsedMem<font color="#000080">, </font><font color="#800000">' Bytes'</font><font color="#000080">) ;
  </font>Tmp <font color="#000080">:= </font>Trunc<font color="#000080">(</font><font color="#800000">1.0 </font><font color="#000080">* </font>MemAvail <font color="#000080">/ (</font><font color="#800000">1.0 </font><font color="#000080">* </font>UsedMem <font color="#000080">/ </font>WordsList<font color="#000080">^.</font>Count<font color="#000080">)) ;
  </font><font color="#FF0000"><b>If </b></font>Tmp <font color="#000080">&gt; </font><font color="#800000">16383 </font><font color="#FF0000"><b>Then
    </b></font>Tmp <font color="#000080">:= </font><font color="#800000">16383 </font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Potential Words manageable     : '</font><font color="#000080">, </font>Tmp<font color="#000080">) ;

  </font><font color="#008000"><i>{ Scan For anagrams, create output File }

  </i></font>ScanForAnagrams <font color="#000080">;
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Anagrams scanning &amp; output done.'</font><font color="#000080">) ;
  </font>WriteLn<font color="#000080">(</font>CntAnagrams<font color="#000080">, </font><font color="#800000">' Words written to '</font><font color="#000080">, </font>OutFileName<font color="#000080">) ;

  </font><font color="#008000"><i>{ Clean-up }
  </i></font>Dispose<font color="#000080">(</font>WordsList<font color="#000080">, </font>Done<font color="#000080">) ;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{

------------------------------------------------------------------------------

Okay, this is my entry For the 'anagram contest' !

The few things I'd like to point-out about it :

. I chosed to use OOP, in contrast to seeking speed. I wouldn't say my
  Program is Really slow (7.25 secs on my 386-33), but speed was not my
  first concern.
. It fully Uses one of the interresting points of OOP in TP, i.e.
  reusability, through inheritance,
. When a Word (A) has been found to be an anagram of another (B), the
  Program never searches again For the anagrams of (A) ; this
  highly reduces computing time... but I believe anybody does the same.
. I also quite like the assembly langage Function 'AreAnagrams'.

------------------------------------------------------------------------------

The Words list is stored in memory in the following maner :
. A collection (say, a list) of the Words,
. Within this list, anagrams are chained as a list
. Each Word knows the first and the next of its anagrams

------------------------------------------------------------------------------

For the sake of speed, I did something I'm quite ashamed of ; but it
saves 32% of execution time, so...
The usual way to access element #i of a TCollection is to call Function At
with parameter i (i.e. At(i)) ; there is also another way, which is not Really
clean, but which I chosed to use : access it directly through Items^[i].

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
