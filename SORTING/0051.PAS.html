<html>
<head><title> "TV Sorting unit" by BRAD WILLIAMS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{*******************************************************************}
{                                                                   }
{     WVS Software Company                                          }
{     Turbo Pascal Sorting Unit for TCollections                    }
{     Usage Fee: None, public domain                                }
{     Version: 1.0                                                  }
{     Release Date: 6/27/93                                         }
{                                                                   }
{     Programmer: Brad Williams                                     }
{     E-mail    : bwilliams@marvin.ag.uidaho.edu                    }
{     US Mail   : 1008 E. 7th                                       }
{                 Moscow, Idaho 83843                               }
{                                                                   }
{*******************************************************************}
{                                                                   }
{  This unit contains objects for performing various types of       }
{  sorts.  To use any of the sorting methods, simply pass them a    }
{  collection and a compare or test function.  You can write your   }
{  programs to accept a TSortProcedure/TSearchFunction as a         }
{  parameter to any function or procedure and use whichever type    }
{  of sort/search you require at that point in your program.  The   }
{  search and sort methods accept pointers to compare and test      }
{  functions so that the same functions can be used for iterative   }
{  procedures/functions in a TSortedCollection.                     }
{                                                                   }
{*******************************************************************}
</i></font><font color="#FF0000"><b>UNIT </b></font>TVSorts<font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
                                 </i></font><font color="#FF0000"><b>INTERFACE
</b></font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>USES </b></font>Objects<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>TCompareFunction <font color="#000080">= </font><font color="#FF0000"><b>FUNCTION </b></font><font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
    </font><font color="#008000"><i>{ A TCompareFunction must return:   }
    {   1  if the Item1 &gt; Item2         }
    {   0  if the Item1 = Item2         }
    {  -1  if the Item1 &lt; Item2         }

  </i></font>TSortProcedure <font color="#000080">= </font><font color="#FF0000"><b>PROCEDURE  </b></font><font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                               </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);

  </font><font color="#008000"><i>{ Sort Procedures }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>BinaryInsertionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                               </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>BubbleSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>CombSort   <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>HeapSort   <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSort  <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSortNonRecursive <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ShakerSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ShellSort  <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>StraightInsertionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>StraightSelectionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>TreeSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);


  </font><font color="#008000"><i>{ Compare Procedures - Must write your own Compare for pointer variables. }
  { This allows one sort routine to be used on any array.                   }
</i></font><font color="#FF0000"><b>FUNCTION  </b></font>CompareChars    <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>CompareInts     <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>CompareLongInts <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>CompareReals    <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION  </b></font>CompareStrs     <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>FAR</b></font><font color="#000080">;

</font><font color="#008000"><i>{****************************************************************************}
                               </i></font><font color="#FF0000"><b>IMPLEMENTATION
</b></font><font color="#008000"><i>{****************************************************************************}
{                                                                            }
{                      Local Procedures and Functions                        }
{                                                                            }
{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Swap <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>A<font color="#000080">, </font>B <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>Item <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Item <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>A<font color="#000080">);
  </font>ACollection<font color="#000080">^.</font>AtPut<font color="#000080">(</font>A<font color="#000080">,</font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>B<font color="#000080">));
  </font>ACollection<font color="#000080">^.</font>AtPut<font color="#000080">(</font>B<font color="#000080">,</font>Item<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
{                                                                            }
{                      Global Procedures and Functions                       }
{                                                                            }
{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>BinaryInsertionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                               </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j<font color="#000080">, </font>Middle<font color="#000080">, </font>Left<font color="#000080">, </font>Right <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>Left <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>Right <font color="#000080">:= </font>i<font color="#000080">;
        </font><font color="#FF0000"><b>WHILE </b></font>Left <font color="#000080">&lt; </font>Right <font color="#FF0000"><b>DO
          BEGIN
            </b></font>Middle <font color="#000080">:= (</font>Left <font color="#000080">+ </font>Right<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
            </font><font color="#FF0000"><b>WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
              IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>Middle<font color="#000080">),</font>At<font color="#000080">(</font>i<font color="#000080">)) &lt; </font><font color="#800000">1
                 </font><font color="#FF0000"><b>THEN </b></font>Left <font color="#000080">:= </font>Middle <font color="#000080">+ </font><font color="#800000">1
                 </font><font color="#FF0000"><b>ELSE </b></font>Right <font color="#000080">:= </font>Middle<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font>i <font color="#FF0000"><b>DOWNTO </b></font><font color="#000080">(</font>Right <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
            </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>j<font color="#000080">,</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>BubbleSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
        FOR </b></font>j <font color="#000080">:= (</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DOWNTO </b></font>i <font color="#FF0000"><b>DO
        IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">),</font>At<font color="#000080">(</font>j<font color="#000080">)) = </font><font color="#800000">1
           </font><font color="#FF0000"><b>THEN </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>j<font color="#000080">,</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>CombSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
  </font><font color="#008000"><i>{ The combsort is an optimised version of the bubble sort. It uses a }
  { decreasing gap in order to compare values of more than one element }
  { apart.  By decreasing the gap the array is gradually &quot;combed&quot; into }
  { order ... like combing your hair. First you get rid of the large   }
  { tangles, then the smaller ones ...                                 }
  {                                                                    }
  { There are a few particular things about the combsort. Firstly, the }
  { optimal shrink factor is 1.3 (worked out through a process of      }
  { exhaustion by the guys at BYTE magazine). Secondly, by never       }
  { having a gap of 9 or 10, but always using 11, the sort is faster.  }
  {                                                                    }
  { This sort approximates an n log n sort - it's faster than any      }
  { other sort I've seen except the quicksort (and it beats that too   }
  { sometimes ... have you ever seen a quicksort become an (n-1)^2     }
  { sort ... ?). The combsort does not slow down under *any*           }
  { circumstances. In fact, on partially sorted lists (including       }
  { *reverse* sorted lists) it speeds up.                              }
  {                                                                    }
  { More information in the April 1991 BYTE magazine.                  }
</i></font><font color="#FF0000"><b>CONST </b></font>ShrinkFactor <font color="#000080">= </font><font color="#800000">1.3</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>Gap<font color="#000080">, </font>i   <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>Finished <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Gap <font color="#000080">:= </font>Round<font color="#000080">((</font>ACollection<font color="#000080">^.</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)/</font>ShrinkFactor<font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
    REPEAT
      </b></font>Finished <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font>Gap <font color="#000080">:= </font>Trunc<font color="#000080">(</font>Gap<font color="#000080">/</font>ShrinkFactor<font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>Gap <font color="#000080">&lt; </font><font color="#800000">1
         </font><font color="#FF0000"><b>THEN </b></font>Gap <font color="#000080">:= </font><font color="#800000">1
         </font><font color="#FF0000"><b>ELSE IF </b></font><font color="#000080">((</font>Gap <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Gap <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">))
                 </font><font color="#FF0000"><b>THEN </b></font>Gap <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">((</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) - </font>Gap<font color="#000080">) </font><font color="#FF0000"><b>DO
          IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>i<font color="#000080">),</font>At<font color="#000080">(</font>i<font color="#000080">+</font>Gap<font color="#000080">)) = </font><font color="#800000">1
             </font><font color="#FF0000"><b>THEN BEGIN
                    </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>i<font color="#000080">,</font>i<font color="#000080">+</font>gap<font color="#000080">);
                    </font>Finished <font color="#000080">:= </font>False<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">((</font>Gap <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font>Finished<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>HeapSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
  </font><font color="#008000"><i>{ Performs best when items are in inverse order. }
</i></font><font color="#FF0000"><b>VAR </b></font>L<font color="#000080">, </font>R <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>X <font color="#000080">: </font>Pointer<font color="#000080">;
    </font><font color="#008000"><i>{*****************************************}
    </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Sift<font color="#000080">;
    </font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>LongInt<font color="#000080">;
        </font><font color="#FF0000"><b>Label </b></font><font color="#800000">13</font><font color="#000080">;
    </font><font color="#FF0000"><b>BEGIN
      </b></font>i <font color="#000080">:= </font>L<font color="#000080">;
      </font>j <font color="#000080">:= </font><font color="#800000">2 </font><font color="#000080">* </font>i<font color="#000080">;
      </font>X <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>i<font color="#000080">);
      </font><font color="#FF0000"><b>WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
        WHILE </b></font>j <font color="#000080">&lt;= </font>R <font color="#FF0000"><b>DO
          BEGIN
            IF </b></font>j <font color="#000080">&lt; </font>R
               <font color="#FF0000"><b>THEN IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>j<font color="#000080">),</font>At<font color="#000080">(</font>j<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)) = -</font><font color="#800000">1
                       </font><font color="#FF0000"><b>THEN </b></font>Inc<font color="#000080">(</font>j<font color="#000080">);
            </font><font color="#FF0000"><b>IF </b></font>Compare<font color="#000080">(</font>X<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">)) &gt;= </font><font color="#800000">0
               </font><font color="#FF0000"><b>THEN GoTo </b></font><font color="#800000">13</font><font color="#000080">;
            </font>AtPut<font color="#000080">(</font>i<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">));
            </font>i <font color="#000080">:= </font>j<font color="#000080">;
            </font>j <font color="#000080">:= </font><font color="#800000">2 </font><font color="#000080">* </font>i<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#800000">13</font><font color="#000080">: </font>ACollection<font color="#000080">^.</font>AtPut<font color="#000080">(</font>i<font color="#000080">,</font>X<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#008000"><i>{*****************************************}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>L <font color="#000080">:= ((</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
  </font>R <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font>L <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>Dec<font color="#000080">(</font>L<font color="#000080">);
      </font>Sift<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font>R <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>X <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>R<font color="#000080">);
      </font>Dec<font color="#000080">(</font>R<font color="#000080">);
      </font>Sift<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
  </font><font color="#008000"><i>{****************************************************************}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Sort <font color="#000080">(</font>Left<font color="#000080">, </font>Right <font color="#000080">: </font>LongInt<font color="#000080">);
  </font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j  <font color="#000080">: </font>LongInt<font color="#000080">;
      </font>X <font color="#000080">: </font>Pointer<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>i <font color="#000080">:= </font>Left<font color="#000080">;
        </font>j <font color="#000080">:= </font>Right<font color="#000080">;
        </font>X <font color="#000080">:= </font>At<font color="#000080">((</font>Left <font color="#000080">+ </font>Right<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>REPEAT
          WHILE </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>i<font color="#000080">),</font>X<font color="#000080">) = -</font><font color="#800000">1 </font><font color="#FF0000"><b>DO </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
          </font><font color="#FF0000"><b>WHILE </b></font>Compare<font color="#000080">(</font>X<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">)) = -</font><font color="#800000">1 </font><font color="#FF0000"><b>DO </b></font>Dec<font color="#000080">(</font>j<font color="#000080">);
          </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt;= </font>j
             <font color="#FF0000"><b>THEN BEGIN
                    </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>i<font color="#000080">,</font>j<font color="#000080">);
                    </font>Inc<font color="#000080">(</font>i<font color="#000080">);
                    </font>Dec<font color="#000080">(</font>j<font color="#000080">)
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>UNTIL </b></font>i <font color="#000080">&gt; </font>j<font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>Left <font color="#000080">&lt; </font>j
           <font color="#FF0000"><b>THEN </b></font>Sort<font color="#000080">(</font>Left<font color="#000080">,</font>j<font color="#000080">);
        </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt; </font>Right
           <font color="#FF0000"><b>THEN </b></font>Sort<font color="#000080">(</font>i<font color="#000080">,</font>Right<font color="#000080">)
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#008000"><i>{****************************************************************}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Sort<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>ACollection<font color="#000080">^.</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>QuickSortNonRecursive <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>CONST </b></font>m <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j<font color="#000080">, </font>L<font color="#000080">, </font>R <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>x <font color="#000080">: </font>Pointer<font color="#000080">;
    </font>s <font color="#000080">: </font><font color="#800000">0</font><font color="#000080">..</font>m<font color="#000080">;
    </font>Stack <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>m<font color="#000080">] </font><font color="#FF0000"><b>OF RECORD
                             </b></font>l<font color="#000080">, </font>r <font color="#000080">: </font>LongInt<font color="#000080">;
                           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>s <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Stack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>l <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Stack<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">].</font>r <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
    REPEAT
      </b></font>L <font color="#000080">:= </font>Stack<font color="#000080">[</font>s<font color="#000080">].</font>l<font color="#000080">;
      </font>R <font color="#000080">:= </font>Stack<font color="#000080">[</font>s<font color="#000080">].</font>r<font color="#000080">;
      </font>Dec<font color="#000080">(</font>S<font color="#000080">);
      </font><font color="#FF0000"><b>REPEAT
        </b></font>i <font color="#000080">:= </font>L<font color="#000080">;
        </font>j <font color="#000080">:= </font>R<font color="#000080">;
        </font>x <font color="#000080">:= </font>At<font color="#000080">((</font>L <font color="#000080">+ </font>R<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#FF0000"><b>REPEAT
          WHILE </b></font>Compare<font color="#000080">(</font>x<font color="#000080">,</font>At<font color="#000080">(</font>i<font color="#000080">)) =  </font><font color="#800000">1 </font><font color="#FF0000"><b>DO </b></font>Inc<font color="#000080">(</font>i<font color="#000080">);
          </font><font color="#FF0000"><b>WHILE </b></font>Compare<font color="#000080">(</font>x<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">)) = -</font><font color="#800000">1 </font><font color="#FF0000"><b>DO </b></font>Dec<font color="#000080">(</font>j<font color="#000080">);
          </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt;= </font>j
             <font color="#FF0000"><b>THEN BEGIN
                    </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>i<font color="#000080">,</font>j<font color="#000080">);
                    </font>Inc<font color="#000080">(</font>i<font color="#000080">);
                    </font>Dec<font color="#000080">(</font>j<font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>UNTIL </b></font>i <font color="#000080">&gt; </font>j<font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">&lt; </font>R
           <font color="#FF0000"><b>THEN BEGIN
                  </b></font>Inc<font color="#000080">(</font>s<font color="#000080">);
                  </font>Stack<font color="#000080">[</font>s<font color="#000080">].</font>l <font color="#000080">:= </font>i<font color="#000080">;
                  </font>Stack<font color="#000080">[</font>s<font color="#000080">].</font>r <font color="#000080">:= </font>R<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>R <font color="#000080">:= </font>j<font color="#000080">;
      </font><font color="#FF0000"><b>UNTIL </b></font>L <font color="#000080">&gt;= </font>R<font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font>s <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShakerSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
  </font><font color="#008000"><i>{ Works for any array and any index range. }
</i></font><font color="#FF0000"><b>VAR </b></font>j<font color="#000080">, </font>k<font color="#000080">, </font>Left<font color="#000080">, </font>Right <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Left <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Right <font color="#000080">:= (</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font>k <font color="#000080">:= </font>Right<font color="#000080">;
  </font><font color="#FF0000"><b>WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
    REPEAT
      FOR </b></font>j <font color="#000080">:= </font>Right <font color="#FF0000"><b>DOWNTO </b></font>Left <font color="#FF0000"><b>DO
          IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">),</font>At<font color="#000080">(</font>j<font color="#000080">)) = </font><font color="#800000">1
             </font><font color="#FF0000"><b>THEN BEGIN
                    </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>j<font color="#000080">,</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
                    </font>k <font color="#000080">:= </font>j<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Left <font color="#000080">:= </font>k <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font>Left <font color="#FF0000"><b>TO </b></font>Right <font color="#FF0000"><b>DO
          IF </b></font>Compare<font color="#000080">(</font>At<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">),</font>At<font color="#000080">(</font>j<font color="#000080">)) = </font><font color="#800000">1
             </font><font color="#FF0000"><b>THEN BEGIN
                    </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>j<font color="#000080">,</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
                    </font>k <font color="#000080">:= </font>j<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Right <font color="#000080">:= </font>k <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>UNTIL </b></font>Left <font color="#000080">&gt; </font>Right<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShellSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>Gap<font color="#000080">, </font>i<font color="#000080">, </font>j<font color="#000080">, </font>k <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Gap <font color="#000080">:= (</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>Gap <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      FOR </b></font>i <font color="#000080">:= </font>Gap <font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
          BEGIN
            </b></font>j <font color="#000080">:= </font>i <font color="#000080">- </font>Gap<font color="#000080">;
            </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&gt; -</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
              BEGIN
                </b></font>k <font color="#000080">:= </font>j <font color="#000080">+ </font>Gap<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>Compare<font color="#000080">(</font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>j<font color="#000080">),</font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>k<font color="#000080">)) &lt; </font><font color="#800000">1
                   </font><font color="#FF0000"><b>THEN </b></font>j <font color="#000080">:= </font><font color="#800000">0
                   </font><font color="#FF0000"><b>ELSE </b></font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">);
                </font>Dec<font color="#000080">(</font>j<font color="#000080">,</font>Gap<font color="#000080">);
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font>Gap <font color="#000080">:= </font>Gap <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>StraightInsertionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j <font color="#000080">: </font>LongInt<font color="#000080">;
    </font>X <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  WITH </b></font>ACollection<font color="#000080">^ </font><font color="#FF0000"><b>DO
    FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>X <font color="#000080">:= </font>At<font color="#000080">(</font>i<font color="#000080">);
        </font>j <font color="#000080">:= </font>i<font color="#000080">;
        </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>j <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Compare<font color="#000080">(</font>X<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)) = -</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
          BEGIN
            </b></font>AtPut<font color="#000080">(</font>j<font color="#000080">,</font>At<font color="#000080">(</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">));
            </font>Dec<font color="#000080">(</font>j<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>AtPut<font color="#000080">(</font>j<font color="#000080">,</font>X<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>StraightSelectionSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">;
                                 </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#FF0000"><b>VAR </b></font>i<font color="#000080">, </font>j<font color="#000080">, </font>k  <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
        </b></font>k <font color="#000080">:= </font>i<font color="#000080">;
        </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= (</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
            IF </b></font>Compare<font color="#000080">(</font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>j<font color="#000080">),</font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>k<font color="#000080">)) = -</font><font color="#800000">1
               </font><font color="#FF0000"><b>THEN </b></font>k <font color="#000080">:= </font>j<font color="#000080">;
        </font>Swap<font color="#000080">(</font>ACollection<font color="#000080">,</font>i<font color="#000080">,</font>k<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>TreeSort <font color="#000080">(</font>ACollection <font color="#000080">: </font>PCollection<font color="#000080">; </font>Compare <font color="#000080">: </font>TCompareFunction<font color="#000080">);
</font><font color="#008000"><i>{after D.Cooke, A.H.Craven, G.M.Clarke: Statistical Computing
 in Pascal, Publisher: Edward Arnold, London 1985 ISBN 0-7131-3545-X }
</i></font><font color="#FF0000"><b>TYPE </b></font>PNode    <font color="#000080">= ^</font>Node<font color="#000080">;
     </font>Node <font color="#000080">= </font><font color="#FF0000"><b>RECORD
              </b></font>Value <font color="#000080">: </font>Pointer<font color="#000080">;
              </font>Left  <font color="#000080">: </font>PNode<font color="#000080">;
              </font>Right <font color="#000080">: </font>PNode<font color="#000080">;
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR  </b></font>Add<font color="#000080">, </font>Top <font color="#000080">: </font>PNode<font color="#000080">;
     </font>i    <font color="#000080">: </font>LongInt<font color="#000080">;
    </font><font color="#008000"><i>{***********************************************************}
    </i></font><font color="#FF0000"><b>PROCEDURE </b></font>MakeTree <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Node <font color="#000080">: </font>PNode<font color="#000080">);
    </font><font color="#FF0000"><b>BEGIN
      IF </b></font>Node <font color="#000080">= </font><font color="#FF0000"><b>NIL
         THEN </b></font>Node <font color="#000080">:= </font>Add
         <font color="#FF0000"><b>ELSE IF </b></font>Compare<font color="#000080">(</font>Add<font color="#000080">^.</font>Value<font color="#000080">,</font>Node<font color="#000080">^.</font>Value<font color="#000080">) = </font><font color="#800000">1
                 </font><font color="#FF0000"><b>THEN </b></font>MakeTree<font color="#000080">(</font>Node<font color="#000080">^.</font>Right<font color="#000080">)
                 </font><font color="#FF0000"><b>ELSE </b></font>MakeTree<font color="#000080">(</font>Node<font color="#000080">^.</font>Left<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#008000"><i>{**********************************************************}
     </i></font><font color="#FF0000"><b>PROCEDURE </b></font>StripTree <font color="#000080">(</font>Node <font color="#000080">: </font>PNode<font color="#000080">);
     </font><font color="#FF0000"><b>BEGIN
       IF </b></font>Node <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>NIL
          THEN BEGIN
                 </b></font>StripTree<font color="#000080">(</font>Node<font color="#000080">^.</font>Left<font color="#000080">);
                 </font>ACollection<font color="#000080">^.</font>AtPut<font color="#000080">(</font>i<font color="#000080">,</font>Node<font color="#000080">^.</font>Value<font color="#000080">);
                 </font>Inc<font color="#000080">(</font>i<font color="#000080">);
                 </font>StripTree<font color="#000080">(</font>Node<font color="#000080">^.</font>Right<font color="#000080">)
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#008000"><i>{**********************************************************}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Top <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>ACollection<font color="#000080">^.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>New<font color="#000080">(</font>Add<font color="#000080">);
      </font>Add<font color="#000080">^.</font>Value <font color="#000080">:= </font>ACollection<font color="#000080">^.</font>At<font color="#000080">(</font>i<font color="#000080">);
      </font>Add<font color="#000080">^.</font>Left  <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
      </font>Add<font color="#000080">^.</font>Right <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
      </font>MakeTree<font color="#000080">(</font>Top<font color="#000080">)
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>StripTree<font color="#000080">(</font>Top<font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{****************************************************************************}
{                                                                            }
{                            Compare Procedures                              }
{                                                                            }
{****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompareChars <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>Char<font color="#000080">(</font>Item1<font color="#000080">^) &lt; </font>Char<font color="#000080">(</font>Item2<font color="#000080">^)
     </font><font color="#FF0000"><b>THEN </b></font>CompareChars <font color="#000080">:= -</font><font color="#800000">1
     </font><font color="#FF0000"><b>ELSE </b></font>CompareChars <font color="#000080">:= </font>Ord<font color="#000080">(</font>Char<font color="#000080">(</font>Item1<font color="#000080">^) &lt;&gt; </font>Char<font color="#000080">(</font>Item2<font color="#000080">^));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompareInts <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>Integer<font color="#000080">(</font>Item1<font color="#000080">^) &lt; </font>Integer<font color="#000080">(</font>Item2<font color="#000080">^)
     </font><font color="#FF0000"><b>THEN </b></font>CompareInts <font color="#000080">:= -</font><font color="#800000">1
     </font><font color="#FF0000"><b>ELSE </b></font>CompareInts <font color="#000080">:= </font>Ord<font color="#000080">(</font>Integer<font color="#000080">(</font>Item1<font color="#000080">^) &lt;&gt; </font>Integer<font color="#000080">(</font>Item2<font color="#000080">^));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompareLongInts <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>LongInt<font color="#000080">(</font>Item1<font color="#000080">^) &lt; </font>LongInt<font color="#000080">(</font>Item2<font color="#000080">^)
     </font><font color="#FF0000"><b>THEN </b></font>CompareLongInts <font color="#000080">:= -</font><font color="#800000">1
     </font><font color="#FF0000"><b>ELSE </b></font>CompareLongInts <font color="#000080">:= </font>Ord<font color="#000080">(</font>LongInt<font color="#000080">(</font>Item1<font color="#000080">^) &lt;&gt; </font>LongInt<font color="#000080">(</font>Item2<font color="#000080">^));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompareReals <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>Real<font color="#000080">(</font>Item1<font color="#000080">^) &lt; </font>Real<font color="#000080">(</font>Item2<font color="#000080">^)
     </font><font color="#FF0000"><b>THEN </b></font>CompareReals <font color="#000080">:= -</font><font color="#800000">1
     </font><font color="#FF0000"><b>ELSE </b></font>CompareReals <font color="#000080">:= </font>Ord<font color="#000080">(</font>Real<font color="#000080">(</font>Item1<font color="#000080">^) &lt;&gt; </font>Real<font color="#000080">(</font>Item2<font color="#000080">^));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>CompareStrs <font color="#000080">(</font>Item1<font color="#000080">, </font>Item2 <font color="#000080">: </font>Pointer<font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF String</b></font><font color="#000080">(</font>Item1<font color="#000080">^) &lt; </font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Item2<font color="#000080">^)
     </font><font color="#FF0000"><b>THEN </b></font>CompareStrs <font color="#000080">:= -</font><font color="#800000">1
     </font><font color="#FF0000"><b>ELSE </b></font>CompareStrs <font color="#000080">:= </font>Ord<font color="#000080">(</font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Item1<font color="#000080">^) &lt;&gt; </font><font color="#FF0000"><b>String</b></font><font color="#000080">(</font>Item2<font color="#000080">^));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.

</font><font color="#008000"><i>{ -----------------------------------  DEMO PROGRAM ---------------------}

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Test<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>Crt<font color="#000080">, </font>Objects<font color="#000080">, </font>TVSorts<font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>MaxCollectionSize <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>C <font color="#000080">: </font>TCollection<font color="#000080">;
    </font>i<font color="#000080">, </font>j<font color="#000080">, </font>k <font color="#000080">: </font>Integer<font color="#000080">;
    </font>Ch <font color="#000080">: ^</font>Char<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Randomize<font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">11 </font><font color="#FF0000"><b>DO
    BEGIN
        </b></font><font color="#008000"><i>{ initialize collection and load with data in reverse order }
      </i></font>C<font color="#000080">.</font>Init<font color="#000080">(</font>MaxCollectionSize<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font>MaxCollectionSize <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO
          BEGIN
            </b></font>k <font color="#000080">:= </font>Random<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
            </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>k <font color="#000080">&lt; </font><font color="#800000">65</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>k <font color="#000080">&gt; </font><font color="#800000">90</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>k <font color="#000080">:= </font>Random<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
            </font>New<font color="#000080">(</font>Ch<font color="#000080">);
            </font>Ch<font color="#000080">^ := </font>Char<font color="#000080">(</font>k<font color="#000080">);
            </font>C<font color="#000080">.</font>AtInsert<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>Ch<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#008000"><i>{ display unsorted data }
      </i></font>ClrScr<font color="#000080">;
      </font><font color="#FF0000"><b>CASE </b></font>i <font color="#FF0000"><b>OF
        </b></font><font color="#800000">1 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Binary Insertion Sort'</font><font color="#000080">);
        </font><font color="#800000">2 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Bubble Sort'</font><font color="#000080">);
        </font><font color="#800000">3 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Comb Sort'</font><font color="#000080">);
        </font><font color="#800000">4 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Heap Sort'</font><font color="#000080">);
        </font><font color="#800000">5 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Quick Sort'</font><font color="#000080">);
        </font><font color="#800000">6 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Non-recursive Quick Sort'</font><font color="#000080">);
        </font><font color="#800000">7 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Shaker Sort'</font><font color="#000080">);
        </font><font color="#800000">8 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Shell Sort'</font><font color="#000080">);
        </font><font color="#800000">9 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Straight Insertion Sort'</font><font color="#000080">);
       </font><font color="#800000">10 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Straight Selection Sort'</font><font color="#000080">);
       </font><font color="#800000">11 </font><font color="#000080">: </font>WriteLn<font color="#000080">(</font><font color="#800000">'Tree Sort'</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>C<font color="#000080">.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>Char<font color="#000080">(</font>C<font color="#000080">.</font>At<font color="#000080">(</font>j<font color="#000080">)^):</font><font color="#800000">2</font><font color="#000080">);
        </font><font color="#008000"><i>{ sort data }
      </i></font><font color="#FF0000"><b>CASE </b></font>i <font color="#FF0000"><b>OF
        </b></font><font color="#800000">1 </font><font color="#000080">: </font>BinaryInsertionSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">2 </font><font color="#000080">: </font>BubbleSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">3 </font><font color="#000080">: </font>CombSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">4 </font><font color="#000080">: </font>HeapSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">5 </font><font color="#000080">: </font>QuickSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">6 </font><font color="#000080">: </font>QuickSortNonRecursive<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">7 </font><font color="#000080">: </font>ShakerSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">8 </font><font color="#000080">: </font>ShellSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
        </font><font color="#800000">9 </font><font color="#000080">: </font>StraightInsertionSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
       </font><font color="#800000">10 </font><font color="#000080">: </font>StraightSelectionSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
       </font><font color="#800000">11 </font><font color="#000080">: </font>TreeSort<font color="#000080">(@</font>C<font color="#000080">,</font>CompareChars<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#008000"><i>{ display sorted data }
      </i></font>WriteLn<font color="#000080">;
      </font><font color="#FF0000"><b>FOR </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">(</font>C<font color="#000080">.</font>Count <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DO </b></font>Write<font color="#000080">(</font>Char<font color="#000080">(</font>C<font color="#000080">.</font>At<font color="#000080">(</font>j<font color="#000080">)^):</font><font color="#800000">2</font><font color="#000080">);
      </font>ReadLn<font color="#000080">;
        </font><font color="#008000"><i>{ clear of collection }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0051.PAS">Original</a><b>]</b></p></body>
</html>
