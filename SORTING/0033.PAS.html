<html>
<head><title> "Alpha Sorting" by GREGORY P. SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
GREGORY P. SMITH

&gt; Well, that's easier said than done !  So far I've accomplished a
&gt; selection sort which takes about 10-15 minutes For 1000 Records, and I'm
&gt; gonna be needin to sort about 5000 For the Programz intended application
&gt; !!! Also the place that I'm writing this For has an 8088 With 640K RAM
&gt; &lt;chuckle&gt; !!! Could you pleez tell me how to do a merge sort &lt;is that
&gt; easier than quicksort

Here is an example followed by an exlpanation.
}

</i></font><font color="#FF0000"><b>Type
  </b></font>ListPtr <font color="#000080">= ^</font>List<font color="#000080">;
  </font>List <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>next <font color="#000080">: </font>ListPtr<font color="#000080">; </font><font color="#008000"><i>{ next node }
    </i></font>str  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{ data to sort }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Splits List l into two half lists, h1 &amp; h2 }
</i></font><font color="#FF0000"><b>Procedure </b></font>SplitList<font color="#000080">(</font>l <font color="#000080">: </font>ListPtr<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>h1<font color="#000080">, </font>h2 <font color="#000080">:  </font>ListPtr<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>listone <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>tmp <font color="#000080">: </font>ListPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>h1 <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>h2 <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>listone <font color="#000080">:= </font>True<font color="#000080">;            </font><font color="#008000"><i>{ start With first list }
  </i></font><font color="#FF0000"><b>While </b></font>l <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
  begin
    </b></font>tmp <font color="#000080">:= </font>l<font color="#000080">^.</font>next<font color="#000080">;           </font><font color="#008000"><i>{ save next node to split }
    </i></font><font color="#FF0000"><b>if </b></font>listone <font color="#FF0000"><b>then
    begin                     </b></font><font color="#008000"><i>{ insert a node in the first list }
      </i></font>l<font color="#000080">^.</font>next <font color="#000080">:= </font>h1<font color="#000080">;
      </font>h1 <font color="#000080">:= </font>l<font color="#000080">;                </font><font color="#008000"><i>{ keep h1 at head }
    </i></font><font color="#FF0000"><b>end
    else
    begin                     </b></font><font color="#008000"><i>{ insert a node in the second list }
      </i></font>l<font color="#000080">^.</font>next <font color="#000080">:= </font>h2<font color="#000080">;
      </font>h2 <font color="#000080">:= </font>l<font color="#000080">;                </font><font color="#008000"><i>{ keep h2 at head }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>l <font color="#000080">:= </font>tmp<font color="#000080">;                 </font><font color="#008000"><i>{ move to next node }
    </i></font>listone <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>listone<font color="#000080">;   </font><font color="#008000"><i>{ alternate lists to insert into }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ SplitList }

{----------------- Merge Sort -------------------}

{ merges sorted l1 &amp; l2 into one sorted list (alphabetically) }
</i></font><font color="#FF0000"><b>Function </b></font>MergeAlphaLists<font color="#000080">(</font>l1<font color="#000080">, </font>l2 <font color="#000080">: </font>ListPtr<font color="#000080">) : </font>ListPtr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>tmp <font color="#000080">: </font>ListPtr<font color="#000080">;  </font><font color="#008000"><i>{ resulting list }
</i></font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>l1 <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>tmp <font color="#000080">:= </font>l2
  <font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>l2 <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>tmp <font color="#000080">:= </font>l1
  <font color="#FF0000"><b>else
  if </b></font>l1<font color="#000080">^.</font>str <font color="#000080">&lt; </font>l2<font color="#000080">^.</font>str <font color="#FF0000"><b>then
  begin </b></font><font color="#008000"><i>{ lesser node first }
    </i></font>tmp <font color="#000080">:= </font>l1<font color="#000080">;
    </font>l1 <font color="#000080">:= </font>l1<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>tmp <font color="#000080">:= </font>l2<font color="#000080">;
    </font>l2 <font color="#000080">:= </font>l2<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>MergeAlphaLists <font color="#000080">:= </font>tmp<font color="#000080">;               </font><font color="#008000"><i>{ return head of merged sorted list }
  </i></font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>l1 <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>l2 <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{ traverse lists }
  </i></font><font color="#FF0000"><b>if </b></font>l1<font color="#000080">^.</font>str <font color="#000080">&lt; </font>l2<font color="#000080">^.</font>str <font color="#FF0000"><b>then
  begin
    </b></font>tmp<font color="#000080">^.</font>next <font color="#000080">:= </font>l1<font color="#000080">; </font><font color="#008000"><i>{ add the lesser node }
    </i></font>tmp <font color="#000080">:= </font>l1<font color="#000080">;       </font><font color="#008000"><i>{ move ahead }
    </i></font>l1 <font color="#000080">:= </font>l1<font color="#000080">^.</font>next<font color="#000080">;  </font><font color="#008000"><i>{ next node }
  </i></font><font color="#FF0000"><b>end
  else
  begin
    </b></font>tmp<font color="#000080">^.</font>next <font color="#000080">:= </font>l2<font color="#000080">; </font><font color="#008000"><i>{ add the lesser node }
    </i></font>tmp <font color="#000080">:= </font>l2<font color="#000080">;       </font><font color="#008000"><i>{ ahead 1 }
    </i></font>l2 <font color="#000080">:= </font>l2<font color="#000080">^.</font>next<font color="#000080">;  </font><font color="#008000"><i>{ next node }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>l1 <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>tmp<font color="#000080">^.</font>next <font color="#000080">:= </font>l1   <font color="#008000"><i>{ append remaining nodes }
  </i></font><font color="#FF0000"><b>else
    </b></font>tmp<font color="#000080">^.</font>next <font color="#000080">:= </font>l2<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ MergeAlphaLists }

{ Sorts list l alphabetically }
</i></font><font color="#FF0000"><b>Function </b></font>MergeSortAlpha<font color="#000080">(</font>l <font color="#000080">: </font>ListPtr<font color="#000080">) : </font>ListPtr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>sl1<font color="#000080">,
  </font>sl2 <font color="#000080">: </font>ListPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>l <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then                 </b></font><font color="#008000"><i>{ empty list? }
    </i></font><font color="#FF0000"><b>if </b></font>l<font color="#000080">^.</font>next <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
    begin   </b></font><font color="#008000"><i>{ single node list? }
      </i></font>inc<font color="#000080">(</font>progress<font color="#000080">);
      </font>SplitList<font color="#000080">(</font>l<font color="#000080">, </font>sl1<font color="#000080">, </font>sl2<font color="#000080">);      </font><font color="#008000"><i>{ split list into two halves }
      </i></font>sl1 <font color="#000080">:= </font>MergeSortAlpha<font color="#000080">(</font>sl1<font color="#000080">);  </font><font color="#008000"><i>{ sort the first half }
      </i></font>sl2 <font color="#000080">:= </font>MergeSortAlpha<font color="#000080">(</font>sl2<font color="#000080">);  </font><font color="#008000"><i>{ sort the second half }
      </i></font>MergeSortAlpha <font color="#000080">:= </font>MergeAlphaLists<font color="#000080">(</font>sl1<font color="#000080">, </font>sl2<font color="#000080">)  </font><font color="#008000"><i>{ combine sorted lists }
    </i></font><font color="#FF0000"><b>end
    else
      </b></font>MergeSortAlpha <font color="#000080">:= </font>l   <font color="#008000"><i>{ single node is already sorted }
  </i></font><font color="#FF0000"><b>else
    </b></font>MergeSortAlpha <font color="#000080">:= </font><font color="#FF0000"><b>nil
end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
What mergesort does is to split the list into two equal halves.  It then
mergesorts each of these halves, and merges them back together.  The Real work
is done in the merging step.  When the lists are split down to the level of
single node lists they are merged together again in the correct order.  As it
pops out of the recursion the larger lists are sorted so that merging will
still keep them in order because each node is &gt; than the previous one.  This is
probably the most widely used sorting algorithm (don't quote me) because it is
simple but delivers n*log(n) performance like any good algorithm would.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p></body>
</html>
