<html>
<head><title> "UltraSort" by JERE SANISALO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0057.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's a new sorting routine I developed... If someone know that someone
already did this, leave a message to me... Ok.. On with the sorting
routine...

(********************************CutHERE******************************)
{
                     UltraSORT   Jere Sanisalo
                   \***************************/

   This is a new (I think) method of sorting... It uses a table, which
   size can be different every time you use it... Now I am going to tell
   you how this example works (not only the general method). This example
   makes 32000 numbers (words) and randomizes them. Then comes the &quot;WOW&quot;
   part... It sorts them all 100 times... So it processes 3.2 megabytes.
   It took about 8 seconds in my 66 Mzh machine. You all must understand
   all of this code, but I'm still going to explain how the sorting is
   done (for the lazy people). First it (USort procedure) makes a &quot;table&quot;
   that is sized as big as a word can can be ($FFFF), and clears is. Now
   we have a table full of zeros and the numbers to be sorted. Then it
   goes through the number one by one and looks what they are. After that
   it increases the value in the table at the position that the number tells
   by one. Pretty tricky, huh? So if we have a number to process, let's say
   it is 89. Then it increses the value at the table positioned 89 by one.
   (In pascal: Inc(Table[Number]) ) This example just doesn't use straight
   variable. It reserves one memory segment and uses it, but the way the
   sorting is done is not changed. After we have processed the whole number-
   stream we have all information we need in the table. So now we just go
   through the table, and if its value is more that 0 then put the value
   somewhere where you want the final results (In order, of course). When
   that is done, we are finished! We have the sorted table ready!! Enjoy it,
   but if you use it           ====&gt;  GIVE CREDITS TO ME  &lt;====

  BTW. There are some restrictions... You can't have more that 256
  pieces of the same number. And the number can't be greater than $FFFF.
  These retrictions are possible to break, but I am lazy... ;( On with
  the code...
}

</i></font><font color="#FF0000"><b>uses </b></font>dos<font color="#000080">,</font>crt<font color="#000080">;

</font><font color="#FF0000"><b>const
   </b></font>numtosort <font color="#000080">= </font><font color="#800000">32000</font><font color="#000080">;                           </font><font color="#008000"><i>{How many numbers to sort}

</i></font><font color="#FF0000"><b>var
   </b></font>numbers <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>numtosort<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;      </font><font color="#008000"><i>{Numbers to be sorted}
   </i></font>i<font color="#000080">,</font>j<font color="#000080">,</font>b<font color="#000080">,</font>a <font color="#000080">: </font>word<font color="#000080">;                              </font><font color="#008000"><i>{Just some variables}

</i></font><font color="#FF0000"><b>procedure </b></font>usort<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>p <font color="#000080">: </font>pointer<font color="#000080">;
   </font>segm<font color="#000080">,</font>maxnum<font color="#000080">,</font>minnum <font color="#000080">: </font>word<font color="#000080">;
 </font><font color="#FF0000"><b>begin
 </b></font>getmem<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">$ffff</font><font color="#000080">); </font>segm<font color="#000080">:=</font>seg<font color="#000080">(</font>p<font color="#000080">^);                </font><font color="#008000"><i>{Make the table to be used}
 </i></font>fillchar<font color="#000080">(</font>p<font color="#000080">^,</font><font color="#800000">$ffff</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);                          </font><font color="#008000"><i>{in the sorting}
{This version looks also for the maximum and minimum numbers for speed...}
 </i></font>maxnum<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>minnum<font color="#000080">:=</font><font color="#800000">$ffff</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numtosort <font color="#FF0000"><b>do                       </b></font><font color="#008000"><i>{This &quot;plots the numbers to}
     </i></font><font color="#FF0000"><b>begin                                      </b></font><font color="#008000"><i>{the table...}
     </i></font><font color="#FF0000"><b>if </b></font>maxnum<font color="#000080">&lt;</font>numbers<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>maxnum<font color="#000080">:=</font>numbers<font color="#000080">[</font>i<font color="#000080">];
     </font><font color="#FF0000"><b>if </b></font>minnum<font color="#000080">&gt;</font>numbers<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>minnum<font color="#000080">:=</font>numbers<font color="#000080">[</font>i<font color="#000080">];
     </font>inc<font color="#000080">(</font>mem<font color="#000080">[</font>segm<font color="#000080">:</font>numbers<font color="#000080">[</font>i<font color="#000080">]]);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>b<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>minnum <font color="#FF0000"><b>to </b></font>maxnum <font color="#FF0000"><b>do                     </b></font><font color="#008000"><i>{This gets the procecced}
     </i></font><font color="#FF0000"><b>begin                                      </b></font><font color="#008000"><i>{numbers back to Numbers[]-}
     </i></font><font color="#FF0000"><b>if </b></font>mem<font color="#000080">[</font>segm<font color="#000080">:</font>i<font color="#000080">]&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then                      </b></font><font color="#008000"><i>{variable}
        </i></font><font color="#FF0000"><b>begin
        for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>mem<font color="#000080">[</font>segm<font color="#000080">:</font>i<font color="#000080">]-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
            </b></font>numbers<font color="#000080">[</font>b<font color="#000080">+</font>j<font color="#000080">]:=</font>i<font color="#000080">;
        </font>inc<font color="#000080">(</font>b<font color="#000080">,</font>mem<font color="#000080">[</font>segm<font color="#000080">:</font>i<font color="#000080">]);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>freemem<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">$ffff</font><font color="#000080">);                              </font><font color="#008000"><i>{Free the table's memory}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>randomize<font color="#000080">;                                      </font><font color="#008000"><i>{Randomize the numbers}
</i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numtosort <font color="#FF0000"><b>do
    </b></font>numbers<font color="#000080">[</font>i<font color="#000080">]:=</font>random<font color="#000080">(</font><font color="#800000">$ffff</font><font color="#000080">);
</font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">100 </font><font color="#FF0000"><b>do                              </b></font><font color="#008000"><i>{Sort 100 times}
    </i></font><font color="#FF0000"><b>begin
    </b></font>write<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">);
    </font>usort<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>writeln<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>numtosort <font color="#FF0000"><b>do                        </b></font><font color="#008000"><i>{Write the finished results}
    </i></font><font color="#FF0000"><b>begin
    </b></font>writeln<font color="#000080">(</font>numbers<font color="#000080">[</font>i<font color="#000080">]);
    </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then begin </b></font>readkey<font color="#000080">; </font>readkey<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to SORTING SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0057.PAS">Original</a><b>]</b></p></body>
</html>
