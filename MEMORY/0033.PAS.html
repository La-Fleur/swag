<html>
<head><title> "Get ALL the Memory" by MARK OUELLET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
MARK OUELLET

Compile for Protected Mode in BP 7.x}

{$A+,B-,D+,E+,F-,G+,I+,L+,N-,P-,Q-,R-,S+,T-,V+,X+,Y+}
{$M 16384,0}

</i></font><font color="#FF0000"><b>type
        </b></font>MyElement <font color="#000080">= </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>const
        </b></font>Chunk    <font color="#000080">= </font><font color="#800000">65520 </font><font color="#FF0000"><b>div </b></font>sizeof<font color="#000080">(</font>MyElement<font color="#000080">);
  </font>ChunkCnt <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
        </font>Limit    <font color="#000080">: </font>longint <font color="#000080">= </font>Chunk <font color="#000080">* </font>ChunkCnt <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>type
        </b></font>HeapArrPtr <font color="#000080">= ^</font>HeapArr<font color="#000080">;
        </font>HeapArr    <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..(</font>Chunk <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)] </font><font color="#FF0000"><b>of </b></font>MyElement<font color="#000080">;
        </font>BigHeapArr <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..(</font>ChunkCnt <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)] </font><font color="#FF0000"><b>of </b></font>HeapArrPtr<font color="#000080">;

</font><font color="#FF0000"><b>var
        </b></font>MyHeap <font color="#000080">: </font>BigHeapArr<font color="#000080">;
  </font>Index  <font color="#000080">: </font>longint<font color="#000080">;

</font><font color="#FF0000"><b>begin
        for </b></font>Index <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ChunkCnt<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
          </b></font>new<font color="#000080">(</font>MyHeap<font color="#000080">[</font>Index<font color="#000080">]);
  </font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Limit <font color="#FF0000"><b>do
          </b></font>MyHeap<font color="#000080">[</font>Index <font color="#FF0000"><b>div </b></font>Chunk<font color="#000080">]^[</font>Index <font color="#FF0000"><b>mod </b></font>Chunk<font color="#000080">] := </font>Index<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Limit <font color="#FF0000"><b>do
          </b></font>writeln<font color="#000080">(</font>Index<font color="#000080">:</font><font color="#800000">10</font><font color="#000080">,</font>MyHeap<font color="#000080">[</font>Index <font color="#FF0000"><b>div </b></font>Chunk<font color="#000080">]^[</font>Index <font color="#FF0000"><b>mod </b></font>Chunk<font color="#000080">]:</font><font color="#800000">10</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>Index <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ChunkCnt<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>dispose<font color="#000080">(</font>MyHeap<font color="#000080">[</font>Index<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
I just tested it and it stored 163,800 Longintegers on the heap. The
nice thing is you could make this into an Object with SET and GET
methods and treat it as a 163800 element array.
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0033.PAS">Original</a><b>]</b></p></body>
</html>
