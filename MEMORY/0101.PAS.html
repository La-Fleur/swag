<html>
<head><title> "fastest MEMORY procedures" by WESLEY BURNS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000"> <font color="#008000"><i>{Fast FillChar and Move}
 {Posted By: Wesley Burns}
 {Email    : microcon@iafirca.com}
</i></font><font color="#FF0000"><b>Unit </b></font>MEM<font color="#000080">;

</font><font color="#FF0000"><b>Interface
Procedure </b></font>FillCharFast<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">; </font>Count<font color="#000080">: </font>Word<font color="#000080">; </font>Value<font color="#000080">:</font>Byte<font color="#000080">); 
</font><font color="#FF0000"><b>Procedure </b></font>MoveFast<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>source<font color="#000080">, </font>dest<font color="#000080">; </font>count<font color="#000080">: </font>word<font color="#000080">); 

</font><font color="#FF0000"><b>Implementation
Procedure </b></font>MoveFast<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>source<font color="#000080">, </font>dest<font color="#000080">; </font>count<font color="#000080">: </font>word<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  lds  si,source      </font><font color="#008000"><i>{ds,si = source}
  </i></font><font color="#FF00FF">les  di,dest        </font><font color="#008000"><i>{es,di = dest}
  </i></font><font color="#FF00FF">mov  cx,count       </font><font color="#008000"><i>{cx = count}
  </i></font><font color="#FF00FF">mov  ax,cx          </font><font color="#008000"><i>{ax = count}
  </i></font><font color="#FF00FF">cld
  shr  cx,2           </font><font color="#008000"><i>{cx = count / 4}
  </i></font><font color="#FF00FF">db   66h
  rep  movsw          </font><font color="#008000"><i>{copy double words}
  </i></font><font color="#FF00FF">mov  cl,al          </font><font color="#008000"><i>{get rest bytes}
  </i></font><font color="#FF00FF">and  cl,3
  rep  movsb          </font><font color="#008000"><i>{copy rest}
  </i></font><font color="#FF00FF">pop  ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FillCharFast<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">; </font>Count<font color="#000080">: </font>Word<font color="#000080">; </font>Value<font color="#000080">:</font>Byte<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">les di,x
  mov cx,Count
  shr cx,1
  mov al,value
  mov ah,al
  rep StoSW
  test count,1
  jz @</font><font color="#FF0000"><b>end
  </b></font>StoSB
<font color="#000080">@</font><font color="#FF0000"><b>end</b></font><font color="#000080">:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

 </font><font color="#008000"><i>{Email: me if you have ANY questions about                                   }
 { : 64k DMA Sound Blaster Programming using XMS                              }
 { : Fast Memory Management                                                   }
 { : PCX using XMS                                                            }
 { : XMS Units                                                                }
 { : Pascal in general                                                        }
 { : Or if you have some fast procedures that you don't mind parting with.    }


</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p></body>
</html>
