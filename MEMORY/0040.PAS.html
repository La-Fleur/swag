<html>
<head><title> "Line Memory" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
-&gt; All you need to access flat memory is to make sure you get two segmen
-&gt; up against each other when you allocate them. The Windows API has
-&gt; GlobalAllocPtr for this type of huge memory allocation, but I'm not s
-&gt; you'd go about it in DOS (non-protected) mode except to compare the s
-&gt; after GetMem() and see if they are linear/sequential. (and hope V86 m
-&gt; handle translation to actual physical memory!)

&gt; If that is the case then look up the ABSOLUTE clause in your Pascal
&gt; manual. It will tell you how to make a second variables address be
&gt; Absolutely relative to the firstone; no matter what. The address for
&gt; the second one will be based on the address for the original.

Correct. Absolutely at the same address as the other variable.

At this time, BP won't let you add or subtract offsets from the address you
give to the Absolute clause. Unless possibly it's a constant address. In any
case, it's not ACCESSING memory linearly that is the problem, it's getting the
operating system or runtime library to ALLOCATE it linearly.

Protected mode has the WinAPI unit that lets you deal with huge memory blocks
and other stuff. That is what is needed.

In real mode all you can do is:
}

</i></font><font color="#FF0000"><b>var </b></font>p<font color="#000080">,</font>p2<font color="#000080">,</font>tmp<font color="#000080">:</font>pointer<font color="#000080">;

</font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{make sure 2 memory blocks are linear}
 </i></font>getmem<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">);  </font><font color="#008000"><i>{48K}
 </i></font>getmem<font color="#000080">(</font>p2<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">); </font><font color="#008000"><i>{96K total}
 </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>seg<font color="#000080">(</font>p2<font color="#000080">^)-</font>seg<font color="#000080">(</font>p<font color="#000080">^))*</font><font color="#800000">$1000</font><font color="#000080">+(</font>ofs<font color="#000080">(</font>p2<font color="#000080">^)-</font>ofs<font color="#000080">(</font>p<font color="#000080">^))&lt;&gt;</font><font color="#800000">$C000 </font><font color="#FF0000"><b>do begin
  </b></font>freeMem<font color="#000080">(</font>p2<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">);
  </font>freeMem<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Not linear... trying again.'</font><font color="#000080">);
  </font>getmem<font color="#000080">(</font>tmp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>getmem<font color="#000080">(</font>p<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">);
  </font>getmem<font color="#000080">(</font>p2<font color="#000080">,</font><font color="#800000">$C000</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p></body>
</html>
