<html>
<head><title> "RTM Functions" by PETER SAWATZKI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>RtmApi<font color="#000080">;
</font><font color="#008000"><i>{ Import unit for all new functions in RTM 1.5
  written 06/20/94 by Peter Sawatzki }
</i></font><font color="#FF0000"><b>Interface
Uses
  </b></font>WinTypes<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FatalExit<font color="#000080">(</font>Code<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>GetVersion<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalInit<font color="#000080">(</font>Segment<font color="#000080">, </font>Start<font color="#000080">, </font>EndPos<font color="#000080">: </font>Word<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalAlloc<font color="#000080">(</font>Flags<font color="#000080">, </font>Bytes<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalReAlloc<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">; </font>Bytes<font color="#000080">, </font>Flags<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalFree<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalLock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalUnlock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalSize<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalHandle<font color="#000080">(</font>Mem<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalFlags<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalCompact<font color="#000080">(</font>MinFree<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalDiscard<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#008000"><i>{function LocalNotify(NotifyProc: TFarProc): TFarProc;}
</i></font><font color="#FF0000"><b>function </b></font>GlobalAlloc<font color="#000080">(</font>Flags<font color="#000080">: </font>Word<font color="#000080">; </font>Bytes<font color="#000080">: </font>LongInt<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalReAlloc<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">; </font>Bytes<font color="#000080">: </font>LongInt<font color="#000080">; </font>Flags<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalFree<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalLock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalUnlock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>UnlockResource<font color="#000080">(</font>ResData<font color="#000080">: </font>THandle<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalSize<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalHandle<font color="#000080">(</font>Mem<font color="#000080">: </font>Word<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalFlags<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LockSegment<font color="#000080">(</font>Segment<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>UnlockSegment<font color="#000080">(</font>Segment<font color="#000080">: </font>Word<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalCompact<font color="#000080">(</font>MinFree<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetCurrentTask<font color="#000080">: </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleUsage<font color="#000080">(</font>Module<font color="#000080">: </font>THandle<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleFileName<font color="#000080">(</font>Module<font color="#000080">: </font>THandle<font color="#000080">; </font>Filename<font color="#000080">: </font>PChar<font color="#000080">; </font>Size<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleHandle<font color="#000080">(</font>ModuleName<font color="#000080">: </font>PChar<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetProcAddress<font color="#000080">(</font>Module<font color="#000080">: </font>THandle<font color="#000080">; </font>ProcName<font color="#000080">: </font>PChar<font color="#000080">): </font>TFarProc<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Catch<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>CatchBuf<font color="#000080">: </font>TCatchBuf<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Throw<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>CatchBuf<font color="#000080">: </font>TCatchBuf<font color="#000080">; </font>ThrowBack<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>GetProfileInt<font color="#000080">(</font>AppName<font color="#000080">, </font>KeyName<font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#FF0000"><b>Default</b></font><font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetProfileString<font color="#000080">(</font>AppName<font color="#000080">, </font>KeyName<font color="#000080">, </font><font color="#FF0000"><b>Default</b></font><font color="#000080">, </font>ReturnedString<font color="#000080">: </font>PChar<font color="#000080">; </font>Size<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WriteProfileString<font color="#000080">(</font>ApplicationName<font color="#000080">, </font>KeyName<font color="#000080">, </font>Str<font color="#000080">: </font>PChar<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FindResource<font color="#000080">(</font>Instance<font color="#000080">: </font>THandle<font color="#000080">; </font>Name<font color="#000080">, </font>ResType<font color="#000080">: </font>PChar<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadResource<font color="#000080">(</font>Instance<font color="#000080">: </font>THandle<font color="#000080">; </font>ResInfo<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LockResource<font color="#000080">(</font>ResData<font color="#000080">: </font>THandle<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FreeResource<font color="#000080">(</font>ResData<font color="#000080">: </font>THandle<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AccessResource<font color="#000080">(</font>Instance<font color="#000080">, </font>ResInfo<font color="#000080">: </font>THandle<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SizeofResource<font color="#000080">(</font>Instance<font color="#000080">, </font>ResInfo<font color="#000080">: </font>THandle<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>OpenFile<font color="#000080">(</font>FileName<font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ReOpenBuff<font color="#000080">: </font>TOfStruct<font color="#000080">; </font>Style<font color="#000080">: </font>Word<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lclose<font color="#000080">(</font>FileHandle<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lread<font color="#000080">(</font>FileHandle<font color="#000080">: </font>Integer<font color="#000080">; </font>Buffer<font color="#000080">: </font>PChar<font color="#000080">; </font>Bytes<font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lcreat<font color="#000080">(</font>PathName<font color="#000080">: </font>PChar<font color="#000080">; </font>Atribute<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_llseek<font color="#000080">(</font>FileHandle<font color="#000080">: </font>Integer<font color="#000080">; </font>Offset<font color="#000080">: </font>LongInt<font color="#000080">; </font>Origin<font color="#000080">: </font>Integer<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lopen<font color="#000080">(</font>PathName<font color="#000080">: </font>PChar<font color="#000080">; </font>ReadWrite<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lwrite<font color="#000080">(</font>FileHandle<font color="#000080">: </font>Integer<font color="#000080">; </font>Buffer<font color="#000080">: </font>PChar<font color="#000080">; </font>Bytes<font color="#000080">: </font>Integer<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadLibrary<font color="#000080">(</font>LibFileName<font color="#000080">: </font>PChar<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>FreeLibrary<font color="#000080">(</font>LibModule<font color="#000080">: </font>THandle<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>DOS3Call<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>OutputDebugString<font color="#000080">(</font>OutputString<font color="#000080">: </font>PChar<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>LocalShrink<font color="#000080">(</font>Seg<font color="#000080">: </font>THandle<font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetPrivateProfileInt<font color="#000080">(</font>ApplicationName<font color="#000080">, </font>KeyName<font color="#000080">: </font>PChar<font color="#000080">;
                              </font><font color="#FF0000"><b>Default</b></font><font color="#000080">: </font>Integer<font color="#000080">; </font>FileName<font color="#000080">: </font>PChar<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetPrivateProfileString<font color="#000080">(</font>ApplicationName<font color="#000080">, </font>KeyName<font color="#000080">: </font>PChar<font color="#000080">;
                                 </font><font color="#FF0000"><b>Default</b></font><font color="#000080">: </font>PChar<font color="#000080">; </font>ReturnedString<font color="#000080">: </font>PChar<font color="#000080">;
                                 </font>Size<font color="#000080">: </font>Integer<font color="#000080">; </font>FileName<font color="#000080">: </font>PChar<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WritePrivateProfileString<font color="#000080">(</font>ApplicationName<font color="#000080">, </font>KeyName<font color="#000080">, </font>Str<font color="#000080">, </font>FileName<font color="#000080">: </font>PChar<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetDOSEnvironment<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetWinFlags<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function </b></font>GetExePtr <font color="#000080">(</font>aHandle<font color="#000080">: </font>tHandle<font color="#000080">): </font>tHandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetWindowsDirectory<font color="#000080">(</font>Buffer<font color="#000080">: </font>PChar<font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSystemDirectory<font color="#000080">(</font>Buffer<font color="#000080">: </font>PChar<font color="#000080">; </font>Size<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>GlobalNotify<font color="#000080">(</font>NotifyProc<font color="#000080">: </font>TFarProc<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>GlobalLRUOldest<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalLRUNewest<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetFreeSpace<font color="#000080">(</font>Flag<font color="#000080">: </font>Word<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AllocDStoCSAlias<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AllocSelector<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FreeSelector<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ChangeSelector<font color="#000080">(</font>DestSelector<font color="#000080">, </font>SourceSelector<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalDosAlloc<font color="#000080">(</font>Bytes<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalDosFree<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalPageLock<font color="#000080">(</font>Selector<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalPageUnlock<font color="#000080">(</font>Selector<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>GlobalFix<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>GlobalUnfix<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AnsiUpper<font color="#000080">(</font>Str<font color="#000080">: </font>PChar<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AnsiLower<font color="#000080">(</font>Str<font color="#000080">: </font>PChar<font color="#000080">): </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>PrestoChangoSelector<font color="#000080">(</font>SourceSel<font color="#000080">, </font>DestSel<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSelectorBase<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetSelectorBase<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">; </font>Base<font color="#000080">: </font>Longint<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSelectorLimit<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetSelectorLimit<font color="#000080">(</font>Selector<font color="#000080">: </font>Word<font color="#000080">; </font>Base<font color="#000080">: </font>Longint<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LockData<font color="#000080">(</font>Dummy<font color="#000080">: </font>Integer<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>UnlockData<font color="#000080">(</font>Dummy<font color="#000080">: </font>Integer<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalDiscard<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;

</font><font color="#008000"><i>{USER}
</i></font><font color="#FF0000"><b>function </b></font>MessageBox<font color="#000080">(</font>WndParent<font color="#000080">: </font>HWnd<font color="#000080">; </font>Txt<font color="#000080">, </font>Caption<font color="#000080">: </font>PChar<font color="#000080">; </font>TextType<font color="#000080">: </font>Word<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetTickCount<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetCurrentTime<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadString<font color="#000080">(</font>Instance<font color="#000080">: </font>THandle<font color="#000080">; </font>ID<font color="#000080">: </font>Word<font color="#000080">; </font>Buffer<font color="#000080">: </font>PChar<font color="#000080">; </font>BufferMax<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_wsprintf<font color="#000080">(</font>DestStr<font color="#000080">, </font>Format<font color="#000080">: </font>PChar<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ArgList<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>CDecl</b></font><font color="#000080">;

</font><font color="#008000"><i>{KEYBOARD}
</i></font><font color="#FF0000"><b>function </b></font>AnsiToOem<font color="#000080">(</font>AnsiStr<font color="#000080">, </font>OemStr<font color="#000080">: </font>PChar<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>AnsiToOemBuff<font color="#000080">(</font>AnsiStr<font color="#000080">, </font>OemStr<font color="#000080">: </font>PChar<font color="#000080">; </font>Length<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>OemToAnsi<font color="#000080">(</font>OemStr<font color="#000080">, </font>AnsiStr<font color="#000080">: </font>PChar<font color="#000080">): </font>Bool<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>OemToAnsiBuff<font color="#000080">(</font>OemStr<font color="#000080">, </font>AnsiStr<font color="#000080">: </font>PChar<font color="#000080">; </font>Length<font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

function </b></font>_LocalLock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Word<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">; </font><font color="#FF0000"><b>forward</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FatalExit<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetVersion<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">3</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalInit<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">4</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalAlloc<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">5</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalReAlloc<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalFree<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">7</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_LocalLock<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">8</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalUnlock<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">9</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalSize<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">10</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalHandle<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">11</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalFlags<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">12</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalCompact<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">13</font><font color="#000080">;
</font><font color="#008000"><i>{function LocalNotify;                   external 'KERNEL'       Index 14;}
</i></font><font color="#FF0000"><b>function </b></font>GlobalAlloc<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">15</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalReAlloc<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">16</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalFree<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">17</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalLock<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">18</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalUnlock<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">19</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>UnlockResource<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">19</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalSize<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">20</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalHandle<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">21</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalFlags<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">22</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LockSegment<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">23</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>UnlockSegment<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">24</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalCompact<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">25</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetCurrentTask<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">36</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleHandle<font color="#000080">;               </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">47</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleUsage<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">48</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetModuleFileName<font color="#000080">;             </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">49</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetProcAddress<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">50</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>Catch<font color="#000080">;                         </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">55</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Throw<font color="#000080">;                        </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">56</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetProfileInt<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">57</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetProfileString<font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">58</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WriteProfileString<font color="#000080">;            </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">59</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FindResource<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">60</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadResource<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">61</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LockResource<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">62</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FreeResource<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">63</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AccessResource<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">64</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SizeofResource<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">65</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>OpenFile<font color="#000080">;                      </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">74</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lclose<font color="#000080">;                       </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">81</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lread<font color="#000080">;                        </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">82</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lcreat<font color="#000080">;                       </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">83</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_llseek<font color="#000080">;                       </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">84</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lopen<font color="#000080">;                        </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">85</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_lwrite<font color="#000080">;                       </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">86</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadLibrary<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">95</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>FreeLibrary<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">96</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>DOS3Call<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">102</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>OutputDebugString<font color="#000080">;            </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">115</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LocalShrink<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">121</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetPrivateProfileInt<font color="#000080">;          </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">127</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetPrivateProfileString<font color="#000080">;       </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">128</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>WritePrivateProfileString<font color="#000080">;     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">129</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetDOSEnvironment<font color="#000080">;             </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">131</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetWinFlags<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">132</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetExePtr<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">133</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetWindowsDirectory<font color="#000080">;           </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">134</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSystemDirectory<font color="#000080">;            </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">135</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>GlobalNotify<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">154</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalLRUOldest<font color="#000080">;               </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">163</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalLRUNewest<font color="#000080">;               </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">164</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetFreeSpace<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">169</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AllocDStoCSAlias<font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">171</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AllocSelector<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">175</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>FreeSelector<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">176</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>ChangeSelector<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">177</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalDosAlloc<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">184</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalDosFree<font color="#000080">;                 </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">185</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalPageLock<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">191</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalPageUnlock<font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">192</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>GlobalFix<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">197</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GlobalUnfix<font color="#000080">;                   </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">198</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AnsiUpper<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">431</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>AnsiLower<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">432</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>PrestoChangoSelector<font color="#000080">;          </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">177</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSelectorBase<font color="#000080">;               </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">186</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetSelectorBase<font color="#000080">;               </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">187</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetSelectorLimit<font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">188</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>SetSelectorLimit<font color="#000080">;              </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KERNEL'        </font>Index <font color="#800000">189</font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>MessageBox<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'USER'          </font>Index <font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetTickCount<font color="#000080">;                  </font><font color="#FF0000"><b>external </b></font><font color="#800000">'USER'          </font>Index <font color="#800000">13</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>GetCurrentTime<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'USER'          </font>Index <font color="#800000">15</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>LoadString<font color="#000080">;                    </font><font color="#FF0000"><b>external </b></font><font color="#800000">'USER'          </font>Index <font color="#800000">176</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>_wsprintf<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'USER'          </font>Index <font color="#800000">420</font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>AnsiToOem<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KEYBOARD'      </font>Index <font color="#800000">5</font><font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>OemToAnsi<font color="#000080">;                     </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KEYBOARD'      </font>Index <font color="#800000">6</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>AnsiToOemBuff<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KEYBOARD'      </font>Index <font color="#800000">134</font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>OemToAnsiBuff<font color="#000080">;                </font><font color="#FF0000"><b>external </b></font><font color="#800000">'KEYBOARD'      </font>Index <font color="#800000">135</font><font color="#000080">;

</font><font color="#008000"><i>{ Various wrapper routines }

</i></font><font color="#FF0000"><b>function </b></font>LockData<font color="#000080">(</font>Dummy<font color="#000080">: </font>Integer<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LockData <font color="#000080">:= </font>LockSegment<font color="#000080">(</font><font color="#800000">$FFFF</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>UnlockData<font color="#000080">(</font>Dummy<font color="#000080">: </font>Integer<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>UnlockData <font color="#000080">:= </font>UnlockSegment<font color="#000080">(</font><font color="#800000">$FFFF</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>GlobalDiscard<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GlobalDiscard <font color="#000080">:= </font>GlobalReAlloc<font color="#000080">(</font>Mem<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>gmem_Moveable<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LocalDiscard<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LocalDiscard <font color="#000080">:= </font>LocalReAlloc<font color="#000080">(</font>Mem<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>lmem_Moveable<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>LocalLock<font color="#000080">(</font>Mem<font color="#000080">: </font>THandle<font color="#000080">): </font>Pointer<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">PUSH    Mem
        CALL    _LocalLock
        MOV     DX,DS
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to MEMORY SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0060.PAS">Original</a><b>]</b></p></body>
</html>
