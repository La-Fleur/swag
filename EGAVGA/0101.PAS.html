<html>
<head><title> "VGA/EGA Multi Line Modes" by BOB SWART</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Check out Hax #179 from PC Techniques vol.4 no.6 Feb/Mar issue (page 70),
(coincidently written by me), where a small program is presented that'll not
only detect whether a VGA adapter is installed, but is also capable of putting
the screen in 80x12, 80x14, 80x21, 80x25, 80x28, 80x43 or 80x50 mode...}

{$IFDEF VER70}
{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,P-,Q-,R-,S+,T-,V-,X-}
{$ELSE}
{$A+,B-,D-,E-,F-,G-,I-,L-,N-,O-,R-,S+,V-,X-}
{$ENDIF}
{$M 1024,0,0}
{
  VGA 3.0
  Borland Pascal (Objects) 7.01
  Copr. (c) 7-17-1993 DwarFools &amp; Consultancy drs. Robert E. Swart
                      P.O. box 799
                      5702 NP  Helmond
                      The Netherlands

  Code size: 3248 Bytes
  Data size:  676 Bytes
}
</i></font><font color="#FF0000"><b>Const
  </b></font>VGAInside<font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">; </font><font color="#008000"><i>{ Assume no VGA-card is installed }

</i></font><font color="#FF0000"><b>var </b></font>VGALines<font color="#000080">,</font>i<font color="#000080">: </font>Integer<font color="#000080">;

    </font><font color="#FF0000"><b>procedure </b></font>Lines200<font color="#000080">;
    </font><font color="#008000"><i>{ Set 200 scanlines on VGA display }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1200  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$30</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,$30    }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }

    </i></font><font color="#FF0000"><b>procedure </b></font>Lines350<font color="#000080">;
    </font><font color="#008000"><i>{ Set 350 scanlines on VGA display }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$01</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1201  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$30</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,$30    }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }

    </i></font><font color="#FF0000"><b>procedure </b></font>Lines400<font color="#000080">;
    </font><font color="#008000"><i>{ Set 400 scanlines on VGA display }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$02</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1202  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$30</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,$30    }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }

    </i></font><font color="#FF0000"><b>procedure </b></font>Font8x8<font color="#000080">;
    </font><font color="#008000"><i>{ Set 8x8 CGA-font on VGA display. }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$12</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1112  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,0      }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }

    </i></font><font color="#FF0000"><b>procedure </b></font>Font8x14<font color="#000080">;
    </font><font color="#008000"><i>{ Set 8x14 EGA-font on VGA display }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1111  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,0      }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }

    </i></font><font color="#FF0000"><b>procedure </b></font>Font8x16<font color="#000080">;
    </font><font color="#008000"><i>{ Set 8x16 VGA-font on VGA display }
    </i></font><font color="#FF0000"><b>InLine</b></font><font color="#000080">(
      </font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$0003  }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/      </font><font color="#008000"><i>{  int   $10       }
      </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$14</font><font color="#000080">/</font><font color="#800000">$11</font><font color="#000080">/  </font><font color="#008000"><i>{  mov   AX,$1114  }
      </i></font><font color="#800000">$B3</font><font color="#000080">/</font><font color="#800000">$00</font><font color="#000080">/      </font><font color="#008000"><i>{  mov   BL,0      }
      </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);     </font><font color="#008000"><i>{  int   $10       }


</i></font><font color="#FF0000"><b>begin
  </b></font>writeln<font color="#000080">(</font><font color="#800000">'VGALines 3.0 (c) 1993 DwarFools &amp; Consultancy' </font><font color="#000080">+
                         </font><font color="#800000">', by drs. Robert E. Swart.'#13#10</font><font color="#000080">);
  </font><font color="#FF0000"><b>ASM </b></font><font color="#008000"><i>{ Detect VGA display }
        </i></font><font color="#FF00FF">mov   AX,$0F00
        int   $10
        cmp   AL,$03   </font><font color="#008000"><i>{ TextMode = CO80 }
        </i></font><font color="#FF00FF">jne   @</font><font color="#FF0000"><b>End
        </b></font>mov   AX<font color="#000080">,</font><font color="#800000">$1C00
        </font>mov   CX<font color="#000080">,</font><font color="#800000">$0007
        </font>int   <font color="#800000">$10
        </font>cmp   AL<font color="#000080">,</font><font color="#800000">$1C
        </font>jne   <font color="#000080">@</font><font color="#FF0000"><b>End
        </b></font>mov   VGAInside<font color="#000080">,</font>True <font color="#008000"><i>{ VGA display installed }
  </i></font><font color="#000080">@</font><font color="#FF0000"><b>End</b></font><font color="#000080">:
  </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{ VGA display }</i></font><font color="#000080">;

  </font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>VGALines<font color="#000080">,</font>i<font color="#000080">);

  </font><font color="#FF0000"><b>if not </b></font><font color="#000080">((</font>ParamCount <font color="#000080">&gt;= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>VGAInside <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>i <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
          </b></font><font color="#000080">(</font>VGALines <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">25</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">43</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">])) </font><font color="#FF0000"><b>then
  begin
    </b></font>writeln<font color="#000080">(</font><font color="#800000">'Usage: VGALines #Lines [test]'#13#10</font><font color="#000080">);
    </font>writeln<font color="#000080">(</font><font color="#800000">'Where #Lines is any of [12,14,21,25,28,43,50]'</font><font color="#000080">:</font><font color="#800000">52</font><font color="#000080">);
    </font><font color="#FF0000"><b>if not </b></font>VGAInside <font color="#FF0000"><b>then
      </b></font>writeln<font color="#000080">(</font><font color="#800000">#13#10'Error: VGA display required!'</font><font color="#000080">);
    </font>Halt
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>case </b></font>VGALines <font color="#FF0000"><b>of </b></font><font color="#008000"><i>{ first set scan-lines }
  </i></font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">: </font>Lines200<font color="#000080">;
  </font><font color="#800000">21</font><font color="#000080">,</font><font color="#800000">43</font><font color="#000080">: </font>Lines350<font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>Lines400
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>case </b></font>VGALines <font color="#FF0000"><b>of </b></font><font color="#008000"><i>{ then select the font }
  </i></font><font color="#800000">43</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">: </font>Font8x8<font color="#000080">;
  </font><font color="#800000">14</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">: </font>Font8x14<font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>Font8x16
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>ParamCount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{ test parameter is used }
  </i></font><font color="#FF0000"><b>begin
    for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>VGALines<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do </b></font>writeln<font color="#000080">(</font>i<font color="#000080">);
    </font>write<font color="#000080">(</font>VGALines<font color="#000080">,</font><font color="#800000">' lines set.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0101.PAS">Original</a><b>]</b></p></body>
</html>
