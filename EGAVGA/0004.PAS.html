<html>
<head><title> "Detection of EGA/VGA Card" by EDWIN CALIMBO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
EDWIN CALIMBO

&sup3;Can anyone supply me With a routine to determine a Graphics card? I want
&sup3;the Procedure to return a Variable if the user has a Graphics card less
&sup3;than an EGA. Anyone have anything quick?

The Function below will detect most Graphics (mono/color) card. It's
a bit long, but is has all the info on how to detect certain card.
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>CardType <font color="#000080">= (</font>none<font color="#000080">,</font>mda<font color="#000080">,</font>cga<font color="#000080">,</font>egamono<font color="#000080">,</font>egacolor<font color="#000080">,
              </font>vgamono<font color="#000080">,</font>vgacolor<font color="#000080">,</font>mcgamono<font color="#000080">,</font>mcgacolor<font color="#000080">);

</font><font color="#FF0000"><b>Function </b></font>VideoCard<font color="#000080">: </font>CardType<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>code <font color="#000080">: </font>Byte<font color="#000080">;
  </font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$1A</font><font color="#000080">;      </font><font color="#008000"><i>(* call VGA Identify Adapter Function *)
  </i></font>Regs<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;      </font><font color="#008000"><i>(* clear AL to 0...*)
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);     </font><font color="#008000"><i>(* call BIOS *)
  </i></font><font color="#FF0000"><b>If </b></font>Regs<font color="#000080">.</font>AL <font color="#000080">= </font><font color="#800000">$1A </font><font color="#FF0000"><b>then
  begin
    Case </b></font>Regs<font color="#000080">.</font>BL <font color="#FF0000"><b>of
      </b></font><font color="#800000">$00 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>NONE<font color="#000080">;       </font><font color="#008000"><i>(* no Graphic card *)
      </i></font><font color="#800000">$01 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>MDA<font color="#000080">;        </font><font color="#008000"><i>(* monochrome *)
      </i></font><font color="#800000">$02 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>CGA<font color="#000080">;        </font><font color="#008000"><i>(* cga *)
      </i></font><font color="#800000">$04 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>EGAColor<font color="#000080">;   </font><font color="#008000"><i>(* ega color *)
      </i></font><font color="#800000">$05 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>EGAMono<font color="#000080">;    </font><font color="#008000"><i>(* ega mono*)
      </i></font><font color="#800000">$07 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>VGAMono<font color="#000080">;    </font><font color="#008000"><i>(* vga mono *)
      </i></font><font color="#800000">$08 </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>VGAColor<font color="#000080">;   </font><font color="#008000"><i>(* vga color *)
      </i></font><font color="#800000">$0A</font><font color="#000080">,
      </font><font color="#800000">$0C </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>MCGAColor<font color="#000080">;  </font><font color="#008000"><i>(* mcga color *)
      </i></font><font color="#800000">$0B </font><font color="#000080">: </font>VideoCard <font color="#000080">:= </font>MCGAMono<font color="#000080">;   </font><font color="#008000"><i>(* mcga mono *)
      </i></font><font color="#FF0000"><b>Else
        </b></font>VideoCard <font color="#000080">:= </font>CGA
    <font color="#FF0000"><b>end
  end
  Else
  begin
    </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;         </font><font color="#008000"><i>(* use another Function service *)
    </i></font>Regs<font color="#000080">.</font>BX <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;         </font><font color="#008000"><i>(* BL = $10 means return EGA info *)
    </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);        </font><font color="#008000"><i>(* call BIOS video Function *)
    </i></font><font color="#FF0000"><b>If </b></font>Regs<font color="#000080">.</font>bx <font color="#000080">&lt;&gt; </font><font color="#800000">$10 </font><font color="#FF0000"><b>Then  </b></font><font color="#008000"><i>(* bx unchanged means EGA is not present *)
    </i></font><font color="#FF0000"><b>begin
      </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
      </font>Regs<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
      </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Regs<font color="#000080">.</font>BH <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>VideoCard <font color="#000080">:= </font>EGAColor
      <font color="#FF0000"><b>Else
        </b></font>VideoCard <font color="#000080">:= </font>EGAMono
    <font color="#FF0000"><b>end
    Else
    begin
      </b></font>Intr<font color="#000080">(</font><font color="#800000">$11</font><font color="#000080">, </font>Regs<font color="#000080">);     </font><font color="#008000"><i>(* eguipment determination service *)
      </i></font>code <font color="#000080">:= (</font>Regs<font color="#000080">.</font>AL <font color="#FF0000"><b>and </b></font><font color="#800000">$30</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>code <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        </b></font>VideoCard <font color="#000080">:= </font>MDA
      <font color="#FF0000"><b>Else
        </b></font>VideoCard <font color="#000080">:= </font>CGA
    <font color="#FF0000"><b>end
  end
end</b></font><font color="#000080">; </font><font color="#008000"><i>(* VideoCard *)

(*============================= cut here ==================================*)

</i></font><font color="#FF0000"><b>begin
  Case </b></font>VideoCard <font color="#FF0000"><b>of
    </b></font>VGAColor <font color="#000080">: </font>Writeln<font color="#000080">(</font><font color="#800000">'VGA Color'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0004.PAS">Original</a><b>]</b></p></body>
</html>
