<html>
<head><title> "Quick 256 VGA Palette Cycling" by TAPIO AIJALA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0149.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Any one out there have code to do this
&gt;
&gt; Rotate_PAL_Up(count : byte; from,to: byte):
&gt;   ie.  Rotate_Pal_Up(10,100,120);
&gt;   will rotate the pal up 10 times between the ranges of 100   and 12
&gt; back after 120...
&gt;
&gt; Rotate_Pal_Down(c,f,t : byte);  basicly same as abov! Thanks!

You asked for the palette cycling routine, here you are! As you can see,
there is NO cycling routine in this piece of code which does all the job.
There are several smaller routines (GetRGB, SetRGB etc.) and then the actual
cycling routine which uses other smaller routines. That's because all these
routines are from my own vga util library and I was too lazy to put them to
together to a one piece of code... :)
}

</i></font><font color="#FF0000"><b>Program </b></font>CyclePaletteExample<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>crt<font color="#000080">;

</font><font color="#FF0000"><b>Type  </b></font>PaletteType                 <font color="#000080">= </font><font color="#FF0000"><b>Record
       </b></font>red                        <font color="#000080">: </font>Byte<font color="#000080">;
       </font>green                      <font color="#000080">: </font>Byte<font color="#000080">;
       </font>blue                       <font color="#000080">: </font>Byte<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Var   </b></font>rgb                         <font color="#000080">: </font>PaletteType<font color="#000080">;
      </font>pal                         <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>PaletteType<font color="#000080">;

</font><font color="#FF0000"><b>Var   </b></font>aa1                         <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{Some temp variables}
      </i></font>aa5                         <font color="#000080">: </font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetRGB<font color="#000080">(</font>col<font color="#000080">, </font>r<font color="#000080">, </font>g<font color="#000080">, </font>b <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Begin
 ASM
  </b></font><font color="#FF00FF">CLI
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font>Port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font>col<font color="#000080">;
 </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>r<font color="#000080">;
 </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>g<font color="#000080">;
 </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>b<font color="#000080">;
 </font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">STI
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetRGB<font color="#000080">(</font>col <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Begin
 </b></font>Port<font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">] := </font>col<font color="#000080">;
 </font>rgb<font color="#000080">.</font>red <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
 </font>rgb<font color="#000080">.</font>green <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
 </font>rgb<font color="#000080">.</font>blue <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetPalette<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 For </b></font>aa5 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do </b></font>SetRGB<font color="#000080">(</font>aa5<font color="#000080">,</font>pal<font color="#000080">[</font>aa5<font color="#000080">].</font>red<font color="#000080">,</font>pal<font color="#000080">[</font>aa5<font color="#000080">].</font>green<font color="#000080">,</font>pal<font color="#000080">[</font>aa5<font color="#000080">].</font>blue<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetPalette<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 For </b></font>aa5 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do Begin
  </b></font>GetRGB<font color="#000080">(</font>aa5<font color="#000080">);
  </font>pal<font color="#000080">[</font>aa5<font color="#000080">] := </font>rgb<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CyclePalette<font color="#000080">(</font>s<font color="#000080">, </font>e<font color="#000080">, </font>n<font color="#000080">, </font>d <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>Var </b></font>c1 <font color="#000080">: </font>PaletteType<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 If </b></font>d <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then Begin
  </b></font>aa1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
   </b></font>c1 <font color="#000080">:= </font>pal<font color="#000080">[</font>e<font color="#000080">];
   </font><font color="#FF0000"><b>For </b></font>aa5 <font color="#000080">:= </font>e <font color="#FF0000"><b>downto </b></font>s <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>Do Begin
    </b></font>pal<font color="#000080">[</font>aa5<font color="#000080">] := </font>pal<font color="#000080">[</font>aa5 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">];
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>pal<font color="#000080">[</font>s<font color="#000080">] := </font>c1<font color="#000080">;
   </font>Inc<font color="#000080">(</font>aa1<font color="#000080">);
   </font>SetPalette<font color="#000080">; </font><font color="#008000"><i>{Sets cycled palette}
  </i></font><font color="#FF0000"><b>Until </b></font>aa1 <font color="#000080">= </font>n<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>If </b></font>d <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then Begin
  </b></font>aa1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
   </b></font>c1 <font color="#000080">:= </font>pal<font color="#000080">[</font>s<font color="#000080">];
   </font><font color="#FF0000"><b>For </b></font>aa5 <font color="#000080">:= </font>s <font color="#FF0000"><b>to </b></font>e <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>Do Begin
    </b></font>pal<font color="#000080">[</font>aa5<font color="#000080">] := </font>pal<font color="#000080">[</font>aa5 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">];
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>pal<font color="#000080">[</font>e<font color="#000080">] := </font>c1<font color="#000080">;
   </font>Inc<font color="#000080">(</font>aa1<font color="#000080">);
   </font>SetPalette<font color="#000080">; </font><font color="#008000"><i>{Sets cycled palette}
  </i></font><font color="#FF0000"><b>Until </b></font>aa1 <font color="#000080">= </font>n<font color="#000080">;
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
 ASM
  </b></font><font color="#FF00FF">MOV  AX,$13 </font><font color="#008000"><i>{Video mode is now 13h = 320 x 200 and 256 colors}
  </i></font><font color="#FF00FF">INT  $10
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>For </b></font>aa1 <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>aa1<font color="#000080">] := </font>aa1<font color="#000080">; </font><font color="#008000"><i>{Draw 255 pixels}
 </i></font>GetPalette<font color="#000080">; </font><font color="#008000"><i>{Loads palette from vga's registers}
 </i></font><font color="#FF0000"><b>Repeat
  </b></font>CyclePalette<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{Palette cycling!}
 </i></font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">; </font><font color="#008000"><i>{Press any key to continue! :)}
 </i></font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV  AX,$3 </font><font color="#008000"><i>{Back to the text mode}
  </i></font><font color="#FF00FF">INT  $10
 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font><font color="#008000"><i>{
Example:

CyclePalette(120, 140, 10, 1) would rotate colors between the ranges
120 and 140 10 times.

The last parameter (d) is the direction of palette rotation:

1       From the first specified color to the last specified color
2       From the last specified color to the first specified color
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0149.PAS">Original</a><b>]</b></p></body>
</html>
