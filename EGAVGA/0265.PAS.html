<html>
<head><title> "Mode-13 Variable Width font" by EDDY JANSSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0265.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Program </b></font>SaruFont<font color="#000080">;
</font><font color="#008000"><i>{ Mail suggestions &amp; Improvements to eddy.jansson@saru.ct.se }
</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">,</font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>var
 </b></font>F              <font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
 </font>BytesRead      <font color="#000080">:</font>Word<font color="#000080">;
 </font>Font           <font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8192</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Better safe than sorry ;}

</i></font><font color="#FF0000"><b>Const
</b></font><font color="#008000"><i>(*
font: db 5,32,58 { Fontheight,first defined character, characters defined }
      db width,bitmapline1,bitmapline2..bitmapline[height]
      etc..
*)
 </i></font>SmallFont <font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">357</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">= (</font><font color="#800000">5</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">58</font><font color="#000080">, </font><font color="#008000"><i>{ Space to 'Z' }
  </i></font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,
  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,
</font><font color="#800000">144</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,
  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">144</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">248</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,
  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">,
 </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,
 </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,
 </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,
 </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,
  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,
</font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">240</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">104</font><font color="#000080">, </font><font color="#800000">72</font><font color="#000080">,  </font><font color="#800000">8</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,
</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,
</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,
</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,
</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,
  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,
</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">96</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">192</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,
</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">136</font><font color="#000080">,</font><font color="#800000">168</font><font color="#000080">,</font><font color="#800000">168</font><font color="#000080">,</font><font color="#800000">168</font><font color="#000080">, </font><font color="#800000">80</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,
 </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">,</font><font color="#800000">160</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">,</font><font color="#800000">128</font><font color="#000080">,</font><font color="#800000">224</font><font color="#000080">);

</font><font color="#FF0000"><b>Procedure </b></font>SRMUserFont<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Font<font color="#000080">: </font>Pointer<font color="#000080">;</font><font color="#FF0000"><b>const </b></font>X<font color="#000080">,</font>Y<font color="#000080">: </font>Word<font color="#000080">;
                      </font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">: </font>Byte<font color="#000080">;</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Write to a 320*200*256 screen using a variable width font.
  Please note that this is my first ever asm-routine, and
  because of that you'll have to use nullterminated pascalstrings,
  _OR_ you could just hack the code.. :-)  // Eddy.Jansson@saru.ct.se }
</i></font><font color="#FF0000"><b>var
 </b></font>FirstChar<font color="#000080">,
 </font>CharHeight   <font color="#000080">:</font>Byte<font color="#000080">;
 </font>CharNr<font color="#000080">,
 </font>ScreenPTR    <font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">push ds

 mov ax,0a000h     </font><font color="#008000"><i>{ Setup ES:[BX] = X,Y to plot at }
 </i></font><font color="#FF00FF">mov es,ax
 mov bx,x
 mov ax,y
 xchg ah,al
 add bx,ax
 shr ax,2
 add bx,ax

</font><font color="#008000"><i>(* Use this instead if you have a Lookuptable:
 mov bx,y          { Setup ES:[BX] = X,Y to plot at }
 add bx,bx
 mov ax,$a000      { easily modified to point to a virtual screen }
 mov es,ax         { Lookup tables rules :-) }
 mov bx,word ptr YTable[bx]
 add bx,x          { Voila! bx = offset onto screen }
*)

 </i></font><font color="#FF00FF">lds di,font
 mov dl,[di]       </font><font color="#008000"><i>{ height of font goes into dh }
 </i></font><font color="#FF00FF">mov CharHeight,dl
 inc di
 mov dl,[di]
 mov FirstChar,dl
 mov CharNr,0     </font><font color="#008000"><i>{ Ugh! Character counter, not a very }
                  { good method, but I'm all out of registers :-( }

</i></font><font color="#FF00FF">@nextchar:
 inc CharNr       </font><font color="#008000"><i>{ also skips lengthbyte! }
 </i></font><font color="#FF00FF">push ds          </font><font color="#008000"><i>{ This I don't like, pushing and popping. }
 </i></font><font color="#FF00FF">lds si,[S]       </font><font color="#008000"><i>{ But unfortunately I can't seem to find }
 </i></font><font color="#FF00FF">add si,CharNr    </font><font color="#008000"><i>{ any spare registers? Intel, can you help? }
 </i></font><font color="#FF00FF">lodsb            </font><font color="#008000"><i>{ load asciivalue into al }
 </i></font><font color="#FF00FF">pop ds
 cmp al,0         </font><font color="#008000"><i>{ check for null-termination }
 </i></font><font color="#FF00FF">je @exit         </font><font color="#008000"><i>{ exit if end of string }

 </i></font><font color="#FF00FF">mov ScreenPTR,BX </font><font color="#008000"><i>{ save bx }
 </i></font><font color="#FF00FF">mov dh,CharHeight
 xor ah,ah
 mov cl,firstchar </font><font color="#008000"><i>{ firstchar }
 </i></font><font color="#FF00FF">sub al,cl        </font><font color="#008000"><i>{ al = currentchar - firstchar }
 </i></font><font color="#FF00FF">mov si,ax        </font><font color="#008000"><i>{ di = scrap register }
 </i></font><font color="#FF00FF">mul dh           </font><font color="#008000"><i>{ ax * fontheight }
 </i></font><font color="#FF00FF">add ax,si        </font><font color="#008000"><i>{ ax + characters to skip }

 </i></font><font color="#FF00FF">lds di,font      </font><font color="#008000"><i>{ This can be omptimized I think (preserve DI) }
 </i></font><font color="#FF00FF">add di,3         </font><font color="#008000"><i>{ skip header }
 </i></font><font color="#FF00FF">add di,ax        </font><font color="#008000"><i>{ Point into structure }
 </i></font><font color="#FF00FF">mov cl,[di]      </font><font color="#008000"><i>{ get character width }

</i></font><font color="#FF00FF">@nextline:
 mov ch,cl        </font><font color="#008000"><i>{ ch is the height counter. cl is the original. }
 </i></font><font color="#FF00FF">inc di           </font><font color="#008000"><i>{ .. now points to bitmap }
 </i></font><font color="#FF00FF">mov dl,[di]      </font><font color="#008000"><i>{ get bitmap byte }

</i></font><font color="#FF00FF">@nextpixel:
 rol dl,1         </font><font color="#008000"><i>{ rotate bitmap and prepare for next pixel }
 </i></font><font color="#FF00FF">mov al,dl        </font><font color="#008000"><i>{ mov bitmap into al for manipulation }
 </i></font><font color="#FF00FF">and al,1         </font><font color="#008000"><i>{ mask out the correct bit }
 </i></font><font color="#FF00FF">jz @masked       </font><font color="#008000"><i>{ jump if transperent }
 </i></font><font color="#FF00FF">mov al,color
 mov byte ptr es:[bx],al </font><font color="#008000"><i>{ Set the pixel on the screen }
</i></font><font color="#FF00FF">@masked:
 inc bx           </font><font color="#008000"><i>{ increment X-offset }
 </i></font><font color="#FF00FF">dec ch           </font><font color="#008000"><i>{ are we done? last byte in character? }
 </i></font><font color="#FF00FF">jnz @nextpixel   </font><font color="#008000"><i>{ nope, out with another pixel }
 </i></font><font color="#FF00FF">add bx,320       </font><font color="#008000"><i>{ Go to next line on the screen }
 </i></font><font color="#FF00FF">sub bx,cx        </font><font color="#008000"><i>{ X-alignment fixup }
 </i></font><font color="#FF00FF">dec dh           </font><font color="#008000"><i>{ are we done with the character? }
 </i></font><font color="#FF00FF">jnz @nextline
 mov bx,ScreenPTR </font><font color="#008000"><i>{ restore screen offset and prepare for next character }
 </i></font><font color="#FF00FF">add bx,cx
 inc bx           </font><font color="#008000"><i>{ A little gap between the letters, thank you... }
 </i></font><font color="#FF00FF">jmp @nextchar

@exit:
 pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 asm
  </b></font><font color="#FF00FF">mov ax,$13
  int $10
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
 Assign(F,'C:\TEMP\SMALLER.BIN');
 Reset(F,1);
 BlockRead(F,Font,FileSize(F),BytesRead);
 Close(F);
}


 { This example font gives you about 80*32 characters/screen }

</i></font><font color="#FF0000"><b>for </b></font>BytesRead<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">32 </font><font color="#FF0000"><b>do
 </b></font>SRMUserFont<font color="#000080">(@</font>SmallFont<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>BytesRead<font color="#000080">*</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">64</font><font color="#000080">-</font>BytesRead<font color="#000080">,
</font><font color="#800000">'12345678901234567890123456789012345678901234567890123456789012345678901234567890'</font><font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">);
 </font>ReadLn<font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0265.PAS">Original</a><b>]</b></p></body>
</html>
