<html>
<head><title> "Reading TIFF Files" by ALAN B.</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0234.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: nigelg@lpilsley.demon.co.uk (Nigel Goodwin)
&gt; Can anyone tell me where to find some pascal source code that reads simple
&gt; bi-level TIFF format images. It should support the standard TIFF compression
&gt; schemes used for bi-level images.

Here's a TIFF program I downloaded from Compuserve, hope it may be of help.
}

</i></font><font color="#FF0000"><b>Program </b></font>tiffread<font color="#000080">;

</font><font color="#008000"><i>{Written by Alan B.}


{$I-,R+}

</i></font><font color="#FF0000"><b>uses  </b></font>printer<font color="#000080">,</font>crt<font color="#000080">,</font>dos<font color="#000080">,</font>graph<font color="#000080">;

</font><font color="#FF0000"><b>type  </b></font>binstr     <font color="#000080">= </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
      </font>screenarray<font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">11000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

      </font>stripinfoptr <font color="#000080">= ^</font>stripinfo<font color="#000080">;
      </font>stripinfo    <font color="#000080">= </font><font color="#FF0000"><b>record
                       </b></font>size<font color="#000080">: </font>word<font color="#000080">;
                       </font>offset<font color="#000080">: </font>word<font color="#000080">;
                       </font>stripinfolink<font color="#000080">: </font>stripinfoptr<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>stripobytesptr <font color="#000080">=^</font>stripobytes<font color="#000080">;
      </font>stripobytes    <font color="#000080">= </font><font color="#FF0000"><b>record
                         </b></font>value<font color="#000080">: </font>byte<font color="#000080">;
                         </font>stripobyteslink<font color="#000080">: </font>stripobytesptr<font color="#000080">;
                       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>lineobytesptr    <font color="#000080">= ^</font>lineobytes<font color="#000080">;
      </font>lineobytes       <font color="#000080">= </font><font color="#FF0000"><b>record
                           </b></font>bits<font color="#000080">: </font>byte<font color="#000080">;
                           </font>lineobyteslink<font color="#000080">: </font>lineobytesptr<font color="#000080">;
                         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var   </b></font>fin<font color="#000080">,
      </font>fout                   <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
      </font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">,</font>rr               <font color="#000080">: </font>integer<font color="#000080">;
      </font>l<font color="#000080">,</font>m<font color="#000080">,
      </font>column<font color="#000080">,
      </font>bytepos                <font color="#000080">: </font>byte<font color="#000080">;
      </font>row                    <font color="#000080">: </font>integer<font color="#000080">;
      </font>count                  <font color="#000080">: </font>shortint<font color="#000080">;
      </font>rownum                 <font color="#000080">: </font>integer<font color="#000080">;
      </font>TifFileName            <font color="#000080">:   </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">45</font><font color="#000080">];
      </font>dot<font color="#000080">: </font>boolean<font color="#000080">;
      </font>rowstir                <font color="#000080">: </font>integer<font color="#000080">;
      </font>fentries<font color="#000080">,
      </font>nexttag<font color="#000080">,
      </font>nextlength             <font color="#000080">: </font>word<font color="#000080">;
      </font>tbyte                  <font color="#000080">: </font>byte<font color="#000080">;
      </font>fimagewidth<font color="#000080">,
      </font>fimagelength<font color="#000080">,
      </font>fstripoffsetsoffset<font color="#000080">,
      </font>fstrips<font color="#000080">,
      </font>fstripbytecountsoffset<font color="#000080">,
      </font>bytetoread<font color="#000080">,
      </font>largeststrip           <font color="#000080">: </font>word<font color="#000080">;
      </font>first<font color="#000080">,
      </font>last<font color="#000080">,
      </font>p                      <font color="#000080">: </font>stripinfoptr<font color="#000080">;
      </font>firstbyte<font color="#000080">,
      </font>lastbyte<font color="#000080">,
      </font>pbyte                  <font color="#000080">: </font>stripobytesptr<font color="#000080">;
      </font>firstline<font color="#000080">,
      </font>lastline<font color="#000080">,
      </font>pline                  <font color="#000080">: </font>lineobytesptr<font color="#000080">;
      </font>columns                <font color="#000080">: </font>integer<font color="#000080">;
      </font>compression            <font color="#000080">: </font>word<font color="#000080">;
      </font>regs                   <font color="#000080">: </font>registers<font color="#000080">;
      </font>screen                 <font color="#000080">: ^</font>screenarray<font color="#000080">;
      </font>header                 <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">10</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
      </font>page                   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
      </font>printcolumns           <font color="#000080">: </font>integer<font color="#000080">;


</font><font color="#008000"><i>{reads a file into the image array}
{assumes StripOffsets start directly after stripbytcounts}
{read down to where stripbytecounts starts}
{fill stripbytecounts with size in bytes of each offset}
{read each strip into linked list}


</i></font><font color="#FF0000"><b>procedure </b></font>Writebytes<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{this displays the contents of the linked list on the printer}
  </i></font>pbyte<font color="#000080">:= </font>firstbyte<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>pbyte<font color="#000080">^.</font>stripobyteslink <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
    begin
      </b></font>write<font color="#000080">(</font>lst<font color="#000080">,</font>pbyte<font color="#000080">^.</font>value<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
      </font>pbyte<font color="#000080">:= </font>pbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">(</font>lst<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>WriteStripInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{this displays the contents of the linked list on the printer}
  </i></font>p<font color="#000080">:= </font>first<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>p <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
    begin
      </b></font>write<font color="#000080">(</font>lst<font color="#000080">,</font>p<font color="#000080">^.</font>size<font color="#000080">:</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
      </font>writeln<font color="#000080">(</font>lst<font color="#000080">,</font>p<font color="#000080">^.</font>offset<font color="#000080">:</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
      </font>p<font color="#000080">:= </font>p<font color="#000080">^.</font>stripinfolink<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>writeln<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#12</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVMode<font color="#000080">(</font>newmode<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Regs<font color="#000080">,</font>SizeOf<font color="#000080">(</font>regs<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>Regs<font color="#000080">.</font>AX<font color="#000080">:= </font>newmode<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>BitOn<font color="#000080">(</font>Position<font color="#000080">, </font>TestByte<font color="#000080">:</font>byte<font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>bt<font color="#000080">,
  </font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>bt<font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
  </font>bt<font color="#000080">:= </font>bt <font color="#FF0000"><b>shl </b></font>position<font color="#000080">;
  </font>biton<font color="#000080">:= (</font>bt <font color="#FF0000"><b>and </b></font>testbyte<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Pictoprinter<font color="#000080">(</font>row<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>bytepos<font color="#000080">,
    </font>j<font color="#000080">,</font>i<font color="#000080">,
    </font>pinlabel<font color="#000080">,
    </font>pin<font color="#000080">,
    </font>column   <font color="#000080">: </font>integer<font color="#000080">;
    </font>trow     <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>write<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'A'</font><font color="#000080">,</font><font color="#800000">#8</font><font color="#000080">); </font><font color="#008000"><i>{8 lines per inch}
  </i></font>bytepos<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>write<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#27</font><font color="#000080">,</font><font color="#800000">'L'</font><font color="#000080">,</font>Chr<font color="#000080">((</font>columns<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">256</font><font color="#000080">),</font>chr<font color="#000080">((</font>columns<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">256</font><font color="#000080">));
</font><font color="#008000"><i>{graphics mode}
  </i></font><font color="#FF0000"><b>for </b></font>column<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>columns <font color="#FF0000"><b>do
  begin
    for </b></font>bytepos<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
    begin
      </b></font>trow<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
      </font>pinlabel<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>pinlabel<font color="#000080">:= </font><font color="#800000">128</font><font color="#000080">;
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">64</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">32</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>trow<font color="#000080">);
      </font><font color="#FF0000"><b>if not </b></font>biton<font color="#000080">(</font>abs<font color="#000080">(</font>bytepos<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>page<font color="#000080">[</font>trow<font color="#000080">][</font>column<font color="#000080">]) </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>pinlabel<font color="#000080">);
      </font>write<font color="#000080">(</font>lst<font color="#000080">,</font>char<font color="#000080">(</font>pinlabel<font color="#000080">))
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>write<font color="#000080">(</font>lst<font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">,</font><font color="#800000">#10</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Pictoscreen<font color="#000080">(</font>row<font color="#000080">:</font>integer<font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>storagebyte <font color="#000080">: </font>byte<font color="#000080">;
    </font>i<font color="#000080">,</font>j<font color="#000080">,</font>wl<font color="#000080">,</font>wr<font color="#000080">,</font>wb<font color="#000080">,</font>wt<font color="#000080">,
    </font>column      <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetPixal<font color="#000080">(</font>xpos<font color="#000080">,</font>ypos<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">(</font>Regs<font color="#000080">,</font>SizeOf<font color="#000080">(</font>regs<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>Regs<font color="#000080">.</font>ah<font color="#000080">:= </font><font color="#800000">$0c</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>al<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Regs<font color="#000080">.</font>cx<font color="#000080">:= </font>xpos<font color="#000080">;
  </font>Regs<font color="#000080">.</font>dx<font color="#000080">:= </font>ypos<font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>column<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>printcolumns<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>pline <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
    begin
      if </b></font><font color="#000080">((</font>row <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>page<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">,</font>column<font color="#000080">]:= </font>pline<font color="#000080">^.</font>bits
      <font color="#FF0000"><b>else
        </b></font>page<font color="#000080">[</font>row <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">,</font>column<font color="#000080">]:= </font>pline<font color="#000080">^.</font>bits<font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
        if </b></font>biton<font color="#000080">(</font>i<font color="#000080">,</font>pline<font color="#000080">^.</font>bits<font color="#000080">) </font><font color="#FF0000"><b>then
        begin
          </b></font>SetPixal<font color="#000080">((</font>column<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">-</font><font color="#800000">7</font><font color="#000080">)+</font>abs<font color="#000080">(</font>i<font color="#000080">-</font><font color="#800000">7</font><font color="#000080">),</font>row<font color="#000080">);
          </font>inc<font color="#000080">(</font>printcolumns<font color="#000080">)
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>pline<font color="#000080">:= </font>pline<font color="#000080">^.</font>lineobyteslink<font color="#000080">;
      </font>inc<font color="#000080">(</font>column<font color="#000080">)
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>GetFileName<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>fileexists<font color="#000080">(</font>searchfile<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>f<font color="#000080">:   </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>ok<font color="#000080">:  </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>f<font color="#000080">,</font>searchfile<font color="#000080">);
  </font><font color="#008000"><i>(*$I-*)
  </i></font>reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>(*$I+*)
  </i></font>ok<font color="#000080">:= </font>ioresult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>ok <font color="#FF0000"><b>then
    </b></font>fileexists<font color="#000080">:= </font>false
  <font color="#FF0000"><b>else
    begin
      </b></font>close<font color="#000080">(</font>f<font color="#000080">);
      </font>fileexists<font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>TifFileName<font color="#000080">:=</font><font color="#800000">'____________'</font><font color="#000080">;
  </font>i<font color="#000080">:=</font>ParamCount<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>i<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then
  begin
    </b></font>Write<font color="#000080">(</font><font color="#800000">#07</font><font color="#000080">,</font><font color="#800000">' Invalid Number of Paramaters'</font><font color="#000080">);
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  if </b></font>i<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>write<font color="#000080">(</font><font color="#800000">'Enter File Name: '</font><font color="#000080">);
    </font>ReadLn<font color="#000080">(</font>tifFileName<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>tifFileName<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>tifFileName<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Dot<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>tifFileName<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>tifFileName<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">'.' </font><font color="#FF0000"><b>then
        </b></font>Dot<font color="#000080">:=</font>True<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Dot<font color="#000080">=</font>False <font color="#FF0000"><b>then
    </b></font>tifFileName<font color="#000080">:=</font>tifFileName<font color="#000080">+</font><font color="#800000">'.TIF'</font><font color="#000080">;
  </font><font color="#FF0000"><b>if not</b></font><font color="#000080">(</font>FileExists<font color="#000080">(</font>tifFileName<font color="#000080">)) </font><font color="#FF0000"><b>then
  begin
    </b></font>Write<font color="#000080">(</font><font color="#800000">#07</font><font color="#000080">,</font><font color="#800000">'File '</font><font color="#000080">,</font>tifFileName<font color="#000080">,</font><font color="#800000">' Not on Disk'</font><font color="#000080">);
    </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>GetFileInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>fin<font color="#000080">,</font>tiffilename<font color="#000080">);
  </font>reset<font color="#000080">(</font>fin<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'***********'</font><font color="#000080">);
        </font><font color="#008000"><i>{we're assuming the ifd is right after the header}
  </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fentries<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>fentries <font color="#FF0000"><b>do
    begin
      </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>nexttag<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>case </b></font>nexttag <font color="#FF0000"><b>of
         </b></font><font color="#008000"><i>{i really need a 32 bit unsigned type here. since i dont have
          one file witdth should be limited to 65535}
        </i></font><font color="#800000">256</font><font color="#000080">: </font><font color="#FF0000"><b>begin                        </b></font><font color="#008000"><i>{imagewidth}
               </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
               </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fimagewidth<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
               </font>Columns<font color="#000080">:= (</font>fimagewidth <font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>fimagewidth <font color="#FF0000"><b>mod </b></font><font color="#800000">8</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                 </b></font>inc<font color="#000080">(</font>Columns<font color="#000080">);
</font><font color="#008000"><i>{               writeln('columns: ',columns);}
               </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
             </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">257</font><font color="#000080">:</font><font color="#FF0000"><b>begin                         </b></font><font color="#008000"><i>{imagelength}
              </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fimagelength<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#008000"><i>{              writeln('rows: ',fimagelength);}
              </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">259</font><font color="#000080">:</font><font color="#FF0000"><b>begin
              </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>Compression<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>compression <font color="#000080">&lt;&gt; </font><font color="#800000">32773 </font><font color="#FF0000"><b>then
                begin
                  </b></font>writeln<font color="#000080">(</font><font color="#800000">'I can''t read this. A computer is a terrible thing to waste, isn''t it.'</font><font color="#000080">);
                  </font>readln<font color="#000080">;
                  </font>halt<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">273</font><font color="#000080">:</font><font color="#FF0000"><b>begin                         </b></font><font color="#008000"><i>{stripOffsets}
              </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);    </font><font color="#008000"><i>{read past field type}
              </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fstrips<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);      </font><font color="#008000"><i>{length}
              </i></font>writeln<font color="#000080">(</font><font color="#800000">'strips: '</font><font color="#000080">,</font>fstrips<font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fstripoffsetsoffset<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#800000">279</font><font color="#000080">:</font><font color="#FF0000"><b>begin                         </b></font><font color="#008000"><i>{StripByteCounts}
              </i></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>fstripbytecountsoffset<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
              </font>writeln<font color="#000080">(</font><font color="#800000">'stripbytecountoffset: '</font><font color="#000080">,</font>fstripbytecountsoffset<font color="#000080">);
              </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>else </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>header<font color="#000080">,</font><font color="#800000">10</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>{case}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{for i:= 1 to fentries}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;




</font><font color="#FF0000"><b>Procedure </b></font>GetStripCounts<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>add<font color="#000080">(</font>fcount<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#008000"><i>{we're assuming theres at least 1 byte in the list}
</i></font><font color="#FF0000"><b>begin
  if </b></font>first <font color="#000080">= </font><font color="#FF0000"><b>nil then
    begin
      </b></font>new<font color="#000080">(</font>first<font color="#000080">);
      </font>last<font color="#000080">:= </font>first<font color="#000080">;
      </font>first<font color="#000080">^.</font>size<font color="#000080">:= </font>fcount<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else      </b></font><font color="#008000"><i>{the list has already been started so just add to it}
    </i></font><font color="#FF0000"><b>begin
      </b></font>new<font color="#000080">(</font>p<font color="#000080">);
      </font>p<font color="#000080">^.</font>size<font color="#000080">:= </font>fcount<font color="#000080">;
      </font>last<font color="#000080">^.</font>stripinfolink<font color="#000080">:=</font>p<font color="#000080">;
      </font>last<font color="#000080">:= </font>p<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{here we're assuming the stripbytecount values will fit in a word}
{this part reads stripbytecounts into the linkedlist}
  </i></font>first<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>reset<font color="#000080">(</font>fin<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>seek<font color="#000080">(</font>fin<font color="#000080">,</font>fstripbytecountsoffset<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>fstrips <font color="#FF0000"><b>do
    begin
      </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>bytetoread<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>add<font color="#000080">(</font>bytetoread<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>first <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>last<font color="#000080">^.</font>stripinfolink<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>GetStripOffsets<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{this part reads in the strip offsets into the linked list}
  </i></font>p<font color="#000080">:= </font>first<font color="#000080">;
  </font>reset<font color="#000080">(</font>fin<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>seek<font color="#000080">(</font>fin<font color="#000080">,</font>fstripoffsetsoffset<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>fstrips <font color="#FF0000"><b>do
    begin
      </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>bytetoread<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>p<font color="#000080">^.</font>offset<font color="#000080">:= </font>bytetoread<font color="#000080">;
      </font>p<font color="#000080">:=</font>p<font color="#000080">^.</font>stripinfolink<font color="#000080">;
      </font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>bytetoread<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DisposeStrip<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>tpointer<font color="#000080">:</font>stripobytesptr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tpointer<font color="#000080">:= </font>firstbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">;
  </font>dispose<font color="#000080">(</font>firstbyte<font color="#000080">);
  </font>firstbyte<font color="#000080">:= </font>tpointer<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>tpointer<font color="#000080">^.</font>stripobyteslink <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
  begin
    </b></font>tpointer<font color="#000080">:= </font>tpointer<font color="#000080">^.</font>stripobyteslink<font color="#000080">;
    </font>dispose<font color="#000080">(</font>firstbyte<font color="#000080">);
    </font>firstbyte<font color="#000080">:= </font>tpointer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dispose<font color="#000080">(</font>tpointer<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>ReadAStrip<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>addbyte<font color="#000080">(</font>fcount<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#008000"><i>{we're assuming there's at least 1 byte in the list}
</i></font><font color="#FF0000"><b>begin
  if </b></font>firstbyte <font color="#000080">= </font><font color="#FF0000"><b>nil then
    begin
      </b></font>new<font color="#000080">(</font>firstbyte<font color="#000080">);
      </font>lastbyte<font color="#000080">:= </font>firstbyte<font color="#000080">;
      </font>firstbyte<font color="#000080">^.</font>value<font color="#000080">:= </font>fcount<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else      </b></font><font color="#008000"><i>{the list has already been started so just add to it}
    </i></font><font color="#FF0000"><b>begin
      </b></font>new<font color="#000080">(</font>pbyte<font color="#000080">);
      </font>pbyte<font color="#000080">^.</font>value<font color="#000080">:= </font>fcount<font color="#000080">;
      </font>lastbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">:=</font>pbyte<font color="#000080">;
      </font>lastbyte<font color="#000080">:= </font>pbyte<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{this part jumps down to the right place in the file and reads a strip into
 a linked list.  We'll just read in one strip for now.}

  </i></font>firstbyte<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>reset<font color="#000080">(</font>fin<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>seek<font color="#000080">(</font>fin<font color="#000080">,</font>p<font color="#000080">^.</font>offset<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>p<font color="#000080">^.</font>size <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>do  </b></font><font color="#008000"><i>{+1 for not / by 8 evenly}
    </i></font><font color="#FF0000"><b>begin
      </b></font>blockread<font color="#000080">(</font>fin<font color="#000080">,</font>tbyte<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>addbyte<font color="#000080">(</font>tbyte<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>firstbyte <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>lastbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>DecodeStrip<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>spot     <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>disposeline<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>tpointer<font color="#000080">:</font>lineobytesptr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tpointer<font color="#000080">:= </font>firstline<font color="#000080">^.</font>lineobyteslink<font color="#000080">;
  </font>dispose<font color="#000080">(</font>firstline<font color="#000080">);
  </font>firstline<font color="#000080">:= </font>tpointer<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>tpointer<font color="#000080">^.</font>lineobyteslink <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
  begin
    </b></font>tpointer<font color="#000080">:= </font>tpointer<font color="#000080">^.</font>lineobyteslink<font color="#000080">;
    </font>dispose<font color="#000080">(</font>firstline<font color="#000080">);
    </font>firstline<font color="#000080">:= </font>tpointer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>dispose<font color="#000080">(</font>tpointer<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ResetPage<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>firstline <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then </b></font>lastline<font color="#000080">^.</font>lineobyteslink<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>pline<font color="#000080">:= </font>firstline<font color="#000080">;
  </font>pictoscreen<font color="#000080">(</font>rownum<font color="#000080">);
  </font><font color="#008000"><i>{if ((rownum div 8) &gt;= 1) and ((rownum mod 8) = 0) then
    pictoprinter(rownum);}
  </i></font>inc<font color="#000080">(</font>rownum<font color="#000080">);
  </font>disposeline<font color="#000080">;
  </font>firstline<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>spot<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>addline<font color="#000080">(</font>fcount<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#008000"><i>{we're assuming there's at least 1 byte in the list}
</i></font><font color="#FF0000"><b>begin
  if </b></font>firstline <font color="#000080">= </font><font color="#FF0000"><b>nil then
    begin
      </b></font>new<font color="#000080">(</font>firstline<font color="#000080">);
      </font>lastline<font color="#000080">:= </font>firstline<font color="#000080">;
      </font>firstline<font color="#000080">^.</font>bits<font color="#000080">:= </font>fcount<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else      </b></font><font color="#008000"><i>{the list has already been started so just add to it}
    </i></font><font color="#FF0000"><b>begin
      </b></font>new<font color="#000080">(</font>pline<font color="#000080">);
      </font>pline<font color="#000080">^.</font>bits<font color="#000080">:= </font>fcount<font color="#000080">;
      </font>lastline<font color="#000080">^.</font>lineobyteslink<font color="#000080">:=</font>pline<font color="#000080">;
      </font>lastline<font color="#000080">:= </font>pline<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{now lets try and decode the strip in the linked list}
  </i></font>firstline<font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>spot<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>pbyte<font color="#000080">:= </font>firstbyte<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>pbyte<font color="#000080">^.</font>stripobyteslink <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do </b></font><font color="#008000"><i>{convert the strip 8 rows per strip}
    </i></font><font color="#FF0000"><b>begin
      </b></font>Count<font color="#000080">:= </font>shortint<font color="#000080">(</font>pbyte<font color="#000080">^.</font>value<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Count <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then    </b></font><font color="#008000"><i>{copy the next byte -n+1 times}
        </i></font><font color="#FF0000"><b>begin
          </b></font>pbyte<font color="#000080">:= </font>pbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">; </font><font color="#008000"><i>{point to the byte to copy -n+1
times}
          </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(-</font>Count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
            begin
              </b></font>addline<font color="#000080">(</font>pbyte<font color="#000080">^.</font>value<font color="#000080">);
              </font>inc<font color="#000080">(</font>spot<font color="#000080">);
              </font><font color="#FF0000"><b>if </b></font>spot <font color="#000080">&gt; </font>columns <font color="#FF0000"><b>then
                </b></font>resetpage<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end
      else                  </b></font><font color="#008000"><i>{copy the next n+1 bytes literally}
        </i></font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Count<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{no error checking for nil}
          </i></font><font color="#FF0000"><b>begin
            </b></font>pbyte<font color="#000080">:= </font>pbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">; </font><font color="#008000"><i>{point the the next literal byte}
            </i></font>addline<font color="#000080">(</font>pbyte<font color="#000080">^.</font>value<font color="#000080">);
            </font>inc<font color="#000080">(</font>spot<font color="#000080">);
            </font><font color="#FF0000"><b>if </b></font>spot <font color="#000080">&gt; </font>columns <font color="#FF0000"><b>then
              </b></font>resetpage<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>pbyte<font color="#000080">:= </font>pbyte<font color="#000080">^.</font>stripobyteslink<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>ch<font color="#000080">:</font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetFileName<font color="#000080">;
  </font>GetFileInfo<font color="#000080">;
  </font>GetStripCounts<font color="#000080">;
  </font>GetStripOffsets<font color="#000080">;
  </font>p<font color="#000080">:= </font>first<font color="#000080">;
  </font>SetVMode<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">);
  </font>new<font color="#000080">(</font>screen<font color="#000080">);
  </font>screen<font color="#000080">:= </font>ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">$0000</font><font color="#000080">);
  </font>rownum<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>p<font color="#000080">^.</font>stripinfolink <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil do
    begin
      </b></font>ReadAStrip<font color="#000080">;
      </font>DecodeStrip<font color="#000080">;
      </font>DisposeStrip<font color="#000080">;
      </font>p<font color="#000080">:= </font>p<font color="#000080">^.</font>stripinfolink<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">(</font>fin<font color="#000080">);
  </font>assign<font color="#000080">(</font>input<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>input<font color="#000080">);
  </font>readln<font color="#000080">;
  </font>SetVMode<font color="#000080">(</font><font color="#800000">$3</font><font color="#000080">);
  </font><font color="#008000"><i>{write(lst,#12,#13);}

  {enhancements needed

  adjust for aspect ratio
  mask out extra stuf at right side when displaying
  add ega support
  add interface
  write direct to memory
  }

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.



</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0234.PAS">Original</a><b>]</b></p></body>
</html>
