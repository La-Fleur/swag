<html>
<head><title> "Fire Code" by ALEX CHALFIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0202.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Howdy, I am looking for some Pascal (no ASM please :) plasma or fire
&gt; psudocode..

 Here is a 100% Pascal fire. It isn't very fast (well, its downright slow),
 but its all Pascal with no ASM (the video mode set is ASM, but that one is
 easy to understand). Please do not send updates to me, as I already know
 how to make it much faster.
}

</i></font><font color="#FF0000"><b>Program </b></font>Fire<font color="#000080">;
</font><font color="#008000"><i>{ Alex Chalfin   12/26/94         }
{ Internet: achalfin@uceng.uc.edu }
{ FidoNet: 1:108/180              }

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>Buffer <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">16000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBottom<font color="#000080">;
</font><font color="#008000"><i>{ Set the bottom line of the buffer with hotspots }

</i></font><font color="#FF0000"><b>Var  </b></font>x <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">159 </font><font color="#FF0000"><b>do
    </b></font>Buffer<font color="#000080">[</font><font color="#800000">99</font><font color="#000080">*</font><font color="#800000">160</font><font color="#000080">+</font>x<font color="#000080">] := </font>Random<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">) * </font><font color="#800000">255</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CalcFire<font color="#000080">;
</font><font color="#008000"><i>{ Calculate the rest of the fire buffer }

</i></font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>ColorVal <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>y <font color="#000080">:= </font><font color="#800000">98 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
    For </b></font>x <font color="#000080">:= </font><font color="#800000">159 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
      Begin
        </b></font>ColorVal <font color="#000080">:= (</font>Buffer<font color="#000080">[(</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">160</font><font color="#000080">+</font>x<font color="#000080">]+</font>Buffer<font color="#000080">[(</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">160</font><font color="#000080">+(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)]+
                     </font>Buffer<font color="#000080">[(</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">160</font><font color="#000080">+(</font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)]+</font>Buffer<font color="#000080">[</font>Y<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">+</font>x<font color="#000080">]) </font><font color="#FF0000"><b>Shr </b></font><font color="#800000">2</font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>ColorVal <font color="#000080">&gt; </font><font color="#800000">0
          </font><font color="#FF0000"><b>Then </b></font>ColorVal <font color="#000080">:= </font>ColorVal <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
        </font>Buffer<font color="#000080">[</font>Y<font color="#000080">*</font><font color="#800000">160</font><font color="#000080">+</font>x<font color="#000080">] := </font>ColorVal<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CopyFire<font color="#000080">;
</font><font color="#008000"><i>{ Copy the fire buffer, using 2x2 squares }

</i></font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">,</font>y <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  For </b></font>y <font color="#000080">:= </font><font color="#800000">197 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
    For </b></font>x <font color="#000080">:= </font><font color="#800000">319 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
      </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+</font>x<font color="#000080">] := </font>Buffer<font color="#000080">[(</font>y <font color="#FF0000"><b>Shr </b></font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">160</font><font color="#000080">+(</font>x <font color="#FF0000"><b>Shr </b></font><font color="#800000">1</font><font color="#000080">)];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetPalette<font color="#000080">;
</font><font color="#008000"><i>{ Set a very basic fire palette }

</i></font><font color="#FF0000"><b>Var
 </b></font>x <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
 For </b></font>x <font color="#000080">:= </font><font color="#800000">255 </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
   Begin
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">] := </font>x<font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font>x <font color="#FF0000"><b>Div </b></font><font color="#800000">4</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font>x <font color="#FF0000"><b>Div </b></font><font color="#800000">12</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Begin
  Asm           </b></font><font color="#008000"><i>{ Sorry about the ASM, but it just sets the video mode }
    </i></font><font color="#FF00FF">Mov  ax,13h </font><font color="#008000"><i>{ Set video mode $13 }
    </i></font><font color="#FF00FF">Int  10h
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>Buffer<font color="#000080">, </font>Sizeof<font color="#000080">(</font>Buffer<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font>SetPalette<font color="#000080">;   </font><font color="#008000"><i>{ Set up a simple fire palette }
  </i></font><font color="#FF0000"><b>Repeat
    </b></font>SetBottom<font color="#000080">;
    </font>CalcFire<font color="#000080">;
    </font>CopyFire<font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">Mov  ax,3   </font><font color="#008000"><i>{ Return back to text mode }
    </i></font><font color="#FF00FF">Int  10h
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0202.PAS">Original</a><b>]</b></p></body>
</html>
