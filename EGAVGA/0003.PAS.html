<html>
<head><title> "EGA/VGA Bitmap FONTS" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;I need to Write some Pascal code For a PC that will allow Text mode
&gt;fonts to be changed (at least on PC's With VGA adapters).

&gt;Prof. Salmi's FAQ lists a book by Porter and Floyd, &quot;Stretching
&gt;Turbo Pascal&quot;, as having the relevant information, but my local
&gt;bookstore claims this is out of print.

You could try borrowing the book from the library.  For instance ours
will search For books; I rarely buy books.  STP:v5.5 was an exception.
Here is code (substantially based on Porter and Floyds' code) written
for version 5.x .  Actually, aside from this stuff, the book wasn't as
good as I thought it would be.  I believe Ken Porter died and parts of
the book seem missing.  This code, For instance, isn't well documented
in the book (althought I think its clear how to use it from these
Programs).

You know, after playing With this code I thought I knew it all :D
It turns out that there is a lot more you can do.  For instance, the
intensity bit can be used as an extra Character bit to allow
512-Character fonts.  I have an aging PC Magazine article (that I
haven't gotten around to playing with) that has some Asm code For the
EGA.  (I'm hoping the same code will work For the VGA).
}
{--[rounded.pas]--}

</i></font><font color="#FF0000"><b>Program
  </b></font>Rounded<font color="#000080">;
</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>BitFonts<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>matrix <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>URC <font color="#000080">: </font>matrix <font color="#000080">= (</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$C0</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$30</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">);
  </font>LLC <font color="#000080">: </font>matrix <font color="#000080">= (</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">);
  </font>LRC <font color="#000080">: </font>matrix <font color="#000080">= (</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$30</font><font color="#000080">,</font><font color="#800000">$70</font><font color="#000080">,</font><font color="#800000">$C0</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">);
  </font>ULC <font color="#000080">: </font>matrix <font color="#000080">= (</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$00</font><font color="#000080">,</font><font color="#800000">$03</font><font color="#000080">,</font><font color="#800000">$0E</font><font color="#000080">,</font><font color="#800000">$0C</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">,</font><font color="#800000">$18</font><font color="#000080">);
</font><font color="#008000"><i>{  ULC : matrix = ($00,$00,$00,$00,$00,$03,$0E,$19,$33,$36,$36,$36,$36,$36,$36,$36);}
</i></font><font color="#FF0000"><b>Var
  </b></font>index<font color="#000080">,</font>b      <font color="#000080">: </font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>package      </b></font><font color="#000080">: </font>fontPackagePtr<font color="#000080">;
  </font>FontFile     <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>FontPackage<font color="#000080">;
  </font>EntryFont    <font color="#000080">: </font>ROMfont<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>TextBox<font color="#000080">( </font>left<font color="#000080">, </font>top<font color="#000080">, </font>right<font color="#000080">, </font>bottom<font color="#000080">, </font>style <font color="#000080">: </font>Integer <font color="#000080">);
    </font><font color="#FF0000"><b>Const
      </b></font>bord <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= ( ( </font><font color="#800000">#196</font><font color="#000080">,</font><font color="#800000">#179</font><font color="#000080">,</font><font color="#800000">#218</font><font color="#000080">,</font><font color="#800000">#191</font><font color="#000080">,</font><font color="#800000">#217</font><font color="#000080">,</font><font color="#800000">#192 </font><font color="#000080">),
                                          ( </font><font color="#800000">#205</font><font color="#000080">,</font><font color="#800000">#186</font><font color="#000080">,</font><font color="#800000">#201</font><font color="#000080">,</font><font color="#800000">#187</font><font color="#000080">,</font><font color="#800000">#188</font><font color="#000080">,</font><font color="#800000">#200 </font><font color="#000080">));
    </font><font color="#FF0000"><b>Var </b></font>P<font color="#000080">:</font>Integer<font color="#000080">;

    </font><font color="#FF0000"><b>begin
      if </b></font>Style <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">; </font><font color="#008000"><i>{ what the fuck is this For ? }

      { verify coordinates are in ( NW,SE ) corner }
      </i></font><font color="#FF0000"><b>if </b></font>left <font color="#000080">&gt; </font>right <font color="#FF0000"><b>then
        begin
          </b></font>p <font color="#000080">:= </font>left<font color="#000080">; </font>left <font color="#000080">:= </font>right<font color="#000080">; </font>right <font color="#000080">:= </font>p<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>bottom <font color="#000080">&lt; </font>top <font color="#FF0000"><b>then
        begin
          </b></font>p <font color="#000080">:= </font>top<font color="#000080">; </font>top <font color="#000080">:= </font>bottom<font color="#000080">; </font>bottom <font color="#000080">:= </font>p<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font><font color="#008000"><i>{ draw top }
      </i></font>GotoXY<font color="#000080">( </font>left<font color="#000080">,</font>top <font color="#000080">);
      </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] );
      </font><font color="#FF0000"><b>For </b></font>p <font color="#000080">:= </font>left<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>right<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        </b></font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]);
      </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] );

      </font><font color="#008000"><i>{ draw bottomm }
      </i></font>GotoXY<font color="#000080">( </font>left<font color="#000080">,</font>bottom <font color="#000080">);
      </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">]);
      </font><font color="#FF0000"><b>For </b></font>p <font color="#000080">:= </font>left<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>right<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        </b></font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">]);
      </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">]);

      </font><font color="#008000"><i>{ draw sides }
      </i></font><font color="#FF0000"><b>For </b></font>p <font color="#000080">:= </font>top<font color="#000080">+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>bottom<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
          </b></font>GotoXY<font color="#000080">( </font>left<font color="#000080">,</font>p <font color="#000080">);
          </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] );
          </font>GotoXY<font color="#000080">( </font>right<font color="#000080">,</font>p <font color="#000080">);
          </font>Write<font color="#000080">( </font>bord<font color="#000080">[</font>style<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] );
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Procedure TextBox }

  </i></font><font color="#FF0000"><b>Procedure </b></font>replace<font color="#000080">( </font>ASCII<font color="#000080">:</font>Word<font color="#000080">; </font>newChar<font color="#000080">:</font>matrix <font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>offset<font color="#000080">,</font>b<font color="#000080">:</font>Word<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>offset <font color="#000080">:= </font>ASCII <font color="#000080">* </font>VDA<font color="#000080">.</font>points<font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>b <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>VDA<font color="#000080">.</font>points<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        package</b></font><font color="#000080">^.</font>ch<font color="#000080">[</font>offset<font color="#000080">+</font>b<font color="#000080">] := </font>newChar<font color="#000080">[</font>b<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if not </b></font>isEGA <font color="#FF0000"><b>then
    begin
      </b></font>Writeln<font color="#000080">( </font><font color="#800000">'You can only run this Program on EGA or VGA systems' </font><font color="#000080">);
      </font>halt<font color="#000080">( </font><font color="#800000">1 </font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{- fetch copy of entry font -}
  </i></font>EntryFont <font color="#000080">:= </font>CurrentFont<font color="#000080">;
  </font><font color="#FF0000"><b>Package </b></font><font color="#000080">:= </font>FetchHardwareFont<font color="#000080">( </font>CurrentFont <font color="#000080">);

  </font><font color="#008000"><i>{- replace the corner Characters -}
  </i></font>replace<font color="#000080">( </font><font color="#800000">191</font><font color="#000080">,</font>URC <font color="#000080">);
  </font>replace<font color="#000080">( </font><font color="#800000">192</font><font color="#000080">,</font>LLC <font color="#000080">);
  </font>replace<font color="#000080">( </font><font color="#800000">217</font><font color="#000080">,</font>LRC <font color="#000080">);
  </font>replace<font color="#000080">( </font><font color="#800000">218</font><font color="#000080">,</font>ULC <font color="#000080">);

  </font><font color="#008000"><i>{- load and active user-modified font -}
  </i></font>Sound<font color="#000080">( </font><font color="#800000">1000 </font><font color="#000080">);
  </font>LoadUserFont<font color="#000080">( </font><font color="#FF0000"><b>package </b></font><font color="#000080">);
  </font>NoSound<font color="#000080">;

  </font><font color="#008000"><i>{- Draw a Text box -}
  </i></font>ClrScr<font color="#000080">;
</font><font color="#008000"><i>{  CursorOff; }
  </i></font>TextBox<font color="#000080">( </font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">1 </font><font color="#000080">);
  </font>GotoXY<font color="#000080">( </font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">12 </font><font color="#000080">); </font>Write<font color="#000080">( </font><font color="#800000">'rounded corners' </font><font color="#000080">);
</font><font color="#008000"><i>{  WaitForKey;}
  </i></font>readln<font color="#000080">;

  </font><font color="#008000"><i>{- save user-modified font to File -}
  </i></font>assign<font color="#000080">( </font>FontFile<font color="#000080">, </font><font color="#800000">'HELLO' </font><font color="#000080">);
  </font>reWrite<font color="#000080">( </font>FontFile <font color="#000080">);
  </font>Write<font color="#000080">( </font>FontFile<font color="#000080">,</font><font color="#FF0000"><b>Package</b></font><font color="#000080">^ );
  </font>close<font color="#000080">( </font>FontFile <font color="#000080">);

  </font><font color="#008000"><i>{- clear and quit -}
  </i></font>SetHardWareFont<font color="#000080">( </font>EntryFont <font color="#000080">);
  </font>ClrScr<font color="#000080">;
</font><font color="#008000"><i>{  CursorOn;}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{--[editfnt2.pas]--}

</i></font><font color="#FF0000"><b>Program </b></font>EditFont<font color="#000080">;

</font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">, </font>BitFonts<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>Block <font color="#000080">= </font><font color="#800000">#220</font><font color="#000080">;
  </font>Esc <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>c<font color="#000080">,
  </font>Choice <font color="#000080">: </font>Char<font color="#000080">;
  </font>EditDone<font color="#000080">,
  </font>Done<font color="#000080">,
  </font>Valid  <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Font   <font color="#000080">: </font>ROMfont<font color="#000080">;
  </font><font color="#FF0000"><b>package </b></font><font color="#000080">: </font>FontPackagePtr<font color="#000080">;
  </font>fout <font color="#000080">: </font><font color="#FF0000"><b>File of </b></font>FontPackage<font color="#000080">;
  </font>foutfil <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>UpperCase<font color="#000080">( </font>s<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">:</font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">( </font>s <font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>s<font color="#000080">[</font>i<font color="#000080">] := </font>UpCase<font color="#000080">( </font>s<font color="#000080">[</font>i<font color="#000080">] );
    </font>UpperCase <font color="#000080">:= </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>HexByte<font color="#000080">( </font>b<font color="#000080">:</font>Byte <font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Const </b></font>DIGIT <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>HexByte <font color="#000080">:= </font>Digit<font color="#000080">[</font>b <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">] + </font>Digit<font color="#000080">[</font>b <font color="#FF0000"><b>and </b></font><font color="#800000">$0F</font><font color="#000080">];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ByteBin<font color="#000080">( </font><font color="#FF0000"><b>Var </b></font>bs<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">):</font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>Const </b></font>DIGIT <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
  </font><font color="#FF0000"><b>Var </b></font>i<font color="#000080">,</font>b<font color="#000080">:</font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>b <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">( </font>bs <font color="#000080">) </font><font color="#FF0000"><b>do
      if </b></font>bs<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'1' </font><font color="#FF0000"><b>then
        </b></font>b <font color="#000080">:= </font>b <font color="#000080">+ </font><font color="#800000">2 </font><font color="#FF0000"><b>SHL </b></font><font color="#000080">(</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>bs<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'1' </font><font color="#FF0000"><b>then
      </b></font>b <font color="#000080">:= </font>b <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>ByteBin <font color="#000080">:= </font>b<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Browse<font color="#000080">( </font>Font<font color="#000080">:</font>ROMfont <font color="#000080">);

</font><font color="#008000"><i>{
    arrow keys to manuever
    Esc to accept
    Enter or space to toggle bit
    C or c to clear a row
    alt-C or ctl-C to clear whole Char

}
  </i></font><font color="#FF0000"><b>Const
    </b></font>MapRow <font color="#000080">= </font><font color="#800000">' - - - - - - - - '</font><font color="#000080">;
    </font>MapTop <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;

  </font><font color="#FF0000"><b>Var
    </b></font>ASCII<font color="#000080">,
    </font>row<font color="#000080">,
    </font>col<font color="#000080">,
    </font>index<font color="#000080">,
    </font>bit   <font color="#000080">: </font>Word<font color="#000080">;
    </font>f     <font color="#000080">: </font>Char_table<font color="#000080">;
    </font>s     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>error <font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Procedure </b></font>putChar<font color="#000080">( </font>value<font color="#000080">:</font>Word <font color="#000080">);
    </font><font color="#FF0000"><b>Var </b></font>reg<font color="#000080">:</font>Registers<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0A</font><font color="#000080">;
      </font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font>Byte<font color="#000080">( </font>value <font color="#000080">);
      </font>reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>reg<font color="#000080">.</font>BL <font color="#000080">:= </font>LightGray<font color="#000080">;
      </font>reg<font color="#000080">.</font>CX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
      </font>intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">,</font>reg <font color="#000080">);
      </font>GotoXY<font color="#000080">( </font>WhereX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>WhereY <font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ proc putChar }

  </i></font><font color="#FF0000"><b>begin
    </b></font>GetMem<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">, </font>SizeOf<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^ ));
    </font>ClrScr<font color="#000080">;
    </font><font color="#FF0000"><b>Package </b></font><font color="#000080">:= </font>FetchHardwareFont<font color="#000080">( </font>Font <font color="#000080">);
    </font><font color="#FF0000"><b>Repeat
      </b></font>GotoXY<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1 </font><font color="#000080">);
      </font>Write<font color="#000080">( </font><font color="#800000">'FONT: ' </font><font color="#000080">);
      </font><font color="#FF0000"><b>Case </b></font>Font <font color="#FF0000"><b>of
        </b></font>ROM8x8  <font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'8 x 8' </font><font color="#000080">);
        </font>ROM8x14 <font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'8 x 14' </font><font color="#000080">);
        </font>ROM8x16 <font color="#000080">: </font>Writeln<font color="#000080">( </font><font color="#800000">'8 x 16' </font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Writeln<font color="#000080">;
      </font>clreol<font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">'ASCII value to examine? (or QUIT to quit) ' </font><font color="#000080">);
      </font>readln<font color="#000080">( </font>s <font color="#000080">);
      </font>Val<font color="#000080">( </font>s<font color="#000080">,</font>ASCII<font color="#000080">,</font>error <font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>error <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        if </b></font>UpperCase<font color="#000080">( </font>s <font color="#000080">) = </font><font color="#800000">'QUIT' </font><font color="#FF0000"><b>then
          </b></font>Done <font color="#000080">:= </font>True
        <font color="#FF0000"><b>else
          </b></font>ASCII <font color="#000080">:= </font>Byte<font color="#000080">( </font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] );

      </font><font color="#008000"><i>{ show the Character image }
      </i></font>clreol<font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">'(Image For ASCII '</font><font color="#000080">,</font>ASCII<font color="#000080">,</font><font color="#800000">' is ' </font><font color="#000080">);
      </font>putChar<font color="#000080">( </font>ASCII <font color="#000080">);
      </font>Writeln<font color="#000080">( </font><font color="#800000">')' </font><font color="#000080">);

      </font><font color="#008000"><i>{ display blank bitmap }
      </i></font>GotoXY<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font>MapTop <font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>row <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points <font color="#FF0000"><b>do
        </b></font>Writeln<font color="#000080">( </font>maprow <font color="#000080">);

      </font><font color="#008000"><i>{ explode the image bitmap }
      </i></font>index <font color="#000080">:= </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points <font color="#000080">* </font>ASCII<font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>row <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
        begin
          For </b></font>bit <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
            if </b></font><font color="#000080">(( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font>bit <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
              begin
                </b></font>col <font color="#000080">:= ( </font><font color="#800000">8 </font><font color="#000080">- </font>bit <font color="#000080">) * </font><font color="#800000">2</font><font color="#000080">;
                </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row<font color="#000080">+</font>MapTop <font color="#000080">);
                </font>Write<font color="#000080">( </font>block <font color="#000080">);
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font>GotoXY<font color="#000080">( </font><font color="#800000">20</font><font color="#000080">,</font>row<font color="#000080">+</font>MapTop <font color="#000080">);
          </font>Write<font color="#000080">( </font>hexByte<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] )+ </font><font color="#800000">'h' </font><font color="#000080">);
          </font>inc<font color="#000080">( </font>index <font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


      </font><font color="#008000"><i>{ edit font }
      </i></font>col <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
      </font>row <font color="#000080">:= </font>MapTop<font color="#000080">;
      </font>EditDone <font color="#000080">:= </font>False<font color="#000080">;
      </font>index <font color="#000080">:= </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points <font color="#000080">* </font>ASCII<font color="#000080">;

      </font><font color="#FF0000"><b>While </b></font><font color="#000080">( </font><font color="#FF0000"><b>not </b></font>Done <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font><font color="#FF0000"><b>not </b></font>EditDone <font color="#000080">) </font><font color="#FF0000"><b>do
        begin
          </b></font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
          </font>c <font color="#000080">:= </font>ReadKey<font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">#0 </font><font color="#FF0000"><b>then
            </b></font>c <font color="#000080">:= </font>ReadKey<font color="#000080">;

          </font><font color="#FF0000"><b>Case </b></font>c <font color="#FF0000"><b>of

            </b></font><font color="#800000">#03</font><font color="#000080">,         </font><font color="#008000"><i>{ wipe entire letter }
            </i></font><font color="#800000">#46 </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                    </b></font>index <font color="#000080">:= </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points <font color="#000080">* </font>ASCII<font color="#000080">;
                    </font><font color="#FF0000"><b>For </b></font>row <font color="#000080">:= </font>MapTop <font color="#FF0000"><b>to </b></font>MapTop<font color="#000080">+</font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
                      begin
                        Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
                        </font>col <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                        </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
                        </font>Write<font color="#000080">( </font><font color="#800000">'- - - - - - -' </font><font color="#000080">);
                        </font>GotoXY<font color="#000080">( </font><font color="#800000">20</font><font color="#000080">,</font>row <font color="#000080">);
                        </font>Write<font color="#000080">( </font>hexByte<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] )+ </font><font color="#800000">'h' </font><font color="#000080">);
                        </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
                        </font>inc<font color="#000080">( </font>index <font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#800000">'C'</font><font color="#000080">,         </font><font color="#008000"><i>{ wipe row }
            </i></font><font color="#800000">'c' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                    Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
                    </font>col <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
                    </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
                    </font>Write<font color="#000080">( </font><font color="#800000">'- - - - - - -' </font><font color="#000080">);
                    </font>GotoXY<font color="#000080">( </font><font color="#800000">20</font><font color="#000080">,</font>row <font color="#000080">);
                    </font>Write<font color="#000080">( </font>hexByte<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] )+ </font><font color="#800000">'h' </font><font color="#000080">);
                    </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


            </font><font color="#800000">#27 </font><font color="#000080">: </font>EditDone <font color="#000080">:= </font>True<font color="#000080">;  </font><font color="#008000"><i>{ esc }

            </i></font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ up }
                    </i></font><font color="#FF0000"><b>if </b></font>row <font color="#000080">&gt;  </font>MapTop <font color="#FF0000"><b>then
                      begin
                        </b></font>dec<font color="#000080">( </font>row <font color="#000080">);
                        </font>dec<font color="#000080">( </font>index <font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ down }
                    </i></font><font color="#FF0000"><b>if </b></font>row <font color="#000080">&lt; ( </font>MapTop <font color="#000080">+ </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points <font color="#000080">- </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>then
                      begin
                        </b></font>inc<font color="#000080">( </font>row <font color="#000080">);
                        </font>inc<font color="#000080">( </font>index <font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#800000">#77 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ right }
                    </i></font><font color="#FF0000"><b>if </b></font>col <font color="#000080">&lt; </font><font color="#800000">16 </font><font color="#FF0000"><b>then
                      </b></font>inc<font color="#000080">( </font>col<font color="#000080">,</font><font color="#800000">2 </font><font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#800000">#75 </font><font color="#000080">: </font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ left }
                    </i></font><font color="#FF0000"><b>if </b></font>col <font color="#000080">&gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
                      </b></font>dec<font color="#000080">( </font>col<font color="#000080">,</font><font color="#800000">2 </font><font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

            </font><font color="#800000">#13</font><font color="#000080">,
            </font><font color="#800000">#10</font><font color="#000080">,
            </font><font color="#800000">' ' </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                    </b></font>bit <font color="#000080">:= </font><font color="#800000">8 </font><font color="#000080">- ( </font>col <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#000080">);
                    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] </font><font color="#FF0000"><b>SHR </b></font>bit <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
                      begin
                        Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] := ( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] ) </font><font color="#FF0000"><b>AND
                                               </b></font><font color="#000080">(</font><font color="#800000">$FF </font><font color="#FF0000"><b>xor </b></font><font color="#000080">( </font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font>bit <font color="#000080">));
                        </font>Write<font color="#000080">( </font><font color="#800000">'-' </font><font color="#000080">)
                      </font><font color="#FF0000"><b>end
                    else
                      begin
                        Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] := </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] </font><font color="#FF0000"><b>XOR
                                              </b></font><font color="#000080">( </font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font>bit <font color="#000080">);
                        </font>Write<font color="#000080">( </font>block <font color="#000080">);
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

                    </font>GotoXY<font color="#000080">( </font><font color="#800000">20</font><font color="#000080">,</font>row <font color="#000080">);
                    </font>Write<font color="#000080">( </font>hexByte<font color="#000080">( </font><font color="#FF0000"><b>Package</b></font><font color="#000080">^.</font>Ch<font color="#000080">[</font>index<font color="#000080">] )+ </font><font color="#800000">'h' </font><font color="#000080">);
                    </font>GotoXY<font color="#000080">( </font>col<font color="#000080">,</font>row <font color="#000080">);
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Case }

          </i></font>LoadUserFont<font color="#000080">( </font><font color="#FF0000"><b>Package </b></font><font color="#000080">);

        </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ While }

    </i></font><font color="#FF0000"><b>Until </b></font>Done<font color="#000080">;

    </font>GotoXY<font color="#000080">( </font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">7 </font><font color="#000080">);
    </font>Write<font color="#000080">( </font><font color="#800000">'Save to disk? (Y/n) '</font><font color="#000080">);
    </font><font color="#FF0000"><b>Repeat
      </b></font>c <font color="#000080">:= </font>UpCase<font color="#000080">( </font>ReadKey <font color="#000080">);
    </font><font color="#FF0000"><b>Until </b></font>c <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'Y'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">,</font><font color="#800000">#13</font><font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">#13 </font><font color="#FF0000"><b>then
      </b></font>c <font color="#000080">:= </font><font color="#800000">'Y'</font><font color="#000080">;
    </font>Write<font color="#000080">( </font>c <font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>c <font color="#000080">= </font><font color="#800000">'Y' </font><font color="#FF0000"><b>then
      begin
        </b></font>GotoXY<font color="#000080">( </font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">9 </font><font color="#000080">);
        </font>ClrEol<font color="#000080">;
        </font>Write<font color="#000080">( </font><font color="#800000">'Save as: '</font><font color="#000080">);
        </font>readln<font color="#000080">( </font>foutfil <font color="#000080">);

</font><font color="#008000"><i>(*        if fexist( foutfil ) then
          begin
            GotoXY( 40,7 );
            Write( 'OverWrite File ''',foutfil,''' (y/N) ');
            Repeat
              c := UpCase( ReadKey );
            Until c in ['Y','N',#13];
            if c = #13 then
              c := 'N';
            Write( c );
          end;
*)
        {$I-}
        </i></font>assign<font color="#000080">( </font>fout<font color="#000080">,</font>foutfil <font color="#000080">); </font>reWrite<font color="#000080">( </font>fout <font color="#000080">);
        </font>Write<font color="#000080">( </font>fout<font color="#000080">,</font><font color="#FF0000"><b>Package</b></font><font color="#000080">^ );
        </font>close<font color="#000080">( </font>fout <font color="#000080">);
        </font><font color="#008000"><i>{$I+}
        </i></font>GotoXY<font color="#000080">( </font><font color="#800000">40</font><font color="#000080">,</font><font color="#800000">11 </font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font>ioResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          </b></font>Writeln<font color="#000080">( </font><font color="#800000">'Write failed!' </font><font color="#000080">)
        </font><font color="#FF0000"><b>else
          </b></font>Writeln<font color="#000080">( </font><font color="#800000">'Wrote font to File '''</font><font color="#000080">,</font>foutfil<font color="#000080">,</font><font color="#800000">'''.' </font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ proc Browse }


</i></font><font color="#FF0000"><b>begin

  </b></font>Done <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#008000"><i>{ get font to view }
  </i></font><font color="#FF0000"><b>Repeat
    </b></font>Valid <font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>Repeat
      </b></font>ClrScr<font color="#000080">;
      </font>Writeln<font color="#000080">( </font><font color="#800000">'Fonts available For examination: ' </font><font color="#000080">);
      </font>Writeln<font color="#000080">( </font><font color="#800000">'    1. 8 x 8' </font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>isEGA <font color="#FF0000"><b>then

        </b></font>Writeln<font color="#000080">( </font><font color="#800000">'    2. 8 x 14' </font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>isVGA <font color="#FF0000"><b>then
        </b></font>Writeln<font color="#000080">( </font><font color="#800000">'    3. 8 x 16' </font><font color="#000080">);
      </font>Writeln<font color="#000080">;
      </font>Write<font color="#000080">( </font><font color="#800000">'    Select by number (or Esc to quit) ' </font><font color="#000080">);
      </font>choice <font color="#000080">:= </font>ReadKey<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Choice <font color="#000080">= </font>Esc <font color="#FF0000"><b>then
        begin
          </b></font>ClrScr<font color="#000080">;
          </font>Exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Choice <font color="#000080">= </font><font color="#800000">'1' </font><font color="#FF0000"><b>then </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>choice <font color="#000080">= </font><font color="#800000">'2' </font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>isEGA <font color="#FF0000"><b>then </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>Choice <font color="#000080">= </font><font color="#800000">'3' </font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>isVGA <font color="#FF0000"><b>then </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>Until </b></font>Valid<font color="#000080">;

    </font><font color="#008000"><i>{ fetch and display selected font }
    </i></font><font color="#FF0000"><b>Case </b></font>choice <font color="#FF0000"><b>of
      </b></font><font color="#800000">'1' </font><font color="#000080">: </font>Font <font color="#000080">:= </font>ROM8x8<font color="#000080">;
      </font><font color="#800000">'2' </font><font color="#000080">: </font>Font <font color="#000080">:= </font>ROM8x14<font color="#000080">;
      </font><font color="#800000">'3' </font><font color="#000080">: </font>Font <font color="#000080">:= </font>ROM8x16<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Browse<font color="#000080">( </font>font <font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>Done<font color="#000080">;
  </font>GotoXY<font color="#000080">( </font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">25 </font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">( </font><font color="#800000">'Thanks you For using EditFont which is based on code from' </font><font color="#000080">);
  </font>Writeln<font color="#000080">( </font><font color="#800000">'_Stretching Turbo Pascal_ by Kent Porter and Mike Floyd.' </font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">( </font><font color="#800000">'This Program was developed 12 Apr 92 by Alan D. Mead.' </font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{--[bitfonts.pas]--}


</i></font><font color="#FF0000"><b>Unit </b></font>BitFonts<font color="#000080">;
  </font><font color="#008000"><i>{ support For bit-mapped Text fonts on EGA/VGA }

</i></font><font color="#FF0000"><b>Interface

Type
              </b></font><font color="#008000"><i>{ enumeration of ROM hardware fonts }
  </i></font>ROMfont <font color="#000080">= ( </font>ROM8x14<font color="#000080">, </font>ROM8x8<font color="#000080">, </font>ROM8x16 <font color="#000080">);

              </font><font color="#008000"><i>{ Characetr definition table }
  </i></font>CharDefTable <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4095</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>CharDefPtr   <font color="#000080">= ^</font>CharDefTable<font color="#000080">;

              </font><font color="#008000"><i>{ For geting Text Character generators }
  </i></font>Char_table <font color="#000080">= </font><font color="#FF0000"><b>Record
                 </b></font>points <font color="#000080">: </font>Byte<font color="#000080">;       </font><font color="#008000"><i>{ Char matrix height }
                 </i></font>def    <font color="#000080">: </font>CharDefPtr<font color="#000080">; </font><font color="#008000"><i>{ address of table }
               </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

              </font><font color="#008000"><i>{ font format }
  </i></font>FontPackage <font color="#000080">= </font><font color="#FF0000"><b>Record
                  </b></font>FontInfo <font color="#000080">: </font>Char_Table<font color="#000080">;
                  </font>ch       <font color="#000080">: </font>CharDefTable<font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FontPackagePtr <font color="#000080">= ^</font>FontPackage<font color="#000080">;

              </font><font color="#008000"><i>{ table maintained by video ROM BIOS at 40h : 84h }
  </i></font>VideoDataArea <font color="#000080">= </font><font color="#FF0000"><b>Record
                    </b></font>rows   <font color="#000080">: </font>Byte<font color="#000080">;  </font><font color="#008000"><i>{ Text rows on screem - 1 }
                    </i></font>points <font color="#000080">: </font>Word<font color="#000080">;    </font><font color="#008000"><i>{ height of Char matrix }
                    </i></font>info<font color="#000080">,               </font><font color="#008000"><i>{ EGA/VGA status info }
                    </i></font>info_3<font color="#000080">,           </font><font color="#008000"><i>{ EGA/VGA configuration }
                    </i></font>flags  <font color="#000080">: </font>Word<font color="#000080">;               </font><font color="#008000"><i>{ misc flags }
                  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;           </font><font color="#008000"><i>{ remainder of table ignored }

              { globally visible }
</i></font><font color="#FF0000"><b>Var
  </b></font>VDA         <font color="#000080">: </font>VideoDataArea <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$84</font><font color="#000080">;   </font><font color="#008000"><i>{ equipment flags }
  </i></font>isEGA<font color="#000080">,
  </font>isVGA<font color="#000080">,
  </font>isColor     <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>CurrentFont <font color="#000080">: </font>ROMfont<font color="#000080">; </font><font color="#008000"><i>{ default hardware font }

</i></font><font color="#FF0000"><b>Procedure </b></font>GetCharGenInfo<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">:</font>Char_table <font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>SetHardWareFont<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont <font color="#000080">);
</font><font color="#FF0000"><b>Function </b></font>FetchHardwareFont<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont <font color="#000080">):</font>FontPackagePtr<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>LoadUserFont<font color="#000080">( </font>pkg<font color="#000080">:</font>FontPackagePtr <font color="#000080">);

</font><font color="#008000"><i>{ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - }

</i></font><font color="#FF0000"><b>Implementation

Uses </b></font>Dos<font color="#000080">, </font>Crt <font color="#008000"><i>{, TextScrn} </i></font><font color="#000080">;

</font><font color="#FF0000"><b>Var </b></font>reg<font color="#000080">:</font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetCharGenInfo<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>table<font color="#000080">:</font>Char_table <font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>isEGA <font color="#FF0000"><b>then
      begin
        </b></font>reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
        </font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$30</font><font color="#000080">;
        </font><font color="#FF0000"><b>Case </b></font>font <font color="#FF0000"><b>of
          </b></font>ROM8x8  <font color="#000080">: </font>reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
          </font>ROM8x14 <font color="#000080">: </font>reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
          </font>ROM8x16 <font color="#000080">: </font>reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">,</font>reg <font color="#000080">);
        </font>table<font color="#000080">.</font>def <font color="#000080">:= </font>ptr<font color="#000080">( </font>reg<font color="#000080">.</font>ES<font color="#000080">,</font>reg<font color="#000080">.</font>BP <font color="#000080">); </font><font color="#008000"><i>{ address of definition table }
        </i></font><font color="#FF0000"><b>Case </b></font>font <font color="#FF0000"><b>of
          </b></font>ROM8x8  <font color="#000080">: </font>table<font color="#000080">.</font>points <font color="#000080">:=  </font><font color="#800000">8</font><font color="#000080">;
          </font>ROM8x14 <font color="#000080">: </font>table<font color="#000080">.</font>points <font color="#000080">:= </font><font color="#800000">14</font><font color="#000080">;
          </font>ROM8x16 <font color="#000080">: </font>table<font color="#000080">.</font>points <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ proc GetCharGenInfo }


</i></font><font color="#FF0000"><b>Procedure </b></font>SetHardWareFont<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont <font color="#000080">);
  </font><font color="#FF0000"><b>begin
    if </b></font>isEGA <font color="#FF0000"><b>then
      begin
        Case </b></font>Font <font color="#FF0000"><b>of
          </b></font>ROM8x14 <font color="#000080">: </font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
          </font>ROM8x8  <font color="#000080">: </font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
          </font>ROM8X16 <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>isVGA <font color="#FF0000"><b>then
                      </b></font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$14
                    </font><font color="#FF0000"><b>else
                      begin
                        </b></font>reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
                        </font>font <font color="#000080">:= </font>ROM8x14<font color="#000080">;
                      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>reg<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
        </font>intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">,</font>reg <font color="#000080">);
        </font>CurrentFont <font color="#000080">:= </font>font<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ proc SetHardwareFont }


</i></font><font color="#FF0000"><b>Function </b></font>FetchHardwareFont<font color="#000080">( </font>font<font color="#000080">:</font>ROMfont <font color="#000080">):</font>FontPackagePtr<font color="#000080">;
  </font><font color="#008000"><i>{ Get a hardware font and place it on heap For user modification }
  </i></font><font color="#FF0000"><b>Var </b></font>pkg <font color="#000080">: </font>FontPackagePtr<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>new<font color="#000080">( </font>pkg <font color="#000080">);
    </font>GetCharGenInfo<font color="#000080">( </font>font<font color="#000080">,</font>pkg<font color="#000080">^.</font>fontinfo <font color="#000080">);
    </font>pkg<font color="#000080">^.</font>ch <font color="#000080">:= </font>pkg<font color="#000080">^.</font>fontinfo<font color="#000080">.</font>def<font color="#000080">^;
    </font>FetchHardwareFont <font color="#000080">:= </font>pkg<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ func FetchHardwareFont }


</i></font><font color="#FF0000"><b>Procedure </b></font>LoadUserFont<font color="#000080">( </font>pkg<font color="#000080">:</font>FontPackagePtr <font color="#000080">);
  </font><font color="#FF0000"><b>begin
    </b></font>reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
    </font>reg<font color="#000080">.</font>ES <font color="#000080">:= </font>seg<font color="#000080">( </font>pkg<font color="#000080">^.</font>ch <font color="#000080">);
    </font>reg<font color="#000080">.</font>BP <font color="#000080">:= </font>ofs<font color="#000080">( </font>pkg<font color="#000080">^.</font>ch <font color="#000080">);
    </font>reg<font color="#000080">.</font>BH <font color="#000080">:= </font>pkg<font color="#000080">^.</font>FontInfo<font color="#000080">.</font>points<font color="#000080">;
    </font>reg<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>reg<font color="#000080">.</font>CX <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font>reg<font color="#000080">.</font>DX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">,</font>reg <font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ proc LoadUserFont }


</i></font><font color="#FF0000"><b>begin  </b></font><font color="#008000"><i>{ initialize }

  { determine adapter Type }
  </i></font>isEGA <font color="#000080">:= </font>False<font color="#000080">;
  </font>isVGA <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>VDA<font color="#000080">.</font>info <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>isEGA <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">( </font>VDA<font color="#000080">.</font>flags <font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
        </b></font>isVGA <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ determine monitor Type }
  </i></font><font color="#FF0000"><b>if </b></font>isEGA <font color="#FF0000"><b>then
    begin
      </b></font>reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
      </font>reg<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
      </font>intr<font color="#000080">( </font><font color="#800000">$10</font><font color="#000080">,</font>reg <font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>reg<font color="#000080">.</font>BH <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>isCOLOR <font color="#000080">:= </font>True
      <font color="#FF0000"><b>else
        </b></font>isCOLOR <font color="#000080">:= </font>False<font color="#000080">;
                                   </font><font color="#008000"><i>{ ADM: this seems Really shaky! }
      { determine current font }
      </i></font><font color="#FF0000"><b>if </b></font>isVGA <font color="#FF0000"><b>and </b></font><font color="#000080">( </font>VDA<font color="#000080">.</font>rows <font color="#000080">= </font><font color="#800000">24 </font><font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font>CurrentFont <font color="#000080">:= </font>ROM8x16
      <font color="#FF0000"><b>else
        if </b></font>isEGA <font color="#FF0000"><b>and </b></font><font color="#000080">( </font>VDA<font color="#000080">.</font>rows <font color="#000080">= </font><font color="#800000">24 </font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>CurrentFont <font color="#000080">:= </font>ROM8x14
        <font color="#FF0000"><b>else
          </b></font>CurrentFont <font color="#000080">:= </font>ROM8x8<font color="#000080">;
    </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0003.PAS">Original</a><b>]</b></p></body>
</html>
