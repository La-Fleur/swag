<html>
<head><title> "EGA/VGA Bitplanes" by JAN DOGGEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Attention: All those who are familiar with graphics ports
&gt; (ie. Sean Palmer, Jan Doggen, and others I don't yet know).

Don't consider myself that familiar with 'em, but here are some
snippets and remarks. BTW I consider phasing out all BGI stuff in my
code in the first half of '93 or so, which will be a major effort.
After that, I'll rank myself among the register-twiddlers. Maybe we
should team up on this project if you plan on going in that direction
too.

&gt; Would you mind explaining the EGA map mask (?) and
&gt; sequencer (?) register ports (I don't know what they are
&gt; *really* called, but they are the ones that control which
&gt; bitplane gets written to in EGA mode
&gt; 640x350x16, 4 bitplanes) to me (please)?

There are several write modes and read modes for EGA/VGA, and the
exact workings of the registers depend on the mode. What you are
talking about (I assume) is read/write mode 0 which you would use
to pump bytes directly into a bit plane. I use the following
procedure for this:


(*************************** EGA/VGA bit planes ****************************)
}

</i></font><font color="#FF0000"><b>CONST
  </b></font>GDCIndexReg <font color="#000080">= </font><font color="#800000">$3CE</font><font color="#000080">;  </font><font color="#008000"><i>{ Index register of EGA/VGA Graphics Device Controller }
  </i></font>GDCDataReg  <font color="#000080">= </font><font color="#800000">$3CF</font><font color="#000080">;  </font><font color="#008000"><i>{ Data  register of EGA/VGA Graphics Device Controller }
  </i></font>SeqIndexReg <font color="#000080">= </font><font color="#800000">$3C4</font><font color="#000080">;  </font><font color="#008000"><i>{ Index register of EGA/VGA Sequencer }
  </i></font>SeqDataReg  <font color="#000080">= </font><font color="#800000">$3C5</font><font color="#000080">;  </font><font color="#008000"><i>{ Data  register of EGA/VGA Sequencer }

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>PrepareBitPlaneRead<font color="#000080">(</font>Plane<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Mode register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: 0: read mode 0 }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Read Map Select register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font>Plane<font color="#000080">;       </font><font color="#008000"><i>{ Value of register: bit for plane to
read }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ PrepareBitPlaneRead }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ConcludeBitPlaneRead<font color="#000080">(</font>Plane<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Mode register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">$10</font><font color="#000080">;         </font><font color="#008000"><i>{ Value of register: 10: default for
modes 10h and 12h }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Read Map Select register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: plane to read }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ConcludeBitPlaneRead }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>PrepareBitPlaneWrite<font color="#000080">(</font>Plane<font color="#000080">,</font>PutMode<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Mode register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: 0: write mode 0 }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Enable Set/Reset register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: 0 }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">3</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Data Rotate/Function Select
register }
   (* Bits 3 and 4 from the Rotate/Function Select register mean:
    *          Bit 4  Bit 3   Replacement function:
    *            0      0           Replace
    *            0      1           AND
    *            1      0           OR
    *            1      1           XOR    *)
    </i></font><font color="#FF0000"><b>CASE </b></font>PutMode <font color="#FF0000"><b>OF
      </b></font>AndPut <font color="#000080">: </font>Port<font color="#000080">[</font>GDCDataReg<font color="#000080">] :=  </font><font color="#800000">8</font><font color="#000080">;   </font><font color="#008000"><i>{ No rotation; AND with buffer }
      </i></font>OrPut  <font color="#000080">: </font>Port<font color="#000080">[</font>GDCDataReg<font color="#000080">] := </font><font color="#800000">16</font><font color="#000080">;   </font><font color="#008000"><i>{ No rotation; OR  with buffer }
      </i></font>XORPut <font color="#000080">: </font>Port<font color="#000080">[</font>GDCDataReg<font color="#000080">] := </font><font color="#800000">24    </font><font color="#008000"><i>{ No rotation; XOR with buffer }
    </i></font><font color="#FF0000"><b>ELSE
      </b></font>Port<font color="#000080">[</font>GDCDataReg<font color="#000080">] :=  </font><font color="#800000">0</font><font color="#000080">;    </font><font color="#008000"><i>{ No rotation; replace; use this as default }
    </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ CASE }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">8</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of BitMask register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">$FF</font><font color="#000080">;         </font><font color="#008000"><i>{ Value of register: $FF: use all bits }
    </i></font>Port<font color="#000080">[</font>SeqIndexReg<font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Map Mask register }
    </i></font>Port<font color="#000080">[</font>SeqDataReg <font color="#000080">] := </font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font>Plane<font color="#000080">; </font><font color="#008000"><i>{ Value of register: plane number }
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ PrepareBitPlaneWrite }


</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ConcludeBitPlaneWrite<font color="#000080">(</font>Plane<font color="#000080">: </font>Byte<font color="#000080">);
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Enable Set/Reset register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: 0 }
    </i></font>Port<font color="#000080">[</font>SeqIndexReg<font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Map Mask register }
    </i></font>Port<font color="#000080">[</font>SeqDataReg <font color="#000080">] := </font><font color="#800000">$0F</font><font color="#000080">;         </font><font color="#008000"><i>{ Value of register: Enable all planes }
    </i></font>Port<font color="#000080">[</font>GDCIndexReg<font color="#000080">] := </font><font color="#800000">3</font><font color="#000080">;           </font><font color="#008000"><i>{ Number of Data Rotate/Function Select
register }
    </i></font>Port<font color="#000080">[</font>GDCDataReg <font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;           </font><font color="#008000"><i>{ Value of register: No rotation; replace
}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ ConcludeBitPlaneWrite }

{
A good explanation can be found in:
  Wilton,R - Programmers' guide to PC and PS/2 video systems
  Microsoft Press

You should invest in some books on EGA/VGA programming if you have
more of these questions, otherwise you're being 'penny wise, pound
foolish'.

The book by Wilton is considered more or less a 'must have' together
with
  Ferraro, R.F. - Programmer's guide to the EGA and VGA cards
  Addison-Wesley

Ferraro gives you detailed register info. It also deals with Super
VGAs. Because I'll have to expand a program to use VESA super VGA
modes, I bought this together with:
  Rimmer, S - Super VGA graphics programming secrets
  WindCrest/McGraw Hill
}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0079.PAS">Original</a><b>]</b></p></body>
</html>
