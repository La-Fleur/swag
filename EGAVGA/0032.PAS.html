<html>
<head><title> "Set Graphics Page" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 Hi..  I am trying to do animation by flipping the two images between
 the video pages, but I keep getting lines at the bottom of my screen,
 and my screen color changes..  What's up here?
 Did you synchronize to the {vertical|horizontal retrace beFore
 flipping? I don't know how to do this, so any helpfull code from you will
 be appreciated. I took this out of my ANIVGA-Unit:

At the very beginning of your Program, detect the address of the proper port
(StatusReg is a global Word Variable):
}

 </i></font><font color="#FF0000"><b>Asm  </b></font><font color="#008000"><i>{check whether we are running on a monochrome or color monitor}
   </i></font><font color="#FF00FF">MOV DX,3CCh  </font><font color="#008000"><i>{ask Output-register:}
   </i></font><font color="#FF00FF">in AL,DX
   TEST AL,1    </font><font color="#008000"><i>{is it a color monitor?}
   </i></font><font color="#FF00FF">MOV DX,3D4h
   JNZ @L1      </font><font color="#008000"><i>{yes}
   </i></font><font color="#FF00FF">MOV DX,3B4h  </font><font color="#008000"><i>{no }
  </i></font><font color="#FF00FF">@L1:          </font><font color="#008000"><i>{DX=3B4h/3D4h = CrtAddress-register For monochrome/color}
{ MOV CrtAddress,DX  not needed For this purpose}
   </i></font><font color="#FF00FF">ADD DX,6     </font><font color="#008000"><i>{DX=3BAh/3DAh = Status-register For monochrome/color}
   </i></font><font color="#FF00FF">MOV StatusReg,DX
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{of Asm}

{
Later on, when you want to switch pages:

   CLI {time critical routine: do not disturb!}
    </i></font>mov dx<font color="#000080">,</font>StatusReg
  <font color="#000080">@</font>WaitnotVSyncLoop<font color="#000080">:
    </font><font color="#FF0000"><b>in   </b></font>al<font color="#000080">,</font>dx
    <font color="#FF0000"><b>and  </b></font>al<font color="#000080">,</font><font color="#800000">8
    </font>jnz  <font color="#000080">@</font>WaitnotVSyncLoop
  <font color="#000080">@</font>WaitVSyncLoop<font color="#000080">:
    </font><font color="#FF0000"><b>in   </b></font>al<font color="#000080">,</font>dx
    <font color="#FF0000"><b>and  </b></font>al<font color="#000080">,</font><font color="#800000">8
    </font>jz   <font color="#000080">@</font>WaitVSyncLoop
<font color="#008000"><i>{
    HERE! SWITCH PAGES NOW!!! IMMEDIATELY! do not USE BIOS-inTS or OTHER
    TIME-WASTERS!
}
   </i></font>STI
<font color="#008000"><i>{
Well, that's all there is... if you replace the 2 &quot;and al,8&quot; against &quot;and al,1&quot;
and exchange jnz&lt;-&gt;jz, you are syncronizing at the horizontal retrace. But this
signal is extremely short (at least Compared With the vertical retr.).
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0032.PAS">Original</a><b>]</b></p></body>
</html>
