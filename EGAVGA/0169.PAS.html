<html>
<head><title> "Neat Wavey VGA Scoller" by JEROEN BOUWENS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Hmmm, this is a small, but neat routine. Really something to post. I hope you
like it. Made by Jeroen Bouwens, Holland. This routine is PD, Freeware and
Smileware, which means bla..blabla...blablabla. Got it? See ya! :-)

O Yeah, I nearly forgot. It is a perspective scroller that comes right at you.
}
</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>I<font color="#000080">,</font>J<font color="#000080">,</font>XS<font color="#000080">,</font>YS<font color="#000080">,</font>TL<font color="#000080">,</font>EP<font color="#000080">,</font>AD<font color="#000080">,</font>XT<font color="#000080">,</font>YT<font color="#000080">,</font>ZY         <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Alpha<font color="#000080">,</font>Beta<font color="#000080">,</font>Gamma<font color="#000080">,</font>G<font color="#000080">,</font>Tel              <font color="#000080">: </font>Integer<font color="#000080">;
  </font>XX<font color="#000080">,</font>YY<font color="#000080">,</font>ZZ<font color="#000080">,</font>BX<font color="#000080">,</font>BY                      <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Exists                              <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Tof<font color="#000080">,</font>TSeg<font color="#000080">,</font>SL<font color="#000080">,</font>ArrayTel<font color="#000080">,</font>Lof            <font color="#000080">: </font>Word<font color="#000080">;
  </font>VX<font color="#000080">,</font>VY<font color="#000080">,</font>VZ                            <font color="#000080">: </font>Real<font color="#000080">;
  </font>XT1<font color="#000080">,</font>YT1<font color="#000080">,</font>ZT1                         <font color="#000080">: </font>Real<font color="#000080">;
  </font>Offsets                             <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">160</font><font color="#000080">*</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Word<font color="#000080">;
  </font>Colors                              <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">160</font><font color="#000080">*</font><font color="#800000">50</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;
  </font>Cosinus<font color="#000080">,</font>Sinus                       <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">360</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Real<font color="#000080">;
  </font>Tekst                               <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Rotate<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Z<font color="#000080">:</font>Real<font color="#000080">;</font>Alpha<font color="#000080">,</font>Beta<font color="#000080">,</font>Gamma<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>Z1<font color="#000080">,</font>Z2 <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>X1<font color="#000080">:=</font>X<font color="#000080">;
  </font>Y1<font color="#000080">:=</font>Cosinus<font color="#000080">[</font>Alpha<font color="#000080">]*</font>Y<font color="#000080">-</font>Sinus<font color="#000080">[</font>Alpha<font color="#000080">]*</font>Z<font color="#000080">;
  </font>Z1<font color="#000080">:=</font>Sinus<font color="#000080">[</font>Alpha<font color="#000080">]*</font>Y<font color="#000080">+</font>Cosinus<font color="#000080">[</font>Alpha<font color="#000080">]*</font>Z<font color="#000080">;
  </font>X2<font color="#000080">:=</font>Cosinus<font color="#000080">[</font>Beta<font color="#000080">]*</font>X1<font color="#000080">+</font>Sinus<font color="#000080">[</font>Beta<font color="#000080">]*</font>Z1<font color="#000080">;
  </font>Y2<font color="#000080">:=</font>Y1<font color="#000080">;
  </font>Z2<font color="#000080">:=</font>Cosinus<font color="#000080">[</font>Beta<font color="#000080">]*</font>Z1<font color="#000080">-</font>Sinus<font color="#000080">[</font>Beta<font color="#000080">]*</font>X1<font color="#000080">;
  </font>X<font color="#000080">:=</font>Cosinus<font color="#000080">[</font>Gamma<font color="#000080">]*</font>X2<font color="#000080">-</font>Sinus<font color="#000080">[</font>Gamma<font color="#000080">]*</font>Y2<font color="#000080">;
  </font>Y<font color="#000080">:=</font>Sinus<font color="#000080">[</font>Gamma<font color="#000080">]*</font>X2<font color="#000080">+</font>Cosinus<font color="#000080">[</font>Gamma<font color="#000080">]*</font>Y2<font color="#000080">;
  </font>Z<font color="#000080">:=</font>Z2<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#008000"><i>{Rotate}

</i></font><font color="#FF0000"><b>Procedure </b></font>PrecalcPoints<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  For </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">360 </font><font color="#FF0000"><b>Do Begin
    </b></font>Cosinus<font color="#000080">[</font>I<font color="#000080">]:=</font>Cos<font color="#000080">(</font>I<font color="#000080">/</font><font color="#800000">57.29578</font><font color="#000080">);
    </font>Sinus<font color="#000080">[</font>I<font color="#000080">]:=</font>Sin<font color="#000080">(</font>I<font color="#000080">/</font><font color="#800000">57.29578</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>G<font color="#000080">:=</font><font color="#800000">250</font><font color="#000080">;</font><font color="#008000"><i>{Find some well working value for this (250 is fine for VZ=300) }
  </i></font>Alpha<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">; </font>Beta<font color="#000080">:=</font><font color="#800000">310</font><font color="#000080">; </font>Gamma<font color="#000080">:=</font><font color="#800000">330</font><font color="#000080">;</font><font color="#008000"><i>{Change these for an other orientation of
                                     the scroll}
  </i></font>VX<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>VY<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>VZ<font color="#000080">:=</font><font color="#800000">300</font><font color="#000080">;             </font><font color="#008000"><i>{Don't make VZ 0 -&gt; division by zero!!}
  </i></font>XX<font color="#000080">:=-</font><font color="#800000">160</font><font color="#000080">; </font>YY<font color="#000080">:=-</font><font color="#800000">25</font><font color="#000080">; </font>ZZ<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">160</font><font color="#000080">*</font><font color="#800000">50 </font><font color="#FF0000"><b>do Begin
    </b></font>XT1<font color="#000080">:=</font>XX<font color="#000080">; </font>YT1<font color="#000080">:=</font>YY<font color="#000080">; </font>ZT1<font color="#000080">:=</font>Cos<font color="#000080">(</font>XX<font color="#000080">/</font><font color="#800000">10</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">+</font>Sin<font color="#000080">(</font>YY<font color="#000080">/</font><font color="#800000">5</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">; </font><font color="#008000"><i>{Play with these!}
    </i></font>Colors<font color="#000080">[</font>I<font color="#000080">]:=</font>Round<font color="#000080">(</font>ZT1<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">44</font><font color="#000080">);
    </font>Rotate<font color="#000080">(</font>XT1<font color="#000080">,</font>YT1<font color="#000080">,</font>ZT1<font color="#000080">,</font>Alpha<font color="#000080">,</font>Beta<font color="#000080">,</font>Gamma<font color="#000080">);
    </font>BX<font color="#000080">:=</font><font color="#800000">160</font><font color="#000080">+</font>Round<font color="#000080">((</font>XT1<font color="#000080">*</font>G<font color="#000080">)/(</font>ZT1<font color="#000080">+</font>VZ<font color="#000080">));
    </font>BY<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">+</font>Round<font color="#000080">((</font>YT1<font color="#000080">*</font>G<font color="#000080">*</font><font color="#800000">0.8333</font><font color="#000080">)/(</font>ZT1<font color="#000080">+</font>VZ<font color="#000080">));
    </font>Offsets<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">320</font><font color="#000080">*</font>BY<font color="#000080">+</font>BX<font color="#000080">;
    </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>I<font color="#000080">]]:=</font><font color="#800000">15</font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>YY<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>YY<font color="#000080">&gt;=</font><font color="#800000">24  </font><font color="#FF0000"><b>Then Begin
      </b></font>YY<font color="#000080">:=-</font><font color="#800000">25</font><font color="#000080">;
      </font>XX<font color="#000080">:=</font>XX<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;</font><font color="#008000"><i>{Also change size of arrays:Offsets,Colors if you change this}
      </i></font><font color="#FF0000"><b>If </b></font>XX<font color="#000080">&gt;=</font><font color="#800000">159 </font><font color="#FF0000"><b>Then Begin </b></font>XX<font color="#000080">:=-</font><font color="#800000">160</font><font color="#000080">; </font>YY<font color="#000080">:=-</font><font color="#800000">25</font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">64000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  Asm </b></font><font color="#FF00FF">Mov AX,$13; Int $10 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>PrecalcPoints<font color="#000080">;
  </font>Tekst<font color="#000080">:=</font><font color="#800000">'                    '</font><font color="#000080">+
         </font><font color="#800000">'Well, this is an interesting routine (and it seems to work too '</font><font color="#000080">+
         </font><font color="#800000">':-)                    '</font><font color="#000080">;
  </font>TOf<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Tekst<font color="#000080">); </font>TSeg<font color="#000080">:=</font>Seg<font color="#000080">(</font>Tekst<font color="#000080">);
  </font>Tel<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Repeat
    For </b></font>TL<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">7 </font><font color="#FF0000"><b>Do Begin
      </b></font>ArrayTel<font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">*</font><font color="#800000">49</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">19 </font><font color="#FF0000"><b>Do Begin
        </b></font>SL<font color="#000080">:=</font>Mem<font color="#000080">[</font>TSeg<font color="#000080">:</font>TOf<font color="#000080">+</font>I<font color="#000080">+</font>Tel<font color="#000080">];
        </font>LOf<font color="#000080">:=</font><font color="#800000">$FA6E</font><font color="#000080">+</font>SL<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">;
        </font><font color="#FF0000"><b>For </b></font>XS<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">7 </font><font color="#FF0000"><b>Do Begin
          For </b></font>YS<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do Begin
            If </b></font><font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$F000</font><font color="#000080">:</font>LOf<font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#800000">128 </font><font color="#FF0000"><b>Shr </b></font>XS<font color="#000080">))&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
              </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font>Colors<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">];
            </font><font color="#FF0000"><b>End Else Begin
              </b></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
              </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font>Inc<font color="#000080">(</font>Lof<font color="#000080">);
            </font>Inc<font color="#000080">(</font>ArrayTel<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">);
          </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
          </font>Dec<font color="#000080">(</font>Lof<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
          </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Offsets<font color="#000080">[</font>ArrayTel<font color="#000080">-</font>TL<font color="#000080">*</font><font color="#800000">49</font><font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
          </font>Inc<font color="#000080">(</font>ArrayTel<font color="#000080">);
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>Tel<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>Tel<font color="#000080">&gt;=</font>Length<font color="#000080">(</font>Tekst<font color="#000080">)-</font><font color="#800000">20 </font><font color="#FF0000"><b>Then </b></font>Tel<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p></body>
</html>
