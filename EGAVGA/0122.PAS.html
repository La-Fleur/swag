<html>
<head><title> "smooth text scroll" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's a demo for a REAL smooth textscroll. Reset lines to something usefull,
cut the sideborders, place some readable text, and your scroller is ready! ;-)

}
</i></font><font color="#FF0000"><b>program </b></font>smoothtextscroll<font color="#000080">;
</font><font color="#008000"><i>{ by Bas van Gaalen and Sven van Heel, Holland, PD }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>vidseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$b800</font><font color="#000080">; </font>lines<font color="#000080">=</font><font color="#800000">23</font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>ofs<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>vertrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03dah; @vert1: in al,dx; test al,8; jnz @vert1
  @vert2: in al,dx; test al,8; jz @vert2; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setaddress<font color="#000080">(</font>ad<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3d4h; mov al,0ch; mov ah,[byte(ad)+1]; out dx,ax
  mov al,0dh; mov ah,[byte(ad)]; out dx,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setsmooth<font color="#000080">(</font>smt<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03c0h; mov al,13h+32; out dx,al; inc dx; in al,dx
  and al,11110000b; mov ah,smt; or al,ah; dec dx; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setup<font color="#000080">(</font>ad<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3d4h
  mov al,18h
  mov ah,[byte(ad)]
  out dx,ax
  mov al,7
  out dx,al
  inc dx
  in al,dx
  dec dx
  mov ah,[byte(ad)+1]
  and ah,00000001b
  shl ah,4
  and al,11101111b
  or al,ah
  mov ah,al
  mov al,7
  out dx,ax

  mov al,9
  out dx,al
  inc dx
  in al,dx
  dec dx
  mov ah,[byte(ad)+1]
  and ah,00000010b
  shl ah,5
  and al,10111111b
  or al,ah
  mov ah,al
  mov al,9
  out dx,ax

  mov dx,03c0h
  mov al,10h+32
  out dx,al
  inc dx
  in al,dx
  and al,11011111b
  or al,00100000b
  dec dx
  out dx,al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>i<font color="#000080">:</font>word<font color="#000080">; </font>cx<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>setup<font color="#000080">(</font>lines<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">);
  </font>setaddress<font color="#000080">((</font><font color="#800000">25</font><font color="#000080">-</font>lines<font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">);
  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'Hey, a smooth textscroll...'</font><font color="#000080">);
  </font>x<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>cx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>randomize<font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>vertrace<font color="#000080">;
    </font>setsmooth<font color="#000080">(</font>x<font color="#000080">); </font>ofs<font color="#000080">:=</font>ofs <font color="#FF0000"><b>mod </b></font><font color="#800000">4</font><font color="#000080">;
    </font>x<font color="#000080">:=(</font><font color="#800000">1</font><font color="#000080">+</font>x<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">9</font><font color="#000080">; </font><font color="#FF0000"><b>if </b></font>x<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      for </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>lines<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
        </b></font>move<font color="#000080">(</font>mem<font color="#000080">[</font><font color="#800000">$b800</font><font color="#000080">:</font><font color="#800000">160</font><font color="#000080">*(</font><font color="#800000">25</font><font color="#000080">-</font>lines<font color="#000080">+</font>y<font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">],</font>mem<font color="#000080">[</font><font color="#800000">$b800</font><font color="#000080">:</font><font color="#800000">160</font><font color="#000080">*(</font><font color="#800000">25</font><font color="#000080">-</font>lines<font color="#000080">+</font>y<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">158</font><font color="#000080">);
        </font>mem<font color="#000080">[</font><font color="#800000">$b800</font><font color="#000080">:(</font><font color="#800000">25</font><font color="#000080">-</font>lines<font color="#000080">+</font>y<font color="#000080">)*</font><font color="#800000">160</font><font color="#000080">+</font><font color="#800000">158</font><font color="#000080">]:=</font>random<font color="#000080">(</font><font color="#800000">26</font><font color="#000080">)+</font><font color="#800000">32</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>textmode<font color="#000080">(</font>lastmode<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0122.PAS">Original</a><b>]</b></p></body>
</html>
