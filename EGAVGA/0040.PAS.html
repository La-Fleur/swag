<html>
<head><title> "VGA BGI & Detect" by ERIC MILLER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
ERIC MILLER

&gt; Let's suppose that I used VGA256.BGI.  I change it to VGA256.OBJ.  And in
&gt; my program, I type the following: {$L VGA256.OBJ}

Well, you can't lin VGA256.BGI into the program that way; for some
reason, if it wasn't included in TP6 it won't register.  You have
to use the InstallUserDriver function instead of RegisterBGIDriver.
Here is a program that get's into VGA256 mode that way - but of
course you must already know how to do it.
*)

</i></font><font color="#FF0000"><b>PROGRAM </b></font>Vg<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Graph<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>vgaPresent <font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov ah,$F
  int $10
  mov ax,$1A00
  int $10      </font><font color="#008000"><i>{check for VGA/MCGA}
  </i></font><font color="#FF00FF">cmp al,$1A
  jne @ERR     </font><font color="#008000"><i>{no VGA Bios}
  </i></font><font color="#FF00FF">cmp bl,7
  jb @ERR      </font><font color="#008000"><i>{is VGA or better?}
  </i></font><font color="#FF00FF">cmp bl,$FF
  jnz @OK
 @ERR:
  xor al,al
  jmp @EXIT
 @OK:
  mov al,1
 @EXIT:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$F+}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>DetectVGA256<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>vgaPresent <font color="#FF0000"><b>THEN
    </b></font>DetectVGA256 <font color="#000080">:= </font><font color="#800000">0
  </font><font color="#FF0000"><b>ELSE
    </b></font>DetectVGA256 <font color="#000080">:= </font>grError<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{$F-}


</i></font><font color="#FF0000"><b>VAR
  </b></font>VGA256<font color="#000080">: </font>Integer<font color="#000080">;
  </font>B<font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>VGA256 <font color="#000080">:= </font>InstallUserDriver<font color="#000080">(</font><font color="#800000">'VGA256'</font><font color="#000080">, @</font>DetectVGA256<font color="#000080">);
  </font>B <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>InitGraph<font color="#000080">(</font>VGA256<font color="#000080">, </font>B<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
  </font>OutText<font color="#000080">(</font><font color="#800000">'In 320x200x256 - press enter'</font><font color="#000080">);
  </font>Readln<font color="#000080">;
  </font>CloseGraph<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0040.PAS">Original</a><b>]</b></p></body>
</html>
