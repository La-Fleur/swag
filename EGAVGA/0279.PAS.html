<html>
<head><title> "Mini VGA Graphics Mode unit" by NELSON CHU</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0279.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>graphic<font color="#000080">;
</font><font color="#008000"><i>{ By Nelson Chu 1993,94,95,96 - DOS mini version, to be included in SWAG.

{ This uint contains functions &amp; procedures that I ususally need for
  writing graphical programs in standard VGA mode. There may be some code
  that are not useful. I just release it so that I don't have to include
  the needed routines in my every other programs to SWAG. }
</i></font><font color="#FF0000"><b>interface
type </b></font>ScreenType<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">199</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">319</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
     </font>pScreenType<font color="#000080">=^</font>ScreenType<font color="#000080">;
     </font>palrecordtype <font color="#000080">= </font><font color="#FF0000"><b>record  </b></font><font color="#008000"><i>{ the Palette type, consists }
                     </i></font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>PALType<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>palrecordtype<font color="#000080">;</font><font color="#008000"><i>{ of 3 fields :
                                              Red, Green &amp; Blue values }
     </i></font>sintable <font color="#000080">= </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>shortint<font color="#000080">;
</font><font color="#FF0000"><b>var  </b></font>vs<font color="#000080">,</font>screen<font color="#000080">:</font>pScreenType<font color="#000080">;
     </font>sine<font color="#000080">:</font>sintable<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>SetCRTMode<font color="#000080">(</font>Mode<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>FadeOut<font color="#000080">(</font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>low<font color="#000080">,</font>high<font color="#000080">,</font>delay<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>FadeIn<font color="#000080">(</font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>low<font color="#000080">,</font>high<font color="#000080">,</font>delay<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>LoadPAL<font color="#000080">(</font>FileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>mix<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>HVline<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>len<font color="#000080">:</font>word<font color="#000080">;</font>color<font color="#000080">:</font>byte<font color="#000080">;</font>HV<font color="#000080">:</font>boolean<font color="#000080">; </font>screen<font color="#000080">:</font>pScreenType<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>blacken<font color="#000080">(</font>low<font color="#000080">,</font>high<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#008000"><i>{set all color's palette to zero}
</i></font><font color="#FF0000"><b>procedure </b></font>setcolor<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>vSync<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>clearScreen<font color="#000080">(</font>scr<font color="#000080">:</font>pScreenType<font color="#000080">);
</font><font color="#FF0000"><b>function </b></font>VideoOK<font color="#000080">:</font>boolean<font color="#000080">; </font><font color="#008000"><i>{check for a VGA or MCGA}
</i></font><font color="#FF0000"><b>Function </b></font>VGA <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>GetPal<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>pal<font color="#000080">:</font>palType<font color="#000080">; </font>b<font color="#000080">,</font>e<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>Setpal<font color="#000080">(</font>apal<font color="#000080">:</font>paltype<font color="#000080">; </font>b<font color="#000080">,</font>e<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>pset<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">; </font>color<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#008000"><i>{pascal}
</i></font><font color="#FF0000"><b>Procedure </b></font>asmPset<font color="#000080">(</font>Scr<font color="#000080">:</font>pscreentype<font color="#000080">;</font>x<font color="#000080">:</font>Integer<font color="#000080">;</font>y<font color="#000080">,</font>Col<font color="#000080">:</font>Byte<font color="#000080">);</font><font color="#008000"><i>{asm}
{use direct array reference is faster, since every time you call the above
two proc., time wasted on pushing/poping registers.}
</i></font><font color="#FF0000"><b>procedure </b></font>copyscreen<font color="#000080">(</font>ss<font color="#000080">,</font>ds<font color="#000080">:</font>pscreentype<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>fillbox<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>word<font color="#000080">; </font>c<font color="#000080">: </font>byte<font color="#000080">; </font>screen<font color="#000080">:</font>pscreentype<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>RotatePal<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Pal <font color="#000080">: </font>PALType<font color="#000080">; </font>beginRec<font color="#000080">, </font>endRec <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>calSine<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sinbl<font color="#000080">:</font>sintable<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>copybox<font color="#000080">(</font>ss<font color="#000080">,</font>ds<font color="#000080">:</font>pscreentype<font color="#000080">; </font>sx<font color="#000080">, </font>sy<font color="#000080">, </font>w<font color="#000080">, </font>h<font color="#000080">, </font>dx<font color="#000080">, </font>dy<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>implementation

procedure </b></font>copyright<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>label </b></font>there<font color="#000080">;
</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">jmp there;
 db 13,10,&quot;Graphic Unit(Mini DOS version 1.3) by Nelson Chu 93-96&quot;,13,10
there:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>dmove<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>S<font color="#000080">, </font>D<font color="#000080">; </font>Cnt <font color="#000080">: </font>Word <font color="#000080">); </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
</b></font>	<font color="#FF00FF">MOV</font>	<font color="#FF00FF">DX,DS
</font>	<font color="#FF00FF">LDS</font>	<font color="#FF00FF">SI,[S]
</font>	<font color="#FF00FF">LES</font>	<font color="#FF00FF">DI,[D]
</font>	<font color="#FF00FF">MOV</font>	<font color="#FF00FF">CX,[Cnt]
</font>	<font color="#FF00FF">CLD
</font>	<font color="#FF00FF">SHR</font>	<font color="#FF00FF">CX,2
        DB      66h
    REP MOVSW
</font>	<font color="#FF00FF">ADC</font>	<font color="#FF00FF">CX,CX
    REP MOVSB
</font>	<font color="#FF00FF">MOV</font>	<font color="#FF00FF">DS,DX
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>SetCRTMode<font color="#000080">(</font>Mode<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ as the name implies, it sets }
</i></font><font color="#FF0000"><b>asm                                     </b></font><font color="#008000"><i>{ the CRT's mode by calling int 10 }
</i></font><font color="#FF00FF">mov ax,Mode;
int 10h
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>vSync<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ used for smooth output }
</i></font><font color="#FF0000"><b>label
  </b></font>l1<font color="#000080">, </font>l2<font color="#000080">;
</font><font color="#FF0000"><b>asm
</b></font><font color="#008000"><i>{    cli}
    </i></font><font color="#FF00FF">mov dx,3DAh
l1:
    in al,dx
    and al,08h
    jnz l1
l2:
    in al,dx
    and al,08h
    jz  l2
</font><font color="#008000"><i>{    sti}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>FadeOut<font color="#000080">(</font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>low<font color="#000080">,</font>high<font color="#000080">,</font>delay<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>i<font color="#000080">:=</font><font color="#800000">31 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
begin
</b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>low<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>delay <font color="#FF0000"><b>do</b></font><font color="#000080">;
</font>vSync<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>low <font color="#FF0000"><b>to </b></font>high <font color="#FF0000"><b>do
    begin
    </b></font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>R<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>G<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>B<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FadeIn<font color="#000080">(</font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>low<font color="#000080">,</font>high<font color="#000080">,</font>delay<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin

for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">31 </font><font color="#FF0000"><b>do
begin
</b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>low<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>delay <font color="#FF0000"><b>do</b></font><font color="#000080">;
</font>vSync<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font>low <font color="#FF0000"><b>to </b></font>high <font color="#FF0000"><b>do
    begin
    </b></font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>R<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>G<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=(</font>pal<font color="#000080">[</font>j<font color="#000080">].</font>B<font color="#000080">*</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">32</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>VGA <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV     AH,1Ah
  INT     10h
  CMP     AL,1Ah
  MOV     AL,True
  JE      @OUT
  DEC     AX
 @OUT:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>VideoOK<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>result<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
asm
   </b></font><font color="#FF00FF">mov ah,$1a
   xor al,al
   int $10
   mov result,bl
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#008000"><i>{ VGA mono;VGA color }
            { vvvvvvv            }
</i></font><font color="#FF0000"><b>if </b></font>result <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">$07</font><font color="#000080">,</font><font color="#800000">$08</font><font color="#000080">,</font><font color="#800000">$0a</font><font color="#000080">..</font><font color="#800000">$0c</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>videoOK<font color="#000080">:=</font>true <font color="#FF0000"><b>else </b></font>videoOK<font color="#000080">:=</font>false<font color="#000080">;
                   </font><font color="#008000"><i>{  ^^^^^^^^   }
                   { MCGA digital color; MCGA analog color; }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;               </font><font color="#008000"><i>{ MCGA analog mono }

</i></font><font color="#FF0000"><b>procedure </b></font>LoadPAL<font color="#000080">(</font>FileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>pal<font color="#000080">:</font>paltype<font color="#000080">; </font>mix<font color="#000080">:</font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Fil<font color="#000080">:</font><font color="#FF0000"><b>file of </b></font>PALType<font color="#000080">;
  </font>i<font color="#000080">:</font>byte<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>Fil<font color="#000080">,</font>FileName<font color="#000080">);
  </font>reset<font color="#000080">(</font>Fil<font color="#000080">);
  </font>read<font color="#000080">(</font>Fil<font color="#000080">,</font>PAL<font color="#000080">);
  </font>close<font color="#000080">(</font>Fil<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>mix <font color="#FF0000"><b>then
  for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do
    begin
    </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>i<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>PAL<font color="#000080">[</font>i<font color="#000080">].</font>R<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>PAL<font color="#000080">[</font>i<font color="#000080">].</font>G<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>PAL<font color="#000080">[</font>i<font color="#000080">].</font>B<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setcolor<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
    </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>c<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>R<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>G<font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>B<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Setpal<font color="#000080">(</font>apal<font color="#000080">:</font>paltype<font color="#000080">; </font>b<font color="#000080">,</font>e<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>b<font color="#000080">; </font><font color="#008000"><i>{auto incremented}
 </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>b <font color="#FF0000"><b>to </b></font>e <font color="#FF0000"><b>do
 begin </b></font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>aPAL<font color="#000080">[</font>i<font color="#000080">].</font>R<font color="#000080">;
       </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>aPAL<font color="#000080">[</font>i<font color="#000080">].</font>G<font color="#000080">;
       </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>aPAL<font color="#000080">[</font>i<font color="#000080">].</font>B<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetPal<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>pal<font color="#000080">:</font>palType<font color="#000080">; </font>b<font color="#000080">,</font>e<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font><font color="#800000">$3c7</font><font color="#000080">]:=</font>b<font color="#000080">; </font><font color="#008000"><i>{auto incremented}
  </i></font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:= </font>b <font color="#FF0000"><b>to </b></font>e <font color="#FF0000"><b>do
  begin </b></font>Pal<font color="#000080">[</font>i<font color="#000080">].</font>R<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">];
        </font>Pal<font color="#000080">[</font>i<font color="#000080">].</font>G<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">];
        </font>Pal<font color="#000080">[</font>i<font color="#000080">].</font>B<font color="#000080">:=</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>HVline<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>len<font color="#000080">:</font>word<font color="#000080">;</font>color<font color="#000080">:</font>byte<font color="#000080">;</font>HV<font color="#000080">:</font>boolean<font color="#000080">; </font>screen<font color="#000080">:</font>pScreenType<font color="#000080">);
</font><font color="#008000"><i>{ (x1,y1) is the upper-left coordinate; HV determine whelter it's H or V }
</i></font><font color="#FF0000"><b>var </b></font>a<font color="#000080">,</font>b<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>a<font color="#000080">:=</font>x1<font color="#000080">;</font>b<font color="#000080">:=</font>y1<font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>HV <font color="#FF0000"><b>then </b></font>fillchar<font color="#000080">( </font>screen<font color="#000080">^[</font>b<font color="#000080">,</font>a<font color="#000080">], </font>len<font color="#000080">, </font>char<font color="#000080">(</font>color<font color="#000080">))
      </font><font color="#FF0000"><b>else while </b></font>len<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do begin </b></font>screen<font color="#000080">^[</font>b<font color="#000080">,</font>a<font color="#000080">]:=</font>color<font color="#000080">; </font>inc<font color="#000080">(</font>b<font color="#000080">); </font>dec<font color="#000080">(</font>len<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>blacken<font color="#000080">(</font>low<font color="#000080">,</font>high<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>d<font color="#000080">:=</font>low <font color="#FF0000"><b>to </b></font>high <font color="#FF0000"><b>do
</b></font>	<font color="#FF0000"><b>begin
        </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>d<font color="#000080">;
</font>	Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font>	Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font>	Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>RotatePal<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Pal <font color="#000080">: </font>PALType<font color="#000080">; </font>beginRec<font color="#000080">, </font>endRec <font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var  </b></font>TRGB <font color="#000080">: </font>palrecordtype<font color="#000080">;
</font><font color="#FF0000"><b>begin </b></font>TRGB<font color="#000080">:=</font>Pal<font color="#000080">[</font>beginRec<font color="#000080">];
      </font>Move<font color="#000080">(</font>Pal<font color="#000080">[</font>beginRec<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>Pal<font color="#000080">[</font>beginRec<font color="#000080">],(</font>endRec<font color="#000080">-</font>beginRec<font color="#000080">)*</font><font color="#800000">3</font><font color="#000080">);
      </font>Pal<font color="#000080">[</font>endRec<font color="#000080">]:=</font>TRGB<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>clearScreen<font color="#000080">(</font>scr<font color="#000080">:</font>pScreenType<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>fillchar<font color="#000080">(</font>scr<font color="#000080">^,</font><font color="#800000">64000</font><font color="#000080">,</font><font color="#800000">#0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>asmPset<font color="#000080">(</font>Scr<font color="#000080">:</font>pscreentype<font color="#000080">;</font>x<font color="#000080">:</font>Integer<font color="#000080">;</font>y<font color="#000080">,</font>Col<font color="#000080">:</font>Byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">les   di,Scr; xor   bh,bh; mov   bl,y; shl   bx,6; add   bh,y;
add bx,x; add   bx,di; mov   al,Col; mov   es:[bx],al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>pset<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">; </font>color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
 </b></font>screen<font color="#000080">^[</font>y<font color="#000080">,</font>x<font color="#000080">]:=</font>color<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>copyscreen<font color="#000080">(</font>ss<font color="#000080">,</font>ds<font color="#000080">:</font>pscreentype<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>dmove<font color="#000080">(</font>ss<font color="#000080">^,</font>ds<font color="#000080">^,</font><font color="#800000">64000</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>fillbox<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">:</font>word<font color="#000080">; </font>c<font color="#000080">: </font>byte<font color="#000080">; </font>screen<font color="#000080">:</font>pscreentype<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">: </font>byte<font color="#000080">; </font>s<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>s<font color="#000080">:=</font>x2<font color="#000080">-</font>x1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>for </b></font>a<font color="#000080">:= </font>y1 <font color="#FF0000"><b>to </b></font>y2 <font color="#FF0000"><b>do </b></font>fillchar<font color="#000080">(</font>screen<font color="#000080">^[</font>a<font color="#000080">,</font>x1<font color="#000080">], </font>s<font color="#000080">, </font>c<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>copybox<font color="#000080">(</font>ss<font color="#000080">,</font>ds<font color="#000080">:</font>pscreentype<font color="#000080">; </font>sx<font color="#000080">, </font>sy<font color="#000080">, </font>w<font color="#000080">, </font>h<font color="#000080">, </font>dx<font color="#000080">, </font>dy<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
 for </b></font>a<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>h<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
  </b></font>move<font color="#000080">(</font>ss<font color="#000080">^[</font>sy<font color="#000080">+</font>a<font color="#000080">,</font>sx<font color="#000080">], </font>ds<font color="#000080">^[</font>dy<font color="#000080">+</font>a<font color="#000080">, </font>dx<font color="#000080">], </font>w<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>calSine<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>sinbl<font color="#000080">:</font>sintable<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>a<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>a<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>sinbl<font color="#000080">[</font>a<font color="#000080">]:=</font>trunc<font color="#000080">( </font>sin<font color="#000080">(</font>a<font color="#000080">*</font>pi<font color="#000080">/</font><font color="#800000">128</font><font color="#000080">)*</font><font color="#800000">127</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Screen<font color="#000080">:=</font>Ptr<font color="#000080">(</font>SegA000<font color="#000080">,</font><font color="#800000">0000</font><font color="#000080">);
  </font>copyright<font color="#000080">;
  </font>calSine<font color="#000080">(</font>sine<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ At last I can contribute something to SWAG. I waited to be a university
  student in Hong Kong for long. We have our Internet account as we become
  one of their menbers. Only then can I e-mail my programs to you...}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0279.PAS">Original</a><b>]</b></p></body>
</html>
