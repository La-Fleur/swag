<html>
<head><title> "360x256x256 Tweaked Mode" by MAURICE MARVIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0179.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
     Hi Kai.  I read your message about 360x256x256 and saw you were using
Tweak.  This is message 1/2 which includes Pascal versions of Twkuser.c
and Tweak2c.  Thought they might be helpful to you.

Maurice L. Marvin
maurice@cs.pdx.edu
}

{$I-}
</i></font><font color="#FF0000"><b>UNIT </b></font>TWKUSER<font color="#000080">;

</font><font color="#008000"><i>{=========================================================================
  TWKUSER.PAS is a Borland Pascal 7.0 compatible unit for using Robert
  Schmidt's TWEAK generated files.

  Ported to Pascal from Robert Schmidt's original C code.

  Donated to public domain.

  Maurice L. Marvin
  maurice@cs.pdx.edu
 ==========================================================================}

</i></font><font color="#FF0000"><b>INTERFACE

 CONST

    </b></font><font color="#008000"><i>{ xxxxADDR defines the base port number used to access VGA
      component xxxx, and is defined for xxxx =
           ATTRCON    -   Attribute Controller
           MISC       -   Miscellaneous Register
           VGAENABLE  -   VGA Enable Register
           SEQ        -   Sequencer
           GRACON     -   Graphics Controller
           CRTC       -   Cathode Ray Tube Controller
           STATUS     -   Status Register }

    </i></font>ATTRCON_ADDR        <font color="#000080">= </font><font color="#800000">$3C0</font><font color="#000080">;
    </font>MISC_ADDR           <font color="#000080">= </font><font color="#800000">$3C2</font><font color="#000080">;
    </font>VGAENABLE_ADDR      <font color="#000080">= </font><font color="#800000">$3C3</font><font color="#000080">;
    </font>SEQ_ADDR            <font color="#000080">= </font><font color="#800000">$3C4</font><font color="#000080">;
    </font>GRACON_ADDR         <font color="#000080">= </font><font color="#800000">$3CE</font><font color="#000080">;
    </font>CRTC_ADDR           <font color="#000080">= </font><font color="#800000">$3D4</font><font color="#000080">;
    </font>STATUS_ADDR         <font color="#000080">= </font><font color="#800000">$3DA</font><font color="#000080">;

 </font><font color="#FF0000"><b>TYPE

    Register </b></font><font color="#000080">= </font><font color="#FF0000"><b>RECORD
                  </b></font>port   <font color="#000080">: </font>WORD<font color="#000080">;
                  </font>index  <font color="#000080">: </font>BYTE<font color="#000080">;
                  </font>value  <font color="#000080">: </font>BYTE<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>RegisterPtr <font color="#000080">= ^</font><font color="#FF0000"><b>Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ReadyVgaRegs<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>OutReg<font color="#000080">(</font>r <font color="#000080">: </font><font color="#FF0000"><b>Register</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>OutRegArray<font color="#000080">(</font>r <font color="#000080">: </font>RegisterPtr<font color="#000080">;
                      </font>n <font color="#000080">: </font>INTEGER<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION  </b></font>LoadRegArray<font color="#000080">(</font>fpath        <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                       </font><font color="#FF0000"><b>VAR </b></font>RegArray <font color="#000080">: </font>RegisterPtr<font color="#000080">) : </font>INTEGER<font color="#000080">;


</font><font color="#FF0000"><b>IMPLEMENTATION


</b></font><font color="#008000"><i>{--------------------------------------------------------------------------
  ReadyVGARegs does the initialization to make the VGA ready to accept
  any combination of configuration register settings.

  This involves enabling writes to index 0 to 7 of the CRT controller
  (port $3d4), by clearing the most significant bit (bit 7) of index
  $11.
 --------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ReadyVGARegs<font color="#000080">;

 </font><font color="#FF0000"><b>VAR

    </b></font>v <font color="#000080">: </font>BYTE<font color="#000080">;

 </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{*** Begin procedure ReadyVGARegs ***}
    </i></font>Port<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$11</font><font color="#000080">;
    </font>v <font color="#000080">:= </font>Port<font color="#000080">[</font><font color="#800000">$3d5</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$7f</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3d4</font><font color="#000080">] := </font><font color="#800000">$11</font><font color="#000080">;
    </font>Port<font color="#000080">[</font><font color="#800000">$3d5</font><font color="#000080">] := </font>v<font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{*** End procedure ReadyVGARegs ***}


{--------------------------------------------------------------------------
  OutReg sets a single register according to the contents of the passed
  Register structure.
 --------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>OutReg<font color="#000080">(</font>r <font color="#000080">: </font><font color="#FF0000"><b>Register</b></font><font color="#000080">);

 </font><font color="#FF0000"><b>VAR

    </b></font>v <font color="#000080">: </font>BYTE<font color="#000080">;

 </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{*** Begin procedure OutReg ***}
    </i></font><font color="#FF0000"><b>CASE </b></font><font color="#000080">(</font>r<font color="#000080">.</font>port<font color="#000080">) </font><font color="#FF0000"><b>OF
       </b></font>ATTRCON_ADDR   <font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                           </b></font>v <font color="#000080">:= </font>Port<font color="#000080">[</font>STATUS_ADDR<font color="#000080">]; </font><font color="#008000"><i>{ Reset read/write flip flop
}                           </i></font>Port<font color="#000080">[</font>ATTRCON_ADDR<font color="#000080">] := </font>r<font color="#000080">.</font>index <font color="#FF0000"><b>OR </b></font><font color="#800000">$20</font><font color="#000080">;
                           </font><font color="#008000"><i>{ Ensure VGA output is enabled }
                           </i></font>Port<font color="#000080">[</font>ATTRCON_ADDR<font color="#000080">] := </font>r<font color="#000080">.</font>value<font color="#000080">;
                        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font>MISC_ADDR<font color="#000080">,
       </font>VGAENABLE_ADDR <font color="#000080">: </font><font color="#FF0000"><b>BEGIN
                           </b></font>Port<font color="#000080">[</font>r<font color="#000080">.</font>port<font color="#000080">] := </font>r<font color="#000080">.</font>value<font color="#000080">; </font><font color="#008000"><i>{ Directly to the port }
                        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>ELSE </b></font><font color="#008000"><i>{ Default method }
                        </i></font><font color="#FF0000"><b>BEGIN
                           </b></font>Port<font color="#000080">[</font>r<font color="#000080">.</font>port<font color="#000080">] := </font>r<font color="#000080">.</font>index<font color="#000080">; </font><font color="#008000"><i>{ Index to port }
                           </i></font>Port<font color="#000080">[</font>r<font color="#000080">.</font>port <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>r<font color="#000080">.</font>value<font color="#000080">; </font><font color="#008000"><i>{ Value to port + 1}
                        </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{*** End procedure OutReg ***}


{--------------------------------------------------------------------------
  OutRegArray sets n registers according to the array pointed to by r.
  First, indexes 0-7 of the CRT controller are enabled for writing.
 --------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>OutRegArray<font color="#000080">(</font>r <font color="#000080">: </font>RegisterPtr<font color="#000080">;
                      </font>n <font color="#000080">: </font>INTEGER<font color="#000080">);

 </font><font color="#FF0000"><b>VAR

    </b></font>s <font color="#000080">: </font>WORD<font color="#000080">;

 </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{*** Begin procedure OutRegArray ***}
    </i></font>s <font color="#000080">:= </font>SizeOf<font color="#000080">(</font><font color="#FF0000"><b>Register</b></font><font color="#000080">);
    </font>ReadyVGARegs<font color="#000080">;
    </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>n <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
       BEGIN
          </b></font>OutReg<font color="#000080">(</font>r<font color="#000080">^);
          </font><font color="#FF0000"><b>ASM </b></font><font color="#008000"><i>{ Increment pointer to next record }
             </i></font><font color="#FF00FF">MOV DX,s
             ADD WORD PTR [r],DX
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>DEC<font color="#000080">(</font>n<font color="#000080">);
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{*** End procedure OutRegArray ***}


{--------------------------------------------------------------------------
  LoadRegArray opens the given file, does some validity checking, then
  reads the entire file into an array of Registers, which is returned
  via the RegArray parameter.

  You will probably want to provide your own error handling code in this
  function, as it never aborts the program, rather than just printing
  an error message and returning NULL.

  The returned value is the number of registers read.  The RegArray
  parameter is set to the allocated register array.

  If you use this function, remember to dispose the returned array pointer,
  as it was allocated dynamically using GetMem (unless NULL is returned,
  which designates an error).
 --------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>LoadRegArray<font color="#000080">(</font>fpath        <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
                      </font><font color="#FF0000"><b>VAR </b></font>RegArray <font color="#000080">: </font>RegisterPtr<font color="#000080">) : </font>INTEGER<font color="#000080">;

 </font><font color="#FF0000"><b>VAR

    </b></font>handle <font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
    </font>fsize  <font color="#000080">: </font>LONGINT<font color="#000080">;

 </font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{*** Begin function LoadRegArray ***}
    </i></font>LoadRegArray <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>RegArray <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
    </font>ASSIGN<font color="#000080">(</font>handle<font color="#000080">,</font>fpath<font color="#000080">);
    </font>RESET<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ error opening file ? }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font><font color="#008000"><i>{ include error handling code here }
          </i></font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>fsize <font color="#000080">:= </font>FileSize<font color="#000080">(</font>handle<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ error acquiring file size ? }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
          </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>fsize <font color="#FF0000"><b>MOD </b></font>SizeOf<font color="#000080">(</font><font color="#FF0000"><b>Register</b></font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Is filesize multiple of record
? }       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Illegal TWEAK file size: '</font><font color="#000080">,</font>fpath<font color="#000080">);
          </font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
          </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>MaxAvail <font color="#000080">&lt; </font>fsize<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Is there enough memory ? }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>WriteLn<font color="#000080">(</font><font color="#800000">'Out of memory allocating buffer for '</font><font color="#000080">,</font>fpath<font color="#000080">);
          </font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
          </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>GetMem<font color="#000080">(</font>RegArray<font color="#000080">,</font>fsize<font color="#000080">);
    </font>BlockRead<font color="#000080">(</font>handle<font color="#000080">,</font>RegArray<font color="#000080">^,</font>fsize<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Error reading file ? }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
          </font>Dispose<font color="#000080">(</font>RegArray<font color="#000080">);
          </font>RegArray <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
          </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Error closing file ? }
       </i></font><font color="#FF0000"><b>BEGIN
          </b></font>Dispose<font color="#000080">(</font>RegArray<font color="#000080">);
          </font>RegArray <font color="#000080">:= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">;
          </font>Exit<font color="#000080">;
       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>LoadRegArray <font color="#000080">:= </font>fsize <font color="#FF0000"><b>DIV </b></font>SizeOf<font color="#000080">(</font><font color="#FF0000"><b>Register</b></font><font color="#000080">);
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{*** End function LoadRegArray ***}


</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.




</font><font color="#008000"><i>{$I-}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>TWEAK2P<font color="#000080">;

</font><font color="#FF0000"><b>USES </b></font>TWKUSER<font color="#000080">;

</font><font color="#008000"><i>{=========================================================================
  TWEAK2P version 1.0

  Ported to Pascal from Robert Schmidt's original C code.

  Converts a TWEAK version 1.0 file to an include-able Pascal file,
  defining the equivalent register array, which is passable
  to the OutRegArray function defined in the TWKUSER unit.

  Maurice L. Marvin
  maurice@cs.pdx.edu
 =========================================================================}

</i></font><font color="#FF0000"><b>VAR

   </b></font>table   <font color="#000080">: </font>RegisterPtr<font color="#000080">;
   </font>btable  <font color="#000080">: </font>RegisterPtr<font color="#000080">;
   </font>regsize <font color="#000080">: </font>INTEGER<font color="#000080">;
   </font>handle  <font color="#000080">: </font>TEXT<font color="#000080">;
   </font>b1      <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>b2      <font color="#000080">: </font>BYTE<font color="#000080">;
   </font>s       <font color="#000080">: </font>WORD<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{*** Begin program TWEAK2P ***}
   { Check command line arguments. }
   </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&lt; </font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>WriteLn<font color="#000080">;
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'TWEAK2P version 1.0'</font><font color="#000080">);
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'Converts a TWEAK version 1.x file to an include-able Pascal
</font><font color="#FF0000"><b>file</b></font><font color="#000080">.</font><font color="#800000">');         WriteLn;
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'SYNTAX: TWEAK2P &lt;TWEAK-File&gt; &lt;Pascal File to Create&gt; &lt;Array
</font>Name<font color="#000080">&gt;</font><font color="#800000">');         WriteLn('</font>All Parameters are required<font color="#000080">.</font><font color="#800000">');
         </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#008000"><i>{ Load the register file. }
   </i></font>regsize <font color="#000080">:= </font>LoadRegArray<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>table<font color="#000080">);
   </font><font color="#008000"><i>{ Save a pointer to the start of the table.  The pointer 'table' will
     be corrupted due to pointer arithmetic. }
   </i></font>btable <font color="#000080">:= </font>table<font color="#000080">;
   </font><font color="#008000"><i>{ Check if we loaded the table successfully. }
   </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Table <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>WriteLn<font color="#000080">;
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'ERROR : Unable to load register file.'</font><font color="#000080">);
         </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#008000"><i>{ Open the destination file. }
   </i></font>ASSIGN<font color="#000080">(</font>handle<font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">));
   </font>REWRITE<font color="#000080">(</font>handle<font color="#000080">);
   </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ Check if error creating file. }
      </i></font><font color="#FF0000"><b>BEGIN
         </b></font>WriteLn<font color="#000080">;
         </font>WriteLn<font color="#000080">(</font><font color="#800000">'ERROR : Unable to create destination file.'</font><font color="#000080">);
         </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#008000"><i>{ Write data structure }
   </i></font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'{ Tweaked include file generated by TWEAK2P } '</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'CONST'</font><font color="#000080">);
   </font>WriteLn<font color="#000080">(</font>handle<font color="#000080">);
   </font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'   '</font><font color="#000080">,</font>ParamStr<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">),</font><font color="#800000">' : ARRAY[1..'</font><font color="#000080">,</font>RegSize<font color="#000080">);
   </font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'] OF Register = ('</font><font color="#000080">);
   </font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'       '</font><font color="#000080">);
   </font>s <font color="#000080">:= </font>SizeOf<font color="#000080">(</font><font color="#FF0000"><b>Register</b></font><font color="#000080">);
   </font><font color="#008000"><i>{ Write register values }
   </i></font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>RegSize <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>DO
      BEGIN
         </b></font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'(Port : '</font><font color="#000080">,</font>table<font color="#000080">^.</font>port<font color="#000080">);
         </font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'; Index : '</font><font color="#000080">,</font>table<font color="#000080">^.</font>index<font color="#000080">);
         </font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'; Value : '</font><font color="#000080">,</font>table<font color="#000080">^.</font>value<font color="#000080">,</font><font color="#800000">')'</font><font color="#000080">);
         </font>DEC<font color="#000080">(</font>RegSize<font color="#000080">);
         </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>RegSize <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
            </b></font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">');'</font><font color="#000080">)
         </font><font color="#FF0000"><b>ELSE
            </b></font>WriteLn<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">);
         </font><font color="#FF0000"><b>ASM </b></font><font color="#008000"><i>{ move to next record }
            </i></font><font color="#FF00FF">MOV DX,s
            ADD WORD PTR [table],DX
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
         </font>Write<font color="#000080">(</font>handle<font color="#000080">,</font><font color="#800000">'       '</font><font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>CLOSE<font color="#000080">(</font>handle<font color="#000080">);
   </font>Dispose<font color="#000080">(</font>btable<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">. </font><font color="#008000"><i>{*** End program Tweak2P ***}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0179.PAS">Original</a><b>]</b></p></body>
</html>
