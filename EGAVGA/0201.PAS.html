<html>
<head><title> "Nice Light Vector with Box" by ALEX CHALFIN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0201.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Well, here is yet another version of my light vector. This time, I
fully tested it on TP7 (I got the blip thing that everybody was saying).
But it really works this time, and it should for you as well.
In case you were wondering, the problem was in the Intensity function.
There was a Longint overflow.
}
</i></font><font color="#FF0000"><b>Program </b></font>Display3D<font color="#000080">;

</font><font color="#FF0000"><b>Const </b></font>NumColors <font color="#000080">: </font>Longint <font color="#000080">= </font><font color="#800000">63</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ScreenVertType <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>ScreenList <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ScreenVertType<font color="#000080">;
  </font>_3DCT <font color="#000080">= </font><font color="#FF0000"><b>Record </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z <font color="#000080">: </font>Longint<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Coords <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>_3DCT<font color="#000080">;
  </font>SinglePoly <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>PLT <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>SinglePoly<font color="#000080">;
  </font>NormCoord <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Longint<font color="#000080">;
  </font>Norms <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>NormCoord<font color="#000080">;
  </font>VScreen <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>PVScreen <font color="#000080">= ^</font>VScreen<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>LocalCds <font color="#000080">: </font>Coords <font color="#000080">= ((</font>x<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">;  </font>z<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">), (</font>x<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">),
   (</font>x<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">),(</font>x<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">),(</font>x<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">),
   (</font>x<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">),(</font>x<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">),(</font>x<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">; </font>y<font color="#000080">:</font><font color="#800000">50</font><font color="#000080">; </font>z<font color="#000080">:-</font><font color="#800000">50</font><font color="#000080">));
  </font>PolyDesc<font color="#000080">:</font>PLT<font color="#000080">=((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">),(</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">),(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">),(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">));
  </font>LNormals<font color="#000080">:</font>Norms<font color="#000080">=((</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4096</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">4096</font><font color="#000080">),(</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">4096</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">4096</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),
               (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4096</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">4096</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">));

</font><font color="#FF0000"><b>Var
  </b></font>Time <font color="#000080">: </font>Longint <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$0</font><font color="#000080">:</font><font color="#800000">$046c</font><font color="#000080">; </font>STime<font color="#000080">, </font>ETime<font color="#000080">, </font>Frame <font color="#000080">: </font>Longint<font color="#000080">;
  </font>WNormals <font color="#000080">: </font>Norms<font color="#000080">; </font>Sine<font color="#000080">, </font>CoSine <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">511</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Longint<font color="#000080">;
  </font>WorldCds <font color="#000080">: </font>Coords<font color="#000080">; </font>ScreenCoords <font color="#000080">: </font>ScreenList<font color="#000080">; </font>Page0<font color="#000080">, </font>Page1 <font color="#000080">: </font>PVScreen<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitGraph<font color="#000080">;
</font><font color="#FF0000"><b>Begin </b></font>New<font color="#000080">(</font>Page1<font color="#000080">);</font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">Mov AX,13h;Int 10h;</font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font>Page0<font color="#000080">:=</font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CloseGraph<font color="#000080">;
</font><font color="#FF0000"><b>Begin </b></font>Dispose<font color="#000080">(</font>Page1<font color="#000080">); </font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">Mov ax,3; Int 10h; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Cls<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Screen<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">Les  di,Screen; Xor  ax,ax; Mov  cx,32000; Rep  Stosw; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CopyWin<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm </b></font><font color="#FF00FF">Push ds; Les di,Dest; Lds si,Source; Mov cx,32000;Rep Movsw;Pop ds;</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>InitPal<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>c <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin For </b></font>c <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>NumColors <font color="#FF0000"><b>do Begin </b></font>Port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">] := </font>c<font color="#000080">;
</font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font>Round<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">*</font>c<font color="#000080">/</font>NumColors<font color="#000080">); </font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
</font>Port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">] := </font>Round<font color="#000080">(</font><font color="#800000">63</font><font color="#000080">*</font>c<font color="#000080">/</font>NumColors<font color="#000080">);</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>CalcSinus<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>C <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin For </b></font>C <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">511 </font><font color="#FF0000"><b>do Begin
</b></font>Sine<font color="#000080">[</font>C<font color="#000080">]:=</font>Round<font color="#000080">(</font>Sin<font color="#000080">(</font>C<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">*</font>Pi<font color="#000080">)/</font><font color="#800000">512</font><font color="#000080">)*</font><font color="#800000">4096</font><font color="#000080">);
</font>CoSine<font color="#000080">[</font>C<font color="#000080">]:=</font>Round<font color="#000080">(</font>Cos<font color="#000080">(</font>C<font color="#000080">*(</font><font color="#800000">2</font><font color="#000080">*</font>Pi<font color="#000080">)/</font><font color="#800000">512</font><font color="#000080">)*</font><font color="#800000">4096</font><font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SAR<font color="#000080">(</font>S<font color="#000080">, </font>B <font color="#000080">: </font>Longint<font color="#000080">) : </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin If </b></font>S<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>SAR<font color="#000080">:=-((-</font>S<font color="#000080">) </font><font color="#FF0000"><b>Shr </b></font>B<font color="#000080">) </font><font color="#FF0000"><b>Else </b></font>SAR<font color="#000080">:=(</font>S <font color="#FF0000"><b>Shr </b></font>B<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Rotate3D<font color="#000080">(</font>Xa<font color="#000080">, </font>Ya<font color="#000080">, </font>Za <font color="#000080">: </font>Word<font color="#000080">; </font>Num <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Loc<font color="#000080">, </font>Wor<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Local <font color="#000080">: </font>Coords <font color="#FF0000"><b>Absolute </b></font>Loc<font color="#000080">; </font>World <font color="#000080">: </font>Coords <font color="#FF0000"><b>Absolute </b></font>Wor<font color="#000080">;
  </font>x<font color="#000080">,</font>y<font color="#000080">,</font>z<font color="#000080">,</font>Xt<font color="#000080">,</font>Yt<font color="#000080">,</font>Zt<font color="#000080">,</font>C <font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Begin For </b></font>C <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>Num<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do Begin
  </b></font>x<font color="#000080">:=</font>Local<font color="#000080">[</font>C<font color="#000080">].</font>x<font color="#000080">; </font>y<font color="#000080">:=</font>Local<font color="#000080">[</font>C<font color="#000080">].</font>y<font color="#000080">; </font>z<font color="#000080">:=</font>Local<font color="#000080">[</font>C<font color="#000080">].</font>z<font color="#000080">;
  </font>Yt<font color="#000080">:=</font>Sar<font color="#000080">(</font>Y<font color="#000080">*</font>CoSine<font color="#000080">[</font>Xa<font color="#000080">]-</font>Z<font color="#000080">*</font>Sine<font color="#000080">[</font>Xa<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">); </font>Zt<font color="#000080">:=</font>Sar<font color="#000080">(</font>Y<font color="#000080">*</font>Sine<font color="#000080">[</font>Xa<font color="#000080">]+</font>Z<font color="#000080">*</font>CoSine<font color="#000080">[</font>Xa<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
  </font>Y<font color="#000080">:=</font>Yt<font color="#000080">;</font>Z<font color="#000080">:=</font>Zt<font color="#000080">; </font>Xt<font color="#000080">:=</font>Sar<font color="#000080">(</font>X<font color="#000080">*</font>CoSine<font color="#000080">[</font>Ya<font color="#000080">]-</font>Z<font color="#000080">*</font>Sine<font color="#000080">[</font>Ya<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
  </font>Zt<font color="#000080">:=</font>Sar<font color="#000080">(</font>X<font color="#000080">*</font>Sine<font color="#000080">[</font>Ya<font color="#000080">]+</font>Z<font color="#000080">*</font>CoSine<font color="#000080">[</font>Ya<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">); </font>X<font color="#000080">:=</font>Xt<font color="#000080">;</font>Z<font color="#000080">:=</font>Zt<font color="#000080">;
  </font>Xt<font color="#000080">:=</font>Sar<font color="#000080">(</font>X<font color="#000080">*</font>CoSine<font color="#000080">[</font>Za<font color="#000080">]-</font>Y<font color="#000080">*</font>Sine<font color="#000080">[</font>Za<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);</font>Yt<font color="#000080">:=</font>Sar<font color="#000080">(</font>X<font color="#000080">*</font>Sine<font color="#000080">[</font>Za<font color="#000080">]+</font>Y<font color="#000080">*</font>CoSine<font color="#000080">[</font>Za<font color="#000080">],</font><font color="#800000">12</font><font color="#000080">);
  </font>X<font color="#000080">:=</font>Xt<font color="#000080">; </font>Y<font color="#000080">:=</font>Yt<font color="#000080">; </font>World<font color="#000080">[</font>C<font color="#000080">].</font>x<font color="#000080">:=</font>X<font color="#000080">; </font>World<font color="#000080">[</font>C<font color="#000080">].</font>y<font color="#000080">:=</font>Y<font color="#000080">; </font>World<font color="#000080">[</font>C<font color="#000080">].</font>z<font color="#000080">:=</font>Z<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Project<font color="#000080">(</font>World <font color="#000080">: </font>Coords<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Screen <font color="#000080">: </font>ScreenList<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>C <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin For </b></font>C <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do Begin
 </b></font>Screen<font color="#000080">[</font>C<font color="#000080">].</font>x <font color="#000080">:= (</font>World<font color="#000080">[</font>C<font color="#000080">].</font>X <font color="#FF0000"><b>Shl </b></font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font><font color="#800000">512</font><font color="#000080">-</font>World<font color="#000080">[</font>C<font color="#000080">].</font>Z<font color="#000080">) + </font><font color="#800000">160</font><font color="#000080">;
 </font>Screen<font color="#000080">[</font>C<font color="#000080">].</font>y <font color="#000080">:= (</font>World<font color="#000080">[</font>C<font color="#000080">].</font>Y <font color="#FF0000"><b>Shl </b></font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font><font color="#800000">512</font><font color="#000080">-</font>World<font color="#000080">[</font>C<font color="#000080">].</font>Z<font color="#000080">) + </font><font color="#800000">100</font><font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Intensity<font color="#000080">(</font>World<font color="#000080">:</font>Coords<font color="#000080">;</font>Poly<font color="#000080">:</font>SinglePoly<font color="#000080">;</font>Normal<font color="#000080">:</font>NormCoord<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>Viewer <font color="#000080">: </font>NormCoord <font color="#000080">= (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">4096</font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Dot <font color="#000080">: </font>Longint<font color="#000080">; </font>Temp <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Dot <font color="#000080">:= </font>Viewer<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]*</font>Normal<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]; </font><font color="#FF0000"><b>If </b></font>Dot <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Temp <font color="#000080">:= </font><font color="#800000">$ff00 </font><font color="#FF0000"><b>Else </b></font>Temp <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Hi<font color="#000080">(</font>Temp<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Temp<font color="#000080">:=</font>Temp<font color="#000080">+((</font>Dot <font color="#FF0000"><b>Shr </b></font><font color="#800000">12</font><font color="#000080">)*</font>NumColors<font color="#000080">) </font><font color="#FF0000"><b>Shr </b></font><font color="#800000">12</font><font color="#000080">;
  </font>Intensity <font color="#000080">:= </font>Temp<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>HLine<font color="#000080">(</font>X1<font color="#000080">, </font>X2<font color="#000080">, </font>Y <font color="#000080">: </font>Integer<font color="#000080">; </font>Color <font color="#000080">: </font>Byte<font color="#000080">; </font>P<font color="#000080">:</font>PVScreen<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Y <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">; </font><font color="#FF0000"><b>If </b></font>Y <font color="#000080">&gt; </font><font color="#800000">199 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>X2 <font color="#000080">&gt; </font>X1 <font color="#FF0000"><b>Then Begin If </b></font>X1 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>X1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>X2 <font color="#000080">&gt; </font><font color="#800000">319 </font><font color="#FF0000"><b>Then </b></font>X2 <font color="#000080">:= </font><font color="#800000">319</font><font color="#000080">;
  </font>FillChar<font color="#000080">(</font>Mem<font color="#000080">[</font>Seg<font color="#000080">(</font>P<font color="#000080">^):</font>Ofs<font color="#000080">(</font>P<font color="#000080">^)+</font>Y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+</font>X1<font color="#000080">], </font>X2<font color="#000080">-</font>X1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">, </font>Color<font color="#000080">); </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DrawPoly<font color="#000080">(</font>S <font color="#000080">: </font>ScreenList<font color="#000080">; </font>P <font color="#000080">: </font>SinglePoly<font color="#000080">; </font>Color <font color="#000080">: </font>Byte<font color="#000080">; </font>Page<font color="#000080">:</font>PVScreen<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x11<font color="#000080">,</font>y11<font color="#000080">,</font>x22<font color="#000080">,</font>y22<font color="#000080">,</font>StartV1<font color="#000080">,</font>EndV1<font color="#000080">,</font>StartV2<font color="#000080">,</font>EndV2 <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Dx1<font color="#000080">, </font>Dx2<font color="#000080">,</font>Count1<font color="#000080">, </font>Count2<font color="#000080">,</font>XVal1<font color="#000080">, </font>XVal2<font color="#000080">,</font>MinY<font color="#000080">,</font>C<font color="#000080">, </font>EdgeCount <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>EdgeCount <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">; </font>MinY <font color="#000080">:= </font><font color="#800000">22300</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>C <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>EdgeCount<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do
   Begin If </b></font>S<font color="#000080">[</font>P<font color="#000080">[</font>c<font color="#000080">]].</font>Y <font color="#000080">&lt; </font>MinY <font color="#FF0000"><b>Then Begin </b></font>MinY <font color="#000080">:= </font>S<font color="#000080">[</font>P<font color="#000080">[</font>c<font color="#000080">]].</font>Y<font color="#000080">; </font>StartV1 <font color="#000080">:= </font>C<font color="#000080">; </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>StartV2<font color="#000080">:=</font>StartV1<font color="#000080">; </font>EndV1<font color="#000080">:=</font>StartV1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>EndV2<font color="#000080">:=</font>StartV2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>EndV1 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>EndV1 <font color="#000080">:= (</font><font color="#800000">4</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">); </font><font color="#FF0000"><b>If </b></font>EndV2 <font color="#000080">&gt;= </font><font color="#800000">4 </font><font color="#FF0000"><b>Then </b></font>EndV2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>MinY<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>Y<font color="#000080">; </font>X1<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>X<font color="#000080">; </font>Y1<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>Y<font color="#000080">;
  </font>X2<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV1<font color="#000080">]].</font>X<font color="#000080">; </font>Y2<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV1<font color="#000080">]].</font>Y<font color="#000080">; </font>Dx1<font color="#000080">:=((</font>X2<font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>Y2<font color="#000080">-</font>Y1<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>Count1<font color="#000080">:=</font>Y2<font color="#000080">-</font>Y1<font color="#000080">; </font>XVal1<font color="#000080">:=</font>X1 <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">; </font>X11<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV2<font color="#000080">]].</font>X<font color="#000080">; </font>Y11<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV2<font color="#000080">]].</font>Y<font color="#000080">;
  </font>X22<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV2<font color="#000080">]].</font>X<font color="#000080">; </font>Y22<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV2<font color="#000080">]].</font>Y<font color="#000080">;
  </font>Dx2<font color="#000080">:=((</font>X22<font color="#000080">-</font>X11<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>Y22<font color="#000080">-</font>Y11<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>Count2<font color="#000080">:=</font>Y22<font color="#000080">-</font>Y11<font color="#000080">; </font>XVal2 <font color="#000080">:=</font>X11 <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>EdgeCount <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    Begin
      While </b></font><font color="#000080">(</font>Count1 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Count2 <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
        Begin </b></font>HLine<font color="#000080">(</font>XVal1 <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">, </font>XVal2 <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">, </font>MinY<font color="#000080">, </font>Color<font color="#000080">, </font>Page<font color="#000080">);
          </font>XVal1 <font color="#000080">:= </font>XVal1 <font color="#000080">+ </font>Dx1<font color="#000080">; </font>XVal2 <font color="#000080">:= </font>XVal2 <font color="#000080">+ </font>Dx2<font color="#000080">;
          </font>Count1 <font color="#000080">:= </font>Count1 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>Count2 <font color="#000080">:= </font>Count2 <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>MinY <font color="#000080">:= </font>MinY <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Count1 <font color="#000080">= </font><font color="#800000">0
        </font><font color="#FF0000"><b>Then Begin
          </b></font>StartV1<font color="#000080">:=</font>EndV1<font color="#000080">;</font>EndV1<font color="#000080">:=</font>EndV1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>If </b></font>EndV1 <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>EndV1<font color="#000080">:=(</font><font color="#800000">4</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
          </font>EdgeCount <font color="#000080">:= </font>EdgeCount <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">; </font>MinY <font color="#000080">:= </font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>Y<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>MinY <font color="#000080">&gt; </font><font color="#800000">319 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
          </font>X1 <font color="#000080">:= </font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>X<font color="#000080">; </font>Y1 <font color="#000080">:= </font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV1<font color="#000080">]].</font>Y<font color="#000080">; </font>X2 <font color="#000080">:= </font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV1<font color="#000080">]].</font>X<font color="#000080">;
          </font>Y2<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV1<font color="#000080">]].</font>Y<font color="#000080">; </font>Dx1<font color="#000080">:=((</font>X2<font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>Abs<font color="#000080">(</font>Y2<font color="#000080">-</font>Y1<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
          </font>Count1 <font color="#000080">:= </font>Y2<font color="#000080">-</font>Y1<font color="#000080">; </font>XVal1<font color="#000080">:=</font>X1 <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Count2 <font color="#000080">= </font><font color="#800000">0
        </font><font color="#FF0000"><b>Then Begin
          </b></font>StartV2<font color="#000080">:=</font>EndV2<font color="#000080">;</font>EndV2<font color="#000080">:=</font>EndV2<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">; </font><font color="#FF0000"><b>If </b></font>EndV2 <font color="#000080">&gt;= </font><font color="#800000">4 </font><font color="#FF0000"><b>Then </b></font>EndV2 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>EdgeCount<font color="#000080">:=</font>EdgeCount<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font>MinY<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV2<font color="#000080">]].</font>Y<font color="#000080">;
          </font><font color="#FF0000"><b>If </b></font>MinY <font color="#000080">&gt; </font><font color="#800000">319 </font><font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">; </font>X11<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV2<font color="#000080">]].</font>X<font color="#000080">;</font>Y11<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>StartV2<font color="#000080">]].</font>Y<font color="#000080">;
          </font>X22<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV2<font color="#000080">]].</font>X<font color="#000080">;</font>Y22<font color="#000080">:=</font>S<font color="#000080">[</font>P<font color="#000080">[</font>EndV2<font color="#000080">]].</font>Y<font color="#000080">;
          </font>Dx2<font color="#000080">:=((</font>X22<font color="#000080">-</font>X11<font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#000080">(</font>Abs<font color="#000080">(</font>Y22<font color="#000080">-</font>Y11<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">); </font>Count2 <font color="#000080">:= </font>Y22<font color="#000080">-</font>Y11<font color="#000080">;
          </font>XVal2 <font color="#000080">:= </font>X11 <font color="#FF0000"><b>Shl </b></font><font color="#800000">8</font><font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Display<font color="#000080">(</font>World <font color="#000080">: </font>Coords<font color="#000080">; </font>Normals <font color="#000080">: </font>Norms<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>x <font color="#000080">: </font>Integer<font color="#000080">; </font>Temp <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin </b></font>Project<font color="#000080">(</font>WorldCds<font color="#000080">, </font>ScreenCoords<font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>do
    Begin </b></font>Temp <font color="#000080">:= </font>Intensity<font color="#000080">(</font>WorldCds<font color="#000080">, </font>PolyDesc<font color="#000080">[</font>x<font color="#000080">], </font>WNormals<font color="#000080">[</font>x<font color="#000080">]);
     </font><font color="#FF0000"><b>If </b></font>Hi<font color="#000080">(</font>Temp<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>DrawPoly<font color="#000080">(</font>ScreenCoords<font color="#000080">,</font>PolyDesc<font color="#000080">[</font>x<font color="#000080">],</font>Lo<font color="#000080">(</font>Temp<font color="#000080">),</font>Page1<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{ ******************** End Display Procedures ******************** }

</i></font><font color="#FF0000"><b>Var </b></font>a<font color="#000080">, </font>b<font color="#000080">, </font>c <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>InitGraph<font color="#000080">; </font>CalcSinus<font color="#000080">; </font>InitPal<font color="#000080">; </font>a<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>b<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>c<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>Frame<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>STime<font color="#000080">:=</font>Time<font color="#000080">;
  </font><font color="#FF0000"><b>Repeat </b></font>Cls<font color="#000080">(</font>Page1<font color="#000080">^);
    </font>Rotate3D<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font>LocalCds<font color="#000080">,</font>WorldCds<font color="#000080">);</font>Rotate3D<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">,</font>c<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font>LNormals<font color="#000080">,</font>WNormals<font color="#000080">);
    </font>Display<font color="#000080">(</font>WorldCds<font color="#000080">, </font>WNormals<font color="#000080">); </font>CopyWin<font color="#000080">(</font>Page1<font color="#000080">^, </font>Page0<font color="#000080">^);
    </font>a<font color="#000080">:=</font>a<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;</font>b<font color="#000080">:=</font>b<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">;</font>c<font color="#000080">:=</font>c<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;</font>Frame<font color="#000080">:=</font>Frame<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>a<font color="#000080">&gt;</font><font color="#800000">511 </font><font color="#FF0000"><b>Then </b></font>a<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>If </b></font>b<font color="#000080">&gt;</font><font color="#800000">511 </font><font color="#FF0000"><b>Then </b></font>b<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>If </b></font>c<font color="#000080">&gt;</font><font color="#800000">511 </font><font color="#FF0000"><b>Then </b></font>c<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>Port<font color="#000080">[</font><font color="#800000">$60</font><font color="#000080">]=</font><font color="#800000">1</font><font color="#000080">; </font>ETime <font color="#000080">:= </font>Time<font color="#000080">;
  </font>CloseGraph<font color="#000080">; </font>Writeln<font color="#000080">((</font>Frame<font color="#000080">*</font><font color="#800000">18.2</font><font color="#000080">)/(</font>ETime<font color="#000080">-</font>STime<font color="#000080">):</font><font color="#800000">5</font><font color="#000080">:</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">' fps'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0201.PAS">Original</a><b>]</b></p></body>
</html>
