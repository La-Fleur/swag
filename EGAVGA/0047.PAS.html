<html>
<head><title> "VGA ClrScr #3" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I also wanted to put a picture bigger than the screen to scroll over
For the intro.  --  ANIVGA  --
}

</i></font><font color="#FF0000"><b>Program </b></font>ScrollExample<font color="#000080">;
</font><font color="#008000"><i>{Demonstrates how to use the VGA's hardware scroll to do some nice opening}
{sequence: the Program loads 3 Graphic pages With data and then scrolls   }
{them by. note that this erases the contents of the background page and   }
{thus shouldn't be used While animating sprites in parallel!}

</i></font><font color="#FF0000"><b>Uses
  </b></font>ANIVGA<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>IntroScroll<font color="#000080">(</font>n<font color="#000080">,</font>wait<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#008000"><i>{ in: n    = # rows to scroll up using hardware zoom}
{     wait = time (in ms) to wait after each row    }
{rem: Scrolling *always* starts at page 0 (=$A000:0000)   }
{     Thus, issuing &quot;Screen(1-page)&quot; afterwards is a must!}
{     if you put the routine into ANIVGA.PAS, you should delete all the}
{     Constants following this line}
</i></font><font color="#FF0000"><b>Const
  </b></font>StartIndex<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
  </font>endIndex<font color="#000080">=</font>StartIndex<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">;
  </font><font color="#008000"><i>{offsetadressen der Grafikseiten (in Segment $A000):}
  </i></font>offset_Adr<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font>StartIndex<font color="#000080">..</font>endIndex<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">=(</font><font color="#800000">$0000</font><font color="#000080">,</font><font color="#800000">$3E80</font><font color="#000080">,</font><font color="#800000">$7D00</font><font color="#000080">,</font><font color="#800000">$BB80</font><font color="#000080">);
  </font>CrtAddress<font color="#000080">=</font><font color="#800000">$3D4</font><font color="#000080">; </font><font color="#008000"><i>{if monochrome: $3B4}
  </i></font>StatusReg <font color="#000080">=</font><font color="#800000">$3DA</font><font color="#000080">; </font><font color="#008000"><i>{if monochrome: $3BA}
</i></font><font color="#FF0000"><b>begin
  </b></font>Screen<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);                  </font><font color="#008000"><i>{position at $A000:0000}
  </i></font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">xor SI,SI                </font><font color="#008000"><i>{use page address 0 }
    </i></font><font color="#FF00FF">and SI,3
    SHL SI,1
    ADD SI,ofFSET offset_Adr-StartIndex*2 </font><font color="#008000"><i>{call this &quot;defensive Programming&quot;..}
    </i></font><font color="#FF00FF">LODSW
    MOV BX,AX
    MOV CX,n
    MOV SI,wait
  @oneline:
    ADD BX,LinESIZE
    CLI                      </font><font color="#008000"><i>{no inTs please!}
    </i></font><font color="#FF00FF">MOV DX,StatusReg
    @WaitnotHSyncLoop:
      in   al,dx
      and  al,1
      jz  @WaitnotHSyncLoop
    @WaitHSyncLoop:
      in   al,dx
      and  al,1
      jz   @WaitHSyncLoop
    MOV DX,CrtAddress        </font><font color="#008000"><i>{Crt-controller}
    </i></font><font color="#FF00FF">MOV AL,$0D               </font><font color="#008000"><i>{LB-startaddress-register}
    </i></font><font color="#FF00FF">OUT DX,AL
    inC DX

    MOV AL,BL
    OUT DX,AL                </font><font color="#008000"><i>{set new LB of starting address}
    </i></font><font color="#FF00FF">DEC DX
    MOV AL,$0C
    OUT DX,AL
    inC DX
    MOV AL,BH                </font><font color="#008000"><i>{dto., HB}
    </i></font><font color="#FF00FF">OUT DX,AL
    STI

    PUSH BX
    PUSH CX
    PUSH SI
    PUSH SI
    CALL Crt.Delay
    POP SI
    POP CX
    POP BX
    LOOP @oneline
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>InitGraph<font color="#000080">; </font><font color="#008000"><i>{Program VGA into Graphic mode, clear all pages}

 {--- Start of Intro ---}
 </i></font>Screen<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{or SCROLLPAGE, just an aesthetic question...}
 {Load 3 pages With pics, or draw them:}
 </i></font>LoadPage<font color="#000080">(</font><font color="#800000">'1st.PIC'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
 </font>LoadPage<font color="#000080">(</font><font color="#800000">'2nd.PIC'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
 </font>LoadPage<font color="#000080">(</font><font color="#800000">'3rd.PIC'</font><font color="#000080">,</font>BackgndPage<font color="#000080">);
 </font>IntroScroll<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">*</font><font color="#800000">200</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">); </font><font color="#008000"><i>{scroll up 3 pages, wait 20ms}
 </i></font>Delay<font color="#000080">(</font><font color="#800000">3000</font><font color="#000080">); </font><font color="#008000"><i>{wait a few seconds}
 </i></font>Screen<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">-</font>page<font color="#000080">); </font><font color="#008000"><i>{restore correct mode}
 {--- end of Intro ---}

 {now do your animations as usual}
 {...}
 </i></font>CloseRoutines<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{
if you adjust LoadPage() to allow loading into Graphic page 3 (=SCROLLPAGE),
too, you may easily do a 4 screen hardware scroll!
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0047.PAS">Original</a><b>]</b></p></body>
</html>
