<html>
<head><title> "BitMap Scaler" by BERNIE PALLEK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>TYPE
  </b></font>Fixed <font color="#000080">= </font><font color="#FF0000"><b>RECORD CASE </b></font>Boolean <font color="#FF0000"><b>OF
    </b></font>True  <font color="#000080">: (</font>w <font color="#000080">: </font>LongInt<font color="#000080">); </font>False <font color="#000080">: (</font>f<font color="#000080">, </font>i <font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ originally by SEAN PALMER, I just mangled it  :^) }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ScaleBitmap<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>bmp2scale<font color="#000080">; </font>actualx<font color="#000080">, </font>actualy <font color="#000080">: </font>Byte<font color="#000080">;
                      </font>bstrtx<font color="#000080">, </font>bstrty<font color="#000080">, </font>bendx<font color="#000080">, </font>bendy <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#008000"><i>{ These are notes I added, so they might be wrong.  :^)     }
{ - bmp2scale is an array [0..actualx, 0..actualy] of byte  }
{   which contains the original bitmap                      }
{ - actualx and actualy are the actual width and height of  }
{   the normal bitmap                                       }
{ - bstrtx and bstrty are the x and y values for the upper- }
{   left-hand corner of the scaled bitmap                   }
{ - bendx and bendy are the lower-right-hand corner of the  }
{   scaled version of the original bitmap                   }
{ - eg. to paste an unscaled version of a bitmap that is    }
{   64x64 pixels in size in the top left-hand corner of the }
{   screen, fill the array with data and call:              }
{     ScaleBitmap(bitmap, 64, 64, 0, 0, 63, 63);            }
{ - apparently, the bitmap is read starting at (0,0) and    }
{   then going to (0,1), then (0,2), etc; meaning that it's }
{   not read horizontally, but vertically                   }
</i></font><font color="#FF0000"><b>VAR
   </b></font>bmp_sx<font color="#000080">, </font>bmp_sy<font color="#000080">, </font>bmp_cy <font color="#000080">: </font>Fixed<font color="#000080">;
   </font>bmp_s<font color="#000080">, </font>bmp_w<font color="#000080">, </font>bmp_h    <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>bmp_w <font color="#000080">:= </font>bendx <font color="#000080">- </font>bstrtx <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">; </font>bmp_h <font color="#000080">:= </font>bendy <font color="#000080">- </font>bstrty <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
     </font>bmp_sx<font color="#000080">.</font>w <font color="#000080">:= </font>actualx <font color="#000080">* </font><font color="#800000">$10000 </font><font color="#FF0000"><b>DIV </b></font>bmp_w<font color="#000080">;
     </font>bmp_sy<font color="#000080">.</font>w <font color="#000080">:= </font>actualy <font color="#000080">* </font><font color="#800000">$10000 </font><font color="#FF0000"><b>DIV </b></font>bmp_h<font color="#000080">;
     </font>bmp_s <font color="#000080">:= </font><font color="#800000">320 </font><font color="#000080">- </font>bmp_w<font color="#000080">; </font>bmp_cy<font color="#000080">.</font>w <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">PUSH DS
        MOV DS,WORD PTR bmp2scale + 2
        MOV AX,$A000; MOV ES,AX; CLD; MOV AX,320;
        MUL bstrty; ADD ax,bstrtx; MOV DI,AX;
       @L2:
        MOV AX,bmp_cy.i; MUL actualx; MOV BX,AX;
        ADD BX,WORD PTR bmp2scale;
        MOV CX,bmp_w; MOV SI,0; MOV DX,bmp_sx.f;
       @L:
        MOV AL,[BX]; STOSB; ADD SI,DX; ADC BX,bmp_sx.i;
        LOOP @L
        ADD DI,bmp_s; MOV AX,bmp_sy.f; MOV bx,bmp_sy.i;
        ADD bmp_cy.f,AX; ADC bmp_cy.i,BX;
        DEC WORD PTR bmp_h; JNZ @L2; POP DS;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0069.PAS">Original</a><b>]</b></p></body>
</html>
