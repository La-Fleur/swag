<html>
<head><title> "Force Different Video Modes" by SCOTT TUNSTALL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0273.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
VMode
-----

Allows you to select your own mode to work in, could be very handy
if you can access the 132 x 25, 50 modes etc that SVGA supports.

Just imagine using DIR and seeing a whole directory on one page!


Usage:

VMODE &lt;video mode&gt;

Where video mode is a number in the range of 0 to 127.

}

</i></font><font color="#FF0000"><b>Procedure </b></font>Usage<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'VMODE, (C) 1995 Scott Tunstall.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Usage :'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'VMODE [FORCE] &lt;Video Mode required&gt;'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Where Video Mode can be one of the following :'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'      1 :  80 x 25'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'      2 : 132 x 25 (8 x 16 character size)'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'      3 : 132 x 43 (8 x 8 character size)'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'      4 : 132 x 25 (8 x 14 character size)'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'If your favourite video mode is not here you may force'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'it by using FORCE as the first parameter then the video'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'mode number as the second. (A list of all video mode'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'numbers should have come with your graphics card).'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'For example, to force graphics mode 93 which is the'</font><font color="#000080">);
     </font>Writeln<font color="#000080">(</font><font color="#800000">'1024 x 768 x 16 colour mode, you would type :'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'VMODE FORCE 93'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
I'm sorry for including the expletive, but if you have problems with
using this program then really you must be really stupid.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>YouArecluckingStupid<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Incorrect number of parameters ! Only 2 MAXIMUM allowed.'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#008000"><i>{
This procedure is called if their are two parameters and the
first parameter is not FORCE.. This routine has to be here because
I'll probably add more command line parameters as time goes on.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>ErrorInFirstParameter<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     </b></font>Writeln<font color="#000080">;
     </font>Writeln<font color="#000080">(</font><font color="#800000">'Error in the first parameter .. FORCE expected !'</font><font color="#000080">);
     </font>Writeln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#008000"><i>{
Set the desired video mode.

ModeWantedAsString is the string representation of the desired mode,
for example if you wanted mode 93 you pass in '93'. Easy eh? This
is here so that if I change the function of the parameters later
it'll still be easy to interface (?!!)

Oh, damn. Why do I bother ?
}

</i></font><font color="#FF0000"><b>Procedure </b></font>GoIntoVideoMode<font color="#000080">(</font>ModeWantedAsString<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>ModeNumber<font color="#000080">,
    </font>ErrorPosition<font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
     </b></font>Val<font color="#000080">(</font>ModeWantedAsString<font color="#000080">,</font>ModeNumber<font color="#000080">,</font>ErrorPosition<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>ErrorPosition <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        Begin
        If </b></font><font color="#000080">(</font>ModeNumber <font color="#000080">&gt;-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>ModeNumber<font color="#000080">&lt; </font><font color="#800000">128</font><font color="#000080">) </font><font color="#FF0000"><b>Then
           Asm
           </b></font><font color="#FF00FF">MOV AX,ModeNumber    </font><font color="#008000"><i>{ Mode number is an integer }
           </i></font><font color="#FF00FF">INT $10              </font><font color="#008000"><i>{ Video mode set by AL }
           </i></font><font color="#FF0000"><b>End
        Else
            Begin
            </b></font>Writeln<font color="#000080">;
            </font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot set this video mode, video mode number'</font><font color="#000080">);
            </font>Writeln<font color="#000080">(</font><font color="#800000">'MUST be in the range of 0-127 ! .'</font><font color="#000080">);
            </font>Writeln<font color="#000080">;
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>End
     Else
         Begin
         </b></font>Writeln<font color="#000080">(</font><font color="#800000">'Cannot set video mode - second parameter is not numeric !'</font><font color="#000080">);
         </font>Writeln<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
A nice 'n' easy routine here. Pass in the video mode ya want
as a short integer and the computer'll set the video mode,
if it supports it that is.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>UseVideoMode<font color="#000080">(</font>VideoModeNumber<font color="#000080">: </font>shortint<font color="#000080">); </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">XOR AH,AH                    </font><font color="#008000"><i>{ Function 0 = Set Video Mode }
   </i></font><font color="#FF00FF">MOV AL, VideoModeNumber      </font><font color="#008000"><i>{ Load AL with mode wanted }
   </i></font><font color="#FF00FF">INT $10                      </font><font color="#008000"><i>{ Execute Video interrupt }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{
Convert a string to it's upper case equivalent. TheString is
a string of any length less than 256 characters, and on exit
the string var passed in is now entirely uppercase! Good eh?
}

</i></font><font color="#FF0000"><b>Procedure </b></font>ConvertToUpCase<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>TheString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Count<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     for </b></font>Count <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>TheString<font color="#000080">) </font><font color="#FF0000"><b>do
         </b></font>TheString<font color="#000080">[</font>Count<font color="#000080">] := </font>UpCase<font color="#000080">(</font>TheString<font color="#000080">[</font>Count<font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;




</font><font color="#008000"><i>{
Check what option the user has selected. (And of course, if
the option is valid)
}


</i></font><font color="#FF0000"><b>Procedure </b></font>CheckVideoModeOptions<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>FirstParam<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>VideoModePresetNum<font color="#000080">: </font>byte<font color="#000080">;
    </font>ErrorPosition<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
     If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
        Begin
        </b></font>FirstParam<font color="#000080">:=</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
        </font>ConvertToUpCase<font color="#000080">(</font>FirstParam<font color="#000080">);

        </font><font color="#008000"><i>{
        I'll probably add extra parameters later.
        }

        </i></font><font color="#FF0000"><b>If </b></font>FirstParam <font color="#000080">= </font><font color="#800000">'FORCE' </font><font color="#FF0000"><b>Then
           </b></font>GoIntoVideoMode<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">))
        </font><font color="#FF0000"><b>Else
            </b></font>ErrorInFirstParameter<font color="#000080">;


        </font><font color="#FF0000"><b>End
     Else
         Begin
         </b></font>Val<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">),</font>VideoModePresetNum<font color="#000080">,</font>ErrorPosition<font color="#000080">);
         </font><font color="#FF0000"><b>Case </b></font>VideoModePresetNum <font color="#FF0000"><b>Of
              </b></font><font color="#800000">1 </font><font color="#000080">: </font>UseVideoMode<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
              </font><font color="#800000">2 </font><font color="#000080">: </font>UseVideoMode<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
              </font><font color="#800000">3 </font><font color="#000080">: </font>UseVideoMode<font color="#000080">(</font><font color="#800000">84</font><font color="#000080">);
              </font><font color="#800000">4 </font><font color="#000080">: </font>UseVideoMode<font color="#000080">(</font><font color="#800000">85</font><font color="#000080">);
         </font><font color="#FF0000"><b>Else
             Begin
             </b></font>Writeln<font color="#000080">;
             </font>Writeln<font color="#000080">(</font><font color="#800000">'Can''t set mode - Preset number is unsupported !'</font><font color="#000080">);
             </font>Writeln<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;





</font><font color="#008000"><i>{
The main program.

If no parameters are passed, then it is assumed that the user wants
to see the instructions for use.

If there is 1 parameter, then it is assumed that the user wants
to use a preset text mode in the range of 1 - 4 .

If there are two parameters, then the first parameter must be checked,
and acted on appropriately to determine an action. Currently only 1
option type exists, &quot;FORCE&quot;. The second parameter, with FORCE,
specifies the video mode to set.

}

</i></font><font color="#FF0000"><b>Begin
     If </b></font>ParamCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>Usage
     <font color="#FF0000"><b>Else
         If </b></font>ParamCount <font color="#000080">&gt;</font><font color="#800000">2 </font><font color="#FF0000"><b>Then
            </b></font>YouArecluckingStupid
         <font color="#FF0000"><b>Else
             </b></font>CheckVideoModeOptions<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0273.PAS">Original</a><b>]</b></p></body>
</html>
