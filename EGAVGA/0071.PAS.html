<html>
<head><title> "VESA Video Support" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>VESA<font color="#000080">;

</font><font color="#FF0000"><b>Interface

Type </b></font>ModeList<font color="#000080">=</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">32</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Word<font color="#000080">;  </font><font color="#008000"><i>{ List of VESA mode numbers }

     </i></font>TVesaMode<font color="#000080">=</font><font color="#FF0000"><b>Record
       </b></font>Attr     <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Mode Attributes                   }
       </i></font>WinA     <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Window A attributes               }
       </i></font>WinB     <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Window B attributes               }
       </i></font>Gran     <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Window granularity in K bytes     }
       </i></font>WinSiz   <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Size of window in K bytes         }
       </i></font>SegA     <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Segment address of window A       }
       </i></font>SegB     <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Segment address of window B       }
       </i></font>WinFunc  <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;    </font><font color="#008000"><i>{ Windows positioning function      }
       </i></font>Bytes    <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Number of bytes per line          }
       </i></font>Width    <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Number of horizontal pixels       }
       </i></font>Height   <font color="#000080">: </font>Word<font color="#000080">;         </font><font color="#008000"><i>{ Number of vertical pixels         }
       </i></font>CharW    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Width of character cell           }
       </i></font>CharH    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Height of character cell          }
       </i></font>Planes   <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Number of memory planes           }
       </i></font>Bits     <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Number of bits per pixel          }
       </i></font>nBanks   <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Number of banks        (not used) }
       </i></font>Model    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Memory model type                 }
       </i></font>Banks    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Size of bank           (not used) }
       </i></font>Pages    <font color="#000080">: </font>Byte<font color="#000080">;         </font><font color="#008000"><i>{ Number of image pages             }
       </i></font>Reserved <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{ The following are for 15,16,24,32 bit colour modes }
       </i></font>RedMaskSize   <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Size of Red mask in bits          }
       </i></font>RedFieldPos   <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Bit position of LSB of Red mask   }
       </i></font>GreenMaskSize <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Size of Green mask in bits        }
       </i></font>GreenFieldPos <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Bit position of LSB of Green mask }
       </i></font>BlueMaskSize  <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Size of Blue mask in bits         }
       </i></font>BlueFieldPos  <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Bit position of LSB of Blue mask  }
       </i></font>RsvdMaskSize  <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Size of Reserved mask in bits     }
       </i></font>RsvdFieldPos  <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Bit pos. of LSB of Reserved mask  }
       </i></font>DirColModeInf <font color="#000080">: </font>Byte<font color="#000080">;    </font><font color="#008000"><i>{ Direct Colour mode attributes     }
       </i></font>Filler   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">215</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Not used - filler        }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font>TVesaInfo<font color="#000080">=</font><font color="#FF0000"><b>Record
       </b></font>Signature    <font color="#000080">: </font>LongInt<font color="#000080">;   </font><font color="#008000"><i>{ Signature - &quot;VESA&quot;               }
       </i></font>Version      <font color="#000080">: </font>Word<font color="#000080">;      </font><font color="#008000"><i>{ VESA Version number              }
       </i></font>OEMName      <font color="#000080">: </font>PChar<font color="#000080">;     </font><font color="#008000"><i>{ Pointer to manufacturer name     }
       </i></font>Capabilities <font color="#000080">: </font>Longint<font color="#000080">;   </font><font color="#008000"><i>{ Capabilities       (Not used)    }
       </i></font>List         <font color="#000080">: ^</font>ModeList<font color="#000080">; </font><font color="#008000"><i>{ Pointer to list of VESA modes    }
       </i></font>TotalMemory  <font color="#000080">: </font>Word<font color="#000080">;      </font><font color="#008000"><i>{ Number of 64k memory blocks on card }
       </i></font>Filler       <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">238</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{ 258 byte size due to bug in the Diamond SpeedStar 24X v1.01 BIOS }


</i></font><font color="#FF0000"><b>Var  </b></font>VesaMode <font color="#000080">: </font>TVesaMode<font color="#000080">;
                </font><font color="#008000"><i>{ Contains all info needed for drawing on the screen }
     </i></font>VesaInfo <font color="#000080">: </font>TVesaInfo<font color="#000080">;
                </font><font color="#008000"><i>{ Contains info on the VESA BIOS Extensions }

     </i></font>vesaon   <font color="#000080">: </font>Byte<font color="#000080">;
                </font><font color="#008000"><i>{ Specifies whether a VESA mode is on or not      }

</i></font><font color="#FF0000"><b>Function  </b></font>IsVesa<font color="#000080">:</font>Boolean<font color="#000080">;
          </font><font color="#008000"><i>{ Detects whether VESA support is present }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetVesaInfo<font color="#000080">;
          </font><font color="#008000"><i>{ Get Information on VESA modes, etc }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetVesaModeInfo<font color="#000080">(</font>md<font color="#000080">:</font>Word<font color="#000080">);
          </font><font color="#008000"><i>{ Get Information on a VESA mode (md) }
</i></font><font color="#FF0000"><b>Function  </b></font>SetMode<font color="#000080">(</font>md<font color="#000080">:</font>Word<font color="#000080">):</font>Boolean<font color="#000080">;
          </font><font color="#008000"><i>{ Sets a video mode (OEM and VESA) }
</i></font><font color="#FF0000"><b>Function  </b></font>GetMode<font color="#000080">:</font>Word<font color="#000080">;
          </font><font color="#008000"><i>{ Returns the current video mode }
</i></font><font color="#FF0000"><b>Function  </b></font>SizeOfVideoState<font color="#000080">:</font>Word<font color="#000080">;
          </font><font color="#008000"><i>{ Returns the size of the buffer needed to save the video state }
</i></font><font color="#FF0000"><b>Procedure </b></font>SaveVideoState<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buf<font color="#000080">);
          </font><font color="#008000"><i>{ Saves the SVGA video state in the buffer }
</i></font><font color="#FF0000"><b>Procedure </b></font>RestoreVideoState<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buf<font color="#000080">);
          </font><font color="#008000"><i>{ Restores the SVGA video state from the buffer}
</i></font><font color="#FF0000"><b>Procedure </b></font>SetBank<font color="#000080">(</font>bank<font color="#000080">:</font>Word<font color="#000080">);
          </font><font color="#008000"><i>{ Set the video bank to draw on }
</i></font><font color="#FF0000"><b>Function  </b></font>GetBank<font color="#000080">:</font>Word<font color="#000080">;
          </font><font color="#008000"><i>{ Gets the current active video bank }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetLineLength<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>len<font color="#000080">:</font>Word<font color="#000080">);
          </font><font color="#008000"><i>{ Sets the logical scan line length, returns the actual length set }
</i></font><font color="#FF0000"><b>Function  </b></font>GetLineLength<font color="#000080">:</font>Word<font color="#000080">;
          </font><font color="#008000"><i>{ Returns the current logical scan line length }
</i></font><font color="#FF0000"><b>Procedure </b></font>SetDisplayStart<font color="#000080">(</font>pixel<font color="#000080">,</font>line<font color="#000080">:</font>Word<font color="#000080">);
          </font><font color="#008000"><i>{ Sets the first pixel and line on the display }
</i></font><font color="#FF0000"><b>Procedure </b></font>GetDisplayStart<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>pixel<font color="#000080">,</font>line<font color="#000080">:</font>Word<font color="#000080">);
          </font><font color="#008000"><i>{ Returns the first pixel and line on the display }

{---------------------------------------------------------------------------}
{-----------------------------} </i></font><font color="#FF0000"><b>Implementation </b></font><font color="#008000"><i>{----------------------------}
{---------------------------------------------------------------------------}

</i></font><font color="#FF0000"><b>Uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Var  </b></font>rp <font color="#000080">: </font>Registers<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>IsVesa<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F03</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>IsVesa<font color="#000080">:=(</font>rp<font color="#000080">.</font>al<font color="#000080">=</font><font color="#800000">$4F</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetVesaInfo<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F00</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>di<font color="#000080">:=</font>Ofs<font color="#000080">(</font>VesaInfo<font color="#000080">);
  </font>rp<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>VesaInfo<font color="#000080">);
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetVesaModeInfo<font color="#000080">(</font>md<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F01</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font>md<font color="#000080">;
  </font>rp<font color="#000080">.</font>di<font color="#000080">:=</font>Ofs<font color="#000080">(</font>VesaMode<font color="#000080">);
  </font>rp<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>VesaMode<font color="#000080">);
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SetMode<font color="#000080">(</font>md<font color="#000080">:</font>Word<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>SetMode<font color="#000080">:=</font>True<font color="#000080">; </font>vesaon<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>md<font color="#000080">&gt;</font><font color="#800000">$FF </font><font color="#FF0000"><b>Then Begin
    </b></font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font>md<font color="#000080">;
    </font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F02</font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>rp<font color="#000080">.</font>ax<font color="#000080">&lt;&gt;</font><font color="#800000">$4F </font><font color="#FF0000"><b>Then </b></font>SetMode<font color="#000080">:=</font>False <font color="#FF0000"><b>Else </b></font>GetVesaModeInfo<font color="#000080">(</font>md<font color="#000080">);
  </font><font color="#FF0000"><b>End Else Begin
    </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font>md<font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
    </font>VesaMode<font color="#000080">.</font>Gran<font color="#000080">:=</font><font color="#800000">64</font><font color="#000080">; </font>vesaon<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>VesaMode<font color="#000080">.</font>SegA<font color="#000080">:=</font><font color="#800000">$A000</font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>md <font color="#FF0000"><b>Of  </b></font><font color="#008000"><i>{ OEM (standard) video modes }
      </i></font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">7 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin </b></font><font color="#008000"><i>{ Text modes }
                 </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;  </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">25</font><font color="#000080">;
                 </font><font color="#FF0000"><b>If </b></font>md<font color="#000080">=</font><font color="#800000">7 </font><font color="#FF0000"><b>Then Begin
                   </b></font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;  </font>VesaMode<font color="#000080">.</font>SegA<font color="#000080">:=</font><font color="#800000">$B000</font><font color="#000080">;
                 </font><font color="#FF0000"><b>End Else Begin
                   </b></font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;  </font>VesaMode<font color="#000080">.</font>SegA<font color="#000080">:=</font><font color="#800000">$B800</font><font color="#000080">;
                 </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                 </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">160</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
               </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#800000">$13 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ 320 x 200 x 256 colours, VGA &amp; MCGA }
              </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">8</font><font color="#000080">;    </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#800000">$12 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ 640 x 480 x 16 colours, VGA only }
              </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">640</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">480</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;    </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#800000">$10 </font><font color="#000080">: </font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ 640 x 350 x 16 colours, VGA &amp; EGA with 128k+ }
              </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">640</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">350</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;    </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#800000">$0E </font><font color="#000080">: </font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ 640 x 200 x 16 colours, VGA &amp; EGA }
              </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">640</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;    </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#800000">$0D </font><font color="#000080">: </font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ 320 x 200 x 16 colours, VGA &amp; EGA }
              </i></font>VesaMode<font color="#000080">.</font>Width<font color="#000080">:=</font><font color="#800000">320</font><font color="#000080">; </font>VesaMode<font color="#000080">.</font>Height<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bits<font color="#000080">:=</font><font color="#800000">4</font><font color="#000080">;    </font>VesaMode<font color="#000080">.</font>Model<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">;
              </font>VesaMode<font color="#000080">.</font>Bytes<font color="#000080">:=</font><font color="#800000">40</font><font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Else </b></font>SetMode<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetMode<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F03</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>GetMode<font color="#000080">:=</font>rp<font color="#000080">.</font>bx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>SizeOfVideoState<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin  </b></font><font color="#008000"><i>{ Will save/restore all video states }
  </i></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F04</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>dl<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">$0F</font><font color="#000080">;  </font><font color="#008000"><i>{ hardware, BIOS, DAC &amp; SVGA states }
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>SizeOfVideoState<font color="#000080">:=</font>rp<font color="#000080">.</font>bx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SaveVideoState<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buf<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F04</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>dl<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">$0F</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>buf<font color="#000080">);
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font>Ofs<font color="#000080">(</font>buf<font color="#000080">);
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>RestoreVideoState<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>buf<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F04</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>dl<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">$0F</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>buf<font color="#000080">);
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font>Ofs<font color="#000080">(</font>buf<font color="#000080">);
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBank<font color="#000080">(</font>bank<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>winnum<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>winnum<font color="#000080">:=</font>bank<font color="#000080">*</font><font color="#800000">64 </font><font color="#FF0000"><b>Div </b></font>VesaMode<font color="#000080">.</font>Gran<font color="#000080">;
  </font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F05</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>dx<font color="#000080">:=</font>winnum<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F05</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>dx<font color="#000080">:=</font>winnum<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetBank<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F05</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">$100</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>GetBank<font color="#000080">:=</font>rp<font color="#000080">.</font>dx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetLineLength<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>len<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F06</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bl<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font>len<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">); </font><font color="#008000"><i>{ dx:=maximum number of scan lines }
  </i></font>len<font color="#000080">:=</font>rp<font color="#000080">.</font>cx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetLineLength<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F06</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bl<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">); </font><font color="#008000"><i>{ dx:=maximum number of scan lines }
  </i></font>GetLineLength<font color="#000080">:=</font>rp<font color="#000080">.</font>cx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetDisplayStart<font color="#000080">(</font>pixel<font color="#000080">,</font>line<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F07</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>cx<font color="#000080">:=</font>pixel<font color="#000080">;
  </font>rp<font color="#000080">.</font>dx<font color="#000080">:=</font>line<font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GetDisplayStart<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>pixel<font color="#000080">,</font>line<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>rp<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$4F07</font><font color="#000080">;
  </font>rp<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>rp<font color="#000080">);
  </font>pixel<font color="#000080">:=</font>rp<font color="#000080">.</font>cx<font color="#000080">;
  </font>line<font color="#000080">:=</font>rp<font color="#000080">.</font>dx<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0071.PAS">Original</a><b>]</b></p></body>
</html>
