<html>
<head><title> "Tweaked 256x256x256 Chained" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0175.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here's something funny to play with. I got it from Tweak by Robert Schmidt of
Ztiff Zox Softwear (just quoting here...), which I FTP'ed. It was written in
C, and rather buggy (as ever with C). Anyway, he called it mode-q, because of
the 3 times 256: cubed. I even documented it a bit. You can alter the
horizontal position by playing with reg $3d4, func $4 for instance. None of
those blew my monitor up, so I guess it won't do any harm on yours. But don't
start complaining if it does: use at your own risk! &lt;btw: as far as I know
it's not possible to harm the VGA-monitor. If you have a EGA or worse, you
better not run this&gt;
}
</i></font><font color="#FF0000"><b>program </b></font>tweak256x256chained<font color="#000080">;
</font><font color="#008000"><i>{ Original by Robert Schmidt in C, converted to Pas by Bas van Gaalen,
  fido: 2:285/213.8, email: bas.van.gaalen@schotman.nl, Holland, Aug. '94, PD }
</i></font><font color="#FF0000"><b>const
  </b></font>vidseg<font color="#000080">:</font>word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>twrec<font color="#000080">=</font><font color="#FF0000"><b>record </b></font>reg<font color="#000080">:</font>word<font color="#000080">; </font>func<font color="#000080">,</font>data<font color="#000080">:</font>byte<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>twarr<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">22</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>twrec<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>tweak<font color="#000080">:</font>twarr<font color="#000080">=(
    (</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$00</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$5f</font><font color="#000080">), </font><font color="#008000"><i>{ hor. total }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$3f</font><font color="#000080">), </font><font color="#008000"><i>{ hor. display enable end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$02</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ blank start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$03</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$82</font><font color="#000080">), </font><font color="#008000"><i>{ blank end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$04</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$4e</font><font color="#000080">), </font><font color="#008000"><i>{ retrace start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$9a</font><font color="#000080">), </font><font color="#008000"><i>{ retrace end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$06</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$23</font><font color="#000080">), </font><font color="#008000"><i>{ vertical total }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$07</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$b2</font><font color="#000080">), </font><font color="#008000"><i>{ overflow register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$08</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$00</font><font color="#000080">), </font><font color="#008000"><i>{ preset row scan }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$09</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$61</font><font color="#000080">), </font><font color="#008000"><i>{ max scan line/char heigth }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$10</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$0a</font><font color="#000080">), </font><font color="#008000"><i>{ ver. retrace start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$11</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$ac</font><font color="#000080">), </font><font color="#008000"><i>{ ver. retrace end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$12</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$ff</font><font color="#000080">), </font><font color="#008000"><i>{ ver. display enable end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$13</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$20</font><font color="#000080">), </font><font color="#008000"><i>{ offset/logical width }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$14</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ underlinde location }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$15</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$07</font><font color="#000080">), </font><font color="#008000"><i>{ ver. blank start }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$16</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">), </font><font color="#008000"><i>{ ver. blank end }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03d4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$a3</font><font color="#000080">), </font><font color="#008000"><i>{ mode control }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$01</font><font color="#000080">), </font><font color="#008000"><i>{ clock mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c4</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$04</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$0e</font><font color="#000080">), </font><font color="#008000"><i>{ memory mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03ce</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$40</font><font color="#000080">), </font><font color="#008000"><i>{ mode register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03ce</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$06</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$05</font><font color="#000080">), </font><font color="#008000"><i>{ misc. register }
    </i></font><font color="#000080">(</font>reg<font color="#000080">:</font><font color="#800000">$03c0</font><font color="#000080">; </font>func<font color="#000080">:</font><font color="#800000">$10</font><font color="#000080">; </font>data<font color="#000080">:</font><font color="#800000">$41</font><font color="#000080">)  </font><font color="#008000"><i>{ mode control }
  </i></font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>col<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b <font color="#000080">: </font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03c8h; mov al,col; out dx,al; inc dx; mov al,r; out dx,al
  mov al,g; out dx,al; mov al,b; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>initvga<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,13h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>inittxt<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,3; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>openregs<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03d4h; mov al,11h; out dx,al; inc dx; in al,dx; and al,7fh
  mov ah,al; mov al,11h; dec dx; out dx,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>closeregs<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,03d4h; mov al,11h; out dx,al; inc dx; in al,dx; or al,80h
  mov ah,al; mov al,11h; dec dx; out dx,ax; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setmodeq<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>initvga<font color="#000080">;
  </font>openregs<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">22 </font><font color="#FF0000"><b>do
    with </b></font>tweak<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do begin
      if </b></font>reg<font color="#000080">&lt;&gt;</font><font color="#800000">$03c0 </font><font color="#FF0000"><b>then </b></font>port<font color="#000080">[</font>reg<font color="#000080">]:=</font>func <font color="#FF0000"><b>else </b></font>port<font color="#000080">[</font>reg<font color="#000080">]:=</font>func<font color="#000080">+</font><font color="#800000">32</font><font color="#000080">;
      </font>port<font color="#000080">[</font>reg<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>data<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>closeregs<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>setmodeq<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>setpal<font color="#000080">(</font>x<font color="#000080">,</font>x <font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">,</font>x <font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">,</font>x <font color="#FF0000"><b>div </b></font><font color="#800000">6</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>x<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do for </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>mem<font color="#000080">[</font>vidseg<font color="#000080">:</font>y<font color="#000080">*</font><font color="#800000">256</font><font color="#000080">+</font>x<font color="#000080">]:=(</font>x<font color="#000080">+</font>y<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">255</font><font color="#000080">;
  </font>readln<font color="#000080">;
  </font>inittxt<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ Just imagine the possibilities... No words needed, no muls needed... }

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0175.PAS">Original</a><b>]</b></p></body>
</html>
