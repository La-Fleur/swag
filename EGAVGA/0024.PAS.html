<html>
<head><title> "redefine Chars in EGA/VGA" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
After several tricks to redefine Characters in EGA and VGA in this echo,
here is one you can use in CGA mode 4,5,6. You will find an Unit, and a
test Program.
}

</i></font><font color="#FF0000"><b>Unit </b></font>graftabl<font color="#000080">;

</font><font color="#008000"><i>{
released into the public domain
author : Emmanuel ROUSSIN
FIDO   : 2:320/200.21
Email  : roussin@frmug.fr.mugnet.org

for using redefined Characters (128 to 255)
in CGA mode 4,5 and 6 Without using GRAFTABL.EXE
}

</i></font><font color="#FF0000"><b>Interface

Type
  </b></font>Tcaractere8 <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>Tgraftabl <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">128</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Tcaractere8<font color="#000080">;

</font><font color="#008000"><i>{
if you want to use only one font, define it in this Unit, For example :

Const
  the_only_font : Tgraftabl = (
                              (x,x,x,x,x,x,x,x),
                              .
                              .
                              (x,x,x,x,x,x,x,x),
                              (x,x,x,x,x,x,x,x)
                              );

Or you can in your main Program :

Var
  my_font : Tgraftabl;

and define it after
}

</i></font><font color="#FF0000"><b>Var
  </b></font>seg_graftabl<font color="#000080">,
  </font>ofs_graftabl <font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#008000"><i>{internal Procedures}

</i></font><font color="#FF0000"><b>Procedure </b></font>get_graftabl<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>segment<font color="#000080">, </font>offset <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>put_graftabl<font color="#000080">(</font>segment<font color="#000080">, </font>offset <font color="#000080">: </font>Word<font color="#000080">);

</font><font color="#008000"><i>{Procedures to use in your Programs}

</i></font><font color="#FF0000"><b>Procedure </b></font>init_graftabl<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>use_graftabl<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>aray <font color="#000080">: </font>Tgraftabl<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>end_graftabl<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>get_graftabl<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>segment<font color="#000080">, </font>offset <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>segment <font color="#000080">:= </font>memw<font color="#000080">[</font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">$1F </font><font color="#000080">* </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">];
  </font>offset  <font color="#000080">:= </font>memw<font color="#000080">[</font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">$1f </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>put_graftabl<font color="#000080">(</font>segment<font color="#000080">, </font>offset <font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>memw<font color="#000080">[</font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">$1f </font><font color="#000080">* </font><font color="#800000">4 </font><font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">] := </font>segment<font color="#000080">;
  </font>memw<font color="#000080">[</font><font color="#800000">0 </font><font color="#000080">: </font><font color="#800000">$1f </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">] := </font>offset
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>init_graftabl<font color="#000080">;
</font><font color="#008000"><i>{ interrupt 1F is a Pointer to bitmaps For high 128 Chars (8 Bytes per
  Character) defined by GRAFTABL.EXE we save this initial Pointer }
</i></font><font color="#FF0000"><b>begin
  </b></font>get_graftabl<font color="#000080">(</font>seg_graftabl<font color="#000080">, </font>ofs_graftabl<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>use_graftabl<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>aray <font color="#000080">: </font>Tgraftabl<font color="#000080">);
</font><font color="#008000"><i>{ we define a new Pointer : the address of an Array }
</i></font><font color="#FF0000"><b>begin
  </b></font>put_graftabl<font color="#000080">(</font>seg<font color="#000080">(</font>aray<font color="#000080">),</font>ofs<font color="#000080">(</font>aray<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>end_graftabl<font color="#000080">;
</font><font color="#008000"><i>{ we restore the original Pointer }
</i></font><font color="#FF0000"><b>begin
  </b></font>put_graftabl<font color="#000080">(</font>seg_graftabl<font color="#000080">,</font>ofs_graftabl<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#FF0000"><b>Program </b></font>test<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Graph3<font color="#000080">, </font>Crt<font color="#000080">, </font>graftabl<font color="#000080">;


</font><font color="#FF0000"><b>Var
  </b></font>font    <font color="#000080">: </font>Tgraftabl<font color="#000080">;
  </font>i<font color="#000080">,</font>j<font color="#000080">,</font>tmp <font color="#000080">: </font>Byte<font color="#000080">;
  </font>rid     <font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>hires<font color="#000080">;
  </font>init_graftabl<font color="#000080">;
  </font>fillChar<font color="#000080">(</font>font<font color="#000080">,</font>sizeof<font color="#000080">(</font>font<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
  </font>use_graftabl<font color="#000080">(</font>font<font color="#000080">);

  </font><font color="#008000"><i>{$F000:$FA6E is the ROM address where the Characters 0 to 127 are defined}

  </i></font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do
    For </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
    begin
      </b></font>tmp <font color="#000080">:= </font>mem<font color="#000080">[</font><font color="#800000">$F000 </font><font color="#000080">: </font><font color="#800000">$FA6E </font><font color="#000080">+ </font><font color="#800000">97 </font><font color="#000080">* </font><font color="#800000">8 </font><font color="#000080">+ (</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">8 </font><font color="#000080">+ </font>j<font color="#000080">] </font><font color="#FF0000"><b>xor </b></font><font color="#800000">$FF</font><font color="#000080">;
      </font>tmp <font color="#000080">:= </font>tmp <font color="#FF0000"><b>xor </b></font><font color="#800000">$FF</font><font color="#000080">;
      </font>tmp <font color="#000080">:= </font>tmp <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>tmp <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
      </font>font<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">127</font><font color="#000080">, </font>j <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>tmp<font color="#000080">;
      </font><font color="#008000"><i>{ Char 128 to 153 are redefined }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">26 </font><font color="#FF0000"><b>do
    For </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
    begin
      </b></font>tmp <font color="#000080">:= </font>mem<font color="#000080">[</font><font color="#800000">$F000 </font><font color="#000080">: </font><font color="#800000">$FA6E </font><font color="#000080">+ </font><font color="#800000">97 </font><font color="#000080">* </font><font color="#800000">8 </font><font color="#000080">+ (</font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) * </font><font color="#800000">8 </font><font color="#000080">+ </font>j<font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#800000">$55</font><font color="#000080">;
      </font>font<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">153</font><font color="#000080">, </font>j <font color="#000080">+ </font><font color="#800000">1 </font><font color="#000080">] := </font>tmp<font color="#000080">;
      </font><font color="#008000"><i>{ Char 154 to 181 are redefined }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Writeln<font color="#000080">(</font><font color="#800000">'the normal Characters ($61 to $7A) :'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">$61 </font><font color="#FF0000"><b>to </b></font><font color="#800000">$7A </font><font color="#FF0000"><b>do
    </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font>i<font color="#000080">));
  </font>Writeln<font color="#000080">; </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'now, these same Characters, but thick :'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">128 </font><font color="#FF0000"><b>to </b></font><font color="#800000">153 </font><font color="#FF0000"><b>do
    </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font>i<font color="#000080">));
  </font>Writeln<font color="#000080">; </font>Writeln<font color="#000080">;
  </font>Writeln<font color="#000080">(</font><font color="#800000">'the same Characters, but greyed :'</font><font color="#000080">);
  </font>Writeln<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">154 </font><font color="#FF0000"><b>to </b></font><font color="#800000">181 </font><font color="#FF0000"><b>do
    </b></font>Write<font color="#000080">(</font>chr<font color="#000080">(</font>i<font color="#000080">));
  </font>rid <font color="#000080">:= </font>ReadKey<font color="#000080">;
  </font>end_graftabl<font color="#000080">;
  </font>Textmode<font color="#000080">(</font>co80<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0024.PAS">Original</a><b>]</b></p></body>
</html>
