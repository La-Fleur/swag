<html>
<head><title> "80x30 Text Mode Procedure" by MIGUEL MARTINEZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
From: MIGUEL MARTINEZ              Refer#: NONE
Subj: 80x30 Text-Mode Procedure      Conf: (1617) L-Pascal
---------------------------------------------------------------------------
Hello to everyone!. A friend of mine who enjoys Assembler, has developed a
routine, to provide &quot;another&quot; video mode to all those who develop text-based
programs.

It's a routine to set a 80x30 text mode, using the 16x8 font of the VGA.
I think is a better mode to work, than the standard 80x25 mode: More
information on screen, without loosing the pretty 16x8 chars.

I have translated this routine to Pascal, and here is the result. It will
work on any standard VGA card.
*)

{Procedure to set 80 columns per 30 rows video mode}
{Orignial Author: Ignacio Garc&iexcl;a P‚rez}
</i></font><font color="#FF0000"><b>Procedure </b></font>Set80x30Mode<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>CrtcReg<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;
    </font>Offset<font color="#000080">:</font>Word<font color="#000080">;
    </font>i<font color="#000080">,</font>Data<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>CrtcReg<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">$0c11</font><font color="#000080">;           </font><font color="#008000"><i>{Vertical Display End (unprotect regs. 0-7)}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">$0d06</font><font color="#000080">;           </font><font color="#008000"><i>{Vertical Total}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">$3e07</font><font color="#000080">;           </font><font color="#008000"><i>{Overflow}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]:=</font><font color="#800000">$ea10</font><font color="#000080">;           </font><font color="#008000"><i>{Vertical Retrace Start}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">5</font><font color="#000080">]:=</font><font color="#800000">$8c11</font><font color="#000080">;           </font><font color="#008000"><i>{Vertical Retrace End (&amp; protect regs. 0-7)}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">6</font><font color="#000080">]:=</font><font color="#800000">$df12</font><font color="#000080">;           </font><font color="#008000"><i>{Vertical Display Enable End}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">7</font><font color="#000080">]:=</font><font color="#800000">$e715</font><font color="#000080">;           </font><font color="#008000"><i>{Start Vertical Blanking}
  </i></font>CrtcReg<font color="#000080">[</font><font color="#800000">8</font><font color="#000080">]:=</font><font color="#800000">$0616</font><font color="#000080">;           </font><font color="#008000"><i>{End Vertical Blanking}

  </i></font>MemW<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$004c</font><font color="#000080">]:=</font><font color="#800000">8192</font><font color="#000080">;     </font><font color="#008000"><i>{Change page size in bytes}
  </i></font>Mem<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0084</font><font color="#000080">]:=</font><font color="#800000">29</font><font color="#000080">;        </font><font color="#008000"><i>{Change page length}
  </i></font>Offset<font color="#000080">:=</font>MemW<font color="#000080">[</font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0063</font><font color="#000080">];   </font><font color="#008000"><i>{Base of CRTRC}
  </i></font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">cli                        </font><font color="#008000"><i>{Clear Interrupts}
  </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>do
    </b></font>PortW<font color="#000080">[</font>Offset<font color="#000080">]:=</font>CrtcReg<font color="#000080">[</font>i<font color="#000080">]; </font><font color="#008000"><i>{Load Registers}

  </i></font>Data<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$03cc</font><font color="#000080">];
  </font>Data<font color="#000080">:=</font>Data <font color="#FF0000"><b>And </b></font><font color="#800000">$33</font><font color="#000080">;
  </font>Data<font color="#000080">:=</font>Data <font color="#FF0000"><b>Or </b></font><font color="#800000">$C4</font><font color="#000080">;
  </font>Port<font color="#000080">[</font><font color="#800000">$03c2</font><font color="#000080">]:=</font>Data<font color="#000080">;
  </font><font color="#FF0000"><b>Asm
   </b></font><font color="#FF00FF">sti                         </font><font color="#008000"><i>{Set Interrupts}
   </i></font><font color="#FF00FF">mov ah,12h                  </font><font color="#008000"><i>{Select alternate printing routine}
   </i></font><font color="#FF00FF">mov bl,20h
   int 10h
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{Of Procedure}

</i></font><font color="#FF0000"><b>BEGIN
</b></font>Set80X30Mode<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0059.PAS">Original</a><b>]</b></p></body>
</html>
