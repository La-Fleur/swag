<html>
<head><title> "EGA VGA PALETTE" by LUKASZ GRABUN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0258.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 JA&gt; Does anyone know how to set the palette in 640x480x16 mode?  I am
 JA&gt; working on a bmp reader for C/S class and it needs to be compatible
 JA&gt; with the BGI drivers :(  Thanks.

I thnik this one will work :)))) }

</i></font><font color="#FF0000"><b>uses </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>type </b></font>paltype<font color="#000080">=</font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j<font color="#000080">:</font>Integer<font color="#000080">;
  </font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">,</font>k<font color="#000080">:</font>Byte<font color="#000080">;
  </font>kuku<font color="#000080">,</font>sv<font color="#000080">:</font>paltype<font color="#000080">;
  </font>palup<font color="#000080">:</font>shortint<font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>SetPalette <font color="#000080">(</font>paletka<font color="#000080">:</font>paltype<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>reg<font color="#000080">:</font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>reg<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$1012</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">255</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>paletka<font color="#000080">);
  </font>reg<font color="#000080">.</font>dx<font color="#000080">:=</font>Ofs<font color="#000080">(</font>paletka<font color="#000080">);
  </font>intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>reg<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetPalette <font color="#000080">(</font><font color="#FF0000"><b>var </b></font>paletka<font color="#000080">:</font>paltype<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>reg<font color="#000080">:</font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>reg<font color="#000080">.</font>ax<font color="#000080">:=</font><font color="#800000">$1017</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>bx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>cx<font color="#000080">:=</font><font color="#800000">255</font><font color="#000080">;
  </font>reg<font color="#000080">.</font>es<font color="#000080">:=</font>Seg<font color="#000080">(</font>paletka<font color="#000080">);
  </font>reg<font color="#000080">.</font>dx<font color="#000080">:=</font>Ofs<font color="#000080">(</font>paletka<font color="#000080">);
  </font>intr <font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>reg<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setrgb<font color="#000080">(</font>n<font color="#000080">:</font>integer<font color="#000080">;</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
asm
  </b></font><font color="#FF00FF">mov ax,1010h
  mov bx,n
  mov ch,g
  mov cl,b
  mov dh,r
  int 10h
</font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>getrgb<font color="#000080">(</font>n<font color="#000080">:</font>integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
asm
  </b></font><font color="#FF00FF">mov ax,1015h
  mov bx,n
  int 10h
  les di,g
  mov [es:di],ch
  les di,b
  mov [es:di],cl
  les di,r
  mov [es:di],dh
</font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0258.PAS">Original</a><b>]</b></p></body>
</html>
