<html>
<head><title> "Yet More Stars!" by JUSTIN GREER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0216.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: JUSTIN GREER

&gt; I have recently coded a program that gives a three layer starfield
&gt; moving only accross the monitor.  I am looking for some code that
&gt; will give a 'warp' kinda feeling. (The stars coming at you, like that
&gt; windows screen saver.)  Any help, even just some mathematics would be
&gt; greatly appriciated.
&gt; Thanks

Well, a while ago I wrote one of these that seems to work real well...
I just spent a half-hour or so doing it, because the only ones I had
were in future crew type demos, and I wanted a screen saver one... Here
ya' go:

Here's a program I've been working on a little lately--It shows
a 3D star field with 256 colors used.  I haven't seen this particular
type of star program anywhere outside of demos and things, and I thought
it might be helpful.  I haven't had time to really optimize it yet,
and it is pretty math-intensive, so it's not the fastest thing in the
world (even though it's a little too fast on my 486dx2/66 =|).
You can shange most of the variables in the program for different
effects--Things like the maximum stars and stuff.  I am running TP7, and
I have not tried this with other versions, but it should work fine
as far as I know.
}

{$G+,N+}
</i></font><font color="#FF0000"><b>PROGRAM </b></font>TPSTARS<font color="#000080">;
</font><font color="#FF0000"><b>USES </b></font>CRT<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>STD<font color="#000080">,</font>SCRNX<font color="#000080">,</font>SCRNY<font color="#000080">,</font>SCRNC<font color="#000080">,</font>Z<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>WORD<font color="#000080">;
  </font>X<font color="#000080">,</font>Y<font color="#000080">:</font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>INTEGER<font color="#000080">;
  </font>I<font color="#000080">:</font>WORD<font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>INIT<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">200 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>X <font color="#000080">[</font>I<font color="#000080">] := </font>RANDOM<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">)-</font><font color="#800000">500</font><font color="#000080">;
      </font>Y <font color="#000080">[</font>I<font color="#000080">] := </font>RANDOM<font color="#000080">(</font><font color="#800000">800</font><font color="#000080">)-</font><font color="#800000">400</font><font color="#000080">;
      </font>Z <font color="#000080">[</font>I<font color="#000080">] := </font>RANDOM<font color="#000080">(</font><font color="#800000">1846</font><font color="#000080">)+</font><font color="#800000">202</font><font color="#000080">;
      </font>STD <font color="#000080">[</font>I<font color="#000080">] := </font>ROUND<font color="#000080">(</font>SQR<font color="#000080">(</font>X<font color="#000080">[</font>I<font color="#000080">])+</font>SQR<font color="#000080">(</font>Y<font color="#000080">[</font>I<font color="#000080">]));
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">MOV AX,013H
    INT 10H
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>PORT<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>ROUND<font color="#000080">((</font><font color="#800000">256</font><font color="#000080">-</font>I<font color="#000080">)/</font><font color="#800000">4</font><font color="#000080">);
      </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>ROUND<font color="#000080">((</font><font color="#800000">256</font><font color="#000080">-</font>I<font color="#000080">)/</font><font color="#800000">4</font><font color="#000080">);
      </font>PORT<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>ROUND<font color="#000080">((</font><font color="#800000">256</font><font color="#000080">-</font>I<font color="#000080">)/</font><font color="#800000">4</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>RESETSTAR<font color="#000080">;
 </font><font color="#FF0000"><b>BEGIN
  </b></font>Z<font color="#000080">[</font>I<font color="#000080">]:=</font><font color="#800000">2048</font><font color="#000080">;
  </font>X<font color="#000080">[</font>I<font color="#000080">]:=</font>RANDOM<font color="#000080">(</font><font color="#800000">1000</font><font color="#000080">)-</font><font color="#800000">500</font><font color="#000080">;
  </font>Y<font color="#000080">[</font>I<font color="#000080">]:=</font>RANDOM<font color="#000080">(</font><font color="#800000">800</font><font color="#000080">)-</font><font color="#800000">400</font><font color="#000080">;
  </font>STD <font color="#000080">[</font>I<font color="#000080">] := </font>ROUND<font color="#000080">(</font>SQR<font color="#000080">(</font>X<font color="#000080">[</font>I<font color="#000080">])+</font>SQR<font color="#000080">(</font>Y<font color="#000080">[</font>I<font color="#000080">]));
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CLOSEDOWN<font color="#000080">;</font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">MOV AX,003H
  INT 10H
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>MOVESTARS<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  repeat
  FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">200 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>mem <font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:(</font>scrny<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">+ </font>scrny<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">)+</font>scrnx<font color="#000080">[</font>i<font color="#000080">]]:=</font><font color="#800000">0</font><font color="#000080">;
      </font>dec<font color="#000080">(</font>Z<font color="#000080">[</font>I<font color="#000080">]);</font><font color="#008000"><i>{:=Z[I]-1;}
      </i></font><font color="#FF0000"><b>IF </b></font>Z<font color="#000080">[</font>I<font color="#000080">] &lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN </b></font>RESETSTAR<font color="#000080">;
      </font>SCRNX<font color="#000080">[</font>I<font color="#000080">]:=(</font><font color="#800000">300</font><font color="#000080">*</font>X<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>DIV </b></font>Z<font color="#000080">[</font>I<font color="#000080">]+</font><font color="#800000">160</font><font color="#000080">;
      </font>SCRNY<font color="#000080">[</font>I<font color="#000080">]:=(</font><font color="#800000">300</font><font color="#000080">*</font>Y<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>DIV </b></font>Z<font color="#000080">[</font>I<font color="#000080">]+</font><font color="#800000">100</font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>SCRNX<font color="#000080">[</font>I<font color="#000080">] &gt; </font><font color="#800000">319 </font><font color="#FF0000"><b>THEN </b></font>RESETSTAR<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>SCRNY<font color="#000080">[</font>I<font color="#000080">] &gt; </font><font color="#800000">199 </font><font color="#FF0000"><b>THEN </b></font>RESETSTAR<font color="#000080">;
       </font><font color="#FF0000"><b>IF </b></font>SCRNX<font color="#000080">[</font>I<font color="#000080">] &lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>RESETSTAR<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>SCRNY<font color="#000080">[</font>I<font color="#000080">] &lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN </b></font>RESETSTAR<font color="#000080">;
      </font>SCRNC<font color="#000080">[</font>I<font color="#000080">]:=</font>Round<font color="#000080">(</font>SQRT<font color="#000080">(</font>SQR<font color="#000080">(</font>Z<font color="#000080">[</font>I<font color="#000080">])+</font>STD<font color="#000080">[</font>I<font color="#000080">]) / </font><font color="#800000">9</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
      </font>mem <font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:(</font>scrny<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">+ </font>scrny<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">)+</font>scrnx<font color="#000080">[</font>i<font color="#000080">]]:=</font>scrnc<font color="#000080">[</font>i<font color="#000080">];
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>Keypressed<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>INIT<font color="#000080">;
  </font>MOVESTARS<font color="#000080">;
  </font>CLOSEDOWN<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0216.PAS">Original</a><b>]</b></p></body>
</html>
