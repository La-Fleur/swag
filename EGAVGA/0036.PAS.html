<html>
<head><title> "VGA Tricks" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Sorry it took so long - anyway here's a new batch of VGA TRICKS :
First there's your basic equipment - synchronizing with
the vertical Crt retrace.
( You can use this For hardware VGA scrolling synchronisation too, just
substitute the Delay(14) in my old routine For a call to this
Procedure.)
}

</i></font><font color="#FF0000"><b>Procedure </b></font>VRET<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{works For CGA,EGA and VGA cards}
</i></font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV  DX, $03DA
  MOV  AH, 8
@Wau: in   AL, DX
  TEST AL, AH
  JNZ  @Wau     </font><font color="#008000"><i>{ wait Until out of retrace }
</i></font><font color="#FF00FF">@Wai: in   AL, DX
  TEST AL, AH
  JZ   @Wai     </font><font color="#008000"><i>{ wait Until inside retrace }
</i></font><font color="#FF0000"><b>end

</b></font><font color="#008000"><i>{
The following is Really new, as Far as I know: breaking the color
barrier by displaying more than 64 different colors on a Text mode
screen. (But it will work For Text and Graphics color modes.)
It displays the effect For approximately SEC seconds, affecting
the black background and any black Characters. note that if
you have the border set to black too, the bars will expand into it.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>ColorBars<font color="#000080">(</font>Sec<font color="#000080">:</font>Byte<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AL,Sec
  MOV AH,70      </font><font color="#008000"><i>{ assume a 70 Hz mode (= 400 lines like mode 3 or $13)}
  </i></font><font color="#FF00FF">MUL AH
  MOV CX,AX
  MOV DX,$03DA
  in AL,DX
  MOV DX,$03C0   </font><font color="#008000"><i>{ assume color nr 0 = default Text background.. }
  </i></font><font color="#FF00FF">MOV AL,$20+0   </font><font color="#008000"><i>{ set color nr 0 .. }
  </i></font><font color="#FF00FF">OUT DX,AL
  MOV AL,0       </font><font color="#008000"><i>{ .. to DAC color 0 }
  </i></font><font color="#FF00FF">OUT DX,AL
@Doscreen:
  xor SI,SI
  CLI
  MOV DX,$03DA
  MOV AH,8
@Wau: in AL,DX
  TEST AL,AH
  JNZ @Wau       </font><font color="#008000"><i>{ wait Until out of retrace }
</i></font><font color="#FF00FF">@Wai: in AL,DX
  TEST AL,AH
  JZ @Wai        </font><font color="#008000"><i>{ wait Until inside retrace }
</i></font><font color="#FF00FF">@Doline:
  STI
  MOV DX,$03C8  </font><font color="#008000"><i>{ point to DAC[0] }
  </i></font><font color="#FF00FF">MOV AL,0
  OUT DX,AL
  inC SI        </font><font color="#008000"><i>{ line counter }
  </i></font><font color="#FF00FF">MOV BX,SI
  ADD BX,CX     </font><font color="#008000"><i>{ prepare For color effect }
  </i></font><font color="#FF00FF">MOV DI,$03C9
  CLI
  MOV DX,$03DA
@Whu: in AL,DX
  RCR AL,1
  JC @Whu       </font><font color="#008000"><i>{ wait Until out of horizontal retrace }
</i></font><font color="#FF00FF">@Whi: in AL,DX
  RCR AL,1
  JNC @Whi      </font><font color="#008000"><i>{ wait Until inside retrace }
  </i></font><font color="#FF00FF">MOV DX,DI
  XCHG BX,AX  </font><font color="#008000"><i>{ tinker With these to change the chromatic effect}
  </i></font><font color="#FF00FF">OUT DX,AL   </font><font color="#008000"><i>{ dynamic Red }
  </i></font><font color="#FF00FF">ADD AL,AL
  OUT DX,AL   </font><font color="#008000"><i>{ dynamic Green }
  </i></font><font color="#FF00FF">XCHG SI,AX
  OUT DX,AL   </font><font color="#008000"><i>{ static Blue }
  </i></font><font color="#FF00FF">XCHG SI,AX
  CMP SI,200    </font><font color="#008000"><i>{ paint 200 lines }
  </i></font><font color="#FF00FF">JBE  @doline
  DEC DX         </font><font color="#008000"><i>{ last line }
  </i></font><font color="#FF00FF">MOV AL,0       </font><font color="#008000"><i>{ reset to black For remainder of screen }
  </i></font><font color="#FF00FF">OUT DX,AL
  inC DX
  OUT DX,AL
  OUT DX,AL
  OUT DX,AL
  STI
Loop @Doscreen
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0036.PAS">Original</a><b>]</b></p></body>
</html>
