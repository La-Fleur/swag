<html>
<head><title> "Drip Drip Drip" by CHRISTOPHER CHANDRA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0184.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ Drip revisited - Modifications by Christopher J. Chandra
  Originally coded by Tim Mattison.
  This version works much much faster than the last one.
  I dunno if it is maximally optimized or not.  Speed Demons?? *Grin* }

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;                               </font><font color="#008000"><i>{386s needed for clrcrt procs}

</i></font><font color="#FF0000"><b>const </b></font>SEGA000<font color="#000080">:</font>Word<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">;               </font><font color="#008000"><i>{needed for TP v6.0 or older}

</i></font><font color="#FF0000"><b>var </b></font>yt<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;
    </font>timer<font color="#000080">:</font>longint <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$006c</font><font color="#000080">;
    </font>tstart<font color="#000080">,</font>tend<font color="#000080">:</font>longint<font color="#000080">;
    </font>xx<font color="#000080">,</font>yy<font color="#000080">:</font>word<font color="#000080">;

</font><font color="#008000"><i>{You can use Drip and Drip2 interchangably?; both operates on the same
 speed.  The difference is in the calculation of the pixel position}

</i></font><font color="#FF0000"><b>procedure </b></font>Drip<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
   </b></font><font color="#FF00FF">mov es,SEGA000
   mov dx,198                           </font><font color="#008000"><i>{for dx:=198 downto 0 do}
</i></font><font color="#FF00FF">@reloop1:
   xor si,si                            </font><font color="#008000"><i>{for si:=0 to 319 do}
</i></font><font color="#FF00FF">@reloop2:
   mov bx,dx;shl bx,1;mov di,word ptr[yt+bx];add di,si
   mov al,[ES:DI]                       </font><font color="#008000"><i>{al:=getcolor(si,dx}
   </i></font><font color="#FF00FF">mov bx,dx;inc bx;mov cx,200;sub cx,bx;
   shl bx,1;mov di,word ptr[yt+bx];add di,si
@again:                                 </font><font color="#008000"><i>{for cx:=dx+1 to 200 do}
   </i></font><font color="#FF00FF">mov [ES:DI],al;add di,320            </font><font color="#008000"><i>{putpixel(si,cx,al}
   </i></font><font color="#FF00FF">loop @again
  inc si;cmp si,320;jl @reloop2         </font><font color="#008000"><i>{end}
  </i></font><font color="#FF00FF">dec dx;jnz @reloop1;                  </font><font color="#008000"><i>{end}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Drip2<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
   </b></font><font color="#FF00FF">mov es,SEGA000
   mov dx,198                           </font><font color="#008000"><i>{for dx:=198 downto 0 do}
</i></font><font color="#FF00FF">@reloop11:
   xor si,si                            </font><font color="#008000"><i>{for si:=0 to 319 do}
</i></font><font color="#FF00FF">@reloop22:
   mov ax,dx;mov di,ax;shl ax,8;shl di,6;add di,ax;add di,si 
   mov bl,[ES:DI]                       </font><font color="#008000"><i>{bl:=getcolor(si,dx}
   </i></font><font color="#FF00FF">mov ax,dx;inc ax;mov cx,200;sub cx,ax
   mov di,ax;shl ax,8;shl di,6;add di,ax;add di,si
@again1:                                </font><font color="#008000"><i>{for cx:=dx+1 to 200 do}
   </i></font><font color="#FF00FF">mov [ES:DI],bl;add di,320            </font><font color="#008000"><i>{putpixel(si,cx,bl}
   </i></font><font color="#FF00FF">loop @again1
  inc si;cmp si,320;jl @reloop22        </font><font color="#008000"><i>{end}
  </i></font><font color="#FF00FF">dec dx;jnz @reloop11;                 </font><font color="#008000"><i>{end}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
 for </b></font>xx<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">200 </font><font color="#FF0000"><b>do </b></font>yt<font color="#000080">[</font>xx<font color="#000080">]:=</font>xx<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">;    </font><font color="#008000"><i>{prepare y table}
 </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov ax,$13;int 10h                 </font><font color="#008000"><i>{init 320x200x256c graphic mode}
  </i></font><font color="#FF00FF">mov es,SEGA000;xor di,di;db $66;mov ax,$3232;dw $3232;mov cx,16000;db $66
  rep stosw </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                        </font><font color="#008000"><i>{fill screen w/ some sort of blue}

 </i></font><font color="#FF0000"><b>for </b></font>xx<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do                    </b></font><font color="#008000"><i>{set palette}
 </i></font><font color="#FF0000"><b>begin
  </b></font>port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font>xx<font color="#000080">;
  </font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>xx <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">;</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>xx <font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">;</font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>xx <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>for </b></font>yy<font color="#000080">:=</font><font color="#800000">50 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199</font><font color="#000080">-</font><font color="#800000">50 </font><font color="#FF0000"><b>do                </b></font><font color="#008000"><i>{you can replace this w/ whatever}
 </i></font><font color="#FF0000"><b>for </b></font>xx<font color="#000080">:=</font><font color="#800000">50 </font><font color="#FF0000"><b>to </b></font><font color="#800000">320</font><font color="#000080">-</font><font color="#800000">50 </font><font color="#FF0000"><b>do                </b></font><font color="#008000"><i>{thing that you want to drip}
  </i></font>mem<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:</font>yt<font color="#000080">[</font>yy<font color="#000080">]+</font>xx<font color="#000080">]:=</font>yy <font color="#FF0000"><b>and </b></font><font color="#800000">255 </font><font color="#000080">+ </font>random<font color="#000080">(</font>xx <font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">);

 </font>tstart<font color="#000080">:=</font>timer<font color="#000080">;                         </font><font color="#008000"><i>{begin timer}
 </i></font>drip2<font color="#000080">;                                 </font><font color="#008000"><i>{apply dripping fx - drip/drip2}
 </i></font>tend<font color="#000080">:=</font>timer<font color="#000080">;                           </font><font color="#008000"><i>{stop timer}

 </i></font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">mov es,SEGA000;xor di,di;db $66;mov ax,$0000;dw $0000;mov cx,16000;
  db $66;rep stosw                      </font><font color="#008000"><i>{fill screen w/ black}
  </i></font><font color="#FF00FF">xor ax,ax;int 16h </font><font color="#FF0000"><b>end</b></font><font color="#000080">;                </font><font color="#008000"><i>{get a keystroke}

 </i></font>textmode<font color="#000080">(</font>co80<font color="#000080">);                        </font><font color="#008000"><i>{return to textmode 80x25 color}
 </i></font>writeln<font color="#000080">(</font>tend<font color="#000080">-</font>tstart<font color="#000080">);                  </font><font color="#008000"><i>{show time needed in microseconds}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{Enjoy - CJC}</i></font><font color="#000080">---
 * </font>Origin<font color="#000080">: </font>The InterZone Cafe <font color="#000080">- </font>Pembroke Pines FL USA <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">369</font><font color="#000080">/</font><font color="#800000">35</font><font color="#000080">)
</font>SEEN<font color="#000080">-</font>BY<font color="#000080">: </font><font color="#800000">135</font><font color="#000080">/</font><font color="#800000">52 94 292 416 369</font><font color="#000080">/</font><font color="#800000">14 32 35 69 74 92 101 135 137
</font>SEEN<font color="#000080">-</font>BY<font color="#000080">: </font><font color="#800000">369</font><font color="#000080">/</font><font color="#800000">169 396</font><font color="#000080">/</font><font color="#800000">1 3615</font><font color="#000080">/</font><font color="#800000">50 51
</font>PATH<font color="#000080">: </font><font color="#800000">369</font><font color="#000080">/</font><font color="#800000">35 74 32 135</font><font color="#000080">/</font><font color="#800000">52 94 3615</font><font color="#000080">/</font><font color="#800000">50
</font>                                                                                                                 
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0184.PAS">Original</a><b>]</b></p></body>
</html>
