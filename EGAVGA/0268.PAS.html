<html>
<head><title> "VGA MODE 12 Code" by TJAKOBS@MSWE.DNET.MS.PHIL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0268.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*


Hi..

This Unit is made all by myself, And There may be some problems with it, If
so please let me know..

All the routines that are present here come from one big unit that i have,
so there could be something missing( but as i said, just let me know))

there are some thing You have to keep in Mind when you are using these
routines, But i will go over them..

There are routines where the x coordinate isn't 640 but 80 (Like Text),
I've done this because I use 8x8 Text. (I now know that it isn't very hard
for me to change it so you can put a char on every x-coordinate, But i don't
feel much like it at the moment, Maybe in a couple of days))

Oh Yeah, None of my routines check if the coordinates are correct..

Andre Jakobs
  MicroBrain Technologies Inc.
    The Netherlands


Procedure Plot12h(x,y:word;Color:byte);
{x        (0-639)
 y        (0-479)
 Color    (0-15)
 Plots a pixel in [Color] at [x],[y]}
Procedure HLine12h(x,y,Length:word;Color:byte);
{x        (0-639)
 y        (0-479)
 Length   (0-639)(But can of course be larger, cause there is no checking)
 Color    (0-15)
 Draws a horizontal Line in [Color] at [x],[y]}
Procedure VLine12h(x,y,Length:word;Color:byte);
{x        (0-639)
 y        (0-479)
 Length   (0-479)
 Color    (0-15)
 Draws a vertical Line in [Color] at [x],[y]}
Procedure Block12h(x,y,Width,Height:word;Color:byte);
{x        (0-639)
 y        (0-479)
 Width    (0-639)
 Height   (0-479)
 Color    (0-15)
 Draws a Box in [Color] at [x],[y] wich is [Width] Wide and [Height] High}
Procedure Frame12h(x,y,Width,Height:word;Color:byte);
{x        (0-639)
 y        (0-479)
 Width    (0-639)
 Height   (0-479)
 Color    (0-15)
 Draws a Frame in [Color] at [x],[y] wich is [Width] Wide and [Height] High}
Procedure PutChar12h(x,y:word;color:byte;cha:char);
{x        (0-79)  !!!
 y        (0-479)
 Color    (0-15)
 cha      ('Character')
 Puts a character in [Color] at [x],[y]
  Doesn't erase background, So if there already is a character use block to
  erase it.
  example:
          Block(50 shl 3,100,8,8,1);
                ^^^^^^^^  (50 is the x coordinate that is used for the char
                           but because block uses 0-639 and not (0-79) you
                           have to multiply it by 8 (shl 3))
          PutChar(50,100,7,'A');}
Procedure PutString12h(x,y:word;Color:byte;Str:String);
{x        (0-79)  !!!
 y        (0-479)
 Color    (0-15)
 Str      ('String')
 Puts a String in [Color] at [x],[y]
  Doesn't erase background, So if there already is a String use block to
  erase it.
  example:
          Block(50 shl 3,100,Length(String) shl 8,8,1);
                ^^^^^^^^  (50 is the x coordinate that is used for the char
                           but because block uses 0-639 and not (0-79) you
                           have to multiply it by 8 (shl 3))
          PutString(50,100,7,'A');}
Procedure Window12h(x,y,Width,Height:word;Color0,Color1,Color2:byte);
{x        (0-79)  !!!
 y        (0-479)
 Width    (0-79)  !!!
 Height   (0-479)
 Color1   (0-15)    (Darkest Color)
 Color2   (0-15)    (Window Main Color)
 Color3   (0-15)    (Lightest Color)
 Draws a Window at [x],[y] wich is [Width] Wide and [Height] High
 example:
         Window12h(9,89,39,79,8,7,15)
 }
Procedure CloseWindow12h;
{closes Last opened Window, there is a max of 16 windows at the moment, But you
 can increase it if you want}
Procedure SaveScreen12h;
{Saves a complete Mode 12h Screen}
Procedure RestoreScreen12h;
{Restores Screen that is saved using SaveScreen12h}
 
Procedure Mode12h;{640x480x16, write mode 2}
{Sets Up mode 12h}
Procedure Button(x,y,W,H:Word;Color0,Color1,Color2:byte);
{x        (0-639)
 y        (0-479)
 Width    (0-639)
 Height   (0-479)
 Color1   (0-15)    (Darkest Color)
 Color2   (0-15)    (Window Main Color)
 Color3   (0-15)    (Lightest Color)
 Draws a Button at [x],[y] wich is [Width] Wide and [Height] High
 }

Procedure LoadFont;
{This Loads a 8x8 Font into an array '_8x8P' that is used to display the text
 You can optain this font by saving the 8x8 ROM font to a binary file and then
 load it into this array.. (you can use a font util to save the font to disk
 try some at (x2ftp.oulu.fi msdos/programming, and search for something that
 has the name 2l8 (Too Late) font editor v1.20)},
 Or you can load the _8x8Seg,_8x8Ofs with the Segment and Offset to the VGA 8x8
 ROM Font..
 
Hope You can use these routines, Cause I use them alot now (Don't use textmode
anymore, But this Mode)..
 
*)
</i></font><font color="#FF0000"><b>UNIT </b></font>VGA_12h<font color="#000080">;
 
</font><font color="#FF0000"><b>INTERFACE
USES </b></font>CRT<font color="#000080">,</font>DOS<font color="#000080">;
</font><font color="#FF0000"><b>Type
    </b></font>PlotProc     <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
    </font>HLineProc    <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
    </font>VLineProc    <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
    </font>BlockProc    <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
    </font>FrameProc    <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
    </font>PutCharProc  <font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>color<font color="#000080">:</font>byte<font color="#000080">;</font>cha<font color="#000080">:</font>char<font color="#000080">);
    </font>PutStringProc<font color="#000080">=</font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">;</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
 
</font><font color="#FF0000"><b>var
   </b></font>Result       <font color="#000080">: </font>word<font color="#000080">;
 
</font><font color="#008000"><i>{Procedures}
   </i></font>ClrScr       <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;            </font><font color="#008000"><i>{Clear Screen}
   </i></font>Plot         <font color="#000080">: </font>PlotProc<font color="#000080">;             </font><font color="#008000"><i>{Plot(x,y,Color)}
   </i></font>HLine        <font color="#000080">: </font>HLineProc<font color="#000080">;            </font><font color="#008000"><i>{HorizontalLine(x,y,Length,Color)}
   </i></font>VLine        <font color="#000080">: </font>VLineProc<font color="#000080">;            </font><font color="#008000"><i>{VerticalLine(x,y,Length,Color)}
   </i></font>Block        <font color="#000080">: </font>BlockProc<font color="#000080">;            </font><font color="#008000"><i>{Block(x,y,Width,Height,Color)}
   </i></font>Frame        <font color="#000080">: </font>FrameProc<font color="#000080">;
   </font>PutChar      <font color="#000080">: </font>PutCharProc<font color="#000080">;          </font><font color="#008000"><i>{PutCharacter(x,y,Color,Char)}
   </i></font>PutString    <font color="#000080">: </font>PutStringProc<font color="#000080">;        </font><font color="#008000"><i>{PutString(x,y,Color,String)}
   </i></font>SaveScreen   <font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;            </font><font color="#008000"><i>{SaveScreen}
   </i></font>RestoreScreen<font color="#000080">: </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">;            </font><font color="#008000"><i>{RestoreScreen}
 
{Mode 12h Routines}
</i></font><font color="#FF0000"><b>Procedure </b></font>Plot12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>HLine12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>VLine12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Block12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Frame12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>PutChar12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>color<font color="#000080">:</font>byte<font color="#000080">;</font>cha<font color="#000080">:</font>char<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>PutString12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">;</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Window12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color0<font color="#000080">,</font>Color1<font color="#000080">,</font>Color2<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>CloseWindow12h<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SaveScreen12h<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>RestoreScreen12h<font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Mode12h<font color="#000080">;</font><font color="#008000"><i>{640x480x16, write mode 2}
</i></font><font color="#FF0000"><b>Procedure </b></font>Button<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>Word<font color="#000080">;</font>Color0<font color="#000080">,</font>Color1<font color="#000080">,</font>Color2<font color="#000080">:</font>byte<font color="#000080">);
 
</font><font color="#FF0000"><b>IMPLEMENTATION
 
Type
    </b></font>Window12hType <font color="#000080">= </font><font color="#FF0000"><b>record
                      </b></font>Width <font color="#000080">: </font>byte<font color="#000080">;
                      </font>Height<font color="#000080">: </font>word<font color="#000080">;
                      </font>VidOfs<font color="#000080">: </font>word<font color="#000080">;
                      </font>Plane0<font color="#000080">: </font>pointer<font color="#000080">;
                      </font>Plane1<font color="#000080">: </font>pointer<font color="#000080">;
                      </font>Plane2<font color="#000080">: </font>pointer<font color="#000080">;
                      </font>Plane3<font color="#000080">: </font>pointer<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>WindowList12h     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">16</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font><font color="#000080">^</font>Window12hType<font color="#000080">;
   </font>LastWindow12h     <font color="#000080">: </font>byte<font color="#000080">;
   </font>ScreenGrab        <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pointer<font color="#000080">;
   </font>_8x8Seg<font color="#000080">,</font>_8x8Ofs   <font color="#000080">: </font>word<font color="#000080">;
   </font>_8x8P             <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
 
</font><font color="#008000"><i>{*****************************************************************
                    GRAPHICS &amp; TEXT ROUTINES
 *****************************************************************}
</i></font><font color="#FF0000"><b>Procedure </b></font>LoadFont<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>F    <font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>assign<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">'8x8'</font><font color="#000080">);
  </font>reset<font color="#000080">(</font>F<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>blockread<font color="#000080">(</font>f<font color="#000080">,</font>_8x8P<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">2048</font><font color="#000080">);
  </font>close<font color="#000080">(</font>F<font color="#000080">);
  </font>_8x8Seg<font color="#000080">:=</font>Seg<font color="#000080">(</font>_8x8P<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font>_8x8Ofs<font color="#000080">:=</font>Ofs<font color="#000080">(</font>_8x8P<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Mode12h<font color="#000080">;</font><font color="#008000"><i>{Assembler;{640x480x16}
</i></font><font color="#FF0000"><b>begin
  </b></font><font color="#000080">@</font>Plot<font color="#000080">:=@</font>Plot12h<font color="#000080">;
  @</font>VLine<font color="#000080">:=@</font>VLine12h<font color="#000080">;
  @</font>HLine<font color="#000080">:=@</font>HLine12h<font color="#000080">;
  @</font>Block<font color="#000080">:=@</font>Block12h<font color="#000080">;
  @</font>Frame<font color="#000080">:=@</font>Frame12h<font color="#000080">;
  @</font>PutChar<font color="#000080">:=@</font>PutChar12h<font color="#000080">;
  @</font>PutString<font color="#000080">:=@</font>PutString12h<font color="#000080">;
  @</font>SaveScreen<font color="#000080">:=@</font>SaveScreen12h<font color="#000080">;
  @</font>RestoreScreen<font color="#000080">:=@</font>RestoreScreen12h<font color="#000080">;
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">Mov     AH,00
    Mov     AL,12h
    Int     10h
    mov     dx,03ceh    </font><font color="#008000"><i>{Graphics Controller}
    </i></font><font color="#FF00FF">mov     ax,0205h    </font><font color="#008000"><i>{Mode Register, Write Mode 2}
    </i></font><font color="#FF00FF">out     dx,ax
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Button<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">:</font>Word<font color="#000080">;</font>Color0<font color="#000080">,</font>Color1<font color="#000080">,</font>Color2<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Block<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>W<font color="#000080">,</font>H<font color="#000080">,</font>Color1<font color="#000080">);
  </font>HLine<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">,</font>W<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Color2<font color="#000080">);
  </font>VLine<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Color2<font color="#000080">);
  </font>HLine<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">+</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Color0<font color="#000080">);
  </font>VLine<font color="#000080">(</font>x<font color="#000080">+</font>W<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>H<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Color0<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>ClrScr12h<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov   es,SegA000
  mov   di,00h
  mov   ax,00h
  mov   cx,19200
  rep   stosw
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Plot12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
  </i></font><font color="#FF00FF">mov   es,ax
  mov   bx,[y]
  mov   di,bx
  shl   di,6            </font><font color="#008000"><i>{80*y}
  </i></font><font color="#FF00FF">shl   bx,4
  add   di,bx
 
  mov   cx,[x]
  mov   bx,cx
  shr   bx,3            </font><font color="#008000"><i>{/8}
  </i></font><font color="#FF00FF">add   di,bx           </font><font color="#008000"><i>{80*y+ (x/8)}
 
  </i></font><font color="#FF00FF">and   cx,7            </font><font color="#008000"><i>{Get Bit that Changes}
  </i></font><font color="#FF00FF">mov   ah,128
  shr   ah,cl
  mov   dx,03ceh
  mov   al,8
  out   dx,ax
  mov   dl,[es:di]
  mov   al,[Color]
  mov   [es:di],al
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>HLine12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov   bx,[x]
  mov   si,[Length]
  or    si,si           </font><font color="#008000"><i>{Check if Length=0}
  </i></font><font color="#FF00FF">jz    @D_End           </font><font color="#008000"><i>{If So then jump to End}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
 
  </i></font><font color="#FF00FF">mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
  </i></font><font color="#FF00FF">mov   es,ax
  mov   ax,[y]
  mov   di,ax
  shl   di,6            </font><font color="#008000"><i>{80*y}
  </i></font><font color="#FF00FF">shl   ax,4
  add   di,ax
 
  mov   ax,bx
  shr   ax,3            </font><font color="#008000"><i>{/8}
  </i></font><font color="#FF00FF">add   di,ax           </font><font color="#008000"><i>{80*y+ (x/8)}
 
{di = Offset in VMem}
{Si = Length}
{bx = x}
{dx = Graphix Controller}
 
{ax = empty}
{cx = empty}
 
  </i></font><font color="#FF00FF">mov   cx,bx           </font><font color="#008000"><i>{Get StartBit}
  </i></font><font color="#FF00FF">and   cx,07h
 
  mov   ax,si
  add   ax,cx
  cmp   ax,8            </font><font color="#008000"><i>{Is x+Length&lt;One Byte}
  </i></font><font color="#FF00FF">jb    @D_One
 
  mov   ah,0ffh         </font><font color="#008000"><i>{11111111b}
  </i></font><font color="#FF00FF">shr   ah,cl           </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}
  </i></font><font color="#FF00FF">mov   al,[es:di]
  mov   al,[Color]
  mov   [es:di],al
  inc   di
 
  mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">mov   ah,0ffh         </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}
 
  </i></font><font color="#FF00FF">mov   ax,si
  mov   ch,8
  sub   ch,cl
  mov   cl,ch
  xor   ch,ch
  sub   ax,cx
  shr   ax,3            </font><font color="#008000"><i>{Length div 8}
  </i></font><font color="#FF00FF">mov   cx,ax
  mov   al,[Color]
  rep   stosb
 
  mov   cx,bx           </font><font color="#008000"><i>{cx:=x+Length}
  </i></font><font color="#FF00FF">add   cx,si
  and   cx,07h          </font><font color="#008000"><i>{cx and 07}
  </i></font><font color="#FF00FF">mov   ah,0ffh
  shr   ah,cl           </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">cmp   ah,0
  je    @D_End
 
  not   ah
  mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}
  </i></font><font color="#FF00FF">mov   cl,[es:di]
  mov   al,[Color]
  mov   [es:di],al
  jmp   @D_End
 
@D_One:
  mov   ah,0ffh
  shr   ah,cl           </font><font color="#008000"><i>{Left BitMask}
 
  </i></font><font color="#FF00FF">add   bx,si
  dec   bx
  and   bx,07h
 
  mov   cx,7
  sub   cx,bx
 
  mov   bl,0ffh
  shl   bl,cl          </font><font color="#008000"><i>{Right BitMask}
 
  </i></font><font color="#FF00FF">and   ah,bl          </font><font color="#008000"><i>{Full  BitMask}
  </i></font><font color="#FF00FF">mov   al,8           </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">out   dx,ax          </font><font color="#008000"><i>{Write BitMask}

  </i></font><font color="#FF00FF">mov   dl,[es:di]     </font><font color="#008000"><i>{Fill Latches}
  </i></font><font color="#FF00FF">mov   al,[Color]
  mov   [es:di],al     </font><font color="#008000"><i>{Write Pixel}
</i></font><font color="#FF00FF">@D_End:
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>VLine12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Length<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
  </i></font><font color="#FF00FF">mov   es,ax
  mov   bx,[y]
  mov   di,bx
  shl   di,6            </font><font color="#008000"><i>{80*y}
  </i></font><font color="#FF00FF">shl   bx,4
  add   di,bx
 
  mov   cx,[x]
  mov   bx,cx
  shr   bx,3            </font><font color="#008000"><i>{/8}
  </i></font><font color="#FF00FF">add   di,bx           </font><font color="#008000"><i>{80*y+ (x/8)}
 
  </i></font><font color="#FF00FF">and   cx,7            </font><font color="#008000"><i>{Get Bit that Changes}
  </i></font><font color="#FF00FF">mov   ah,80h
  shr   ah,cl           </font><font color="#008000"><i>{BitMask Value}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
  </i></font><font color="#FF00FF">mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{BitMask Setup}
  </i></font><font color="#FF00FF">mov   bx,[Length]
  mov   al,[Color]
@D_L:
  mov   dl,[es:di]
  mov   [es:di],al      </font><font color="#008000"><i>{Put Byte at Offset}
  </i></font><font color="#FF00FF">add   di,80
  dec   bx
  jnz   @D_L
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Block12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov   bx,[x]
  mov   si,[Width]
  or    si,si           </font><font color="#008000"><i>{Check if Length=0}
  </i></font><font color="#FF00FF">jz    @D_End           </font><font color="#008000"><i>{If So then jump to End}
 
  </i></font><font color="#FF00FF">mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
  </i></font><font color="#FF00FF">mov   es,ax
  mov   ax,[y]
  mov   di,ax
  shl   di,6            </font><font color="#008000"><i>{80*y}
  </i></font><font color="#FF00FF">shl   ax,4
  add   di,ax
 
  mov   ax,bx
  shr   ax,3            </font><font color="#008000"><i>{/8}
  </i></font><font color="#FF00FF">add   di,ax           </font><font color="#008000"><i>{80*y+ (x/8)}
 
{di = Offset in VMem}
{Si = Length}
{bx = x}
{dx = Graphix Controller}
 
{ax = empty}
{cx = empty}
 
  </i></font><font color="#FF00FF">mov   cx,bx           </font><font color="#008000"><i>{Get StartBit}
  </i></font><font color="#FF00FF">and   cx,07h
 
  mov   ax,si
  add   ax,cx
  cmp   ax,8            </font><font color="#008000"><i>{Is x+Length&lt;One Byte}
  </i></font><font color="#FF00FF">jb    @D_One

  mov   ah,0ffh         </font><font color="#008000"><i>{11111111b}
  </i></font><font color="#FF00FF">shr   ah,cl           </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}
  </i></font><font color="#FF00FF">push  cx
  mov   ah,[Color]
  mov   cx,[Height]
  mov   dx,di
@D_LL:                   </font><font color="#008000"><i>{Draw Left of Box}
  </i></font><font color="#FF00FF">mov   al,[es:di]
  mov   [es:di],ah
  add   di,80           </font><font color="#008000"><i>{di:=di+80}
  </i></font><font color="#FF00FF">dec   cx
  jnz   @D_LL
  mov   di,dx
  inc   di
  pop   cx
 
  mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">mov   ah,0ffh         </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}

  </i></font><font color="#FF00FF">mov   ax,si
  mov   ch,8
  sub   ch,cl
  mov   cl,ch
  xor   ch,ch
  sub   ax,cx
  shr   ax,3            </font><font color="#008000"><i>{Length div 8}
 
  </i></font><font color="#FF00FF">push  di
  push  bx
  mov   bx,[Height]
  mov   dx,ax
  mov   al,[Color]
@D_LC:
  mov   cx,dx
  rep   stosb
  add   di,80
  sub   di,dx
  dec   bx
  jnz   @D_LC
  pop   bx
  pop   di
  add   di,dx

  mov   cx,bx           </font><font color="#008000"><i>{cx:=x+Length}
  </i></font><font color="#FF00FF">add   cx,si
  and   cx,07h          </font><font color="#008000"><i>{cx and 07}
  </i></font><font color="#FF00FF">mov   ah,0ffh
  shr   ah,cl           </font><font color="#008000"><i>{BitMask}
  </i></font><font color="#FF00FF">cmp   ah,0
  je    @D_End
 
  not   ah
  mov   al,8            </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
  </i></font><font color="#FF00FF">out   dx,ax           </font><font color="#008000"><i>{Write BitMask}
  </i></font><font color="#FF00FF">mov   cx,[Height]
  mov   al,[Color]
@D_LR:
  mov   ah,[es:di]
  mov   [es:di],al
  add   di,80
  dec   cx
  jnz   @D_LR
 
  jmp   @D_End
 
@D_One:
  mov   ah,0ffh
  shr   ah,cl           </font><font color="#008000"><i>{Left BitMask}
 
  </i></font><font color="#FF00FF">add   bx,si
  dec   bx
  and   bx,07h
 
  mov   cx,7
  sub   cx,bx
 
  mov   bl,0ffh
  shl   bl,cl          </font><font color="#008000"><i>{Right BitMask}
 
  </i></font><font color="#FF00FF">and   ah,bl          </font><font color="#008000"><i>{Full  BitMask}
  </i></font><font color="#FF00FF">mov   al,8           </font><font color="#008000"><i>{BitMask Register}
  </i></font><font color="#FF00FF">mov   dx,03ceh        </font><font color="#008000"><i>{Graphics Controller}
  </i></font><font color="#FF00FF">out   dx,ax          </font><font color="#008000"><i>{Write BitMask}
  </i></font><font color="#FF00FF">mov   cx,[Height]
  mov   al,[Color]
@D_L:
  mov   dl,[es:di]     </font><font color="#008000"><i>{Fill Latches}
  </i></font><font color="#FF00FF">mov   [es:di],al     </font><font color="#008000"><i>{Write Pixel}
  </i></font><font color="#FF00FF">add   di,80
  dec   cx
  jnz   @D_L
@D_End:
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Frame12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>HLine<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Color<font color="#000080">);
  </font>VLine<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Height<font color="#000080">,</font>Color<font color="#000080">);
  </font>VLine<font color="#000080">(</font>x<font color="#000080">+</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">,</font>Height<font color="#000080">,</font>Color<font color="#000080">);
  </font>HLine<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">+</font>Height<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Width<font color="#000080">,</font>Color<font color="#000080">);
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PutChar12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">;</font>cha<font color="#000080">:</font>char<font color="#000080">);</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push  ds
  xor   bx,bx
  mov   bl,[cha]
  shl   bx,3
  mov   ax,_8x8Seg
  mov   ds,ax
  mov   si,_8x8Ofs
  add   si,bx
 
  mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
  </i></font><font color="#FF00FF">mov   es,ax
  mov   di,[y]
  mov   ax,di
  shl   ax,6
  shl   di,4
  add   di,ax
  add   di,[x]
  mov   cx,8
  mov   dx,03ceh
  mov   al,8
  mov   bl,[Color]
@D_L:
  mov   ah,[ds:si]
  out   dx,ax
  mov   ah,[es:di]
  mov   [es:di],bl
  inc   si
  add   di,80
  dec   cx
  jnz   @D_L
  pop   ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>PutString12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">:</font>word<font color="#000080">;</font>Color<font color="#000080">:</font>byte<font color="#000080">;</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>f1   <font color="#000080">: </font>byte<font color="#000080">;
   </font>Cha  <font color="#000080">: </font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
for </b></font>f1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ord<font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>do
 begin
   </b></font>cha<font color="#000080">:=</font>Str<font color="#000080">[</font>f1<font color="#000080">];
   </font><font color="#FF0000"><b>asm
     </b></font><font color="#FF00FF">push  ds
     mov   ax,_8x8Seg
     mov   ds,ax
     mov   si,_8x8Ofs
     xor   ax,ax
     mov   al,cha
     shl   ax,3
     add   si,ax
 
     mov   ax,SegA000      </font><font color="#008000"><i>{Calculate Offset}
     </i></font><font color="#FF00FF">mov   es,ax
     mov   di,[y]
     mov   ax,di
     shl   ax,6
     shl   di,4
     add   di,ax
     add   di,[x]
     mov   cx,8
     mov   dx,03ceh
     mov   al,8
     mov   bl,[Color]
@D_L:
     mov   ah,[ds:si]
     out   dx,ax
     mov   ah,[es:di]
     mov   [es:di],bl
     inc   si
     add   di,80
     dec   cx
     jnz   @D_L
     pop   ds
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>inc<font color="#000080">(</font>x<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{For}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>Window12h<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">:</font>word<font color="#000080">;</font>Color0<font color="#000080">,</font>Color1<font color="#000080">,</font>Color2<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>VidOfs       <font color="#000080">: </font>word<font color="#000080">;
   </font>ImOfs<font color="#000080">,</font>ImSeg  <font color="#000080">: </font>word<font color="#000080">;
   </font>ScrW         <font color="#000080">: </font>word<font color="#000080">;
   </font>O0<font color="#000080">,</font>S0<font color="#000080">,</font>O1<font color="#000080">,</font>S1  <font color="#000080">: </font>word<font color="#000080">;
   </font>O2<font color="#000080">,</font>S2<font color="#000080">,</font>O3<font color="#000080">,</font>S3  <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>LastWindow12h<font color="#000080">&lt;</font><font color="#800000">16 </font><font color="#FF0000"><b>then
    begin
      </b></font>inc<font color="#000080">(</font>LastWindow12h<font color="#000080">);
      </font>new<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]);
      </font>VidOfs<font color="#000080">:=(</font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">6</font><font color="#000080">)+(</font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">)+</font>x<font color="#000080">;
      </font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>VidOfs<font color="#000080">:=</font>VidOfs<font color="#000080">;
      </font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Width <font color="#000080">:=</font>Width<font color="#000080">;
      </font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Height<font color="#000080">:=</font>Height<font color="#000080">;
      </font>ScrW<font color="#000080">:=</font>Width<font color="#000080">*</font>Height<font color="#000080">;
      </font>GetMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">,</font>ScrW<font color="#000080">);
      </font>GetMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">,</font>ScrW<font color="#000080">);
      </font>GetMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">,</font>ScrW<font color="#000080">);
      </font>GetMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">,</font>ScrW<font color="#000080">);
      </font>S0<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">^);
      </font>O0<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">^);
      </font>S1<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">^);
      </font>O1<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">^);
      </font>S2<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">^);
      </font>O2<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">^);
      </font>S3<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">^);
      </font>O3<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">^);
      </font>ScrW<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">-</font>Width<font color="#000080">;
      </font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">push  ds
 
        mov   bx,[Width]
        mov   cx,[Height]
 
        mov   si,[VidOfs]
        mov   ds,SegA000                 </font><font color="#008000"><i>{ds:si VideoMem}
        </i></font><font color="#FF00FF">mov   dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
        </i></font><font color="#FF00FF">mov   ax,0005h                   </font><font color="#008000"><i>{Mode Register, Write 0, Read  0}
        </i></font><font color="#FF00FF">out   dx,ax
 
 
        mov   di,[O3]                    </font><font color="#008000"><i>{Read Plane 3}
        </i></font><font color="#FF00FF">mov   es,[S3]                    </font><font color="#008000"><i>{es:di ImageOfset}
        </i></font><font color="#FF00FF">mov   ax,0304h                   </font><font color="#008000"><i>{Read Plane Select}
        </i></font><font color="#FF00FF">out   dx,ax
        push  si                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
        </i></font><font color="#FF00FF">push  cx
        mov   ax,cx                      </font><font color="#008000"><i>{cx=Height}
    </i></font><font color="#FF00FF">@B3:
        mov   cx,bx                      </font><font color="#008000"><i>{bx=Width}
        </i></font><font color="#FF00FF">rep   movsb                      </font><font color="#008000"><i>{Read 8 Pixels}
        </i></font><font color="#FF00FF">add   si,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
        </i></font><font color="#FF00FF">dec   ax
        jnz   @B3
        pop   cx
        pop   si                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 
        </i></font><font color="#FF00FF">mov   di,[O2]                    </font><font color="#008000"><i>{Read Plane 2}
        </i></font><font color="#FF00FF">mov   es,[S2]                    </font><font color="#008000"><i>{es:di ImageOfset}
        </i></font><font color="#FF00FF">mov   ax,0204h                   </font><font color="#008000"><i>{Read Plane Select}
        </i></font><font color="#FF00FF">out   dx,ax
        push  si                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
        </i></font><font color="#FF00FF">push  cx
        mov   ax,cx                      </font><font color="#008000"><i>{cx=Height}
    </i></font><font color="#FF00FF">@B2:
        mov   cx,bx                      </font><font color="#008000"><i>{bx=Width}
        </i></font><font color="#FF00FF">rep   movsb                      </font><font color="#008000"><i>{Read 8 Pixels}
        </i></font><font color="#FF00FF">add   si,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
        </i></font><font color="#FF00FF">dec   ax
        jnz   @B2
        pop   cx
        pop   si                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 

        </i></font><font color="#FF00FF">mov   di,[O1]                    </font><font color="#008000"><i>{Read Plane 1}
        </i></font><font color="#FF00FF">mov   es,[S1]                    </font><font color="#008000"><i>{es:di ImageOfset}
        </i></font><font color="#FF00FF">mov   ax,0104h                   </font><font color="#008000"><i>{Read Plane Select}
        </i></font><font color="#FF00FF">out   dx,ax
        push  si                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
        </i></font><font color="#FF00FF">push  cx
        mov   ax,cx                      </font><font color="#008000"><i>{cx=Height}
    </i></font><font color="#FF00FF">@B1:
        mov   cx,bx                      </font><font color="#008000"><i>{bx=Width}
        </i></font><font color="#FF00FF">rep   movsb                      </font><font color="#008000"><i>{Read 8 Pixels}
        </i></font><font color="#FF00FF">add   si,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
        </i></font><font color="#FF00FF">dec   ax
        jnz   @B1
        pop   cx
        pop   si                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 
 
        </i></font><font color="#FF00FF">mov   di,[O0]                    </font><font color="#008000"><i>{Read Plane 0}
        </i></font><font color="#FF00FF">mov   es,[S0]                    </font><font color="#008000"><i>{es:di ImageOfset}
        </i></font><font color="#FF00FF">mov   ax,0004h                   </font><font color="#008000"><i>{Read Plane Select}
        </i></font><font color="#FF00FF">out   dx,ax
        mov   ax,cx                      </font><font color="#008000"><i>{cx=Height}
    </i></font><font color="#FF00FF">@B0:
        mov   cx,bx                      </font><font color="#008000"><i>{bx=Width}
        </i></font><font color="#FF00FF">rep   movsb                      </font><font color="#008000"><i>{Read 8 Pixels}
        </i></font><font color="#FF00FF">add   si,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
        </i></font><font color="#FF00FF">dec   ax
        jnz   @B0
 
        mov   ax,0205h                   </font><font color="#008000"><i>{Mode Register, Write Mode 2}
        </i></font><font color="#FF00FF">out   dx,ax
        pop   ds
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>Width<font color="#000080">:=</font>Width <font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">;
     </font>x<font color="#000080">:=</font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">;
     </font>Block<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">,</font>Color1<font color="#000080">);
     </font>HLine<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Color2<font color="#000080">);
     </font>VLine<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Height<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">,</font>Color2<font color="#000080">);
     </font>HLine<font color="#000080">(</font>x<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">+</font>Height<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Color0<font color="#000080">);
     </font>VLine<font color="#000080">(</font>x<font color="#000080">+</font>width<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Height<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Color0<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>CloseWindow12h<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Width<font color="#000080">,</font>Height  <font color="#000080">: </font>word<font color="#000080">;
  </font>SegWin<font color="#000080">,</font>OfsWin <font color="#000080">: </font>word<font color="#000080">;
  </font>OfsVid        <font color="#000080">: </font>word<font color="#000080">;
  </font>ScrW          <font color="#000080">: </font>word<font color="#000080">;
  </font>O0<font color="#000080">,</font>S0<font color="#000080">,</font>O1<font color="#000080">,</font>S1   <font color="#000080">: </font>word<font color="#000080">;
  </font>O2<font color="#000080">,</font>S2<font color="#000080">,</font>O3<font color="#000080">,</font>S3   <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>LastWindow12h<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
   begin
     </b></font>Width<font color="#000080">:=</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Width<font color="#000080">;
     </font>Height<font color="#000080">:=</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Height<font color="#000080">;
     </font>OfsVid<font color="#000080">:=</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>VidOfs<font color="#000080">;
 
     </font>S0<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">^);
     </font>O0<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">^);
     </font>S1<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">^);
     </font>O1<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">^);
     </font>S2<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">^);
     </font>O2<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">^);
     </font>S3<font color="#000080">:=</font>Seg<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">^);
     </font>O3<font color="#000080">:=</font>Ofs<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">^);
     </font>ScrW<font color="#000080">:=</font><font color="#800000">80</font><font color="#000080">-</font>Width<font color="#000080">;
     </font><font color="#FF0000"><b>Asm
       </b></font><font color="#FF00FF">push ds
      </font><font color="#008000"><i>{GET OFFSET IN VIDEOMEM/MOUSEBACKUP}
 
       </i></font><font color="#FF00FF">mov  bx,[Width]
       mov  cx,[Height]
       mov  es,SegA000
       mov  di,[OfsVid]                </font><font color="#008000"><i>{es:di Start in VideoMem}
       </i></font><font color="#FF00FF">mov  dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
       </i></font><font color="#FF00FF">mov  ax,0805h                   </font><font color="#008000"><i>{Mode Register, Write Mode 0, Read Mode 
1}
       </i></font><font color="#FF00FF">out  dx,ax
       mov  ax,0007h                   </font><font color="#008000"><i>{color don't care Register}
       </i></font><font color="#FF00FF">out  dx,ax
       mov  ax,0ff08h                  </font><font color="#008000"><i>{BitMask Register}
       </i></font><font color="#FF00FF">out  dx,ax
       mov  dx,03c4h                   </font><font color="#008000"><i>{Sequencer Controller}
 
       </i></font><font color="#FF00FF">cli
       mov  si,[O3]
       mov  ds,[S3]                    </font><font color="#008000"><i>{ds:si Start in Memory}
       </i></font><font color="#FF00FF">mov  ax,0802h                   </font><font color="#008000"><i>{Write Plane Select,Plane 3}
       </i></font><font color="#FF00FF">out  dx,ax                      </font><font color="#008000"><i>{Write Read Plane Select}
       </i></font><font color="#FF00FF">push di                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
       </i></font><font color="#FF00FF">mov  ax,[Height]                </font><font color="#008000"><i>{Height}
   </i></font><font color="#FF00FF">@R3:
       mov  cx,bx                      </font><font color="#008000"><i>{bx=Width}
       </i></font><font color="#FF00FF">rep  movsb                      </font><font color="#008000"><i>{Draw 8 Pixels}
       </i></font><font color="#FF00FF">add  di,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
       </i></font><font color="#FF00FF">dec  ax
       jnz  @R3
       pop  di                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 
 
       </i></font><font color="#FF00FF">mov  si,[O2]
       mov  ds,[S2]                    </font><font color="#008000"><i>{ds:si Start in Memory}
       </i></font><font color="#FF00FF">mov  ax,0402h                   </font><font color="#008000"><i>{Write Plane Select,Plane 2}
       </i></font><font color="#FF00FF">out  dx,ax                      </font><font color="#008000"><i>{Write Read Plane Select}
       </i></font><font color="#FF00FF">push di                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
       </i></font><font color="#FF00FF">mov  ax,[Height]                </font><font color="#008000"><i>{Height}
   </i></font><font color="#FF00FF">@R2:
       mov  cx,bx                      </font><font color="#008000"><i>{bx=Width}
       </i></font><font color="#FF00FF">rep  movsb                      </font><font color="#008000"><i>{Draw 8 Pixels}
       </i></font><font color="#FF00FF">add  di,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
       </i></font><font color="#FF00FF">dec  ax
       jnz  @R2
       pop  di                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 
       </i></font><font color="#FF00FF">mov  si,[O1]
       mov  ds,[S1]                    </font><font color="#008000"><i>{ds:si Start in Memory}
       </i></font><font color="#FF00FF">mov  ax,0202h                   </font><font color="#008000"><i>{Write Plane Select,Plane 1}
       </i></font><font color="#FF00FF">out  dx,ax                      </font><font color="#008000"><i>{Write Read Plane Select}
       </i></font><font color="#FF00FF">push di                         </font><font color="#008000"><i>{Save 'Start Window in VideoMem'}
       </i></font><font color="#FF00FF">mov  ax,[Height]                </font><font color="#008000"><i>{Height}
   </i></font><font color="#FF00FF">@R1:
       mov  cx,bx                      </font><font color="#008000"><i>{bx=Width}
       </i></font><font color="#FF00FF">rep  movsb                      </font><font color="#008000"><i>{Draw 8 Pixels}
       </i></font><font color="#FF00FF">add  di,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
       </i></font><font color="#FF00FF">dec  ax
       jnz  @R1
       pop  di                         </font><font color="#008000"><i>{Restore 'Start Window in VideoMem'}
 
       </i></font><font color="#FF00FF">mov  si,[O0]
       mov  ds,[S0]                    </font><font color="#008000"><i>{ds:si Start in Memory}
       </i></font><font color="#FF00FF">mov  ax,0102h                   </font><font color="#008000"><i>{Write Plane Select,Plane 2}
       </i></font><font color="#FF00FF">out  dx,ax                      </font><font color="#008000"><i>{Write Read Plane Select}
       </i></font><font color="#FF00FF">mov  ax,[Height]                </font><font color="#008000"><i>{Height}
   </i></font><font color="#FF00FF">@R0:
       mov  cx,bx                      </font><font color="#008000"><i>{bx=Width}
       </i></font><font color="#FF00FF">rep  movsb                      </font><font color="#008000"><i>{Draw 8 Pixels}
       </i></font><font color="#FF00FF">add  di,[ScrW]                  </font><font color="#008000"><i>{Goto Next Line by adding ScrWidth}
       </i></font><font color="#FF00FF">dec  ax
       jnz  @R0
 
       mov  ax,0f02h                   </font><font color="#008000"><i>{Set All Planes to write}
       </i></font><font color="#FF00FF">out  dx,ax

       mov  dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
       </i></font><font color="#FF00FF">mov  ax,0205h                   </font><font color="#008000"><i>{Mode Register, Write Mode 2}
       </i></font><font color="#FF00FF">out  dx,ax
       sti
       pop  ds
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>ScrW<font color="#000080">:=</font>Width<font color="#000080">*</font>Height<font color="#000080">;
     </font>FreeMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane0<font color="#000080">,</font>ScrW<font color="#000080">);
     </font>FreeMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane1<font color="#000080">,</font>ScrW<font color="#000080">);
     </font>FreeMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane2<font color="#000080">,</font>ScrW<font color="#000080">);
     </font>FreeMem<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]^.</font>Plane3<font color="#000080">,</font>ScrW<font color="#000080">);
     </font>Dispose<font color="#000080">(</font>WindowList12h<font color="#000080">[</font>LastWindow12h<font color="#000080">]);
     </font>dec<font color="#000080">(</font>LastWindow12h<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>SaveScreen12h<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>O0<font color="#000080">,</font>S0<font color="#000080">,</font>O1<font color="#000080">,</font>S1  <font color="#000080">: </font>word<font color="#000080">;
   </font>O2<font color="#000080">,</font>S2<font color="#000080">,</font>O3<font color="#000080">,</font>S3  <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">38592</font><font color="#000080">);</font><font color="#008000"><i>{80*480+64*3(Palet)}
  </i></font>GetMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
  </i></font>GetMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
  </i></font>GetMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
 
  </i></font>S0<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]^);
  </font>O0<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]^);
 
  </font>S1<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]^);
  </font>O1<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]^);
 
  </font>S2<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]^);
  </font>O2<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]^);
 
  </font>S3<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]^);
  </font>O3<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]^);
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">push ds
 
    mov  di,[O3]
    mov  es,[S3]
   </font><font color="#008000"><i>{es:di          ImageOfset}
    </i></font><font color="#FF00FF">mov  ds,SegA000
    xor  si,si
   </font><font color="#008000"><i>{ds:si          VideoMem}
    </i></font><font color="#FF00FF">mov  dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
    </i></font><font color="#FF00FF">mov  ax,0005h                   </font><font color="#008000"><i>{Mode Register, Write 0, Read  0}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  ax,0304h                   </font><font color="#008000"><i>{Read Plane Select}{Plane 3}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    mov  es,[S2]
    mov  di,[O2]
    xor  si,si
    dec  ah                         </font><font color="#008000"><i>{Plane 2}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    mov  es,[S1]
    mov  di,[O1]
    xor  si,si
    dec  ah                         </font><font color="#008000"><i>{Plane 1}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    mov  es,[S0]
    mov  di,[O0]
    xor  si,si
    dec  ah                         </font><font color="#008000"><i>{Plane 0}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    mov  dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
    </i></font><font color="#FF00FF">mov  ax,0205h                   </font><font color="#008000"><i>{Mode Register, Write Mode 2}
    </i></font><font color="#FF00FF">out  dx,ax
 
    mov  dx,03c7h                   </font><font color="#008000"><i>{Save Palette behind Plane 0}
    </i></font><font color="#FF00FF">mov  al,0
    out  dx,al
    mov  dx,03c9h
    mov  cx,192                     </font><font color="#008000"><i>{64 Colors RxGxB starting}
    </i></font><font color="#FF00FF">rep  insb
    pop  ds
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>Procedure </b></font>RestoreScreen12h<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>O0<font color="#000080">,</font>S0<font color="#000080">,</font>O1<font color="#000080">,</font>S1  <font color="#000080">: </font>word<font color="#000080">;
   </font>O2<font color="#000080">,</font>S2<font color="#000080">,</font>O3<font color="#000080">,</font>S3  <font color="#000080">: </font>word<font color="#000080">;
</font><font color="#FF0000"><b>Label
     </b></font>C1<font color="#000080">,</font>C2<font color="#000080">,</font>rt1<font color="#000080">,</font>rt2<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>S0<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]^);
  </font>O0<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]^);
 
  </font>S1<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]^);
  </font>O1<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]^);
 
  </font>S2<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]^);
  </font>O2<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]^);

  </font>S3<font color="#000080">:=</font>Seg<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]^);
  </font>O3<font color="#000080">:=</font>Ofs<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]^);
  </font><font color="#FF0000"><b>Asm
    </b></font><font color="#FF00FF">push ds
 
    mov   dx,03c8h
    mov   al,0
    out   dx,al
    inc   dx
    mov   cx,192
  C1:
    out   dx,al
    dec   cx
    jnz   C1
 
    mov  dx,03ceh                   </font><font color="#008000"><i>{Graphics Controller}
    </i></font><font color="#FF00FF">mov  ax,0805h                   </font><font color="#008000"><i>{Mode Register, Write Mode 0, Read Mode 1}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  ax,0007h                   </font><font color="#008000"><i>{color don't care Register}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  ax,0ff08h                  </font><font color="#008000"><i>{BitMask Register}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  dx,03c4h                   </font><font color="#008000"><i>{Sequencer Controller}
   {GET OFFSET IN VIDEOMEM}
    </i></font><font color="#FF00FF">mov  es,SegA000
    xor  di,di
   </font><font color="#008000"><i>{es:di                Start in VideoMem}
    </i></font><font color="#FF00FF">mov  si,[O3]
    mov  ds,[S3]
   </font><font color="#008000"><i>{ds:si                Start in Memory}
    </i></font><font color="#FF00FF">mov  ax,0802h                     </font><font color="#008000"><i>{Write Plane Select}
    </i></font><font color="#FF00FF">out  dx,ax
    cli
    mov  cx,19200
    rep  movsw

    xor  di,di
   </font><font color="#008000"><i>{es:di                Start in VideoMem}
    </i></font><font color="#FF00FF">mov  si,[O2]
    mov  ds,[S2]
   </font><font color="#008000"><i>{ds:si                Start in Memory}
    </i></font><font color="#FF00FF">mov  ax,0402h                     </font><font color="#008000"><i>{Write Plane Select}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    xor  di,di
   </font><font color="#008000"><i>{es:di                Start in VideoMem}
    </i></font><font color="#FF00FF">mov  si,[O1]
    mov  ds,[S1]
   </font><font color="#008000"><i>{ds:si                Start in Memory}
    </i></font><font color="#FF00FF">mov  ax,0202h                     </font><font color="#008000"><i>{Write Plane Select}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
 
    xor  di,di
   </font><font color="#008000"><i>{es:di                Start in VideoMem}
    </i></font><font color="#FF00FF">mov  si,[O0]
    mov  ds,[S0]
   </font><font color="#008000"><i>{ds:si                Start in Memory}
    </i></font><font color="#FF00FF">mov  ax,0102h                     </font><font color="#008000"><i>{Write Plane Select}
    </i></font><font color="#FF00FF">out  dx,ax
    mov  cx,19200
    rep  movsw
    sti
    mov  ax,0f02h                  </font><font color="#008000"><i>{Set All Planes to write}
    </i></font><font color="#FF00FF">out  dx,ax
 
    mov  dx,03ceh                  </font><font color="#008000"><i>{Graphics Controller}
    </i></font><font color="#FF00FF">mov  ax,0205h                  </font><font color="#008000"><i>{Mode Register, Write Mode 2}
    </i></font><font color="#FF00FF">out  dx,ax
 
    mov   dx,03c8h
    mov   al,0
    out   dx,al
    inc   dx
    mov   cx,192
    rep   outsb
    pop  ds
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FreeMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
  </i></font>FreeMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
  </i></font>FreeMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">38400</font><font color="#000080">);</font><font color="#008000"><i>{80*480}
  </i></font>FreeMem<font color="#000080">(</font>ScreenGrab<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font><font color="#800000">38592</font><font color="#000080">);</font><font color="#008000"><i>{80*480+64*3}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font><font color="#FF0000"><b>begin
  </b></font>LastWindow12h<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>LoadFont<font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0268.PAS">Original</a><b>]</b></p></body>
</html>
