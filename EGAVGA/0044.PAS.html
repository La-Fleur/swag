<html>
<head><title> "VGA User Fonts" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;so it appears nothing happened).  I have seen some Programs that are
&gt;able to save the Dos font into a buffer in the Program and then just
&gt;set the video card back to that font when the Program quits.  The problem
&gt;is, I have not seen any documented Dos interrupt that will allow me to
&gt;do this.
&gt;  I'm wondering if anyone knows of such an interrupt that I can use to
&gt;  get the current VGA font and save it to a buffer.
&gt;  Any help would be greatly appreciated!

   Interrupt $10 is what you're looking For. Function $11,
   subFunction $30 gets the Character generator info.
   Function $11, subFunction $10 loads user fonts. Function $11 can
   also be used to Reset to one of the hardware fonts (subFunction
   $11 Resets to ROM 8x14, $12 Resets to ROM 8x8, $14 Resets to VGA
   ROM 8x16)

   The structure Types are as follows:
}
</i></font><font color="#FF0000"><b>Type

  </b></font><font color="#008000"><i>{ enumerated font Type }
  </i></font>ROMfont <font color="#000080">= (</font>ROM8x14<font color="#000080">, </font>ROM8x8<font color="#000080">, </font>ROM8x16<font color="#000080">);

  </font><font color="#008000"><i>{ Character definition table }
  </i></font>CharDefTable <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4096</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>CharDefPtr   <font color="#000080">= ^</font>CharDefTable<font color="#000080">;

  </font><font color="#008000"><i>{ Text Character generator table }
  </i></font>Char_Table <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>Points <font color="#000080">:</font>Byte<font color="#000080">;
     </font>Def    <font color="#000080">:</font>CharDefPtr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{ font Format }
  </i></font>FontPackage <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>FontInfo <font color="#000080">:</font>Char_Table<font color="#000080">;
     </font>Ch       <font color="#000080">:</font>CharDefTable<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FontPkgPtr <font color="#000080">= ^</font>FontPackage<font color="#000080">;

</font><font color="#008000"><i>{ Here are some handy Procedures to use those Types: }

</i></font><font color="#FF0000"><b>Procedure </b></font>GetCharGenInfo<font color="#000080">(</font>font<font color="#000080">: </font>ROMfont<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Table<font color="#000080">:</font>Char_Table<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>is_EGA <font color="#FF0000"><b>then
  begin
    </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$30</font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>font <font color="#FF0000"><b>of
      </b></font>ROM8x8 <font color="#000080">: </font>Reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">3</font><font color="#000080">;
      </font>ROM8x14<font color="#000080">: </font>Reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
      </font>ROM8x16<font color="#000080">: </font>Reg<font color="#000080">.</font>BH <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Reg<font color="#000080">);
    </font>Table<font color="#000080">.</font>Def <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Reg<font color="#000080">.</font>ES<font color="#000080">, </font>Reg<font color="#000080">.</font>BP<font color="#000080">);
    </font><font color="#FF0000"><b>Case </b></font>font <font color="#FF0000"><b>of
      </b></font>ROM8x8 <font color="#000080">: </font>Table<font color="#000080">.</font>Points <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
      </font>ROM8x14<font color="#000080">: </font>Table<font color="#000080">.</font>Points <font color="#000080">:= </font><font color="#800000">14</font><font color="#000080">;
      </font>ROM8x16<font color="#000080">: </font>Table<font color="#000080">.</font>Points <font color="#000080">:= </font><font color="#800000">16</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetHardwareFont<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>font <font color="#000080">:</font>ROMfont<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>is_EGA <font color="#FF0000"><b>then
  begin
    </b></font>Reg<font color="#000080">,</font>AH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>font <font color="#FF0000"><b>of
      </b></font>ROM8x14 <font color="#000080">: </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
      </font>ROM8x8  <font color="#000080">: </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
      </font>ROM8x16 <font color="#000080">:
        </font><font color="#FF0000"><b>if </b></font>is_VGA <font color="#FF0000"><b>then
           </b></font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$14 </font><font color="#008000"><i>{ 8x16 on VGA only }
        </i></font><font color="#FF0000"><b>else
        begin
           </b></font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
           </font>font <font color="#000080">:= </font>ROM8x14<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Reg<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Reg<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FetchHardwareFont<font color="#000080">(</font>font <font color="#000080">:</font>ROMfont<font color="#000080">):</font>FontPkgPtr<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>pkg <font color="#000080">:</font>FontPkgPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>pkg<font color="#000080">);
  </font>GetCharGenInfo<font color="#000080">(</font>font<font color="#000080">, </font>Pkg<font color="#000080">^.</font>FontInfo<font color="#000080">);
  </font>Pkg<font color="#000080">^.</font>Ch <font color="#000080">:= </font>Pkg<font color="#000080">^.</font>FontInfo<font color="#000080">.</font>Def<font color="#000080">^;
  </font>FetchHardwareFont <font color="#000080">:= </font>Pkg<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>LoadUserFont<font color="#000080">(</font>pkg <font color="#000080">:</font>FontPkgPtr<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Reg<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>AL <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>pkg<font color="#000080">^.</font>ch<font color="#000080">);
  </font>Reg<font color="#000080">.</font>BP <font color="#000080">:= </font>Ofs<font color="#000080">(</font>pkg<font color="#000080">^.</font>ch<font color="#000080">);
  </font>Reg<font color="#000080">.</font>BH <font color="#000080">:= </font>Pkg<font color="#000080">^.</font>FontInfo<font color="#000080">.</font>Points<font color="#000080">;
  </font>Reg<font color="#000080">.</font>BL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>CX <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
  </font>Reg<font color="#000080">.</font>DX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Reg<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0044.PAS">Original</a><b>]</b></p></body>
</html>
