<html>
<head><title> "Nice Copper Bars" by AKI TIKKALA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0193.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 OK, Sean! I hope this will help you to understand
  my explanation!

 Copper-BAR with 1000 lines (c) Aki Tikkala,1995
}

</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const
     </b></font>lines <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">; </font>delays <font color="#000080">=</font><font color="#800000">30</font><font color="#000080">; </font>start <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">; </font>endo <font color="#000080">= </font><font color="#800000">115</font><font color="#000080">;

</font><font color="#FF0000"><b>var
   </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>p1<font color="#000080">,</font>p2<font color="#000080">,</font>z<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">,</font>gr<font color="#000080">,</font>gm<font color="#000080">,</font>ss<font color="#000080">,</font>red_p<font color="#000080">,</font>blue_p<font color="#000080">,</font>green_p<font color="#000080">,</font>green2_p<font color="#000080">:</font>integer<font color="#000080">;
   </font>blue2_p<font color="#000080">,</font>red2_p<font color="#000080">,</font>max <font color="#000080">: </font>integer<font color="#000080">;
   </font>x1<font color="#000080">,</font>x2<font color="#000080">,</font>red_pnt <font color="#000080">: </font>pointer<font color="#000080">;
   </font>red_s<font color="#000080">,</font>blue_s<font color="#000080">,</font>green_s<font color="#000080">,</font>green2_s<font color="#000080">,</font>red2_s<font color="#000080">,</font>capu <font color="#000080">:</font>byte<font color="#000080">;
   </font>cup <font color="#000080">: </font>boolean<font color="#000080">;
   </font>cloop<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">127</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
   </font>colors<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>lines<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
   </font>clear<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>lines<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>integer<font color="#000080">;
   </font>stab<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>word<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>setpalette<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">);</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm</b></font><font color="#FF00FF">;mov dx,3c8h;mov al,c;mov ah,r;out dx,ax;inc dx;
mov al,g;out dx,al;mov al,b;out dx,al;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>init2<font color="#000080">;
</font><font color="#FF0000"><b>begin
      </b></font>x1 <font color="#000080">:= </font>ptr<font color="#000080">(</font>seg<font color="#000080">(</font>colors<font color="#000080">),</font>ofs<font color="#000080">(</font>colors<font color="#000080">)); </font>x2 <font color="#000080">:= </font>ptr<font color="#000080">(</font>seg<font color="#000080">(</font>clear<font color="#000080">),</font>ofs<font color="#000080">(</font>clear<font color="#000080">));
      </font>blue_s <font color="#000080">:= </font><font color="#800000">20</font><font color="#000080">;</font>green_S <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;</font>green2_s <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>red_S <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
      </font>max <font color="#000080">:= </font>lines<font color="#000080">-</font><font color="#800000">127</font><font color="#000080">; </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lines <font color="#FF0000"><b>do for </b></font>z <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">3 </font><font color="#FF0000"><b>do begin
      </b></font>clear<font color="#000080">[</font>x<font color="#000080">,</font>z<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">; </font>colors<font color="#000080">[</font>x<font color="#000080">,</font>z<font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do begin </b></font>cloop<font color="#000080">[</font>x<font color="#000080">] := </font>x<font color="#000080">; </font>cloop<font color="#000080">[</font>x<font color="#000080">+</font><font color="#800000">63</font><font color="#000080">] := </font><font color="#800000">63</font><font color="#000080">-</font>x<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>draw<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>move<font color="#000080">(</font>x2<font color="#000080">^,</font>x1<font color="#000080">^,</font>sizeof<font color="#000080">(</font>colors<font color="#000080">));
   </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font>start <font color="#FF0000"><b>to </b></font>endo <font color="#FF0000"><b>do
        begin
             </b></font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green2_p<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font>cloop<font color="#000080">[</font>x<font color="#000080">];</font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green2_p<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
             </font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green2_p<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] := </font>cloop<font color="#000080">[</font>x<font color="#000080">];</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font>start <font color="#FF0000"><b>to </b></font>endo <font color="#FF0000"><b>do
        begin
              </b></font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green_p<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">; </font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green_p<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font>cloop<font color="#000080">[</font>x<font color="#000080">];
              </font>colors<font color="#000080">[</font>x<font color="#000080">+</font>green_p<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font>start <font color="#FF0000"><b>to </b></font>endo <font color="#FF0000"><b>do
        begin
             </b></font>colors<font color="#000080">[</font>x<font color="#000080">+</font>blue_p<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;</font>colors<font color="#000080">[</font>x<font color="#000080">+</font>blue_p<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
             </font>colors<font color="#000080">[</font>x<font color="#000080">+</font>blue_p<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] := </font>cloop<font color="#000080">[</font>x<font color="#000080">];  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>x <font color="#000080">:= </font>start <font color="#FF0000"><b>to </b></font>endo  <font color="#FF0000"><b>do
        begin
              </b></font>colors<font color="#000080">[</font>x<font color="#000080">+</font>red_p<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] := </font>cloop<font color="#000080">[</font>x<font color="#000080">];</font>colors<font color="#000080">[</font>x<font color="#000080">+</font>red_p<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
              </font>colors<font color="#000080">[</font>x<font color="#000080">+</font>red_p<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>main<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>blue_p <font color="#000080">:= </font>stab<font color="#000080">[</font>blue_s<font color="#000080">];</font>inc<font color="#000080">(</font>blue_s<font color="#000080">);
     </font>green_p <font color="#000080">:= </font>stab<font color="#000080">[</font>green_s<font color="#000080">];</font>inc<font color="#000080">(</font>green_s<font color="#000080">);
     </font>green2_p <font color="#000080">:= </font>stab<font color="#000080">[</font>green2_s<font color="#000080">];</font>inc<font color="#000080">(</font>green2_s<font color="#000080">);
     </font>red_p <font color="#000080">:= </font>stab<font color="#000080">[</font>red_s<font color="#000080">];</font>inc<font color="#000080">(</font>red_s<font color="#000080">);</font>draw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>wait<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm</b></font><font color="#FF00FF">;mov dx,3dah;@w1:in al,dx;test al,8;jnz @w1;
@w2:in al,dx;test al,8;jz @w2;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>waitline<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm</b></font><font color="#FF00FF">;mov dx,3dah;@a1:in al,dx;and al,01;jne @a1;@a2:in al,dx;
and al,9;cmp al,1;jne @a2;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
    for </b></font>x<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do </b></font>stab<font color="#000080">[</font>x<font color="#000080">]:=</font>round<font color="#000080">((</font>round<font color="#000080">(</font>sin<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">*</font>pi<font color="#000080">*</font>x<font color="#000080">/</font><font color="#800000">255</font><font color="#000080">)*</font><font color="#800000">127</font><font color="#000080">)+</font><font color="#800000">128</font><font color="#000080">)*</font><font color="#800000">3.35</font><font color="#000080">);
    </font>init2<font color="#000080">; </font>cup <font color="#000080">:= </font>true<font color="#000080">; </font>capu <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;</font><font color="#FF0000"><b>asm</b></font><font color="#FF00FF">; mov ax,0013h;int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
         </b></font>wait<font color="#000080">;
         </font><font color="#FF0000"><b>for </b></font>b <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>delays <font color="#FF0000"><b>do </b></font>waitline<font color="#000080">; </font><font color="#008000"><i>{Do some delay}
    </i></font><font color="#FF0000"><b>for </b></font>b <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>lines <font color="#FF0000"><b>do </b></font>setpalette<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>colors<font color="#000080">[</font>b<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>colors<font color="#000080">[</font>b<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>colors<font color="#000080">[</font>b<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
         </font>main<font color="#000080">;
    </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0193.PAS">Original</a><b>]</b></p></body>
</html>
