<html>
<head><title> "ANIVGA Fades - Fixes" by KAI ROHRBACHER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0138.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
&gt; Here are some ANIVGA v1.2 fades I am releasing to public domain:
&gt; { FEB-01-94 Added more FadeIn routines: Curtains, Blinds.  MaxFade CONST. }
  As  I posted some time ago, there's a bug in the GetImage() routine in
  V1.2  (which  can  easily  be  fixed by adding &quot;dec(x1,StartVirtualX);
  dec(y1,StartVirtualY);  dec(x2,StartVirtualX); dec(y2,StartVirtualY);&quot;
  at the beginning of the GetImage() procedure).
  If you did so, you can code your fade's kernel as follows:

  kai.rohrbacher@logo.ka.sub.org
*)

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SweepOutVertical<font color="#000080">(</font>pa<font color="#000080">, </font>time<font color="#000080">: </font>WORD<font color="#000080">; </font>seam<font color="#000080">: </font>BOOLEAN<font color="#000080">);    </font><font color="#008000"><i>{JH New! }
{ in: pa    = page, which contents will be made visible }
{     time  = time (in milliseconds) for this action (approx.) }
{     seam  =TRUE/FALSE for: show curtain seam in actual drawing color}
{     color =seam color (if seam=TRUE)}
{     1-PAGE= (visible) graphic page on which to draw }
{out: - }
{rem: the contents of page &quot;pa&quot; has been copied to page 1-PAGE }
</i></font><font color="#FF0000"><b>CONST </b></font>n<font color="#000080">=</font>Succ<font color="#000080">(</font>YMAX<font color="#000080">);      </font><font color="#008000"><i>{number of executions of the delay loop }
      </i></font>centerY <font color="#000080">= </font>YMAX <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">; </font><font color="#008000"><i>{middle of screen }
</i></font><font color="#FF0000"><b>VAR </b></font>y<font color="#000080">, </font>counter<font color="#000080">: </font>WORD<font color="#000080">;
    </font>ClockTicks<font color="#000080">: </font>LONGINT <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$6C</font><font color="#000080">;
    </font>t<font color="#000080">: </font>LONGINT<font color="#000080">;
    </font>temp<font color="#000080">: </font>REAL<font color="#000080">;
    </font>p1<font color="#000080">: </font>POINTER<font color="#000080">;
    </font>p2<font color="#000080">: </font>POINTER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{SweepOutVertical}
 </i></font>t <font color="#000080">:= </font>ClockTicks<font color="#000080">;
 </font>counter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>temp <font color="#000080">:= </font><font color="#800000">0.0182</font><font color="#000080">*</font>time<font color="#000080">/</font>n<font color="#000080">;

 </font><font color="#008000"><i>{upward }
 </i></font><font color="#FF0000"><b>FOR </b></font>y <font color="#000080">:= </font>centerY <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  BEGIN
   IF </b></font>seam
    <font color="#FF0000"><b>THEN BEGIN
          </b></font>Line<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,
               </font>StartVirtualX<font color="#000080">+</font>XMAX<font color="#000080">,</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
           </font><font color="#008000"><i>{downward }
          </i></font>Line<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>YMAX<font color="#000080">-</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,
               </font>StartVirtualX<font color="#000080">+</font>XMAX<font color="#000080">,</font>YMAX<font color="#000080">-</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>INC<font color="#000080">(</font>counter<font color="#000080">);
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks <font color="#000080">&lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
 </font><font color="#008000"><i>{upward }
   </i></font>p2 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,
                  </font>StartVirtualX<font color="#000080">+</font>XMAX<font color="#000080">,</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>pa<font color="#000080">);
   </font>PutImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>p2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
   </font>FreeImageMem<font color="#000080">(</font>p2<font color="#000080">);
 </font><font color="#008000"><i>{downward }
   </i></font>p1 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>YMAX<font color="#000080">-</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,
                  </font>StartVirtualX<font color="#000080">+</font>XMAX<font color="#000080">,</font>YMAX<font color="#000080">-</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>pa<font color="#000080">);
   </font>PutImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>YMAX<font color="#000080">-</font>y<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>p1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
   </font>FreeImageMem<font color="#000080">(</font>p1<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{SweepOutVertical}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SweepOutHorizontal<font color="#000080">(</font>pa<font color="#000080">, </font>time<font color="#000080">: </font>WORD<font color="#000080">; </font>seam<font color="#000080">: </font>BOOLEAN<font color="#000080">);  </font><font color="#008000"><i>{JH New! }
{ in: pa    = page, which contents will be made visible }
{     time  = time (in milliseconds) for this action (approx.) }
{     seam  =TRUE/FALSE for: show curtain seam in actual drawing color}
{     color =seam color (if seam=TRUE)}
{     1-PAGE= (visible) graphic page on which to draw }
{out: - }
{rem: the contents of page &quot;pa&quot; has been copied to page 1-PAGE }
</i></font><font color="#FF0000"><b>CONST </b></font>n <font color="#000080">= </font>Succ<font color="#000080">(</font>XMAX<font color="#000080">);      </font><font color="#008000"><i>{number of executions of the delay loop }
      </i></font>centerX <font color="#000080">= </font>XMAX <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">; </font><font color="#008000"><i>{middle of screen }
</i></font><font color="#FF0000"><b>VAR </b></font>x<font color="#000080">, </font>counter<font color="#000080">: </font>WORD<font color="#000080">;
    </font>ClockTicks<font color="#000080">: </font>LONGINT <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$6C</font><font color="#000080">;
    </font>t<font color="#000080">: </font>LONGINT<font color="#000080">;
    </font>temp<font color="#000080">: </font>REAL<font color="#000080">;
    </font>p1<font color="#000080">: </font>POINTER<font color="#000080">;
    </font>p2<font color="#000080">: </font>POINTER<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN </b></font><font color="#008000"><i>{SweepOutHorizontal}
 </i></font>t <font color="#000080">:= </font>ClockTicks<font color="#000080">;
 </font>counter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>temp <font color="#000080">:= </font><font color="#800000">0.0182</font><font color="#000080">*</font>time<font color="#000080">/</font>n<font color="#000080">;

 </font><font color="#008000"><i>{right_to_left }
 </i></font><font color="#FF0000"><b>FOR </b></font>x <font color="#000080">:= </font>centerX <font color="#FF0000"><b>DOWNTO </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  BEGIN
   IF </b></font>seam
    <font color="#FF0000"><b>THEN BEGIN
          </b></font>Line<font color="#000080">(</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,
               </font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">+</font>YMAX<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
          </font><font color="#008000"><i>{left_to_right }
          </i></font>Line<font color="#000080">(</font>XMAX<font color="#000080">-</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,
               </font>XMAX<font color="#000080">-</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">+</font>YMAX<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font>INC<font color="#000080">(</font>counter<font color="#000080">);
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks <font color="#000080">&lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
 </font><font color="#008000"><i>{right_to_left }
   </i></font>p2 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,
                  </font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">+</font>YMAX<font color="#000080">,</font>pa<font color="#000080">);
   </font>PutImage<font color="#000080">(</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,</font>p2<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
   </font>FreeImageMem<font color="#000080">(</font>p2<font color="#000080">);
 </font><font color="#008000"><i>{left_to_right }
   </i></font>p1 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>XMAX<font color="#000080">-</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,
                  </font>XMAX<font color="#000080">-</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">+</font>YMAX<font color="#000080">,</font>pa<font color="#000080">);
   </font>PutImage<font color="#000080">(</font>XMAX<font color="#000080">-</font>x<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,</font>p1<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">-</font>PAGE<font color="#000080">);
   </font>FreeImageMem<font color="#000080">(</font>p1<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{SweepOutHorizontal}

</i></font><font color="#000080">...</font><font color="#FF0000"><b>and </b></font>they will work <font color="#FF0000"><b>with </b></font>any <font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">) </font>values<font color="#000080">.
(</font>I  omitted  the <font color="#000080">&quot;</font>color<font color="#000080">:=</font>white<font color="#000080">&quot; </font>stuff so that the seam <font color="#FF0000"><b>is </b></font>drwan <font color="#FF0000"><b>in </b></font>the
actual drawing color<font color="#000080">).


</font>BTW<font color="#000080">:  </font><font color="#FF0000"><b>As </b></font>we are talking about fades<font color="#000080">, </font>here<font color="#800000">'s another one, check it out!
</font><font color="#FF0000"><b>With  </b></font>this one<font color="#000080">, </font>the picture creeps <font color="#FF0000"><b>out </b></font>from the middle line <font color="#FF0000"><b>to </b></font>the top
<font color="#FF0000"><b>and </b></font>bottom <font color="#000080">(</font><font color="#FF0000"><b>as if </b></font>you look at an image folded at its middle line which
becomes opened slowly<font color="#000080">).
</font>I  saw  that one <font color="#FF0000"><b>in </b></font>the opening sequence <font color="#FF0000"><b>of </b></font>EPIC<font color="#800000">'s OVERKILL, and found
</font>it looks nice<font color="#000080">.

</font><font color="#FF0000"><b>PROCEDURE </b></font>VerticalExpand<font color="#000080">(</font>pa<font color="#000080">,</font>time<font color="#000080">:</font>WORD<font color="#000080">);
</font><font color="#008000"><i>{ in: pa    = page, which contents will be made visible }
{     time  = time (in milliseconds) for this action (approx.) }
{out: - }
{rem: the contents of page &quot;pa&quot; has been copied to page visualPage }
</i></font><font color="#FF0000"><b>CONST </b></font>n <font color="#000080">= (</font>YMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*(</font>YMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">8</font><font color="#000080">; </font><font color="#008000"><i>{number of executions of the delay loop}
</i></font><font color="#FF0000"><b>VAR </b></font>ClockTicks<font color="#000080">:^</font>LONGINT<font color="#000080">; </font><font color="#008000"><i>{LONGINT ABSOLUTE $40:$6C geht nicht}
    </i></font>t<font color="#000080">: </font>LONGINT<font color="#000080">;
    </font>temp<font color="#000080">,</font>mitte<font color="#000080">,</font>step<font color="#000080">,</font>akku<font color="#000080">:</font>REAL<font color="#000080">;
    </font>lines<font color="#000080">,</font>y<font color="#000080">:</font>INTEGER<font color="#000080">;

 </font><font color="#FF0000"><b>PROCEDURE </b></font>CopyLine<font color="#000080">(</font>von<font color="#000080">,</font>nach<font color="#000080">:</font>WORD<font color="#000080">);
 </font><font color="#008000"><i>{ in: von = zu kopierende Zeile von Seite pa}
 {     nach= Zielzeile in Seite visualPage dafuer}
 </i></font><font color="#FF0000"><b>VAR </b></font>p1<font color="#000080">:</font>POINTER<font color="#000080">;
 </font><font color="#FF0000"><b>BEGIN
  </b></font>p1 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>von<font color="#000080">+</font>StartVirtualY<font color="#000080">,
                 </font>StartVirtualX<font color="#000080">+</font>XMAX<font color="#000080">,</font>von<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>pa<font color="#000080">);
  </font>PutImage<font color="#000080">(</font>StartVirtualX<font color="#000080">,</font>nach<font color="#000080">+</font>StartVirtualY<font color="#000080">,</font>p1<font color="#000080">,</font>visualPage<font color="#000080">);
  </font>FreeImageMem<font color="#000080">(</font>p1<font color="#000080">);
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
 </b></font>ClockTicks<font color="#000080">:=</font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font><font color="#800000">$6C</font><font color="#000080">);
 </font>t <font color="#000080">:= </font>ClockTicks<font color="#000080">^;
 </font>counter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>temp <font color="#000080">:= </font><font color="#800000">0.0182</font><font color="#000080">*</font>time<font color="#000080">/</font>n<font color="#000080">;

 </font>mitte<font color="#000080">:=</font>YMAX<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;
 </font><font color="#FF0000"><b>FOR </b></font>lines<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#000080">((</font>YMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">)-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>step<font color="#000080">:=</font>YMAX<font color="#000080">/(</font>lines <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">);
   </font>akku<font color="#000080">:=</font>step<font color="#000080">;
   </font><font color="#FF0000"><b>FOR </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>lines<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    BEGIN
     </b></font>CopyLine<font color="#000080">(</font>TRUNC<font color="#000080">(</font>mitte<font color="#000080">-</font>akku<font color="#000080">),(</font>YMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#000080">-</font>y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
     </font>CopyLine<font color="#000080">(</font>TRUNC<font color="#000080">(</font>mitte<font color="#000080">+</font>akku<font color="#000080">),(</font>YMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#000080">+</font>y<font color="#000080">);
     </font>akku<font color="#000080">:=</font>akku<font color="#000080">+</font>step<font color="#000080">;
     </font>INC<font color="#000080">(</font>counter<font color="#000080">);
     </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks<font color="#000080">^ &lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

 </font><font color="#008000"><i>{Cleanup:}
 </i></font>lines<font color="#000080">:=</font>YMAX <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>FOR </b></font>y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>YMAX <font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>CopyLine<font color="#000080">( </font>lines<font color="#000080">-</font>y<font color="#000080">,</font>lines<font color="#000080">-</font>y<font color="#000080">);
   </font>CopyLine<font color="#000080">( </font>lines<font color="#000080">+</font>y<font color="#000080">,</font>lines<font color="#000080">+</font>y<font color="#000080">);
   </font>INC<font color="#000080">(</font>counter<font color="#000080">);
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks<font color="#000080">^ &lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>Odd<font color="#000080">(</font>YMAX<font color="#000080">)
  </font><font color="#FF0000"><b>THEN </b></font>CopyLine<font color="#000080">(</font>YMAX<font color="#000080">,</font>YMAX<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
  I  gave  it  the fade constant &quot;Fade_VerticalExpand=29&quot;, so in routine
  FadeIn() extend the CASE clause by:
     Fade_VerticalExpand: VerticalExpand(pa,ti);
}

</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0138.PAS">Original</a><b>]</b></p></body>
</html>
