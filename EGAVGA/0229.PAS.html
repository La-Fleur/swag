<html>
<head><title> "Fast 3-Point Splines" by WIL BARATH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0229.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 I've seen a lot of Spline and B-Spline code floating around.  Most of it
 is very slow even running with a math unit.  This code is quite reasonably
 fast and will draw very accurate 3-point Splines at a rate of about 180
 splines per second on my 386/40 with _no_ math unit.

 Enjoy!
}

</i></font><font color="#FF0000"><b>Program </b></font>CUrves<font color="#000080">; </font><font color="#008000"><i>{Spline curve demo (C) 1994 by Wil Barath}
</i></font><font color="#FF0000"><b>Uses </b></font>Tgr12<font color="#000080">; </font><font color="#008000"><i>{Mode 12h graphics unit by me available from SWAG}

</i></font><font color="#FF0000"><b>Procedure </b></font>Spline<font color="#000080">(</font>x1<font color="#000080">,</font>y1<font color="#000080">,</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x3<font color="#000080">,</font>y3<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>sx<font color="#000080">,</font>sy<font color="#000080">,</font>dx1<font color="#000080">,</font>dx2<font color="#000080">,</font>dy1<font color="#000080">,</font>dy2<font color="#000080">,</font>sdx<font color="#000080">,</font>sdy<font color="#000080">,</font>l<font color="#000080">:</font>LongInt<font color="#000080">;</font>deep<font color="#000080">,</font>deep2<font color="#000080">,</font>ox<font color="#000080">,</font>oy<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
</b></font><font color="#008000"><i>{  Circle(x1,y1,3);Circle(x2,y2,3);Circle(x3,y3,3);{}
  </i></font>dx1<font color="#000080">:=(</font>x2<font color="#000080">-</font>x1<font color="#000080">); </font>dx2<font color="#000080">:=(</font>x3<font color="#000080">-</font>x2<font color="#000080">); </font>dy1<font color="#000080">:=(</font>y2<font color="#000080">-</font>y1<font color="#000080">); </font>dy2<font color="#000080">:=(</font>y3<font color="#000080">-</font>y2<font color="#000080">);
  </font>Deep<font color="#000080">:=</font><font color="#800000">32</font><font color="#000080">; </font>deep2<font color="#000080">:=</font>Deep<font color="#000080">*</font>Deep<font color="#000080">;
  </font>sdx<font color="#000080">:=</font>dx1<font color="#000080">*</font>Pred<font color="#000080">(</font>deep<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">)-</font>dx2<font color="#000080">;
  </font>sdy<font color="#000080">:=</font>dy1<font color="#000080">*</font>Pred<font color="#000080">(</font>deep<font color="#000080">*</font><font color="#800000">2</font><font color="#000080">)-</font>dy2<font color="#000080">;
  </font>Inc<font color="#000080">(</font>dx1<font color="#000080">,</font>dx1<font color="#000080">); </font>Inc<font color="#000080">(</font>dx2<font color="#000080">,</font>dx2<font color="#000080">); </font>Inc<font color="#000080">(</font>dy1<font color="#000080">,</font>dy1<font color="#000080">); </font>Inc<font color="#000080">(</font>dy2<font color="#000080">,</font>dy2<font color="#000080">);
  </font>sx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>sy<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>x2<font color="#000080">:=</font>x1<font color="#000080">; </font>y2<font color="#000080">:=</font>y1<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>l<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Deep <font color="#FF0000"><b>do
  Begin
    </b></font>ox<font color="#000080">:=</font>x2<font color="#000080">; </font>oy<font color="#000080">:=</font>y2<font color="#000080">; </font>x2<font color="#000080">:=</font>x1<font color="#000080">+</font>sx <font color="#FF0000"><b>Div </b></font>Deep2<font color="#000080">; </font>y2<font color="#000080">:=</font>y1<font color="#000080">+</font>sy <font color="#FF0000"><b>Div </b></font>Deep2<font color="#000080">;
    </font>Line<font color="#000080">(</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>ox<font color="#000080">,</font>oy<font color="#000080">); </font>Inc<font color="#000080">(</font>sx<font color="#000080">,</font>sdx<font color="#000080">); </font>Inc<font color="#000080">(</font>sy<font color="#000080">,</font>sdy<font color="#000080">);
    </font>Inc<font color="#000080">(</font>sdx<font color="#000080">,</font>dx2<font color="#000080">-</font>dx1<font color="#000080">); </font>Inc<font color="#000080">(</font>sdy<font color="#000080">,</font>dy2<font color="#000080">-</font>dy1<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Line<font color="#000080">(</font>x2<font color="#000080">,</font>y2<font color="#000080">,</font>x3<font color="#000080">,</font>y3<font color="#000080">);</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>COnst
  </b></font>Tail<font color="#000080">=</font><font color="#800000">15</font><font color="#000080">;
  </font>m<font color="#000080">:</font>Word<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>px<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;</font>py<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
  </font>dx<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;</font>dy<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer<font color="#000080">;
  </font>l<font color="#000080">,</font>c<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Randomize<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>l<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
  Begin
    </b></font>px<font color="#000080">[</font>l<font color="#000080">]:=</font>Random<font color="#000080">(</font><font color="#800000">600</font><font color="#000080">)+</font><font color="#800000">20</font><font color="#000080">;
    </font>py<font color="#000080">[</font>l<font color="#000080">]:=</font>Random<font color="#000080">(</font><font color="#800000">400</font><font color="#000080">)+</font><font color="#800000">40</font><font color="#000080">;
    </font>dx<font color="#000080">[</font>l<font color="#000080">]:=</font>Random<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">)+</font><font color="#800000">3</font><font color="#000080">; </font>dy<font color="#000080">[</font>l<font color="#000080">]:=</font>Random<font color="#000080">(</font><font color="#800000">12</font><font color="#000080">)+</font><font color="#800000">3</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>l<font color="#000080">:=</font><font color="#800000">3 </font><font color="#FF0000"><b>to </b></font>Tail<font color="#000080">*</font><font color="#800000">3 </font><font color="#FF0000"><b>do Begin </b></font>px<font color="#000080">[</font>l<font color="#000080">]:=</font>l<font color="#000080">;</font>py<font color="#000080">[</font>l<font color="#000080">]:=</font>l<font color="#000080">;</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>VideoMode<font color="#000080">(</font><font color="#800000">$12</font><font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
  Begin
    </b></font>Move<font color="#000080">(</font>px<font color="#000080">,</font>px<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font>Tail<font color="#000080">*</font><font color="#800000">6</font><font color="#000080">-</font><font color="#800000">6</font><font color="#000080">);
    </font>Move<font color="#000080">(</font>py<font color="#000080">,</font>py<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">],</font>Tail<font color="#000080">*</font><font color="#800000">6</font><font color="#000080">-</font><font color="#800000">6</font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>l<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
    Begin
      </b></font>Inc<font color="#000080">(</font>px<font color="#000080">[</font>l<font color="#000080">],</font>dx<font color="#000080">[</font>l<font color="#000080">]); </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>px<font color="#000080">[</font>l<font color="#000080">]&lt;</font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>px<font color="#000080">[</font>l<font color="#000080">]&gt;</font><font color="#800000">620</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>dx<font color="#000080">[</font>l<font color="#000080">]:=-</font>dx<font color="#000080">[</font>l<font color="#000080">];
      </font>Inc<font color="#000080">(</font>py<font color="#000080">[</font>l<font color="#000080">],</font>dy<font color="#000080">[</font>l<font color="#000080">]); </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>py<font color="#000080">[</font>l<font color="#000080">]&lt;</font><font color="#800000">20</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>py<font color="#000080">[</font>l<font color="#000080">]&gt;</font><font color="#800000">460</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>dy<font color="#000080">[</font>l<font color="#000080">]:=-</font>dy<font color="#000080">[</font>l<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>c<font color="#000080">:=</font>m<font color="#000080">;
    </font>SetColor<font color="#000080">(</font>c<font color="#000080">);</font><font color="#FF0000"><b>If </b></font>m<font color="#000080">&lt;</font><font color="#800000">15 </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>m<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>m<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
    </font>Spline<font color="#000080">(</font>px<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>py<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">],</font>px<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>py<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>px<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">],</font>py<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]);
</font><font color="#008000"><i>{    WaitVBL;{}
    </i></font>SetColor<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
    </font>Spline<font color="#000080">(</font>px<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">3</font><font color="#000080">],</font>py<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">3</font><font color="#000080">],</font>px<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">2</font><font color="#000080">],
    </font>py<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">2</font><font color="#000080">],</font>px<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">],</font>py<font color="#000080">[</font>Tail<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>keypressed<font color="#000080">;
  </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0229.PAS">Original</a><b>]</b></p></body>
</html>
