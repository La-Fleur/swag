<html>
<head><title> "Saving the EGA/VGA Font" by LDEBOER@IBM.NET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0270.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>USES </b></font>Graph<font color="#000080">;

</font><font color="#FF0000"><b>TYPE

   </b></font>TByteArray <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">16384</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Byte<font color="#000080">;
   </font>PByteArray <font color="#000080">= ^</font>TByteArray<font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>I<font color="#000080">, </font>J<font color="#000080">: </font>Integer<font color="#000080">; </font>BiosFont<font color="#000080">: </font>PByteArray<font color="#000080">; </font>F<font color="#000080">: </font>Text<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetBiosFont<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">PUSH BP;
   PUSH DS;
   MOV AX, 1130H;
   MOV BX, 0100H;
   INT 10H;
   MOV BX, BP;
   POP DS;
   POP BP;
   MOV WORD PTR [BiosFont], BX;
   MOV WORD PTR [BiosFont+2], ES;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Hex <font color="#000080">(</font>Num<font color="#000080">: </font>Word<font color="#000080">; </font>Nib<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">LES DI, @Result;                                   </font><font color="#008000"><i>{ ES:DI -&gt; return }
   </i></font><font color="#FF00FF">XOR CH, CH;
   MOV CL, Nib;                                       </font><font color="#008000"><i>{ String length }
   </i></font><font color="#FF00FF">MOV ES:[DI], CL;
   JCXZ @@3;                                          </font><font color="#008000"><i>{ Check for zero }
   </i></font><font color="#FF00FF">ADD DI, CX;
   MOV BX, Num;
   STD;                                               </font><font color="#008000"><i>{ Strings backwards }
</i></font><font color="#FF00FF">@@1:
   MOV AL, BL;                                        </font><font color="#008000"><i>{ Current nibble }
   </i></font><font color="#FF00FF">AND AL, $0F;
   OR AL, $30 ;                                       </font><font color="#008000"><i>{ Convert to ascii }
   </i></font><font color="#FF00FF">CMP AL, $3A;
   JB @@2;                                            </font><font color="#008000"><i>{ Contains A-F patch }
   </i></font><font color="#FF00FF">ADD  AL, $07;
@@2:
   STOSB;                                             </font><font color="#008000"><i>{ Store the byte }
   </i></font><font color="#FF00FF">SHR BX, 1;
   SHR BX, 1;
   SHR BX, 1;                                         </font><font color="#008000"><i>{ Roll of nible done }
   </i></font><font color="#FF00FF">SHR BX, 1;
   LOOP @@1;
@@3:
   CLD;                                               </font><font color="#008000"><i>{ Reset direction }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>BEGIN
       </b></font>InitGraph<font color="#000080">(</font>I<font color="#000080">, </font>J<font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
       </font>GetBiosFont<font color="#000080">;
       </font>Assign<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'BiosFont.Bin'</font><font color="#000080">);
       </font>Rewrite<font color="#000080">(</font>F<font color="#000080">);
       </font>WriteLn<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'BiosFont: Array [0..4096] Of Byte = ('</font><font color="#000080">);
       </font><font color="#FF0000"><b>For </b></font>J <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do Begin
         For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font><font color="#800000">15 </font><font color="#FF0000"><b>Do Begin
            </b></font>Write<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'$'</font><font color="#000080">, </font>Hex<font color="#000080">(</font>BiosFont<font color="#000080">^[</font>J<font color="#000080">*</font><font color="#800000">16</font><font color="#000080">+</font>I<font color="#000080">], </font><font color="#800000">2</font><font color="#000080">), </font><font color="#800000">','</font><font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>WriteLn<font color="#000080">(</font>F<font color="#000080">);
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
       </font>WriteLn<font color="#000080">(</font>F<font color="#000080">, </font><font color="#800000">'0);'</font><font color="#000080">);
       </font>Close<font color="#000080">(</font>F<font color="#000080">);
       </font>CloseGraph<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0270.PAS">Original</a><b>]</b></p></body>
</html>
