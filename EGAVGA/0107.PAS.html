<html>
<head><title> "Fading Unit" by FLORIAN ANSORGE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>UNIT </b></font>FadeUnit<font color="#000080">;        </font><font color="#008000"><i>{ This unit does some fading (I hope!) }
                      { The SetCol procedure lets you change individual}
                      { palette entries , for an easier way, try }
                      { the TP setrgbpalette procedure...}
                      { Regards Florian Ansorge :-) }
</i></font><font color="#FF0000"><b>INTERFACE

Procedure </b></font>InitCol<font color="#000080">; </font><font color="#008000"><i>{gets the current palette and saves it}

</i></font><font color="#FF0000"><b>Procedure </b></font>FadeOUT<font color="#000080">(</font>Duration<font color="#000080">:</font>Byte<font color="#000080">);   </font><font color="#008000"><i>{ lowers/increases the brightness,}
</i></font><font color="#FF0000"><b>Procedure </b></font>FadeIN<font color="#000080">(</font>Duration<font color="#000080">:</font>Byte<font color="#000080">);    </font><font color="#008000"><i>{ duration determines the time it takes}

</i></font><font color="#FF0000"><b>Procedure </b></font>SetBrightness<font color="#000080">(</font>Brightness <font color="#000080">:</font>Byte<font color="#000080">);
                                    </font><font color="#008000"><i>{sets the brightness to brightness / 63 }
</i></font><font color="#FF0000"><b>IMPLEMENTATION

USES </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>CONST     </b></font>PelIdxR  <font color="#000080">= </font><font color="#800000">$3c7</font><font color="#000080">; </font><font color="#008000"><i>{Port to read}
          </i></font>PelIdxW  <font color="#000080">= </font><font color="#800000">$3c8</font><font color="#000080">; </font><font color="#008000"><i>{Port to write}
          </i></font>PelData  <font color="#000080">= </font><font color="#800000">$3c9</font><font color="#000080">; </font><font color="#008000"><i>{Dataport}
          </i></font>Maxreg   <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">;  </font><font color="#008000"><i>{Set to 63 for textmode}
          </i></font>MaxInten <font color="#000080">= </font><font color="#800000">63</font><font color="#000080">;

</font><font color="#FF0000"><b>VAR </b></font>col <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxReg<font color="#000080">] </font><font color="#FF0000"><b>of RECORD
                                </b></font>r<font color="#000080">, </font>g<font color="#000080">, </font>b <font color="#000080">: </font>Byte
                              <font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetCol<font color="#000080">(</font>ColNr <font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>r<font color="#000080">, </font>g<font color="#000080">, </font>b <font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font>PelIdxR<font color="#000080">] := </font>ColNr<font color="#000080">;
  </font>r <font color="#000080">:= </font>Port<font color="#000080">[</font>PelData<font color="#000080">];
  </font>g <font color="#000080">:= </font>Port<font color="#000080">[</font>PelData<font color="#000080">];
  </font>b <font color="#000080">:= </font>Port<font color="#000080">[</font>PelData<font color="#000080">];;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetCol<font color="#000080">(</font>ColNr<font color="#000080">, </font>r<font color="#000080">, </font>g<font color="#000080">, </font>b <font color="#000080">:</font>Byte<font color="#000080">); </font><font color="#008000"><i>{Change just one colour}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Port<font color="#000080">[</font>PelIdxW<font color="#000080">] := </font>ColNr<font color="#000080">;
  </font>Port<font color="#000080">[</font>PelData<font color="#000080">] := </font>r<font color="#000080">;
  </font>Port<font color="#000080">[</font>PelData<font color="#000080">] := </font>g<font color="#000080">;
  </font>Port<font color="#000080">[</font>PelData<font color="#000080">] := </font>b<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InitCol<font color="#000080">; </font><font color="#008000"><i>{save initial palette}

</i></font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxReg <font color="#FF0000"><b>DO
    </b></font>GetCol<font color="#000080">(</font>i<font color="#000080">,</font>col<font color="#000080">[</font>i<font color="#000080">].</font>r<font color="#000080">,</font>col<font color="#000080">[</font>i<font color="#000080">].</font>g<font color="#000080">,</font>col<font color="#000080">[</font>i<font color="#000080">].</font>b<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetBrightness<font color="#000080">(</font>Brightness <font color="#000080">:</font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>i          <font color="#000080">:</font>Byte<font color="#000080">;
    </font>fr<font color="#000080">, </font>fg<font color="#000080">, </font>fb <font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxReg <font color="#FF0000"><b>DO
  BEGIN
    </b></font>fr <font color="#000080">:= </font>col<font color="#000080">[</font>i<font color="#000080">].</font>r <font color="#000080">* </font>Brightness <font color="#FF0000"><b>DIV </b></font>MaxInten<font color="#000080">;
    </font>fg <font color="#000080">:= </font>col<font color="#000080">[</font>i<font color="#000080">].</font>g <font color="#000080">* </font>Brightness <font color="#FF0000"><b>DIV </b></font>MaxInten<font color="#000080">;
    </font>fb <font color="#000080">:= </font>col<font color="#000080">[</font>i<font color="#000080">].</font>b <font color="#000080">* </font>Brightness <font color="#FF0000"><b>DIV </b></font>MaxInten<font color="#000080">;
    </font>SetCol<font color="#000080">(</font>i<font color="#000080">,</font>fr<font color="#000080">,</font>fg<font color="#000080">,</font>fb<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FadeOUT<font color="#000080">(</font>Duration <font color="#000080">:</font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font>MaxInten <font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>SetBrightness<font color="#000080">(</font>i<font color="#000080">);
    </font>Delay<font color="#000080">(</font>Duration<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FadeIN<font color="#000080">(</font>Duration <font color="#000080">:</font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>VAR </b></font>i <font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  FOR </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>MaxInten <font color="#FF0000"><b>DO
  BEGIN
    </b></font>SetBrightness<font color="#000080">(</font>i<font color="#000080">);
    </font>Delay<font color="#000080">(</font>Duration<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0107.PAS">Original</a><b>]</b></p></body>
</html>
