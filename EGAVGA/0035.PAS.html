<html>
<head><title> "Another Text Fader" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I attempted to Write a Unit For Text FADING, but I don't have it all down
right...  If any one wants to play With the Unit and perfect it I would not
mind!  My problem is that I do not know the correct values to change in the
color register For the affect of a fade.  Once all the values are 0 the screen
is black, but on the way there the screen gets some strange colors... Also, if
you know how to change the colors, you can implement your own custom colors for
Text mode.  I think 256 different colors, but only 16 at a time. (I am only
guessing at that last part).   The FADEOUT and FADEIN does work here, but it
goes through some strange colors on the way!

Robert
}

</i></font><font color="#FF0000"><b>Unit </b></font>TextFade<font color="#000080">; </font><font color="#008000"><i>{attempt For implementing Text fading}
{ only works For VGA or SVGA as Far as I know! }

</i></font><font color="#FF0000"><b>Interface

Uses </b></font>Dos<font color="#000080">, </font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ColorRegister <font color="#000080">=
  </font><font color="#FF0000"><b>Record
    </b></font>Red      <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Green    <font color="#000080">: </font>Byte<font color="#000080">;
    </font>Blue     <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>ColorRegisterArray    <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ColorRegister<font color="#000080">;
  </font>ColorRegisterArrayPtr <font color="#000080">= ^</font>ColorRegisterArray<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>SaveCRAp      <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SaveColorRegister<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>CRAp <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">);
</font><font color="#008000"><i>{ given a color register Array ptr, this will save the current }
{ values so you can restore from them later...                 }

</i></font><font color="#FF0000"><b>Procedure </b></font>SetColorRegister<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>CRAp <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">);
</font><font color="#008000"><i>{ when you adjust the values of a color register set, this     }
{ Procedure will make put the new values into memory           }

</i></font><font color="#FF0000"><b>Procedure </b></font>FadeOut<font color="#000080">(</font>MS_Delay <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ using the global Variable 'SaveCRAp', this will fade the Text}
{ screen out till all the values in the color register Array   }
{ ptr are 0                                                    }

</i></font><font color="#FF0000"><b>Procedure </b></font>FadeIn<font color="#000080">(</font>MS_Delay <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#008000"><i>{ once again using the global Variable 'SaveCRAp', this will   }
{ fade the screen back in till all values of the current color }
{ register Array ptr are equal to 'SaveCRAp'                   }

</i></font><font color="#FF0000"><b>Implementation

Procedure </b></font>Abort<font color="#000080">(</font>Msg <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font>Msg<font color="#000080">);
  </font>Halt<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SaveColorRegister<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>CRAp <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>R <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>R <font color="#FF0000"><b>Do
  begin
    </b></font>ah <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
    </font>al <font color="#000080">:= </font><font color="#800000">$17</font><font color="#000080">;
    </font>bx <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
    </font>cx <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font>es <font color="#000080">:= </font>Seg<font color="#000080">(</font>crap<font color="#000080">^);
    </font>dx <font color="#000080">:= </font>Ofs<font color="#000080">(</font>crap<font color="#000080">^);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>r<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetColorRegister<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>CRAp <font color="#000080">: </font>ColorREgisterArrayPtr<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>R <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>R <font color="#FF0000"><b>Do
  begin
    </b></font>ah <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
    </font>al <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
    </font>bx <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
    </font>cx <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font>es <font color="#000080">:= </font>Seg<font color="#000080">(</font>crap<font color="#000080">^);
    </font>dx <font color="#000080">:= </font>Ofs<font color="#000080">(</font>crap<font color="#000080">^);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>r<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FadeOut<font color="#000080">(</font>MS_Delay <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>NewCRAp <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">;
  </font>W       <font color="#000080">: </font>Word<font color="#000080">;
  </font>T       <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>NewCRAp<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>NewCRAp <font color="#000080">= </font><font color="#FF0000"><b>NIL Then
    </b></font>Abort<font color="#000080">(</font><font color="#800000">'Not Enough Memory'</font><font color="#000080">);
  </font>NewCrap<font color="#000080">^ := </font>SaveCrap<font color="#000080">^;
  </font><font color="#FF0000"><b>For </b></font>T <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>Do
  begin
    For </b></font>W <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do
    With </b></font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">] </font><font color="#FF0000"><b>Do
    If </b></font>Red <font color="#000080">+ </font>Green <font color="#000080">+ </font>Blue <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    begin
      </b></font>Dec<font color="#000080">(</font>Red<font color="#000080">);
      </font>Dec<font color="#000080">(</font>Green<font color="#000080">);
      </font>Dec<font color="#000080">(</font>Blue<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>SetColorRegister<font color="#000080">(</font>NewCRAp<font color="#000080">);
    </font>Delay<font color="#000080">(</font>MS_Delay<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>FadeIn<font color="#000080">(</font>MS_Delay <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>NewCRAp <font color="#000080">: </font>ColorRegisterArrayPtr<font color="#000080">;
  </font>W       <font color="#000080">: </font>Word<font color="#000080">;
  </font>T       <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>NewCRAp<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>NewCRAp <font color="#000080">= </font><font color="#FF0000"><b>Nil Then
    </b></font>Abort<font color="#000080">(</font><font color="#800000">'Not Enough Memory'</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>NewCRAp<font color="#000080">^,</font>SizeOf<font color="#000080">(</font>NewCRAp<font color="#000080">^),</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>T <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>Do
  </b></font><font color="#008000"><i>{ The values in the color register are not higher than 63 }
  </i></font><font color="#FF0000"><b>begin
    For </b></font>W <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>Do
    If </b></font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Red <font color="#000080">+ </font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Green <font color="#000080">+ </font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Red <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    begin
      If </b></font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Red   <font color="#000080">&lt; </font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Red <font color="#FF0000"><b>Then
        </b></font>Inc<font color="#000080">(</font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Red<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Green <font color="#000080">&lt; </font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Green <font color="#FF0000"><b>Then
        </b></font>Inc<font color="#000080">(</font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Green<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Blue  <font color="#000080">&lt; </font>SaveCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Blue <font color="#FF0000"><b>Then
        </b></font>Inc<font color="#000080">(</font>NewCRAp<font color="#000080">^[</font>w<font color="#000080">].</font>Blue<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>SetColorRegister<font color="#000080">(</font>NewCRAp<font color="#000080">);
    </font>Delay<font color="#000080">(</font>MS_Delay<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin
  </b></font>New<font color="#000080">(</font>SaveCRAp<font color="#000080">);
  </font><font color="#008000"><i>{get memory For the Pointer}
  </i></font><font color="#FF0000"><b>If </b></font>SaveCRAp <font color="#000080">= </font><font color="#FF0000"><b>Nil Then </b></font>Abort<font color="#000080">(</font><font color="#800000">'Not Enough Memory'</font><font color="#000080">);
  </font><font color="#008000"><i>{make sure it actually got some memory}
  </i></font>SaveColorRegister<font color="#000080">(</font>SaveCRAp<font color="#000080">);
  </font><font color="#008000"><i>{save the current values into SaveCRAp}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

---------------</font><font color="#800000">8</font><font color="#000080">&lt;-----</font>cut here<font color="#000080">------&gt;</font><font color="#800000">8</font><font color="#000080">---------

</font>Here <font color="#FF0000"><b>is </b></font>a demo <font color="#FF0000"><b>of </b></font>how <font color="#FF0000"><b>to </b></font>use it<font color="#000080">...


</font><font color="#FF0000"><b>Uses </b></font>TextFADE<font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>FADEOUT<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
   </font>WriteLN<font color="#000080">(</font><font color="#800000">' HOW DOES THIS LOOK'</font><font color="#000080">);
   </font>FADEIN<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
   </font>Dispose<font color="#000080">(</font>SaveCRAp<font color="#000080">);
   </font><font color="#008000"><i>{I just Realized I never got rid of this Pointer before!}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0035.PAS">Original</a><b>]</b></p></body>
</html>
