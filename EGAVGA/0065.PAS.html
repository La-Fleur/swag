<html>
<head><title> "PLASMA Fractal" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;Do you have Pascal code For generating this PLAsmA fractal? if so,
&gt;then I'd like to snarf a copy of it, if'n you don't mind... Or (if it's
&gt;not too large) could you post it as a message? Thanx in advance!
}

</i></font><font color="#FF0000"><b>Program </b></font>PlAsma<font color="#000080">;

</font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Const
  </b></font>f <font color="#000080">= </font><font color="#800000">2.0</font><font color="#000080">;
  </font>EndProgram  <font color="#000080">: </font>Boolean <font color="#000080">= </font>False<font color="#000080">;
  </font>DelayFactor <font color="#000080">: </font>Byte    <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>ColorValue  <font color="#000080">= </font><font color="#FF0000"><b>Record
    </b></font>Rvalue<font color="#000080">,
    </font>Gvalue<font color="#000080">,
    </font>Bvalue <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>PaletteType <font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ColorValue<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>ch    <font color="#000080">: </font>Char<font color="#000080">;
  </font>i     <font color="#000080">: </font>Integer<font color="#000080">;
  </font>image <font color="#000080">: </font><font color="#FF0000"><b>File</b></font><font color="#000080">;
  </font>ok    <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>p     <font color="#000080">: </font>paletteType<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetVGApalette<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>tp <font color="#000080">: </font>PaletteType<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  With </b></font>regs <font color="#FF0000"><b>do
  begin
    </b></font>AX <font color="#000080">:= </font><font color="#800000">$1012</font><font color="#000080">;
    </font>BX <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>CX <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font>ES <font color="#000080">:= </font>Seg<font color="#000080">(</font>tp<font color="#000080">);
    </font>DX <font color="#000080">:= </font>Ofs<font color="#000080">(</font>tp<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>regs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>PutPixel<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">; </font>c <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>mem<font color="#000080">[</font><font color="#800000">$a000 </font><font color="#000080">: </font>Word<font color="#000080">(</font><font color="#800000">320 </font><font color="#000080">* </font>y <font color="#000080">+ </font>x<font color="#000080">)] := </font>c<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetPixel<font color="#000080">(</font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">) : </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetPixel <font color="#000080">:= </font>mem<font color="#000080">[</font><font color="#800000">$a000 </font><font color="#000080">: </font>Word<font color="#000080">(</font><font color="#800000">320 </font><font color="#000080">* </font>y <font color="#000080">+ </font>x<font color="#000080">)];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>adjust<font color="#000080">(</font>xa<font color="#000080">, </font>ya<font color="#000080">, </font>x<font color="#000080">, </font>y<font color="#000080">, </font>xb<font color="#000080">, </font>yb <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>d<font color="#000080">, </font>v <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GetPixel<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font>d <font color="#000080">:= </font>abs<font color="#000080">(</font>xa <font color="#000080">- </font>xb<font color="#000080">) + </font>abs<font color="#000080">(</font>ya <font color="#000080">- </font>yb<font color="#000080">);
  </font>v <font color="#000080">:= </font>trunc<font color="#000080">((</font>GetPixel<font color="#000080">(</font>xa<font color="#000080">, </font>ya<font color="#000080">) + </font>GetPixel<font color="#000080">(</font>xb<font color="#000080">, </font>yb<font color="#000080">)) / </font><font color="#800000">2 </font><font color="#000080">+
       (</font>random <font color="#000080">- </font><font color="#800000">0.5</font><font color="#000080">) * </font>d <font color="#000080">* </font>F<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>v <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>v <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>v <font color="#000080">&gt;= </font><font color="#800000">193 </font><font color="#FF0000"><b>then
    </b></font>v <font color="#000080">:= </font><font color="#800000">192</font><font color="#000080">;
  </font>putpixel<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>v<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>subDivide<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2 <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">, </font>y <font color="#000080">: </font>Integer<font color="#000080">;
  </font>v    <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>KeyPressed <font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x2 <font color="#000080">- </font>x1 <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y2 <font color="#000080">- </font>y1 <font color="#000080">&lt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font>x <font color="#000080">:= (</font>x1 <font color="#000080">+ </font>x2<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
  </font>y <font color="#000080">:= (</font>y1 <font color="#000080">+ </font>y2<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
  </font>adjust<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y1<font color="#000080">);
  </font>adjust<font color="#000080">(</font>x2<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">);
  </font>adjust<font color="#000080">(</font>x1<font color="#000080">, </font>y2<font color="#000080">, </font>x<font color="#000080">, </font>y2<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">);
  </font>adjust<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x1<font color="#000080">, </font>y<font color="#000080">, </font>x1<font color="#000080">, </font>y2<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>GetPixel<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>v <font color="#000080">:= (</font>GetPixel<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">) + </font>GetPixel<font color="#000080">(</font>x2<font color="#000080">, </font>y1<font color="#000080">) + </font>GetPixel<font color="#000080">(</font>x2<font color="#000080">, </font>y2<font color="#000080">) +
          </font>getPixel<font color="#000080">(</font>x1<font color="#000080">, </font>y2<font color="#000080">)) / </font><font color="#800000">4</font><font color="#000080">;
    </font>putpixel<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>Trunc<font color="#000080">(</font>v<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>SubDivide<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x<font color="#000080">, </font>y<font color="#000080">);
  </font>subDivide<font color="#000080">(</font>x<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y<font color="#000080">);
  </font>subDivide<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">);
  </font>subDivide<font color="#000080">(</font>x1<font color="#000080">, </font>y<font color="#000080">, </font>x<font color="#000080">, </font>y2<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>rotatePalette<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>p <font color="#000080">: </font>PaletteType<font color="#000080">; </font>n1<font color="#000080">, </font>n2<font color="#000080">, </font>d <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>q <font color="#000080">: </font>PaletteType<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>q <font color="#000080">:= </font>p<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>n1 <font color="#FF0000"><b>to </b></font>n2 <font color="#FF0000"><b>do
    </b></font>p<font color="#000080">[</font>i<font color="#000080">] :=</font>q<font color="#000080">[</font>n1 <font color="#000080">+ (</font>i <font color="#000080">+ </font>d<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#000080">(</font>n2 <font color="#000080">- </font>n1 <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)];
  </font>SetVGApalette<font color="#000080">(</font>p<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  Inline</b></font><font color="#000080">(</font><font color="#800000">$b8</font><font color="#000080">/</font><font color="#800000">$13</font><font color="#000080">/</font><font color="#800000">0</font><font color="#000080">/</font><font color="#800000">$cd</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>P<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>do
  begin
    </b></font>Rvalue <font color="#000080">:= </font><font color="#800000">32</font><font color="#000080">;
    </font>Gvalue <font color="#000080">:= </font><font color="#800000">32</font><font color="#000080">;
    </font>Bvalue <font color="#000080">:= </font><font color="#800000">32</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do
  begin
    With </b></font>p<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      </b></font>Rvalue <font color="#000080">:= </font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">; </font><font color="#008000"><i>{ 63 - i }
      </i></font>Gvalue <font color="#000080">:= </font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">; </font><font color="#008000"><i>{ 63 - i }
      </i></font>Bvalue <font color="#000080">:= </font>i<font color="#000080">+</font><font color="#800000">63</font><font color="#000080">;    </font><font color="#008000"><i>{ 0 }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>With </b></font>p<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">65</font><font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      </b></font>Rvalue <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;    </font><font color="#008000"><i>{ 0 }
      </i></font>Gvalue <font color="#000080">:= </font>i<font color="#000080">+</font><font color="#800000">63</font><font color="#000080">;    </font><font color="#008000"><i>{ i }
      </i></font>Bvalue <font color="#000080">:= </font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">;    </font><font color="#008000"><i>{ 0 }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>With </b></font>p<font color="#000080">[</font>i <font color="#000080">+ </font><font color="#800000">129</font><font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      </b></font>Rvalue <font color="#000080">:= </font>i<font color="#000080">;    </font><font color="#008000"><i>{ 0 }
      </i></font>Gvalue <font color="#000080">:= </font>i<font color="#000080">;    </font><font color="#008000"><i>{ 0 }
      </i></font>Bvalue <font color="#000080">:= </font><font color="#800000">63 </font><font color="#000080">- </font>i<font color="#000080">; </font><font color="#008000"><i>{ 63 - i }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Inline</b></font><font color="#000080">(</font><font color="#800000">$b8</font><font color="#000080">/</font><font color="#800000">$13</font><font color="#000080">/</font><font color="#800000">0</font><font color="#000080">/</font><font color="#800000">$cd</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);

  </font>SetVGApalette<font color="#000080">(</font>p<font color="#000080">);
  </font>Assign<font color="#000080">(</font>image<font color="#000080">, </font><font color="#800000">'PLASMA.IMG'</font><font color="#000080">);
  </font><font color="#008000"><i>{$i-}
  </i></font>Reset<font color="#000080">(</font>image<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#008000"><i>{$I+}
  </i></font>ok <font color="#000080">:= (</font>ioResult <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if not </b></font>ok <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ParamCount <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    </b></font>Randomize<font color="#000080">;
    </font>putpixel<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">+ </font>Random<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">));
    </font>putpixel<font color="#000080">(</font><font color="#800000">319</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">+ </font>Random<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">));
    </font>putpixel<font color="#000080">(</font><font color="#800000">319</font><font color="#000080">, </font><font color="#800000">199</font><font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">+ </font>Random<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">));
    </font>putpixel<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">199</font><font color="#000080">, </font><font color="#800000">1 </font><font color="#000080">+ </font>Random<font color="#000080">(</font><font color="#800000">192</font><font color="#000080">));
    </font>SubDivide<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">319</font><font color="#000080">, </font><font color="#800000">199</font><font color="#000080">);
    </font>ReWrite<font color="#000080">(</font>image<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>BlockWrite<font color="#000080">(</font>image<font color="#000080">, </font>mem<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">$FA00</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
    </b></font>BlockRead<font color="#000080">(</font>image<font color="#000080">, </font>mem<font color="#000080">[</font><font color="#800000">$a000</font><font color="#000080">:</font><font color="#800000">0</font><font color="#000080">], </font><font color="#800000">$FA00</font><font color="#000080">);

  </font>Close<font color="#000080">(</font>image<font color="#000080">);
  </font><font color="#FF0000"><b>Repeat
    </b></font>rotatePalette<font color="#000080">(</font>p<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">192</font><font color="#000080">, + </font><font color="#800000">1</font><font color="#000080">);
    </font>Delay<font color="#000080">(</font>DelayFactor<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>KeyPressed <font color="#FF0000"><b>then
    Case </b></font>ReadKey <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0 </font><font color="#000080">: </font><font color="#FF0000"><b>Case </b></font>ReadKey <font color="#FF0000"><b>of
             </b></font><font color="#800000">#80 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>DelayFactor <font color="#000080">&lt; </font><font color="#800000">255 </font><font color="#FF0000"><b>then
                     </b></font>Inc<font color="#000080">(</font>DelayFactor<font color="#000080">);
             </font><font color="#800000">#72 </font><font color="#000080">: </font><font color="#FF0000"><b>If </b></font>DelayFactor <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
                     </b></font>Dec<font color="#000080">(</font>DelayFactor<font color="#000080">);
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">#113</font><font color="#000080">,</font><font color="#800000">#81 </font><font color="#008000"><i>{Q,q} </i></font><font color="#000080">: </font>EndProgram <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Until </b></font>EndProgram<font color="#000080">;

  </font>TextMode<font color="#000080">(</font>lastmode<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0065.PAS">Original</a><b>]</b></p></body>
</html>
