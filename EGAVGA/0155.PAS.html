<html>
<head><title> "ANIVGA Horizontal Expand Fade" by JOHN HOWARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0155.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
I went ahead and wrote a fade_HorizontalExpand using Kai
Rohrbacher's fade_VerticalExpand as a guide.  The fade was too slow, so I
reduced the detailed inner loop and had the clean-up complete the effect.
}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>HorizontalExpand<font color="#000080">(</font>pa<font color="#000080">, </font>time<font color="#000080">: </font>WORD<font color="#000080">);                          </font><font color="#008000"><i>{ JH }
{ in: pa    = page, which contents will be made visible }
{     time  = time (in milliseconds) for this action (approx.) }
{out: - }
{rem: the contents of page &quot;pa&quot; has been copied to page visualPage }
{jh &quot;n&quot; was (YMAX+1)*(YMAX+1) DIV 8 = 5000}
</i></font><font color="#FF0000"><b>CONST </b></font>n <font color="#000080">= </font><font color="#800000">2000</font><font color="#000080">; </font><font color="#008000"><i>{number of executions of the delay loop}
</i></font><font color="#FF0000"><b>VAR </b></font>ClockTicks<font color="#000080">:^</font>LONGINT<font color="#000080">;
    </font>counter<font color="#000080">: </font>WORD<font color="#000080">;
    </font>t<font color="#000080">: </font>LONGINT<font color="#000080">;
    </font>temp<font color="#000080">, </font>middle<font color="#000080">, </font>step<font color="#000080">, </font>akku<font color="#000080">: </font>REAL<font color="#000080">;
    </font>lines<font color="#000080">, </font>x<font color="#000080">: </font>INTEGER<font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>CopyLine<font color="#000080">(</font>from<font color="#000080">, </font>dest<font color="#000080">: </font>WORD<font color="#000080">);
   </font><font color="#008000"><i>{ in: from = to duplicate line from page pa}
   {     dest = endline in page visualPage differ}
   </i></font><font color="#FF0000"><b>VAR </b></font>p1<font color="#000080">:</font>POINTER<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
     </b></font>p1 <font color="#000080">:= </font>GetImage<font color="#000080">(</font>from<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,
                    </font>from<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">+</font>YMAX<font color="#000080">,</font>pa<font color="#000080">);
     </font>PutImage<font color="#000080">(</font>dest<font color="#000080">+</font>StartVirtualX<font color="#000080">,</font>StartVirtualY<font color="#000080">,</font>p1<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">-</font>Page<font color="#000080">); </font><font color="#008000"><i>{jh visualPage}
     </i></font>FreeImageMem<font color="#000080">(</font>p1<font color="#000080">);
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{CopyLine}

</i></font><font color="#FF0000"><b>BEGIN
 </b></font>ClockTicks <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Seg0040<font color="#000080">,</font><font color="#800000">$6C</font><font color="#000080">);
 </font>t <font color="#000080">:= </font>ClockTicks<font color="#000080">^;
 </font>counter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
 </font>temp <font color="#000080">:= </font><font color="#800000">0.0182</font><font color="#000080">*</font>time<font color="#000080">/</font>n<font color="#000080">;

 </font>middle <font color="#000080">:= </font>XMAX<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">;
 </font><font color="#008000"><i>{jh FOR lines := 1 TO ((XMAX+1) SHR 1)-1 DO =159}
 </i></font><font color="#FF0000"><b>FOR </b></font>lines <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">99 </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>step <font color="#000080">:= </font>XMAX<font color="#000080">/(</font>lines <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">);
   </font>akku <font color="#000080">:= </font>step<font color="#000080">;
   </font><font color="#FF0000"><b>FOR </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>lines<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>DO
    BEGIN  </b></font><font color="#008000"><i>{jh The SHR 1 handling is for only two Copylines at a time}
     </i></font>CopyLine<font color="#000080">( </font>TRUNC<font color="#000080">(</font>middle<font color="#000080">-</font>akku<font color="#000080">),(</font>XMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#000080">-</font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
     </font>CopyLine<font color="#000080">( </font>TRUNC<font color="#000080">(</font>middle<font color="#000080">+</font>akku<font color="#000080">),(</font>XMAX<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#000080">+</font>x<font color="#000080">);
     </font>akku <font color="#000080">:= </font>akku <font color="#000080">+ </font>step<font color="#000080">;
     </font>INC<font color="#000080">(</font>counter<font color="#000080">);
     </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks<font color="#000080">^ &lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

 </font><font color="#008000"><i>{Cleanup:}
 </i></font>lines <font color="#000080">:= </font>XMAX <font color="#FF0000"><b>SHR </b></font><font color="#800000">1</font><font color="#000080">;
 </font><font color="#FF0000"><b>FOR </b></font>x <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>XMAX <font color="#FF0000"><b>SHR </b></font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  BEGIN
   </b></font>CopyLine<font color="#000080">( </font>lines<font color="#000080">-</font>x<font color="#000080">,</font>lines<font color="#000080">-</font>x<font color="#000080">);
   </font>CopyLine<font color="#000080">( </font>lines<font color="#000080">+</font>x<font color="#000080">,</font>lines<font color="#000080">+</font>x<font color="#000080">);
   </font>INC<font color="#000080">(</font>counter<font color="#000080">);
   </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>ClockTicks<font color="#000080">^ &lt; (</font>t<font color="#000080">+</font>counter<font color="#000080">*</font>temp<font color="#000080">)) </font><font color="#FF0000"><b>DO BEGIN END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>IF </b></font>Odd<font color="#000080">(</font>XMAX<font color="#000080">)
  </font><font color="#FF0000"><b>THEN </b></font>CopyLine<font color="#000080">(</font>XMAX<font color="#000080">,</font>XMAX<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;  </font><font color="#008000"><i>{HorizontalExpand}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0155.PAS">Original</a><b>]</b></p></body>
</html>
