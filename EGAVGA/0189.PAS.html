<html>
<head><title> "StarField 2!" by GRANT SMITH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0189.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ Updated EGAVGA.SWG on May 26, 1995 }

(*
From: denthor@goth.vironix.co.za (Grant Smith)

Scott Stone (Scott.Stone@m.cc.utah.edu) wrote:

Your code is not too bad .. here is my version which is quite a bit faster,
but uses assembler to acheive this... the stars also move in smaller
increments, which makes them slightly smoother.

:   for i:=0 to 63999 do
:   begin
:     mem[seg(p3^):i]:=0;
:   end;

Ouch! Even   fillchar (mem[seg(p3^):0, 64000, 0) would be much faster...
loops are generally a bad plan ... you could gain quite a big speedup by
converting this.

: Procedure SwapPages;
: Begin
:   move(mem[seg(p2^):0],mem[$A000:0],64000);
:   move(mem[seg(p3^):0],mem[seg(p2^):0],64000);
: End;
:     {Moves the data from the imaginary &quot;page 2&quot; to the visible page #1,}
:     {Then moves the blank page 3 over to page 2, to start over.  this}
:     {is how you do smooth animation.}

You ony need one virtual page ... sort of say
cls (virtual screen)
draw (virtual screen)
flip (virtual screen, vga)


Here goes ... this source is from my trainer series, available on
ftp.eng.ufl.edu pub/msdos/demos/code/graph/tutor

Byeeeeee....
  - Denthor
*)

{$X+}
</i></font><font color="#FF0000"><b>USES </b></font>crt<font color="#000080">; 
 
</font><font color="#FF0000"><b>CONST </b></font>Num <font color="#000080">= </font><font color="#800000">400</font><font color="#000080">;     </font><font color="#008000"><i>{ Number of stars }
      </i></font>VGA <font color="#000080">= </font><font color="#800000">$A000</font><font color="#000080">; 
 
</font><font color="#FF0000"><b>TYPE </b></font>Star <font color="#000080">= </font><font color="#FF0000"><b>Record 
              </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>z<font color="#000080">:</font>integer<font color="#000080">; 
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;     </font><font color="#008000"><i>{ Information on each star } 
     </i></font>Pos <font color="#000080">= </font><font color="#FF0000"><b>Record 
             </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; 
           </font><font color="#FF0000"><b>End</b></font><font color="#000080">;      </font><font color="#008000"><i>{ Information on each point to be plotted } 
     </i></font><font color="#FF0000"><b>Virtual </b></font><font color="#000080">= </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">64000</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;  </font><font color="#008000"><i>{ The size of our Virtual Screen } 
     </i></font>VirtPtr <font color="#000080">= ^</font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;                  </font><font color="#008000"><i>{ Pointer to the virtual screen } 
 
</i></font><font color="#FF0000"><b>VAR </b></font>Stars <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>num<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>star<font color="#000080">; 
    </font>Clear <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font>num<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>pos<font color="#000080">; 
    </font>Virscr <font color="#000080">: </font>VirtPtr<font color="#000080">;                     </font><font color="#008000"><i>{ Our first Virtual screen } 
    </i></font>Vaddr  <font color="#000080">: </font>word<font color="#000080">;                        </font><font color="#008000"><i>{ The segment of our virtual screen} 
 
{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>SetUpVirtual<font color="#000080">; 
   </font><font color="#008000"><i>{ This sets up the memory needed for the virtual screen } 
</i></font><font color="#FF0000"><b>BEGIN 
  </b></font>GetMem <font color="#000080">(</font>VirScr<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">); 
  </font>vaddr <font color="#000080">:= </font>seg <font color="#000080">(</font>virscr<font color="#000080">^); 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>ShutDown<font color="#000080">; 
   </font><font color="#008000"><i>{ This frees the memory used by the virtual screen } 
</i></font><font color="#FF0000"><b>BEGIN 
  </b></font>FreeMem <font color="#000080">(</font>VirScr<font color="#000080">,</font><font color="#800000">64000</font><font color="#000080">); 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>SetMCGA<font color="#000080">;  </font><font color="#008000"><i>{ This procedure gets you into 320x200x256 mode. } 
</i></font><font color="#FF0000"><b>BEGIN 
  asm 
     </b></font><font color="#FF00FF">mov        ax,0013h 
     int        10h 
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>SetText<font color="#000080">;  </font><font color="#008000"><i>{ This procedure returns you to text mode.  }
</i></font><font color="#FF0000"><b>BEGIN 
  asm 
     </b></font><font color="#FF00FF">mov        ax,0003h
     int        10h 
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Cls <font color="#000080">(</font>Where<font color="#000080">:</font>word<font color="#000080">;</font>Col <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
   </font><font color="#008000"><i>{ This clears the screen to the specified color } 
</i></font><font color="#FF0000"><b>asm 
   </b></font><font color="#FF00FF">push    es 
   mov     cx, 32000; 
   mov     es,[where] 
   xor     di,di 
   mov     al,[col] 
   mov     ah,al 
   rep     stosw 
   pop     es 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>procedure </b></font>flip<font color="#000080">(</font>source<font color="#000080">,</font>dest<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
  </font><font color="#008000"><i>{ This copies the entire screen at &quot;source&quot; to destination } 
</i></font><font color="#FF0000"><b>asm 
  </b></font><font color="#FF00FF">push    ds 
  mov     ax, [Dest] 
  mov     es, ax 
  mov     ax, [Source] 
  mov     ds, ax 
  xor     si, si 
  xor     di, di 
  mov     cx, 32000 
  rep     movsw 
  pop     ds 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>procedure </b></font>WaitRetrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
  </font><font color="#008000"><i>{  This waits for a vertical retrace to reduce snow on the screen } 
</i></font><font color="#FF0000"><b>label 
  </b></font>l1<font color="#000080">, </font>l2<font color="#000080">; 
</font><font color="#FF0000"><b>asm 
    </b></font><font color="#FF00FF">mov dx,3DAh 
l1:
    in al,dx 
    and al,08h 
    jnz l1
l2: 
    in al,dx 
    and al,08h 
    jz  l2 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Pal<font color="#000080">(</font>Col<font color="#000080">,</font>R<font color="#000080">,</font>G<font color="#000080">,</font>B <font color="#000080">: </font>Byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
  </font><font color="#008000"><i>{ This sets the Red, Green and Blue values of a certain color } 
</i></font><font color="#FF0000"><b>asm 
   </b></font><font color="#FF00FF">mov    dx,3c8h 
   mov    al,[col] 
   out    dx,al 
   inc    dx 
   mov    al,[r] 
   out    dx,al 
   mov    al,[g] 
   out    dx,al 
   mov    al,[b] 
   out    dx,al 
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Putpixel <font color="#000080">(</font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Integer<font color="#000080">; </font>Col <font color="#000080">: </font>Byte<font color="#000080">; </font>where<font color="#000080">:</font>word<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; 
  </font><font color="#008000"><i>{ This puts a pixel on the screen by writing directly to memory. } 
</i></font><font color="#FF0000"><b>Asm 
  </b></font><font color="#FF00FF">mov     ax,[where] 
  mov     es,ax 
  mov     bx,[X] 
  mov     dx,[Y] 
  mov     di,bx 
  mov     bx, dx                  </font><font color="#008000"><i>{; bx = dx} 
  </i></font><font color="#FF00FF">shl     dx, 8 
  shl     bx, 6 
  add     dx, bx                  </font><font color="#008000"><i>{; dx = dx + bx (ie y*320)} 
  </i></font><font color="#FF00FF">add     di, dx                  </font><font color="#008000"><i>{; finalise location} 
  </i></font><font color="#FF00FF">mov     al, [Col] 
  stosb 
</font><font color="#FF0000"><b>End</b></font><font color="#000080">; 
 

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Init<font color="#000080">; 
</font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>loop2<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN 
  for </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do 
    Repeat 
      </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>x<font color="#000080">:=</font>random <font color="#000080">(</font><font color="#800000">400</font><font color="#000080">)-</font><font color="#800000">200</font><font color="#000080">; 
      </font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>y<font color="#000080">:=</font>random <font color="#000080">(</font><font color="#800000">400</font><font color="#000080">)-</font><font color="#800000">200</font><font color="#000080">; 
      </font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">:=</font>loop1<font color="#000080">; 
    </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>x<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>y<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">); 
      </font><font color="#008000"><i>{ Make sure no stars are heading directly towards the viewer } 
  </i></font>pal <font color="#000080">(</font><font color="#800000">32</font><font color="#000080">,</font><font color="#800000">00</font><font color="#000080">,</font><font color="#800000">00</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">); 
  </font>pal <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">40</font><font color="#000080">); 
  </font>pal <font color="#000080">(</font><font color="#800000">34</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,</font><font color="#800000">50</font><font color="#000080">); 
  </font>pal <font color="#000080">(</font><font color="#800000">35</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">60</font><font color="#000080">);   </font><font color="#008000"><i>{ Pallette for the stars coming towards you } 
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Calcstars<font color="#000080">; 
  </font><font color="#008000"><i>{ This calculates the 2-d coordinates of our stars and saves these values 
    into the variable clear } 
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; 
</font><font color="#FF0000"><b>BEGIN 
  For </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do BEGIN 
    </b></font>x<font color="#000080">:=((</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>x <font color="#FF0000"><b>shl </b></font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">)+</font><font color="#800000">160</font><font color="#000080">; 
    </font>y<font color="#000080">:=((</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>y <font color="#FF0000"><b>shl </b></font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">)+</font><font color="#800000">100</font><font color="#000080">; 
    </font>clear<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>loop1<font color="#000080">].</font>x<font color="#000080">:=</font>x<font color="#000080">; 
    </font>clear<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>loop1<font color="#000080">].</font>y<font color="#000080">:=</font>y<font color="#000080">; 
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Drawstars<font color="#000080">; 
  </font><font color="#008000"><i>{ This draws the 2-d values stored in clear to the vga screen, with various 
    colors according to how far away it is. } 
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; 
</font><font color="#FF0000"><b>BEGIN 
  For </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do BEGIN 
    </b></font>x<font color="#000080">:=</font>clear<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>loop1<font color="#000080">].</font>x<font color="#000080">; 
    </font>y<font color="#000080">:=</font>clear<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font>loop1<font color="#000080">].</font>y<font color="#000080">; 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&lt;</font><font color="#800000">320</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>then 
      </b></font>putpixel<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">-</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z <font color="#FF0000"><b>shr </b></font><font color="#800000">7</font><font color="#000080">,</font>vaddr<font color="#000080">) 
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 

</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Clearstars<font color="#000080">; 
  </font><font color="#008000"><i>{ This clears the 2-d values from the virtual screen, which is faster then a
    cls (vaddr,0) } 
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">; 
</font><font color="#FF0000"><b>BEGIN 
  For </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do BEGIN 
    </b></font>x<font color="#000080">:=</font>clear<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font>loop1<font color="#000080">].</font>x<font color="#000080">; 
    </font>y<font color="#000080">:=</font>clear<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">,</font>loop1<font color="#000080">].</font>y<font color="#000080">; 
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>x<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>x<font color="#000080">&lt;</font><font color="#800000">320</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>y<font color="#000080">&lt;</font><font color="#800000">200</font><font color="#000080">) </font><font color="#FF0000"><b>then 
      </b></font>putpixel <font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>vaddr<font color="#000080">); 
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>MoveStars <font color="#000080">(</font>Towards<font color="#000080">:</font>boolean<font color="#000080">); 
  </font><font color="#008000"><i>{ If towards is True, then the z-value of each star is decreased to come 
    towards the viewer, otherwise the z-value is increased to go away from 
    the viewer } 
</i></font><font color="#FF0000"><b>VAR </b></font>loop1<font color="#000080">:</font>integer<font color="#000080">; 
</font><font color="#FF0000"><b>BEGIN 
  If </b></font>towards <font color="#FF0000"><b>then 
    for </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do BEGIN 
      </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">:=</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">-</font><font color="#800000">2</font><font color="#000080">; 
      </font><font color="#FF0000"><b>if </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">:=</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">+</font>num<font color="#000080">; 
    </font><font color="#FF0000"><b>END 
    else 
    for </b></font>loop1<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>num <font color="#FF0000"><b>do BEGIN 
      </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">:=</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">; 
      </font><font color="#FF0000"><b>if </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">&gt;</font>num <font color="#FF0000"><b>then </b></font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">:=</font>stars<font color="#000080">[</font>loop1<font color="#000080">].</font>z<font color="#000080">-</font>num<font color="#000080">; 
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
</font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#008000"><i>{&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;&Auml;} 
</i></font><font color="#FF0000"><b>Procedure </b></font>Play<font color="#000080">; 
  </font><font color="#008000"><i>{ This is our main procedure } 
</i></font><font color="#FF0000"><b>VAR </b></font>ch<font color="#000080">:</font>char<font color="#000080">; 
</font><font color="#FF0000"><b>BEGIN 
  </b></font>Calcstars<font color="#000080">; 
  </font>Drawstars<font color="#000080">;  </font><font color="#008000"><i>{ This draws our stars for the first time } 
  </i></font>ch<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">; 
  </font>cls <font color="#000080">(</font>vaddr<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); 
  </font><font color="#FF0000"><b>Repeat 
    if </b></font>keypressed <font color="#FF0000"><b>then </b></font>ch<font color="#000080">:=</font>readkey<font color="#000080">;
    </font>clear<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>clear<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]; 
    </font>Calcstars<font color="#000080">;     </font><font color="#008000"><i>{ Calculate new star positions } 
    </i></font>waitretrace<font color="#000080">;
    </font>Clearstars<font color="#000080">;    </font><font color="#008000"><i>{ Erase old stars } 
    </i></font>Drawstars<font color="#000080">;     </font><font color="#008000"><i>{ Draw new stars } 
    </i></font>flip <font color="#000080">(</font>vaddr<font color="#000080">,</font>vga<font color="#000080">); 
    </font><font color="#FF0000"><b>if </b></font>ch<font color="#000080">=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>Movestars<font color="#000080">(</font>False<font color="#000080">) </font><font color="#FF0000"><b>else </b></font>Movestars<font color="#000080">(</font>True<font color="#000080">); 
      </font><font color="#008000"><i>{ Move stars towards or away from the viewer } 
  </i></font><font color="#FF0000"><b>Until </b></font>ch<font color="#000080">=</font><font color="#800000">#27</font><font color="#000080">; 
    </font><font color="#008000"><i>{ Until the escape key is pressed } 
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">; 
 
</font><font color="#FF0000"><b>BEGIN 
  </b></font>clrscr<font color="#000080">; 
  </font>writeln <font color="#000080">(</font><font color="#800000">'Hello! Another effect for you, this one is on starfields, again by'</font><font color="#000080">);
  </font>writeln <font color="#000080">(</font><font color="#800000">'request.  In this sample program, a starfield will be coming towards'</font><font color="#000080">);
  </font>writeln <font color="#000080">(</font><font color="#800000">'you. Hit the space bar to have it move away from you, any other key'</font><font color="#000080">);
  </font>writeln <font color="#000080">(</font><font color="#800000">'to have it come towards you again. Hit [ESC] to end.'</font><font color="#000080">);
  </font>writeln<font color="#000080">;
  </font>writeln <font color="#000080">(</font><font color="#800000">'The code is very easy to follow, and the documentation is as usual in the'</font><font color="#000080">);
  </font>writeln <font color="#000080">(</font><font color="#800000">'main text. Leave me mail with further ideas for future trainers.'</font><font color="#000080">);

  </font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">;
  </font>write <font color="#000080">(</font><font color="#800000">'Hit any key to continue ...'</font><font color="#000080">);
  </font>readkey<font color="#000080">;
  </font>randomize<font color="#000080">;
  </font>setmcga<font color="#000080">;
  </font>setupvirtual<font color="#000080">;
  </font>init<font color="#000080">;
  </font>Play<font color="#000080">;
  </font>settext<font color="#000080">;
  </font>shutdown<font color="#000080">;
  </font>Writeln <font color="#000080">(</font><font color="#800000">'All done. This concludes the thirteenth sample program in the ASPHYXIA'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Training series. You may reach DENTHOR under the names of GRANT'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'SMITH/DENTHOR/ASPHYXIA on the ASPHYXIA BBS. I am also an avid'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'Connectix BBS user, and occasionally read RSAProg. E-mail me at :'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'    denthor@beastie.cs.und.ac.za'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'The numbers are available in the main text. You may also write to me at:'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             Grant Smith'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             P.O. Box 270'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             Kloof'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             3640'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             Natal'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'             South Africa'</font><font color="#000080">);
  </font>Writeln <font color="#000080">(</font><font color="#800000">'I hope to hear from you soon!'</font><font color="#000080">);
  </font>Writeln<font color="#000080">; </font>Writeln<font color="#000080">;
  </font>Write   <font color="#000080">(</font><font color="#800000">'Hit any key to exit ...'</font><font color="#000080">);
  </font>readkey<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0189.PAS">Original</a><b>]</b></p></body>
</html>
