<html>
<head><title> "VGA ClrScr #1" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000"> <font color="#008000"><i>{
 Anivga is the best set of Graphics routines i've seen For the PC since
 i stopped using my old 4,7 Mhz MSX (which had smooth sprites &amp;
 scrolling) and the one With the most extra's.

Well, here is &gt;ONE&lt; solution For you.  It is one I have used in a
streetfighter Type game a friend and I have been working on (the friend
is an artist who has been doing the pics While I'm doing the software).
It turns out, using an index-to-index copy during vertical retrace is
fast enough to get at least (and I mean at LEAST--I've been able to over
Double this rate) 18.2 frames per second on a 16bit VGA card.

The code (in pascal, although the Program itself is written in C++, the
theory works With TP6.0) would look something like this:
}

</i></font><font color="#FF0000"><b>Type
  </b></font>ScreenRec <font color="#000080">= </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">63999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
  </font>ScreenPtr <font color="#000080">= ^</font>ScreenRec<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>VGAScreen <font color="#000080">: </font>ScreenRec <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">$0000</font><font color="#000080">; </font><font color="#008000"><i>{I think thats how you do
                                               it, been a While since I
                                               had to do things this way}

</i></font><font color="#FF0000"><b>Procedure </b></font>VS_PutPixel<font color="#000080">(</font>x<font color="#000080">, </font>y<font color="#000080">: </font>Integer<font color="#000080">; </font>c<font color="#000080">:</font>Byte<font color="#000080">; </font>VS<font color="#000080">: </font>ScreenPtr<font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>VS<font color="#000080">^[(</font>y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">)+</font>x<font color="#000080">] := </font>c<font color="#000080">; </font><font color="#008000"><i>{Again, this may be off slightly--my original
                        pascal Implementation used a member Variable in
                        an Object}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VS_Write<font color="#000080">(</font>VS<font color="#000080">: </font>ScreenPtr<font color="#000080">);

</font><font color="#FF0000"><b>Var
  </b></font>X <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Y <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{Wait For a retrace--see a VGA manual For how to do this, it takes
  monitoring two ports.  if you are already in a retrace, wait For it to
  end and another one to begin}
  </i></font><font color="#FF0000"><b>For </b></font>Y <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">199 </font><font color="#FF0000"><b>do
    For </b></font>X <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do
      </b></font>VGAScreen<font color="#000080">[(</font>Y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">)+</font>X<font color="#000080">] := </font>VS<font color="#000080">^[(</font>Y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">)+</font>X<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
With this method, you even have time in the nexted For loops (!) to do a
Comparison.  One I typically use (For emulating multiple planes) is if
VS^[(Y*320)+X] &lt;&gt; 0...  That lets me copy multiple screens.  to give you
an idea of how fast this is, on my 386/25, I can do this during a timer
interrupt (18.2 times a second) without any problems, and still have
time to do full collision detection and multisprite animation with
scrolling backgrounds and Soundblaster Sound.  During the retrace
period, you can move quite a bit of inFormation into the VGA card,
because memory accesses are MUCH faster (the screen is also not being
updated).  This is CompLETELY flicker free using this technique (if
smaller sections are chaging, you MIGHT consider only copying parts of
the screen).

}</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0045.PAS">Original</a><b>]</b></p></body>
</html>
