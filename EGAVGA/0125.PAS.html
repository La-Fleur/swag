<html>
<head><title> "Fading Textscreen" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0125.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 AK&gt; howdie, nice fader! i was wandering if you would be able
 AK&gt; to comment the   program and repost it. i.e what the ports
 AK&gt; are etc for us less experienced   programmers...

Okay, if you don't quote so much next time.

}

</i></font><font color="#FF0000"><b>program </b></font>copper<font color="#000080">;
</font><font color="#008000"><i>{ bar-fade in, copper v7.0, by Bas van Gaalen, Holland, PD }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const </b></font>size<font color="#000080">=</font><font color="#800000">20</font><font color="#000080">; </font><font color="#008000"><i>{ number of text-lines }
</i></font><font color="#FF0000"><b>var </b></font>pal<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">*</font>size<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;

</font><font color="#008000"><i>{ increase first value in the pal-array (the one representing red), and scroll
that in the array }
</i></font><font color="#FF0000"><b>procedure </b></font>incbars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>pal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]&lt;</font><font color="#800000">63 </font><font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>pal<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]);
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">*</font>size<font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font>pal<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]:=</font>pal<font color="#000080">[</font>i<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>copperbars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>cc<font color="#000080">,</font>l<font color="#000080">,</font>j<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">cli </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">; </font><font color="#008000"><i>{ vertical retrace }
  </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">8</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
  </font>cc<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>l<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>size<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
    </b></font>port<font color="#000080">[</font><font color="#800000">$3c8</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{ set pal-idx number (1=blue) }
    </i></font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>pal<font color="#000080">[</font>cc<font color="#000080">]; </font><font color="#008000"><i>{ set first two pal-value's (red and green }
    </i></font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>pal<font color="#000080">[</font>cc<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]; </font><font color="#008000"><i>{ intensities }
    </i></font><font color="#FF0000"><b>for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do begin </b></font><font color="#008000"><i>{ 16 vertical retraces = one text line }
      </i></font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>port<font color="#000080">[</font><font color="#800000">$3da</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>port<font color="#000080">[</font><font color="#800000">$3c9</font><font color="#000080">]:=</font>pal<font color="#000080">[</font>cc<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">]; </font><font color="#008000"><i>{ set last pal-value (blue), and thus activate
                             new palette }
    </i></font>inc<font color="#000080">(</font>cc<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm </b></font><font color="#FF00FF">sti </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>textmode<font color="#000080">(</font>co80<font color="#000080">); </font><font color="#008000"><i>{ 25 lines mode }
  </i></font>fillchar<font color="#000080">(</font>pal<font color="#000080">,</font>sizeof<font color="#000080">(</font>pal<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{ clear palette array }
  </i></font>copperbars<font color="#000080">; </font><font color="#008000"><i>{ default = black -&gt; otherwise flash of blue will appear }
  </i></font>textcolor<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{ set text to blue (now black, 'cos pal changed) }
  </i></font>writeln<font color="#000080">;
  </font>writeln<font color="#000080">(</font><font color="#800000">'Is this what you mean?'</font><font color="#000080">); </font>writeln<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">15 </font><font color="#FF0000"><b>do </b></font>writeln<font color="#000080">(</font><font color="#800000">'Test line '</font><font color="#000080">,</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>repeat
    </b></font>incbars<font color="#000080">;
    </font>copperbars<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">; </font><font color="#008000"><i>{ do stuff until keypressed... }
  </i></font>textmode<font color="#000080">(</font>lastmode<font color="#000080">); </font><font color="#008000"><i>{ back to last mode }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0125.PAS">Original</a><b>]</b></p></body>
</html>
