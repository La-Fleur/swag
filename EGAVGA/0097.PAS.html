<html>
<head><title> "Graphical Fades and Palet" by MIRKO HOLZER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0097.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
here are some routines, with which you can fade the screen in/out.
How to use:

  Fade out: Get the original palette with the GetPal(0,255,pal) command.
            (Of course you have to allocate 768 Bytes Memory for the pal
             pointer first).
            Then call FadePal(Pal,true,steps) and the screen will be
            faded out.

  Fade in: Just pass the target-pal. to the Fade-Routine:

             FadePal(Targetpal,false,steps).

Note: Low step-rates mean high fading speed. }


</i></font><font color="#FF0000"><b>Procedure </b></font>SetPal<font color="#000080">(</font>Start<font color="#000080">: </font>byte<font color="#000080">; </font>Anz<font color="#000080">: </font>word<font color="#000080">; </font>pal<font color="#000080">: </font>pointer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push ds
  cld
  lds si,pal
  mov dx,3c8h
  mov al,start
  out dx,al
  inc dx
  mov ax,anz
  mov cx,ax
  add cx,ax
  add cx,ax
  rep outsb
  pop ds
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>GetPal<font color="#000080">(</font>Start<font color="#000080">: </font>byte<font color="#000080">; </font>Anz<font color="#000080">: </font>word<font color="#000080">; </font>pal<font color="#000080">: </font>pointer<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">les di,pal
  mov al,start
  mov dx,3c7h
  out dx,al
  inc dx
  mov ax,anz
  mov cx,ax
  add cx,ax
  add cx,ax

  mov dx,3c9h
  cld
  rep insb
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>FadePal<font color="#000080">(</font>OrigPal <font color="#000080">: </font>pPal<font color="#000080">; </font>FadeOut <font color="#000080">: </font>Boolean<font color="#000080">; </font>steps<font color="#000080">: </font>byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>r<font color="#000080">,</font>g<font color="#000080">,</font>b   <font color="#000080">: </font>byte<font color="#000080">;
  </font>Fade    <font color="#000080">: </font>word<font color="#000080">;
  </font>Pct     <font color="#000080">: </font>real<font color="#000080">;
  </font>I       <font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  For </b></font>Fade <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Steps <font color="#FF0000"><b>do begin
    </b></font>Pct <font color="#000080">:= </font>Fade <font color="#000080">/ </font>Steps<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>FadeOut <font color="#FF0000"><b>then </b></font>Pct <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">- </font>Pct<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">255 </font><font color="#FF0000"><b>do begin
      </b></font>r <font color="#000080">:= </font>Round<font color="#000080">(</font>OrigPal<font color="#000080">[</font>I<font color="#000080">].</font>R <font color="#000080">* </font>Pct<font color="#000080">);
      </font>g <font color="#000080">:= </font>Round<font color="#000080">(</font>OrigPal<font color="#000080">[</font>I<font color="#000080">].</font>G <font color="#000080">* </font>Pct<font color="#000080">);
      </font>b <font color="#000080">:= </font>Round<font color="#000080">(</font>OrigPal<font color="#000080">[</font>I<font color="#000080">].</font>B <font color="#000080">* </font>Pct<font color="#000080">);
      </font><font color="#FF0000"><b>asm
        </b></font><font color="#FF00FF">mov dx,3c8h
        mov al,i
        out dx,al
        mov dx,3c9h
        mov al,r
        out dx,al
        mov al,g
        out dx,al
        mov al,b
        out dx,al
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0097.PAS">Original</a><b>]</b></p></body>
</html>
