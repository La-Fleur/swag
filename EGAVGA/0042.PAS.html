<html>
<head><title> "VGA Detect #2" by MICHAEL NICOLAI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; I know how to determine the current mode of a card, but how do a lot of
&gt; Programs determine if a VGA is present in the first place? I'd Really

MICHAEL NICOLAI
It's very easy to check if a VGA card is present, 'cause there are some
Functions which are only supported on VGAs. The best one is this:
}

</i></font><font color="#FF0000"><b>Uses
  </b></font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Is_VGA_present <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
 </b></font>regs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>Is_VGA_present <font color="#000080">:= </font>True<font color="#000080">;
 </font>regs<font color="#000080">.</font>ax <font color="#000080">:= </font><font color="#800000">$1A00</font><font color="#000080">;
 </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>regs<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>regs<font color="#000080">.</font>al <font color="#000080">&lt;&gt; </font><font color="#800000">$1A</font><font color="#000080">) </font><font color="#FF0000"><b>then
  </b></font>Is_VGA_present <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ KELD R. HANSEN }

</i></font><font color="#FF0000"><b>Function </b></font>VGA <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV     AH,1Ah
  INT     10h
  CMP     AL,1Ah
  MOV     AL,True
  JE      @OUT
  DEC     AX
 @OUT:
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ will return True if a VGA card is installed. }
</i></font><font color="#FF0000"><b>begin
  </b></font>Writeln<font color="#000080">(</font>Is_VGA_present<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>VGA<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0042.PAS">Original</a><b>]</b></p></body>
</html>
