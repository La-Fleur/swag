<html>
<head><title> "Another Set Graphics Mode" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{RV&sup3;ok i would like some info on how to remove a tsr added to memory by a
  &sup3;i'd like some info on ext. VGA screens. For examplw i know that in
  &sup3;320x200x256 that one Byte is equal to one pixel. i need this Type of
  &sup3;info For =&lt; 640x480

Mode $10 (ie 640x350x16)
-------------------------

In this mode, the  256K display memory is divided into 4 bit planes of
64K each. Each pixel is produced by 4 bits, one from each bit plane, which
are combined into a 4-bit value that determines which of the 16 colors will
appear on the screen For that pixel.

There is a one-to-one correspondense between the bits in each bit plane and
the pixel on the screen. For example, bit 7 of the first Byte in each bit
plane correspond to the pixel in the upper left-hand corner of the screen.

The display memory For the 640x350 Graphics mode is mapped into memory as
a 64K block starting at A000h, With each 64K bit plane occupying the same
address space (ie: in parallel).

Because of the one-to-one relationship of bits in bit planes With the pixels
on the screen, it's straightForward to calculate the address needed to
access a particular pixel. There are 640 bits = 80 Bytes per line on the
screen. Thus the Byte address corresponding to a particular X,Y coordinate
is given by 80*Y + X/8. A desired pixel can then be picked out of the Byte
using the bit mask register.
}

</i></font><font color="#FF0000"><b>Procedure </b></font>PutPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>Color<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Byte_address <font color="#000080">: </font>Word<font color="#000080">;
  </font>wanted_pixel        <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Port<font color="#000080">[</font><font color="#800000">$3CE</font><font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;        </font><font color="#008000"><i>(* mode register *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;        </font><font color="#008000"><i>(* select Write mode 2 *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$3CE</font><font color="#000080">] := </font><font color="#800000">8</font><font color="#000080">;        </font><font color="#008000"><i>(* bit mask register *)
                          (* calculate pixel's Byte address *)
  </i></font>Byte_address <font color="#000080">:= (</font><font color="#800000">80 </font><font color="#000080">* </font>Y<font color="#000080">) + (</font>X <font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">);
                          </font><font color="#008000"><i>(* set the bit we want *)
  </i></font>wanted_pixel <font color="#000080">:= (</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#000080">(</font><font color="#800000">7 </font><font color="#000080">- (</font>X <font color="#FF0000"><b>MOD </b></font><font color="#800000">8</font><font color="#000080">)));
                          </font><font color="#008000"><i>(* mask pixel we want *)
  </i></font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">] := </font><font color="#800000">$FF </font><font color="#FF0000"><b>and </b></font>wanted_pixel<font color="#000080">;
                          </font><font color="#008000"><i>(* turn the pixel we want on *)
  </i></font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Byte_address<font color="#000080">] := </font>Mem<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>Byte_address<font color="#000080">] </font><font color="#FF0000"><b>or </b></font>Color
<font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>(* PutPixel *)

</i></font><font color="#FF0000"><b>Function </b></font>ActiveMode <font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#008000"><i>(* Returns the current display mode *)
</i></font><font color="#FF0000"><b>Var
  </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;     </font><font color="#008000"><i>(* Registers from Dos Unit *)
</i></font><font color="#FF0000"><b>begin
  </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0F</font><font color="#000080">;       </font><font color="#008000"><i>(* get current video mode service *)
  </i></font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);       </font><font color="#008000"><i>(* call bios *)
  </i></font>ActiveMode <font color="#000080">:= </font>Reg<font color="#000080">.</font>AL  <font color="#008000"><i>(* current display mode returns in AL *)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Some video numbers:

  CGA04         = $04;        (* CGA 320x200x4 *)
  CGA06         = $06;        (* CGA 640x200x2 *)

  EGA0D         = $0D;        (* 320x200x16,EGA,2 pages (64K), A0000*)
  EGA0E         = $0E;        (* 640x200x16,EGA,4 pages(64K)      &quot; *)
  EGA0F         = $0F;        (* 640x350 B&amp;W,EGA,2 &quot;     &quot;        &quot;  *)
  EGA10         = $10;        (* 640x350x16 EGA,2 &quot;    (128K)     &quot; *)

  VGA11         = $11;        (* 640x480x2 B&amp;W VGA, 4 pages (256K) &quot; *)
  VGA12         = $12;        (* 640x480x16  VGA   1 page  (256K) &quot; *)
  VGA13         = $13;        (* 320x200x256 VGA   4 pages (256K) &quot; *)

Example:

  ...
  if (ActiveMode = VGA13) then
    begin
      ....
      ShowPCX256
      ....
    end
  ...
}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0026.PAS">Original</a><b>]</b></p></body>
</html>
