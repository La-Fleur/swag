<html>
<head><title> "Video Addresses" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>CONST
  </b></font><font color="#008000"><i>{ Constants for bit plane, video page, and memory block sizes: }
  </i></font>MonoBase      <font color="#000080">= </font><font color="#800000">$B000</font><font color="#000080">;     </font><font color="#008000"><i>{ Segment offset of MDA/Herc video buffer  }
  </i></font>CGABase       <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">;     </font><font color="#008000"><i>{ Segment offset of CGA video buffer       }
  </i></font>EGAVGABase    <font color="#000080">= </font><font color="#800000">$A000</font><font color="#000080">;     </font><font color="#008000"><i>{ Segment offset of EGA/VGA video buffer   }

  { Size of one video page buffer in modes 0..3: }
  </i></font>TxtVidPageSize   <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word <font color="#000080">= (</font><font color="#800000">$800</font><font color="#000080">,</font><font color="#800000">$800</font><font color="#000080">,</font><font color="#800000">$1000</font><font color="#000080">,</font><font color="#800000">$1000</font><font color="#000080">);
  </font><font color="#008000"><i>{ Actual number of bytes used in these buffers }
  </i></font>TxtVidPageFilled <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word <font color="#000080">= (</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">,</font><font color="#800000">4000</font><font color="#000080">);

  </font>CGAMemBankSize    <font color="#000080">= </font><font color="#800000">$2000</font><font color="#000080">; </font><font color="#008000"><i>{ Size of one CGA memory bank in modes 4, 5 and 6}
  </i></font>CGAMemBankFilled  <font color="#000080">= </font><font color="#800000">8000</font><font color="#000080">;  </font><font color="#008000"><i>{ Actual number of bytes used in that bank       }
  </i></font>HercMemBankSize   <font color="#000080">= </font><font color="#800000">$2000</font><font color="#000080">; </font><font color="#008000"><i>{ Size of one Hercules memory bank               }
  </i></font>HercMemBankFilled <font color="#000080">= </font><font color="#800000">7830</font><font color="#000080">;  </font><font color="#008000"><i>{ Actual number of bytes used in that bank       }
  </i></font>VGA256MemBankSize <font color="#000080">= </font><font color="#800000">64000</font><font color="#000080">;

  </font>MDAPageSize   <font color="#000080">= </font><font color="#800000">4000</font><font color="#000080">;      </font><font color="#008000"><i>{ Size of MDA text buffer }
  </i></font>V400PageSize  <font color="#000080">= </font><font color="#800000">32000</font><font color="#000080">;     </font><font color="#008000"><i>{ Size video page in V400VM mode }


</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetVidMode<font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>Regs <font color="#000080">: </font>Registers<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>Regs<font color="#000080">.</font>AH <font color="#000080">:= </font><font color="#800000">$0F</font><font color="#000080">;
    </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
    </font>GetVidMode <font color="#000080">:= </font>Regs<font color="#000080">.</font>AL<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ GetVidMode }


</i></font><font color="#FF0000"><b>FUNCTION </b></font>VidAddress<font color="#000080">: </font>Pointer<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>VM<font color="#000080">: </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>VM <font color="#000080">:= </font>GetVidMode<font color="#000080">;
    </font><font color="#FF0000"><b>CASE </b></font>VM <font color="#FF0000"><b>OF
      </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3   </font><font color="#000080">: </font>VidAddress <font color="#000080">:= </font>Ptr<font color="#000080">(</font>CGABase<font color="#000080">,</font>GetVisualPage <font color="#000080">* </font>TxtVidPageSize<font color="#000080">[</font>VM<font color="#000080">]);
      </font><font color="#800000">4</font><font color="#000080">..</font><font color="#800000">6   </font><font color="#000080">: </font>VidAddress <font color="#000080">:= </font>Ptr<font color="#000080">(</font>CGABase<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#800000">7      </font><font color="#000080">: </font>VidAddress <font color="#000080">:= </font>Ptr<font color="#000080">(</font>MonoBase<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{ Also HercVM }
      </i></font><font color="#800000">13</font><font color="#000080">..</font><font color="#800000">19 </font><font color="#000080">: </font>VidAddress <font color="#000080">:= </font>Ptr<font color="#000080">(</font>EGAVGABase<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
      </font>V400VM <font color="#000080">: </font>VidAddress <font color="#000080">:= </font>Ptr<font color="#000080">(</font>EGAVGABase<font color="#000080">,</font>GetVisualPage <font color="#000080">* </font>V400PageSize<font color="#000080">);
      </font><font color="#FF0000"><b>ELSE     </b></font>DumBool <font color="#000080">:= </font>CheckError<font color="#000080">(</font>TRUE<font color="#000080">,</font><font color="#800000">'VIDADDRESS'</font><font color="#000080">,</font><font color="#800000">68</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{ VidAddress }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0099.PAS">Original</a><b>]</b></p></body>
</html>
