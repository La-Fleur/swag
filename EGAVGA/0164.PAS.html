<html>
<head><title> "enhanced cross-fade" by BAS VAN GAALEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
David Proper posted a cross-fade routine here, some days ago. This is an update
on that one. It now fades all texts. Quite a pain to figure this out, realy.
Put it in the SWAG if you want, Gayle/Kerry/Jeff.
&gt;--- cut here }

</i></font><font color="#FF0000"><b>program </b></font>xfade<font color="#000080">;
</font><font color="#008000"><i>{ made by Bas van Gaalen, Holland, PD,
  fido 2:285/213.8, internet bas.van.gaalen@schotman.nl }
</i></font><font color="#FF0000"><b>uses </b></font>crt<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>vseg<font color="#000080">=</font><font color="#800000">$a000</font><font color="#000080">; </font>fseg<font color="#000080">=</font><font color="#800000">$f000</font><font color="#000080">; </font>fofs<font color="#000080">=</font><font color="#800000">$fa6e</font><font color="#000080">; </font>lines<font color="#000080">=</font><font color="#800000">13</font><font color="#000080">;
  </font>creds<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>lines<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">]=(
    </font><font color="#008000"><i>{.........|.........|}
    </i></font><font color="#800000">'This cross-fade'</font><font color="#000080">,
    </font><font color="#800000">'routine was made by'</font><font color="#000080">,
    </font><font color="#800000">'Bas van Gaalen'</font><font color="#000080">,
    </font><font color="#800000">'Code and idea'</font><font color="#000080">,
    </font><font color="#800000">'inspired by'</font><font color="#000080">,
    </font><font color="#800000">'David Proper'</font><font color="#000080">,
    </font><font color="#800000">'This routine was'</font><font color="#000080">,
    </font><font color="#800000">'enhanced a bit'</font><font color="#000080">,
    </font><font color="#800000">'in comparison with'</font><font color="#000080">,
    </font><font color="#800000">'David''s one...'</font><font color="#000080">,
    </font><font color="#800000">'cu later'</font><font color="#000080">,
    </font><font color="#800000">'alligator!'</font><font color="#000080">,
    </font><font color="#800000">''</font><font color="#000080">);

</font><font color="#FF0000"><b>procedure </b></font>setpal<font color="#000080">(</font>c<font color="#000080">,</font>r<font color="#000080">,</font>g<font color="#000080">,</font>b<font color="#000080">:</font>byte<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3c8h; mov al,[c]; out dx,al; inc dx; mov al,[r]
  out dx,al; mov al,[g]; out dx,al; mov al,[b]; out dx,al; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>retrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah; @vert1: in al,dx; test al,8; jz @vert1
  @vert2: in al,dx; test al,8; jnz @vert2; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>cleartxt<font color="#000080">(</font>col<font color="#000080">,</font>new<font color="#000080">:</font>byte<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>vofs<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>x<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">319 </font><font color="#FF0000"><b>do for </b></font>y<font color="#000080">:=</font><font color="#800000">100 </font><font color="#FF0000"><b>to </b></font><font color="#800000">107 </font><font color="#FF0000"><b>do begin
    </b></font>vofs<font color="#000080">:=</font>y<font color="#000080">*</font><font color="#800000">320</font><font color="#000080">+</font>x<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]=</font>col <font color="#FF0000"><b>then </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]:=</font><font color="#800000">0
    </font><font color="#FF0000"><b>else if </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]:=</font>new<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>writetxt<font color="#000080">(</font>col<font color="#000080">,</font>cur<font color="#000080">:</font>byte<font color="#000080">; </font>txt<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>y<font color="#000080">,</font>vofs<font color="#000080">:</font>word<font color="#000080">; </font>i<font color="#000080">,</font>j<font color="#000080">,</font>k<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>x<font color="#000080">:=(</font><font color="#800000">320</font><font color="#000080">-</font><font color="#800000">8</font><font color="#000080">*</font>length<font color="#000080">(</font>txt<font color="#000080">)) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">; </font>y<font color="#000080">:=</font><font color="#800000">100</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>txt<font color="#000080">) </font><font color="#FF0000"><b>do for </b></font>j<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do for </b></font>k<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">7 </font><font color="#FF0000"><b>do
    if </b></font><font color="#000080">((</font>mem<font color="#000080">[</font>fseg<font color="#000080">:</font>fofs<font color="#000080">+</font>ord<font color="#000080">(</font>txt<font color="#000080">[</font>i<font color="#000080">])*</font><font color="#800000">8</font><font color="#000080">+</font>j<font color="#000080">] </font><font color="#FF0000"><b>shl </b></font>k<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">128</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>vofs<font color="#000080">:=(</font>y<font color="#000080">+</font>j<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+(</font>i<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">)+</font>x<font color="#000080">+</font>k<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]=</font>cur <font color="#FF0000"><b>then </b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]:=</font>col<font color="#000080">+</font>cur <font color="#FF0000"><b>else
</b></font>mem<font color="#000080">[</font>vseg<font color="#000080">:</font>vofs<font color="#000080">]:=</font>col<font color="#000080">;    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>txtidx<font color="#000080">,</font>curcol<font color="#000080">,</font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm </b></font><font color="#FF00FF">mov ax,13h; int 10h; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>setpal<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font>setpal<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">63 </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">63 </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
  </font>curcol<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">; </font>txtidx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>repeat
    </b></font>cleartxt<font color="#000080">(</font>curcol<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">-</font>curcol<font color="#000080">);
    </font>writetxt<font color="#000080">(</font>curcol<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">-</font>curcol<font color="#000080">,</font>creds<font color="#000080">[</font>txtidx<font color="#000080">]);
    </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63 </font><font color="#FF0000"><b>do begin
      </b></font>retrace<font color="#000080">;
      </font>setpal<font color="#000080">(</font>curcol<font color="#000080">,</font>i <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font>i<font color="#000080">,</font>i <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
      </font>setpal<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">-</font>curcol<font color="#000080">,(</font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">,(</font><font color="#800000">63</font><font color="#000080">-</font>i<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>delay<font color="#000080">(</font><font color="#800000">500</font><font color="#000080">);
    </font>curcol<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">+(</font>curcol <font color="#FF0000"><b>mod </b></font><font color="#800000">2</font><font color="#000080">);
    </font>txtidx<font color="#000080">:=(</font><font color="#800000">1</font><font color="#000080">+</font>txtidx<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font>lines<font color="#000080">;
  </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;
  </font>textmode<font color="#000080">(</font>lastmode<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p></body>
</html>
