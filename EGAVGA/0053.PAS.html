<html>
<head><title> "Detect Presents of VGA" by SEAN PALMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0053.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">===========================================================================
 </font>BBS<font color="#000080">: </font>Canada Remote Systems
Date<font color="#000080">: </font><font color="#800000">06</font><font color="#000080">-</font><font color="#800000">30</font><font color="#000080">-</font><font color="#800000">93 </font><font color="#000080">(</font><font color="#800000">16</font><font color="#000080">:</font><font color="#800000">12</font><font color="#000080">)             </font>Number<font color="#000080">: </font><font color="#800000">28771
</font>From<font color="#000080">: </font>SEAN PALMER                  Refer<font color="#800000">#</font><font color="#000080">: </font>NONE
  <font color="#FF0000"><b>To</b></font><font color="#000080">: </font>JOHN DAILEY                   Recvd<font color="#000080">: </font>NO
Subj<font color="#000080">: </font>VGA INFO                       Conf<font color="#000080">: (</font><font color="#800000">1221</font><font color="#000080">) </font>F<font color="#000080">-</font><font color="#FF0000"><b>PASCAL
</b></font><font color="#000080">---------------------------------------------------------------------------
</font>JD<font color="#000080">&gt;</font>I<font color="#800000">'m looking for a quick-and-dirty way of checking to see if
</font>JD<font color="#000080">&gt;</font>a user has VGA capability <font color="#FF0000"><b>in </b></font>text mode<font color="#000080">.  </font>ie<font color="#000080">. </font><font color="#800000">50 </font>line mode<font color="#000080">.
</font>JD<font color="#000080">&gt; </font>Any help <font color="#FF0000"><b>is </b></font>appreciated<font color="#000080">.

</font><font color="#FF0000"><b>function </b></font>vgaPresent<font color="#000080">:</font>boolean<font color="#000080">;</font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;</font><font color="#FF0000"><b>asm
 </b></font><font color="#FF00FF">mov ah,$F; int $10; mov oldMode,al;  </font><font color="#008000"><i>{save old Gr mode}
 </i></font><font color="#FF00FF">mov ax,$1A00; int $10;    </font><font color="#008000"><i>{check for VGA/MCGA}
 </i></font><font color="#FF00FF">cmp al,$1A; jne @ERR;     </font><font color="#008000"><i>{no VGA Bios}
 </i></font><font color="#FF00FF">cmp bl,7; jb @ERR;        </font><font color="#008000"><i>{is VGA or better?}
 </i></font><font color="#FF00FF">cmp bl,$FF; jnz @OK;
@ERR: xor al,al; jmp @EXIT;
@OK: mov al,1;
@EXIT:
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>otherwise you can check the BIOS save data area <font color="#FF0000"><b>for </b></font>number <font color="#FF0000"><b>of </b></font>rows <font color="#FF0000"><b>on
</b></font>screen<font color="#000080">... </font>the EGA <font color="#FF0000"><b>and </b></font>VGA keep this updated<font color="#000080">, </font>older adapters don<font color="#800000">'t (they
</font><font color="#FF0000"><b>set </b></font>it <font color="#FF0000"><b>to </b></font><font color="#800000">0</font><font color="#000080">)

</font>you can just leave the screen <font color="#FF0000"><b>in </b></font>the mode it was <font color="#FF0000"><b>in </b></font>already this way<font color="#000080">.

</font><font color="#FF0000"><b>var
 </b></font>lastRow<font color="#000080">:</font>byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$84</font><font color="#000080">;    </font><font color="#008000"><i>{newer bios only:rows on screen-1}

 </i></font><font color="#000080">* </font>OLX <font color="#800000">2.2 </font><font color="#000080">* </font>Programming <font color="#FF0000"><b>is </b></font>like sex<font color="#000080">:  </font>one mistake <font color="#FF0000"><b>and </b></font>you support it

<font color="#000080">--- </font>Maximus <font color="#800000">2.01</font>wb
 <font color="#000080">* </font>Origin<font color="#000080">: &gt;&gt;&gt; </font>Sun Mountain BBS <font color="#000080">&lt;&lt;&lt; (</font><font color="#800000">303</font><font color="#000080">)-</font><font color="#800000">665</font><font color="#000080">-</font><font color="#800000">6922 </font><font color="#000080">(</font><font color="#800000">1</font><font color="#000080">:</font><font color="#800000">104</font><font color="#000080">/</font><font color="#800000">123</font><font color="#000080">)
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0053.PAS">Original</a><b>]</b></p></body>
</html>
