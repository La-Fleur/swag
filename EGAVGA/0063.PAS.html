<html>
<head><title> "VGA Lines" by ANDREW WOOLFSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0063.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
ANDREW WOOLFSON

I recall certain people discussing ways of drawing LINES in Pascal.
Unfortunately I'v lost the thread of those messages - BUT thought I could
add my endevours to this same task.
I hope this helps someone.

}
</i></font><font color="#FF0000"><b>Program </b></font>VGA_Line_Demo<font color="#000080">;
</font><font color="#008000"><i>(***************************************************************************)
(* Designed, thought out and programmed by Andrew Woolfson {using TP v6.0} *)
(*                                                                         *)
(* Because you have lost all those handy Borland Graphic Functions, I have *)
(* had to redesign the second elementary function in graphics : THE LINE   *)
(* This proved very difficult, and so far this program is a example of the *)
(* best I have managed to do (using vector mathematics).                   *)
(*                                                                         *)
(* This program also shows VGA direct screen addressing in 320x200x256     *)
(* mode.                                                                   *)
(*                                                                         *)
(* I have not documented this program, as I feel it it fairly explanatory. *)
(* If you Do not understand any routine, dont hesitate to ask.             *)
(*            Please share your experiments as I have.                     *)
(***************************************************************************)

</i></font><font color="#FF0000"><b>Uses
  </b></font>Crt<font color="#000080">, </font>Graph<font color="#000080">, </font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>Loop <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Key        <font color="#000080">: </font>Char<font color="#000080">;
  </font>Pixels     <font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">199</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">319</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>BYTE <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$A000</font><font color="#000080">:</font><font color="#800000">0000</font><font color="#000080">;
                       </font><font color="#008000"><i>{ NOTE: Y &amp; X Coord's have been swapped }

</i></font><font color="#FF0000"><b>Procedure </b></font>InitializeVGA<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>GraphDriver  <font color="#000080">: </font>Integer<font color="#000080">;
  </font>GraphMode    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>PathtoDriver <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];
  </font>Regs         <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>GraphDriver <font color="#000080">:= </font>VGA<font color="#000080">;
  </font>GraphMode   <font color="#000080">:= </font>VGAHi<font color="#000080">;
  </font>InitGraph<font color="#000080">(</font>GraphDriver<font color="#000080">, </font>GraphMode<font color="#000080">, </font><font color="#800000">'e:\bp\bgi'</font><font color="#000080">);

  </font>Regs<font color="#000080">.</font>AX <font color="#000080">:= </font><font color="#800000">19</font><font color="#000080">;
  </font>intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);     </font><font color="#008000"><i>{ Interrupt 16 }
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Plot<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Color <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Pixels<font color="#000080">[</font>Y<font color="#000080">,</font>X<font color="#000080">] := </font>Color<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Line<font color="#000080">(</font>x1<font color="#000080">, </font>y1<font color="#000080">, </font>x2<font color="#000080">, </font>y2<font color="#000080">, </font>Color <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Loop<font color="#000080">,
  </font>tx<font color="#000080">, </font>ty   <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Gradiant <font color="#000080">: </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font><font color="#000080">((</font>x1 <font color="#000080">&lt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&lt; </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>OR
     </b></font><font color="#000080">((</font>x1 <font color="#000080">= </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&lt; </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>OR
     </b></font><font color="#000080">((</font>x1 <font color="#000080">&lt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">= </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>Then
  Begin
    If </b></font><font color="#000080">(</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) &lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>x1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>x1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>Loop<font color="#000080">, (</font>y1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>Loop <font color="#000080">- </font>x1<font color="#000080">) * </font>Gradiant<font color="#000080">)), </font>Color<font color="#000080">);
    </font><font color="#FF0000"><b>End
    else
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>y1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>y1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">((</font>x1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>Loop <font color="#000080">- </font>y1<font color="#000080">) * </font>Gradiant<font color="#000080">)), </font>Loop<font color="#000080">, </font>Color<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>x1 <font color="#000080">&gt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&lt; </font>y2<font color="#000080">) </font><font color="#FF0000"><b>Then
  Begin
    If </b></font><font color="#000080">(</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) &lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>x2 <font color="#FF0000"><b>To </b></font>x1 <font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>Loop<font color="#000080">, (</font>y1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>x1 <font color="#000080">- </font>Loop<font color="#000080">) * </font>Gradiant<font color="#000080">)), </font>Color<font color="#000080">);
    </font><font color="#FF0000"><b>End
    else
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>y1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>y1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">((</font>x1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>y1 <font color="#000080">- </font>Loop<font color="#000080">) * </font>Gradiant<font color="#000080">)), </font>Loop<font color="#000080">, </font>Color<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>x1 <font color="#000080">&lt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&gt; </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>Then
  Begin
    If </b></font><font color="#000080">(</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) &lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>x1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>x1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>Loop<font color="#000080">, </font>y1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>x1 <font color="#000080">- </font>Loop<font color="#000080">) * </font>Gradiant<font color="#000080">), </font>color<font color="#000080">);
    </font><font color="#FF0000"><b>End
    else
    Begin
      </b></font>ty <font color="#000080">:= </font>y1<font color="#000080">;
      </font>y1 <font color="#000080">:= </font>y2<font color="#000080">;
      </font>y2 <font color="#000080">:= </font>ty<font color="#000080">;
      </font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>y1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>y1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>x2 <font color="#000080">+ </font>trunc<font color="#000080">((</font>y1 <font color="#000080">- </font>Loop<font color="#000080">) * </font>Gradiant<font color="#000080">), </font>Loop<font color="#000080">, </font>color<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>x1 <font color="#000080">&gt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&gt; </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>OR
     </b></font><font color="#000080">((</font>x1 <font color="#000080">= </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">&gt; </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>OR
     </b></font><font color="#000080">((</font>x1 <font color="#000080">&gt; </font>x2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>y1 <font color="#000080">= </font>y2<font color="#000080">)) </font><font color="#FF0000"><b>Then
  Begin
    </b></font>tx <font color="#000080">:= </font>x1<font color="#000080">;
    </font>ty <font color="#000080">:= </font>y1<font color="#000080">;
    </font>x1 <font color="#000080">:= </font>x2<font color="#000080">;
    </font>y1 <font color="#000080">:= </font>y2<font color="#000080">;
    </font>x2 <font color="#000080">:= </font>tx<font color="#000080">;
    </font>y2 <font color="#000080">:= </font>ty<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) &lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>x1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>x1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>Loop<font color="#000080">, </font>y1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>Loop <font color="#000080">- </font>x1<font color="#000080">) * </font>Gradiant<font color="#000080">), </font>color<font color="#000080">);
    </font><font color="#FF0000"><b>End
    else
    Begin
      </b></font>Gradiant <font color="#000080">:= (</font>ABS<font color="#000080">(</font>x2 <font color="#000080">- </font>x1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">) / (</font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>For </b></font>Loop <font color="#000080">:= </font>y1 <font color="#FF0000"><b>To </b></font><font color="#000080">(</font>y1 <font color="#000080">+ </font>ABS<font color="#000080">(</font>y2 <font color="#000080">- </font>y1<font color="#000080">)) </font><font color="#FF0000"><b>Do
        </b></font>Plot<font color="#000080">(</font>x1 <font color="#000080">+ </font>trunc<font color="#000080">((</font>Loop <font color="#000080">- </font>y1<font color="#000080">) * </font>Gradiant<font color="#000080">), </font>Loop<font color="#000080">, </font>color<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>InitializeVGA<font color="#000080">;

  </font>SetRGBPalette<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);   </font><font color="#008000"><i>{ RED    }
  </i></font>SetRGBPalette<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);   </font><font color="#008000"><i>{ GREEN  }
  </i></font>SetRGBPalette<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">);   </font><font color="#008000"><i>{ BLUE   }
  </i></font>SetRGBPalette<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">,</font><font color="#800000">63</font><font color="#000080">);   </font><font color="#008000"><i>{ WHITE  }

  </i></font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">50 </font><font color="#FF0000"><b>To </b></font><font color="#800000">250 </font><font color="#FF0000"><b>Do
    </b></font>Line<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">, </font>x<font color="#000080">, </font><font color="#800000">50</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>y <font color="#000080">:= </font><font color="#800000">50 </font><font color="#FF0000"><b>To </b></font><font color="#800000">150 </font><font color="#FF0000"><b>Do
    </b></font>Line<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">250</font><font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>x <font color="#000080">:= </font><font color="#800000">250 </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">50 </font><font color="#FF0000"><b>Do
    </b></font>Line<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">, </font>x<font color="#000080">, </font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>y <font color="#000080">:= </font><font color="#800000">150 </font><font color="#FF0000"><b>Downto </b></font><font color="#800000">50 </font><font color="#FF0000"><b>Do
    </b></font>Line<font color="#000080">(</font><font color="#800000">150</font><font color="#000080">, </font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">50</font><font color="#000080">, </font>y<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);

  </font>Readln<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0063.PAS">Original</a><b>]</b></p></body>
</html>
