<html>
<head><title> "Detect" by ROBERT PALMQVIST</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0209.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
From: Robert Palmqvist &lt;rpt@c3consult.comm.se&gt;

&gt; need to know how to display a high intensity background character set in
&gt; text mode.  I remeber seeing something somewhere about sacrificing the
&gt; blink attribute to get it, but I cant for the life of me remember how.

This is one way of doing it ... Hope that it will help you out
}
</i></font><font color="#FF0000"><b>Uses </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GotCGA<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Monitor<font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0010</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GotCGA<font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Monitor <font color="#FF0000"><b>and </b></font><font color="#800000">48 </font><font color="#000080">= </font><font color="#800000">48 </font><font color="#FF0000"><b>then
    </b></font>GotCGA<font color="#000080">:= </font>false
  <font color="#FF0000"><b>else
    if </b></font>Monitor <font color="#FF0000"><b>and </b></font><font color="#800000">32 </font><font color="#000080">= </font><font color="#800000">32 </font><font color="#FF0000"><b>then
      </b></font>GotCGA<font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GotEGA<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Regs<font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Regs <font color="#FF0000"><b>do
    begin
      </b></font>AX<font color="#000080">:= </font><font color="#800000">$1200</font><font color="#000080">;
      </font>BX<font color="#000080">:= </font><font color="#800000">$0010</font><font color="#000080">;
      </font>CX<font color="#000080">:= </font><font color="#800000">$FFFF</font><font color="#000080">;
      </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">, </font>Regs<font color="#000080">);
      </font>GotEGA<font color="#000080">:= (</font>CX <font color="#000080">&lt;&gt; </font><font color="#800000">$FFFF</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GotVGA<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Regs<font color="#000080">: </font>registers<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Regs <font color="#FF0000"><b>do
    begin
      </b></font>AX<font color="#000080">:= </font><font color="#800000">$1A00</font><font color="#000080">;
      </font>Intr<font color="#000080">(</font><font color="#800000">$10</font><font color="#000080">,</font>Regs<font color="#000080">);
      </font>GotVGA<font color="#000080">:= (</font>AL <font color="#000080">= </font><font color="#800000">$1A</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>SetBlink<font color="#000080">(</font><font color="#FF0000"><b>On </b></font><font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#008000"><i>{Enable text mode attribute blinking if On is True}
</i></font><font color="#FF0000"><b>const
  </b></font>PortVal<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">= (</font><font color="#800000">$0C</font><font color="#000080">, </font><font color="#800000">$08</font><font color="#000080">, </font><font color="#800000">$0D</font><font color="#000080">, </font><font color="#800000">$09</font><font color="#000080">, </font><font color="#800000">$09</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>PortNum<font color="#000080">: </font>word<font color="#000080">;
  </font>Index<font color="#000080">, </font>PVal<font color="#000080">: </font>byte<font color="#000080">;
  </font>Mode<font color="#000080">: </font>byte <font color="#FF0000"><b>absolute </b></font><font color="#800000">$0000</font><font color="#000080">:</font><font color="#800000">$0449</font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GotEGA <font color="#FF0000"><b>then
    begin
      inline</b></font><font color="#000080">(
        </font><font color="#800000">$8A</font><font color="#000080">/</font><font color="#800000">$5E</font><font color="#000080">/&lt;</font><font color="#FF0000"><b>On</b></font><font color="#000080">/    </font><font color="#008000"><i>{mov bl,[bp+&lt;On]}
        </i></font><font color="#800000">$B8</font><font color="#000080">/</font><font color="#800000">$03</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">/    </font><font color="#008000"><i>{mov ax,$1003}
        </i></font><font color="#800000">$CD</font><font color="#000080">/</font><font color="#800000">$10</font><font color="#000080">);       </font><font color="#008000"><i>{int $10}
      </i></font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    if </b></font>GotCGA <font color="#FF0000"><b>then
      begin
        </b></font>PortNum<font color="#000080">:= </font><font color="#800000">$3D8</font><font color="#000080">;
        </font><font color="#FF0000"><b>case </b></font>Mode <font color="#FF0000"><b>of
          </b></font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">: </font>Index <font color="#000080">:= </font>Mode<font color="#000080">;
        </font><font color="#FF0000"><b>else
          </b></font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end
    else
      begin
        </b></font>PortNum<font color="#000080">:= </font><font color="#800000">$3B8</font><font color="#000080">;
        </font>Index<font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>PVal<font color="#000080">:= </font>PortVal<font color="#000080">[</font>Index<font color="#000080">];
  </font><font color="#FF0000"><b>if On then
    </b></font>PVal<font color="#000080">:= </font>PVal <font color="#FF0000"><b>or </b></font><font color="#800000">$20</font><font color="#000080">;
  </font>Port<font color="#000080">[</font>PortNum<font color="#000080">]:= </font>PVal<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BlinkOff<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetBlink<font color="#000080">(</font>false<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>BlinkOn<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetBlink<font color="#000080">(</font>true<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0209.PAS">Original</a><b>]</b></p></body>
</html>
