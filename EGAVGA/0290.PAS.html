<html>
<head><title> "Complete MCGA Unit" by STEFAN OHRHALLINGER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0290.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{$A+,G+,R-,S-}
</i></font><font color="#FF0000"><b>UNIT </b></font>MCGA<font color="#000080">;   </font><font color="#008000"><i>{ Copyright by Stefan Ohrhallinger in 1991,92,93,94 }
             { aka &macr;The Faker&reg; of AARDVARK }
</i></font><font color="#FF0000"><b>INTERFACE
CONST
     </b></font>Up<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
     </font>Right<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">;
     </font>Down<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">;
     </font>Left<font color="#000080">=</font><font color="#800000">3</font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>GetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">):</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineH<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineV<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLine<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetColor<font color="#000080">(</font>Nr<font color="#000080">,</font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetColor<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>PaintChar<font color="#000080">(</font>Ch<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>GrWrite<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">; </font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadFont<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetText<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font>MultX<font color="#000080">,</font>DivX<font color="#000080">,</font>MultY<font color="#000080">,</font>DivY<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawPolygon<font color="#000080">(</font>Count<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Fill<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);  </font><font color="#008000"><i>{ Nur die selbe Farbe ersetzen }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Flood<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">,</font>C2<font color="#000080">:</font>Byte<font color="#000080">);  </font><font color="#008000"><i>{ Anf„rben bis zur Randfarbe C2 }
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>MCGAOn<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>MCGAOff<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillPolygon<font color="#000080">(</font>Size<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P1<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Ellipse<font color="#000080">(</font>MX<font color="#000080">,</font>MY<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillEllipse<font color="#000080">(</font>MX<font color="#000080">,</font>MY<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Circle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>RotateArray<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">; </font>Count<font color="#000080">,</font>MX<font color="#000080">,</font>MY<font color="#000080">:</font>Integer<font color="#000080">; </font>Winkel<font color="#000080">:</font>Real<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>N4eck<font color="#000080">(</font>N<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Neck<font color="#000080">(</font>N<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>Drehen<font color="#000080">:</font>Real<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawRing<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillRing<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetFrameColor<font color="#000080">(</font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>RecTangle<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>GetImage<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutImage<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutImagePart<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>XS2<font color="#000080">,</font>YS2<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillBlock<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollLeft<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollRight<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollUp<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollDown<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Scroll<font color="#000080">(</font>Direction<font color="#000080">:</font>Byte<font color="#000080">; </font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SwitchOff<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SwitchOn<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadPalette<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SavePalette<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadScreen<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveScreen<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>BCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>BFillCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Split<font color="#000080">(</font>Row<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollText<font color="#000080">(</font>Nr<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetStart<font color="#000080">(</font>S<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>VerticalRetrace<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitScreen<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitRetrace<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetOffset<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadSprite<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveSprite<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteXSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteYSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>FillScreen<font color="#000080">(</font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetChain4<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearChain4<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CharHeight<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Wait4Line<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>CLI<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>STI<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>PutImage4<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetWriteMap<font color="#000080">(</font>Map<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetWriteMode<font color="#000080">(</font>M<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Unchain<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Rechain<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearScreen<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetModeNr<font color="#000080">(</font>Nr<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Set16Pal<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>Init16Pal<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetLineRepeat<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>TextMode<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>Init13X<font color="#000080">;
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetReadMap<font color="#000080">(</font>Map<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineH4<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineV4<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>PROCEDURE </b></font>SetHorizOfs<font color="#000080">(</font>Count<font color="#000080">:</font>Byte<font color="#000080">);

</font><font color="#008000"><i>{
PROCEDURE SetModeReg(Reg:String);
PROCEDURE SetDoubleLines(Ok:Boolean);
PROCEDURE SetPal(VAR A);
PROCEDURE ReducePal(VAR A);
}

</i></font><font color="#FF0000"><b>IMPLEMENTATION
CONST
     </b></font>MaxFont<font color="#000080">=</font><font color="#800000">4</font><font color="#000080">;
     </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>MaxFont<font color="#000080">] </font><font color="#FF0000"><b>OF String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]=(</font><font color="#800000">'TRIP'</font><font color="#000080">,</font><font color="#800000">'LITT'</font><font color="#000080">,</font><font color="#800000">'SANS'</font><font color="#000080">,</font><font color="#800000">'GOTH'</font><font color="#000080">);
     </font>VekMax<font color="#000080">=</font><font color="#800000">100</font><font color="#000080">;
     </font>X_zu_Y<font color="#000080">=</font><font color="#800000">0.69</font><font color="#000080">;
</font><font color="#FF0000"><b>TYPE
    </b></font>FontType<font color="#000080">=</font><font color="#FF0000"><b>RECORD
                   </b></font>FBuf<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">16000</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
                   </font>WPtr<font color="#000080">:^</font>Word<font color="#000080">;
                   </font>DataOffs<font color="#000080">,</font>MinChar<font color="#000080">,</font>TBStart<font color="#000080">,</font>TblSize<font color="#000080">,</font>WidthTbl<font color="#000080">,</font>VecStart<font color="#000080">,</font>CUp<font color="#000080">,</font>CDown<font color="#000080">:</font>Integer<font color="#000080">;
                   </font>GLine<font color="#000080">,</font>Index<font color="#000080">,</font>CharWidth<font color="#000080">:</font>Integer<font color="#000080">;
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>Font<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font><font color="#000080">^</font>FontType<font color="#000080">;
   </font>FontNr<font color="#000080">,</font>MX<font color="#000080">,</font>DX<font color="#000080">,</font>MY<font color="#000080">,</font>DY<font color="#000080">:</font>Byte<font color="#000080">;
   </font>CurrMode<font color="#000080">,</font>OldMode<font color="#000080">:</font>Byte<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov bx,x
        mov dx,y
        xchg dh,dl
        mov al,c
        mov di,dx
        shr di,1
        shr di,1
        add di,dx
        add di,bx
        stosb
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Word<font color="#000080">):</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov bx,x
        mov dx,y
        mov di,dx
        shl di,1
        shl di,1
        add di,dx
        mov cl,6
        shl di,cl
        add di,bx
        mov al,es:[di]
        mov [bp-1],al
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineH<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov ax,y1
        mov di,ax
        shl di,1
        shl di,1
        add di,ax
        mov cl,6
        shl di,cl
        mov bx,x1
        mov dx,x2
        cmp bx,dx
        jl @1
        xchg bx,dx
@1:     inc dx
        add di,bx
        mov cx,dx
        sub cx,bx
        shr cx,1
        mov al,c
        mov ah,al
        ror bx,1
        jnb @2
        stosb
        ror dx,1
        jnb @3
        dec cx
@3:     rol dx,1
@2:     rep
        stosw
        ror dx,1
        jnb @4
        stosb
@4:
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineV<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,x1
        mov bx,y1
        mov dx,y2
        cmp bx,dx
        jl @1
        xchg bx,dx
@1:     mov di,bx
        shl di,1
        shl di,1
        add di,bx
        mov cl,6
        shl di,cl
        add di,ax
        mov cx,$a000
        mov es,cx
        mov cx,dx
        sub cx,bx
        inc cx
        mov al,c
        mov bx,$13f
@2:     stosb
        add di,bx
        loop @2
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLine<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov al,c
        xor ah,ah
        mov si,ax
        mov ax,x1
        cmp ax,319
        ja @Ende
        mov bx,x2
        cmp bx,319
        ja @Ende
        mov cx,y1
        cmp cx,199
        ja @Ende
        mov dx,y2
        cmp dx,199
        ja @Ende
        cmp ax,bx
        jnz @weiter
        cmp cx,dx
        jnz @vertical
        push ax
        push cx
        push si
        call setpixel
        jmp @ende
@weiter:cmp cx,dx
        jnz @weiter2
        push ax
        push bx
        push cx
        push si
        call drawlineh
        jmp @ende
@vertical:push ax
        push cx
        push dx
        push si
        call drawlinev
        jmp @ende
@weiter2:cmp cx,dx
        jbe @1
        xchg cx,dx
        xchg ax,bx
@1:     mov di,cx
        shl di,1
        shl di,1
        add di,cx
        push si
        mov si,bx
        mov bx,dx
        sub bx,cx
        mov cl,06
        shl di,cl
        add di,ax
        mov dx,si
        pop si
        sub dx,ax
        mov ax,$a000
        mov es,ax
        mov ax,si
        push bp
        or dx,0
        jge @jmp1
        neg dx
        cmp dx,bx
        jbe @jmp3
        mov cx,dx
        inc cx
        mov si,dx
        shr si,1
        std
        mov bp,320
@1c:    stosb
@1b:    or si,si
        jge @1a
        add di,bp
        add si,dx
        jmp @1b
@1a:    sub si,bx
        loop @1c
        jmp @Ende2
@jmp3:  mov cx,bx
        inc cx
        mov si,bx
        neg si
        sar si,1
        cld
        mov bp,319
@2c:    stosb
@2b:    or si,si
        jl @2a
        sub si,bx
        dec di
        jmp @2b
@2a:    add di,bp
        add si,dx
        loop @2c
        jmp @Ende2
@jmp1:  cmp dx,bx
        jbe @jmp4
        mov cx,dx
        inc cx
        mov si,dx
        shr si,1
        cld
        mov bp,320
@3c:    stosb
@3b:    or si,si
        jge @3a
        add di,bp
        add si,dx
        jmp @3b
@3a:    sub si,bx
        loop @3c
        jmp @Ende2
@jmp4:  mov cx,bx
        inc cx
        mov si,bx
        neg si
        sar si,1
        std
        mov bp,321
@4c:    stosb
@4b:    or si,si
        jl @4a
        sub si,bx
        inc di
        jmp @4b
@4a:    add di,bp
        add si,dx
        loop @4c
@Ende2: pop bp
        cld
@Ende:
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetColor<font color="#000080">(</font>Nr<font color="#000080">,</font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">]:=</font>Nr<font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>R<font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>G<font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">]:=</font>B<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetColor<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>R<font color="#000080">,</font>G<font color="#000080">,</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">]:=</font>Nr<font color="#000080">;
     </font>R<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
     </font>G<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
     </font>B<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>PaintChar<font color="#000080">(</font>Ch<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>XVec<font color="#000080">,</font>YVec<font color="#000080">,</font>Func<font color="#000080">,</font>GraphX<font color="#000080">,</font>GraphY<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>PaintChar<font color="#000080">:=</font>FALSE<font color="#000080">;
     </font><font color="#FF0000"><b>WITH </b></font>Font<font color="#000080">[</font>FontNr<font color="#000080">]^ </font><font color="#FF0000"><b>DO
     BEGIN
          IF </b></font><font color="#000080">(</font>Ch<font color="#000080">&lt;</font>MinChar<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Ch<font color="#000080">&gt;</font>MinChar<font color="#000080">+</font>TblSize<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
             </b></font>Exit<font color="#000080">;
          </font>Index<font color="#000080">:=</font>VecStart<font color="#000080">+</font>FBuf<font color="#000080">[</font>TBStart<font color="#000080">+(</font>Ch<font color="#000080">-</font>MinChar<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">]+</font>FBuf<font color="#000080">[</font>TBStart<font color="#000080">+(</font>Ch<font color="#000080">-</font>MinChar<font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]*</font><font color="#800000">256</font><font color="#000080">;
          </font><font color="#FF0000"><b>REPEAT
                </b></font>XVec<font color="#000080">:=</font>ShortInt<font color="#000080">(</font>FBuf<font color="#000080">[</font>Index<font color="#000080">]);
                </font>YVec<font color="#000080">:=</font>ShortInt<font color="#000080">(</font>FBuf<font color="#000080">[</font>Index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">]);
                </font>Inc<font color="#000080">(</font>Index<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                </font>Func<font color="#000080">:=(</font>XVec <font color="#FF0000"><b>AND </b></font><font color="#800000">$80</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">6</font><font color="#000080">+(</font>YVec <font color="#FF0000"><b>AND </b></font><font color="#800000">$80</font><font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">7</font><font color="#000080">;
                </font>XVec<font color="#000080">:=</font>XVec <font color="#FF0000"><b>AND </b></font><font color="#800000">$7F</font><font color="#000080">;
                </font>YVec<font color="#000080">:=</font>YVec <font color="#FF0000"><b>AND </b></font><font color="#800000">$7F</font><font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>XVec<font color="#000080">&gt;=</font><font color="#800000">$40 </font><font color="#FF0000"><b>THEN
                   </b></font>XVec<font color="#000080">:=-</font><font color="#800000">128</font><font color="#000080">+</font>XVec<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>YVec<font color="#000080">&gt;=</font><font color="#800000">$40 </font><font color="#FF0000"><b>THEN
                   </b></font>YVec<font color="#000080">:=-</font><font color="#800000">128</font><font color="#000080">+</font>YVec<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>MX<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                   </b></font>XVec<font color="#000080">:=</font>XVec<font color="#000080">*</font>MX<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>DX<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                   </b></font>XVec<font color="#000080">:=</font>XVec <font color="#FF0000"><b>DIV </b></font>DX<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>MY<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                   </b></font>YVec<font color="#000080">:=</font>YVec<font color="#000080">*</font>MY<font color="#000080">;
                </font><font color="#FF0000"><b>IF </b></font>DY<font color="#000080">&lt;&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                   </b></font>YVec<font color="#000080">:=</font>YVec <font color="#FF0000"><b>DIV </b></font>DY<font color="#000080">;
                </font><font color="#FF0000"><b>CASE </b></font>Func <font color="#FF0000"><b>OF
                     </b></font><font color="#800000">2</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
                            </b></font>GraphX<font color="#000080">:=</font>X<font color="#000080">+</font>XVec<font color="#000080">;
                            </font>GraphY<font color="#000080">:=</font>CUp<font color="#000080">+</font>Y<font color="#000080">-</font>YVec<font color="#000080">;
                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                     </font><font color="#800000">3</font><font color="#000080">:</font><font color="#FF0000"><b>BEGIN
                            </b></font>DrawLine<font color="#000080">(</font>X<font color="#000080">+</font>XVec<font color="#000080">,</font>CUp<font color="#000080">+</font>Y<font color="#000080">-</font>YVec<font color="#000080">,</font>GraphX<font color="#000080">,</font>GraphY<font color="#000080">,</font>C<font color="#000080">);
                            </font>GraphX<font color="#000080">:=</font>X<font color="#000080">+</font>XVec<font color="#000080">;
                            </font>GraphY<font color="#000080">:=</font>CUp<font color="#000080">+</font>Y<font color="#000080">-</font>YVec<font color="#000080">;
                       </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>UNTIL </b></font>Func<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>PaintChar<font color="#000080">:=</font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GrWrite<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">; </font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     WITH </b></font>Font<font color="#000080">[</font>FontNr<font color="#000080">]^ </font><font color="#FF0000"><b>DO
     BEGIN
          FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Ord<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]) </font><font color="#FF0000"><b>DO
          BEGIN
               IF </b></font>X<font color="#000080">+</font>FBuf<font color="#000080">[</font>WidthTbl<font color="#000080">+</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">])-</font>MinChar<font color="#000080">]*</font>MX <font color="#FF0000"><b>DIV </b></font>DX<font color="#000080">&gt;</font><font color="#800000">319 </font><font color="#FF0000"><b>THEN
               BEGIN
                    </b></font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
                    </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">+(</font>CUp<font color="#000080">-</font>CDown<font color="#000080">)*</font>MY <font color="#FF0000"><b>DIV </b></font>DY<font color="#000080">&gt;</font><font color="#800000">319 </font><font color="#FF0000"><b>THEN
                       </b></font>Exit<font color="#000080">;
                    </font>Inc<font color="#000080">(</font>Y<font color="#000080">,(</font>CUp<font color="#000080">-</font>CDown<font color="#000080">)*</font>MY <font color="#FF0000"><b>DIV </b></font>DY<font color="#000080">);
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>IF </b></font>PaintChar<font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]),</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>C<font color="#000080">) </font><font color="#FF0000"><b>THEN
                  </b></font>Inc<font color="#000080">(</font>X<font color="#000080">,(</font>FBuf<font color="#000080">[</font>WidthTbl<font color="#000080">+</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">])-</font>MinChar<font color="#000080">])*</font>MX <font color="#FF0000"><b>DIV </b></font>DX<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadFont<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>X<font color="#000080">:</font>Integer<font color="#000080">;
   </font>ChrFile<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>New<font color="#000080">(</font>Font<font color="#000080">[</font>Nr<font color="#000080">]);
     </font><font color="#FF0000"><b>WITH </b></font>Font<font color="#000080">[</font>Nr<font color="#000080">]^ </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>Assign<font color="#000080">(</font>ChrFile<font color="#000080">,</font>Name<font color="#000080">+</font><font color="#800000">'.CHR'</font><font color="#000080">);
          </font>Reset<font color="#000080">(</font>ChrFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
          </font>BlockRead<font color="#000080">(</font>ChrFile<font color="#000080">,</font>FBuf<font color="#000080">,</font>FileSize<font color="#000080">(</font>ChrFile<font color="#000080">));
          </font>Close<font color="#000080">(</font>ChrFile<font color="#000080">);
          </font>X<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>X<font color="#000080">&lt;</font><font color="#800000">$80</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>FBuf<font color="#000080">[</font>X<font color="#000080">]&lt;&gt;</font><font color="#800000">$1A</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
          </font>Inc<font color="#000080">(</font>X<font color="#000080">);
          </font>DataOffs<font color="#000080">:=</font>FBuf<font color="#000080">[</font>X<font color="#000080">]+</font>FBuf<font color="#000080">[</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
          </font>TblSize<font color="#000080">:=</font>FBuf<font color="#000080">[</font>DataOffs<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">];
          </font>MinChar<font color="#000080">:=</font>FBuf<font color="#000080">[</font>DataOffs<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">];
          </font>CUp<font color="#000080">:=</font>FBuf<font color="#000080">[</font>DataOffs<font color="#000080">+</font><font color="#800000">8</font><font color="#000080">];
          </font>CDown<font color="#000080">:=</font>ShortInt<font color="#000080">(</font>FBuf<font color="#000080">[</font>DataOffs<font color="#000080">+</font><font color="#800000">$0A</font><font color="#000080">]);
          </font>TBStart<font color="#000080">:=</font>DataOffs<font color="#000080">+</font><font color="#800000">$10</font><font color="#000080">;
          </font>WidthTbl<font color="#000080">:=</font>TBStart<font color="#000080">+</font>TblSize <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;
          </font>WPtr<font color="#000080">:=@</font>FBuf<font color="#000080">[</font>DataOffs<font color="#000080">+</font><font color="#800000">5</font><font color="#000080">];
          </font>VecStart<font color="#000080">:=</font>WPtr<font color="#000080">^+</font>DataOffs<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetText<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">; </font>MultX<font color="#000080">,</font>DivX<font color="#000080">,</font>MultY<font color="#000080">,</font>DivY<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     IF </b></font><font color="#000080">(</font>Nr<font color="#000080">&lt;</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Nr<font color="#000080">&gt;</font>MaxFont<font color="#000080">) </font><font color="#FF0000"><b>THEN
        </b></font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>Font<font color="#000080">[</font>Nr<font color="#000080">]=</font><font color="#FF0000"><b>NIL THEN
        </b></font>LoadFont<font color="#000080">(</font>Nr<font color="#000080">,</font>FontName<font color="#000080">[</font>Nr<font color="#000080">]);
     </font>FontNr<font color="#000080">:=</font>Nr<font color="#000080">;
     </font>MX<font color="#000080">:=</font>MultX<font color="#000080">;
     </font>DX<font color="#000080">:=</font>DivX<font color="#000080">;
     </font>MY<font color="#000080">:=</font>MultY<font color="#000080">;
     </font>DY<font color="#000080">:=</font>DivY<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawPolygon<font color="#000080">(</font>Count<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>TYPE
    </b></font>PunkteArray<font color="#000080">=</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">16383</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>A<font color="#000080">:</font>PunkteArray <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>I<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>DrawLine<font color="#000080">(</font>A<font color="#000080">[</font>Count<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>A<font color="#000080">[</font>Count<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>A<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>C<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>Count <font color="#FF0000"><b>DO
         </b></font>DrawLine<font color="#000080">(</font>A<font color="#000080">[</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>A<font color="#000080">[</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Fill<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);  </font><font color="#008000"><i>{ Nur die selbe Farbe ersetzen }
</i></font><font color="#FF0000"><b>VAR
   </b></font>C2<font color="#000080">:</font>Byte<font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>Suchen<font color="#000080">(</font>L<font color="#000080">,</font>R<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>UpDown<font color="#000080">:</font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>VAR
      </b></font>X<font color="#000080">,</font>X2<font color="#000080">:</font>Integer<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
        IF </b></font>GetPixel<font color="#000080">(</font>L<font color="#000080">,</font>Y<font color="#000080">)=</font>C2 <font color="#FF0000"><b>THEN
           WHILE </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)=</font>C2<font color="#000080">) </font><font color="#FF0000"><b>DO
                 </b></font>Dec<font color="#000080">(</font>L<font color="#000080">);
        </font>X<font color="#000080">:=</font>L<font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>GetPixel<font color="#000080">(</font>R<font color="#000080">,</font>Y<font color="#000080">)=</font>C2 <font color="#FF0000"><b>THEN
           WHILE </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)=</font>C2<font color="#000080">) </font><font color="#FF0000"><b>DO
                 </b></font>Inc<font color="#000080">(</font>R<font color="#000080">);
        </font><font color="#FF0000"><b>WHILE </b></font>X<font color="#000080">&lt;=</font>R <font color="#FF0000"><b>DO
        BEGIN
             </b></font>X2<font color="#000080">:=</font>X<font color="#000080">;
             </font><font color="#FF0000"><b>IF </b></font>GetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">)=</font>C2 <font color="#FF0000"><b>THEN
             BEGIN
                  WHILE </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)=</font>C2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>X<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                        </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
                  </font>DrawLineH<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>C<font color="#000080">);
                  </font><font color="#FF0000"><b>IF </b></font>UpDown<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>THEN
                  BEGIN
                       IF </b></font>Y<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                          </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">&lt;</font><font color="#800000">199 </font><font color="#FF0000"><b>THEN
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                          BEGIN
                               </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                               </font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                          </font><font color="#FF0000"><b>END
                          ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&lt;=</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
                          </font><font color="#FF0000"><b>ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&gt;=</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>IF </b></font>UpDown<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                  BEGIN
                       IF </b></font>Y<font color="#000080">&lt;</font><font color="#800000">199 </font><font color="#FF0000"><b>THEN
                          </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                          BEGIN
                               </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                               </font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                          </font><font color="#FF0000"><b>END
                          ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&lt;=</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)
                          </font><font color="#FF0000"><b>ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&gt;=</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>Inc<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>C2<font color="#000080">:=</font>GetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>Dec<font color="#000080">(</font>Y<font color="#000080">);
     </font>Suchen<font color="#000080">(</font>X<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>Suchen<font color="#000080">(</font>X<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Flood<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">,</font>C2<font color="#000080">:</font>Byte<font color="#000080">);  </font><font color="#008000"><i>{ Anf„rben bis zur Randfarbe C2 }

   </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Suchen<font color="#000080">(</font>L<font color="#000080">,</font>R<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">; </font>UpDown<font color="#000080">:</font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>VAR
      </b></font>X<font color="#000080">,</font>X2<font color="#000080">:</font>Integer<font color="#000080">;
   </font><font color="#FF0000"><b>BEGIN
        IF </b></font>GetPixel<font color="#000080">(</font>L<font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2 <font color="#FF0000"><b>THEN
           WHILE </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2<font color="#000080">) </font><font color="#FF0000"><b>DO
                 </b></font>Dec<font color="#000080">(</font>L<font color="#000080">);
        </font>X<font color="#000080">:=</font>L<font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>GetPixel<font color="#000080">(</font>R<font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2 <font color="#FF0000"><b>THEN
           WHILE </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2<font color="#000080">) </font><font color="#FF0000"><b>DO
                 </b></font>Inc<font color="#000080">(</font>R<font color="#000080">);
        </font><font color="#FF0000"><b>WHILE </b></font>X<font color="#000080">&lt;=</font>R <font color="#FF0000"><b>DO
        BEGIN
             </b></font>X2<font color="#000080">:=</font>X<font color="#000080">;
             </font><font color="#FF0000"><b>IF </b></font>GetPixel<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2 <font color="#FF0000"><b>THEN
             BEGIN
                  WHILE </b></font><font color="#000080">(</font>GetPixel<font color="#000080">(</font>X<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">)&lt;&gt;</font>C2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>X<font color="#000080">&lt;</font><font color="#800000">319</font><font color="#000080">) </font><font color="#FF0000"><b>DO
                        </b></font>Inc<font color="#000080">(</font>X<font color="#000080">);
                  </font>DrawLineH<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>C<font color="#000080">);
                  </font><font color="#FF0000"><b>IF </b></font>UpDown<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>THEN
                  BEGIN
                       IF </b></font>Y<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                          </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">&lt;</font><font color="#800000">199 </font><font color="#FF0000"><b>THEN
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                          BEGIN
                               </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                               </font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                          </font><font color="#FF0000"><b>END
                          ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&lt;=</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
                          </font><font color="#FF0000"><b>ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&gt;=</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                  </font><font color="#FF0000"><b>IF </b></font>UpDown<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
                  BEGIN
                       IF </b></font>Y<font color="#000080">&lt;</font><font color="#800000">199 </font><font color="#FF0000"><b>THEN
                          </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
                       </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                          BEGIN
                               </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                               </font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                          </font><font color="#FF0000"><b>END
                          ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&lt;=</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&lt;</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>R<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)
                          </font><font color="#FF0000"><b>ELSE
                          IF </b></font><font color="#000080">(</font>L<font color="#000080">&gt;</font>X2<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>R<font color="#000080">&gt;=</font>X<font color="#000080">) </font><font color="#FF0000"><b>THEN
                             </b></font>Suchen<font color="#000080">(</font>X2<font color="#000080">,</font>L<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>Y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
             </font>Inc<font color="#000080">(</font>X<font color="#000080">);
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     IF </b></font>Y<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>Dec<font color="#000080">(</font>Y<font color="#000080">);
     </font>Suchen<font color="#000080">(</font>X<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
     </font>Suchen<font color="#000080">(</font>X<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MCGAOn<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ah,$f
        int $10
        mov [offset oldmode],al
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">mov ax,$13
        int $10
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MCGAOff<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov al,[offset oldmode]
        xor ah,ah
        int $10
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillPolygon<font color="#000080">(</font>Size<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P1<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>TYPE
    </b></font>Vektor<font color="#000080">=</font><font color="#FF0000"><b>RECORD
                 </b></font>X<font color="#000080">,</font>Y<font color="#000080">,</font>XMax<font color="#000080">,</font>DX<font color="#000080">,</font>DY<font color="#000080">,</font>DZ<font color="#000080">,</font>Z<font color="#000080">,</font>Spalte<font color="#000080">:</font>Integer<font color="#000080">;
           </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>VekPoly<font color="#000080">=</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>VekMax<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>P<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>VekMax<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer <font color="#FF0000"><b>ABSOLUTE </b></font>P1<font color="#000080">;
   </font>Sp<font color="#000080">:</font>VekPoly<font color="#000080">;
   </font>NF<font color="#000080">:</font>Boolean<font color="#000080">;
   </font>V<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>VekMax<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Vektor<font color="#000080">;
   </font>S<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">*</font>VekMax<font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
   </font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>N<font color="#000080">,</font>SX<font color="#000080">,</font>YRMin<font color="#000080">,</font>YRMax<font color="#000080">,</font>YR<font color="#000080">,</font>XMin<font color="#000080">,</font>YMin<font color="#000080">,</font>YMax<font color="#000080">,</font>I2<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     IF </b></font>Size<font color="#000080">&gt;</font>VekMax <font color="#FF0000"><b>THEN
        </b></font>Exit<font color="#000080">;
     </font>K<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
     BEGIN
          </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>P<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
          </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>P<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
          </font><font color="#FF0000"><b>IF </b></font>I<font color="#000080">=</font>Size <font color="#FF0000"><b>THEN
          BEGIN
               </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>P<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>P<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
          </font><font color="#FF0000"><b>END
          ELSE
          BEGIN
               </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>P<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>P<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>IF </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]-</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
          BEGIN
               </b></font>J<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>J<font color="#000080">;
               </font>J<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
               </font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>J<font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Inc<font color="#000080">(</font>K<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>YRMin<font color="#000080">:=</font><font color="#800000">199</font><font color="#000080">;
     </font>YRMax<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
         FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">2 </font><font color="#FF0000"><b>DO
         BEGIN
              IF </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]&gt;</font>YRMax <font color="#FF0000"><b>THEN
                 </b></font>YRMax<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
              </font><font color="#FF0000"><b>IF </b></font>Sp<font color="#000080">[</font>K<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]&lt;</font>YRMin <font color="#FF0000"><b>THEN
                 </b></font>YRMin<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>YRMin<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>YRMin<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>YRMax<font color="#000080">&gt;</font><font color="#800000">199 </font><font color="#FF0000"><b>THEN
        </b></font>YRMax<font color="#000080">:=</font><font color="#800000">199</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
         WITH </b></font>V<font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>DO
         BEGIN
              </b></font>XMin<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
              </font>YMin<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
              </font>XMax<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">];
              </font>YMax<font color="#000080">:=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">];
              </font>DX<font color="#000080">:=</font>Abs<font color="#000080">(</font>XMin<font color="#000080">-</font>XMax<font color="#000080">);
              </font>DY<font color="#000080">:=</font>Abs<font color="#000080">(</font>YMin<font color="#000080">-</font>YMax<font color="#000080">);
              </font>X<font color="#000080">:=</font>XMin<font color="#000080">;
              </font>Y<font color="#000080">:=</font>YMin<font color="#000080">;
              </font><font color="#FF0000"><b>IF </b></font>XMin<font color="#000080">&lt;</font>XMax <font color="#FF0000"><b>THEN
                 </b></font>Z<font color="#000080">:=</font><font color="#800000">1
              </font><font color="#FF0000"><b>ELSE </b></font>Z<font color="#000080">:=-</font><font color="#800000">1</font><font color="#000080">;
              </font><font color="#FF0000"><b>IF </b></font>DX<font color="#000080">&gt;</font>DY <font color="#FF0000"><b>THEN
                 </b></font>I2<font color="#000080">:=</font>DX
              <font color="#FF0000"><b>ELSE </b></font>I2<font color="#000080">:=</font>DY<font color="#000080">;
              </font>DZ<font color="#000080">:=</font>I2 <font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">;
              </font>Spalte<font color="#000080">:=</font>XMin<font color="#000080">;
         </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>YR<font color="#000080">:=</font>YRMin <font color="#FF0000"><b>TO </b></font>YRMax <font color="#FF0000"><b>DO
     BEGIN
          </b></font>N<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
          </font><font color="#FF0000"><b>FOR </b></font>K<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Size <font color="#FF0000"><b>DO
              IF </b></font><font color="#000080">((</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]&lt;=</font>YR<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>YR<font color="#000080">&lt;</font>SP<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">])) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">((</font>YR<font color="#000080">=</font>YRMax<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>YRMax<font color="#000080">=</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>YRMax<font color="#000080">&lt;&gt;</font>Sp<font color="#000080">[</font>K<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">])) </font><font color="#FF0000"><b>THEN
              BEGIN
                   WITH </b></font>V<font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>DO
                   BEGIN
                        </b></font>Inc<font color="#000080">(</font>N<font color="#000080">);
                        </font>S<font color="#000080">[</font>N<font color="#000080">]:=</font>X<font color="#000080">;
                        </font>SX<font color="#000080">:=</font>X<font color="#000080">;
                        </font><font color="#FF0000"><b>REPEAT
                              IF </b></font>DZ<font color="#000080">&lt;</font>DX <font color="#FF0000"><b>THEN
                              BEGIN
                                   </b></font>DZ<font color="#000080">:=</font>DZ<font color="#000080">+</font>DY<font color="#000080">;
                                   </font>X<font color="#000080">:=</font>X<font color="#000080">+</font>Z<font color="#000080">;
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font><font color="#FF0000"><b>IF </b></font>DZ<font color="#000080">&gt;=</font>DX <font color="#FF0000"><b>THEN
                              BEGIN
                                   </b></font>DZ<font color="#000080">:=</font>DZ<font color="#000080">-</font>DX<font color="#000080">;
                                   </font>Inc<font color="#000080">(</font>Y<font color="#000080">);
                              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
                              </font><font color="#FF0000"><b>IF </b></font>Y<font color="#000080">=</font>YR <font color="#FF0000"><b>THEN
                                 </b></font>SX<font color="#000080">:=</font>X<font color="#000080">;
                              </font>Inc<font color="#000080">(</font>Spalte<font color="#000080">,</font>Z<font color="#000080">);
                        </font><font color="#FF0000"><b>UNTIL </b></font><font color="#000080">(</font>Y<font color="#000080">&gt;</font>YR<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Spalte<font color="#000080">=</font>XMax<font color="#000080">);
                        </font>Inc<font color="#000080">(</font>N<font color="#000080">);
                        </font>S<font color="#000080">[</font>N<font color="#000080">]:=</font>SX<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>TO </b></font>N <font color="#FF0000"><b>DO
              FOR </b></font>K<font color="#000080">:=</font>N <font color="#FF0000"><b>DOWNTO </b></font>I <font color="#FF0000"><b>DO
                  IF </b></font>S<font color="#000080">[</font>K<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]&gt;</font>S<font color="#000080">[</font>K<font color="#000080">] </font><font color="#FF0000"><b>THEN
                  BEGIN
                       </b></font>J<font color="#000080">:=</font>S<font color="#000080">[</font>K<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">];
                       </font>S<font color="#000080">[</font>K<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]:=</font>S<font color="#000080">[</font>K<font color="#000080">];
                       </font>S<font color="#000080">[</font>K<font color="#000080">]:=</font>J<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>K<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>WHILE </b></font>K<font color="#000080">&lt;=</font>N <font color="#FF0000"><b>DO
          BEGIN
               IF </b></font>S<font color="#000080">[</font>K<font color="#000080">]&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
                  </b></font>S<font color="#000080">[</font>K<font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
               </font><font color="#FF0000"><b>IF </b></font>S<font color="#000080">[</font>K<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]&gt;</font><font color="#800000">319 </font><font color="#FF0000"><b>THEN
                  </b></font>S<font color="#000080">[</font>K<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">]:=</font><font color="#800000">319</font><font color="#000080">;
               </font>DrawLineH<font color="#000080">(</font>S<font color="#000080">[</font>K<font color="#000080">],</font>S<font color="#000080">[</font>K<font color="#000080">+</font><font color="#800000">3</font><font color="#000080">],</font>YR<font color="#000080">,</font>C<font color="#000080">);
               </font>K<font color="#000080">:=</font>K<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Ellipse<font color="#000080">(</font>MX<font color="#000080">,</font>MY<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>X<font color="#000080">,</font>Y<font color="#000080">,</font>X2<font color="#000080">,</font>J<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Dec<font color="#000080">(</font>B<font color="#000080">);
     </font>X2<font color="#000080">:=</font>A<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>Y<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>B <font color="#FF0000"><b>DO
     BEGIN
          </b></font>X<font color="#000080">:=</font>Trunc<font color="#000080">(</font>A<font color="#000080">/</font>B<font color="#000080">*</font>Sqrt<font color="#000080">(</font>Sqr<font color="#000080">(</font>B<font color="#000080">)-</font>Sqr<font color="#000080">(</font>Y<font color="#000080">-</font><font color="#800000">0.5</font><font color="#000080">)));
          </font><font color="#FF0000"><b>FOR </b></font>J<font color="#000080">:=</font>X <font color="#FF0000"><b>TO </b></font>X2 <font color="#FF0000"><b>DO
          BEGIN
               </b></font>SetPixel<font color="#000080">(</font>MX<font color="#000080">+</font>J<font color="#000080">,</font>MY<font color="#000080">+</font>Y<font color="#000080">,</font>C<font color="#000080">);
               </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">-</font>J<font color="#000080">,</font>MY<font color="#000080">+</font>Y<font color="#000080">,</font>C<font color="#000080">);
               </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">+</font>J<font color="#000080">,</font>MY<font color="#000080">-</font>Y<font color="#000080">,</font>C<font color="#000080">);
               </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">-</font>J<font color="#000080">,</font>MY<font color="#000080">-</font>Y<font color="#000080">,</font>C<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>X2<font color="#000080">:=</font>X<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Inc<font color="#000080">(</font>B<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>J<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>X <font color="#FF0000"><b>DO
     BEGIN
          </b></font>SetPixel<font color="#000080">(</font>MX<font color="#000080">+</font>J<font color="#000080">,</font>MY<font color="#000080">+</font>B<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">-</font>J<font color="#000080">,</font>MY<font color="#000080">+</font>B<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">+</font>J<font color="#000080">,</font>MY<font color="#000080">-</font>B<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>MX<font color="#000080">-</font>J<font color="#000080">,</font>MY<font color="#000080">-</font>B<font color="#000080">,</font>C<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillEllipse<font color="#000080">(</font>MX<font color="#000080">,</font>MY<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>X<font color="#000080">,</font>Y<font color="#000080">,</font>X2<font color="#000080">,</font>J<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Dec<font color="#000080">(</font>B<font color="#000080">);
     </font>X2<font color="#000080">:=</font>A<font color="#000080">;
     </font>DrawLineH<font color="#000080">(</font>MX<font color="#000080">-</font>A<font color="#000080">,</font>MX<font color="#000080">+</font>A<font color="#000080">,</font>MY<font color="#000080">,</font>C<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>Y<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>B <font color="#FF0000"><b>DO
     BEGIN
          </b></font>X<font color="#000080">:=</font>Trunc<font color="#000080">(</font>A<font color="#000080">/</font>B<font color="#000080">*</font>Sqrt<font color="#000080">((</font>Sqr<font color="#000080">(</font>LongInt<font color="#000080">(</font>B<font color="#000080">)))-</font>Sqr<font color="#000080">(</font>Y<font color="#000080">-</font><font color="#800000">0.5</font><font color="#000080">)));
          </font>DrawLineH<font color="#000080">(</font>MX<font color="#000080">-</font>X<font color="#000080">,</font>MX<font color="#000080">+</font>X<font color="#000080">,</font>MY<font color="#000080">+</font>Y<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLineH<font color="#000080">(</font>MX<font color="#000080">-</font>X<font color="#000080">,</font>MX<font color="#000080">+</font>X<font color="#000080">,</font>MY<font color="#000080">-</font>Y<font color="#000080">,</font>C<font color="#000080">);
          </font>X2<font color="#000080">:=</font>X<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Circle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Ellipse<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">,</font>Trunc<font color="#000080">(</font>R<font color="#000080">*</font>X_zu_Y<font color="#000080">),</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>FillEllipse<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">,</font>Round<font color="#000080">(</font>R<font color="#000080">*</font>X_zu_Y<font color="#000080">),</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>RotateArray<font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">; </font>Count<font color="#000080">,</font>MX<font color="#000080">,</font>MY<font color="#000080">:</font>Integer<font color="#000080">; </font>Winkel<font color="#000080">:</font>Real<font color="#000080">);
</font><font color="#FF0000"><b>TYPE
    </b></font>PunkteArray<font color="#000080">=</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">16383</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>A<font color="#000080">:</font>PunkteArray <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>I<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">:</font>Integer<font color="#000080">;
   </font>CosWi<font color="#000080">,</font>SinWi<font color="#000080">:</font>Real<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Winkel<font color="#000080">:=-</font>Pi<font color="#000080">*</font>Winkel<font color="#000080">/</font><font color="#800000">180</font><font color="#000080">;
     </font>CosWi<font color="#000080">:=</font>Cos<font color="#000080">(</font>Winkel<font color="#000080">);
     </font>SinWi<font color="#000080">:=</font>Sin<font color="#000080">(</font>Winkel<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Count <font color="#FF0000"><b>DO
     BEGIN
          </b></font>X<font color="#000080">:=</font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]-</font>MX<font color="#000080">;
          </font>Y<font color="#000080">:=</font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]-</font>MY<font color="#000080">;
          </font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>Round<font color="#000080">(</font>X<font color="#000080">*</font>CosWi<font color="#000080">+</font>Y<font color="#000080">*</font>SinWi<font color="#000080">)+</font>MX<font color="#000080">;
          </font>A<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>Round<font color="#000080">(-</font>X<font color="#000080">*</font>SinWi<font color="#000080">+</font>Y<font color="#000080">*</font>CosWi<font color="#000080">)+</font>MY<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>N4eck<font color="#000080">(</font>N<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>D<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Word<font color="#000080">;
   </font>I<font color="#000080">,</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">;
   </font>Pi180<font color="#000080">:</font>Real<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Pi180<font color="#000080">:=</font>Pi<font color="#000080">/</font><font color="#800000">180</font><font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>N <font color="#FF0000"><b>DO
         </b></font>D<font color="#000080">[</font>I<font color="#000080">]:=</font>Round<font color="#000080">(</font>Sin<font color="#000080">(</font>Pi180<font color="#000080">*</font>I<font color="#000080">/</font>N<font color="#000080">*</font><font color="#800000">90</font><font color="#000080">)*</font><font color="#800000">10000</font><font color="#000080">);
     </font>X1<font color="#000080">:=</font>Round<font color="#000080">(</font>D<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]*</font>R1<font color="#000080">/</font><font color="#800000">10000</font><font color="#000080">);
     </font>Y1<font color="#000080">:=</font>Round<font color="#000080">(</font>D<font color="#000080">[</font>N<font color="#000080">]*</font>R2<font color="#000080">/</font><font color="#800000">10000</font><font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>N <font color="#FF0000"><b>DO
     BEGIN
          </b></font>X2<font color="#000080">:=</font>Round<font color="#000080">(</font>D<font color="#000080">[</font>I<font color="#000080">]*</font>R1<font color="#000080">/</font><font color="#800000">10000</font><font color="#000080">);
          </font>Y2<font color="#000080">:=</font>Round<font color="#000080">(</font>D<font color="#000080">[</font>N<font color="#000080">-</font>I<font color="#000080">]*</font>R2<font color="#000080">/</font><font color="#800000">10000</font><font color="#000080">);
          </font>DrawLine<font color="#000080">(</font>X<font color="#000080">-</font>X1<font color="#000080">,</font>Y<font color="#000080">+</font>Y1<font color="#000080">,</font>X<font color="#000080">-</font>X2<font color="#000080">,</font>Y<font color="#000080">+</font>Y2<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLine<font color="#000080">(</font>X<font color="#000080">+</font>X1<font color="#000080">,</font>Y<font color="#000080">+</font>Y1<font color="#000080">,</font>X<font color="#000080">+</font>X2<font color="#000080">,</font>Y<font color="#000080">+</font>Y2<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLine<font color="#000080">(</font>X<font color="#000080">+</font>X1<font color="#000080">,</font>Y<font color="#000080">-</font>Y1<font color="#000080">,</font>X<font color="#000080">+</font>X2<font color="#000080">,</font>Y<font color="#000080">-</font>Y2<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLine<font color="#000080">(</font>X<font color="#000080">-</font>X1<font color="#000080">,</font>Y<font color="#000080">-</font>Y1<font color="#000080">,</font>X<font color="#000080">-</font>X2<font color="#000080">,</font>Y<font color="#000080">-</font>Y2<font color="#000080">,</font>C<font color="#000080">);
          </font>X1<font color="#000080">:=</font>X2<font color="#000080">;
          </font>Y1<font color="#000080">:=</font>Y2<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Neck<font color="#000080">(</font>N<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>A<font color="#000080">,</font>B<font color="#000080">:</font>Integer<font color="#000080">; </font>Drehen<font color="#000080">:</font>Real<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;
   </font>Winkel<font color="#000080">,</font>Wi<font color="#000080">:</font>Real<font color="#000080">;
   </font>P<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Winkel<font color="#000080">:=</font><font color="#800000">2</font><font color="#000080">*</font>Pi<font color="#000080">/</font>N<font color="#000080">;
     </font>Wi<font color="#000080">:=</font>Winkel<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>N <font color="#FF0000"><b>DO
     BEGIN
          </b></font>P<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>Round<font color="#000080">(</font>A<font color="#000080">*</font>Cos<font color="#000080">(</font>Wi<font color="#000080">))+</font>X<font color="#000080">;
          </font>P<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>Round<font color="#000080">(</font>B<font color="#000080">*</font>Sin<font color="#000080">(</font>Wi<font color="#000080">))+</font>Y<font color="#000080">;
          </font>Wi<font color="#000080">:=</font>Wi<font color="#000080">+</font>Winkel<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font>Drehen<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>RotateArray<font color="#000080">(</font>P<font color="#000080">,</font>N<font color="#000080">,</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>Drehen<font color="#000080">);
     </font>DrawPolygon<font color="#000080">(</font>N<font color="#000080">,</font>P<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawRing<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>TYPE
    </b></font>Arr52<font color="#000080">=</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>CONST
     </b></font>D<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">14</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">=(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">);
     </font>A<font color="#000080">:</font>Arr52<font color="#000080">=(
     (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">),(</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">),(</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">),(</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">),(</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">),(</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">),(</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">),
     (</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">),(</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">),(</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">),(</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">),(</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">),(</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">),
     (</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">9927</font><font color="#000080">,-</font><font color="#800000">1205</font><font color="#000080">),(</font><font color="#800000">9709</font><font color="#000080">,-</font><font color="#800000">2393</font><font color="#000080">),(</font><font color="#800000">9350</font><font color="#000080">,-</font><font color="#800000">3546</font><font color="#000080">),(</font><font color="#800000">8855</font><font color="#000080">,-</font><font color="#800000">4647</font><font color="#000080">),(</font><font color="#800000">8230</font><font color="#000080">,-</font><font color="#800000">5681</font><font color="#000080">),(</font><font color="#800000">7485</font><font color="#000080">,-</font><font color="#800000">6631</font><font color="#000080">),
     (</font><font color="#800000">6631</font><font color="#000080">,-</font><font color="#800000">7485</font><font color="#000080">),(</font><font color="#800000">5681</font><font color="#000080">,-</font><font color="#800000">8230</font><font color="#000080">),(</font><font color="#800000">4647</font><font color="#000080">,-</font><font color="#800000">8855</font><font color="#000080">),(</font><font color="#800000">3546</font><font color="#000080">,-</font><font color="#800000">9350</font><font color="#000080">),(</font><font color="#800000">2393</font><font color="#000080">,-</font><font color="#800000">9709</font><font color="#000080">),(</font><font color="#800000">1205</font><font color="#000080">,-</font><font color="#800000">9927</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">10000</font><font color="#000080">),(-</font><font color="#800000">1205</font><font color="#000080">,-</font><font color="#800000">9927</font><font color="#000080">),(-</font><font color="#800000">2393</font><font color="#000080">,-</font><font color="#800000">9709</font><font color="#000080">),(-</font><font color="#800000">3546</font><font color="#000080">,-</font><font color="#800000">9350</font><font color="#000080">),(-</font><font color="#800000">4647</font><font color="#000080">,-</font><font color="#800000">8855</font><font color="#000080">),(-</font><font color="#800000">5681</font><font color="#000080">,-</font><font color="#800000">8230</font><font color="#000080">),(-</font><font color="#800000">6631</font><font color="#000080">,-</font><font color="#800000">7485</font><font color="#000080">),
     (-</font><font color="#800000">7485</font><font color="#000080">,-</font><font color="#800000">6631</font><font color="#000080">),(-</font><font color="#800000">8230</font><font color="#000080">,-</font><font color="#800000">5681</font><font color="#000080">),(-</font><font color="#800000">8855</font><font color="#000080">,-</font><font color="#800000">4647</font><font color="#000080">),(-</font><font color="#800000">9350</font><font color="#000080">,-</font><font color="#800000">3546</font><font color="#000080">),(-</font><font color="#800000">9709</font><font color="#000080">,-</font><font color="#800000">2393</font><font color="#000080">),(-</font><font color="#800000">9927</font><font color="#000080">,-</font><font color="#800000">1205</font><font color="#000080">),
     (-</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">),(-</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">),(-</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">),(-</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">),(-</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">),(-</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">),
     (-</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">),(-</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">),(-</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">),(-</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">),(-</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">),(-</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">));
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">,</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">;
   </font>A2<font color="#000080">:</font>Arr52<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>A2<font color="#000080">:=</font>A<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">52 </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>X<font color="#000080">+</font>Round<font color="#000080">(</font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]/</font><font color="#800000">10000</font><font color="#000080">*</font>R1<font color="#000080">);
          </font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>Y<font color="#000080">+</font>Round<font color="#000080">(</font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]/</font><font color="#800000">10000</font><font color="#000080">*</font>R2<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>DrawPolygon<font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font>A2<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillRing<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R1<font color="#000080">,</font>R2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>TYPE
    </b></font>Arr52<font color="#000080">=</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">52</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>CONST
     </b></font>D<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">14</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Integer<font color="#000080">=(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">);
     </font>A<font color="#000080">:</font>Arr52<font color="#000080">=(
     (</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">10000</font><font color="#000080">),(</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">),(</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">),(</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">),(</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">),(</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">),(</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">),
     (</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">),(</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">),(</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">),(</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">),(</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">),(</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">),
     (</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(</font><font color="#800000">9927</font><font color="#000080">,-</font><font color="#800000">1205</font><font color="#000080">),(</font><font color="#800000">9709</font><font color="#000080">,-</font><font color="#800000">2393</font><font color="#000080">),(</font><font color="#800000">9350</font><font color="#000080">,-</font><font color="#800000">3546</font><font color="#000080">),(</font><font color="#800000">8855</font><font color="#000080">,-</font><font color="#800000">4647</font><font color="#000080">),(</font><font color="#800000">8230</font><font color="#000080">,-</font><font color="#800000">5681</font><font color="#000080">),(</font><font color="#800000">7485</font><font color="#000080">,-</font><font color="#800000">6631</font><font color="#000080">),
     (</font><font color="#800000">6631</font><font color="#000080">,-</font><font color="#800000">7485</font><font color="#000080">),(</font><font color="#800000">5681</font><font color="#000080">,-</font><font color="#800000">8230</font><font color="#000080">),(</font><font color="#800000">4647</font><font color="#000080">,-</font><font color="#800000">8855</font><font color="#000080">),(</font><font color="#800000">3546</font><font color="#000080">,-</font><font color="#800000">9350</font><font color="#000080">),(</font><font color="#800000">2393</font><font color="#000080">,-</font><font color="#800000">9709</font><font color="#000080">),(</font><font color="#800000">1205</font><font color="#000080">,-</font><font color="#800000">9927</font><font color="#000080">),
     (</font><font color="#800000">0</font><font color="#000080">,-</font><font color="#800000">10000</font><font color="#000080">),(-</font><font color="#800000">1205</font><font color="#000080">,-</font><font color="#800000">9927</font><font color="#000080">),(-</font><font color="#800000">2393</font><font color="#000080">,-</font><font color="#800000">9709</font><font color="#000080">),(-</font><font color="#800000">3546</font><font color="#000080">,-</font><font color="#800000">9350</font><font color="#000080">),(-</font><font color="#800000">4647</font><font color="#000080">,-</font><font color="#800000">8855</font><font color="#000080">),(-</font><font color="#800000">5681</font><font color="#000080">,-</font><font color="#800000">8230</font><font color="#000080">),(-</font><font color="#800000">6631</font><font color="#000080">,-</font><font color="#800000">7485</font><font color="#000080">),
     (-</font><font color="#800000">7485</font><font color="#000080">,-</font><font color="#800000">6631</font><font color="#000080">),(-</font><font color="#800000">8230</font><font color="#000080">,-</font><font color="#800000">5681</font><font color="#000080">),(-</font><font color="#800000">8855</font><font color="#000080">,-</font><font color="#800000">4647</font><font color="#000080">),(-</font><font color="#800000">9350</font><font color="#000080">,-</font><font color="#800000">3546</font><font color="#000080">),(-</font><font color="#800000">9709</font><font color="#000080">,-</font><font color="#800000">2393</font><font color="#000080">),(-</font><font color="#800000">9927</font><font color="#000080">,-</font><font color="#800000">1205</font><font color="#000080">),
     (-</font><font color="#800000">10000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">),(-</font><font color="#800000">9927</font><font color="#000080">,</font><font color="#800000">1205</font><font color="#000080">),(-</font><font color="#800000">9709</font><font color="#000080">,</font><font color="#800000">2393</font><font color="#000080">),(-</font><font color="#800000">9350</font><font color="#000080">,</font><font color="#800000">3546</font><font color="#000080">),(-</font><font color="#800000">8855</font><font color="#000080">,</font><font color="#800000">4647</font><font color="#000080">),(-</font><font color="#800000">8230</font><font color="#000080">,</font><font color="#800000">5681</font><font color="#000080">),(-</font><font color="#800000">7485</font><font color="#000080">,</font><font color="#800000">6631</font><font color="#000080">),
     (-</font><font color="#800000">6631</font><font color="#000080">,</font><font color="#800000">7485</font><font color="#000080">),(-</font><font color="#800000">5681</font><font color="#000080">,</font><font color="#800000">8230</font><font color="#000080">),(-</font><font color="#800000">4647</font><font color="#000080">,</font><font color="#800000">8855</font><font color="#000080">),(-</font><font color="#800000">3546</font><font color="#000080">,</font><font color="#800000">9350</font><font color="#000080">),(-</font><font color="#800000">2393</font><font color="#000080">,</font><font color="#800000">9709</font><font color="#000080">),(-</font><font color="#800000">1205</font><font color="#000080">,</font><font color="#800000">9927</font><font color="#000080">));
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">,</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">;
   </font>A2<font color="#000080">:</font>Arr52<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>A2<font color="#000080">:=</font>A<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">52 </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]:=</font>X<font color="#000080">+</font>Round<font color="#000080">(</font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">]/</font><font color="#800000">10000</font><font color="#000080">*</font>R1<font color="#000080">);
          </font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]:=</font>Y<font color="#000080">+</font>Round<font color="#000080">(</font>A2<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">]/</font><font color="#800000">10000</font><font color="#000080">*</font>R2<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>FillPolygon<font color="#000080">(</font><font color="#800000">52</font><font color="#000080">,</font>A2<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetFrameColor<font color="#000080">(</font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$1001
        mov bh,[bp+offset c]
        int $10
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>RecTangle<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>DrawLineH<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>C<font color="#000080">);
     </font>DrawLineH<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">,</font>C<font color="#000080">);
     </font>DrawLineV<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>C<font color="#000080">);
     </font>DrawLineV<font color="#000080">(</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>GetImage<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Data<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64003</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>I<font color="#000080">,</font>XS<font color="#000080">,</font>YS<font color="#000080">:</font>Word<font color="#000080">;
   </font>P2<font color="#000080">:</font>Pointer <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XS<font color="#000080">:=</font>X2<font color="#000080">-</font>X1<font color="#000080">;
     </font>YS<font color="#000080">:=</font>Y2<font color="#000080">-</font>Y1<font color="#000080">;
     </font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Lo<font color="#000080">(</font>XS<font color="#000080">);
     </font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font>Hi<font color="#000080">(</font>XS<font color="#000080">);
     </font>Data<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font>Lo<font color="#000080">(</font>YS<font color="#000080">);
     </font>Data<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>Hi<font color="#000080">(</font>YS<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>YS <font color="#FF0000"><b>DO
         </b></font>Move<font color="#000080">(</font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,(</font>Y1<font color="#000080">+</font>I<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+</font>X1<font color="#000080">)^,</font>Data<font color="#000080">[(</font>XS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>I<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">],</font>XS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
PROCEDURE PutImage(X1,Y1:Integer; VAR P);
VAR
   Data:ARRAY[0..64003] OF Byte ABSOLUTE P;
   I,XS,YS:Word;
BEGIN
     XS:=Data[0]+Data[1] SHL 8;
     YS:=Data[2]+Data[3] SHL 8;
     FOR I:=0 TO YS DO
         Move(Data[(XS+1)*I+4],Ptr($A000,(Y1+I)*320+X1)^,XS+1);
END;
}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>PutImage<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Data<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64003</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>Adr<font color="#000080">,</font>I<font color="#000080">,</font>XS<font color="#000080">,</font>YS<font color="#000080">:</font>Word<font color="#000080">;
   </font>DataDS<font color="#000080">,</font>DataSI<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>YS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>Adr<font color="#000080">:=</font>Word<font color="#000080">(</font>Y1<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+</font>X1<font color="#000080">;
     </font>DataDS<font color="#000080">:=</font>Seg<font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
     </font>DataSI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
     </font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">mov dx,ys
        inc dx
        mov bx,xs
        inc bx
        mov ax,$a000
        mov es,ax
        mov di,adr
        mov si,DataSI
        mov ax,DataDS
        push ds
        mov ds,ax
        cld
@1:     mov cx,bx
        rep movsb
        add di,320
        sub di,bx
        dec dx
        jnz @1
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
     FOR I:=0 TO YS DO
         Move(Data[(XS+1)*I+4],Ptr($A000,(Y1+I)*320+X1)^,XS+1);
}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PutImagePart<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>XS2<font color="#000080">,</font>YS2<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Data<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64003</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>Adr<font color="#000080">,</font>I<font color="#000080">,</font>XS<font color="#000080">,</font>YS<font color="#000080">:</font>Word<font color="#000080">;
   </font>DataDS<font color="#000080">,</font>DataSI<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font>YS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>XS2<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>XS2<font color="#000080">&gt;</font>XS<font color="#000080">) </font><font color="#FF0000"><b>THEN
        </b></font>XS2<font color="#000080">:=</font>XS<font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>YS2<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>YS2<font color="#000080">&gt;</font>YS<font color="#000080">) </font><font color="#FF0000"><b>THEN
        </b></font>YS2<font color="#000080">:=</font>YS<font color="#000080">;
     </font>Adr<font color="#000080">:=</font>Word<font color="#000080">(</font>Y1<font color="#000080">)*</font><font color="#800000">320</font><font color="#000080">+</font>X1<font color="#000080">;
     </font>DataDS<font color="#000080">:=</font>Seg<font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
     </font>DataSI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Data<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]);
     </font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">mov dx,ys
        mov bx,xs2
        mov ax,$a000
        mov es,ax
        mov di,adr
        mov si,DataSI
        mov ax,DataDS
        mov cx,xs
        sub cx,xs2
        push ds
        mov ds,ax
        mov ax,cx
        cld
@1:     mov cx,bx
        rep movsb
        add di,320
        sub di,bx
        add si,ax
        dec dx
        jnz @1
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{
     FOR I:=0 TO YS DO
         Move(Data[(XS+1)*I+4],Ptr($A000,(Y1+I)*320+X1)^,XS+1);
}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillBlock<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Y<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     FOR </b></font>Y<font color="#000080">:=</font>Y1 <font color="#FF0000"><b>TO </b></font>Y2 <font color="#FF0000"><b>DO
         </b></font>DrawLineH<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollLeft<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        mov ax,$a000
        mov es,ax
        mov ds,ax
        mov si,[bp+offset y1]
        mov cx,[bp+offset y2]
        sub cx,si
        inc cx
        mov ax,320
        mul si
        mov bx,[bp+offset x1]
        add ax,bx
        mov dx,[bp+offset x2]
        sub dx,bx
        inc dx
        cld
@1:     mov bx,cx
        mov di,ax
        dec di
        mov si,ax
        mov cx,dx
        rep movsb
        mov cx,bx
        add ax,320
        loop @1
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollRight<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        mov ax,$a000
        mov es,ax
        mov ds,ax
        mov si,[bp+offset y1]
        mov cx,[bp+offset y2]
        sub cx,si
        inc cx
        mov ax,320
        mul si
        mov bx,[bp+offset x1]
        mov dx,[bp+offset x2]
        add ax,dx
        sub dx,bx
        inc dx
        std
@1:     mov bx,cx
        mov di,ax
        mov si,ax
        dec si
        mov cx,dx
        rep movsb
        mov cx,bx
        add ax,320
        loop @1
        cld
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollUp<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        mov ax,$a000
        mov es,ax
        mov ds,ax
        mov si,[bp+offset y1]
        mov cx,[bp+offset y2]
        sub cx,si
        inc cx
        mov ax,320
        mul si
        mov bx,[bp+offset x1]
        add ax,bx
        mov dx,[bp+offset x2]
        sub dx,bx
        inc dx
        cld
@1:     mov bx,cx
        mov di,ax
        sub di,320
        mov si,ax
        mov cx,dx
        rep movsb
        mov cx,bx
        add ax,320
        loop @1
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollDown<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        mov ax,$a000
        mov es,ax
        mov ds,ax
        mov si,[bp+offset y1]
        mov cx,[bp+offset y2]
        mov ax,320
        mul cx
        sub cx,si
        inc cx
        mov bx,[bp+offset x1]
        mov dx,[bp+offset x2]
        add ax,bx
        sub dx,bx
        inc dx
        cld
@1:     mov bx,cx
        mov di,ax
        mov si,ax
        sub si,320
        mov cx,dx
        rep movsb
        mov cx,bx
        sub ax,320
        loop @1
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Scroll<font color="#000080">(</font>Direction<font color="#000080">:</font>Byte<font color="#000080">; </font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     CASE </b></font>Direction <font color="#FF0000"><b>OF
          </b></font>Up<font color="#000080">:</font>ScrollUp<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">);
          </font>Right<font color="#000080">:</font>ScrollRight<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">);
          </font>Down<font color="#000080">:</font>ScrollDown<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">);
          </font>Left<font color="#000080">:</font>ScrollLeft<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>X2<font color="#000080">,</font>Y2<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SwitchOff<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">mov dx,$3c4
   mov al,1
   out dx,al
   inc dx
   in al,dx
   or al,$20
   out dx,al
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SwitchOn<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">mov dx,$3c4
   mov al,1
   out dx,al
   inc dx
   in al,dx
   and al,$df
   out dx,al
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadPalette<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>RGB<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
   </font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.PAL'</font><font color="#000080">);
     </font>Reset<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>BlockRead<font color="#000080">(</font>Datei<font color="#000080">,</font>RGB<font color="#000080">,</font><font color="#800000">768</font><font color="#000080">);
     </font>SwitchOff<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
         </b></font>SetColor<font color="#000080">(</font>I<font color="#000080">,</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
     </font>SwitchOn<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SavePalette<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>RGB<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
   </font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.PAL'</font><font color="#000080">);
     </font>Rewrite<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
         </b></font>GetColor<font color="#000080">(</font>I<font color="#000080">,</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
     </font>BlockWrite<font color="#000080">(</font>Datei<font color="#000080">,</font>RGB<font color="#000080">,</font><font color="#800000">768</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadScreen<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>RGB<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
   </font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.BLD'</font><font color="#000080">);
     </font>Reset<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>BlockRead<font color="#000080">(</font>Datei<font color="#000080">,</font>RGB<font color="#000080">,</font><font color="#800000">768</font><font color="#000080">);
     </font>SwitchOff<font color="#000080">;
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
         </b></font>SetColor<font color="#000080">(</font>I<font color="#000080">,</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
     </font>BlockRead<font color="#000080">(</font>Datei<font color="#000080">,</font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)^,</font><font color="#800000">64000</font><font color="#000080">);
     </font>SwitchOn<font color="#000080">;
     </font>Close<font color="#000080">(</font>Datei<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveScreen<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>RGB<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
   </font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.BLD'</font><font color="#000080">);
     </font>Rewrite<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">255 </font><font color="#FF0000"><b>DO
         </b></font>GetColor<font color="#000080">(</font>I<font color="#000080">,</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">],</font>RGB<font color="#000080">[</font>I<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">]);
     </font>BlockWrite<font color="#000080">(</font>Datei<font color="#000080">,</font>RGB<font color="#000080">,</font><font color="#800000">768</font><font color="#000080">);
     </font>BlockWrite<font color="#000080">(</font>Datei<font color="#000080">,</font>Ptr<font color="#000080">(</font><font color="#800000">$A000</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">)^,</font><font color="#800000">64000</font><font color="#000080">);
     </font>Close<font color="#000080">(</font>Datei<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>BCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>XX4<font color="#000080">,</font>XX<font color="#000080">,</font>YY<font color="#000080">,</font>D<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XX<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>YY<font color="#000080">:=</font>R<font color="#000080">;
     </font>D<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">-(</font><font color="#800000">2</font><font color="#000080">*</font>R<font color="#000080">);
     </font><font color="#FF0000"><b>WHILE </b></font>XX<font color="#000080">&lt;=</font>YY <font color="#FF0000"><b>DO
     BEGIN
          </b></font>SetPixel<font color="#000080">(</font>X<font color="#000080">+</font>XX<font color="#000080">,</font>Y<font color="#000080">+</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">-</font>XX<font color="#000080">,</font>Y<font color="#000080">+</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">+</font>XX<font color="#000080">,</font>Y<font color="#000080">-</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">-</font>XX<font color="#000080">,</font>Y<font color="#000080">-</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">+</font>YY<font color="#000080">,</font>Y<font color="#000080">+</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">-</font>YY<font color="#000080">,</font>Y<font color="#000080">+</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">+</font>YY<font color="#000080">,</font>Y<font color="#000080">-</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>SetPixel<font color="#000080">(</font>X<font color="#000080">-</font>YY<font color="#000080">,</font>Y<font color="#000080">-</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>XX4<font color="#000080">:=</font>XX <font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">;
          </font><font color="#FF0000"><b>IF </b></font>D<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
             </b></font>Inc<font color="#000080">(</font>D<font color="#000080">,</font>XX4<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">)
          </font><font color="#FF0000"><b>ELSE
          BEGIN
               </b></font>Inc<font color="#000080">(</font>D<font color="#000080">,</font>XX4<font color="#000080">-</font>YY <font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">10</font><font color="#000080">);
               </font>Dec<font color="#000080">(</font>YY<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Inc<font color="#000080">(</font>XX<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>BFillCircle<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">,</font>R<font color="#000080">:</font>Integer<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>XX4<font color="#000080">,</font>XX<font color="#000080">,</font>YY<font color="#000080">,</font>D<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XX<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>YY<font color="#000080">:=</font>R<font color="#000080">;
     </font>D<font color="#000080">:=</font><font color="#800000">3</font><font color="#000080">-(</font><font color="#800000">2</font><font color="#000080">*</font>R<font color="#000080">);
     </font><font color="#FF0000"><b>WHILE </b></font>XX<font color="#000080">&lt;=</font>YY <font color="#FF0000"><b>DO
     BEGIN
          </b></font>DrawLineH<font color="#000080">(</font>X<font color="#000080">-</font>XX<font color="#000080">,</font>X<font color="#000080">+</font>XX<font color="#000080">,</font>Y<font color="#000080">+</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLineH<font color="#000080">(</font>X<font color="#000080">-</font>XX<font color="#000080">,</font>X<font color="#000080">+</font>XX<font color="#000080">,</font>Y<font color="#000080">-</font>YY<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLineH<font color="#000080">(</font>X<font color="#000080">-</font>YY<font color="#000080">,</font>X<font color="#000080">+</font>YY<font color="#000080">,</font>Y<font color="#000080">+</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLineH<font color="#000080">(</font>X<font color="#000080">-</font>YY<font color="#000080">,</font>X<font color="#000080">+</font>YY<font color="#000080">,</font>Y<font color="#000080">-</font>XX<font color="#000080">,</font>C<font color="#000080">);
          </font>XX4<font color="#000080">:=</font>XX <font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">;
          </font><font color="#FF0000"><b>IF </b></font>D<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
             </b></font>Inc<font color="#000080">(</font>D<font color="#000080">,</font>XX4<font color="#000080">+</font><font color="#800000">6</font><font color="#000080">)
          </font><font color="#FF0000"><b>ELSE
          BEGIN
               </b></font>Inc<font color="#000080">(</font>D<font color="#000080">,</font>XX4<font color="#000080">-</font>YY <font color="#FF0000"><b>SHL </b></font><font color="#800000">2</font><font color="#000080">+</font><font color="#800000">10</font><font color="#000080">);
               </font>Dec<font color="#000080">(</font>YY<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
          </font>Inc<font color="#000080">(</font>XX<font color="#000080">);
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Split<font color="#000080">(</font>Row<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,$3d4
        mov ax,row
        mov bh,ah
        mov bl,ah
        and bx,201h
        mov cl,4
        shl bx,cl
        mov ah,al
        mov al,18h
        out dx,ax
        mov al,7
        cli
        out dx,al
        inc dx
        in al,dx
        sti
        dec dx
        mov ah,al
        and ah,0efh
        or ah,bl
        mov al,7
        out dx,ax
        mov al,9
        cli
        out dx,al
        inc dx
        in al,dx
        sti
        dec dx
        mov ah,al
        and ah,0bfh
        shl bh,1
        shl bh,1
        or ah,bh
        mov al,9
        out dx,ax
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ScrollText<font color="#000080">(</font>Nr<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,nr
        push es
        push cx
        push dx
        mov cx,$40
        mov es,cx
        mov cl,es:[$85]
        div cl
        mov cx,ax
        mov dx,es:[$63]
        push dx
        mov al,$13
        cli
        out dx,al
        jmp @1
@1:     inc dx
        in al,dx
        sti
        mul cl
        shl ax,1
        mov es:[$4e],ax
        pop dx
        mov cl,al
        mov al,$c
        out dx,ax
        jmp @2
@2:     mov al,$d
        mov ah,cl
        out dx,ax
        jmp @3
@3:     mov ah,ch
        mov al,8
        out dx,ax
        pop dx
        pop cx
        pop es
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetStart<font color="#000080">(</font>S<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov bx,s
        mov dx,$3d4
        mov al,$c
        mov ah,bh
        out dx,ax
        inc ax
        mov ah,bl
        out dx,ax
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>VerticalRetrace<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,3dah
@1:     in al,dx
        test al,8
        jz @1
@2:     in al,dx
        test al,8
        jnz @2
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitScreen<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,3dah
@1:     in al,dx
        test al,8
        jnz @1
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WaitRetrace<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,3dah
@1:     in al,dx
        test al,8
        jz @1
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetOffset<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,$3d4
        mov al,$13
        mov ah,b
        out dx,ax
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>LoadSprite<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>Size<font color="#000080">,</font>I<font color="#000080">:</font>Word<font color="#000080">;
   </font>P2<font color="#000080">:</font>Pointer <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.SPR'</font><font color="#000080">);
     </font>Reset<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>Size<font color="#000080">:=</font>FileSize<font color="#000080">(</font>Datei<font color="#000080">);
     </font>GetMem<font color="#000080">(</font>P2<font color="#000080">,</font>Size<font color="#000080">+</font><font color="#800000">15</font><font color="#000080">);
     </font><font color="#FF0000"><b>IF </b></font>Ofs<font color="#000080">(</font>P2<font color="#000080">^)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>P2<font color="#000080">:=</font>Ptr<font color="#000080">(</font>Seg<font color="#000080">(</font>P2<font color="#000080">^)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
     </font>BlockRead<font color="#000080">(</font>Datei<font color="#000080">,</font>P2<font color="#000080">^,</font>Size<font color="#000080">);
     </font>Close<font color="#000080">(</font>Datei<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SaveSprite<font color="#000080">(</font>DateiName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>A<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[-</font><font color="#800000">4</font><font color="#000080">..</font><font color="#800000">32000</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>Datei<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
   </font>Size<font color="#000080">,</font>I<font color="#000080">:</font>Word<font color="#000080">;
   </font>XS<font color="#000080">,</font>YS<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XS<font color="#000080">:=</font>A<font color="#000080">[-</font><font color="#800000">4</font><font color="#000080">]+</font>A<font color="#000080">[-</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>YS<font color="#000080">:=</font>A<font color="#000080">[-</font><font color="#800000">2</font><font color="#000080">]+</font>A<font color="#000080">[-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>Assign<font color="#000080">(</font>Datei<font color="#000080">,</font>DateiName<font color="#000080">+</font><font color="#800000">'.SPR'</font><font color="#000080">);
     </font>Rewrite<font color="#000080">(</font>Datei<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
     </font>Size<font color="#000080">:=(</font>XS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*(</font>YS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">;
     </font>BlockWrite<font color="#000080">(</font>Datei<font color="#000080">,</font>A<font color="#000080">,</font>Size<font color="#000080">);
     </font>Close<font color="#000080">(</font>Datei<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FillScreen<font color="#000080">(</font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov al,c
        mov ah,al
        cld
        xor di,di
        mov cx,32000
        rep stosw
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Unchain<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0604</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$0014</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$E317</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0F02</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Rechain<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0E04</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0100</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0300</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$4014</font><font color="#000080">;
     </font>PortW<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$A317</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearScreen<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>PortW<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$0F02</font><font color="#000080">;
     </font><font color="#FF0000"><b>ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov cx,16383
        db $66
        xor ax,ax
        xor di,di
        cld
        db $66
        rep stosw
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetChain4<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3CE</font><font color="#000080">]:=</font><font color="#800000">$05</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">]:=</font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$EF</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3CE</font><font color="#000080">]:=</font><font color="#800000">$06</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">]:=</font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$FD</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">$04</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">]:=</font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F7</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$14</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">]:=</font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$BF</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$17</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">]:=</font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">] </font><font color="#FF0000"><b>OR </b></font><font color="#800000">$40</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>ClearChain4<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,$a000
        mov es,ax
        mov cx,32768
        xor di,di
        cld
        xor ax,ax
        rep stosw
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CharHeight<font color="#000080">(</font>B<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3D4</font><font color="#000080">]:=</font><font color="#800000">$09</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">]:=(</font>Port<font color="#000080">[</font><font color="#800000">$3D5</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$E0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font>B<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Wait4Line<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov dx,$3da
@1:     in al,dx
        test al,1
        jnz @1
@2:     in al,dx
        test al,1
        jz @2
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CLI<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">cli
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>STI<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">sti
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetWriteMap<font color="#000080">(</font>Map<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">2</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">]:=</font>Map<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>PutImage4<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">:</font>Integer<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>P<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Data<font color="#000080">:</font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">64003</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font>P<font color="#000080">;
   </font>Adr<font color="#000080">,</font>I<font color="#000080">,</font>J<font color="#000080">,</font>K<font color="#000080">,</font>XS<font color="#000080">,</font>YS<font color="#000080">:</font>Word<font color="#000080">;
   </font>DataDS<font color="#000080">,</font>DataSI<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>XS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>YS<font color="#000080">:=</font>Data<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]+</font>Data<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>SHL </b></font><font color="#800000">8</font><font color="#000080">;
     </font>DataDS<font color="#000080">:=</font>Seg<font color="#000080">(</font>Data<font color="#000080">);
     </font><font color="#FF0000"><b>FOR </b></font>J<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font>YS <font color="#FF0000"><b>DO
     BEGIN
          </b></font>DataSI<font color="#000080">:=</font>Ofs<font color="#000080">(</font>Data<font color="#000080">)+</font><font color="#800000">4</font><font color="#000080">+(</font>XS<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>J<font color="#000080">;
          </font><font color="#FF0000"><b>FOR </b></font>K<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">3 </font><font color="#FF0000"><b>DO
          BEGIN
               </b></font>Adr<font color="#000080">:=</font>Word<font color="#000080">(</font>Y1<font color="#000080">+</font>J<font color="#000080">)*</font><font color="#800000">80</font><font color="#000080">+(</font>X1<font color="#000080">+</font>K<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">2</font><font color="#000080">;
               </font>SetWriteMap<font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>SHL </b></font><font color="#000080">((</font>X1<font color="#000080">+</font>K<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">3</font><font color="#000080">));
               </font><font color="#FF0000"><b>ASM
                  </b></font><font color="#FF00FF">push ds
                  mov ax,$a000
                  mov es,ax
                  mov di,adr
                  mov cx,xs
                  shr cx,2
                  inc cx
                  mov si,datasi
                  mov ax,datads
                  mov ds,ax
                  mov bx,3
                  cld
@1:               movsb
                  add si,bx
                  loop @1
                  pop ds
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
               </font>Inc<font color="#000080">(</font>DataSI<font color="#000080">);
          </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteXSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        lds si,sprite
        lodsw
        inc ax
        mov @result,ax
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteYSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        lds si,sprite
        lodsw
        lodsw
        inc ax
        mov @result,ax
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>SpriteSize<font color="#000080">(</font>Sprite<font color="#000080">:</font>Pointer<font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">push ds
        lds si,sprite
        lodsw
        inc ax
        mov bx,ax
        lodsw
        inc ax
        mul bx
        add ax,4
        mov @result,ax
        pop ds
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetWriteMode<font color="#000080">(</font>M<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3CE</font><font color="#000080">]:=</font><font color="#800000">$05</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">]:=(</font>Port<font color="#000080">[</font><font color="#800000">$3CF</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$FC</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>M <font color="#FF0000"><b>AND </b></font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetModeNr<font color="#000080">(</font>Nr<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,nr
        int $10
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Set16Pal<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>I<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">];
     </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font><font color="#800000">$34</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font>Nr<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Init16Pal<font color="#000080">;
</font><font color="#FF0000"><b>VAR
   </b></font>I<font color="#000080">:</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>I<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$3DA</font><font color="#000080">];
     </font><font color="#FF0000"><b>FOR </b></font>I<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">15 </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font>I<font color="#000080">;
          </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font>I<font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font><font color="#800000">$10</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font><font color="#800000">$81</font><font color="#000080">;
     </font>Set16Pal<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Init13X<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     </b></font>MCGAOn<font color="#000080">;
     </font>Unchain<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>TextMode<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
     ASM
        </b></font><font color="#FF00FF">mov ax,3
        int 10h
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetLineRepeat<font color="#000080">(</font>Nr<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">9</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">]:=(</font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">)+</font>Nr<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetReadMap<font color="#000080">(</font>Map<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C4</font><font color="#000080">]:=</font><font color="#800000">4</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C5</font><font color="#000080">]:=</font>Map<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineH4<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Adresse<font color="#000080">:</font>LongInt<font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineH4X<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN
        ASM
           </b></font><font color="#FF00FF">mov ax,$a000
           mov es,ax
           mov ax,[bp+offset y1]
           mov bx,800
           mul bx
           add ax,[bp+offset x1]
           adc dx,0
           mov di,$3cd
           xchg di,ax
           xchg ax,dx
           or al,$40
           out dx,al
           mov bx,[bp+offset x1]
           mov dx,[bp+offset x2]
           inc dx
           mov cx,dx
           sub cx,bx
           shr cx,1
           mov al,[bp+offset c]
           mov ah,al
           ror bx,1
           jnb @2
           stosb
           ror dx,1
           jnb @3
           dec cx
   @3:     rol dx,1
   @2:     rep
           stosw
           ror dx,1
           jnb @4
           stosb
   @4:  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>Adresse<font color="#000080">:=</font>LongInt<font color="#000080">(</font>Y1<font color="#000080">)*</font><font color="#800000">800</font><font color="#000080">;
     </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Adresse<font color="#000080">+</font>X1<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">16</font><font color="#000080">&lt;&gt;(</font>Adresse<font color="#000080">+</font>X2<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">16 </font><font color="#FF0000"><b>THEN
     BEGIN
          </b></font>DrawLineH4X<font color="#000080">(</font>X1<font color="#000080">,</font><font color="#800000">65535</font><font color="#000080">-</font>Word<font color="#000080">(</font>Y1<font color="#000080">*</font><font color="#800000">800</font><font color="#000080">),</font>Y1<font color="#000080">,</font>C<font color="#000080">);
          </font>DrawLineH4X<font color="#000080">(</font>Word<font color="#000080">(-</font>Word<font color="#000080">(</font>Y1<font color="#000080">*</font><font color="#800000">800</font><font color="#000080">)),</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>C<font color="#000080">);
     </font><font color="#FF0000"><b>END
     ELSE </b></font>DrawLineH4X<font color="#000080">(</font>X1<font color="#000080">,</font>X2<font color="#000080">,</font>Y1<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineV4<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>VAR
   </b></font>Adresse<font color="#000080">:</font>LongInt<font color="#000080">;
   </font>Y<font color="#000080">:</font>Word<font color="#000080">;
   </font>A<font color="#000080">:</font>Byte<font color="#000080">;

   </font><font color="#FF0000"><b>PROCEDURE </b></font>DrawLineV4X<font color="#000080">(</font>X1<font color="#000080">,</font>Y1<font color="#000080">,</font>Y2<font color="#000080">:</font>Word<font color="#000080">; </font>C<font color="#000080">:</font>Byte<font color="#000080">);
   </font><font color="#FF0000"><b>BEGIN
        ASM
           </b></font><font color="#FF00FF">mov bx,[bp+offset x1]
           mov ax,[bp+offset y1]
           mov cx,800
           mul cx
           add ax,bx
           adc dx,0
           mov di,$3cd
           xchg di,ax
           xchg ax,dx
           or al,$40
           out dx,al
           mov dx,[bp+offset y2]
           mov cx,$a000
           mov es,cx
           mov cx,dx
           sub cx,[bp+offset y1]
           inc cx
           mov al,[bp+offset c]
           mov bx,799
   @2:     stosb
           add di,bx
           loop @2
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
     </b></font>Y<font color="#000080">:=</font>Y1<font color="#000080">;
     </font><font color="#FF0000"><b>WHILE </b></font><font color="#000080">(</font>LongInt<font color="#000080">(</font>Y<font color="#000080">)*</font><font color="#800000">800</font><font color="#000080">+</font>X1<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">16</font><font color="#000080">&lt;&gt;(</font>LongInt<font color="#000080">(</font>Y2<font color="#000080">)*</font><font color="#800000">800</font><font color="#000080">+</font>X1<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">16 </font><font color="#FF0000"><b>DO
     BEGIN
          </b></font>A<font color="#000080">:=(</font>LongInt<font color="#000080">(</font>Y<font color="#000080">)*</font><font color="#800000">800</font><font color="#000080">+</font>X1<font color="#000080">) </font><font color="#FF0000"><b>SHR </b></font><font color="#800000">16</font><font color="#000080">;
          </font>DrawLineV4X<font color="#000080">(</font>X1<font color="#000080">,</font>Y<font color="#000080">,(</font>LongInt<font color="#000080">(</font>A<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">65536</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">800</font><font color="#000080">,</font>C<font color="#000080">);
          </font>Y<font color="#000080">:=(</font>LongInt<font color="#000080">(</font>A<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">65536</font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">-</font>X1<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">800</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
     </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
     </font>DrawLineV4X<font color="#000080">(</font>X1<font color="#000080">,</font>Y<font color="#000080">,</font>Y2<font color="#000080">,</font>C<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SetHorizOfs<font color="#000080">(</font>Count<font color="#000080">:</font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
     </b></font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font><font color="#800000">$13</font><font color="#000080">;
     </font>Port<font color="#000080">[</font><font color="#800000">$3C0</font><font color="#000080">]:=</font>Count <font color="#FF0000"><b>SHL </b></font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{
PROCEDURE SetReg(Reg:Word; Index,Value:Byte);
VAR
   B:Byte;
BEGIN
     CASE Reg OF
          $3C0:BEGIN
                    B:=Port[$3DA];
                    Port[$3C0]:=Index OR $20;
}
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0290.PAS">Original</a><b>]</b></p></body>
</html>
