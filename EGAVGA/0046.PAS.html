<html>
<head><title> "VGA ClrScr #2" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{   The following Turbo Pascal Program displays HARDWARE SCROLLinG
   For 100% Compatible VGA cards,in mode $13.
   I'd be grateful if anyone interested
   could test this and report the results :
}

</i></font><font color="#FF0000"><b>Program </b></font>VGASLIDE<font color="#000080">; </font><font color="#008000"><i>{requirements TP6 or higher + register-Compatible VGA
}

</i></font><font color="#FF0000"><b>Uses </b></font>Crt<font color="#000080">;

</font><font color="#FF0000"><b>Var
  </b></font>t<font color="#000080">,</font>slide<font color="#000080">:</font>Word<font color="#000080">;
  </font>ch<font color="#000080">:</font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>VgaBase<font color="#000080">(</font>Xscroll<font color="#000080">,</font>Yscroll<font color="#000080">:</font>Integer<font color="#000080">);
  </font><font color="#FF0000"><b>Var </b></font>dum<font color="#000080">:</font>Byte<font color="#000080">;
 </font><font color="#FF0000"><b>begin
  </b></font>Dec<font color="#000080">(</font>SLIDE<font color="#000080">,(</font>Xscroll<font color="#000080">+</font><font color="#800000">320</font><font color="#000080">*</font>Yscroll<font color="#000080">));   </font><font color="#008000"><i>{ slide scrolling state         }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03d4</font><font color="#000080">]:=</font><font color="#800000">13</font><font color="#000080">;                    </font><font color="#008000"><i>{ LO register of VGAMEM offset  }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03d5</font><font color="#000080">]:=(</font>SLIDE <font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$FF</font><font color="#000080">; </font><font color="#008000"><i>{ use 8 bits:  [9..2]           }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03d4</font><font color="#000080">]:=</font><font color="#800000">12</font><font color="#000080">;                    </font><font color="#008000"><i>{ HI register of VGAMEM offset  }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03d5</font><font color="#000080">]:= </font>SLIDE <font color="#FF0000"><b>shr </b></font><font color="#800000">10</font><font color="#000080">;         </font><font color="#008000"><i>{ use 6 bits   [16..10]         }
  </i></font>Dum<font color="#000080">:=</font>Port<font color="#000080">[</font><font color="#800000">$03DA</font><font color="#000080">];                   </font><font color="#008000"><i>{ reset to input by dummy read  }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03C0</font><font color="#000080">]:=</font><font color="#800000">$20 </font><font color="#FF0000"><b>or </b></font><font color="#800000">$13</font><font color="#000080">;            </font><font color="#008000"><i>{ smooth pan = register $13     }
  </i></font>Port<font color="#000080">[</font><font color="#800000">$03C0</font><font color="#000080">]:=(</font>SLIDE <font color="#FF0000"><b>and </b></font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>Shl </b></font><font color="#800000">1</font><font color="#000080">;   </font><font color="#008000"><i>{ use bits [1..0], make it 0-2-4-6
}
 </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{main}

  </i></font><font color="#FF0000"><b>Asm                </b></font><font color="#008000"><i>{inITIALIZE vga mode $13 using BIOS}
  </i></font><font color="#FF00FF">MOV AX,00013h
  inT 010h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>SLIDE<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;

  </font><font color="#008000"><i>{ draw a quick test pattern directly to video memory }
  </i></font><font color="#FF0000"><b>For </b></font>T<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">63999 </font><font color="#FF0000"><b>do </b></font>MEM<font color="#000080">[</font><font color="#800000">$A000</font><font color="#000080">:</font>T<font color="#000080">]:=(</font>T <font color="#FF0000"><b>mod </b></font><font color="#000080">(</font><font color="#800000">317 </font><font color="#000080">+ </font>T <font color="#FF0000"><b>div </b></font><font color="#800000">10000</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#800000">255</font><font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   </b></font>Vgabase<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{ scroll smoothly in UPPER LEFT direction }
   </i></font>Delay<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
  </font>ch<font color="#000080">:=</font>ReadKey<font color="#000080">;

  </font><font color="#FF0000"><b>Repeat
   </b></font>Vgabase<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);  </font><font color="#008000"><i>{ scroll smoothly in LOWER RIGHT direction }
   </i></font>Delay<font color="#000080">(</font><font color="#800000">14</font><font color="#000080">);
  </font><font color="#FF0000"><b>Until </b></font>KeyPressed<font color="#000080">;
  </font>ch<font color="#000080">:=</font>ReadKey<font color="#000080">;

  </font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">MOV AX,00003h   </font><font color="#008000"><i>{reset to Textmode}
  </i></font><font color="#FF00FF">inT 010h
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to EGAVGA SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0046.PAS">Original</a><b>]</b></p></body>
</html>
