<html>
<head><title> "Save/Retrieve Fontstyle/Fontcolor in INI" by JENS SCHUMANN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0248.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Anyone with a code snippet to save/retrieve FontStyle and FontColor
in an INI file ?

Hey Dick here are some code snippets from me.

regards
:-) Jens
Germany/Gerdau

------------------------------------------------------------------------
Here is a section from my Unit with constants

     DefaultMemoFontColor       =clBlack;
     DefaultMemoFontSize        =10;
     DefaultMemoFontName      ='Arial';
     DefaultMemoFontStyle       =0;
{           0                 Standart
            1    fsBold        Die Schriftart wird fett dargestellt.
            2    fsItalic          Die Schriftart wird kursiv dargestellt.
            3    fsUnderline  Die Schriftart wird unterstrichen dargestellt.
            4    fsStrikeout    Die Schriftart wird durchgestrichen
dargestellt.}
</i></font><font color="#000080">--------------------------------------------------------------------------------
----------------------------------------------------

</font>This section reads the Fontstyle from the infile
It<font color="#800000">'s called during Form1.Create

 </font><font color="#008000"><i>{Lese Schriftart}
  </i></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Color<font color="#000080">:=</font>Ini<font color="#000080">.</font>ReadInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Farbe'</font><font color="#000080">,</font>DefaultMemoFontColor<font color="#000080">);
  </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">:=</font>Ini<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Name'</font><font color="#000080">,</font>DefaultMemoFontName<font color="#000080">);
  </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">:=</font>Ini<font color="#000080">.</font>ReadInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Grv_e'</font><font color="#000080">,</font>DefaultMemoFontSize<font color="#000080">);
  </font><font color="#FF0000"><b>Case </b></font>Ini<font color="#000080">.</font>ReadInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font>DefaultMemoFontStyle<font color="#000080">) </font><font color="#FF0000"><b>of
     </b></font><font color="#800000">0 </font><font color="#000080">: </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[];
     </font><font color="#800000">1 </font><font color="#000080">: </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[</font>fsBold<font color="#000080">];
     </font><font color="#800000">2 </font><font color="#000080">: </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[</font>fsItalic<font color="#000080">];
     </font><font color="#800000">3 </font><font color="#000080">: </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[</font>fsUnderline<font color="#000080">];
     </font><font color="#800000">4 </font><font color="#000080">: </font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[</font>fsStrikeout<font color="#000080">];
     </font><font color="#FF0000"><b>else
       </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">:=[];
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Case}
</i></font><font color="#000080">--------------------------------------------------------------------------------
----------------------------------------------------
  </font><font color="#008000"><i>{Write Fontstyle}
  </i></font>This Codesection <font color="#FF0000"><b>is </b></font>called during the close<font color="#000080">-</font>event from Form1<font color="#000080">.
  </font>Ini<font color="#000080">:=</font>TIniFile<font color="#000080">.</font>Create<font color="#000080">(</font>BAQIniFile<font color="#000080">);
  </font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Farbe'</font><font color="#000080">,</font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Color<font color="#000080">);
  </font>Ini<font color="#000080">.</font>WriteString<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Name'</font><font color="#000080">,</font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">);
  </font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Grv_e'</font><font color="#000080">,</font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">=[] </font><font color="#FF0000"><b>then
    </b></font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">=[</font>fsBold<font color="#000080">] </font><font color="#FF0000"><b>then
    </b></font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">=[</font>fsItalic<font color="#000080">] </font><font color="#FF0000"><b>then
    </b></font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">=[</font>fsUnderline<font color="#000080">] </font><font color="#FF0000"><b>then
    </b></font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Memo<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">=[</font>fsStrikeout<font color="#000080">] </font><font color="#FF0000"><b>then
    </b></font>Ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font><font color="#800000">'Schriftart'</font><font color="#000080">,</font><font color="#800000">'Style'</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
  </font>Ini<font color="#000080">.</font>Free<font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0248.PAS">Original</a><b>]</b></p></body>
</html>
