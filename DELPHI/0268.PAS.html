<html>
<head><title> "Your own "runtime" object inspector" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0268.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">We all like the <font color="#000080">&quot;</font><font color="#FF0000"><b>Object </b></font>Inspector<font color="#000080">&quot; </font><font color="#FF0000"><b>for </b></font>its ease <font color="#FF0000"><b>of </b></font>use <font color="#FF0000"><b>and </b></font>all the
information it can provide<font color="#000080">. </font>Wouldn<font color="#800000">'t it be great to have your own possibly
</font>non<font color="#000080">-</font>visual <font color="#FF0000"><b>object </b></font>inspector available at run time<font color="#000080">? -- </font>so you can find <font color="#FF0000"><b>out
</b></font>which properties <font color="#FF0000"><b>and </b></font>methods a given <font color="#FF0000"><b>object </b></font><font color="#000080">(</font><font color="#FF0000"><b>or </b></font>component<font color="#000080">) </font>may have <font color="#FF0000"><b>and
</b></font>what <font color="#FF0000"><b>type </b></font>these properties are<font color="#000080">. </font><font color="#FF0000"><b>Try </b></font>the following <font color="#FF0000"><b>function</b></font><font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>ObjectInspector<font color="#000080">(
  </font>Obj   <font color="#000080">: </font>TObject<font color="#000080">;
  </font>Items <font color="#000080">: </font>TStrings <font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>n        <font color="#000080">: </font>integer<font color="#000080">;
  </font>PropList <font color="#000080">: </font>TPropList<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>n <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>GetPropList<font color="#000080">(
    </font>Obj<font color="#000080">.</font>ClassInfo<font color="#000080">,
    </font>tkProperties <font color="#000080">+ [ </font>tkMethod <font color="#000080">],
    @</font>PropList <font color="#000080">);
  </font><font color="#FF0000"><b>while</b></font><font color="#000080">( (</font><font color="#FF0000"><b>Nil </b></font><font color="#000080">&lt;&gt; </font>PropList<font color="#000080">[ </font>n <font color="#000080">]) </font><font color="#FF0000"><b>and
         </b></font><font color="#000080">(</font>n <font color="#000080">&lt; </font>High<font color="#000080">(</font>PropList<font color="#000080">)) ) </font><font color="#FF0000"><b>do
  begin
    </b></font>Items<font color="#000080">.</font>Add<font color="#000080">(
      </font>PropList<font color="#000080">[ </font>n <font color="#000080">].</font>Name <font color="#000080">+ </font><font color="#800000">': '  </font><font color="#000080">+
      </font>PropList<font color="#000080">[ </font>n <font color="#000080">].</font>PropType<font color="#000080">.</font>Name <font color="#000080">);
    </font>Inc<font color="#000080">( </font>n <font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>let<font color="#800000">'s say you want to get information about a listbox named
</font>ListBox1 <font color="#FF0000"><b>and then </b></font>store the information <font color="#FF0000"><b>in </b></font>the same ListBox1<font color="#000080">:

</font>ObjectInspector<font color="#000080">( </font>ListBox1<font color="#000080">, </font>ListBox1<font color="#000080">.</font>Items <font color="#000080">);
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0268.PAS">Original</a><b>]</b></p></body>
</html>
