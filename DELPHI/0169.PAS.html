<html>
<head><title> "Icon on the notify area of the taskbar" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>notify<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>ExtCtrls<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>shellApi<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Button2<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Button3<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Image1<font color="#000080">: </font>TImage<font color="#000080">;
    </font>Timer1<font color="#000080">: </font>TTimer<font color="#000080">;
    </font>Image2<font color="#000080">: </font>TImage<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Timer1Timer<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FormClose<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Action<font color="#000080">: </font>TCloseAction<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;
  </font>MyNotifyStruct<font color="#000080">: </font>TNotifyIconData<font color="#000080">;
</font><font color="#008000"><i>{ // Here is the structure info from ShellAPI.pas:
  type
    PNotifyIconDataA = ^TNotifyIconDataA;
    PNotifyIconDataW = ^TNotifyIconDataW;
    PNotifyIconData = PNotifyIconDataA;
    TNotifyIconDataA = record
      cbSize: DWORD;
      Wnd: HWND;
      uID: UINT;
      uFlags: UINT;
      uCallbackMessage: UINT;
      hIcon: HICON;
      szTip: array [0..63] of AnsiChar;
    end;
    TNotifyIconDataW = record
      cbSize: DWORD;
      Wnd: HWND;
      uID: UINT;
      uFlags: UINT;
      uCallbackMessage: UINT;
      hIcon: HICON;
      szTip: array [0..63] of WideChar;
    end;
    TNotifyIconData = TNotifyIconDataA;
}
</i></font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$R *.DFM}
</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>MyNotifyStruct <font color="#FF0000"><b>do begin
    </b></font>cbSize<font color="#000080">:= </font>sizeof<font color="#000080">(</font>MyNotifyStruct<font color="#000080">);
    </font>Wnd<font color="#000080">:= </font>form1<font color="#000080">.</font>handle<font color="#000080">;
    </font>uID<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>uFlags<font color="#000080">:=  </font>NIF_ICON <font color="#FF0000"><b>or </b></font>NIF_TIP<font color="#000080">;
    </font>hIcon<font color="#000080">:= </font>Image1<font color="#000080">.</font>picture<font color="#000080">.</font>icon<font color="#000080">.</font>handle<font color="#000080">;
    </font>szTip<font color="#000080">:= </font><font color="#800000">'Hello Lloyd'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Shell_NotifyIcon<font color="#000080">(</font>NIM_ADD<font color="#000080">, @</font>MyNotifyStruct<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Shell_NotifyIcon<font color="#000080">(</font>NIM_Delete<font color="#000080">, @</font>MyNotifyStruct<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Timer1Timer<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>StrPCopy<font color="#000080">(</font>MyNotifyStruct<font color="#000080">.</font>szTip<font color="#000080">,</font>TimetoStr<font color="#000080">(</font>Time<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>MyNotifyStruct<font color="#000080">.</font>hIcon <font color="#000080">= </font>image1<font color="#000080">.</font>picture<font color="#000080">.</font>icon<font color="#000080">.</font>handle<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>MyNotifyStruct<font color="#000080">.</font>hIcon<font color="#000080">:= </font>image2<font color="#000080">.</font>picture<font color="#000080">.</font>icon<font color="#000080">.</font>handle
  <font color="#FF0000"><b>else
     </b></font>MyNotifyStruct<font color="#000080">.</font>hIcon<font color="#000080">:= </font>image1<font color="#000080">.</font>picture<font color="#000080">.</font>icon<font color="#000080">.</font>handle<font color="#000080">;

  </font>Shell_NotifyIcon<font color="#000080">(</font>NIM_Modify<font color="#000080">, @</font>MyNotifyStruct<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormClose<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Action<font color="#000080">: </font>TCloseAction<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Shell_NotifyIcon<font color="#000080">(</font>NIM_Delete<font color="#000080">, @</font>MyNotifyStruct<font color="#000080">); </font><font color="#008000"><i>// clean up
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ DFM file }
</i></font><font color="#FF0000"><b>object </b></font>Form1<font color="#000080">: </font>TForm1
  Left <font color="#000080">= </font><font color="#800000">331
  </font>Top <font color="#000080">= </font><font color="#800000">141
  </font>Width <font color="#000080">= </font><font color="#800000">435
  </font>Height <font color="#000080">= </font><font color="#800000">300
  </font>Caption <font color="#000080">= </font><font color="#800000">'Form1'
  </font>Font<font color="#000080">.</font>Color <font color="#000080">= </font>clWindowText
  Font<font color="#000080">.</font>Height <font color="#000080">= -</font><font color="#800000">11
  </font>Font<font color="#000080">.</font>Name <font color="#000080">= </font><font color="#800000">'MS Sans Serif'
  </font>Font<font color="#000080">.</font>Style <font color="#000080">= []
  </font>OnClose <font color="#000080">= </font>FormClose
  PixelsPerInch <font color="#000080">= </font><font color="#800000">96
  </font>TextHeight <font color="#000080">= </font><font color="#800000">13
  </font><font color="#FF0000"><b>object </b></font>Image1<font color="#000080">: </font>TImage
    Left <font color="#000080">= </font><font color="#800000">249
    </font>Top <font color="#000080">= </font><font color="#800000">39
    </font>Width <font color="#000080">= </font><font color="#800000">34
    </font>Height <font color="#000080">= </font><font color="#800000">31
    </font>Picture<font color="#000080">.</font>Data <font color="#000080">= </font><font color="#008000"><i>{
      055449636F6E0000010001002020100000000000E80200001600000028000000
      2000000040000000010004000000000080020000000000000000000000000000
      0000000000000000000080000080000000808000800000008000800080800000
      80808000C0C0C0000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000
      FFFFFF00999999999999999999999999999999999FFFFFFFFFFFFF8888888888
      8FFFFFF997FFFFFFFFFF888888888888888FFFF9977FFFFFFFF8444C44488888
      8888FFF99777FFFFFF4444444444488888888FF997777FFF44444C4C4C4C4C48
      888888F9977777F44444443444444444888888F99777774C444C433C4C4C4C4C
      48888889977774444444C334C444C444C48888899777744C4C4C433C4C4C4C4C
      4C8888899777444444C43334CCC4C4C4C44888899777444C4C43333C4C4C4C4C
      4C38888997744444C4433333CCCCC4CCC433888997744C4C4C4333333C4C4C4C
      4C33888997744444C43333333CCCCCCCC43388899774444C4C333333CC4CCC4C
      4C33888997744444C433333CCCCCCCC33333888997744C4C4C334C4C4CCCCCC3
      33338889977444444433CCCC3CCCCCC3333388F99777444C4C433C433C4CCC4C
      333888F997774444343333333CCCCCCCC4C88FF99777744C333333333C4C4C43
      3C88FFF997777444333333333CCCCCC3348FFFF99777774C333333333C4C3C43
      3FFFFFF997777774333333C333CC3433FFFFFFF9977777774333334C333C4C37
      7FFFFFF9977777777744433444C4477777FFFFF99777777777774C4C4C477777
      777FFFF99777777777777777777777777777FFF9977777777777777777777777
      77777FF9977777777777777777777777777777F9999999999999999999999999
      9999999900000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000}
    </i></font>Visible <font color="#000080">= </font>False
  <font color="#FF0000"><b>end
  object </b></font>Image2<font color="#000080">: </font>TImage
    Left <font color="#000080">= </font><font color="#800000">249
    </font>Top <font color="#000080">= </font><font color="#800000">81
    </font>Width <font color="#000080">= </font><font color="#800000">34
    </font>Height <font color="#000080">= </font><font color="#800000">37
    </font>Picture<font color="#000080">.</font>Data <font color="#000080">= </font><font color="#008000"><i>{
      055449636F6E0000010001002020100000000000E80200001600000028000000
      2000000040000000010004000000000080020000000000000000000000000000
      0000000000000000000080000080000000808000800000008000800080800000
      80808000C0C0C0000000FF0000FF000000FFFF00FF000000FF00FF00FFFF0000
      FFFFFF0000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000330000000000000000000000033303303303300
      0000000000000003303330333003003300000000000000033003330330002333
      0000000000000030000033003033333000000000000033333330000003330003
      33000000080333333333333333300233330000000F033333333333333302333B
      B03000004F8333333333333333333BB003BB00004FF3333333333333B33BB003
      3BBB00004FF333333333B3BB3BB0033BBBB000004FF83B333B3B3B3BBBB03BBB
      BB0300F04FFF33B3B3B3BBBBBBBBBBBB00330FF04FFF8B3B3333BBBBBBBBBB00
      33330FF044FFF8BBB03033BBBBB330333330FFF444FFF8BB0BB3003B33000333
      3330FF44444FF88B3BBB300000033333B33FFF44444FFF3BB0BBB3000333B33B
      B38FF4444444FF003B0BB333333BBBBBB3FFF44444444FF00030BBBBBBBBBBBB
      BBFF444444440000000303BBB3300000BFF44444440000000000000000000000
      0FF4444400000000000000000000000000444444000000000000000000000000
      0000444400000000000000000000000000000444000000000000000000000000
      0000000400000000000000000000000000000000000000000000000000000000
      00000000FFFFFFFFFFFFFFFFFFFF1FFFFF8003FFFC0000FFF800007FF800007F
      E000003F0000001F0000001F0000000F00000007000000070000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000C000000FE01F003FFFFF80FFFFFFC0FFFFFFF0FFFFFFF8FFFFFFFE
      FFFFFFFF}
    </i></font>Visible <font color="#000080">= </font>False
  <font color="#FF0000"><b>end
  object </b></font>Button1<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">15
    </font>Top <font color="#000080">= </font><font color="#800000">36
    </font>Width <font color="#000080">= </font><font color="#800000">124
    </font>Height <font color="#000080">= </font><font color="#800000">34
    </font>Caption <font color="#000080">= </font><font color="#800000">'Add Icon To TaskBar'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">0
    </font>OnClick <font color="#000080">= </font>Button1Click
  <font color="#FF0000"><b>end
  object </b></font>Button2<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">12
    </font>Top <font color="#000080">= </font><font color="#800000">96
    </font>Width <font color="#000080">= </font><font color="#800000">127
    </font>Height <font color="#000080">= </font><font color="#800000">34
    </font>Caption <font color="#000080">= </font><font color="#800000">'Delete Icon from TaskBar'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">1
    </font>OnClick <font color="#000080">= </font>Button2Click
  <font color="#FF0000"><b>end
  object </b></font>Button3<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">12
    </font>Top <font color="#000080">= </font><font color="#800000">159
    </font>Width <font color="#000080">= </font><font color="#800000">130
    </font>Height <font color="#000080">= </font><font color="#800000">31
    </font>Caption <font color="#000080">= </font><font color="#800000">'ModifyIcon on TaskBar'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">2
  </font><font color="#FF0000"><b>end
  object </b></font>Timer1<font color="#000080">: </font>TTimer
    Interval <font color="#000080">= </font><font color="#800000">500
    </font>OnTimer <font color="#000080">= </font>Timer1Timer
    Left <font color="#000080">= </font><font color="#800000">375
    </font>Top <font color="#000080">= </font><font color="#800000">21
  </font><font color="#FF0000"><b>end
end
</b></font><font color="#008000"><i>{ DPR file }
</i></font><font color="#FF0000"><b>program </b></font>taskbar<font color="#000080">;
</font><font color="#FF0000"><b>uses
  </b></font>Forms<font color="#000080">,
  </font>notify <font color="#FF0000"><b>in </b></font><font color="#800000">'notify.pas' </font><font color="#008000"><i>{Form1}</i></font><font color="#000080">;
</font><font color="#008000"><i>{$R *.RES}
</i></font><font color="#FF0000"><b>begin
  </b></font>Application<font color="#000080">.</font>CreateForm<font color="#000080">(</font>TForm1<font color="#000080">, </font>Form1<font color="#000080">);
  </font>Application<font color="#000080">.</font>Run<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0169.PAS">Original</a><b>]</b></p></body>
</html>
