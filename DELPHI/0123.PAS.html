<html>
<head><title> "How to Populate a TDBComboBox Or TDBList" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0123.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Filling dblistboxs <font color="#FF0000"><b>and </b></font>dbcomboboxs

Most <font color="#FF0000"><b>of </b></font>Delphi<font color="#800000">'s data aware components will  populate 
</font>themselves after they are wired up <font color="#FF0000"><b>to </b></font>a open dataset<font color="#000080">.  </font>However 
DbListboxs <font color="#FF0000"><b>and </b></font>DbComboboxs <font color="#FF0000"><b>do not </b></font>display this characteristic<font color="#000080">.  
</font>These two components are <font color="#FF0000"><b>not for </b></font>displaying your datasets<font color="#000080">, </font>but 
filling them<font color="#000080">.  </font>Use <font color="#FF0000"><b>of </b></font>these components <font color="#FF0000"><b>is </b></font>straight <font color="#FF0000"><b>forward</b></font><font color="#000080">.  
</font>When you update your table<font color="#000080">, </font>the value <font color="#FF0000"><b>of </b></font>the DbListbox <font color="#FF0000"><b>or 
</b></font>DbCombobox will be posted <font color="#FF0000"><b>in </b></font>the appropriate field<font color="#000080">.

</font>Filling the DbCombobox <font color="#FF0000"><b>or </b></font>DbListbox the same <font color="#FF0000"><b>as </b></font>filling normal 
comboboxs <font color="#FF0000"><b>or </b></font>listboxes<font color="#000080">.  </font>The lines <font color="#FF0000"><b>of </b></font>text <font color="#FF0000"><b>in </b></font>a listbox <font color="#FF0000"><b>or 
</b></font>combobox are really a tstring list<font color="#000080">.  </font>The <font color="#000080">&quot;</font>Items<font color="#000080">&quot; </font><font color="#FF0000"><b>property of 
</b></font>the given component holds this list<font color="#000080">.  </font>Use the <font color="#000080">&quot;</font>Add<font color="#000080">&quot; </font>method <font color="#FF0000"><b>for 
</b></font>adding items <font color="#FF0000"><b>to </b></font>a tstring<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you want <font color="#FF0000"><b>to </b></font>use data  types other 
than strings they must be converted at run time<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>your list 
has a blank line at the <font color="#FF0000"><b>end</b></font><font color="#000080">, </font>consider setting the 
<font color="#000080">&quot;</font>IntegralHeight<font color="#000080">&quot; </font><font color="#FF0000"><b>property to </b></font>True<font color="#000080">.


</font>Filling a DbListbox <font color="#FF0000"><b>with </b></font><font color="#800000">4 </font>lines programmatically might look 
similar <font color="#FF0000"><b>to </b></font>this<font color="#000080">:

     </font>DbListbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font><font color="#800000">'line one'</font><font color="#000080">);
     </font>DbListbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font><font color="#800000">'line two'</font><font color="#000080">);
     </font>DbListbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font><font color="#800000">'line three'</font><font color="#000080">);
     </font>DbListbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font><font color="#800000">'line four'</font><font color="#000080">);

</font>Filling a DbListbox at design time <font color="#FF0000"><b>requires </b></font>using the <font color="#FF0000"><b>object 
</b></font>inspector<font color="#000080">.  </font>By double clicking <font color="#FF0000"><b>on </b></font>the components <font color="#000080">&quot;</font>Items<font color="#000080">&quot; 
</font><font color="#FF0000"><b>property</b></font><font color="#000080">, </font>you can bring up the <font color="#000080">&quot;</font><font color="#FF0000"><b>String </b></font>List Editor<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font>input 
the desired rows<font color="#000080">.

</font>Unfortunately<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>a combobox <font color="#FF0000"><b>is </b></font>filled this way<font color="#000080">, </font>there <font color="#FF0000"><b>is not 
default </b></font>value<font color="#000080">.  </font>Setting a DbComboboxs <font color="#000080">&quot;</font>text<font color="#000080">&quot; </font><font color="#FF0000"><b>property </b></font>will 
achieve this result<font color="#000080">.  (</font>the <font color="#000080">&quot;</font>text<font color="#000080">&quot; </font><font color="#FF0000"><b>property is not </b></font>available <font color="#FF0000"><b>in 
</b></font>the <font color="#FF0000"><b>object </b></font>inspector<font color="#000080">, </font>so it must be <font color="#FF0000"><b>set </b></font>programmatically<font color="#000080">).
</font>Setting the <font color="#FF0000"><b>default </b></font>value <font color="#FF0000"><b>to </b></font>the first value <font color="#FF0000"><b>in </b></font>the
DbCombobox<font color="#800000">'s list looks like this:

</font>DbCombobox1<font color="#000080">.</font>text <font color="#000080">:= </font>DbCombobox1<font color="#000080">.</font>items<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">];

</font>Often it <font color="#FF0000"><b>is </b></font>useful <font color="#FF0000"><b>to </b></font>fill a DBListBox from a dataset<font color="#000080">.  </font>This 
can be done using loop<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>table2 <font color="#FF0000"><b>do begin
    </b></font>open<font color="#000080">;
    </font><font color="#FF0000"><b>while not </b></font>EOF <font color="#FF0000"><b>do
    begin
      </b></font>DBlistbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font>FieldByName<font color="#000080">(</font><font color="#800000">'name'</font><font color="#000080">).</font>AsString<font color="#000080">); 
      </font>next<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0123.PAS">Original</a><b>]</b></p></body>
</html>
