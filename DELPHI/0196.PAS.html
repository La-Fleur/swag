<html>
<head><title> "Making your Delphi apps show minimized" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0196.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Q<font color="#000080">: </font>When I select the <font color="#000080">&quot;</font>Run Minimized<font color="#000080">&quot; </font>option <font color="#FF0000"><b>in Program </b></font>Manager
   <font color="#FF0000"><b>to </b></font>attempt <font color="#FF0000"><b>to </b></font>make my Delphi application execute <font color="#FF0000"><b>in </b></font>a minimized
   state<font color="#000080">, </font>the Delphi application seems <font color="#FF0000"><b>to </b></font>ignore the setting <font color="#FF0000"><b>and
   </b></font>run normally<font color="#000080">. </font>Why <font color="#FF0000"><b>is </b></font>this<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>how <font color="#FF0000"><b>to </b></font>I fix it<font color="#000080">?

</font>A<font color="#000080">: </font>Delphi<font color="#800000">'s Application object creates a hidden &quot;application
   </font>window<font color="#000080">,&quot; </font><font color="#FF0000"><b>and </b></font>it <font color="#FF0000"><b>is </b></font>that window<font color="#000080">, </font>rather than your main form<font color="#000080">,
   </font>that <font color="#FF0000"><b>is </b></font>being sent the command <font color="#FF0000"><b>to </b></font>show minimized<font color="#000080">. </font><font color="#FF0000"><b>To </b></font>fix this<font color="#000080">,
   </font>make your main form<font color="#800000">'s OnCreate event handler look like this:

      </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
      </font><font color="#008000"><i>{$IFDEF WIN32}           { Delphi 2.0 (32 bit) }
      </i></font><font color="#FF0000"><b>var
        </b></font>MyInfo<font color="#000080">: </font>TStartUpInfo<font color="#000080">;
      </font><font color="#008000"><i>{$ENDIF}
      </i></font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{$IFDEF WIN32}           { Delphi 2.0 (32 bit) }
        </i></font>GetStartUpInfo<font color="#000080">(</font>MyInfo<font color="#000080">);
        </font>ShowWindow<font color="#000080">(</font>Handle<font color="#000080">, </font>MyInfo<font color="#000080">.</font>wShowWindow<font color="#000080">);
      </font><font color="#008000"><i>{$ENDIF}
      {$IFDEF WINDOWS}         { Delphi 1.0 (16 bit) }
        </i></font>ShowWindow<font color="#000080">(</font>Handle<font color="#000080">, </font>cmdShow<font color="#000080">);
      </font><font color="#008000"><i>{$ENDIF}
      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>In </b></font>other words<font color="#000080">, </font><font color="#FF0000"><b>for </b></font><font color="#800000">16 </font>bits<font color="#000080">, </font>just pass cmdShow <font color="#FF0000"><b>to </b></font>ShowWindow<font color="#000080">.
   </font><font color="#FF0000"><b>For </b></font><font color="#800000">32 </font>bits you need <font color="#FF0000"><b>to </b></font>obtain the start up info by calling the
   GetStartUpInfo <font color="#FF0000"><b>procedure</b></font><font color="#000080">, </font>which fills <font color="#FF0000"><b>in </b></font>a TStartUpInfo <font color="#FF0000"><b>record</b></font><font color="#000080">,
   </font><font color="#FF0000"><b>and then </b></font>pass TStartUpInfo<font color="#000080">.</font>wShowWindow <font color="#FF0000"><b>to </b></font>ShowWindow<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0196.PAS">Original</a><b>]</b></p></body>
</html>
