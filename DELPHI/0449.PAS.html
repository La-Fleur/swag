<html>
<head><title> "How to get Paper Source?" by JOE C. HECHT</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0449.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#800000">'Joe C. Hecht' </font><font color="#000080">&lt;</font>jhecht<font color="#000080">@</font>wpo<font color="#000080">.</font>borland<font color="#000080">.</font>com<font color="#000080">&gt;

</font>Below are some code snippets <font color="#FF0000"><b>to </b></font>change the printer settings<font color="#000080">.
</font>Wherever the changes are made<font color="#000080">, </font>you could instead examine the printer
settings<font color="#000080">. </font>See the documentation <font color="#FF0000"><b>for </b></font>ExtDeviceMode <font color="#FF0000"><b>and </b></font>the TDEVMODE
structure <font color="#FF0000"><b>as </b></font>well the printer escape GETSETPAPERBINS <font color="#FF0000"><b>and </b></font>GetDeviceCaps<font color="#000080">().

*********************************************
</font>One way <font color="#FF0000"><b>to </b></font>change printer settings at the start <font color="#FF0000"><b>of </b></font>a print job <font color="#FF0000"><b>is to
</b></font>change the printers devicemode<font color="#000080">.

</font>Example<font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>var
</b></font>Device <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>Driver <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>Port   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font>hDMode <font color="#000080">: </font>THandle<font color="#000080">;
</font>PDMode <font color="#000080">: </font>PDEVMODE<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Printer<font color="#000080">.</font>PrinterIndex <font color="#000080">:= </font>Printer<font color="#000080">.</font>PrinterIndex<font color="#000080">;
  </font>Printer<font color="#000080">.</font>GetPrinter<font color="#000080">(</font>Device<font color="#000080">, </font>Driver<font color="#000080">, </font>Port<font color="#000080">, </font>hDMode<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>hDMode <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
    </b></font>pDMode <font color="#000080">:= </font>GlobalLock<font color="#000080">(</font>hDMode<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>pDMode <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then begin
      </b></font>pDMode<font color="#000080">^.</font>dmFields <font color="#000080">:= </font>pDMode<font color="#000080">^.</font>dmFields <font color="#FF0000"><b>or </b></font>DM_COPIES<font color="#000080">;
      </font>pDMode<font color="#000080">^.</font>dmCopies <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
      </font>GlobalUnlock<font color="#000080">(</font>hDMode<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>GlobalFree<font color="#000080">(</font>hDMode<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Printer<font color="#000080">.</font>PrinterIndex <font color="#000080">:= </font>Printer<font color="#000080">.</font>PrinterIndex<font color="#000080">;
  </font>Printer<font color="#000080">.</font>BeginDoc<font color="#000080">;
  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextOut<font color="#000080">(</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">, </font><font color="#800000">'Test 1'</font><font color="#000080">);
  </font>Printer<font color="#000080">.</font>EndDoc<font color="#000080">;

--------------------------------------------------------------------------------

</font>Another way <font color="#FF0000"><b>is to </b></font>change TPrinter<font color="#000080">. </font>This will enable you <font color="#FF0000"><b>to </b></font>change
settings <font color="#FF0000"><b>in </b></font>mid job<font color="#000080">. </font>You must make the change <font color="#000080">&gt;&gt;&gt;</font>between<font color="#000080">&lt;&lt;&lt; </font>pages<font color="#000080">.

</font><font color="#FF0000"><b>To do </b></font>this<font color="#000080">:

</font>Before every startpage<font color="#000080">() </font>command <font color="#FF0000"><b>in </b></font>printers<font color="#000080">.</font>pas <font color="#FF0000"><b>in </b></font>the Source<font color="#000080">\</font>VCL
directory add something like<font color="#000080">:


--------------------------------------------------------------------------------

 </font>DevMode<font color="#000080">.</font>dmPaperSize<font color="#000080">:=</font>DMPAPER_LEGAL
<font color="#008000"><i>{any other devicemode settings go here}
 </i></font>Windows<font color="#000080">.</font>ResetDc<font color="#000080">(</font>dc<font color="#000080">,</font>Devmode<font color="#000080">^);

--------------------------------------------------------------------------------

</font>This will reset the pagesize<font color="#000080">. </font>you can look up DEVMODE <font color="#FF0000"><b>in </b></font>the help <font color="#FF0000"><b>to
</b></font>find other paper sizes<font color="#000080">.

</font>You will need <font color="#FF0000"><b>to </b></font>rebuild the vcl source <font color="#FF0000"><b>for </b></font>this <font color="#FF0000"><b>to </b></font>work<font color="#000080">, </font>by adding the
path <font color="#FF0000"><b>to </b></font>the VCL source directory <font color="#FF0000"><b>to </b></font>the beginning <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>library
</b></font>path s tatement under tools<font color="#000080">..</font>options<font color="#000080">.. </font><font color="#FF0000"><b>library</b></font><font color="#000080">...</font>libaray path<font color="#000080">.
</font>Quit Delphi <font color="#FF0000"><b>then do </b></font>a build all<font color="#000080">.

</font>Another quick note<font color="#000080">...

</font>When changing printers<font color="#000080">, </font>be aware that fontsizes may <font color="#FF0000"><b>not </b></font>always scale
properly<font color="#000080">. </font><font color="#FF0000"><b>To </b></font>ensure proper scaling <font color="#FF0000"><b>set </b></font>the PixelsPerInch <font color="#FF0000"><b>property of
</b></font>the font<font color="#000080">.

</font>Here are two examples<font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>uses </b></font>Printers<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>MyFile<font color="#000080">: </font>TextFile<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AssignPrn<font color="#000080">(</font>MyFile<font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>MyFile<font color="#000080">);

  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'Courier New'</font><font color="#000080">;
  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Style <font color="#000080">:= [</font>fsBold<font color="#000080">];
  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>PixelsPerInch<font color="#000080">:=
    </font>GetDeviceCaps<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>LOGPIXELSY<font color="#000080">);

  </font>Writeln<font color="#000080">(</font>MyFile<font color="#000080">, </font><font color="#800000">'Print this text'</font><font color="#000080">);

  </font>System<font color="#000080">.</font>CloseFile<font color="#000080">(</font>MyFile<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>uses </b></font>Printers<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Printer<font color="#000080">.</font>BeginDoc<font color="#000080">;
  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'Courier New'</font><font color="#000080">;
  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Style <font color="#000080">:= [</font>fsBold<font color="#000080">];

  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>PixelsPerInch<font color="#000080">:=
    </font>GetDeviceCaps<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>LOGPIXELSY<font color="#000080">);

  </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Textout<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">'Print this text'</font><font color="#000080">);

  </font>Printer<font color="#000080">.</font>EndDoc<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0449.PAS">Original</a><b>]</b></p></body>
</html>
