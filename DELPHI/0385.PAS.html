<html>
<head><title> "Object Caption" by RORY DAULTON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0385.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Pedro<font color="#000080">,

</font><font color="#FF0000"><b>If </b></font>I understand you correctly<font color="#000080">, </font>you want <font color="#FF0000"><b>to </b></font>be able <font color="#FF0000"><b>to </b></font>access <font color="#000080">(</font><font color="#FF0000"><b>and </b></font>show<font color="#000080">) </font>the
caption <font color="#FF0000"><b>of </b></font>ANY control<font color="#000080">, </font>regardless <font color="#FF0000"><b>of </b></font>its <font color="#FF0000"><b>type</b></font><font color="#000080">, </font>whether <font color="#FF0000"><b>is is </b></font>a TButton<font color="#000080">,
</font>TForm<font color="#000080">, </font>TLabel<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>so <font color="#FF0000"><b>on</b></font><font color="#000080">.  </font><font color="#FF0000"><b>Is </b></font>that right<font color="#000080">?

</font><font color="#FF0000"><b>If </b></font>so<font color="#000080">, </font>the difficulty <font color="#FF0000"><b>is </b></font>this<font color="#000080">: </font>although all descendants <font color="#FF0000"><b>of </b></font>TControl have a
Caption <font color="#FF0000"><b>property</b></font><font color="#000080">, </font>within TControl <font color="#FF0000"><b>and </b></font>some <font color="#FF0000"><b>of </b></font>its descendants the <font color="#FF0000"><b>property
is protected</b></font><font color="#000080">, </font>rather than <font color="#FF0000"><b>public or published</b></font><font color="#000080">.  </font>So<font color="#000080">, </font>trying
TControl<font color="#000080">(</font>Sender<font color="#000080">).</font>Caption gives you an error<font color="#000080">.  </font>Here <font color="#FF0000"><b>is </b></font>a trick<font color="#000080">, </font>though<font color="#000080">, </font><font color="#FF0000"><b>to
</b></font>access that Caption <font color="#FF0000"><b>property</b></font><font color="#000080">.

</font>Add this <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>implementation </b></font>section <font color="#FF0000"><b>of </b></font>your <font color="#FF0000"><b>unit</b></font><font color="#000080">:

</font><font color="#FF0000"><b>type
  </b></font>TCaptionControl <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TControl<font color="#000080">)
  </font><font color="#FF0000"><b>public
    property </b></font>Caption<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>You can <font color="#FF0000"><b>then </b></font>access the Caption <font color="#FF0000"><b>of </b></font>any control <font color="#FF0000"><b>with
</b></font>TCaptionControl<font color="#000080">(</font>Sender<font color="#000080">).</font>Caption<font color="#000080">, </font><font color="#FF0000"><b>as in </b></font>the following<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Label1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>ShowMessage<font color="#000080">(</font>TCaptionControl<font color="#000080">(</font>Sender<font color="#000080">).</font>Caption<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>If </b></font>you need <font color="#FF0000"><b>to </b></font>ensure that Sender <font color="#FF0000"><b>is </b></font>a descendant <font color="#FF0000"><b>of </b></font>TControl<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>use<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Label1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Sender <font color="#FF0000"><b>is </b></font>TControl <font color="#FF0000"><b>then
    </b></font>ShowMessage<font color="#000080">(</font>TCaptionControl<font color="#000080">(</font>Sender<font color="#000080">).</font>Caption<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Note that using <font color="#000080">(</font>Sender <font color="#FF0000"><b>as </b></font>TCaptionControl<font color="#000080">).</font>Caption will <font color="#FF0000"><b>not </b></font>work<font color="#000080">, </font>since
Sender will be a TControl but <font color="#FF0000"><b>not </b></font>a TCaptionControl<font color="#000080">.  </font>Also note that some
controls <font color="#000080">(</font>like TEdit<font color="#000080">) </font><font color="#FF0000"><b>do not </b></font>have an accessible Caption<font color="#000080">, </font>but my code will
get it anyway<font color="#000080">!  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>a TEdit<font color="#800000">'s Caption is its Text.  For some other
</font>controls it may be nonsense<font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0385.PAS">Original</a><b>]</b></p></body>
</html>
