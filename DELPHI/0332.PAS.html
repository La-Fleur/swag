<html>
<head><title> "TMemo Component with ChgPos Property" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0332.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Msgmemo<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>TPosChangeEvent<font color="#000080">=</font><font color="#FF0000"><b>procedure</b></font><font color="#000080">(</font><font color="#FF0000"><b>var </b></font>row<font color="#000080">,</font>col<font color="#000080">:</font>integer<font color="#000080">) </font><font color="#FF0000"><b>of object</b></font><font color="#000080">;

  </font>TMessageMemo <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TMemo<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FHandled<font color="#000080">:</font>boolean<font color="#000080">;
    </font>FPosChange<font color="#000080">:</font>TposChangeEvent<font color="#000080">;
  </font><font color="#FF0000"><b>protected
    procedure </b></font>PosChange<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor </b></font>create<font color="#000080">(</font>Aowner<font color="#000080">:</font>Tcomponent<font color="#000080">);</font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>KeyDown<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">:</font>word<font color="#000080">;</font>shift<font color="#000080">:</font>TShiftState<font color="#000080">);</font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>KeyPress<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">:</font>char<font color="#000080">);</font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>MouseDown<font color="#000080">(</font>button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);</font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
    property </b></font>OnPosChange<font color="#000080">:</font>TPosChangeEvent <font color="#FF0000"><b>read </b></font>FPosChange <font color="#FF0000"><b>write </b></font>FposChange<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnKeypress<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseDown<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TMessageMemo<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>Tmessagememo<font color="#000080">.</font>create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>create<font color="#000080">(</font>aowner<font color="#000080">);
  </font>wordwrap<font color="#000080">:=</font>false<font color="#000080">;
  </font>Fhandled<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TmessageMemo<font color="#000080">.</font>KeyDown<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">:</font>word<font color="#000080">;</font>shift<font color="#000080">:</font>TShiftState<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>PosChange<font color="#000080">;
  </font>FHandled<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>keydown<font color="#000080">(</font>key<font color="#000080">,</font>shift<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TmessageMemo<font color="#000080">.</font>KeyPress<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>key<font color="#000080">:</font>char<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if not </b></font>FHandled <font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>key<font color="#000080">&lt;&gt;</font><font color="#800000">#0 </font><font color="#FF0000"><b>then
  begin
    </b></font>PosChange<font color="#000080">;
    </font>FHandled<font color="#000080">:=</font>false<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>keypress<font color="#000080">(</font>key<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMessageMemo<font color="#000080">.</font>mousedown<font color="#000080">(</font>button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>PosChange<font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>mousedown<font color="#000080">(</font>button<font color="#000080">,</font>shift<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMessageMemo<font color="#000080">.</font>PosChange<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>x<font color="#000080">,</font>x2<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>y<font color="#000080">:=</font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LINEFROMCHAR<font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>x2<font color="#000080">:=</font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LINEINDEX<font color="#000080">, </font><font color="#800000">$FFFF</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>x<font color="#000080">:=</font>selStart <font color="#000080">- </font>x2<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>assigned<font color="#000080">(</font>FposChange<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>FposChange<font color="#000080">(</font>y<font color="#000080">,</font>x<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0332.PAS">Original</a><b>]</b></p></body>
</html>
