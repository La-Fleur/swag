<html>
<head><title> "An Improved StringGrid Component" by HARM V. ZOEST</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0173.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*
 DESCRIPTION :  A improved version of the stringgrid component
 AUTHOR      : Harm v. Zoest, email : 4923559@hsu1.HVU.nl
 VERSION     :  0.95 (beta) 06-27- 1996
 REMARKS     : If you have comments, found bugs, ore you have added some
               nice features, please mail me!
 *)

{$S-,I-,D-,L-}
</i></font><font color="#FF0000"><b>unit </b></font>ImpGrid<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
   </b></font>WinTypes<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Controls<font color="#000080">, </font>Grids<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>{ own exeptions}</i></font><font color="#000080">}
  </font>EErrorInCell <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);
  </font>EFileNotFound <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);


  </font>TImpGrid <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TStringGrid<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FHCol<font color="#000080">, </font>FHRow<font color="#000080">: </font>TStrings<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitHCol<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InitHRow<font color="#000080">;
  </font><font color="#FF0000"><b>protected
    procedure </b></font>Loaded<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
    property </b></font>HCol<font color="#000080">: </font>TStrings <font color="#FF0000"><b>read </b></font>FHCol <font color="#FF0000"><b>write </b></font>SetHCol<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>HRow<font color="#000080">: </font>TStrings <font color="#FF0000"><b>read </b></font>FHRow <font color="#FF0000"><b>write </b></font>SetHRow<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>RemoveRows<font color="#000080">(</font>RowIndex<font color="#000080">, </font>RCount<font color="#000080">: </font>LongInt<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>InsertRows<font color="#000080">(</font>RowIndex<font color="#000080">, </font>RCount<font color="#000080">: </font>LongInt<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>RemoveCols<font color="#000080">(</font>ColIndex<font color="#000080">, </font>CCount<font color="#000080">: </font>LongInt<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>InsertCols<font color="#000080">(</font>ColIndex<font color="#000080">, </font>CCount<font color="#000080">: </font>LongInt<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Clear<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>isCell<font color="#000080">(</font>SubStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ACol<font color="#000080">, </font>ARow<font color="#000080">: </font>LongInt<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SaveToFile<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>LoadFromFile<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>CellToReal<font color="#000080">(</font>ACol<font color="#000080">, </font>ARow<font color="#000080">: </font>LongInt<font color="#000080">): </font>Real<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation


constructor </b></font>TImpGrid<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
  </font>FHCol<font color="#000080">:=</font>TStringList<font color="#000080">.</font>Create<font color="#000080">;
  </font>FHRow<font color="#000080">:=</font>TStringList<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Timpgrid<font color="#000080">.</font>Loaded<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Loaded<font color="#000080">;
  </font>initHCol<font color="#000080">;
  </font>initHRow<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>SetHCol<font color="#000080">(</font>Value<font color="#000080">: </font>TStrings<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FHCol<font color="#000080">.</font>Assign<font color="#000080">(</font>Value<font color="#000080">);
  </font>InitHCol<font color="#000080">;
  </font>Refresh<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>SetHRow<font color="#000080">(</font>Value<font color="#000080">: </font>TStrings<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>FHRow<font color="#000080">.</font>Assign<font color="#000080">(</font>Value<font color="#000080">);
  </font>InitHRow<font color="#000080">;
  </font>Refresh<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TImpgrid<font color="#000080">.</font>InitHCol<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>FHCol <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    for </b></font>I <font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>pred<font color="#000080">( </font>ColCount<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
      if </b></font>I <font color="#000080">&lt;</font>FHCol<font color="#000080">.</font>Count <font color="#FF0000"><b>then
         </b></font>Cells<font color="#000080">[</font>I<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] :=</font>FHCol<font color="#000080">[</font>I<font color="#000080">]
      </font><font color="#FF0000"><b>else </b></font>Cells<font color="#000080">[</font>I<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] :=</font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{for}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ImpGrid<font color="#000080">.</font>InitHRow<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>FHRow <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    for </b></font>I <font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>RowCount <font color="#000080">-</font><font color="#800000">2 </font><font color="#FF0000"><b>do
    begin
      if </b></font>I <font color="#000080">&lt;</font>FHRow<font color="#000080">.</font>Count <font color="#FF0000"><b>then
      </b></font>Cells<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">, </font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]:=</font>FHRow<font color="#000080">[</font>I<font color="#000080">]
      </font><font color="#FF0000"><b>else </b></font>Cells<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">, </font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>RemoveRows<font color="#000080">(</font>RowIndex<font color="#000080">, </font>RCount <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i <font color="#000080">:= </font>RowIndex <font color="#FF0000"><b>to </b></font>RowCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>Rows<font color="#000080">[</font>i<font color="#000080">] := </font>Rows<font color="#000080">[</font>i <font color="#000080">+ </font>RCount<font color="#000080">];
  </font>RowCount <font color="#000080">:= </font>RowCount <font color="#000080">- </font>RCount<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>InsertRows<font color="#000080">(</font>RowIndex<font color="#000080">, </font>RCount <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RowCount <font color="#000080">:= </font>RowCount <font color="#000080">+ </font>RCount<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>RowCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font>RowIndex <font color="#FF0000"><b>do
      </b></font>Rows<font color="#000080">[</font>i<font color="#000080">] := </font>Rows<font color="#000080">[</font>i <font color="#000080">- </font>RCount<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>RemoveCols<font color="#000080">(</font>ColIndex<font color="#000080">, </font>CCount <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i <font color="#000080">:= </font>ColIndex <font color="#FF0000"><b>to </b></font>ColCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>Cols<font color="#000080">[</font>i<font color="#000080">] := </font>Cols<font color="#000080">[</font>i <font color="#000080">+ </font>CCount<font color="#000080">];
  </font>ColCount <font color="#000080">:= </font>ColCount <font color="#000080">- </font>CCount<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>InsertCols<font color="#000080">(</font>ColIndex<font color="#000080">, </font>CCount <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ColCount <font color="#000080">:= </font>ColCount <font color="#000080">+ </font>CCount<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>ColCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font>ColIndex <font color="#FF0000"><b>do
      </b></font>Cols<font color="#000080">[</font>i<font color="#000080">] := </font>Cols<font color="#000080">[</font>i <font color="#000080">- </font>CCount<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>Clear<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ColCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>Cols<font color="#000080">[</font>i<font color="#000080">].</font>Clear<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>TImpGrid<font color="#000080">.</font>isCell<font color="#000080">(</font>SubStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>var </b></font>ACol<font color="#000080">, </font>ARow<font color="#000080">: </font>LongInt<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>RowCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    for </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ColCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      if </b></font>Rows<font color="#000080">[</font>i<font color="#000080">].</font>Strings<font color="#000080">[</font>j<font color="#000080">] = </font>SubStr <font color="#FF0000"><b>then
      begin
        </b></font>ARow <font color="#000080">:= </font>i<font color="#000080">;
        </font>ACol <font color="#000080">:= </font>j<font color="#000080">;
        </font>Result <font color="#000080">:= </font>True<font color="#000080">;
        </font>exit<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>SaveToFile<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">, </font>j<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>ss<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>f<font color="#000080">: </font>TextFile<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AssignFile<font color="#000080">(</font>f<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Rewrite<font color="#000080">(</font>f<font color="#000080">);
  </font>ss <font color="#000080">:= </font>IntToStr<font color="#000080">(</font>ColCount<font color="#000080">) + </font><font color="#800000">',' </font><font color="#000080">+ </font>IntToStr<font color="#000080">(</font>RowCount<font color="#000080">);
  </font>Writeln<font color="#000080">(</font>f<font color="#000080">, </font>ss<font color="#000080">);

  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>RowCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    for </b></font>j <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ColCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      if </b></font>Cells<font color="#000080">[</font>j<font color="#000080">, </font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
      begin
        </b></font>ss <font color="#000080">:= </font>IntToStr<font color="#000080">(</font>j<font color="#000080">) + </font><font color="#800000">',' </font><font color="#000080">+ </font>IntToStr<font color="#000080">(</font>i<font color="#000080">) + </font><font color="#800000">',' </font><font color="#000080">+ </font>Cells<font color="#000080">[</font>j<font color="#000080">, </font>i<font color="#000080">];
        </font>Writeln<font color="#000080">(</font>f<font color="#000080">, </font>ss<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CloseFile<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TImpGrid<font color="#000080">.</font>LoadFromFile<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">;
  </font>ss<font color="#000080">, </font>ss1<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>f<font color="#000080">: </font>TextFile<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AssignFile<font color="#000080">(</font>f<font color="#000080">, </font>FileName<font color="#000080">);
  </font>Reset<font color="#000080">(</font>f<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>IOResult <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then raise </b></font>EFileNotFound<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#800000">'File ' </font><font color="#000080">+ </font>FileName <font color="#000080">+ </font><font color="#800000">' not found'</font><font color="#000080">);
  </font>Readln<font color="#000080">(</font>f<font color="#000080">, </font>ss<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ss <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    </b></font>ss1 <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
    </font>ColCount <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>ss1<font color="#000080">);
    </font>ss1 <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>ss<font color="#000080">));
    </font>RowCount <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>ss1<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>while not </b></font>Eof<font color="#000080">(</font>f<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Readln<font color="#000080">(</font>f<font color="#000080">, </font>ss<font color="#000080">);
    </font>ss1 <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
    </font>ss <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>ss<font color="#000080">));
    </font>X <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>ss1<font color="#000080">);
    </font>ss1 <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
    </font>ss <font color="#000080">:= </font>Copy<font color="#000080">(</font>ss<font color="#000080">, </font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">, </font>ss<font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">(</font>ss<font color="#000080">));
    </font>Y <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>ss1<font color="#000080">);
    </font>Cells<font color="#000080">[</font>X<font color="#000080">, </font>Y<font color="#000080">] := </font>ss<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CloseFile<font color="#000080">(</font>f<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>TImpGrid<font color="#000080">.</font>CellToReal<font color="#000080">(</font>ACol<font color="#000080">, </font>ARow<font color="#000080">: </font>LongInt<font color="#000080">): </font>Real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>Real<font color="#000080">;
  </font>Code<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Cells<font color="#000080">[</font>ACol<font color="#000080">, </font>ARow<font color="#000080">] &lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    </b></font>Val<font color="#000080">(</font>Cells<font color="#000080">[</font>ACol<font color="#000080">, </font>ARow<font color="#000080">], </font>i<font color="#000080">, </font>Code<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then raise
          </b></font>EErrorInCell<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#800000">'Error at position: ' </font><font color="#000080">+
          </font>IntToStr<font color="#000080">(</font>Code<font color="#000080">) + </font><font color="#800000">' in Cell [' </font><font color="#000080">+ </font>IntToStr<font color="#000080">(</font>ACol<font color="#000080">) + </font><font color="#800000">', ' </font><font color="#000080">+
          </font>IntToStr<font color="#000080">(</font>ARow<font color="#000080">) + </font><font color="#800000">'].'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
    </b></font>Result <font color="#000080">:= </font>i<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Improved Components'</font><font color="#000080">, [</font>TImpGrid<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0173.PAS">Original</a><b>]</b></p></body>
</html>
