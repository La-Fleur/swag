<html>
<head><title> "Detect Windows System Version" by LEONARDO HUMBERTO LIPORATI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0246.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt;
&gt; </font>Hello <font color="#000080">!
&gt;
&gt; </font>Does anyone know<font color="#000080">, </font>how can I detect the Windows System Version information<font color="#000080">?
&gt;
&gt; </font>Thanks<font color="#000080">!

</font>Hello<font color="#000080">!

</font><font color="#FF0000"><b>If </b></font>you want <font color="#FF0000"><b>to </b></font>know <font color="#FF0000"><b>in </b></font>what operating system your <font color="#FF0000"><b>program is </b></font>running <font color="#FF0000"><b>and </b></font>its
version <font color="#000080">(</font>eg<font color="#000080">. </font>Windows <font color="#800000">95</font><font color="#000080">, </font>Windows NT <font color="#800000">3.51</font><font color="#000080">, </font>Windows NT <font color="#800000">4.0</font><font color="#000080">), </font><font color="#FF0000"><b>try </b></font>the code
below which I adapted from MSDN <font color="#FF0000"><b>to </b></font>work <font color="#FF0000"><b>with </b></font>Delphi<font color="#000080">.

</font><font color="#FF0000"><b>unit </b></font>winversion<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Memo1<font color="#000080">: </font>TMemo<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>Version <font color="#000080">: </font>DWORD<font color="#000080">;
    </font>Build <font color="#000080">: </font>WORD<font color="#000080">;
    </font>MajorVersion<font color="#000080">, </font>MinorVersion <font color="#000080">: </font>BYTE<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Version <font color="#000080">:= </font>GetVersion<font color="#000080">();
  </font><font color="#008000"><i>{ Get major and minor version numbers of Windows }
  </i></font>MajorVersion <font color="#000080">:= </font>LOBYTE<font color="#000080">(</font>LOWORD<font color="#000080">(</font>Version<font color="#000080">));
  </font>MinorVersion <font color="#000080">:= </font>HIBYTE<font color="#000080">(</font>LOWORD<font color="#000080">(</font>Version<font color="#000080">));
  </font><font color="#008000"><i>{ Get build numbers for Windows NT or Win32s }
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Version <font color="#FF0000"><b>and </b></font><font color="#800000">$80000000</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{ Windows NT }
    </i></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Windows NT'</font><font color="#000080">);
    </font>Build <font color="#000080">:= </font>HIWORD<font color="#000080">(</font>Version<font color="#000080">);
  </font><font color="#FF0000"><b>end
  else if </b></font><font color="#000080">(</font>MajorVersion <font color="#000080">&lt; </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{ Win32s }
    </i></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Win32s'</font><font color="#000080">);
    </font>Build <font color="#000080">:= </font>HIWORD<font color="#000080">(</font>Version<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$7FFF</font><font color="#000080">;
  </font><font color="#FF0000"><b>end
  else begin
    </b></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Windows 95'</font><font color="#000080">); </font><font color="#008000"><i>{ Windows 95 -- No build numbers provided }
    </i></font>Build <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Version '</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>MajorVersion<font color="#000080">)+</font><font color="#800000">'.'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>MinorVersion<font color="#000080">));
  </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Build '</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>Build<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0246.PAS">Original</a><b>]</b></p></body>
</html>
