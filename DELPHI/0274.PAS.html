<html>
<head><title> "Multicolors in stringgrid" by TONY POPIEL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0274.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Hi Moris

&gt; Can anyon help me. I would like to alter the colour of a cell in a
&gt; stringgrid if certain criteria are met. Can this be done and if so how

You have to write your own OnDrawCell procedure.
Here is some code I wrote a while back that did the trick. It's too
much but you might find something useful in there.

}

</i></font><font color="#FF0000"><b>procedure </b></font>TLongChart<font color="#000080">.</font>StringGrid1DrawCell<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font>Col<font color="#000080">,
  </font>Row<font color="#000080">: </font>Longint<font color="#000080">; </font>Rect<font color="#000080">: </font>TRect<font color="#000080">; </font>State<font color="#000080">: </font>TGridDrawState<font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>OldColor <font color="#000080">: </font>TColor<font color="#000080">;
</font>OldBrush <font color="#000080">: </font>TBrush<font color="#000080">;
</font><font color="#FF0000"><b>begin with </b></font>StringGrid1<font color="#000080">.</font>Canvas <font color="#FF0000"><b>do begin
    </b></font>OldColor <font color="#000080">:= </font>Font<font color="#000080">.</font>Color<font color="#000080">;
    </font>OldBrush <font color="#000080">:= </font>Brush<font color="#000080">;

   </font><font color="#008000"><i>{paint fridays}
   </i></font><font color="#FF0000"><b>if </b></font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'Fr' </font><font color="#FF0000"><b>then begin
   </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font><font color="#800000">$02aaaaaa</font><font color="#000080">; </font><font color="#008000"><i>{light gray}
   </i></font>FillRect<font color="#000080">(</font>Rect<font color="#000080">);
   </font>Font<font color="#000080">.</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
   </font>TextOut<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font>Row<font color="#000080">]);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{paint each alternating month}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Row <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Col <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
   if </b></font><font color="#000080">(</font>Odd<font color="#000080">(</font>StrToIntDef<font color="#000080">(</font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font><font color="#800000">31</font><font color="#000080">],</font><font color="#800000">0</font><font color="#000080">))) </font><font color="#FF0000"><b>then
   </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clBlue
   <font color="#FF0000"><b>else
   </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clFuchsia<font color="#000080">;

   </font>FillRect<font color="#000080">(</font>Rect<font color="#000080">);
   </font>Font<font color="#000080">.</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
   </font>TextOut<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font>Row<font color="#000080">]);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{paint days of the week}
   </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Row <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Col <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
   if </b></font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'Fr' </font><font color="#FF0000"><b>then
   </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clTeal <font color="#FF0000"><b>else
   </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clAqua<font color="#000080">;
   </font>FillRect<font color="#000080">(</font>Rect<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'Fr' </font><font color="#FF0000"><b>then
   </b></font>Font<font color="#000080">.</font>Color <font color="#000080">:= </font>clWhite <font color="#FF0000"><b>else
   </b></font>Font<font color="#000080">.</font>Color <font color="#000080">:= </font>clBlack<font color="#000080">;

   </font>TextOut<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">,</font>StringGrid1<font color="#000080">.</font>Cells<font color="#000080">[</font>Col<font color="#000080">,</font>Row<font color="#000080">]);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font>Font<font color="#000080">.</font>Color <font color="#000080">:= </font>OldColor<font color="#000080">;
   </font>Brush <font color="#000080">:= </font>OldBrush<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

---------------------------------------------------
</font>Tony Popiel
popiel<font color="#000080">@</font>emirates<font color="#000080">.</font>net<font color="#000080">.</font>ae
United Arab Emirates
<font color="#000080">---------------------------------------------------
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0274.PAS">Original</a><b>]</b></p></body>
</html>
