<html>
<head><title> "Extracting Index Data from a Table" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{


The IndexDefs property of the TTable component contains information about
the indexes for the table used by the TTable. The IndexDefs property
itself has various properties that allow for the extraction of information
about specific indexes. The two properties in the IndexDefs object are:
 
  Count: type Integer; available only at run-time and read-only; indicates
         the number ofentries in the Items property (i.e., the number of
         indexes in the table).
  Items: type TIndexDef; available only at run-time and read-only; an
         array of TIndexDef objects, one for each index in the table.
         
The Count property of the IndexDefs object is used as the basis for a
loop program construct to iterate through the Items property entries to
extract specific information about each index. Each IndexDef object con-
tained in the Items property consists of a number of properties that pro-
vide various bits of information that describe each index. All of the
properties of the IndexDef object are available only at run-time and are
all read-only. These properties are:
 
  Expression: type String; indicates the expression used for dBASE multi-
              field indexes.
  Fields:     type String; indicates the field or fields upon which the
              index is based.
  Name:       type String; name of the index.
  Options:    type TIndexOptions; characteristics of the index (ixPrimary,
              ixUnique, etc.).
 
Before any index information (Count or Items) can be accessed, the Update
method of the IndexDefs object must be called. This refreshes or init-
ializes the IndexDef object's view of the set of indexes.
 
Examples
========
 
Here is a simple For loop based on the Count property of the IndexDefs
object that extracts the name of each index (if any exist) for the table
represented by the TTable component Table1:
}

  </i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>ListBtnClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>ListBox1<font color="#000080">.</font>Items<font color="#000080">.</font>Clear<font color="#000080">;
    </font><font color="#FF0000"><b>with </b></font>Table1 <font color="#FF0000"><b>do begin
      if </b></font>IndexDefs<font color="#000080">.</font>Count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>IndexDefs<font color="#000080">.</font>Count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
          </b></font>ListBox1<font color="#000080">.</font>Items<font color="#000080">.</font>Add<font color="#000080">(</font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Name<font color="#000080">)
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font>Below <font color="#FF0000"><b>is </b></font>an example showing how <font color="#FF0000"><b>to </b></font>extract information about indexes at
run<font color="#000080">-</font>time<font color="#000080">, </font>plugging the extracted values into a TStringGrid <font color="#000080">(</font>named SG1<font color="#000080">).
 
  </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
    </font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    with </b></font>Table1 <font color="#FF0000"><b>do begin
      </b></font>Open<font color="#000080">;
      </font><font color="#008000"><i>{Refresh IndexDefs object}
      </i></font>IndexDefs<font color="#000080">.</font>Update<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>IndexDefs<font color="#000080">.</font>Count <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        </b></font><font color="#008000"><i>{Set up columns and rows in grid to match IndexDefs items}
        </i></font>SG1<font color="#000080">.</font>ColCount <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>RowCount <font color="#000080">:= </font>IndexDefs<font color="#000080">.</font>Count <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
        </font><font color="#008000"><i>{Set grid column labels to TIndexDef property names}
        </i></font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">'Name'</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>ColWidths<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">200</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">'Fields'</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>ColWidths<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">200</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">'Expression'</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>ColWidths<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">200</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">'Options'</font><font color="#000080">;
        </font>SG1<font color="#000080">.</font>ColWidths<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">300</font><font color="#000080">;

        </font><font color="#008000"><i>{Loop through IndexDefs.Items}
        </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>IndexDefs<font color="#000080">.</font>Count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
          </b></font><font color="#008000"><i>{Fill grid cells for current row}
          </i></font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Name<font color="#000080">;
          </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Fields<font color="#000080">;
          </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Expression<font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>ixPrimary <font color="#FF0000"><b>in </b></font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Options <font color="#FF0000"><b>then
            </b></font>S <font color="#000080">:= </font><font color="#800000">'ixPrimary, '</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>ixUnique <font color="#FF0000"><b>in </b></font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Options <font color="#FF0000"><b>then
            </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'ixUnique, '</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>ixDescending <font color="#FF0000"><b>in </b></font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Options <font color="#FF0000"><b>then
            </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'ixDescending, '</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>ixCaseInsensitive <font color="#FF0000"><b>in </b></font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Options <font color="#FF0000"><b>then
            </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'ixCaseInsensitive, '</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>ixExpression <font color="#FF0000"><b>in </b></font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[</font>i<font color="#000080">].</font>Options <font color="#FF0000"><b>then
            </b></font>S <font color="#000080">:= </font>S <font color="#000080">+ </font><font color="#800000">'ixExpression, '</font><font color="#000080">;
          </font><font color="#FF0000"><b>if </b></font>S <font color="#000080">&gt; </font><font color="#800000">' ' </font><font color="#FF0000"><b>then begin
            </b></font><font color="#008000"><i>{Get rid of trailing &quot;, &quot;}
            </i></font>System<font color="#000080">.</font>Delete<font color="#000080">(</font>S<font color="#000080">, </font>Length<font color="#000080">(</font>S<font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
            </font>SG1<font color="#000080">.</font>Cells<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">, </font>i <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>S<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 
</font>Special Considerations
<font color="#000080">======================
 
</font>There are idiosyncracies associated <font color="#FF0000"><b>with </b></font>extracting information about
indexes <font color="#FF0000"><b>for </b></font>different table types that Delphi can access<font color="#000080">.
 
</font>dBASE Tables
<font color="#000080">------------
 
</font><font color="#FF0000"><b>With </b></font>dBASE indexes<font color="#000080">, </font>which properties <font color="#FF0000"><b>of </b></font>Fields <font color="#FF0000"><b>and </b></font>Expression will be
filled will depend <font color="#FF0000"><b>on </b></font>the <font color="#FF0000"><b>type of </b></font>index<font color="#000080">, </font>simple <font color="#000080">(</font>single<font color="#000080">-</font>field<font color="#000080">) </font><font color="#FF0000"><b>or
</b></font>complex <font color="#000080">(</font>based <font color="#FF0000"><b>on </b></font>multiple fields <font color="#FF0000"><b>or </b></font>a dBASE expression<font color="#000080">). </font><font color="#FF0000"><b>If </b></font>the index
<font color="#FF0000"><b>is </b></font>a simple one<font color="#000080">, </font>the Fields <font color="#FF0000"><b>property </b></font>will contain the name <font color="#FF0000"><b>of </b></font>the field
<font color="#FF0000"><b>in </b></font>the table <font color="#FF0000"><b>on </b></font>which the <font color="#FF0000"><b>index is </b></font>based <font color="#FF0000"><b>and </b></font>the Expression <font color="#FF0000"><b>property </b></font>will
be blank<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the <font color="#FF0000"><b>index is </b></font>a complex one<font color="#000080">, </font>the Expression <font color="#FF0000"><b>property </b></font>will
show the expression <font color="#FF0000"><b>on </b></font>which the <font color="#FF0000"><b>index is </b></font>based <font color="#000080">(</font>e<font color="#000080">.</font>g<font color="#000080">., &quot;</font>Field1<font color="#000080">+</font>Field2<font color="#000080">&quot;)
</font><font color="#FF0000"><b>and </b></font>the Fields <font color="#FF0000"><b>property </b></font>will be blank<font color="#000080">.
 
</font>Paradox Tables
<font color="#000080">--------------
 
</font><font color="#FF0000"><b>With </b></font>Paradox primary indexes<font color="#000080">, </font>the Name <font color="#FF0000"><b>property </b></font>will be blank<font color="#000080">, </font>the Fields
<font color="#FF0000"><b>property </b></font>will contain the field<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>on </b></font>which the <font color="#FF0000"><b>index is </b></font>based<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the
Options <font color="#FF0000"><b>property </b></font>will contain ixPrimary<font color="#000080">. </font><font color="#FF0000"><b>With </b></font>secondary indexes<font color="#000080">, </font>the Name
<font color="#FF0000"><b>property </b></font>will contain the name <font color="#FF0000"><b>of </b></font>the secondary <font color="#FF0000"><b>index</b></font><font color="#000080">, </font>the Fields prop<font color="#000080">-
</font>erty will contain the field<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>on </b></font>which the <font color="#FF0000"><b>index is </b></font>based<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>the
Options <font color="#FF0000"><b>property </b></font>may <font color="#FF0000"><b>or </b></font>may <font color="#FF0000"><b>not </b></font>have values<font color="#000080">.
 
</font>The Fields <font color="#FF0000"><b>property for </b></font>indexes based <font color="#FF0000"><b>on </b></font>more than one field will show
the field names separated by semi<font color="#000080">-</font>colons<font color="#000080">. </font>Indexes based <font color="#FF0000"><b>on </b></font>only a single
field will show the name <font color="#FF0000"><b>of </b></font>only that one field <font color="#FF0000"><b>in </b></font>the Fields <font color="#FF0000"><b>property</b></font><font color="#000080">.

</font>InterBase Tables
<font color="#000080">----------------
 
</font><font color="#FF0000"><b>For </b></font>both <font color="#FF0000"><b>index </b></font>types<font color="#000080">, </font>single<font color="#000080">- </font><font color="#FF0000"><b>or </b></font>multiple<font color="#000080">-</font>field<font color="#000080">, </font>the Expression <font color="#FF0000"><b>property
</b></font>will be blank<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>single<font color="#000080">-</font>field indexes<font color="#000080">, </font>the Fields <font color="#FF0000"><b>property </b></font>will contain
the field <font color="#FF0000"><b>on </b></font>which the <font color="#FF0000"><b>index is </b></font>based<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>multi<font color="#000080">-</font>field indexes<font color="#000080">, </font>the Fields
<font color="#FF0000"><b>property </b></font>will show all <font color="#FF0000"><b>of </b></font>the multiple fields that comprise the <font color="#FF0000"><b>index</b></font><font color="#000080">,
</font>each separated by a semi<font color="#000080">-</font>colon<font color="#000080">. 
 
</font>Indexes designated <font color="#FF0000"><b>as </b></font>PRIMARY when the CREATE TABLE command <font color="#FF0000"><b>is </b></font>issued will
have <font color="#000080">&quot;</font>RDB<font color="#800000">$</font>PRIMARYn<font color="#000080">&quot; </font><font color="#FF0000"><b>in </b></font>the Name <font color="#FF0000"><b>property</b></font><font color="#000080">, </font>where n <font color="#FF0000"><b>is </b></font>a number character
uniquely identifying the primary <font color="#FF0000"><b>index </b></font>within the database metadata<font color="#000080">.
</font>Secondary indexes will show the actual name <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>index</b></font><font color="#000080">.
 
</font>Foreign key constraints also result <font color="#FF0000"><b>in </b></font>an <font color="#FF0000"><b>index </b></font>being created by the sys<font color="#000080">-
</font>tem<font color="#000080">. </font>These indexes appear <font color="#FF0000"><b>in </b></font>the IndexDefs <font color="#FF0000"><b>property</b></font><font color="#000080">, </font><font color="#FF0000"><b>and </b></font>will have the
name <font color="#000080">&quot;</font>RDB<font color="#800000">$F</font>OREIGNn<font color="#000080">&quot; </font>where n <font color="#FF0000"><b>is </b></font>a number character that uniquely identifies
the <font color="#FF0000"><b>index </b></font>within the database metadata<font color="#000080">.

</font>The Fields <font color="#FF0000"><b>property for </b></font>indexes based <font color="#FF0000"><b>on </b></font>more than one field will show
the field names separated by semi<font color="#000080">-</font>colons<font color="#000080">. </font>Indexes based <font color="#FF0000"><b>on </b></font>only a single
field will show the name <font color="#FF0000"><b>of </b></font>only that one field <font color="#FF0000"><b>in </b></font>the Fields <font color="#FF0000"><b>property</b></font><font color="#000080">.

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 


</font>DISCLAIMER<font color="#000080">: </font>You have the right <font color="#FF0000"><b>to </b></font>use this technical information
subject <font color="#FF0000"><b>to </b></font>the terms <font color="#FF0000"><b>of </b></font>the No<font color="#000080">-</font>Nonsense License Statement that
you received <font color="#FF0000"><b>with </b></font>the Borland product <font color="#FF0000"><b>to </b></font>which this information
pertains<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0064.PAS">Original</a><b>]</b></p></body>
</html>
