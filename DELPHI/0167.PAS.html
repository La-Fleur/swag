<html>
<head><title> "Detect whether a drive exists or not?" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0167.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>function </b></font>DoesDriveExist<font color="#000080">(</font>DriveLetter<font color="#000080">: </font>char<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>DriveLetter <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{Make it lower case.}
    </i></font>DriveLetter <font color="#000080">:= </font>chr<font color="#000080">(</font>ord<font color="#000080">(</font>DriveLetter<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#800000">$20</font><font color="#000080">);
  </font>i <font color="#000080">:= </font>GetDriveType<font color="#000080">(</font>ord<font color="#000080">(</font>DriveLetter<font color="#000080">) - </font>ord<font color="#000080">(</font><font color="#800000">'a'</font><font color="#000080">));
  </font><font color="#FF0000"><b>case </b></font>i <font color="#FF0000"><b>of
    </b></font>DRIVE_REMOVABLE<font color="#000080">: </font>result <font color="#000080">:= </font><font color="#800000">'floppy'</font><font color="#000080">;
    </font>DRIVE_FIXED<font color="#000080">: </font>result <font color="#000080">:= </font><font color="#800000">'hard disk'</font><font color="#000080">;
    </font>DRIVE_REMOTE<font color="#000080">: </font>result <font color="#000080">:= </font><font color="#800000">'network drive'</font><font color="#000080">;
    </font><font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font><font color="#800000">'does not exist'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DoesDriveExist<font color="#000080">(</font>DriveLetter<font color="#000080">: </font>char<font color="#000080">): </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>drives<font color="#000080">: </font>TDriveComboBox<font color="#000080">;
  </font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>false<font color="#000080">;
  </font>drives <font color="#000080">:= </font>TDriveComboBox<font color="#000080">.</font>create<font color="#000080">(</font>application<font color="#000080">);
  </font>drives<font color="#000080">.</font>parent <font color="#000080">:= </font>form1<font color="#000080">;
  </font>form1<font color="#000080">.</font>listbox1<font color="#000080">.</font>items <font color="#000080">:= </font>drives<font color="#000080">.</font>items<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>drives<font color="#000080">.</font>items<font color="#000080">.</font>count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do </b></font><font color="#008000"><i>{Note: this is case sensitive: lower case.}
    </i></font><font color="#FF0000"><b>if </b></font>drives<font color="#000080">.</font>items<font color="#000080">.</font>strings<font color="#000080">[</font>i<font color="#000080">][</font><font color="#800000">1</font><font color="#000080">] = </font>DriveLetter <font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>true<font color="#000080">;
  </font>drives<font color="#000080">.</font>free<font color="#000080">; </font><font color="#008000"><i>{...so that the combobox doesn't show.}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Also<font color="#000080">, </font>DiskFree<font color="#000080">() </font>will return <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>if </b></font>the drive does <font color="#FF0000"><b>not </b></font>exist<font color="#000080">.

</font>Neil Rubenking wrote this code <font color="#000080">--

</font><font color="#FF0000"><b>function </b></font>DirExists<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>OldMode <font color="#000080">: </font>Word<font color="#000080">;
  </font>OldDir  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Result <font color="#000080">:= </font>True<font color="#000080">;
  </font>GetDir<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>OldDir<font color="#000080">); </font><font color="#008000"><i>{save old dir for return}
  </i></font>OldMode <font color="#000080">:= </font>SetErrorMode<font color="#000080">(</font>SEM_FAILCRITICALERRORS<font color="#000080">); </font><font color="#008000"><i>{if drive empty, except}
  </i></font><font color="#FF0000"><b>try try
    </b></font>ChDir<font color="#000080">(</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>except
    ON </b></font>EInOutError <font color="#FF0000"><b>DO </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>ChDir<font color="#000080">(</font>OldDir<font color="#000080">); </font><font color="#008000"><i>{return to old dir}
    </i></font>SetErrorMode<font color="#000080">(</font>OldMode<font color="#000080">); </font><font color="#008000"><i>{restore old error mode}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0167.PAS">Original</a><b>]</b></p></body>
</html>
