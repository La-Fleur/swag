<html>
<head><title> "Resizing and dividing panels" by DION KURCZEK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
Here's the source code for a resizable panel.  Give the panel an align
property of alClient, throw some controls on it, and watch them resize
at run time when you resize the form.  There is some code that prohibits
resizing during design time, but this can be taken out.  This may not be
perfect, because I threw it together in a few minutes, but it's worked
for me so far.
}

</i></font><font color="#FF0000"><b>unit </b></font>Elastic<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ExtCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TElasticPanel <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">( </font>TPanel <font color="#000080">)
  </font><font color="#FF0000"><b>private
     </b></font>FHorz<font color="#000080">, </font>FVert<font color="#000080">: </font>boolean<font color="#000080">;
     </font>nOldWidth<font color="#000080">, </font>nOldHeight<font color="#000080">: </font>integer<font color="#000080">;
     </font>bResized<font color="#000080">: </font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>protected
     procedure </b></font>WMSize<font color="#000080">( </font><font color="#FF0000"><b>var message</b></font><font color="#000080">: </font>TWMSize <font color="#000080">); </font><font color="#FF0000"><b>message </b></font>WM_SIZE<font color="#000080">;
  </font><font color="#FF0000"><b>public
     </b></font>nCount<font color="#000080">: </font>integer<font color="#000080">;
     </font><font color="#FF0000"><b>constructor </b></font>Create<font color="#000080">( </font>AOwner<font color="#000080">: </font>TComponent <font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
     property </b></font>ElasticHorizontal<font color="#000080">: </font>boolean <font color="#FF0000"><b>read </b></font>FHorz <font color="#FF0000"><b>write </b></font>FHorz <font color="#FF0000"><b>default 
</b></font>TRUE<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>ElasticVertical<font color="#000080">: </font>boolean <font color="#FF0000"><b>read </b></font>FVert <font color="#FF0000"><b>write </b></font>FVert <font color="#FF0000"><b>default 
</b></font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

constructor </b></font>TElasticPanel<font color="#000080">.</font>Create<font color="#000080">( </font>AOwner<font color="#000080">: </font>TComponent <font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">( </font>AOwner <font color="#000080">);
  </font>FHorz <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>FVert <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>nOldWidth <font color="#000080">:= </font>Width<font color="#000080">;
  </font>nOldHeight <font color="#000080">:= </font>Height<font color="#000080">;
  </font>bResized <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TElasticPanel<font color="#000080">.</font>WMSize<font color="#000080">( </font><font color="#FF0000"><b>var message</b></font><font color="#000080">: </font>TWMSize <font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>bResize<font color="#000080">: </font>boolean<font color="#000080">;
  </font>xRatio<font color="#000080">: </font>real<font color="#000080">;
  </font>i<font color="#000080">: </font>integer<font color="#000080">;
  </font>ctl<font color="#000080">: </font>TWinControl<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Inc<font color="#000080">( </font>nCount <font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Align <font color="#000080">= </font>alNone <font color="#FF0000"><b>then
     </b></font>bResize <font color="#000080">:= </font>TRUE
  <font color="#FF0000"><b>else
     </b></font>bResize <font color="#000080">:= </font>bResized<font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font><font color="#000080">( </font>csDesigning <font color="#FF0000"><b>in </b></font>ComponentState <font color="#000080">) </font><font color="#FF0000"><b>and </b></font>bResize <font color="#FF0000"><b>then
     begin
        if </b></font>FHorz <font color="#FF0000"><b>then
           begin
              </b></font>xRatio <font color="#000080">:= </font>Width <font color="#000080">/ </font>nOldWidth<font color="#000080">;
              </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ControlCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
                 begin
                    </b></font>ctl <font color="#000080">:= </font>TWinControl<font color="#000080">( </font>Controls<font color="#000080">[</font>i<font color="#000080">] );
                    </font>ctl<font color="#000080">.</font>Left <font color="#000080">:= </font>Round<font color="#000080">( </font>ctl<font color="#000080">.</font>Left <font color="#000080">* </font>xRatio <font color="#000080">);
                    </font>ctl<font color="#000080">.</font>Width <font color="#000080">:= </font>Round<font color="#000080">( </font>ctl<font color="#000080">.</font>Width <font color="#000080">* </font>xRatio <font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>FVert <font color="#FF0000"><b>then
           begin
              </b></font>xRatio <font color="#000080">:= </font>Height <font color="#000080">/ </font>nOldHeight<font color="#000080">;
              </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ControlCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
                 begin
                    </b></font>ctl <font color="#000080">:= </font>TWinControl<font color="#000080">( </font>Controls<font color="#000080">[</font>i<font color="#000080">] );
                    </font>ctl<font color="#000080">.</font>Top <font color="#000080">:= </font>Round<font color="#000080">( </font>ctl<font color="#000080">.</font>Top <font color="#000080">* </font>xRatio <font color="#000080">);
                    </font>ctl<font color="#000080">.</font>Height <font color="#000080">:= </font>Round<font color="#000080">( </font>ctl<font color="#000080">.</font>Height <font color="#000080">* </font>xRatio <font color="#000080">);
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end
  else
     begin
        </b></font>nOldWidth <font color="#000080">:= </font>Width<font color="#000080">;
        </font>nOldHeight <font color="#000080">:= </font>Height<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>bResized <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font>nOldWidth <font color="#000080">:= </font>Width<font color="#000080">;
  </font>nOldHeight <font color="#000080">:= </font>Height<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Additional'</font><font color="#000080">, [</font>TElasticPanel<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0012.PAS">Original</a><b>]</b></p></body>
</html>
