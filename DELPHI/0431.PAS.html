<html>
<head><title> "Restore a window to its last state when" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0431.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">A<font color="#000080">: </font>Here <font color="#FF0000"><b>is  </b></font>WindowRestorer <font color="#000080">- </font>a window size  <font color="#FF0000"><b>and </b></font>state restorer DESCRIPTION<font color="#000080">:
</font>Ever notice  how professional programs  seem <font color="#FF0000"><b>to </b></font>remember  <font color="#FF0000"><b>in </b></font>what condition
<font color="#FF0000"><b>and </b></font>location  you left them <font color="#FF0000"><b>and  </b></font>their child windows<font color="#000080">? </font>Ever  notice how most
RAD apps  don<font color="#800000">'t? You can take  that ragged edge off  your program with this
</font><font color="#FF0000"><b>unit</b></font><font color="#000080">. </font>It  Allows apps <font color="#FF0000"><b>to </b></font>save  the location<font color="#000080">, </font>size<font color="#000080">, </font><font color="#FF0000"><b>and  </b></font>state <font color="#FF0000"><b>of </b></font>windows so
that when the user reopens them<font color="#000080">, </font>they will look <font color="#FF0000"><b>as </b></font>the user left them<font color="#000080">.

</font>USE<font color="#000080">: </font>Put  WINRSTOR <font color="#FF0000"><b>in </b></font>the  <font color="#FF0000"><b>uses of </b></font>clause  <font color="#FF0000"><b>of </b></font>your main  form <font color="#FF0000"><b>and </b></font>any forms
that will  be saving <font color="#FF0000"><b>or </b></font>restoring  their own state<font color="#000080">, </font>size<font color="#000080">,  </font><font color="#FF0000"><b>or </b></font>location<font color="#000080">. (</font><font color="#FF0000"><b>If
</b></font>you will  be doing all the  saving <font color="#FF0000"><b>and </b></font>restoring using  WinSaveChildren <font color="#FF0000"><b>and
</b></font>WinRestoreChildren from  the main form<font color="#000080">, </font>you  only need reference it  <font color="#FF0000"><b>in </b></font>the
main form<font color="#800000">'s uses clause.)

</font><font color="#FF0000"><b>In  </b></font>MainForm<font color="#000080">.</font>Create<font color="#000080">, </font>initialize  the global  WinRestorer <font color="#FF0000"><b>object  as </b></font>follows
<font color="#000080">(</font>it<font color="#800000">'s already declared in this file, but needs to be allocated):


</font><font color="#000080">--------------------------------------------------------------------------------

        </font>GlobalWinRestorer <font color="#000080">:= </font>TWinRestorer<font color="#000080">.</font>create<font color="#000080">( </font>Application<font color="#000080">, </font>TRUE<font color="#000080">, </font>WHATSAVE_ALL<font color="#000080">);

--------------------------------------------------------------------------------
</font>Which <font color="#FF0000"><b>is </b></font>the same <font color="#FF0000"><b>as</b></font><font color="#000080">:
--------------------------------------------------------------------------------

        </font>GlobalWinRestorer <font color="#000080">:= </font>TWinRestorer<font color="#000080">.</font>create<font color="#000080">( </font>Application<font color="#000080">, </font>TRUE<font color="#000080">, [</font>location<font color="#000080">, </font>size<font color="#000080">, </font>state<font color="#000080">]);

--------------------------------------------------------------------------------
</font><font color="#FF0000"><b>Then</b></font><font color="#000080">,  </font><font color="#FF0000"><b>in </b></font>MainForm<font color="#000080">.</font>Destroy<font color="#000080">,  </font>deallocate  the  global WinRestorer  <font color="#FF0000"><b>object as
</b></font>follows<font color="#000080">:

--------------------------------------------------------------------------------

</font>GlobalWinRestorer<font color="#000080">.</font>free<font color="#000080">;

--------------------------------------------------------------------------------
</font>A good place  <font color="#FF0000"><b>to </b></font>save a  form<font color="#800000">'s status is  in the queryclose  event or else
</font>attached <font color="#FF0000"><b>to  </b></font>a button <font color="#FF0000"><b>or  </b></font>menu item<font color="#000080">. </font>I  usually create an  item <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>File
</b></font>Menu captioned <font color="#800000">'Save &amp;Workspace' </font>which does<font color="#000080">:

--------------------------------------------------------------------------------

        </font>GlobalWinRestorer<font color="#000080">.</font>SaveChildren<font color="#000080">(</font>Self<font color="#000080">, [</font><font color="#FF0000"><b>default</b></font><font color="#000080">]);

--------------------------------------------------------------------------------
</font><font color="#FF0000"><b>And </b></font>under main form<font color="#800000">'s Close event I put:
</font><font color="#000080">--------------------------------------------------------------------------------

        </font>GlobalWinRestorer<font color="#000080">.</font>SaveWin<font color="#000080">(</font>Self<font color="#000080">, [</font>WHATSAVE_ALL<font color="#000080">]);

--------------------------------------------------------------------------------
</font>I have tended  <font color="#FF0000"><b>to </b></font>restore the  children<font color="#800000">'s status in  their own show  events
</font>like this<font color="#000080">:

--------------------------------------------------------------------------------

        </font>GlobalWinRestorer<font color="#000080">.</font>RestoreWin<font color="#000080">(</font>Self<font color="#000080">, [</font><font color="#FF0000"><b>default</b></font><font color="#000080">]);

--------------------------------------------------------------------------------
</font>though I am moving toward putting <font color="#FF0000"><b>in </b></font>the main form<font color="#800000">'s show event:
</font><font color="#000080">--------------------------------------------------------------------------------

        </font>GlobalWinRestorer<font color="#000080">.</font>RestoreWin<font color="#000080">(</font>Self<font color="#000080">, [</font><font color="#FF0000"><b>default</b></font><font color="#000080">]);
        </font>GlobalWinRestorer<font color="#000080">.</font>RestoreChildren<font color="#000080">(</font>Self<font color="#000080">, [</font><font color="#FF0000"><b>default</b></font><font color="#000080">]);

--------------------------------------------------------------------------------
</font>HINTS<font color="#000080">: </font><font color="#FF0000"><b>If </b></font>you <font color="#FF0000"><b>set </b></font>TForm<font color="#000080">.</font>Position  <font color="#FF0000"><b>to </b></font>poScreenCenter <font color="#FF0000"><b>or </b></font>anything fancy<font color="#000080">, </font>this
<font color="#FF0000"><b>unit  </b></font>won<font color="#800000">'t do  what you  expect. poDesigned  seems to  work fairly well. I
</font>could  have raised  an  exception  <font color="#FF0000"><b>if </b></font>you  <font color="#FF0000"><b>try to  set </b></font>top   <font color="#FF0000"><b>and </b></font>left  <font color="#FF0000"><b>of </b></font>a
poScreenCentere<font color="#800000">'d   form,  but   then  you   have  to   be  careful   using
</font>WinRestoreChildren<font color="#000080">. </font>I  opted <font color="#FF0000"><b>not to  </b></font>check the position  <font color="#FF0000"><b>property and </b></font>leave
that up <font color="#FF0000"><b>to </b></font>individual developers<font color="#000080">.


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>unit </b></font>WinRstor<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES </b></font>SysUtils<font color="#000080">, </font>Forms<font color="#000080">;

</font><font color="#FF0000"><b>TYPE </b></font><font color="#008000"><i>{=============================================================}


{------------------------------------------------------------------
Windows restorer object class and related types.
-------------------------------------------------------------------}
</i></font>EWinRestorer <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">( </font>Exception<font color="#000080">);
</font>TWhatSave <font color="#000080">= (</font><font color="#FF0000"><b>default</b></font><font color="#000080">, </font>size<font color="#000080">, </font>location<font color="#000080">, </font>state<font color="#000080">);
</font>STWhatSave <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>TWhatSave<font color="#000080">;
</font>TWinRestorer <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TObject<font color="#000080">)
 </font><font color="#FF0000"><b>protected
  </b></font>mIniFile<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>mIniSect<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
  </font>mIsInitialized<font color="#000080">: </font>boolean<font color="#000080">;
  </font>mDefaultWhat<font color="#000080">: </font>STWhatSave<font color="#000080">;
 </font><font color="#FF0000"><b>public
  constructor </b></font>Create<font color="#000080">( </font>TheApp<font color="#000080">: </font>TApplication<font color="#000080">;

    </font>LocalDir<font color="#000080">: </font>boolean<font color="#000080">; </font>DefaultWhatSave<font color="#000080">: </font>STWhatSave<font color="#000080">);
    </font><font color="#008000"><i>{If localDir is true, ini dir is the app dir.  Else, ini dir is the windows dir.}
  </i></font><font color="#FF0000"><b>procedure </b></font>SaveWin<font color="#000080">(</font>TheForm<font color="#000080">: </font>TForm<font color="#000080">; </font>What<font color="#000080">: </font>STWhatSave<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>SaveChildren<font color="#000080">(</font>TheMDIForm<font color="#000080">: </font>TForm<font color="#000080">; </font>What<font color="#000080">: </font>STWhatSave<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>RestoreWin<font color="#000080">( </font>TheForm<font color="#000080">: </font>TForm<font color="#000080">; </font>What<font color="#000080">: </font>STWhatSave<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>RestoreChildren<font color="#000080">(</font>TheMDIForm<font color="#000080">: </font>TForm<font color="#000080">; </font>What<font color="#000080">: </font>STWhatSave<font color="#000080">);
  </font><font color="#FF0000"><b>property </b></font>IniFileName<font color="#000080">: </font><font color="#FF0000"><b>string  read </b></font>mIniFile<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>WHATSAVE_ALL <font color="#000080">= [</font>size<font color="#000080">, </font>location<font color="#000080">, </font>state<font color="#000080">];


</font><font color="#FF0000"><b>VAR
</b></font>GlobalWinRestorer<font color="#000080">: </font>TWinRestorer<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

Uses </b></font>IniFiles<font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TWinRestorer<font color="#000080">.</font>create<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>fname<font color="#000080">, </font>path<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">100</font><font color="#000080">];
</font><font color="#FF0000"><b>begin
  inherited </b></font>create<font color="#000080">;
</font><font color="#008000"><i>{Calculate ini file name}
  </i></font><font color="#FF0000"><b>if default in </b></font>DefaultWhatSave <font color="#FF0000"><b>then
    raise </b></font>EWinRestorer<font color="#000080">.</font>create<font color="#000080">(
     </font><font color="#800000">'Attempt to initialize default window position paramaters with set ' </font><font color="#000080">+
     </font><font color="#800000">' containing [default] item.  ' </font><font color="#000080">+
     </font><font color="#800000">'Default params may contain only members of [size, location, state].  '</font><font color="#000080">)
  </font><font color="#FF0000"><b>else </b></font>mDefaultWhat <font color="#000080">:= </font>DefaultWhatSave<font color="#000080">;

  </font>fname <font color="#000080">:= </font>ChangeFileExt<font color="#000080">( </font>ExtractFileName<font color="#000080">( </font>TheApp<font color="#000080">.</font>exeName<font color="#000080">), </font><font color="#800000">'.INI'</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>LocalDir <font color="#FF0000"><b>then begin </b></font><font color="#008000"><i>{parse out path and add to file name}
    </i></font>path <font color="#000080">:= </font>ExtractFilePath<font color="#000080">(</font>TheApp<font color="#000080">.</font>exeName<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>path<font color="#000080">[</font>length<font color="#000080">(</font>path<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>then
      </b></font>path <font color="#000080">:= </font>path <font color="#000080">+ </font><font color="#800000">'\'</font><font color="#000080">;
    </font>fname <font color="#000080">:= </font>path <font color="#000080">+ </font>fname<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{fill object fields}
  </i></font>mIniFile <font color="#000080">:= </font>fname<font color="#000080">;
  </font>mIniSect <font color="#000080">:= </font><font color="#800000">'WindowsRestorer'</font><font color="#000080">;
</font><font color="#008000"><i>{It'd be nice to write some notes to a section called [WinRestorer Notes]}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TWinRestorer<font color="#000080">.</font>RestoreWin<font color="#000080">;

</font><font color="#FF0000"><b>var </b></font>FormNm<font color="#000080">, </font>SectionNm<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];   </font>ini<font color="#000080">: </font>TIniFile<font color="#000080">;
  </font>n<font color="#000080">,</font>l<font color="#000080">,</font>t<font color="#000080">,</font>w<font color="#000080">,</font>h<font color="#000080">: </font>integer<font color="#000080">; </font><font color="#008000"><i>{Left, Top Width, Height}
</i></font><font color="#FF0000"><b>begin
  </b></font>ini <font color="#000080">:= </font>TIniFile<font color="#000080">.</font>create<font color="#000080">( </font>mIniFile<font color="#000080">);
  </font><font color="#FF0000"><b>TRY
    </b></font>SectionNm <font color="#000080">:= </font>mIniSect<font color="#000080">;
    </font>FormNm <font color="#000080">:= </font>TheForm<font color="#000080">.</font>classname<font color="#000080">;
    </font><font color="#FF0000"><b>if default in </b></font>What <font color="#FF0000"><b>then </b></font>What <font color="#000080">:= </font>mDefaultWhat<font color="#000080">;
</font><font color="#008000"><i>{Update Window State if Necessary}
    </i></font><font color="#FF0000"><b>if </b></font>state <font color="#FF0000"><b>in </b></font>What <font color="#FF0000"><b>then
      </b></font>n <font color="#000080">:= </font>ini<font color="#000080">.</font>ReadInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_WindowState'</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>case  </b></font>n <font color="#FF0000"><b>of
        </b></font><font color="#800000">1</font><font color="#000080">:   </font>TheForm<font color="#000080">.</font>WindowState <font color="#000080">:= </font>wsMinimized<font color="#000080">;
        </font><font color="#800000">2</font><font color="#000080">:  </font>TheForm<font color="#000080">.</font>WindowState <font color="#000080">:= </font>wsNormal<font color="#000080">;

        </font><font color="#800000">3</font><font color="#000080">:   </font>TheForm<font color="#000080">.</font>WindowState <font color="#000080">:= </font>wsMaximized<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{Update Size and Location if necessary.}
    </i></font><font color="#FF0000"><b>with </b></font>TheForm <font color="#FF0000"><b>do begin </b></font>l<font color="#000080">:=</font>left<font color="#000080">; </font>t<font color="#000080">:=</font>top<font color="#000080">; </font>h<font color="#000080">:=</font>height<font color="#000080">; </font>w<font color="#000080">:=</font>width<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{Save current vals.}
    </i></font><font color="#FF0000"><b>if </b></font>size <font color="#FF0000"><b>in </b></font>What <font color="#FF0000"><b>then begin
      </b></font>w <font color="#000080">:= </font>ini<font color="#000080">.</font>ReadInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Width'</font><font color="#000080">, </font>w<font color="#000080">);
      </font>h <font color="#000080">:= </font>ini<font color="#000080">.</font>ReadInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Height'</font><font color="#000080">, </font>h<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>location <font color="#FF0000"><b>in </b></font>What <font color="#FF0000"><b>then begin
      </b></font>t <font color="#000080">:= </font>ini<font color="#000080">.</font>ReadInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Top'</font><font color="#000080">, </font>t<font color="#000080">);
      </font>l <font color="#000080">:= </font>ini<font color="#000080">.</font>ReadInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Left'</font><font color="#000080">, </font>l<font color="#000080">);

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>TheForm<font color="#000080">.</font>SetBounds<font color="#000080">(</font>l<font color="#000080">,</font>t<font color="#000080">,</font>w<font color="#000080">,</font>h<font color="#000080">);
  </font><font color="#FF0000"><b>FINALLY
    </b></font>ini<font color="#000080">.</font>free<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TWinRestorer<font color="#000080">.</font>RestoreChildren<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>TheMDIForm<font color="#000080">.</font>formstyle <font color="#000080">&lt;&gt; </font>fsMDIForm <font color="#FF0000"><b>then
    raise </b></font>EWinRestorer<font color="#000080">.</font>create<font color="#000080">(</font><font color="#800000">'Attempting to save window sizes of children for a non MDI parent window.'</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>TheMDIForm<font color="#000080">.</font>MDIChildCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>RestoreWin<font color="#000080">( </font>TheMDIForm<font color="#000080">.</font>MDIChildren<font color="#000080">[</font>i<font color="#000080">], </font>what<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TWinRestorer<font color="#000080">.</font>SaveWin<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>FormNm<font color="#000080">, </font>SectionNm<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];   </font>w <font color="#000080">: </font>STWhatsave<font color="#000080">; </font>ini<font color="#000080">: </font>TIniFile<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>ini <font color="#000080">:= </font>TIniFile<font color="#000080">.</font>create<font color="#000080">( </font>mIniFile<font color="#000080">);
  </font><font color="#FF0000"><b>TRY
    </b></font>SectionNm <font color="#000080">:= </font>mIniSect<font color="#000080">;
    </font>FormNm <font color="#000080">:= </font>TheForm<font color="#000080">.</font>ClassName<font color="#000080">;
    </font><font color="#FF0000"><b>if default in </b></font>What <font color="#FF0000"><b>then </b></font>w <font color="#000080">:= </font>mDefaultWhat <font color="#FF0000"><b>else </b></font>w <font color="#000080">:= </font>mDefaultWhat<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>size <font color="#FF0000"><b>in </b></font>w <font color="#FF0000"><b>then begin
      </b></font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Width'</font><font color="#000080">, </font>TheForm<font color="#000080">.</font>Width<font color="#000080">);
      </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Height'</font><font color="#000080">, </font>TheForm<font color="#000080">.</font>Height<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>location <font color="#FF0000"><b>in </b></font>w <font color="#FF0000"><b>then begin
      </b></font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Top'</font><font color="#000080">, </font>TheForm<font color="#000080">.</font>Top<font color="#000080">);
      </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_Left'</font><font color="#000080">, </font>TheForm<font color="#000080">.</font>Left<font color="#000080">);

    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>state <font color="#FF0000"><b>in </b></font>w <font color="#FF0000"><b>then
      case </b></font>TheForm<font color="#000080">.</font>WindowState <font color="#FF0000"><b>of
        </b></font>wsMinimized<font color="#000080">:   </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_WindowState'</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
        </font>wsNormal<font color="#000080">:     </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_WindowState'</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
        </font>wsMaximized<font color="#000080">:   </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">( </font>SectionNm<font color="#000080">, </font>FormNm <font color="#000080">+ </font><font color="#800000">'_WindowState'</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>FINALLY
    </b></font>ini<font color="#000080">.</font>free<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TWinRestorer<font color="#000080">.</font>SaveChildren<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>TheMDIForm<font color="#000080">.</font>formstyle <font color="#000080">&lt;&gt; </font>fsMDIForm <font color="#FF0000"><b>then
    raise </b></font>EWinRestorer<font color="#000080">.</font>create<font color="#000080">(</font><font color="#800000">'Attempting to restore window sizes of children for a non MDI parent window.'</font><font color="#000080">)

  </font><font color="#FF0000"><b>else
    for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>TheMDIForm<font color="#000080">.</font>MDIChildCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
      </b></font>SaveWin<font color="#000080">( </font>TheMDIForm<font color="#000080">.</font>MDIChildren<font color="#000080">[</font>i<font color="#000080">], </font>what<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>INITIALIZATION
END</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0431.PAS">Original</a><b>]</b></p></body>
</html>
