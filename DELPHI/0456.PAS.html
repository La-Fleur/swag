<html>
<head><title> "Fido Mail Unit for D2" by OZZ NIXON JR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0456.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>MKMsgFido32<font color="#000080">;       </font><font color="#008000"><i>{Fido Object *.Msg Unit}

///////////////////////////////////////////////////////////////////////////////
// MKMsgFIDO32 Coded in Part by G.E. Ozz Nixon Jr. of www.warpgroup.com      //
// ========================================================================= //
// Original Source for DOS by Mythical Kindom's Mark May (mmay@dnaco.net)    //
// Re-written and distributed with permission!                               //
// See Original Copyright Notice before using any of this code!              //
///////////////////////////////////////////////////////////////////////////////

</i></font><font color="#FF0000"><b>Interface

Uses
   </b></font>MkFidoAddr32<font color="#000080">,
   </font>Classes<font color="#000080">;

</font><font color="#FF0000"><b>Const
   </b></font>Version<font color="#000080">=</font><font color="#800000">'9.19.97'</font><font color="#000080">;
   </font>MaxFidMsgArray<font color="#000080">=</font><font color="#800000">4000</font><font color="#000080">;
   </font>MaxFidMsgNum<font color="#000080">=(</font>MaxFidMsgArray<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;

</font><font color="#FF0000"><b>Type
   </b></font>MsgMailType <font color="#000080">= (</font>mtNormal<font color="#000080">, </font>mtEchoMail<font color="#000080">, </font>mtNetMail<font color="#000080">);

   </font>TFidoMsgBase <font color="#000080">= </font><font color="#FF0000"><b>Class</b></font><font color="#000080">(</font>TComponent<font color="#000080">)
   </font><font color="#FF0000"><b>private
      </b></font>LastSoft<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>FActive<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>TextCtr<font color="#000080">:</font>LongInt<font color="#000080">;
      </font>MsgPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MsgPathExists<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>LastPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MKMsgFrom<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MKMsgTo<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MKMsgSubj<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MKMsgDate<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MKMsgTime<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>TmpName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{now is the msg text in ram!}
      </i></font>TmpOpen<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>MsgFile<font color="#000080">:</font><font color="#FF0000"><b>File</b></font><font color="#000080">;
      </font>Error<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#008000"><i>{      NetMailPath:String;}
      </i></font>Dest<font color="#000080">:</font>AddrType<font color="#000080">;
      </font>Orig<font color="#000080">:</font>AddrType<font color="#000080">;
      </font>MsgStart<font color="#000080">:</font>LongInt<font color="#000080">;
      </font>MsgEnd<font color="#000080">:</font>LongInt<font color="#000080">;
      </font>MsgDone<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>CurrMsg<font color="#000080">:</font>LongInt<font color="#000080">;
      </font>SeekOver<font color="#000080">:</font>Boolean<font color="#000080">;
      </font>YoursName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>YoursHandle<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>MailType<font color="#000080">:</font>MsgMailType<font color="#000080">;
      </font>MsgPresent<font color="#000080">:</font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxFidMsgArray<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
      </font>MKMsgReplyTo<font color="#000080">:</font>Longint<font color="#000080">;
      </font>MkMsgFlagLow<font color="#000080">:</font>Byte<font color="#000080">;
      </font>MkMsgFlagHigh<font color="#000080">:</font>Byte<font color="#000080">;
      </font>MkMsgNextReply<font color="#000080">:</font>Longint<font color="#000080">;
      </font>MkMsgCost<font color="#000080">:</font>Word<font color="#000080">;
      </font>MsgOpen<font color="#000080">:</font>Boolean<font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>MsgExists<font color="#000080">(</font>MsgNum<font color="#000080">:</font>LongInt<font color="#000080">):</font>Boolean<font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>CheckLine<font color="#000080">(</font>TStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>Procedure </b></font>Rescan<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>Function  </b></font>MKGetHighMsgNumber<font color="#000080">:</font>Longint<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetCost<font color="#000080">(</font>Value<font color="#000080">:</font>Word<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetCost<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetNextSeeAlso<font color="#000080">:</font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetNextSeeAlso<font color="#000080">(</font>Value<font color="#000080">:</font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetLocal<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetRcvd<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetPriv<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetCrash<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetKillSent<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetSent<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetFAttach<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetReqRct<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetReqAud<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetRetRct<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetFileReq<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsLocal<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsCrash<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsKillSent<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsSent<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsFAttach<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsReqRct<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsReqAud<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsRetRct<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsFileReq<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsRcvd<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsPriv<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsDeleted<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>IsEchoed<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetMailType<font color="#000080">(</font>Value<font color="#000080">: </font>MsgMailType<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetActive<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>MKMsgBaseExists<font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>MKSeekFound<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>MKYoursFound<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>MKNumberOfMsgs<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>public
      Constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">:</font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>LockMsgBase<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>UnLockMsgBase<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>DoString<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>DoChar<font color="#000080">(</font>Ch<font color="#000080">: </font>Char<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>DoStringLn<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>DoKludgeLn<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>WriteMsg<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetChar<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>MsgStartUp<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetString<font color="#000080">(</font>MaxLen<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SeekFirst<font color="#000080">(</font>MsgNum<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SeekNext<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SeekPrior<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetMsgLoc<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetMsgLoc<font color="#000080">(</font>ML<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>YoursFirst<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Handle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>YoursNext<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>StartNewMsg<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>OpenMsgBase<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>CloseMsgBase<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>CreateMsgBase<font color="#000080">(</font>MaxMsg<font color="#000080">: </font>Word<font color="#000080">; </font>MaxDays<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>ReWriteHdr<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>DeleteMsg<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetLastRead<font color="#000080">(</font>UNum<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetLastRead<font color="#000080">(</font>UNum<font color="#000080">: </font>LongInt<font color="#000080">; </font>LR<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>MsgTxtStartUp<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetTxtPos<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetTxtPos<font color="#000080">(</font>TP<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Function  </b></font>GetSubArea<font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>Procedure </b></font>SetEcho<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>Virtual</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Published
      property  </b></font>Active<font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>FActive <font color="#FF0000"><b>write </b></font>SetActive<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>MsgPathFileName<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MsgPath <font color="#FF0000"><b>write </b></font>Rescan<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>GetHighMsgNum<font color="#000080">: </font>LongInt <font color="#FF0000"><b>read </b></font>MKGetHighMsgNumber<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrDest<font color="#000080">: </font>AddrType <font color="#FF0000"><b>read </b></font>Dest <font color="#FF0000"><b>write </b></font>Dest<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrOrig<font color="#000080">: </font>AddrType <font color="#FF0000"><b>read </b></font>Orig <font color="#FF0000"><b>write </b></font>Orig<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrFrom<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MKMsgFrom <font color="#FF0000"><b>write </b></font>MKMsgFrom<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrTo<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MKMsgTo <font color="#FF0000"><b>write </b></font>MKMsgTo<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrSubj<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MKMsgSubj <font color="#FF0000"><b>write </b></font>MKMsgSubj<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrCost<font color="#000080">: </font>Word <font color="#FF0000"><b>read </b></font>GetCost <font color="#FF0000"><b>write </b></font>SetCost<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrRefer<font color="#000080">: </font>LongInt <font color="#FF0000"><b>read </b></font>MkMsgReplyTo <font color="#FF0000"><b>write </b></font>MkMsgReplyTo<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrSeeAlso<font color="#000080">: </font>LongInt <font color="#FF0000"><b>read </b></font>MkMsgNextReply <font color="#FF0000"><b>write </b></font>MkMsgNextReply<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrNextSeeAlso<font color="#000080">: </font>LongInt <font color="#FF0000"><b>read </b></font>GetNextSeeAlso <font color="#FF0000"><b>write </b></font>SetNextSeeAlso<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrDate<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MKMsgDate <font color="#FF0000"><b>write </b></font>MKMsgDate<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrTime<font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>MKMsgTime <font color="#FF0000"><b>write </b></font>MKMsgTime<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrLocal<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsLocal <font color="#FF0000"><b>write </b></font>SetLocal<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrReceived<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsRcvd <font color="#FF0000"><b>write </b></font>SetRcvd<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrPrivate<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsRcvd <font color="#FF0000"><b>write </b></font>SetPriv<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrCrash<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsCrash <font color="#FF0000"><b>write </b></font>SetCrash<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrKillSend<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsKillSent <font color="#FF0000"><b>write </b></font>SetKillSent<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrSent<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsSent <font color="#FF0000"><b>write </b></font>SetSent<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrFileAttach<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>IsFAttach <font color="#FF0000"><b>write </b></font>SetFAttach<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrRequestReceipt<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isReqRct <font color="#FF0000"><b>write </b></font>SetReqRct<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrRequestAudit<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isReqAud <font color="#FF0000"><b>write </b></font>SetReqAud<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrReturnReceipt<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isRetRct <font color="#FF0000"><b>write </b></font>SetRetRct<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrFileRequest<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isFileReq <font color="#FF0000"><b>write </b></font>SetFileReq<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrDelete<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isDeleted<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>HdrAttrEchoed<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>isEchoed <font color="#FF0000"><b>write </b></font>SetEcho<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>EndOfMsgText<font color="#000080">:</font>Boolean <font color="#FF0000"><b>read </b></font>MsgDone<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>WasWrap<font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>LastSoft<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>MsgBaseExists<font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>MKMsgBaseExists<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>SeekFound<font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>MKSeekFound<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>YoursFound<font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>MKyoursFound<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>HdrMailType<font color="#000080">:</font>MsgMailType <font color="#FF0000"><b>read </b></font>MailType <font color="#FF0000"><b>write </b></font>SetMailType<font color="#000080">;
      </font><font color="#FF0000"><b>Property  </b></font>MsgNumber<font color="#000080">:</font>Longint <font color="#FF0000"><b>read </b></font>CurrMsg<font color="#000080">;
      </font><font color="#FF0000"><b>property  </b></font>NumberOfMsgs<font color="#000080">: </font>LongInt <font color="#FF0000"><b>read </b></font>MkNumberofMsgs<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Uses
   </b></font>SysUtils<font color="#000080">,
   </font>MKFile32<font color="#000080">,
   </font>MKString32<font color="#000080">;

</font><font color="#FF0000"><b>Const
   </b></font>PosArray<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">16</font><font color="#000080">, </font><font color="#800000">32</font><font color="#000080">, </font><font color="#800000">64</font><font color="#000080">, </font><font color="#800000">128</font><font color="#000080">);

</font><font color="#FF0000"><b>Type
   </b></font>NetMsg<font color="#000080">=</font><font color="#FF0000"><b>RECORD
      </b></font>FromUser  <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">36</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
      </font>ToUser    <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">36</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
      </font>subj      <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">72</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
      </font>dateTime  <font color="#000080">: </font><font color="#FF0000"><b>ARRAY</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">20</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">; </font><font color="#008000"><i>{ 01 Jan 86  02:34:56 }
      </i></font>timesRead <font color="#000080">: </font>Word<font color="#000080">;
      </font>destNode  <font color="#000080">: </font>Word<font color="#000080">;
      </font>origNode  <font color="#000080">: </font>Word<font color="#000080">;
      </font>cost      <font color="#000080">: </font>Word<font color="#000080">;
      </font>origNet   <font color="#000080">: </font>Word<font color="#000080">;
      </font>destNet   <font color="#000080">: </font>Word<font color="#000080">;
      </font>destZone  <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ optional; was sentTime }
      </i></font>origZone  <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ optional; was sentTime }
      </i></font>destPoint <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ optional; was readTime }
      </i></font>origPoint <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#008000"><i>{ optional; was readTime }
      </i></font>replyTo   <font color="#000080">: </font>Word<font color="#000080">;
      </font>flag1     <font color="#000080">: </font>Byte<font color="#000080">;
      </font>flag2     <font color="#000080">: </font>Byte<font color="#000080">;
      </font>nextReply <font color="#000080">: </font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>TFidoMsgBase<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">:</font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   Inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
   </font>MsgPathFileName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>TextCtr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>FillChar<font color="#000080">(</font>Dest<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Dest<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
   </font>FillChar<font color="#000080">(</font>Orig<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Orig<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
   </font>SeekOver<font color="#000080">:=</font>False<font color="#000080">;
   </font>TmpOpen<font color="#000080">:=</font>False<font color="#000080">;
   </font>TmpName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>LastPath<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>MsgPath<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>LastSoft<font color="#000080">:=</font>False<font color="#000080">;
   </font>FActive<font color="#000080">:=</font>False<font color="#000080">;
   </font>MKMsgFrom<font color="#000080">:=</font><font color="#800000">'Noone'</font><font color="#000080">;
   </font>MKMsgTo<font color="#000080">:=</font><font color="#800000">'Noone'</font><font color="#000080">;
   </font>MKMsgSubj<font color="#000080">:=</font><font color="#800000">'MsgBase Not Active yet'</font><font color="#000080">;
   </font>MKMsgDate<font color="#000080">:=</font><font color="#800000">'mm-dd-yy'</font><font color="#000080">;
   </font>MKMsgTime<font color="#000080">:=</font><font color="#800000">'hh:mm'</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>TFidoMsgBase<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TmpOpen <font color="#FF0000"><b>Then </b></font>TmpName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{Procedure TFidoMsgBase.PutLong(L: LongInt; Position: LongInt);
  Var
    i: Integer;

  Begin
  If FM^.MsgFile.SeekFile(Position) Then
    If FM^.MsgFile.BlkWrite(L, SizeOf(LongInt)) Then;
  End;


Procedure TFidoMsgBase.PutWord(W: Word; Position: LongInt);
  Begin
  If FM^.MsgFile.SeekFile(Position) Then
    If FM^.MsgFile.BlkWrite(W, SizeOf(Word)) Then;
  End;


Procedure TFidoMsgBase.PutByte(B: Byte; Position: LongInt);
  Begin
  If FM^.MsgFile.SeekFile(Position) Then
    If FM^.MsgFile.BlkWrite(B, SizeOf(Byte)) Then;
  End;


Function TFidoMsgBase.GetByte(Position: LongInt): Byte;
  Var
    B: Byte;
    NumRead: Word;

  Begin
  If FM^.MsgFile.SeekFile(Position) Then
    If FM^.MsgFile.BlkRead(B, SizeOf(Byte), NumRead) Then;
  GetByte := b;
  End;


Procedure TFidoMsgBase.PutNullStr(St: String; Position: LongInt);
  Var
    i: Byte;

  Begin
  i := 0;
  If FM^.MsgFile.SeekFile(Position) Then
    Begin
    If FM^.MsgFile.BlkWrite(St[1], Length(St)) Then;
    If FM^.MsgFile.BlkWrite(i, 1) Then;
    End;
  End; }

</i></font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MKGetHighMsgNumber<font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
  </b></font>Highest<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Cnt<font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>Cnt<font color="#000080">:=</font>MaxFidMsgArray<font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>Cnt<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">]=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Do </b></font>Dec<font color="#000080">(</font>Cnt<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>Cnt<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Highest<font color="#000080">:=</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else Begin
      </b></font>Highest<font color="#000080">:=</font>Cnt<font color="#000080">*</font><font color="#800000">8</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$40</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$20</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$10</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$08</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$04</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)
      </font><font color="#FF0000"><b>Else If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$02</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Highest<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>MkGetHighMsgNumber<font color="#000080">:=</font>Highest<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>MonthStr<font color="#000080">(</font>MoNo<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  Case </b></font>MoNo <font color="#FF0000"><b>of
    </b></font><font color="#800000">01</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Jan'</font><font color="#000080">;
    </font><font color="#800000">02</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Feb'</font><font color="#000080">;
    </font><font color="#800000">03</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Mar'</font><font color="#000080">;
    </font><font color="#800000">04</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Apr'</font><font color="#000080">;
    </font><font color="#800000">05</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'May'</font><font color="#000080">;
    </font><font color="#800000">06</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Jun'</font><font color="#000080">;
    </font><font color="#800000">07</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Jul'</font><font color="#000080">;
    </font><font color="#800000">08</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Aug'</font><font color="#000080">;
    </font><font color="#800000">09</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Sep'</font><font color="#000080">;
    </font><font color="#800000">10</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Oct'</font><font color="#000080">;
    </font><font color="#800000">11</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Nov'</font><font color="#000080">;
    </font><font color="#800000">12</font><font color="#000080">: </font>MonthStr <font color="#000080">:= </font><font color="#800000">'Dec'</font><font color="#000080">;
    </font><font color="#FF0000"><b>Else
      </b></font>MonthStr <font color="#000080">:= </font><font color="#800000">'???'</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetLocal<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>then </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>or </b></font><font color="#800000">1
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetRcvd<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">4
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetPriv<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">1
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetCrash<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">2
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetKillSent<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">128
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">128</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetSent<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">8
   </font><font color="#FF0000"><b>Else  </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">8</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetFAttach<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>or </b></font><font color="#800000">16
   </font><font color="#FF0000"><b>Else  </b></font>MKMsgFlagLow<font color="#000080">:=</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">16</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetReqRct<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>or </b></font><font color="#800000">16
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">16</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetReqAud<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>or </b></font><font color="#800000">64
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">64</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetRetRct<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>or </b></font><font color="#800000">32
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">32</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetFileReq<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Value <font color="#FF0000"><b>Then </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>or </b></font><font color="#800000">8
   </font><font color="#FF0000"><b>Else </b></font>MKMsgFlagHigh<font color="#000080">:=</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font><font color="#800000">8</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>DoString<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>TmpName<font color="#000080">:=</font>TmpName<font color="#000080">+</font>Str<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TextCtr<font color="#000080">&lt;&gt;</font>Length<font color="#000080">(</font>TmpName<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>TextCtr<font color="#000080">:=</font>Length<font color="#000080">(</font>TmpName<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>DoChar<font color="#000080">(</font>Ch<font color="#000080">:</font>Char<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>TmpName<font color="#000080">:=</font>TmpName<font color="#000080">+</font>Ch<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TextCtr<font color="#000080">&lt;&gt;</font>Length<font color="#000080">(</font>TmpName<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>TextCtr<font color="#000080">:=</font>Length<font color="#000080">(</font>TmpName<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>DoStringLn<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>DoString<font color="#000080">(</font>Str<font color="#000080">);
   </font>DoChar<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>TFidoMsgBase<font color="#000080">.</font>WriteMsg<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>NetNum<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DoChar<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">);
   </font>NetNum<font color="#000080">:=</font>GetHighMsgNum<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font>FileExist<font color="#000080">(</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>NetNum<font color="#000080">)+</font><font color="#800000">'.Msg'</font><font color="#000080">) </font><font color="#FF0000"><b>do Begin </b></font><font color="#008000"><i>{loop jic!}
      </i></font>LastPath<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font>Rescan<font color="#000080">(</font>MsgPath<font color="#000080">);
      </font>NetNum<font color="#000080">:=</font>GetHighMsgNum<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>MsgPresent<font color="#000080">[</font>NetNum <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">]:=</font>MsgPresent<font color="#000080">[</font>NetNum <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>or </b></font>PosArray<font color="#000080">[</font>NetNum <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">];
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Dest<font color="#000080">.</font>Point<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MailType<font color="#000080">=</font>mtNetmail<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>TmpName<font color="#000080">:=</font><font color="#800000">#1</font><font color="#000080">+</font><font color="#800000">'TOPT '</font><font color="#000080">+</font>Long2Str<font color="#000080">(</font>Dest<font color="#000080">.</font>Point<font color="#000080">)+</font><font color="#800000">#13</font><font color="#000080">+</font>TmpName<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Orig<font color="#000080">.</font>Zone<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MailType<font color="#000080">=</font>mtNetMail<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>TmpName<font color="#000080">:=</font><font color="#800000">#1</font><font color="#000080">+</font><font color="#800000">'INTL '</font><font color="#000080">+</font>PointlessAddrStr<font color="#000080">(</font>Dest<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">+</font>PointlessAddrStr<font color="#000080">(</font>Orig<font color="#000080">)+
         </font><font color="#800000">#13</font><font color="#000080">+</font>TmpName<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Orig<font color="#000080">.</font>Point<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MailType<font color="#000080">=</font>mtNetmail<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>TmpName<font color="#000080">:=</font><font color="#800000">#1</font><font color="#000080">+</font><font color="#800000">'FMPT '</font><font color="#000080">+</font>Long2Str<font color="#000080">(</font>Dest<font color="#000080">.</font>Point<font color="#000080">)+</font><font color="#800000">#13</font><font color="#000080">+</font>TmpName<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Dest<font color="#000080">.</font>Zone<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MailType<font color="#000080">=</font>mtNetmail<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>TmpName<font color="#000080">:=</font><font color="#800000">#1</font><font color="#000080">+</font><font color="#800000">'INTL '</font><font color="#000080">+</font>PointlessAddrStr<font color="#000080">(</font>Dest<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">+
         </font>PointlessAddrStr<font color="#000080">(</font>Orig<font color="#000080">)+</font><font color="#800000">#13</font><font color="#000080">+</font>TmpName<font color="#000080">;
   </font>AssignFile<font color="#000080">(</font>MsgFile<font color="#000080">,</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>NetNum<font color="#000080">)+</font><font color="#800000">'.Msg'</font><font color="#000080">);
   </font><font color="#008000"><i>{$I-} </i></font>Rewrite<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>MsgOpen<font color="#000080">:=</font>True<font color="#000080">;
   </font>RewriteHdr<font color="#000080">;
   </font>Seek<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">190</font><font color="#000080">);
   </font>BlockWrite<font color="#000080">(</font>MsgFile<font color="#000080">,</font>TmpName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Length<font color="#000080">(</font>TmpName<font color="#000080">));
   </font>CloseFile<font color="#000080">(</font>MsgFile<font color="#000080">);
   </font><font color="#008000"><i>{$I+}
   </i></font>MsgOpen<font color="#000080">:=</font>False<font color="#000080">;
   </font>Error<font color="#000080">:=</font>IOResult<font color="#000080">;
   </font>TmpName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>TmpOpen<font color="#000080">:=</font>False<font color="#000080">;
   </font>WriteMsg<font color="#000080">:=</font>Error<font color="#000080">;
   </font>CurrMsg<font color="#000080">:=</font>NetNum<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetChar<font color="#000080">:</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Ch<font color="#000080">:</font>Char<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font>TextCtr<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>TextCtr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TextCtr<font color="#000080">&gt;</font>Length<font color="#000080">(</font>TmpName<font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>Ch<font color="#000080">:=</font><font color="#800000">#0
   </font><font color="#FF0000"><b>Else Begin
      </b></font>Ch<font color="#000080">:=</font>TmpName<font color="#000080">[</font>TextCtr<font color="#000080">];
      </font>Inc<font color="#000080">(</font>TextCtr<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>MsgDone<font color="#000080">:=</font>Ch<font color="#000080">=</font><font color="#800000">#0</font><font color="#000080">;
   </font>GetChar<font color="#000080">:=</font>Ch<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MonthNum<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  </b></font>ST <font color="#000080">:= </font>Upper<font color="#000080">(</font>St<font color="#000080">);
  </font>MonthNum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'JAN' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">01</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'FEB' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">02</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'MAR' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">03</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'APR' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">04</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'MAY' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">05</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'JUN' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">06</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'JUL' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">07</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'AUG' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">08</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'SEP' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">09</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'OCT' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'NOV' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>St <font color="#000080">= </font><font color="#800000">'DEC' </font><font color="#FF0000"><b>Then </b></font>MonthNum <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{
Function TFidoMsgBase.BufferWord(i: Word):Word;
  Begin
  BufferWord := BufferByte(i) + (BufferByte(i + 1) shl 8);
  End;


Function TFidoMsgBase.BufferByte(i: Word):Byte;
  Begin
  BufferByte := GetByte(i);
  End;


Function TFidoMsgBase.BufferNullString(i: Word; Max: Word): String;
Var
   Ctr: Word;
   CurrPos: Word;

Begin
   BufferNullString := '';
   Ctr := i;
   CurrPos := 0;
   While ((CurrPos&lt;Max) and (GetByte(Ctr)&lt;&gt;0)) Do Begin
    Inc(CurrPos);
    BufferNullString[CurrPos] := Chr(GetByte(Ctr));
    Inc(Ctr);
    End;
   BufferNullString[0] := Chr(CurrPos);
End;
}

</i></font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>CheckLine<font color="#000080">(</font>TStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
   </b></font>TmpStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">#10 </font><font color="#FF0000"><b>Then </b></font>Delete<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">#01 </font><font color="#FF0000"><b>Then </b></font>Delete<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Upper<font color="#000080">(</font>Copy<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">))=</font><font color="#800000">'INTL'</font><font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>TmpStr<font color="#000080">:=</font>StripBoth<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">);
      </font>Dest<font color="#000080">.</font>Zone<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>TmpStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>TmpStr<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
      </font>TmpStr<font color="#000080">:=</font>StripBoth<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">);
      </font>Orig<font color="#000080">.</font>Zone<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>TmpStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">,</font>TmpStr<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Upper<font color="#000080">(</font>Copy<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">))=</font><font color="#800000">'TOPT'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Dest<font color="#000080">.</font>Point<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>StripBoth<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Upper<font color="#000080">(</font>Copy<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">))=</font><font color="#800000">'FMPT'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Orig<font color="#000080">.</font>Point<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>StripBoth<font color="#000080">(</font>ExtractWord<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>MsgStartUp<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>NumRead<font color="#000080">:</font>Integer<font color="#000080">;
   </font>NetRec<font color="#000080">:</font>NetMsg<font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Az2Str<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>MaxLen<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert asciiz to string}
</i></font><font color="#FF0000"><b>Var
   </b></font>i<font color="#000080">: </font>Word<font color="#000080">;
   </font>TmpStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>SetLength<font color="#000080">(</font>TmpStr<font color="#000080">,</font>MaxLen<font color="#000080">);
   </font>Move<font color="#000080">(</font>Str<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>TmpStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>MaxLen<font color="#000080">);
   </font>i <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">, </font>TmpStr<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>i <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>TmpStr<font color="#000080">:=</font>Copy<font color="#000080">(</font>TmpStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
   </font>Az2Str <font color="#000080">:= </font>TmpStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>CvtDate<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TmpStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>i<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>MKMsgtime<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MKMsgDate<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then Begin </b></font><font color="#008000"><i>{Fido or Opus}
      </i></font><font color="#FF0000"><b>If </b></font>MKMsgDate<font color="#000080">[</font><font color="#800000">11</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then Begin </b></font><font color="#008000"><i>{Fido DD MON YY  HH:MM:SSZ}
         </i></font>MKMsgTime<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
         </font>TmpStr<font color="#000080">:=</font>Long2Str<font color="#000080">(</font>MonthNum<font color="#000080">(</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)));
      </font><font color="#FF0000"><b>End
      Else Begin </b></font><font color="#008000"><i>{Opus DD MON YY HH:MM:SS}
         </i></font>MKMsgTime<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDaTe<font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
         </font>TmpStr<font color="#000080">:=</font>Long2Str<font color="#000080">(</font>MonthNum<font color="#000080">(</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)));
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>TmpStr<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>TmpStr<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>TmpStr<font color="#000080">;
     </font>MKMsgDate<font color="#000080">:=</font>TmpStr<font color="#000080">+</font><font color="#800000">'-'</font><font color="#000080">+</font>Copy<font color="#000080">(</font>MKMsgDaTe<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
   </font><font color="#FF0000"><b>End
   Else Begin
      If </b></font>MKMsgDaTe<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then Begin </b></font><font color="#008000"><i>{SeaDog format DOW DD MON YY HH:MM}
         </i></font>MKMsgTime<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDaTe<font color="#000080">,</font><font color="#800000">15</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
         </font>TmpStr<font color="#000080">:=</font>Long2Str<font color="#000080">(</font>MonthNum<font color="#000080">(</font>Copy<font color="#000080">(</font>MKMsgDaTe<font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)));
         </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>TmpStr<font color="#000080">)=</font><font color="#800000">1 </font><font color="#FF0000"><b>Then </b></font>TmpStr<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>TmpStr<font color="#000080">;
         </font>MKMsgDate<font color="#000080">:=</font>TmpStr<font color="#000080">+</font><font color="#800000">'-'</font><font color="#000080">+</font>Copy<font color="#000080">(</font>MKMsgDaTe<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>End
      Else Begin
         If </b></font>MKMsgDaTe<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]=</font><font color="#800000">'-' </font><font color="#FF0000"><b>Then Begin </b></font><font color="#008000"><i>{Wierd format DD-MM-YYYY HH:MM:SS}
            </i></font>MKMsgTime<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);
            </font>MKMsgDate<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)+</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)+</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>CvtDate<font color="#000080">:=</font>MKMsgTime<font color="#000080">&lt;&gt;</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>MKMsgTime<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then Begin
      For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">5 </font><font color="#FF0000"><b>Do
         If </b></font>MKMsgTime<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>MKMsgTime<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do
         If </b></font>MKMsgDate<font color="#000080">[</font>i<font color="#000080">]=</font><font color="#800000">' ' </font><font color="#FF0000"><b>Then </b></font>MKMsgDate<font color="#000080">[</font>i<font color="#000080">]:=</font><font color="#800000">'0'</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>MKMsgDate<font color="#000080">)&lt;&gt;</font><font color="#800000">8 </font><font color="#FF0000"><b>Then </b></font>CvtDate<font color="#000080">:=</font>False<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>MKMsgTime<font color="#000080">)&lt;&gt;</font><font color="#800000">5 </font><font color="#FF0000"><b>Then </b></font>CvtDate<font color="#000080">:=</font>False<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>MsgDone<font color="#000080">:=</font>True<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>TmpOpen <font color="#FF0000"><b>Then </b></font>TmpName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>LastSoft<font color="#000080">:=</font>False<font color="#000080">;
   </font>MsgEnd<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>TextCtr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>FileExist<font color="#000080">(</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>CurrMsg<font color="#000080">)+</font><font color="#800000">'.MSG'</font><font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>AssignFile<font color="#000080">(</font>MsgFile<font color="#000080">,</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>CurrMsg<font color="#000080">)+</font><font color="#800000">'.MSG'</font><font color="#000080">);
      </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
      </i></font>Error<font color="#000080">:=</font>IOResult<font color="#000080">;
      </font>FillChar<font color="#000080">(</font>NetRec<font color="#000080">,</font>Sizeof<font color="#000080">(</font>NetRec<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Error<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin
         </b></font>MsgDone<font color="#000080">:=</font>False<font color="#000080">;
         </font><font color="#008000"><i>{$I-} </i></font>BlockRead<font color="#000080">(</font>MsgFile<font color="#000080">,</font>NetRec<font color="#000080">,</font>Sizeof<font color="#000080">(</font>NetRec<font color="#000080">),</font>NumRead<font color="#000080">); </font><font color="#008000"><i>{$I+}
         </i></font>Error<font color="#000080">:=</font>IOResult<font color="#000080">;
         </font>TextCtr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
         </font>SetLength<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">);
         </font>Move<font color="#000080">(</font>NetRec<font color="#000080">.</font>FromUser<font color="#000080">,</font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">35</font><font color="#000080">);
         </font>MKMsgFrom<font color="#000080">:=</font>Az2Str<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">);
         </font>Move<font color="#000080">(</font>NetRec<font color="#000080">.</font>ToUser<font color="#000080">,</font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">35</font><font color="#000080">);
         </font>MKMsgTo<font color="#000080">:=</font>Az2Str<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">35</font><font color="#000080">);
         </font>SetLength<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">72</font><font color="#000080">);
         </font>Move<font color="#000080">(</font>NetRec<font color="#000080">.</font>Subj<font color="#000080">,</font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">71</font><font color="#000080">);
         </font>MKMsgSubj<font color="#000080">:=</font>Az2Str<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">72</font><font color="#000080">);
         </font>SetLength<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
         </font>Move<font color="#000080">(</font>NetRec<font color="#000080">.</font>DateTime<font color="#000080">,</font>TStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">20</font><font color="#000080">);
         </font>MKMsgDate<font color="#000080">:=</font>PadRight<font color="#000080">(</font>Az2Str<font color="#000080">(</font>TStr<font color="#000080">,</font><font color="#800000">20</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
         </font><font color="#008000"><i>{timesRead : Word; (unused!)}
         </i></font>Dest<font color="#000080">.</font>Node<font color="#000080">:=</font>NetRec<font color="#000080">.</font>destNode<font color="#000080">;
         </font>Orig<font color="#000080">.</font>Node<font color="#000080">:=</font>NetRec<font color="#000080">.</font>origNode<font color="#000080">;
         </font>MKMsgcost<font color="#000080">:=</font>NetRec<font color="#000080">.</font>Cost<font color="#000080">;
         </font>Orig<font color="#000080">.</font>Net<font color="#000080">:=</font>NetRec<font color="#000080">.</font>origNet<font color="#000080">;
         </font>Dest<font color="#000080">.</font>Net<font color="#000080">:=</font>NetRec<font color="#000080">.</font>destNet<font color="#000080">;
         </font>Dest<font color="#000080">.</font>Zone<font color="#000080">:=</font>NetRec<font color="#000080">.</font>destZone<font color="#000080">;
         </font>Orig<font color="#000080">.</font>Zone<font color="#000080">:=</font>NetRec<font color="#000080">.</font>origZone<font color="#000080">;
         </font>Dest<font color="#000080">.</font>Point<font color="#000080">:=</font>NetRec<font color="#000080">.</font>destPoint<font color="#000080">;
         </font>Orig<font color="#000080">.</font>Point<font color="#000080">:=</font>NetRec<font color="#000080">.</font>origPoint<font color="#000080">;
         </font>MkMsgReplyTo<font color="#000080">:=</font>NetRec<font color="#000080">.</font>replyTo<font color="#000080">;
         </font>MkMsgFlagLow<font color="#000080">:=</font>NetRec<font color="#000080">.</font>flag1<font color="#000080">;
         </font>MKMsgFlagHigh<font color="#000080">:=</font>NetRec<font color="#000080">.</font>flag2<font color="#000080">;
         </font>MKMsgNextReply<font color="#000080">:=</font>NetRec<font color="#000080">.</font>nextReply<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>Error<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin
            If Not </b></font>CvtDate <font color="#FF0000"><b>then Begin
               </b></font>MKMsgDate<font color="#000080">:=</font><font color="#800000">'05-29-97'</font><font color="#000080">;
               </font>MKMsgTime<font color="#000080">:=</font><font color="#800000">'19:21'
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>While Not </b></font>Eof<font color="#000080">(</font>MsgFile<font color="#000080">) </font><font color="#FF0000"><b>do Begin
               </b></font>SetLength<font color="#000080">(</font>TmpName<font color="#000080">,</font>FileSize<font color="#000080">(</font>MsgFile<font color="#000080">)-</font><font color="#800000">190</font><font color="#000080">);
               </font><font color="#008000"><i>{$I-} </i></font>BlockRead<font color="#000080">(</font>MsgFile<font color="#000080">,</font>TmpName<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Length<font color="#000080">(</font>TmpName<font color="#000080">),</font>NumRead<font color="#000080">); </font><font color="#008000"><i>{$I+}
               </i></font>Error<font color="#000080">:=</font>IOResult<font color="#000080">;
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
            </font>TextCtr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
            </font><font color="#FF0000"><b>While not </b></font>MsgDone <font color="#FF0000"><b>do </b></font>CheckLine<font color="#000080">(</font>GetString<font color="#000080">(</font><font color="#800000">128</font><font color="#000080">));
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font>MsgEnd<font color="#000080">:=</font>Length<font color="#000080">(</font>TmpName<font color="#000080">);
         </font>CloseFile<font color="#000080">(</font>MsgFile<font color="#000080">);
         </font>MsgTxtStartUp<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End
   Else </b></font>Error<font color="#000080">:=</font><font color="#800000">200</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>Error<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>CurrMsg<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>MsgTxtStartUp<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>MsgStart<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>TextCtr<font color="#000080">:=</font>MsgStart<font color="#000080">;
   </font>MsgDone<font color="#000080">:=</font>False<font color="#000080">;
   </font>LastSoft<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetString<font color="#000080">(</font>MaxLen<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>StrCtr<font color="#000080">:</font>Integer<font color="#000080">;
   </font>TmpStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>Junk<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font>TextCtr<font color="#000080">&lt;</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>TextCtr<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>TextCtr<font color="#000080">&gt;</font>MsgEnd<font color="#000080">) </font><font color="#FF0000"><b>Then Begin
      </b></font>TmpStr<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
      </font>MsgDone<font color="#000080">:=</font>True<font color="#000080">;
   </font><font color="#FF0000"><b>End
   Else Begin
      </b></font>SetLength<font color="#000080">(</font>TmpStr<font color="#000080">,</font>Min<font color="#000080">(</font>MaxLen<font color="#000080">,(</font>Length<font color="#000080">(</font>TmpName<font color="#000080">)-</font>TextCtr<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">));
      </font>Move<font color="#000080">(</font>TmpName<font color="#000080">[</font>TextCtr<font color="#000080">],</font>TmpStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Length<font color="#000080">(</font>TmpStr<font color="#000080">));
      </font>StrCtr<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">#13</font><font color="#000080">,</font>TmpStr<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>StrCtr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>TmpStr<font color="#000080">:=</font>WWrap<font color="#000080">(</font>TmpStr<font color="#000080">,</font>MaxLen<font color="#000080">,</font>Junk<font color="#000080">)
      </font><font color="#FF0000"><b>Else </b></font>TmpStr<font color="#000080">:=</font>Copy<font color="#000080">(</font>TmpStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>StrCtr<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>LastSoft<font color="#000080">:=</font>StrCtr<font color="#000080">=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font>Pos<font color="#000080">(</font><font color="#800000">#$8D</font><font color="#000080">,</font>TmpStr<font color="#000080">)&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then Begin </b></font><font color="#008000"><i>{soft return detected!}
         </i></font>StrCtr<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">#$8D</font><font color="#000080">,</font>TmpStr<font color="#000080">);
         </font>TmpStr<font color="#000080">:=</font>Copy<font color="#000080">(</font>TmpStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>StrCtr<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
         </font>LastSoft<font color="#000080">:=</font>True<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>TextCtr<font color="#000080">:=</font>TextCtr<font color="#000080">+</font>Length<font color="#000080">(</font>TmpStr<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">;
      </font>StrCtr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>While </b></font>StrCtr<font color="#000080">&lt;</font>Length<font color="#000080">(</font>TmpStr<font color="#000080">) </font><font color="#FF0000"><b>do Begin
         </b></font>Inc<font color="#000080">(</font>StrCtr<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font>TmpStr<font color="#000080">[</font>StrCtr<font color="#000080">]=</font><font color="#800000">#10 </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>TmpStr<font color="#000080">,</font>StrCtr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>GetString<font color="#000080">:=</font>TmpStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsLocal<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg local}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsLocal<font color="#000080">:=((</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#800000">001</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsCrash<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg crash}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsCrash<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">002</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsKillSent<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg kill sent}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsKillSent<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">128</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsSent<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg sent}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsSent<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">008</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsFAttach<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg file attach}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsFAttach<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">016</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsReqRct<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg request receipt}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsReqRct<font color="#000080">:=((</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#800000">016</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsReqAud<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg request audit}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsReqAud<font color="#000080">:=((</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#800000">064</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsRetRct<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg a return receipt}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsRetRct<font color="#000080">:=((</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#800000">032</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsFileReq<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg a file request}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsFileReq<font color="#000080">:=((</font>MKMsgFlagHigh <font color="#FF0000"><b>and </b></font><font color="#800000">008</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsRcvd<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg received}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsRcvd<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">004</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsPriv<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg priviledged/private}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsPriv<font color="#000080">:=((</font>MKMsgFlagLow <font color="#FF0000"><b>and </b></font><font color="#800000">001</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsDeleted<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg deleted}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsDeleted<font color="#000080">:=</font><font color="#FF0000"><b>Not </b></font>FileExist<font color="#000080">(</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>CurrMsg<font color="#000080">)+</font><font color="#800000">'.MSG'</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>IsEchoed<font color="#000080">:</font>Boolean<font color="#000080">; </font><font color="#008000"><i>{Is current msg echoed}
</i></font><font color="#FF0000"><b>Begin
   </b></font>IsEchoed<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SeekFirst<font color="#000080">(</font>MsgNum<font color="#000080">:</font>LongInt<font color="#000080">); </font><font color="#008000"><i>{Start msg seek}
</i></font><font color="#FF0000"><b>Begin
   </b></font>CurrMsg<font color="#000080">:=</font>MsgNum<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>CurrMsg<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>CurrMsg<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>SeekNext<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SeekNext<font color="#000080">; </font><font color="#008000"><i>{Find next matching msg}
</i></font><font color="#FF0000"><b>Begin
   </b></font>Inc<font color="#000080">(</font>CurrMsg<font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font><font color="#FF0000"><b>Not </b></font>MsgExists<font color="#000080">(</font>CurrMsg<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>CurrMsg<font color="#000080">&lt;=</font>MaxFidMsgNum<font color="#000080">)) </font><font color="#FF0000"><b>Do </b></font>Inc<font color="#000080">(</font>CurrMsg<font color="#000080">);
   </font><font color="#FF0000"><b>If Not </b></font>MsgExists<font color="#000080">(</font>CurrMsg<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>CurrMsg<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SeekPrior<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Dec<font color="#000080">(</font>CurrMsg<font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font><font color="#FF0000"><b>Not </b></font>MsgExists<font color="#000080">(</font>CurrMsg<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>CurrMsg <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>Do </b></font>Dec<font color="#000080">(</font>CurrMsg<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetMsgLoc<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#008000"><i>{Msg location}
</i></font><font color="#FF0000"><b>Begin
   </b></font>GetMsgLoc<font color="#000080">:=</font>CurrMsg<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetMsgLoc<font color="#000080">(</font>ML<font color="#000080">: </font>LongInt<font color="#000080">); </font><font color="#008000"><i>{Msg location}
</i></font><font color="#FF0000"><b>Begin
   </b></font>CurrMsg<font color="#000080">:=</font>ML<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MKSeekFound<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>MKSeekFound<font color="#000080">:=</font>CurrMsg<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>YoursFirst<font color="#000080">(</font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Handle<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>YoursName<font color="#000080">:=</font>Upper<font color="#000080">(</font>Name<font color="#000080">);
   </font>YoursHandle<font color="#000080">:=</font>Upper<font color="#000080">(</font>Handle<font color="#000080">);
   </font>CurrMsg<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>YoursNext<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>YoursNext<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>FoundDone<font color="#000080">:</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>FoundDone <font color="#000080">:= </font>False<font color="#000080">;
   </font>SeekFirst<font color="#000080">(</font>CurrMsg<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>CurrMsg<font color="#000080">&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>FoundDone<font color="#000080">)) </font><font color="#FF0000"><b>Do Begin
      </b></font>MsgStartUp<font color="#000080">;
      </font>FoundDone<font color="#000080">:=((</font>Upper<font color="#000080">(</font>HdrTo<font color="#000080">)=</font>YoursName<font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Upper<font color="#000080">(</font>HdrTo<font color="#000080">)=</font>YoursHandle<font color="#000080">));
      </font><font color="#FF0000"><b>If </b></font>IsRcvd <font color="#FF0000"><b>Then </b></font>FoundDone<font color="#000080">:=</font>False<font color="#000080">;
      </font><font color="#FF0000"><b>If Not </b></font>FoundDone <font color="#FF0000"><b>Then </b></font>SeekNext<font color="#000080">;
      </font><font color="#FF0000"><b>If Not </b></font>SeekFound <font color="#FF0000"><b>Then </b></font>FoundDone<font color="#000080">:=</font>True<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MKYoursFound<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>MKYoursFound<font color="#000080">:=</font>SeekFound<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>StartNewMsg<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Error<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>TextCtr<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>FillChar<font color="#000080">(</font>Dest<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Dest<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
   </font>FillChar<font color="#000080">(</font>Dest<font color="#000080">,</font>Sizeof<font color="#000080">(</font>Orig<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
   </font>TmpOpen<font color="#000080">:=</font>True<font color="#000080">;
   </font>TmpName<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font>MKMsgDate <font color="#000080">:= </font>DateStr<font color="#000080">(</font>GetDosDate<font color="#000080">);
   </font>MKMsgTime <font color="#000080">:= </font>TimeStr<font color="#000080">(</font>GetDosDate<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>OpenMsgBase<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Rescan<font color="#000080">(</font>MsgPath<font color="#000080">);
   </font>FActive<font color="#000080">:=</font>MsgBaseExists<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font>FActive <font color="#FF0000"><b>then </b></font>OpenMsgBase<font color="#000080">:=</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else </b></font>OpenMsgBase<font color="#000080">:=</font><font color="#800000">500</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetActive<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   If </b></font>Factive<font color="#000080">=</font>Value <font color="#FF0000"><b>then </b></font>Exit
   <font color="#FF0000"><b>Else If </b></font>Value <font color="#FF0000"><b>then </b></font>OpenMsgBase
   <font color="#FF0000"><b>Else </b></font>CloseMsgBase<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>CloseMsgBase<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>CloseMsgBase<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>FActive<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>CreateMsgBase<font color="#000080">(</font>MaxMsg<font color="#000080">: </font>Word<font color="#000080">; </font>MaxDays<font color="#000080">: </font>Word<font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>MakePath<font color="#000080">(</font>MsgPathFileName<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>CreateMsgBase<font color="#000080">:=</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else </b></font>CreateMsgBase<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetMailType<font color="#000080">(</font>Value<font color="#000080">:</font>MsgMailType<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>MailType<font color="#000080">:=</font>Value<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetSubArea<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetSubArea<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>ReWriteHdr<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>NetRec<font color="#000080">:</font>NetMsg<font color="#000080">;
   </font>TmpNum<font color="#000080">:</font>Byte<font color="#000080">;
   </font>TmpStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{   OldSeek:Longint;}

</i></font><font color="#FF0000"><b>Begin
   </b></font>FillChar<font color="#000080">(</font>NetRec<font color="#000080">,</font>Sizeof<font color="#000080">(</font>NetRec<font color="#000080">),</font><font color="#800000">#0</font><font color="#000080">);
   </font>TmpNum<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font>TmpStr<font color="#000080">:=</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">+</font>MonthStr<font color="#000080">(</font>TmpNum<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">+</font>Copy<font color="#000080">(</font>MKMsgDate<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'  '</font><font color="#000080">;
   </font><font color="#FF0000"><b>With </b></font>NetRec <font color="#FF0000"><b>do Begin
      </b></font>Move<font color="#000080">(</font>MKMsgFrom<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>FromUser<font color="#000080">,</font>Length<font color="#000080">(</font>MKMsgFrom<font color="#000080">));
      </font>Move<font color="#000080">(</font>MKMsgTo<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>toUser<font color="#000080">,</font>Length<font color="#000080">(</font>MKMsgTo<font color="#000080">));
      </font>Move<font color="#000080">(</font>MKMsgSubj<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>subj<font color="#000080">,</font>Length<font color="#000080">(</font>MKMsgSubj<font color="#000080">));
      </font>Move<font color="#000080">(</font>TmpStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>DateTime<font color="#000080">,</font>Length<font color="#000080">(</font>TmpStr<font color="#000080">));
      </font>TimesRead<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font>DestNode<font color="#000080">:=</font>Dest<font color="#000080">.</font>Node<font color="#000080">;
      </font>OrigNode<font color="#000080">:=</font>Orig<font color="#000080">.</font>Node<font color="#000080">;
      </font>Cost<font color="#000080">:=</font>MKMsgCost<font color="#000080">;
      </font>origNet<font color="#000080">:=</font>Orig<font color="#000080">.</font>Net<font color="#000080">;
      </font>destNet<font color="#000080">:=</font>Dest<font color="#000080">.</font>Net<font color="#000080">;
      </font>destZone<font color="#000080">:=</font>Dest<font color="#000080">.</font>Zone<font color="#000080">;
      </font>origZone<font color="#000080">:=</font>Orig<font color="#000080">.</font>Zone<font color="#000080">;
      </font>destPoint<font color="#000080">:=</font>Dest<font color="#000080">.</font>Point<font color="#000080">;
      </font>origPoint<font color="#000080">:=</font>Orig<font color="#000080">.</font>Point<font color="#000080">;
      </font>replyTo<font color="#000080">:=</font>MKMsgReplyTo<font color="#000080">;
      </font>flag1<font color="#000080">:=</font>MkMsgFlagLow<font color="#000080">;
      </font>flag2<font color="#000080">:=</font>MkMsgFlagHigh<font color="#000080">;
      </font>nextReply<font color="#000080">:=</font>MkMsgNextReply<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{   OldSeek:=FilePos(MsgFile);}
   </i></font><font color="#FF0000"><b>If Not </b></font>MsgOpen <font color="#FF0000"><b>then Begin
      </b></font>AssignFile<font color="#000080">(</font>MsgFile<font color="#000080">,</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>CurrMsg<font color="#000080">)+</font><font color="#800000">'.Msg'</font><font color="#000080">);
      </font><font color="#008000"><i>{$I-} </i></font>Reset<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{$I-}
   </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#008000"><i>{$I-} </i></font>Seek<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
   </font>BlockWrite<font color="#000080">(</font>MsgFile<font color="#000080">,</font>NetRec<font color="#000080">,</font>Sizeof<font color="#000080">(</font>NetRec<font color="#000080">));
   </font>Seek<font color="#000080">(</font>MsgFile<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{$I+}
   </i></font><font color="#FF0000"><b>If Not </b></font>MsgOpen <font color="#FF0000"><b>then </b></font>CloseFile<font color="#000080">(</font>MsgFile<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>IOResult<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{absorb}</i></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>DeleteMsg<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>DeleteFile<font color="#000080">(</font>PChar<font color="#000080">(</font>MsgPath<font color="#000080">+</font>Long2Str<font color="#000080">(</font>CurrMsg<font color="#000080">)+</font><font color="#800000">'.MSG'</font><font color="#000080">));
   </font>MsgPresent<font color="#000080">[</font>CurrMsg <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">]:=</font>MsgPresent<font color="#000080">[</font>CurrMsg <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>and Not </b></font><font color="#000080">(</font>PosArray<font color="#000080">[</font>CurrMsg <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MKNumberOfMsgs<font color="#000080">:</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Cnt<font color="#000080">:</font>Word<font color="#000080">;
   </font>Active<font color="#000080">:</font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>Active<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>Cnt<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>To </b></font>MaxFidMsgArray <font color="#FF0000"><b>Do Begin
      If </b></font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">]&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
         If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$80</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$40</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$20</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$10</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$08</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$04</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$02</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
         </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>MsgPresent<font color="#000080">[</font>Cnt<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$01</font><font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Active<font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font>MKNumberOfMsgs<font color="#000080">:=</font>Active<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetLastRead<font color="#000080">(</font>UNum<font color="#000080">:</font>LongInt<font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>LRec<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">((</font>UNum<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">))&gt;</font>SizeFile<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>GetLastRead<font color="#000080">:=</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else Begin
      If </b></font>LoadFilePos<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">,</font>LRec<font color="#000080">,</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">),</font>UNum<font color="#000080">*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">))=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then
         </b></font>GetLastRead<font color="#000080">:=</font>LRec
      <font color="#FF0000"><b>Else </b></font>GetLastRead<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetLastRead<font color="#000080">(</font>UNum<font color="#000080">:</font>LongInt<font color="#000080">;</font>LR<font color="#000080">:</font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Var
   </b></font>LRec<font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">((</font>UNum<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">))&gt;</font>SizeFile<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>ExtendFile<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">,(</font>UNum<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">)*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font>LoadFilePos<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">,</font>LRec<font color="#000080">,</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">),</font>UNum<font color="#000080">*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">))=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
      </b></font>LRec<font color="#000080">:=</font>LR<font color="#000080">;
      </font>SaveFilePos<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'LastRead'</font><font color="#000080">,</font>LRec<font color="#000080">,</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">),</font>UNum<font color="#000080">*</font>SizeOf<font color="#000080">(</font>LRec<font color="#000080">));
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>GetTxtPos<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetTxtPos<font color="#000080">:=</font>TextCtr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetTxtPos<font color="#000080">(</font>TP<font color="#000080">:</font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>TextCtr<font color="#000080">:=</font>TP<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MKMsgBaseExists<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Rescan<font color="#000080">(</font>MsgPath<font color="#000080">); </font><font color="#008000"><i>{jic}
   </i></font>MKMsgBaseExists<font color="#000080">:=</font>MsgPathExists<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>Rescan<font color="#000080">(</font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
   </b></font>SR<font color="#000080">: </font>TSearchRec<font color="#000080">;
   </font>TmpNum<font color="#000080">:</font>Word<font color="#000080">;
   </font>Code<font color="#000080">:</font>Word<font color="#000080">;
   </font>DosError<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>MsgPath<font color="#000080">:=</font>WithBackSlash<font color="#000080">(</font>S<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>MsgPath<font color="#000080">=</font>LastPath <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
   </font>LastPath<font color="#000080">:=</font>MsgPath<font color="#000080">;
   </font>FillChar<font color="#000080">(</font>MsgPresent<font color="#000080">,</font>SizeOf<font color="#000080">(</font>MsgPresent<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
   </font>DosError<font color="#000080">:=</font>FindFirst<font color="#000080">(</font>MsgPath<font color="#000080">+</font><font color="#800000">'*.MSG'</font><font color="#000080">,</font>faReadOnly<font color="#000080">+</font>faArchive<font color="#000080">,</font>SR<font color="#000080">);
   </font>MsgPathExists<font color="#000080">:=</font>False<font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font>DosError<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Do Begin
      </b></font>TmpNum<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>SR<font color="#000080">.</font>Name<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>SR<font color="#000080">.</font>Name<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">));
      </font><font color="#FF0000"><b>If </b></font>TmpNum<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
         </b></font>MsgPathExists<font color="#000080">:=</font>True<font color="#000080">;
         </font><font color="#FF0000"><b>If </b></font>TmpNum<font color="#000080">&lt;=</font>MaxFidMsgNum <font color="#FF0000"><b>Then Begin
            </b></font>Code<font color="#000080">:=</font>TmpNum <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">; </font><font color="#008000"><i>{div by 8 to get byte position}
            </i></font>MsgPresent<font color="#000080">[</font>Code<font color="#000080">]:=</font>MsgPresent<font color="#000080">[</font>Code<font color="#000080">] </font><font color="#FF0000"><b>or </b></font>PosArray<font color="#000080">[</font>TmpNum <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">];
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>DosError<font color="#000080">:=</font>FindNext<font color="#000080">(</font>SR<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>FindClose<font color="#000080">(</font>SR<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TFidoMsgBase<font color="#000080">.</font>MsgExists<font color="#000080">(</font>MsgNum<font color="#000080">:</font>LongInt<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">((</font>MsgNum <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>MsgNum <font color="#000080">&lt;= </font>MaxFidMsgNum<font color="#000080">)) </font><font color="#FF0000"><b>Then
      </b></font>MsgExists<font color="#000080">:=(</font>MsgPresent<font color="#000080">[</font>MsgNum <font color="#FF0000"><b>shr </b></font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font>PosArray<font color="#000080">[</font>MsgNum <font color="#FF0000"><b>and </b></font><font color="#800000">7</font><font color="#000080">])&lt;&gt;</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else </b></font>MsgExists<font color="#000080">:=</font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>TFidoMsgBase<font color="#000080">.</font>GetNextSeeAlso<font color="#000080">:</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetNextSeeAlso<font color="#000080">:=</font>MKMsgNextReply<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetNextSeeAlso<font color="#000080">(</font>Value<font color="#000080">:</font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>MKMsgNextReply<font color="#000080">:=</font>Value<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetCost<font color="#000080">(</font>Value<font color="#000080">:</font>Word<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>MKMsgCost<font color="#000080">:=</font>Value<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>TFidoMsgBase<font color="#000080">.</font>GetCost<font color="#000080">:</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetCost<font color="#000080">:=</font>MKMsgCost<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>TFidoMsgBase<font color="#000080">.</font>LockMsgBase<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>LockMsgbase<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>TFidoMsgBase<font color="#000080">.</font>UnLockMsgBase<font color="#000080">:</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>UnLockMsgbase<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>SetEcho<font color="#000080">(</font>Value<font color="#000080">:</font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{Not Needed!}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TFidoMsgBase<font color="#000080">.</font>DoKludgeLn<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
   </b></font>DoString<font color="#000080">(</font><font color="#800000">#1</font><font color="#000080">+</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Warpgroup'</font><font color="#000080">,[</font>TFidoMsgBase<font color="#000080">]);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0456.PAS">Original</a><b>]</b></p></body>
</html>
