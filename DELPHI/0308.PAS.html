<html>
<head><title> "File Locking with Delphi" by DANIEL MALTAROLLI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0308.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Using Windows<font color="#800000">'s LockFileEx and UnlockFileEx functions with the
</font>LOCKFILE_EXCLUSIVE_LOCK flag enabled you can lock exclusively a byte range
within your <font color="#FF0000"><b>file</b></font><font color="#000080">.  </font>But <font color="#FF0000"><b>in </b></font>your <font color="#FF0000"><b>case</b></font><font color="#000080">, </font>it<font color="#800000">'s easier and more efficient create
</font>the <font color="#FF0000"><b>file </b></font>using Windows<font color="#800000">'s OpenFile this way:

  </font>hFile <font color="#000080">:= </font>OpenFile<font color="#000080">(</font>FileName<font color="#000080">, </font>ofStruct<font color="#000080">, </font>OF_CREATE <font color="#FF0000"><b>or </b></font>OF_READWRITE <font color="#FF0000"><b>or
</b></font>OF_SHARE_EXCLUSIVE<font color="#000080">);

</font>You<font color="#800000">'ll find more in WIN32.HLP.  Good luck!

</font>Daniel Maltarolli<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0308.PAS">Original</a><b>]</b></p></body>
</html>
