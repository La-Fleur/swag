<html>
<head><title> "Getting File Size" by CRAUG FRENCHM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0369.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Here<font color="#000080">, </font>I<font color="#800000">'ve thrown together two routines from code I wrote for an   
</font>application that keeps track <font color="#FF0000"><b>of </b></font>certain network files <font color="#FF0000"><b>to </b></font>make sure that   
they don<font color="#800000">'t grow too big.

</font>Yehah<font color="#000080">! </font>I <font color="#FF0000"><b>finally </b></font>get <font color="#FF0000"><b>to </b></font>help someone<font color="#000080">!!!


</font><font color="#FF0000"><b>function </b></font>ReturnFileSize<font color="#000080">(</font>TheFileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Srec <font color="#000080">: </font>TSearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>// TheFileName must include the full path
  </i></font><font color="#FF0000"><b>if </b></font>findfirst<font color="#000080">(</font>TheFileName<font color="#000080">, </font>faanyfile<font color="#000080">, </font>srec<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Result <font color="#000080">:= </font>SRec<font color="#000080">.</font>Size
  <font color="#FF0000"><b>else
    </b></font>Result <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>or </b></font>return the MB <font color="#000080">(</font>megabyte<font color="#000080">) </font>size <font color="#FF0000"><b>with</b></font><font color="#000080">:

</font><font color="#FF0000"><b>function </b></font>ReturnMBFileSize<font color="#000080">(</font>TheFileName<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>Real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Srec <font color="#000080">: </font>TSearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>// TheFileName must include the full path
  </i></font><font color="#FF0000"><b>if </b></font>findfirst<font color="#000080">(</font>TheFileName<font color="#000080">, </font>faanyfile<font color="#000080">, </font>srec<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Result <font color="#000080">:= </font>SRec<font color="#000080">.</font>Size <font color="#000080">/ </font><font color="#800000">1048576
  </font><font color="#FF0000"><b>else
    </b></font>Result <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0369.PAS">Original</a><b>]</b></p></body>
</html>
