<html>
<head><title> "Delete files to recyle bin" by JOHN RUZICKA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0184.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{ This function deletes a file in Windows 95 and moves it to the recycle bin.
  It returns True if the operation is successful, and False otherwise

  Syntax:

          x := RecycleFile(Filename);

          *** Distribute this file freely

          This unit written by John Ruzicka 75160.2376@compuserve.com
          based on code from Dennis Passmore and Steve Schafer on the
          BDELPHI forum

  }

</i></font><font color="#FF0000"><b>unit </b></font>Recycle<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ShellAPI<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RecycleFile<font color="#000080">(</font>FileToRecycle<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>implementation

function </b></font>RecycleFile<font color="#000080">(</font>FileToRecycle<font color="#000080">: </font>TFilename<font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Struct<font color="#000080">: </font>TSHFileOpStruct<font color="#000080">;
    </font>pFromc<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>Resultval<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   if not </b></font>FileExists<font color="#000080">(</font>FileToRecycle<font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>RecycleFile <font color="#000080">:= </font>False<font color="#000080">;
      </font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>end
   else begin
      </b></font>fillchar<font color="#000080">(</font>pfromc<font color="#000080">,</font>sizeof<font color="#000080">(</font>pfromc<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">);
      </font>StrPcopy<font color="#000080">(</font>pfromc<font color="#000080">,</font>expandfilename<font color="#000080">(</font>FileToRecycle<font color="#000080">)+</font><font color="#800000">#0#0</font><font color="#000080">);
      </font>Struct<font color="#000080">.</font>wnd <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>Struct<font color="#000080">.</font>wFunc <font color="#000080">:= </font>FO_DELETE<font color="#000080">;
      </font>Struct<font color="#000080">.</font>pFrom <font color="#000080">:= </font>pFromC<font color="#000080">;
      </font>Struct<font color="#000080">.</font>pTo   <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>Struct<font color="#000080">.</font>fFlags<font color="#000080">:= </font>FOF_ALLOWUNDO<font color="#000080">;
      </font>Struct<font color="#000080">.</font>fAnyOperationsAborted <font color="#000080">:= </font>false<font color="#000080">;
      </font>Struct<font color="#000080">.</font>hNameMappings <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>Resultval <font color="#000080">:= </font>ShFileOperation<font color="#000080">(</font>Struct<font color="#000080">);
      </font>RecycleFile <font color="#000080">:= (</font>Resultval <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0184.PAS">Original</a><b>]</b></p></body>
</html>
