<html>
<head><title> "How to get a registered OCX?" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0443.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Before an OCX can be used<font color="#000080">, </font>it must be registered <font color="#FF0000"><b>with </b></font>the
System Registry<font color="#000080">.

</font>Suppose the OCX you want <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>is </b></font>called <font color="#000080">&quot;</font>test<font color="#000080">.</font>ocx<font color="#000080">&quot;.

</font><font color="#FF0000"><b>Try </b></font>this code<font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>var
  </b></font>OCXHand<font color="#000080">: </font>THandle<font color="#000080">;
  </font>RegFunc<font color="#000080">: </font>TDllRegisterServer<font color="#000080">;   </font><font color="#008000"><i>//add OLECtl to the uses clause
</i></font><font color="#FF0000"><b>begin
  </b></font>OCXHand<font color="#000080">:= </font>LoadLibrary<font color="#000080">(</font><font color="#800000">'c:\windows\system\test.ocx'</font><font color="#000080">);
  </font>RegFunc<font color="#000080">:= </font>GetProcAddress<font color="#000080">(</font>OCXHand<font color="#000080">, </font><font color="#800000">'DllRegisterServer'</font><font color="#000080">);  </font><font color="#008000"><i>//case
</i></font>sensitive<font color="#000080">?
  </font><font color="#FF0000"><b>if </b></font>RegFunc <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>ShowMessage<font color="#000080">(</font><font color="#800000">'Error!'</font><font color="#000080">);
  </font>FreeLibrary<font color="#000080">(</font>OCXHand<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------

</font>You can the same way unregister the OCX<font color="#000080">: </font>all you have <font color="#FF0000"><b>to do is to
</b></font>replace <font color="#800000">'DllRegisterServer' </font>by <font color="#800000">'DllUnregisterServer'</font><font color="#000080">.

</font>You should add some validation code<font color="#000080">: &quot;</font>Does the <font color="#FF0000"><b>file </b></font>exist<font color="#000080">&quot;, &quot;</font>Was the call
<font color="#FF0000"><b>to </b></font>LoadLibrary successful<font color="#000080">?&quot;, ...

</font>Some explanations<font color="#000080">:

</font>An OCX <font color="#FF0000"><b>is </b></font>a special form <font color="#FF0000"><b>of </b></font>dll<font color="#000080">, </font>so you can load it <font color="#FF0000"><b>in </b></font>memory <font color="#FF0000"><b>with </b></font>a call
<font color="#FF0000"><b>to </b></font>the LoadLibrary<font color="#000080">() </font>API <font color="#FF0000"><b>function</b></font><font color="#000080">. </font>An OCX <font color="#FF0000"><b>exports </b></font>two functions <font color="#FF0000"><b>to register
and </b></font>unregister the control<font color="#000080">. </font>You <font color="#FF0000"><b>then </b></font>use GetProcAddress <font color="#FF0000"><b>to </b></font>obtain the
address <font color="#FF0000"><b>of </b></font>these functions<font color="#000080">. </font>You just have <font color="#FF0000"><b>then to </b></font>call the appropriate
<font color="#FF0000"><b>function</b></font><font color="#000080">. </font><font color="#FF0000"><b>And </b></font>that<font color="#800000">'s it! You can explore the Registry (with regedit.exe)
</font><font color="#FF0000"><b>to </b></font>verify that the OCX <font color="#FF0000"><b>is </b></font>registered<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0443.PAS">Original</a><b>]</b></p></body>
</html>
