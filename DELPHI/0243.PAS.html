<html>
<head><title> "Register OLE components" by VEIKKO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0243.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt;</font>How can I <font color="#FF0000"><b>register </b></font>OCX component <font color="#000080">(</font>NetManage HTML<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>use it <font color="#FF0000"><b>with
</b></font><font color="#000080">&gt;</font>my application <font color="#FF0000"><b>on </b></font>a <font color="#000080">&quot;</font>clean<font color="#000080">&quot; </font>pc <font color="#000080">(</font>Delphi <font color="#FF0000"><b>not </b></font>installed<font color="#000080">).
&gt;        </font>Run regsvr32 filename<font color="#000080">.</font>ocx<font color="#000080">(</font>dll<font color="#000080">)

  </font>Another way <font color="#FF0000"><b>to do </b></font>it <font color="#FF0000"><b>is </b></font>this<font color="#000080">:
---------- </font>Application<font color="#800000">'s Project Source ----------
 </font><font color="#000080">...
</font><font color="#FF0000"><b>var
  </b></font>i     <font color="#000080">: </font>TCLSID<font color="#000080">;
  </font>hOCX  <font color="#000080">:</font>integer<font color="#000080">;
  </font>pReg  <font color="#000080">: </font><font color="#FF0000"><b>procedure</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ Check ocx registration. }
  </i></font><font color="#FF0000"><b>try
    </b></font>i <font color="#000080">:=</font><font color="#800000">3</font>D StringToClassID<font color="#000080">(</font><font color="#800000">'SoftwareFX.ChartFX.20'</font><font color="#000080">);
  </font><font color="#FF0000"><b>except
    </b></font>hOCX <font color="#000080">:=</font><font color="#800000">3</font>D LoadLibrary<font color="#000080">( </font><font color="#800000">'CFX32.OCX' </font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>hOCX  <font color="#000080">&gt;=</font><font color="#800000">3</font>D HINSTANCE_ERROR<font color="#000080">) </font><font color="#FF0000"><b>then begin
      try
        </b></font>pReg <font color="#000080">:=</font><font color="#800000">3</font>D GetProcAddress<font color="#000080">(</font>hOCX<font color="#000080">,</font><font color="#800000">'DllRegisterServer'</font><font color="#000080">);
        </font><font color="#FF0000"><b>if </b></font><font color="#000080">(@</font>pReg <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>pReg  <font color="#008000"><i>{ Call the registration function }
        </i></font><font color="#FF0000"><b>else
          </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'Error in registering OCX control.'</font><font color="#000080">, </font>mtError<font color="#000080">, [</font>mbok<font color="#000080">]=
,</font><font color="#800000">0</font><font color="#000080">);
      </font><font color="#FF0000"><b>finally
        </b></font>FreeLibrary<font color="#000080">(</font>hOCX<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
      </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'Error in loading OCX control.'</font><font color="#000080">, </font>mtError<font color="#000080">, [</font>mbok<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Application<font color="#000080">.</font>Initialize<font color="#000080">;
...
------------------------------

  </font>This source checks that the OCX <font color="#FF0000"><b>is </b></font>registered <font color="#FF0000"><b>with </b></font>StringToClassID meth<font color="#000080">=
</font>od<font color="#000080">.
</font><font color="#FF0000"><b>If not </b></font>registered<font color="#000080">, </font>it raises an error<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>error occured<font color="#000080">, </font>just load the OC<font color="#000080">=
</font>X
<font color="#FF0000"><b>and </b></font>call  DllRegisterServer method <font color="#FF0000"><b>to register </b></font>it<font color="#000080">.

  </font>This source <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>to register </b></font>ChartFX OCX but you can change it <font color="#FF0000"><b>to
register </b></font>any OCX by changing <font color="#800000">'SoftwareFX.ChartFX.20' </font><font color="#FF0000"><b>and </b></font><font color="#800000">'CFX32.OCX' </font><font color="#FF0000"><b>to
</b></font>whatever<font color="#000080">...

  </font>Hope it helps<font color="#000080">.

  </font>Veikko V<font color="#000080">=</font>E4<font color="#000080">=</font>E4t<font color="#000080">=</font>E4j<font color="#000080">=</font>E4
  veikko<font color="#000080">.</font>vaataja<font color="#000080">@</font>abo<font color="#000080">.</font>fi


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0243.PAS">Original</a><b>]</b></p></body>
</html>
