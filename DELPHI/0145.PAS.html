<html>
<head><title> "Search window list for all Windows title" by FERDINAND SOETHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0145.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>function </b></font>FindMatchingWindows<font color="#000080">(</font>SearchFor<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>AtBeginning<font color="#000080">: </font>boolean<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>FoundWindows<font color="#000080">: </font>TStringList<font color="#000080">): </font>longint<font color="#000080">;

</font><font color="#008000"><i>{Search window list for all Windows where the title contains or begins
 with (AtBeginning) SearchFor. Returns a TStringList with the title of the
 found windows as string and the window-Handle as Object.
 It is up to you to create and free the TStringList}

</i></font><font color="#FF0000"><b>var
  </b></font>hWndFirst<font color="#000080">, </font>hWndCurWin<font color="#000080">, </font>hWndDesk<font color="#000080">: </font>HWnd<font color="#000080">;
  </font>szWinText<font color="#000080">: </font>pChar<font color="#000080">;
  </font>WinText<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>foundAt<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>hWndDesk<font color="#000080">:= </font>GetDesktopWindow<font color="#000080">;
  </font><font color="#008000"><i>{This ist the parent of alle top-level windows}
  </i></font><font color="#FF0000"><b>if </b></font>hWndDesk <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
        </b></font>hWndCurWin <font color="#000080">:= </font>GetWindow<font color="#000080">(</font>hWndDesk<font color="#000080">,</font>GW_CHILD<font color="#000080">)
  </font><font color="#FF0000"><b>else
        </b></font><font color="#008000"><i>{place error handling here}
        </i></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>assigned<font color="#000080">(</font>FoundWindows<font color="#000080">) </font><font color="#FF0000"><b>then
        </b></font><font color="#008000"><i>{you have to create Stringlist before passing the
         variable to this function}
        </i></font>exit<font color="#000080">;
  </font>getMem<font color="#000080">(</font>szWinText<font color="#000080">,</font><font color="#800000">256</font><font color="#000080">);
  </font>hWndFirst<font color="#000080">:= </font>hWndCurWin<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>hWndCurWin <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>GetWindowText<font color="#000080">(</font>hWndCurWin<font color="#000080">, </font>szWinText<font color="#000080">,</font><font color="#800000">255</font><font color="#000080">);
    </font>WinText<font color="#000080">:= </font>strpas<font color="#000080">(</font>szWinText<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>SearchFor <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    begin
        if </b></font>WinText <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>Wintext <font color="#000080">:= </font>format <font color="#000080">(</font><font color="#800000">'Fenster Nr. %d (Ohne Titel)'</font><font color="#000080">,[</font>hWndCurWin<font color="#000080">]);
        </font>FoundWindows<font color="#000080">.</font>addObject<font color="#000080">(</font>WinText<font color="#000080">,</font>TObject<font color="#000080">(</font>hWndCurWin<font color="#000080">))
    </font><font color="#FF0000"><b>end
    else
    begin
      </b></font>foundAt<font color="#000080">:= </font>pos<font color="#000080">(</font>SearchFor<font color="#000080">, </font>WinText<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>atBeginning <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>foundAt <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>foundAt <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>FoundWindows<font color="#000080">.</font>addObject<font color="#000080">(</font>WinText<font color="#000080">,</font>TObject<font color="#000080">(</font>hWndCurWin<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>hWndCurWin <font color="#000080">:= </font>GetWindow<font color="#000080">(</font>hWndCurWin<font color="#000080">,</font>GW_HWNDNEXT<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>freeMem<font color="#000080">(</font>szWinText<font color="#000080">,</font><font color="#800000">256</font><font color="#000080">);
  </font>result <font color="#000080">:= </font>FoundWindows<font color="#000080">.</font>count<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0145.PAS">Original</a><b>]</b></p></body>
</html>
