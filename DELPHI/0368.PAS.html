<html>
<head><title> "Building a delay into a DLL" by SIMON CARTER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0368.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">I<font color="#800000">'m trying to add a delay of a few seconds into a formless DLL written in
</font>Delphi

Using the VCL TTimer seems <font color="#FF0000"><b>to </b></font>be precluded because it <font color="#FF0000"><b>is </b></font>a component<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>its create method <font color="#FF0000"><b>is </b></font>looking <font color="#FF0000"><b>for </b></font>that all familiar Sender<font color="#000080">:</font>TComponent<font color="#000080">, =</font><font color="#800000">20</font><font color="#000080">=

</font>The following <font color="#FF0000"><b>function </b></font>should work <font color="#FF0000"><b>in </b></font>both <font color="#800000">16 </font><font color="#FF0000"><b>and </b></font><font color="#800000">32 </font>bit environment

<font color="#FF0000"><b>Procedure </b></font>GoSleep<font color="#000080">(</font>SleepFor<font color="#000080">: </font>DWord<font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>StartTicks<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{$IfDef Win16}
    </i></font>StartTicks <font color="#000080">:= </font>GetTickCount <font color="#000080">+ </font>SleepFor<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font>GetTickCount <font color="#000080">&lt; </font>StartTicks <font color="#FF0000"><b>Do
      Begin
        </b></font><font color="#008000"><i>//Optional
        </i></font>Application<font color="#000080">=</font>ProcessMessages<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#008000"><i>{$Else}
    </i></font>Sleep<font color="#000080">(</font>SleepFor<font color="#000080">);
  </font><font color="#008000"><i>{$EndIf}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0368.PAS">Original</a><b>]</b></p></body>
</html>
