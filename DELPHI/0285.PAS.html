<html>
<head><title> "Replacement for QuickReport's Preview Fo" by ANGUS JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0285.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Delphi1 <font color="#000080">&amp; </font>Delphi2<font color="#000080">.

</font>This <font color="#FF0000"><b>unit is to </b></font>replace QuickReport<font color="#800000">'s Preview Form.

</font>Advantages<font color="#000080">:
  </font><font color="#800000">1. </font>cursor keys can be used <font color="#FF0000"><b>to </b></font>move around the preview page<font color="#000080">.
  </font><font color="#800000">2. </font><font color="#000080">[</font>page_up<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#000080">[</font>page_down<font color="#000080">] </font>keys used <font color="#FF0000"><b>to </b></font>move between pages
  <font color="#800000">3. </font><font color="#000080">[</font>home<font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#000080">[</font>ctrl<font color="#000080">][</font>page_up<font color="#000080">] </font><font color="#FF0000"><b>to </b></font>move <font color="#FF0000"><b>to </b></font>first page
  <font color="#800000">4. </font><font color="#000080">[</font><font color="#FF0000"><b>end</b></font><font color="#000080">] </font><font color="#FF0000"><b>or </b></font><font color="#000080">[</font>ctrl<font color="#000080">][</font>page_down<font color="#000080">] </font><font color="#FF0000"><b>to </b></font>move <font color="#FF0000"><b>to </b></font>last page

  <font color="#800000">5. </font>automatically fills entire screen <font color="#000080">(</font><font color="#FF0000"><b>except </b></font>task bar<font color="#000080">)


</font>Usage<font color="#000080">:

  </font><font color="#800000">1. </font>Make sure QuickRep <font color="#FF0000"><b>is in </b></font>the <font color="#FF0000"><b>uses </b></font>clause <font color="#FF0000"><b>on </b></font>your MainForm<font color="#000080">.
  </font><font color="#800000">2. </font>Add this Preview <font color="#FF0000"><b>unit to </b></font>your project<font color="#000080">.
  </font><font color="#800000">3. </font>Add the following <font color="#FF0000"><b>procedure to </b></font>your MainForm <font color="#000080">-
</font>	<font color="#FF0000"><b>procedure </b></font>TMainForm<font color="#000080">.</font>MyPreview<font color="#000080">;
</font>	<font color="#FF0000"><b>begin
</b></font>	   FmPreview<font color="#000080">.</font>ShowModal<font color="#000080">;
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#800000">4. </font>add <font color="#000080">-
</font>	QRPrinter<font color="#000080">.</font>OnPreview <font color="#000080">:= </font>MyPreview<font color="#000080">;
     </font><font color="#FF0000"><b>to </b></font>your code <font color="#000080">(</font><font color="#FF0000"><b>or </b></font>place it <font color="#FF0000"><b>in </b></font>FormCreate method<font color="#000080">) </font>before calling <font color="#000080">-
</font>	YourReport<font color="#000080">.</font>Quickreport1<font color="#000080">.</font>preview<font color="#000080">;


</font>Angus Johnson
ajohnson<font color="#000080">@</font>rpi<font color="#000080">.</font>net<font color="#000080">.</font>au


<font color="#FF0000"><b>unit </b></font>Preview<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Quickrep<font color="#000080">, </font>ExtCtrls<font color="#000080">, </font>Messages<font color="#000080">,
  </font>StdCtrls<font color="#000080">, </font>Buttons<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Dialogs<font color="#000080">, </font>Printers<font color="#000080">,
  </font>IniFiles<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TFmPreview <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
</font>	 Panel1<font color="#000080">: </font>TPanel<font color="#000080">;
</font>	 QRPreview1<font color="#000080">: </font>TQRPreview<font color="#000080">;
</font>	 Label1<font color="#000080">: </font>TLabel<font color="#000080">;
</font>	 PrintDialog1<font color="#000080">: </font>TPrintDialog<font color="#000080">;
</font>	 bbPrev<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 bbNext<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 bbZoomOut<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 bbZoomW<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 bbZoomIn<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 bbPrint<font color="#000080">: </font>TBitBtn<font color="#000080">;
    </font>bbClose<font color="#000080">: </font>TBitBtn<font color="#000080">;
</font>	 <font color="#FF0000"><b>procedure </b></font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbZoomOutClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbZoomWClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbPrevClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbNextClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbPrintClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbZoomInClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>bbCloseClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>FormActivate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>FormClose<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Action<font color="#000080">: </font>TCloseAction<font color="#000080">);
</font>	 <font color="#FF0000"><b>procedure </b></font>FormKeyDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Key<font color="#000080">: </font>Word<font color="#000080">;
</font>	   Shift<font color="#000080">: </font>TShiftState<font color="#000080">);
  </font><font color="#FF0000"><b>private
</b></font>	 <font color="#FF0000"><b>procedure </b></font>CMDialogKey<font color="#000080">(</font><font color="#FF0000"><b>var message</b></font><font color="#000080">: </font>TCMDialogKey<font color="#000080">); </font><font color="#FF0000"><b>message </b></font>CM_DIALOGKEY<font color="#000080">;
  </font><font color="#FF0000"><b>public
  end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>FmPreview<font color="#000080">: </font>TFmPreview<font color="#000080">;

</font><font color="#FF0000"><b>implementation

uses
  </b></font>Main<font color="#000080">;

</font><font color="#008000"><i>{$R *.DFM}


</i></font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>FormShow<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	QRPreview1<font color="#000080">.</font>Zoom <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">; </font><font color="#008000"><i>{defaults to ZoomIn}
</i></font>	Label1<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">'Page 1 of ' </font><font color="#000080">+</font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">);
</font>	<font color="#FF0000"><b>if </b></font>QRPrinter<font color="#000080">.</font>PageCount <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>false
	<font color="#FF0000"><b>else </b></font>bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbClose<font color="#000080">.</font>setfocus<font color="#000080">;
</font>	bbZoomIn<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	bbZoomW<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbZoomOut<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbZoomOutClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	QRPreview1<font color="#000080">.</font>ZoomToFit<font color="#000080">;
</font>	bbZoomOut<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	bbZoomW<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbZoomIn<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbClose<font color="#000080">.</font>setfocus<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbZoomWClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	QRPreview1<font color="#000080">.</font>ZoomToWidth<font color="#000080">;
</font>	bbZoomW<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	bbZoomOut<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbZoomIn<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbClose<font color="#000080">.</font>setfocus<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbPrevClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{Previous page}
  </i></font><font color="#FF0000"><b>if </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
         </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">:= </font>QRPreview1<font color="#000080">.</font>PageNumber<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>Label1<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">'Page ' </font><font color="#000080">+ </font>inttostr<font color="#000080">(</font>QRPreview1<font color="#000080">.</font>PageNumber<font color="#000080">)+
                        </font><font color="#800000">' of ' </font><font color="#000080">+</font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">);
  </font>bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then begin
</b></font>	 bbPrev<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	 bbNext<font color="#000080">.</font>setfocus<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbNextClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{Next page}
  </i></font><font color="#FF0000"><b>if </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">&lt; </font>QRPrinter<font color="#000080">.</font>PageCount <font color="#FF0000"><b>then
</b></font>					QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">:= </font>QRPreview1<font color="#000080">.</font>PageNumber<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>Label1<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">'Page ' </font><font color="#000080">+ </font>inttostr<font color="#000080">(</font>QRPreview1<font color="#000080">.</font>PageNumber<font color="#000080">)+
</font>					<font color="#800000">' of ' </font><font color="#000080">+</font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">);
  </font>bbPrev<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">= </font>QRPrinter<font color="#000080">.</font>PageCount <font color="#FF0000"><b>then begin
</b></font>	 bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	 bbPrev<font color="#000080">.</font>setfocus<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbPrintClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{A PrintDialog component can be added to the form with an -
  if not PrintDialog1.execute then exit -
  statement placed here.}
  </i></font>screen<font color="#000080">.</font>cursor <font color="#000080">:= </font>crHourglass<font color="#000080">;
  </font><font color="#FF0000"><b>try
</b></font>	 QRPrinter<font color="#000080">.</font>Print<font color="#000080">;
</font>	 <font color="#FF0000"><b>while </b></font>tag <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>do begin
</b></font>	   QRPrinter<font color="#000080">.</font>Print<font color="#000080">;
</font>	   tag <font color="#000080">:= </font>tag<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
</font>	 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>	 tag <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>finally
</b></font>	 screen<font color="#000080">.</font>cursor <font color="#000080">:= </font>crDefault<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>close<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbZoomInClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	QRPreview1<font color="#000080">.</font>Zoom <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
</font>	bbZoomIn<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	bbZoomW<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbZoomOut<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	bbClose<font color="#000080">.</font>setfocus<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>bbCloseClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	close<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>FormActivate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>TrayHwnd<font color="#000080">: </font>HWnd<font color="#000080">;
  </font>Rect<font color="#000080">: </font>TRect<font color="#000080">;
  </font>CxFullScreen<font color="#000080">, </font>CyFullScreen<font color="#000080">, </font>CyCaption<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{size the form to fill the screen...}
  </i></font>TrayHwnd <font color="#000080">:= </font>FindWindow<font color="#000080">(</font><font color="#800000">'Shell_TrayWnd'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>TrayHwnd <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font><font color="#008000"><i>{not Win95 screen}
</i></font>	 WindowState <font color="#000080">:= </font>wsMaximized
  <font color="#FF0000"><b>else begin
</b></font>	 GetWindowRect<font color="#000080">(</font>TrayHwnd<font color="#000080">,</font>Rect<font color="#000080">);
</font>	 CxFullScreen    <font color="#000080">:= </font>GetSystemMetrics<font color="#000080">(</font>SM_CXFULLSCREEN<font color="#000080">);
</font>	 CyFullScreen    <font color="#000080">:= </font>GetSystemMetrics<font color="#000080">(</font>SM_CYFULLSCREEN<font color="#000080">);
</font>	 CyCaption       <font color="#000080">:= </font>GetSystemMetrics<font color="#000080">(</font>SM_CYCAPTION<font color="#000080">);

</font>	 <font color="#008000"><i>{NOTE: Position must equal either poDefault or poDesigned,
	  and WindowState = wsNormal}
</i></font>	 Top      <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>	 Left     <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font>	 Width    <font color="#000080">:= </font>CxFullScreen<font color="#000080">;
</font>	 Height   <font color="#000080">:= </font>CyFullScreen <font color="#000080">+ </font>CyCaption<font color="#000080">;

</font>	 <font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Rect<font color="#000080">.</font>Top <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Rect<font color="#000080">.</font>Left <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>	   <font color="#008000"><i>{Taskbar on either top or left}
</i></font>	   <font color="#FF0000"><b>if </b></font>Rect<font color="#000080">.</font>Right <font color="#000080">&gt; </font>Rect<font color="#000080">.</font>Bottom <font color="#FF0000"><b>then </b></font><font color="#008000"><i>{Taskbar on top}
</i></font>		 Top  <font color="#000080">:= </font>Rect<font color="#000080">.</font>Bottom
	   <font color="#FF0000"><b>else </b></font><font color="#008000"><i>{Taskbar on left}
</i></font>		 Left <font color="#000080">:= </font>Rect<font color="#000080">.</font>Right<font color="#000080">;
</font>	 <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>bbClose<font color="#000080">.</font>left <font color="#000080">:= </font>width <font color="#000080">- </font><font color="#800000">76</font><font color="#000080">;
  </font>bbPrint<font color="#000080">.</font>left <font color="#000080">:= </font>width <font color="#000080">- </font><font color="#800000">144</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>FormClose<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Action<font color="#000080">: </font>TCloseAction<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{this is necessary if reopening form!!!?}
  </i></font>bbPrev<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
  </font>QRPreview1<font color="#000080">.</font>HorzScrollbar<font color="#000080">.</font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>QRPreview1<font color="#000080">.</font>VertScrollbar<font color="#000080">.</font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>CMDialogKey<font color="#000080">(</font><font color="#FF0000"><b>var message</b></font><font color="#000080">: </font>TCMDialogKey<font color="#000080">);
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{INTERCEPTS ARROW KEYS INORDER TO MOVE AROUND PAGE}
  </i></font><font color="#FF0000"><b>with message do
</b></font>	 <font color="#FF0000"><b>case </b></font>CharCode <font color="#FF0000"><b>of
</b></font>	   VK_LEFT<font color="#000080">: </font><font color="#FF0000"><b>begin
</b></font>		 <font color="#FF0000"><b>with </b></font>QRPreview1<font color="#000080">.</font>HorzScrollbar <font color="#FF0000"><b>do </b></font>Position <font color="#000080">:= </font>Position <font color="#000080">-</font><font color="#800000">50</font><font color="#000080">;
</font>		 exit<font color="#000080">;
</font>		 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>		VK_RIGHT<font color="#000080">: </font><font color="#FF0000"><b>begin
</b></font>		 <font color="#FF0000"><b>with </b></font>QRPreview1<font color="#000080">.</font>HorzScrollbar <font color="#FF0000"><b>do </b></font>Position <font color="#000080">:= </font>Position <font color="#000080">+</font><font color="#800000">50</font><font color="#000080">;
</font>		 exit<font color="#000080">;
</font>		 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>		VK_UP<font color="#000080">: </font><font color="#FF0000"><b>begin
</b></font>		 <font color="#FF0000"><b>with </b></font>QRPreview1<font color="#000080">.</font>VertScrollbar <font color="#FF0000"><b>do </b></font>Position <font color="#000080">:= </font>Position <font color="#000080">-</font><font color="#800000">50</font><font color="#000080">;
</font>		 exit<font color="#000080">;
</font>		 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>		VK_DOWN<font color="#000080">: </font><font color="#FF0000"><b>begin
</b></font>		 <font color="#FF0000"><b>with </b></font>QRPreview1<font color="#000080">.</font>VertScrollbar <font color="#FF0000"><b>do </b></font>Position <font color="#000080">:= </font>Position <font color="#000080">+</font><font color="#800000">50</font><font color="#000080">;
</font>		 exit<font color="#000080">;
</font>		 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>	 <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>inherited</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TFmPreview<font color="#000080">.</font>FormKeyDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Key<font color="#000080">: </font>Word<font color="#000080">;
  </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">);
</font><font color="#FF0000"><b>begin </b></font><font color="#008000"><i>{INTERCEPTS [PG_UP],[PG_DN], [CTRL][PG_UP],[CTRL][PG_DN], [HOME],[END]}
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(((</font>Key <font color="#000080">= </font>VK_NEXT<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Shift <font color="#000080">= [</font>ssCtrl<font color="#000080">])) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Key <font color="#000080">= </font>VK_END<font color="#000080">))
</font>											<font color="#FF0000"><b>and </b></font>bbNext<font color="#000080">.</font>enabled <font color="#FF0000"><b>then begin
</b></font>	 QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">:= </font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">; </font><font color="#008000"><i>{GOTO LAST PAGE}
</i></font>	 Label1<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">'Page ' </font><font color="#000080">+ </font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">)+
</font>					  <font color="#800000">' of ' </font><font color="#000080">+</font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">);
</font>	 bbPrev<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	 bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	 bbPrev<font color="#000080">.</font>setfocus<font color="#000080">;
</font>	 <font color="#FF0000"><b>end
  else if </b></font><font color="#000080">(((</font>Key <font color="#000080">= </font>VK_PRIOR<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Shift <font color="#000080">= [</font>ssCtrl<font color="#000080">])) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Key <font color="#000080">= </font>VK_HOME<font color="#000080">))
</font>											 <font color="#FF0000"><b>and </b></font>bbPrev<font color="#000080">.</font>enabled <font color="#FF0000"><b>then begin
</b></font>	 QRPreview1<font color="#000080">.</font>PageNumber <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{GOTO FIRST PAGE}
</i></font>	 Label1<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">'Page 1' </font><font color="#000080">+
</font>					  <font color="#800000">' of ' </font><font color="#000080">+</font>inttostr<font color="#000080">(</font>QRPrinter<font color="#000080">.</font>PageCount<font color="#000080">);
</font>	 bbPrev<font color="#000080">.</font>enabled <font color="#000080">:= </font>false<font color="#000080">;
</font>	 bbNext<font color="#000080">.</font>enabled <font color="#000080">:= </font>true<font color="#000080">;
</font>	 bbNext<font color="#000080">.</font>setfocus<font color="#000080">;
</font>	 <font color="#FF0000"><b>end
  else if </b></font><font color="#000080">(</font>Key <font color="#000080">= </font>VK_NEXT<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>bbNext<font color="#000080">.</font>enabled <font color="#FF0000"><b>then </b></font>bbNextClick<font color="#000080">(</font>Sender<font color="#000080">)
  </font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>Key <font color="#000080">= </font>VK_PRIOR<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>bbPrev<font color="#000080">.</font>enabled <font color="#FF0000"><b>then </b></font>bbPrevClick<font color="#000080">(</font>Sender<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ the following contains additional files that should be included with this
  file.  To extract, you need XX3402 available with the SWAG distribution.

  1.     Cut the text below out, and save to a file  ..  filename.xx
  2.     Use XX3402  :   xx3402 d filename.xx
  3.     The decoded file should be created in the same directory.
  4.     If the file is a archive file, use the proper archive program to
         extract the members.

{ ------------------            CUT              ----------------------}

</i></font><font color="#000080">*</font>XX3402<font color="#000080">-</font><font color="#800000">001873</font><font color="#000080">-</font><font color="#800000">240597</font><font color="#000080">--</font><font color="#800000">72</font><font color="#000080">--</font><font color="#800000">85</font><font color="#000080">-</font><font color="#800000">09701</font><font color="#000080">-----</font>PREVIEW<font color="#000080">.</font>DFM<font color="#000080">--</font><font color="#800000">1</font><font color="#000080">-</font><font color="#FF0000"><b>OF</b></font><font color="#000080">--</font><font color="#800000">1
</font>zkc<font color="#000080">+</font>J2NBI373JYZ3Jk<font color="#000080">+</font>k21o5<font color="#000080">++-</font>II2Mk0ZF4PJ<font color="#000080">-</font>mNLNdNLQ7FapEQaJqOKJr<font color="#000080">-</font><font color="#800000">2</font>lZNbE0<font color="#000080">++</font>BI
Pr<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">++</font>h0Pr7YNL77MqxiQkgAMaZHSLBoNKpBNKtp<font color="#000080">++</font>d<font color="#000080">-</font>RLFjIqBmPqlg0<font color="#000080">+</font>R1ML<font color="#000080">-</font>oOKxi<font color="#000080">-</font>UpE
QaZiR0<font color="#000080">-</font>EQaJqOKJr12BgOKJiR2VZOKRcR<font color="#000080">+</font>Cn<font color="#000080">+</font>Eh1P4ZZPbFLOKFoO<font color="#000080">+</font>Bs<font color="#000080">+</font>Ud4Pqto9YBjP4xm
<font color="#000080">-</font>klXP3RdPaFjRpFZS5E9FaxiR0t6NKZbO5E0x<font color="#000080">+</font>Z4Pqto9YtVPKI4<font color="#000080">-</font>I3mOK3g0YNjPbEiIrFt
P4I9<font color="#000080">++</font>d9NLZEQaJqOKJr0EpEOLVZP5BENL77PaBc<font color="#000080">+</font>a<font color="#000080">+</font><font color="#800000">6</font>I4xnOLFdPqs51b<font color="#000080">-</font>jIqBmNKJiEqJi
R4Jm<font color="#000080">-</font>ZBXMKlZN<font color="#000080">+</font>U8Hqt<font color="#000080">-</font>MrFdRa3oNEQAFaxmPI3XR4ZqMLFZ<font color="#000080">-</font>oxiEqljQqI50INjQap1P4xn
NEZDPYhZSIFjRqs50oNjQap9NLZ2PrRi<font color="#000080">-</font>YxiIqVjRkQ6FaxmPJBcPrQ8J4JsR2VZOKRcR<font color="#000080">+</font><font color="#800000">6</font>D
<font color="#000080">++</font>NII43iNKk4I43iNKkl<font color="#000080">-</font><font color="#800000">2</font>lZNbE0<font color="#000080">++</font>BIPr<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">++</font>JLOKFoO<font color="#000080">+</font>Bs<font color="#000080">+</font>UN6NKZbO5E04UJ<font color="#000080">-</font>P4ZbPUQ3
MKlIPr<font color="#000080">+</font><font color="#800000">6</font>J43WHr7YNL60<font color="#000080">+++</font><font color="#800000">4</font>J2lVMaJg<font color="#000080">-</font>YlVMaJgAEFANKNo<font color="#000080">+</font>sU<font color="#000080">++</font>pFjQ<font color="#000080">+</font><font color="#800000">64</font><font color="#000080">-</font>JRdN5Fc<font color="#000080">+</font>b<font color="#000080">+</font><font color="#800000">4
</font>G4JdNqVo<font color="#000080">+</font>Uw7EKldNqthNKto<font color="#000080">-</font>kVoMIBZPbFZQUV<font color="#000080">-</font>RLFjIqZuNEU5Eq3kR4ZjPUM9I43bNG<font color="#000080">+</font>l
<font color="#800000">64</font>xa612<font color="#000080">+++</font>RIEaZoEbFi<font color="#000080">-</font>a7WI57ZRUFANKNo<font color="#000080">+</font>U21J4xk<font color="#000080">+</font>U63JqZYR4U0EUN6NKZbO5E03UR1
ML<font color="#000080">-</font>oOKxi<font color="#000080">-</font>UdEQaIaRW<font color="#000080">-</font>EMKRZ<font color="#000080">-</font>oJiMK7gNKE603FVMYxmN4Jm<font color="#000080">+</font>U<font color="#000080">+</font><font color="#800000">5</font>Hqt1P4ZXOkQ9Ma7EQaJq
EqldMqg<font color="#000080">+++</font>RIEaZoEbFi<font color="#000080">-</font>a7WHaJsR<font color="#000080">+</font>FANKNo<font color="#000080">+</font>YE1J4xk<font color="#000080">+</font>U63JqZYR4U0EUN6NKZbO5E03UR1
ML<font color="#000080">-</font>oOKxi<font color="#000080">-</font>UcaHaJsR0<font color="#000080">-</font>EMKRZ03FVMYxmN4Jm<font color="#000080">+</font>U25Hqt1P4ZXOkQ9Ma7CNLVoEqldMqg<font color="#000080">+++</font>RI
EaZoEbFi0K7WKaxjPIxpR<font color="#000080">+</font>FANKNo<font color="#000080">+</font>zc<font color="#000080">++</font>pFjQ<font color="#000080">+</font><font color="#800000">60</font><font color="#000080">-</font>JRdN5Fc<font color="#000080">+</font>YQ4G4JdNqVo<font color="#000080">+</font>VM5Eq3kR4Zj
PUM7KaxjPG<font color="#000080">+</font>aHrJo03FVMYxmN4Jm<font color="#000080">+</font>U65Hqt1P4ZXOkQCMa7OPqxhHrJoEqldMqg<font color="#000080">+++</font>RIEaZo
EbFi<font color="#000080">-</font>q7WKaxjPJQ2H4JaR<font color="#000080">+</font>B0<font color="#000080">+</font>EBIPr<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">+</font>UJLOKFoO<font color="#000080">+</font><font color="#800000">77</font><font color="#000080">-</font>YVZOKRcR<font color="#000080">+</font><font color="#800000">6</font>K<font color="#000080">-</font>oBVQ5FdPqs40p<font color="#000080">-</font>V
NqIU7ZRdN5Fc03FVMYxmN4Jm<font color="#000080">+</font>UA5Hqt1P4ZXOkQAMa7OPqxhJoBgOKBf<font color="#000080">+++</font><font color="#800000">5</font>J27dR27oPUVW
MZdjPqp7PUFANKNo<font color="#000080">+</font>sk<font color="#000080">-+</font>pFjQ<font color="#000080">+</font><font color="#800000">60</font><font color="#000080">-</font>JRdN5Fc<font color="#000080">+</font>YQ4G4JdNqVo<font color="#000080">+</font>VM5Eq3kR4ZjPUM6KaxjPG<font color="#000080">+</font>a
GKs5FKtVMalZN<font color="#000080">+</font>U6J43WHr7YNL60<font color="#000080">-+</font>RDPYBgOKBf<font color="#000080">-</font>kpWMZdjPqp7PYBgOKBf<font color="#000080">+++</font><font color="#800000">5</font>J27dR27o
PURWMZ<font color="#000080">-</font>mOKto<font color="#000080">-</font><font color="#800000">2</font>lZNbE1wE21J4xk<font color="#000080">+</font>U63JqZYR4U0EUN6NKZbO5E03UR1ML<font color="#000080">-</font>oOKxi<font color="#000080">-</font>UNEQaZi
<font color="#800000">7</font>bE6J43WHr7YNL60<font color="#000080">-</font>ERDPYBgOKBf<font color="#000080">-</font>klWMZ<font color="#000080">-</font>mOKtoEqldMqg<font color="#000080">+++</font>RIEaZoEbFi<font color="#000080">-</font>q7WEqljQqI2
H4JaR<font color="#000080">+</font>Ao<font color="#000080">+</font>UBIPr<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">+</font>UJLOKFoO<font color="#000080">+</font><font color="#800000">70</font><font color="#000080">-</font>YVZOKRcR<font color="#000080">+</font><font color="#800000">6</font>K<font color="#000080">-</font>YBVPaBZP<font color="#000080">+</font>Y5Eq3kR4ZjPUM47YBgPrBZ
<font color="#800000">03</font>FVMYxmN4Jm<font color="#000080">+</font>UM5Hqt1P4ZXOkQAMa71P4xnNIBgOKBf0YRgSL<font color="#000080">-</font>c9YFVR428M<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">++</font><font color="#800000">3</font>k<font color="#000080">-++-</font><font color="#800000">0
</font>HJk<font color="#000080">-++++++++</font>RU<font color="#000080">+++</font><font color="#800000">0</font>U<font color="#000080">++++</font>F<font color="#000080">++++</font><font color="#800000">2E</font><font color="#000080">++++</font><font color="#800000">2</font><font color="#000080">+-+++++++</font>n<font color="#000080">+++++++++++++++++++++++++++
++++++</font><font color="#800000">0</font><font color="#000080">+++</font><font color="#800000">0</font><font color="#000080">+++++</font>U6<font color="#000080">++</font>U<font color="#000080">++++</font><font color="#800000">6</font><font color="#000080">++</font>U<font color="#000080">+</font><font color="#800000">0</font><font color="#000080">+</font>U<font color="#000080">+++</font>kA1<font color="#000080">++</font><font color="#800000">60</font><font color="#000080">+</font>U<font color="#000080">++++</font>Dw<font color="#000080">++</font>Dw<font color="#000080">+++</font><font color="#800000">1</font>zzk1z<font color="#000080">++++</font>zk1z
<font color="#000080">+</font>Dzz<font color="#000080">++</font><font color="#800000">1</font>zzzw<font color="#000080">+</font>RrRrRrRrRrRk<font color="#000080">++++</font>Xzzzzzzzzzzk<font color="#000080">++++</font>VrRrRrRrRrTk<font color="#000080">++++</font>VsW6RrRsW6Tk
<font color="#000080">++++</font>VsaNVrS7aMTk<font color="#000080">++++</font>VsaNa5WNaMTk<font color="#000080">++++</font>VrWNaMaNa5Tk<font color="#000080">++++</font>VrS7aNaNVrTk<font color="#000080">++++</font>VrRs
aNaMRrTk<font color="#000080">++++</font>VrS7aNaNVrTk<font color="#000080">++++</font>VrWNaMaNa5Tk<font color="#000080">++++</font>VsaNa5WNaMTk<font color="#000080">++++</font>VsaNVrS7aMTk
<font color="#000080">++++</font>VsW6RrRsW6Tk<font color="#000080">++++</font>VrRrRrRrRrTk<font color="#000080">++++</font>W6W6W6W6W6Xk<font color="#000080">++++</font>RrRrRrRrRrRk<font color="#000080">++++++++
+++++++++++++++++++++++++++++++++++</font><font color="#800000">8</font>J33GI57ZRaZZRkdFIZ<font color="#000080">-</font>mNLNdNLQl<font color="#000080">-</font><font color="#800000">2</font>lZNbE0
<font color="#000080">++</font>BIPr<font color="#000080">+</font><font color="#800000">04</font>UJLOKFoO<font color="#000080">+</font>Bs<font color="#000080">+</font>UN6NKZbO5E1aE23EKldNqs5043gEqldNKto0YNjPbEiEqxgPr65
<font color="#800000">14</font>BgJqZiN4xrJ4JsR<font color="#000080">+</font>h4Pqto9YVZOKRcR<font color="#000080">+</font><font color="#800000">9</font>k0INjPbEiHa3hNEM3EL7dMKk8FaxiR0tHR5Zg
NEg<font color="#000080">+</font><font color="#800000">0</font>Z<font color="#000080">-</font>VQaJiR2NjPbE603FVMYxmN4Jm<font color="#000080">+</font>U28I43bNItpPK7ZQU6<font color="#000080">--</font><font color="#800000">3</font>djPqo0N<font color="#000080">+++</font><font color="#800000">13</font>FEQaZi
R2FdMKljNklEQaZiR2FdMKljNn22H4JaR<font color="#000080">+</font>B5<font color="#000080">+</font>UBIPr<font color="#000080">+</font><font color="#800000">05</font>U<font color="#000080">++++++
***** </font><font color="#FF0000"><b>END OF </b></font>BLOCK <font color="#800000">1 </font><font color="#000080">*****

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0285.PAS">Original</a><b>]</b></p></body>
</html>
