<html>
<head><title> "Handling Massive Numbers" by JES RAHBEK KLINKE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0464.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
To the SWAG:
I would like this version of my unit to replace the older version called
'Handling Massive Number functions' in the 'Math' snippet. If it is possible.
}

</i></font><font color="#FF0000"><b>program </b></font>BigNum<font color="#000080">;

</font><font color="#008000"><i>{ BigNum v2.0, 16-bit  by Jes R. Klinke

  Implements calculations on integers of arbitrary size.
  All operations necessary for cryptographic applications are provided.

  You may use this unit for whatever you want. But if you make a commercial
  product please at least send me a copy of it.

  New in version 2:
  * Dynamic size
      Each instance of TBigNum has just enough memory allocated to it to
      keep its current value. You don't have to specify a BigNumSize anymore.
  * Negative numbers
      Most of the calculations now support negative values.
  * More efficient calculations
      As each instance of TBigNum keeps track of how many words are actually
      used in it's value, only the necessary calculations are performed.
      This particularly speeds up the multiplication, as lots of
      MUL's with zero words are avoided.

  To do's:
  * 32-bit calculations on 386+ processors for better performance

  Any comment or bug reports are welcome. I am especially interested in
  knowing if there are sufficient demand for a 32-bit version.
  You can reach me at jesk@diku.dk or jesk@dk-online.dk.
  My snail-mail address is Jes Rahbek Klinke
                           Haandvaerkerhaven 3, 2. mf
                           2400 Copenhagen NV
}

</i></font><font color="#FF0000"><b>uses
  </b></font>Crt<font color="#000080">, </font>Dos<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>PWordArr <font color="#000080">= ^</font>TWordArr<font color="#000080">;
  </font>TWordArr <font color="#000080">= </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">999</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Word<font color="#000080">;

  </font>PBigNum <font color="#000080">= ^</font>TBigNum<font color="#000080">;
  </font>TBigNum <font color="#000080">= </font><font color="#FF0000"><b>object
    </b></font>Value<font color="#000080">: </font>PWordArr<font color="#000080">;
    </font>Alloc<font color="#000080">, </font>Used<font color="#000080">: </font>Word<font color="#000080">;
    </font>Sign<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Assign<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AssignLong<font color="#000080">(</font>AValue<font color="#000080">: </font>LongInt<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Add<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Subtract<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Multiply<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>Divide<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>Modulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>PowerModulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AExponent<font color="#000080">, </font>AModulo<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>BitwiseOr<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AMask<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>Compare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Mult10<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Div10<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Mult2<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Div2<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>StrHex<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Val<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>AsLong<font color="#000080">: </font>LongInt<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Swap<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
  </font><font color="#008000"><i>{ procedures working on absolute values only, mainly for internal use. }
    </i></font><font color="#FF0000"><b>procedure </b></font>AbsIncrement<font color="#000080">(</font>By<font color="#000080">: </font>Word<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AbsDecrement<font color="#000080">(</font>By<font color="#000080">: </font>Word<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>AbsCompare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>AbsAdd<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>AbsSubtract<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>AbsDivide<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>AbsModulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>private </b></font><font color="#008000"><i>{ internal procedures for memory management }
    </i></font><font color="#FF0000"><b>procedure </b></font>Realloc<font color="#000080">(</font>Words<font color="#000080">: </font>Word<font color="#000080">; </font>Preserve<font color="#000080">: </font>Boolean<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>Critical<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>CountUsed<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TBigNum<font color="#000080">.</font>Init<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Alloc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Used <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TBigNum<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>Alloc <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Assign<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Alloc <font color="#000080">&lt; </font>AValue<font color="#000080">.</font>Used <font color="#FF0000"><b>then
    </b></font>Realloc<font color="#000080">(</font>AValue<font color="#000080">.</font>Used<font color="#000080">, </font>False<font color="#000080">);
  </font>Used <font color="#000080">:= </font>AValue<font color="#000080">.</font>Used<font color="#000080">;
  </font>Move<font color="#000080">(</font>AValue<font color="#000080">.</font>Value<font color="#000080">^, </font>Value<font color="#000080">^, </font>Used <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">);
  </font>FillChar<font color="#000080">(</font>Value<font color="#000080">^[</font>Used<font color="#000080">], (</font>Alloc <font color="#000080">- </font>Used<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>Sign <font color="#000080">:= </font>AValue<font color="#000080">.</font>Sign<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>AssignLong<font color="#000080">(</font>AValue<font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>AValue <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Sign <font color="#000080">:= </font>True<font color="#000080">;
    </font>AValue <font color="#000080">:= -</font>AValue<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
    </b></font>Sign <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Alloc <font color="#000080">&lt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
    </b></font>Realloc<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">, </font>False<font color="#000080">);
  </font>Move<font color="#000080">(</font>AValue<font color="#000080">, </font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">], </font>SizeOf<font color="#000080">(</font>LongInt<font color="#000080">));;
  </font>Used <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Alloc <font color="#000080">&gt; </font>Used <font color="#FF0000"><b>then
    </b></font>FillChar<font color="#000080">(</font>Value<font color="#000080">^[</font>Used<font color="#000080">], (</font>Alloc <font color="#000080">- </font>Used<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>MValue<font color="#000080">: </font>TBigNum<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Sign <font color="#FF0000"><b>xor </b></font>AValue<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
    if </b></font>AbsCompare<font color="#000080">(</font>AValue<font color="#000080">) &gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>AbsSubtract<font color="#000080">(</font>AValue<font color="#000080">)
    </font><font color="#FF0000"><b>else
    begin
      </b></font>MValue<font color="#000080">.</font>Init<font color="#000080">;
      </font>MValue<font color="#000080">.</font>Assign<font color="#000080">(</font>AValue<font color="#000080">);
      </font>TBigNum<font color="#000080">.</font>Swap<font color="#000080">(</font>MValue<font color="#000080">);
      </font>AbsSubtract<font color="#000080">(</font>MValue<font color="#000080">);
      </font>MValue<font color="#000080">.</font>Done<font color="#000080">;
    </font><font color="#FF0000"><b>end
  else
    </b></font>AbsAdd<font color="#000080">(</font>AValue<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Subtract<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>MValue<font color="#000080">: </font>TBigNum<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Sign <font color="#FF0000"><b>xor </b></font>AValue<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
    </b></font>AbsAdd<font color="#000080">(</font>AValue<font color="#000080">)
  </font><font color="#FF0000"><b>else
    if </b></font>AbsCompare<font color="#000080">(</font>AValue<font color="#000080">) &gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>AbsSubtract<font color="#000080">(</font>AValue<font color="#000080">)
    </font><font color="#FF0000"><b>else
    begin
      </b></font>MValue<font color="#000080">.</font>Init<font color="#000080">;
      </font>MValue<font color="#000080">.</font>Assign<font color="#000080">(</font>AValue<font color="#000080">);
      </font>TBigNum<font color="#000080">.</font>Swap<font color="#000080">(</font>MValue<font color="#000080">);
      </font>AbsSubtract<font color="#000080">(</font>MValue<font color="#000080">);
      </font>MValue<font color="#000080">.</font>Done<font color="#000080">;
      </font>Sign <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>Sign<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Multiply<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Needed<font color="#000080">: </font>Word<font color="#000080">;
  </font>Result<font color="#000080">: </font>PWordArr<font color="#000080">;
  </font>SmallVal<font color="#000080">, </font>BigVal<font color="#000080">: </font>PWordArr<font color="#000080">;
  </font>Small<font color="#000080">, </font>Big<font color="#000080">, </font>I<font color="#000080">: </font>Integer<font color="#000080">;
  </font>X<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>AValue<font color="#000080">.</font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Used <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Sign <font color="#000080">:= </font>Sign <font color="#FF0000"><b>xor </b></font>AValue<font color="#000080">.</font>Sign<font color="#000080">;
  </font>Needed <font color="#000080">:= </font>Used <font color="#000080">+ </font>AValue<font color="#000080">.</font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>GetMem<font color="#000080">(</font>Result<font color="#000080">, </font>Needed <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
  </font>FillChar<font color="#000080">(</font>Result<font color="#000080">^, </font>Needed <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Used <font color="#000080">&gt; </font>AValue<font color="#000080">.</font>Used <font color="#FF0000"><b>then
  begin
    </b></font>SmallVal <font color="#000080">:= </font>AValue<font color="#000080">.</font>Value<font color="#000080">;
    </font>Small <font color="#000080">:= </font>AValue<font color="#000080">.</font>Used<font color="#000080">;
    </font>BigVal <font color="#000080">:= </font>Value<font color="#000080">;
    </font>Big <font color="#000080">:= </font>Used<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>BigVal <font color="#000080">:= </font>AValue<font color="#000080">.</font>Value<font color="#000080">;
    </font>Big <font color="#000080">:= </font>AValue<font color="#000080">.</font>Used<font color="#000080">;
    </font>SmallVal <font color="#000080">:= </font>Value<font color="#000080">;
    </font>Small <font color="#000080">:= </font>Used<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">PUSH  DS
    CLD
    XOR    DX,DX
@@0:PUSH  DX
    LES    DI,SmallVal
    ADD    DI,DX
    ADD    DI,DX
    MOV    AX,[ES:DI]
    LES    DI,Result
    ADD    DI,DX
    ADD    DI,DX
    LDS    SI,BigVal
    MOV    CX,Big
    PUSH  BP
    MOV    BP,AX
    XOR    DX,DX
@@1:MOV    BX,DX
    LODSW
    MUL    BP
    ADD    BX,AX
    ADC    DX,0
    MOV    AX,[ES:DI]
    ADD    AX,BX
    STOSW
    ADC    DX,0
    LOOP  @@1
    MOV    AX,[ES:DI]
    ADD    AX,DX
    STOSW
    POP    BP
    POP    DX
    INC    DX
    CMP    DX,Small
    JNE    @@0
    POP    DS
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Realloc<font color="#000080">(</font>Needed<font color="#000080">, </font>False<font color="#000080">);
  </font>Move<font color="#000080">(</font>Result<font color="#000080">^, </font>Value<font color="#000080">^, </font>Needed <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font>Alloc <font color="#000080">- </font>Needed <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>FillChar<font color="#000080">(</font>Value<font color="#000080">^[</font>Needed<font color="#000080">], (</font>Alloc <font color="#000080">- </font>Needed<font color="#000080">) * </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>Result<font color="#000080">, </font>Needed <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Note: At first sight, you might think, that Divide and Modulo gives wrong
  results for negative values. This depends on the definition of the quoient
  and remainder.
  The definition used by these routines is:
  Given the divident N and divisor D, the quotient Q and remainder R is then
  defined by the equation
    N = D * Q + R,
  where the absolute value of R is less then the absolute value of D and R
  have the same sign as D.
  This will prove to be very convinient.}

</i></font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>Divide<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Sign <font color="#FF0000"><b>xor </b></font>ADivisor<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
  begin
    </b></font>Subtract<font color="#000080">(</font>ADivisor<font color="#000080">);
    </font>AbsDecrement<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>AbsDivide<font color="#000080">(</font>ADivisor<font color="#000080">);
    </font>Sign <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>Sign<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>AbsDivide<font color="#000080">(</font>ADivisor<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>Modulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Sign <font color="#FF0000"><b>xor </b></font>ADivisor<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
  begin
    </b></font>Subtract<font color="#000080">(</font>ADivisor<font color="#000080">);
    </font>AbsDecrement<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>AbsModulo<font color="#000080">(</font>ADivisor<font color="#000080">);
    </font>Add<font color="#000080">(</font>ADivisor<font color="#000080">);
    </font>AbsDecrement<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>AbsModulo<font color="#000080">(</font>ADivisor<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>PowerModulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AExponent<font color="#000080">, </font>AModulo<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Result<font color="#000080">, </font>A<font color="#000080">: </font>TBigNum<font color="#000080">;
  </font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AExponent<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
    </b></font>RunError<font color="#000080">(</font><font color="#800000">201</font><font color="#000080">);
  </font>Result<font color="#000080">.</font>Init<font color="#000080">;
  </font>A<font color="#000080">.</font>Init<font color="#000080">;
  </font>Result<font color="#000080">.</font>AssignLong<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>A<font color="#000080">.</font>Assign<font color="#000080">(</font>Self<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>AExponent<font color="#000080">.</font>Used <font color="#000080">* </font><font color="#800000">16 </font><font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
  begin
    if </b></font>AExponent<font color="#000080">.</font>Value<font color="#000080">^[</font>I <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font><font color="#000080">(</font>I <font color="#FF0000"><b>and </b></font><font color="#800000">15</font><font color="#000080">)) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      </b></font>Result<font color="#000080">.</font>Multiply<font color="#000080">(</font>A<font color="#000080">);
      </font>Result<font color="#000080">.</font>Modulo<font color="#000080">(</font>AModulo<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>A<font color="#000080">.</font>Multiply<font color="#000080">(</font>A<font color="#000080">);
    </font>A<font color="#000080">.</font>Modulo<font color="#000080">(</font>AModulo<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Assign<font color="#000080">(</font>Result<font color="#000080">);
  </font>A<font color="#000080">.</font>Done<font color="#000080">;
  </font>Result<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>BitwiseOr<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AMask<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>AMask<font color="#000080">.</font>Used <font color="#000080">&gt; </font>Used <font color="#FF0000"><b>then
    </b></font>Realloc<font color="#000080">(</font>AMask<font color="#000080">.</font>Used<font color="#000080">, </font>True<font color="#000080">);
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">PUSH  DS
    LES   DI,Self
    LES   DI,[ES:DI.TBigNum.Value]
    LDS   SI,AMask
    MOV   CX,[DS:SI.TBigNum.Used]
    JCXZ  @@1
    LDS   SI,[DS:SI.TBigNum.Value]
    CLD
@@0:LODSW
    OR    AX,[ES:DI]
    STOSW
    LOOP  @@0
@@1:POP   DS
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>Compare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Sign <font color="#FF0000"><b>xor </b></font>AValue<font color="#000080">.</font>Sign <font color="#FF0000"><b>then
    if </b></font>Sign <font color="#FF0000"><b>then
      </b></font>Compare <font color="#000080">:= -</font><font color="#800000">1
    </font><font color="#FF0000"><b>else
      </b></font>Compare <font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>else
    if </b></font>Sign <font color="#FF0000"><b>then
      </b></font>Compare <font color="#000080">:= -</font>AbsCompare<font color="#000080">(</font>AValue<font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>Compare <font color="#000080">:= </font>AbsCompare<font color="#000080">(</font>AValue<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Mult10<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Realloc<font color="#000080">(</font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>True<font color="#000080">);
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    JCXZ  @@1
    LES    DI,[ES:DI.TBigNum.Value]
    XOR   BX,BX
    CLD
@@0:MOV   AX,[ES:DI]
    MOV   DX,10
    MUL   DX
    ADD   AX,BX
    ADC   DX,0
    STOSW
    MOV   BX,DX
    LOOP  @@0
    MOV   [ES:DI],BX
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Div10<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    JCXZ  @@1
    LES    DI,[ES:DI.TBigNum.Value]
    MOV   DX,CX
    DEC   DX
    SHL   DX,1
    STD
    ADD   DI,DX
    XOR   DX,DX
@@0:MOV   AX,[ES:DI]
    MOV   BX,10
    DIV   BX
    STOSW
    LOOP  @@0
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Mult2<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Critical <font color="#FF0000"><b>then
  begin
    </b></font>Realloc<font color="#000080">(</font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>True<font color="#000080">);
    </font>Used <font color="#000080">:= </font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    JCXZ  @@1
    LES    DI,[ES:DI.TBigNum.Value]
    CLC
    CLD
@@0:MOV   AX,[ES:DI]
    RCL   AX,1
    STOSW
    LOOP  @@0
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Div2<font color="#000080">;
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    JCXZ  @@1
    LES    DI,[ES:DI.TBigNum.Value]
    MOV   DX,CX
    DEC   DX
    SHL   DX,1
    ADD   DI,DX
    XOR   DX,DX
    CLC
    STD
@@0:MOV   AX,[ES:DI]
    RCR   AX,1
    STOSW
    LOOP  @@0
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>M<font color="#000080">, </font>T<font color="#000080">: </font>TBigNum<font color="#000080">;
  </font>Res<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>I<font color="#000080">, </font>Ciffer<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Str <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>M<font color="#000080">.</font>Init<font color="#000080">;
  </font>T<font color="#000080">.</font>Init<font color="#000080">;
  </font>M<font color="#000080">.</font>Assign<font color="#000080">(</font>Self<font color="#000080">);
  </font>T<font color="#000080">.</font>AssignLong<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>I <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>M<font color="#000080">.</font>AbsCompare<font color="#000080">(</font>T<font color="#000080">) &gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>T<font color="#000080">.</font>Mult10<font color="#000080">;
    </font>Inc<font color="#000080">(</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>I <font color="#000080">&lt;= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
  begin
    if </b></font>Sign <font color="#FF0000"><b>then
      </b></font>Str <font color="#000080">:= </font><font color="#800000">'-' </font><font color="#000080">+ </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">) + </font>M<font color="#000080">.</font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">])
    </font><font color="#FF0000"><b>else
      </b></font>Str <font color="#000080">:= </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">) + </font>M<font color="#000080">.</font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]);
  </font><font color="#FF0000"><b>end
  else
  begin
    if </b></font>Sign <font color="#FF0000"><b>then
      </b></font>Res <font color="#000080">:= </font><font color="#800000">'-'
    </font><font color="#FF0000"><b>else
      </b></font>Res <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
    </font>T<font color="#000080">.</font>Div10<font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>I <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
    begin
      </b></font>Ciffer <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>M<font color="#000080">.</font>AbsCompare<font color="#000080">(</font>T<font color="#000080">) &gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>M<font color="#000080">.</font>AbsSubtract<font color="#000080">(</font>T<font color="#000080">);
        </font>Inc<font color="#000080">(</font>Ciffer<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Res <font color="#000080">:= </font>Res <font color="#000080">+ </font>Char<font color="#000080">(</font>Byte<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">) + </font>Ciffer<font color="#000080">);
      </font>Dec<font color="#000080">(</font>I<font color="#000080">);
      </font>T<font color="#000080">.</font>Div10<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Str <font color="#000080">:= </font>Res<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>T<font color="#000080">.</font>Done<font color="#000080">;
  </font>M<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>StrHex<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>HexCif<font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Res<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>I<font color="#000080">: </font>Integer<font color="#000080">;
  </font>HasBegun<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>StrHex <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>HasBegun <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Sign <font color="#FF0000"><b>then
    </b></font>Res <font color="#000080">:= </font><font color="#800000">'-'
  </font><font color="#FF0000"><b>else
    </b></font>Res <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font>Used <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    if </b></font>HasBegun <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      if </b></font>HasBegun <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">12 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Res <font color="#000080">:= </font>Res <font color="#000080">+ </font>HexCif<font color="#000080">[</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">12 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
        </font>HasBegun <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>HasBegun <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">8 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Res <font color="#000080">:= </font>Res <font color="#000080">+ </font>HexCif<font color="#000080">[</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">8 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
        </font>HasBegun <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>HasBegun <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        </b></font>Res <font color="#000080">:= </font>Res <font color="#000080">+ </font>HexCif<font color="#000080">[</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>shr </b></font><font color="#800000">4 </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
        </font>HasBegun <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>Res <font color="#000080">:= </font>Res <font color="#000080">+ </font>HexCif<font color="#000080">[</font>Value<font color="#000080">^[</font>I<font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">$F</font><font color="#000080">];
      </font>HasBegun <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>StrHex <font color="#000080">:= </font>Res<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Used <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'-' </font><font color="#FF0000"><b>then
  begin
    </b></font>Sign <font color="#000080">:= </font>True<font color="#000080">;
    </font>I <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>Sign <font color="#000080">:= </font>False<font color="#000080">;
    </font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>I <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Mult10<font color="#000080">;
    </font>AbsIncrement<font color="#000080">(</font>Byte<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]) - </font>Byte<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">));
    </font>Inc<font color="#000080">(</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>AsLong<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Used <font color="#000080">&gt; </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Used <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>Critical <font color="#FF0000"><b>then
    </b></font>RunError<font color="#000080">(</font><font color="#800000">215</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Used <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>then
    </b></font>Res <font color="#000080">:= </font>Value<font color="#000080">^[</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>shl </b></font><font color="#800000">16 </font><font color="#FF0000"><b>or </b></font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]
  </font><font color="#FF0000"><b>else if </b></font>Used <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>Res <font color="#000080">:= </font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">]
  </font><font color="#FF0000"><b>else
    </b></font>Res <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Sign <font color="#FF0000"><b>then
    </b></font>AsLong <font color="#000080">:= -</font>Res
  <font color="#FF0000"><b>else
    </b></font>AsLong <font color="#000080">:= </font>Res<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Swap<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>MW<font color="#000080">: </font>Word<font color="#000080">;
  </font>MP<font color="#000080">: </font>PWordArr<font color="#000080">;
  </font>MB<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MW <font color="#000080">:= </font>Alloc<font color="#000080">;
  </font>Alloc <font color="#000080">:= </font>AValue<font color="#000080">.</font>Alloc<font color="#000080">;
  </font>AValue<font color="#000080">.</font>Alloc <font color="#000080">:= </font>MW<font color="#000080">;
  </font>MW <font color="#000080">:= </font>Used<font color="#000080">;
  </font>Used <font color="#000080">:= </font>AValue<font color="#000080">.</font>Used<font color="#000080">;
  </font>AValue<font color="#000080">.</font>Used <font color="#000080">:= </font>MW<font color="#000080">;
  </font>MP <font color="#000080">:= </font>Value<font color="#000080">;
  </font>Value <font color="#000080">:= </font>AValue<font color="#000080">.</font>Value<font color="#000080">;
  </font>AValue<font color="#000080">.</font>Value <font color="#000080">:= </font>MP<font color="#000080">;
  </font>MB <font color="#000080">:= </font>Sign<font color="#000080">;
  </font>Sign <font color="#000080">:= </font>AValue<font color="#000080">.</font>Sign<font color="#000080">;
  </font>AValue<font color="#000080">.</font>Sign <font color="#000080">:= </font>MB<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>AbsCompare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Used <font color="#000080">&gt; </font>AValue<font color="#000080">.</font>Used <font color="#FF0000"><b>then
    </b></font>AbsCompare <font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>else if </b></font>Used <font color="#000080">&lt; </font>AValue<font color="#000080">.</font>Used <font color="#FF0000"><b>then
    </b></font>AbsCompare <font color="#000080">:= -</font><font color="#800000">1
  </font><font color="#FF0000"><b>else
    asm
      </b></font><font color="#FF00FF">PUSH  DS
      LES    DI,Self
      LES    DI,[ES:DI.TBigNum.Value]
      LDS   SI,AValue
      MOV    CX,[DS:SI.TBigNum.Used]
      LDS    SI,[DS:SI.TBigNum.Value]
      MOV    DX,CX
      DEC    DX
      SHL    DX,1
      ADD    DI,DX
      ADD    SI,DX
      STD
      REPZ  CMPSW
      MOV    @Result,0FFFFh
      JA    @@1
      MOV    @Result,0000h
      JE    @@1
      MOV    @Result,0001h
@@1:  POP    DS
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>AbsIncrement<font color="#000080">(</font>By<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Used <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font>Critical <font color="#FF0000"><b>then
  begin
    </b></font>Inc<font color="#000080">(</font>Used<font color="#000080">);
    </font>Realloc<font color="#000080">(</font>Used<font color="#000080">, </font>True<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    DEC    CX
    LES   DI,[ES:DI.TBigNum.Value]
    CLD
    MOV   AX,[ES:DI]
    ADD   AX,By
    STOSW
    JCXZ  @@1
@@0:MOV   AX,[ES:DI]
    ADC   AX,0
    STOSW
    LOOP  @@0
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>AbsDecrement<font color="#000080">(</font>By<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">LES   DI,Self
    MOV   CX,[ES:DI.TBigNum.Used]
    DEC    CX
    LES   DI,[ES:DI.TBigNum.Value]
    CLD
    MOV   AX,ES:[DI]
    SUB   AX,By
    STOSW
    JCXZ  @@1
@@0:MOV   AX,ES:[DI]
    SBB   AX,0
    STOSW
    LOOP  @@0
@@1:
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>AbsAdd<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>RealAdds<font color="#000080">, </font>ExtraAdds<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>AValue<font color="#000080">.</font>Used <font color="#000080">&gt;= </font>Alloc <font color="#FF0000"><b>then
    if </b></font>AValue<font color="#000080">.</font>Critical <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>AValue<font color="#000080">.</font>Used <font color="#000080">= </font>Alloc<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Alloc <font color="#000080">= </font>Used<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>Critical <font color="#FF0000"><b>then
      </b></font>Realloc<font color="#000080">(</font>AValue<font color="#000080">.</font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>True<font color="#000080">)
    </font><font color="#FF0000"><b>else
      if </b></font>AValue<font color="#000080">.</font>Used <font color="#000080">&gt; </font>Alloc <font color="#FF0000"><b>then
        </b></font>Realloc<font color="#000080">(</font>AValue<font color="#000080">.</font>Used<font color="#000080">, </font>True<font color="#000080">)
  </font><font color="#FF0000"><b>else if </b></font>AValue<font color="#000080">.</font>Used <font color="#000080">&lt; </font>Alloc <font color="#FF0000"><b>then
    if </b></font><font color="#000080">(</font>Used <font color="#000080">= </font>Alloc<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>Critical <font color="#FF0000"><b>then
      </b></font>Realloc<font color="#000080">(</font>Used <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>True<font color="#000080">);
  </font>RealAdds <font color="#000080">:= </font>AValue<font color="#000080">.</font>Used<font color="#000080">;
  </font>ExtraAdds <font color="#000080">:= </font>Alloc <font color="#000080">- </font>RealAdds<font color="#000080">;
  </font><font color="#FF0000"><b>asm
    </b></font><font color="#FF00FF">PUSH  DS
    LES    DI,Self
    LES    DI,[ES:DI.TBigNum.Value]
    LDS    SI,AValue
    LDS    SI,[DS:SI.TBigNum.Value]
    MOV    CX,RealAdds
    JCXZ  @@2
    CLD
    CLC
@@0:LODSW
    ADC    [ES:DI],AX
    INC    DI
    INC    DI
    LOOP  @@0
    MOV    CX,ExtraAdds
    JCXZ  @@2
@@1:ADC    WORD PTR [ES:DI],0
    INC    DI
    INC    DI
    LOOP  @@1
@@2:POP    DS
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>AbsSubtract<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>AValue<font color="#000080">: </font>TBigNum<font color="#000080">);
</font><font color="#FF0000"><b>begin
  asm
    </b></font><font color="#FF00FF">PUSH  DS
    LES   DI,Self
    MOV   DX,[ES:DI.TBigNum.Used]
    LES   DI,[ES:DI.TBigNum.Value]
    LDS   SI,AValue
    MOV   CX,[DS:SI.TBigNum.Used]
    LDS   SI,[DS:SI.TBigNum.Value]
    SUB    DX,CX
    JCXZ  @@2
    CLD
    CLC
@@0:LODSW
    SBB   [ES:DI],AX
    INC   DI
    INC   DI
    LOOP  @@0
    MOV    CX,DX
    JCXZ  @@2
@@1:SBB   WORD PTR [ES:DI],0
    INC   DI
    INC   DI
    LOOP  @@0
@@2:POP   DS
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>AbsDivide<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Bit<font color="#000080">, </font>Res<font color="#000080">, </font>Divisor<font color="#000080">: </font>TBigNum<font color="#000080">;
  </font>NoRemainder<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ADivisor<font color="#000080">.</font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>RunError<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
  </font>Bit<font color="#000080">.</font>Init<font color="#000080">;
  </font>Res<font color="#000080">.</font>Init<font color="#000080">;
  </font>Divisor<font color="#000080">.</font>Init<font color="#000080">;
  </font>Divisor<font color="#000080">.</font>Assign<font color="#000080">(</font>ADivisor<font color="#000080">);
  </font>NoRemainder <font color="#000080">:= </font>False<font color="#000080">;
  </font>Bit<font color="#000080">.</font>AssignLong<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font>Res<font color="#000080">.</font>AssignLong<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>AbsCompare<font color="#000080">(</font>Divisor<font color="#000080">) &gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Bit<font color="#000080">.</font>Mult2<font color="#000080">;
    </font>Divisor<font color="#000080">.</font>Mult2<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Bit<font color="#000080">.</font>Value<font color="#000080">^[</font><font color="#800000">0</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#800000">1 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>NoRemainder <font color="#FF0000"><b>do
  begin
    </b></font>Bit<font color="#000080">.</font>Div2<font color="#000080">;
    </font>Divisor<font color="#000080">.</font>Div2<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>AbsCompare<font color="#000080">(</font>Divisor<font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">1</font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Res<font color="#000080">.</font>BitwiseOr<font color="#000080">(</font>Bit<font color="#000080">);
        </font>AbsSubtract<font color="#000080">(</font>Divisor<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">0</font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>NoRemainder <font color="#000080">:= </font>True<font color="#000080">;
        </font>Res<font color="#000080">.</font>BitwiseOr<font color="#000080">(</font>Bit<font color="#000080">);
        </font>AbsSubtract<font color="#000080">(</font>Divisor<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>AbsDivide <font color="#000080">:= </font>NoRemainder<font color="#000080">;
  </font>Assign<font color="#000080">(</font>Res<font color="#000080">);
  </font>Divisor<font color="#000080">.</font>Done<font color="#000080">;
  </font>Res<font color="#000080">.</font>Done<font color="#000080">;
  </font>Bit<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>AbsModulo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ADivisor<font color="#000080">: </font>TBigNum<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Divisor<font color="#000080">: </font>TBigNum<font color="#000080">;
  </font>NoRemainder<font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Count<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>ADivisor<font color="#000080">.</font>Used <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>RunError<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
  </font>Divisor<font color="#000080">.</font>Init<font color="#000080">;
  </font>Divisor<font color="#000080">.</font>Assign<font color="#000080">(</font>ADivisor<font color="#000080">);
  </font>NoRemainder <font color="#000080">:= </font>False<font color="#000080">;
  </font>Count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>AbsCompare<font color="#000080">(</font>Divisor<font color="#000080">) &gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Inc<font color="#000080">(</font>Count<font color="#000080">);
    </font>Divisor<font color="#000080">.</font>Mult2<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Count <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>NoRemainder <font color="#FF0000"><b>do
  begin
    </b></font>Divisor<font color="#000080">.</font>Div2<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>AbsCompare<font color="#000080">(</font>Divisor<font color="#000080">) </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">1</font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>AbsSubtract<font color="#000080">(</font>Divisor<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#800000">0</font><font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>NoRemainder <font color="#000080">:= </font>True<font color="#000080">;
        </font>AbsSubtract<font color="#000080">(</font>Divisor<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Dec<font color="#000080">(</font>Count<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>AbsModulo <font color="#000080">:= </font>NoRemainder<font color="#000080">;
  </font>Divisor<font color="#000080">.</font>Done<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>Realloc<font color="#000080">(</font>Words<font color="#000080">: </font>Word<font color="#000080">; </font>Preserve<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>NewValue<font color="#000080">: </font>PWordArr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Words <font color="#000080">&lt;= </font>Alloc <font color="#FF0000"><b>then
  begin
    if </b></font>Preserve <font color="#FF0000"><b>then
    begin
      </b></font>FillChar<font color="#000080">(</font>Value<font color="#000080">^[</font>Used<font color="#000080">], (</font>Alloc <font color="#000080">- </font>Used<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Preserve <font color="#FF0000"><b>then
  begin
    </b></font>GetMem<font color="#000080">(</font>NewValue<font color="#000080">, </font>Words <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
    </font>Move<font color="#000080">(</font>Value<font color="#000080">^, </font>NewValue<font color="#000080">^, </font>Used <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">);
    </font>FillChar<font color="#000080">(</font>NewValue<font color="#000080">^[</font>Used<font color="#000080">], (</font>Words <font color="#000080">- </font>Used<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
    </font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>Alloc <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
    </font>Value <font color="#000080">:= </font>NewValue<font color="#000080">;
    </font>Alloc <font color="#000080">:= </font>Words<font color="#000080">;
  </font><font color="#FF0000"><b>end
  else
  begin
    </b></font>FreeMem<font color="#000080">(</font>Value<font color="#000080">, </font>Alloc <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
    </font>Alloc <font color="#000080">:= </font>Words<font color="#000080">;
    </font>GetMem<font color="#000080">(</font>Value<font color="#000080">, </font>Alloc <font color="#000080">* </font>SizeOf<font color="#000080">(</font>Word<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TBigNum<font color="#000080">.</font>Critical<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Critical <font color="#000080">:= (</font>Used <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>Used <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font><font color="#000080">(</font>SizeOf<font color="#000080">(</font>Word<font color="#000080">) * </font><font color="#800000">8 </font><font color="#000080">- </font><font color="#800000">1</font><font color="#000080">)) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TBigNum<font color="#000080">.</font>CountUsed<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Used <font color="#000080">:= </font>Alloc<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Used <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Value<font color="#000080">^[</font>Used <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Dec<font color="#000080">(</font>Used<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>BigA<font color="#000080">, </font>BigB<font color="#000080">: </font>TBigNum<font color="#000080">;
  </font>I<font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>BigA<font color="#000080">.</font>Init<font color="#000080">; </font><font color="#008000"><i>{ Caution: Because of the new dynamic memory allocation }
  </i></font>BigB<font color="#000080">.</font>Init<font color="#000080">; </font><font color="#008000"><i>{          you have to use Init and Done. }
  </i></font>WriteLn<font color="#000080">(</font><font color="#800000">'Fibonacci numbers:'</font><font color="#000080">);
  </font>BigA<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
  </font>BigB<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'1'</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">370 </font><font color="#FF0000"><b>do
  begin
    </b></font>WriteLn<font color="#000080">(</font>BigB<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">79</font><font color="#000080">);
    </font>BigA<font color="#000080">.</font>Add<font color="#000080">(</font>BigB<font color="#000080">);
    </font>BigA<font color="#000080">.</font>Swap<font color="#000080">(</font>BigB<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font>BigB<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">79</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Factorials:'</font><font color="#000080">);
  </font>BigA<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'1'</font><font color="#000080">);
  </font>BigB<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'1'</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">49 </font><font color="#FF0000"><b>do
  begin
    </b></font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">' = '</font><font color="#000080">, </font>BigB<font color="#000080">.</font>Str<font color="#000080">, </font><font color="#800000">'!'</font><font color="#000080">);
    </font>BigB<font color="#000080">.</font>AbsIncrement<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
    </font>BigA<font color="#000080">.</font>Multiply<font color="#000080">(</font>BigB<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">49 </font><font color="#FF0000"><b>do
  begin
    </b></font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">' = '</font><font color="#000080">, </font>BigB<font color="#000080">.</font>Str<font color="#000080">, </font><font color="#800000">'!'</font><font color="#000080">);
    </font>BigA<font color="#000080">.</font>Divide<font color="#000080">(</font>BigB<font color="#000080">);
    </font>BigB<font color="#000080">.</font>AbsDecrement<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">' = '</font><font color="#000080">, </font>BigB<font color="#000080">.</font>Str<font color="#000080">, </font><font color="#800000">'!'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">(</font><font color="#800000">'Powers of 2:'</font><font color="#000080">);
  </font>BigA<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'1'</font><font color="#000080">);
  </font>BigB<font color="#000080">.</font>Val<font color="#000080">(</font><font color="#800000">'-2'</font><font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">250 </font><font color="#FF0000"><b>do
  begin
    </b></font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">79</font><font color="#000080">);
    </font>BigA<font color="#000080">.</font>Multiply<font color="#000080">(</font>BigB<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">250 </font><font color="#FF0000"><b>do
  begin
    </b></font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">79</font><font color="#000080">);
    </font>BigA<font color="#000080">.</font>Divide<font color="#000080">(</font>BigB<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>WriteLn<font color="#000080">(</font>BigA<font color="#000080">.</font>Str<font color="#000080">: </font><font color="#800000">79</font><font color="#000080">);
  </font>BigB<font color="#000080">.</font>Done<font color="#000080">;
  </font>BigA<font color="#000080">.</font>Done<font color="#000080">;
  </font>Write<font color="#000080">(</font><font color="#800000">'Press enter to exit.'</font><font color="#000080">);
  </font>ReadLn<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0464.PAS">Original</a><b>]</b></p></body>
</html>
