<html>
<head><title> "Extended TIniFile Component" by FERDINAND SOETHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0152.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{****************************************************************
 * 	TExtIniF class																							*
 *	created and copyright by Ferdinand Soethe 1996  						*
 *	(email: f.soethe@oln.comlink.apc.org)												*
 *																															*
 *	You may use this source code in your applications           *
 *	(a word of credit would be nice) but you must not 					*
 *	resell it as part of a library or publish it in paper-			*
 *	or electronic form without asking my permission.						*
 *																															*
 *	TExtIniF extends Delphi's TIniFile to simplify saving a 		*
 *	components state to an INI-File. After creation you can 		*
 *	register any number of components and	save and retrieve     *
 *  their settings with just one call to StoreObjectStates.			*
 *																															*
 ****************************************************************}

</i></font><font color="#FF0000"><b>unit </b></font>extINIF<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
</b></font>	<font color="#008000"><i>{unfortunately we need to include a units of classes
 	 that we want to be able to store}
  </i></font>IniFiles<font color="#000080">, </font>Files<font color="#000080">, </font>Classes<font color="#000080">, </font>Forms<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>FileCtrl<font color="#000080">, </font>Menus<font color="#000080">,
  </font>sysUtils<font color="#000080">, </font>TabNotBK<font color="#000080">;

</font><font color="#FF0000"><b>type
</b></font>	EExtIniFError <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);
</font>	TExtIniF <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TIniFile<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private-Deklarationen }
</i></font>		FAutoStore<font color="#000080">: </font>boolean<font color="#000080">;    </font><font color="#008000"><i>{store all objects states before TExtIniF is destroyed}
</i></font>		FRegObjects<font color="#000080">: </font>TStringList<font color="#000080">; </font><font color="#008000"><i>{list of all registered objects}
</i></font>		FIniSection<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;    </font><font color="#008000"><i>{Name of [section] where values are stored}
  </i></font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected-Deklarationen }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public-Deklarationen }
</i></font>		<font color="#FF0000"><b>constructor </b></font>create<font color="#000080">(</font>IniFName<font color="#000080">: </font>TFileName<font color="#000080">);
</font>		<font color="#FF0000"><b>destructor </b></font>destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
</font>		<font color="#008000"><i>{find the ini section for a registered object}
</i></font>		<font color="#FF0000"><b>function </b></font>GetIniSection<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font>		<font color="#008000"><i>{Add a component to the list of objects}
</i></font>		<font color="#FF0000"><b>procedure </b></font>RegisterObject<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font>		<font color="#008000"><i>{Remove a component to the list of objects}
    </i></font><font color="#FF0000"><b>procedure </b></font>UnRegisterObject<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font>		<font color="#008000"><i>{Retrieve the setting of a single Object}
    </i></font><font color="#FF0000"><b>procedure </b></font>ReStoreObjectState<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font>		<font color="#008000"><i>{Restore states of all registered objects}
</i></font>		<font color="#FF0000"><b>procedure </b></font>RestoreObjectStates<font color="#000080">;
</font>		<font color="#008000"><i>{Restore states of all registered objects}
</i></font>		<font color="#FF0000"><b>procedure </b></font>StoreObjectState<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font>		<font color="#008000"><i>{Store state of a single object}
</i></font>		<font color="#FF0000"><b>procedure </b></font>StoreObjectStates<font color="#000080">;
</font>		<font color="#008000"><i>{Store states of all registered objects}
  </i></font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published-Deklarationen }
</i></font>		<font color="#FF0000"><b>property </b></font>AutoStore<font color="#000080">: </font>boolean <font color="#FF0000"><b>read </b></font>FAutoStore <font color="#FF0000"><b>write </b></font>FAutoStore<font color="#000080">;
</font>		<font color="#FF0000"><b>property </b></font>IniSection<font color="#000080">: </font><font color="#FF0000"><b>string read </b></font>FIniSection <font color="#FF0000"><b>write </b></font>FIniSection<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{ find the section string to a registered object
   if not registered or section string is empty
   return default value}
</i></font><font color="#FF0000"><b>function </b></font>TExtIniF<font color="#000080">.</font>GetIniSection<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	index<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	index<font color="#000080">:= </font>FRegObjects<font color="#000080">.</font>indexOfObject<font color="#000080">(</font>obj<font color="#000080">);
</font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>index <font color="#000080">&gt; -</font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>		result<font color="#000080">:= </font>FRegObjects<font color="#000080">.</font>strings<font color="#000080">[</font>index<font color="#000080">];
</font>		<font color="#FF0000"><b>if </b></font>result <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>then
</b></font>			result<font color="#000080">:= </font>FIniSection<font color="#000080">;
</font>	<font color="#FF0000"><b>end else
</b></font>		result<font color="#000080">:= </font>FIniSection<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{GetIniSection}

{}
</i></font><font color="#FF0000"><b>constructor </b></font>TExtIniF<font color="#000080">.</font>create<font color="#000080">(</font>IniFName<font color="#000080">: </font>TFileName<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{if you don't pass your own name for the ini-File, it will be the name
	 of your exe-file with the extension '*.INI'}
</i></font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>IniFName <font color="#000080">= </font><font color="#800000">'' </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>IniFName<font color="#000080">:= </font>ExtraxtFileBaseName<font color="#000080">(</font>application<font color="#000080">.</font>exename<font color="#000080">)+</font><font color="#800000">'.ini'</font><font color="#000080">;
</font>	<font color="#FF0000"><b>inherited </b></font>create<font color="#000080">(</font>IniFName<font color="#000080">);
  </font>FRegObjects<font color="#000080">:= </font>TStringList<font color="#000080">.</font>Create<font color="#000080">;
</font>	FIniSection<font color="#000080">:= </font><font color="#800000">'Options'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>destructor </b></font>TExtIniF<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{If AutoStore is set, values are stored
	 before TExtIniF-Object is destroyed}
</i></font>	<font color="#FF0000"><b>if </b></font>FAutoStore <font color="#FF0000"><b>then </b></font>StoreObjectStates<font color="#000080">;
</font>	FRegObjects<font color="#000080">.</font>destroy<font color="#000080">;
</font>	<font color="#FF0000"><b>inherited </b></font>destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Add an object to the list of monitored objects. If you pass an empty string
   for INISection, the default value will apply and no name will be stored}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>RegisterObject<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{check if object is already registered}
</i></font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>FRegObjects<font color="#000080">.</font>indexOfObject<font color="#000080">(</font>obj<font color="#000080">) = -</font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>then
</b></font>		FRegObjects<font color="#000080">.</font>addObject<font color="#000080">(</font>INISection<font color="#000080">,</font>obj<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Remove an object from the list of monitored objects.}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>UnRegisterObject<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>	index<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	index<font color="#000080">:= </font>FRegObjects<font color="#000080">.</font>indexOfObject<font color="#000080">(</font>obj<font color="#000080">);
</font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>index <font color="#000080">&gt; -</font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>then
</b></font>		FRegObjects<font color="#000080">.</font>delete<font color="#000080">(</font>index<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ Restores the name of an object from the INI-File
   Note: When there is no entry in the INI-File, the object's value
 				 is not changed.}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>ReStoreObjectState<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>	strBuf<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>INISection <font color="#000080">= </font><font color="#800000">'' </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>INISection<font color="#000080">:= </font>FIniSection<font color="#000080">;
</font>	<font color="#008000"><i>{the next lines check for the type of object and
	 restore whatever property we would like to store of that object
	 if you make changes here you will need to make changes in
	 StoreObjectState as well!!!}
  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj<font color="#000080">.</font>classInfo <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TCheckBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
      with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TCheckBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>				<font color="#008000"><i>{Checkboxes: restore checked state}
        </i></font>checked<font color="#000080">:= </font>readBool<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>checked<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
    if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TEdit<font color="#000080">) </font><font color="#FF0000"><b>then begin
      with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TEdit<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>				<font color="#008000"><i>{Editfield: restore text}
        </i></font>text<font color="#000080">:= </font>readString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>text<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
    if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TMenuItem<font color="#000080">) </font><font color="#FF0000"><b>then begin
      with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TMenuItem<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>				<font color="#008000"><i>{Menuitem: restore checked state}
        </i></font>checked<font color="#000080">:= </font>readBool<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>checked<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
</b></font>		<font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TTabbedNoteBook<font color="#000080">) </font><font color="#FF0000"><b>then begin
        with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TTabbedNoteBook<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>					<font color="#008000"><i>{Notebook: restore open Tab}
          </i></font>pageIndex<font color="#000080">:= </font>readInteger<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>pageIndex<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
    if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TDriveComboBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
      with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TDriveComboBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>				<font color="#008000"><i>{DriveCombo: restore selected drive}
</i></font>				strBuf<font color="#000080">:= </font>readString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>Drive<font color="#000080">);
        </font>Drive<font color="#000080">:= </font>strBuf<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
    if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TDirectoryListBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
      with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TDirectoryListBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>				<font color="#008000"><i>{DirectoryList: restore current directory}
        </i></font>Directory<font color="#000080">:= </font>readString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>Directory<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end else
</b></font>    	<font color="#FF0000"><b>raise </b></font>EExtIniFError<font color="#000080">.</font>create<font color="#000080">(</font><font color="#800000">'This object is not supported!'</font><font color="#000080">);
</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Restores the state of all registered objects
   from the INI-File}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>RestoreObjectStates<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	objNo<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#008000"><i>{iterate through all registered objects}
</i></font>	<font color="#FF0000"><b>for </b></font>objNo<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>FRegObjects<font color="#000080">.</font>count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>ReStoreObjectState<font color="#000080">(</font>FRegObjects<font color="#000080">.</font>objects<font color="#000080">[</font>objNo<font color="#000080">],</font>FRegObjects<font color="#000080">.</font>strings<font color="#000080">[</font>objNo<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Stores the state of an object to the INI-File}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>StoreObjectState<font color="#000080">(</font>obj<font color="#000080">: </font>TObject<font color="#000080">; </font>INISection<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>		strBuf<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#FF0000"><b>if </b></font><font color="#000080">( </font>INISection <font color="#000080">= </font><font color="#800000">'' </font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>INISection<font color="#000080">:= </font>FIniSection<font color="#000080">;

</font>	<font color="#008000"><i>{the next lines check for the type of object and
	 store whatever property we would like to store of that object
	 if you make changes here you will need to make changes in
	 ReStoreObjectState as well!!!}

  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj<font color="#000080">.</font>classInfo <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil </b></font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TCheckBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>				<font color="#008000"><i>{Checkboxes: store checked state}
        </i></font><font color="#FF0000"><b>with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TCheckBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
          </b></font>writeBool<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>checked<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end else
      if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TEdit<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>				<font color="#008000"><i>{Editfield: store text}
        </i></font><font color="#FF0000"><b>with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TEdit<font color="#000080">) </font><font color="#FF0000"><b>do begin
          </b></font>writeString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>text<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end else
      if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TMenuItem<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>				<font color="#008000"><i>{Menuitem: restore checked state}
        </i></font><font color="#FF0000"><b>with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TMenuItem<font color="#000080">) </font><font color="#FF0000"><b>do begin
          </b></font>writeBool<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>checked<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end else
</b></font>			<font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TTabbedNoteBook<font color="#000080">) </font><font color="#FF0000"><b>then begin
        with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TTabbedNoteBook<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>					<font color="#008000"><i>{Notebook: restore open Tab}
          </i></font>writeInteger<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>pageIndex<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>  	  <font color="#FF0000"><b>end else
</b></font>			<font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TDriveComboBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>      	<font color="#FF0000"><b>with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TDriveComboBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
</b></font>					<font color="#008000"><i>{DriveCombo: restore selected drive}
</i></font>					writeString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>Drive<font color="#000080">);
</font>      	<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>    	<font color="#FF0000"><b>end else
</b></font>			<font color="#FF0000"><b>if </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>is </b></font>TDirectoryListBox<font color="#000080">) </font><font color="#FF0000"><b>then begin
</b></font>				<font color="#008000"><i>{DirectoryList: restore current directory}
        </i></font><font color="#FF0000"><b>with </b></font><font color="#000080">(</font>obj <font color="#FF0000"><b>as </b></font>TDirectoryListBox<font color="#000080">) </font><font color="#FF0000"><b>do begin
          </b></font>writeString<font color="#000080">(</font>INISection<font color="#000080">,</font>Name<font color="#000080">,</font>Directory<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>	    <font color="#FF0000"><b>end else
</b></font>  	  	<font color="#FF0000"><b>raise </b></font>EExtIniFError<font color="#000080">.</font>create<font color="#000080">(</font><font color="#800000">'This object is not supported!'</font><font color="#000080">);
</font>		<font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Stores the state of all registered objects
   to the INI-File}
</i></font><font color="#FF0000"><b>procedure </b></font>TExtIniF<font color="#000080">.</font>StoreObjectStates<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>	objNo<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#FF0000"><b>for </b></font>objNo<font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>FRegObjects<font color="#000080">.</font>count <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    </b></font>StoreObjectState<font color="#000080">(</font>FRegObjects<font color="#000080">.</font>objects<font color="#000080">[</font>objNo<font color="#000080">],</font>FRegObjects<font color="#000080">.</font>strings<font color="#000080">[</font>objNo<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0152.PAS">Original</a><b>]</b></p></body>
</html>
