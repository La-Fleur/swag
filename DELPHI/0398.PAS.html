<html>
<head><title> "REALLY transparent TGroupBox?" by EDDIE SHIPMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0398.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Once again<font color="#000080">, </font>the dcr <font color="#FF0000"><b>is </b></font>attached<font color="#000080">...

</font><font color="#008000"><i>(*
TTransparentGroupBox - Eddie Shipman

 TGroupBox that is transparent and allows colored bevels.

 Added two properties:
****************************************************************************
***
 Property: - BevelShadowColor-

    This is the color of the Bevel's Shadow, Default clBtnShadow.
    Change this color to change the color of the Bevel's Shadow.

****************************************************************************
***
 Property:  BevelHighlightColor-

    This is the color of the Bevel's Highlight, Default clBtnHighlight.
    Change this color to change the color of the Bevel's Highlight.

****************************************************************************
***
12/22/97 - Added DrawFrame procedure to correct the way the frame
               is drawn to let background actually show thorugh transparent
               text., {ES}

*)
</i></font><font color="#FF0000"><b>unit </b></font>TransparentGroupBox<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>ExtCtrls<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TTransparentGroupBox <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TGroupBox<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font>FBevelLowColor<font color="#000080">: </font>TColor<font color="#000080">;
    </font>FBevelHiColor<font color="#000080">: </font>TColor<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetBvlLowColor<font color="#000080">(</font>Value<font color="#000080">: </font>TColor<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetBvlHiColor<font color="#000080">(</font>Value<font color="#000080">: </font>TColor<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>WMEraseBkGnd<font color="#000080">(</font><font color="#FF0000"><b>Var Message</b></font><font color="#000080">:</font>TWMEraseBkGnd<font color="#000080">); </font><font color="#FF0000"><b>Message </b></font>WM_EraseBkGnd<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>WMMove<font color="#000080">(</font><font color="#FF0000"><b>Var Message</b></font><font color="#000080">:</font>TWMMove<font color="#000080">); </font><font color="#FF0000"><b>Message </b></font>WM_Move<font color="#000080">;
  </font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected declarations }
    </i></font><font color="#FF0000"><b>Procedure </b></font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Params<font color="#000080">:</font>TCreateParams<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>Paint<font color="#000080">; </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>SetParent<font color="#000080">(</font>AParent<font color="#000080">:</font>TWinControl<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>DrawFrame<font color="#000080">(</font>Rect<font color="#000080">:</font>TRect<font color="#000080">);
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
    </i></font><font color="#FF0000"><b>Constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">:</font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>Invalidate<font color="#000080">; </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published declarations }
    </i></font><font color="#FF0000"><b>property </b></font>BevelShadowColor<font color="#000080">:</font>TColor    <font color="#FF0000"><b>read </b></font>FBevelLowColor
                                       <font color="#FF0000"><b>write </b></font>SetBvlLowColor<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>BevelHighlightColor<font color="#000080">:</font>TColor <font color="#FF0000"><b>read </b></font>FBevelHiColor
                                       <font color="#FF0000"><b>write </b></font>SetBvlHiColor<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Standard'</font><font color="#000080">, [</font>TTransparentGroupBox<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TTransparentGroupBox<font color="#000080">.</font>Create <font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
  </font>ControlStyle<font color="#000080">:= </font>ControlStyle <font color="#000080">- [</font>csOpaque<font color="#000080">];
  </font>FBevelLowColor <font color="#000080">:= </font>clBtnShadow<font color="#000080">;
  </font>FBevelHiColor <font color="#000080">:= </font>clBtnHighlight<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Params<font color="#000080">:</font>TCreateParams<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  inherited </b></font>CreateParams <font color="#000080">(</font>Params<font color="#000080">);
  </font>Params<font color="#000080">.</font>ExStyle <font color="#000080">:= </font>Params<font color="#000080">.</font>ExStyle <font color="#000080">+ </font>WS_EX_TRANSPARENT<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>Paint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>H<font color="#000080">: </font>Integer<font color="#000080">;
  </font>R<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Canvas <font color="#FF0000"><b>do
  begin
    </b></font>Font <font color="#000080">:= </font>Self<font color="#000080">.</font>Font<font color="#000080">;
    </font>H <font color="#000080">:= </font>TextHeight<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
    </font>R <font color="#000080">:= </font>Rect<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>H <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#000080">- </font><font color="#800000">1</font><font color="#000080">, </font>Width<font color="#000080">, </font>Height<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>Ctl3D <font color="#FF0000"><b>then
    begin
      </b></font>DrawFrame<font color="#000080">(</font>R<font color="#000080">);
    </font><font color="#FF0000"><b>end else
    begin
      </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>clWindowFrame<font color="#000080">;
      </font>FrameRect<font color="#000080">(</font>R<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Text <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    begin
      </b></font>R <font color="#000080">:= </font>Rect<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>H<font color="#000080">);
      </font>DrawText<font color="#000080">(</font>Handle<font color="#000080">, </font>PChar<font color="#000080">(</font>Text<font color="#000080">), </font>Length<font color="#000080">(</font>Text<font color="#000080">), </font>R<font color="#000080">, </font>DT_LEFT <font color="#FF0000"><b>or
</b></font>DT_SINGLELINE <font color="#FF0000"><b>or
        </b></font>DT_CALCRECT<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Ctl3D <font color="#FF0000"><b>then
        </b></font>Brush<font color="#000080">.</font>Style<font color="#000080">:= </font>bsClear
      <font color="#FF0000"><b>else
        </b></font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>Color<font color="#000080">;
      </font>DrawText<font color="#000080">(</font>Handle<font color="#000080">, </font>PChar<font color="#000080">(</font>Text<font color="#000080">), </font>Length<font color="#000080">(</font>Text<font color="#000080">), </font>R<font color="#000080">, </font>DT_LEFT <font color="#FF0000"><b>or
</b></font>DT_SINGLELINE<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>WMEraseBkGnd<font color="#000080">(</font><font color="#FF0000"><b>Var Message</b></font><font color="#000080">:</font>TWMEraseBkGnd<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Repaint<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>SetParent<font color="#000080">(</font>AParent<font color="#000080">:</font>TWinControl<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Inherited </b></font>SetParent<font color="#000080">(</font>AParent<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Parent <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil then
    </b></font>SetWindowLong<font color="#000080">(</font>Parent<font color="#000080">.</font>Handle<font color="#000080">, </font>GWL_STYLE<font color="#000080">,
       </font>GetWindowLong<font color="#000080">(</font>Parent<font color="#000080">.</font>Handle<font color="#000080">, </font>GWL_STYLE<font color="#000080">)
          </font><font color="#FF0000"><b>And Not </b></font>WS_ClipChildren<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Rect <font color="#000080">:</font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Rect<font color="#000080">:= </font>BoundsRect<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Parent <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>Parent<font color="#000080">.</font>HandleAllocated <font color="#FF0000"><b>then
    </b></font>InvalidateRect<font color="#000080">(</font>Parent<font color="#000080">.</font>Handle<font color="#000080">, @</font>Rect<font color="#000080">, </font>True<font color="#000080">)
  </font><font color="#FF0000"><b>Else
    Inherited </b></font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>WMMove<font color="#000080">(</font><font color="#FF0000"><b>Var Message</b></font><font color="#000080">:</font>TWMMove<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>SetBvlLowColor<font color="#000080">(</font>Value<font color="#000080">: </font>TColor<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FBevelLowColor <font color="#000080">&lt;&gt; </font>Value <font color="#FF0000"><b>then
    </b></font>FBevelLowColor <font color="#000080">:= </font>Value<font color="#000080">;
  </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>SetBvlHiColor<font color="#000080">(</font>Value<font color="#000080">: </font>TColor<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FBevelHiColor <font color="#000080">&lt;&gt; </font>Value <font color="#FF0000"><b>then
    </b></font>FBevelHiColor <font color="#000080">:= </font>Value<font color="#000080">;
  </font>Invalidate<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TTransparentGroupBox<font color="#000080">.</font>DrawFrame<font color="#000080">(</font>Rect<font color="#000080">: </font>TRect<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>CaptionLength<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Canvas <font color="#FF0000"><b>do
  begin
    </b></font>Inc<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>Dec<font color="#000080">(</font>Rect<font color="#000080">.</font>Right<font color="#000080">);
    </font>Dec<font color="#000080">(</font>Rect<font color="#000080">.</font>Bottom<font color="#000080">);
    </font>CaptionLength <font color="#000080">:= </font>TextWidth<font color="#000080">(</font>Text<font color="#000080">);
    </font>Pen<font color="#000080">.</font>Color <font color="#000080">:= </font>FBevelHiColor<font color="#000080">;
    </font>MoveTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>MoveTo<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">+</font>CaptionLength<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Right<font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Right<font color="#000080">,</font>Rect<font color="#000080">.</font>Bottom<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">,</font>Rect<font color="#000080">.</font>Bottom<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>OffsetRect<font color="#000080">(</font>Rect<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">);
    </font>Pen<font color="#000080">.</font>Color <font color="#000080">:= </font>FBevelLowColor<font color="#000080">;
    </font>MoveTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>MoveTo<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">+</font>CaptionLength<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Right<font color="#000080">,</font>Rect<font color="#000080">.</font>Top<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Right<font color="#000080">,</font>Rect<font color="#000080">.</font>Bottom<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">,</font>Rect<font color="#000080">.</font>Bottom<font color="#000080">);
    </font>LineTo<font color="#000080">(</font>Rect<font color="#000080">.</font>Left<font color="#000080">, </font>Rect<font color="#000080">.</font>Top<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ --------------------------- TransparentGroupbox.dcr ------------------------------
Content-Transfer-Encoding: base64
{ cut this out, and save to a file .. then use a base64 processor to create
  TransparentGroupbox.dcr  .. there is one in SWAG that works fine !}

</i></font>AAAAACAAAAD<font color="#008000"><i>//wAA//8AAAAAAAAAAAAAAAAAAAAAAACIAQAASAAAAP//AgBUAFQAUgBBAE4AUwBQ
</i></font>AEEAUgBFAE4AVABHAFIATwBVAFAAQgBPAFgAAAAAAAAAAAAQEAkEAAAAAAAAAAAoAAAAGAAAABgA
AAABAAQAAAAAACABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAA
AICAgADAwMAAAAD<font color="#000080">/</font>AAD<font color="#000080">/</font>AAAA<font color="#008000"><i>//8A/wAAAP8A/wD//wAA////ADMzMzMzMzMzMzMzMzMzMzMzMzMz
</i></font>MzMzMzAAAAAAAAAAAAAAAzDMzMzMzMzMzMzMAzDMzMzMzMzMzMzMAzDMzd3d3d3d3d3cAzDMXFVV
VVVVVVXSAzDMXczMzMzMzCXSAzDMXczMzMzMIiXSAzDvXe<font color="#000080">/</font>v7<font color="#000080">+</font><font color="#800000">8</font>iIiXSAzD<font color="#000080">+</font>Xf7<font color="#000080">+/</font>v7<font color="#000080">+</font>IiXSAzDv
Xe<font color="#000080">/</font>v7<font color="#000080">+/</font>v7yXSAzD<font color="#000080">+</font>Xf7<font color="#000080">+/</font>v7<font color="#000080">+/</font>vXSAzDvXe<font color="#000080">/</font>v7<font color="#000080">+/</font>v7<font color="#000080">+</font>XSAzD<font color="#000080">+</font>Xf74jv7<font color="#000080">+/</font>vXeAzDvXe<font color="#000080">+</font>PuO<font color="#000080">/</font>v7<font color="#000080">+</font>Xf
AzD<font color="#000080">+</font>Xf4L<font color="#000080">+</font>P7<font color="#000080">+/</font>vXeAzDvXeDoDw8P7<font color="#000080">+</font>XfAzD<font color="#000080">+</font>XdDQ3Q0N3d7eAzDvVVAAUFBVVVXvAzD<font color="#000080">+/</font>v4O8P7<font color="#000080">+
/</font>v7<font color="#000080">+</font>AzAAAAAAAAAAAAAAAzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMw<font color="#000080">==
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0398.PAS">Original</a><b>]</b></p></body>
</html>
