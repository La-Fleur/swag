<html>
<head><title> "Serial port List" by ROBERT PENZ</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0394.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt; </font>I<font color="#800000">'m Looking For a Routine to get the number of serial ports in a
</font><font color="#000080">&gt; </font>machine<font color="#000080">, </font>There <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>function </b></font>GetSerialPortList but <font color="#FF0000"><b>Not in </b></font>Delphi
<font color="#000080">&gt; </font><font color="#FF0000"><b>Unit </b></font>Files <font color="#FF0000"><b>or </b></font>any C Header <font color="#FF0000"><b>File </b></font>What <font color="#FF0000"><b>function </b></font>can I use<font color="#000080">....?

...</font><font color="#FF0000"><b>and </b></font>here <font color="#FF0000"><b>is </b></font>it <font color="#000080">- </font>the best <font color="#FF0000"><b>function for </b></font>that<font color="#000080">!

</font><font color="#FF0000"><b>function </b></font>SerialAvail<font color="#000080">(</font>ComPort <font color="#000080">: </font>integer<font color="#000080">) : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>UsedComm <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">5</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= </font><font color="#800000">'COMx'</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>H <font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#008000"><i>{$IFNDEF VER80}
  </i></font>i <font color="#000080">: </font>integer<font color="#000080">;
  </font>CommConfig <font color="#000080">: </font>TCommConfig<font color="#000080">;
  </font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>begin
  </b></font>SerialAvail<font color="#000080">:=</font>false<font color="#000080">;
  </font>UsedComm<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">]:=</font>chr<font color="#000080">(</font>ComPort<font color="#000080">+</font><font color="#800000">$31</font><font color="#000080">);
  </font><font color="#008000"><i>{$IFDEF VER80}   { Win 3.x }
  </i></font>H<font color="#000080">:=</font>OpenComm<font color="#000080">(@</font>UsedComm<font color="#000080">,</font><font color="#800000">256</font><font color="#000080">,</font><font color="#800000">256</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>H<font color="#000080">&gt;=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>CloseComm<font color="#000080">(</font>H<font color="#000080">);
    </font>SerialAvail<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{$ELSE}          { Win95/NT }
  </i></font>H<font color="#000080">:=</font>CreateFile<font color="#000080">(</font>UsedComm<font color="#000080">,</font>GENERIC_READ <font color="#FF0000"><b>or </b></font>GENERIC_WRITE<font color="#000080">,
                </font><font color="#800000">0</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>OPEN_EXISTING<font color="#000080">,</font>FILE_ATTRIBUTE_NORMAL<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>H<font color="#000080">&lt;&gt;</font>INVALID_HANDLE_VALUE <font color="#FF0000"><b>then
  begin
    </b></font>CloseHandle<font color="#000080">(</font>H<font color="#000080">);
    </font>SerialAvail<font color="#000080">:=</font>true<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>GetLastError<font color="#000080">;
  </font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0394.PAS">Original</a><b>]</b></p></body>
</html>
