<html>
<head><title> "Component to give access to Application" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0174.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>App_prop<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TDuplicateError <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);
  </font>TMainFormError <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);
  </font>TApplicationProperties <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TComponent<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font>fHint <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>fHintColor <font color="#000080">: </font>TColor<font color="#000080">;
    </font>fHintPause <font color="#000080">: </font>Integer<font color="#000080">;
    </font>fShowHint <font color="#000080">: </font>Boolean<font color="#000080">;

    </font>fOnActivate <font color="#000080">: </font>TNotifyEvent<font color="#000080">;
    </font>fOnDeactivate <font color="#000080">: </font>TNotifyEvent<font color="#000080">;
    </font>fOnException <font color="#000080">: </font>TExceptionEvent<font color="#000080">;
    </font>fOnHelp <font color="#000080">: </font>THelpEvent<font color="#000080">;
    </font>fOnHint <font color="#000080">: </font>TNotifyEvent<font color="#000080">;
    </font>fOnIdle <font color="#000080">: </font>TIdleEvent<font color="#000080">;
    </font>fOnMessage <font color="#000080">: </font>TMessageEvent<font color="#000080">;
  </font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
    </i></font><font color="#FF0000"><b>constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
      </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>Destroy<font color="#000080">;
      </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Loaded<font color="#000080">;
      </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published declarations }
    </i></font><font color="#FF0000"><b>property </b></font>Hint <font color="#000080">: </font><font color="#FF0000"><b>String
      read </b></font>fHint <font color="#FF0000"><b>write </b></font>fHint<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>HintColor <font color="#000080">: </font>TColor
      <font color="#FF0000"><b>read </b></font>fHintColor <font color="#FF0000"><b>write </b></font>fHintColor<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>HintPause <font color="#000080">: </font>Integer
      <font color="#FF0000"><b>read </b></font>fHintPause <font color="#FF0000"><b>write </b></font>fHintPause<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ShowHint <font color="#000080">: </font>Boolean
      <font color="#FF0000"><b>read </b></font>fShowHint <font color="#FF0000"><b>write </b></font>fShowHint<font color="#000080">;

    </font><font color="#FF0000"><b>property </b></font>OnActivate <font color="#000080">: </font>TNotifyEvent
      <font color="#FF0000"><b>read </b></font>fOnActivate <font color="#FF0000"><b>write </b></font>fOnActivate<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnDeactivate <font color="#000080">: </font>TNotifyEvent
      <font color="#FF0000"><b>read </b></font>fOnDeactivate <font color="#FF0000"><b>write </b></font>fOnDeactivate<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnException <font color="#000080">: </font>TExceptionEvent
      <font color="#FF0000"><b>read </b></font>fOnException <font color="#FF0000"><b>write </b></font>fOnException<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnHelp <font color="#000080">: </font>THelpEvent
      <font color="#FF0000"><b>read </b></font>fOnHelp <font color="#FF0000"><b>write </b></font>fOnHelp<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnHint <font color="#000080">: </font>TNotifyEvent
      <font color="#FF0000"><b>read </b></font>fOnHint <font color="#FF0000"><b>write </b></font>fOnHint<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnIdle <font color="#000080">: </font>TIdleEvent
      <font color="#FF0000"><b>read </b></font>fOnIdle <font color="#FF0000"><b>write </b></font>fOnIdle<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMessage <font color="#000080">: </font>TMessageEvent
      <font color="#FF0000"><b>read </b></font>fOnMessage <font color="#FF0000"><b>write </b></font>fOnMessage<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

var
  </b></font>ComponentCounter <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TApplicationProperties<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
  </font>Inc<font color="#000080">(</font>ComponentCounter<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>ComponentCounter <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    raise </b></font>TDuplicateError<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#800000">'You can have only ' </font><font color="#000080">+
      </font><font color="#800000">'one ApplicationProperties component in a project'</font><font color="#000080">);

  </font>fHintColor <font color="#000080">:= </font>Application<font color="#000080">.</font>HintColor<font color="#000080">;
  </font>fHintPause <font color="#000080">:= </font>Application<font color="#000080">.</font>HintPause<font color="#000080">;
  </font>fShowHint <font color="#000080">:= </font>Application<font color="#000080">.</font>ShowHint<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TApplicationProperties<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Destroy<font color="#000080">;
  </font>Dec<font color="#000080">(</font>ComponentCounter<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TApplicationProperties<font color="#000080">.</font>Loaded<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>fHint <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>Hint <font color="#000080">:= </font>fHint<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>fHintColor <font color="#000080">&lt;&gt; </font>Application<font color="#000080">.</font>HintColor <font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>HintColor <font color="#000080">:= </font>fHintColor<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>fHintPause <font color="#000080">&lt;&gt; </font>Application<font color="#000080">.</font>HintPause <font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>HintPause <font color="#000080">:= </font>fHintPause<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>fShowHint <font color="#000080">&lt;&gt; </font>Application<font color="#000080">.</font>ShowHint <font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>ShowHint <font color="#000080">:= </font>fShowHint<font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnActivate<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnActivate <font color="#000080">:= </font>fOnActivate<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnDeactivate<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnDeactivate <font color="#000080">:= </font>fOnDeactivate<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnException<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnException <font color="#000080">:= </font>fOnException<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnHelp<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnHelp <font color="#000080">:= </font>fOnHelp<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnHint<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnHint <font color="#000080">:= </font>fOnHint<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnIdle<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnIdle <font color="#000080">:= </font>fOnIdle<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>fOnMessage<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>OnMessage <font color="#000080">:= </font>fOnMessage<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TApplicationProperties<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>initialization
  </b></font>ComponentCounter <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0174.PAS">Original</a><b>]</b></p></body>
</html>
