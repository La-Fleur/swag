<html>
<head><title> "New Styles in COMCTL32.DLL" by COLIN WILSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0193.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(*============================================================================*
 | The Internet Explorer release of COMCTL32.DLL introduced a number of new   |
 | styles.  These aren't documented anywhere yet by Microsoft, although they  |
 | do appear in the latest COMMCTRL.H supplied with VC4.2.  The styles mostly |
 | only work when the ViewStyle property is set to vsReport.                  |
 |                                                                            |
 | The new styles are:                                                        |
 |   GridLines        Displays thin, gray, horizontal and vertical lines      |
 |                    separating rows and columns.                            |
 |                                                                            |
 |   SubItemImages    Displays images against sub-items as well as items.     |
 |                                                                            |
 |   CheckBoxes       Displays a check box at the start of each row.          |
 |                                                                            |
 |   TrackSelect      Colours the item as you drag the mouse over it.         |
 |                    Automatically selects the item if you leave the mouse   |
 |                    on it.                                                  |
 |                                                                            |
 |   HeaderDragDrop   Enables drag/drop from the report header.               |
 |                                                                            |
 |   FullRowSelect    Highlights the entire row when you select it instead of |
 |                    just the first column data.                             |
 |                                                                            |
 |   OneClickActivate ??                                                      |
 |   TwoClickActivate ??                                                      |
 |                                                                            |
 | Note that this component doesn't do anything except set the appropriate    |
 | styles - so some styles may not be particularly useful.                    |
 |                                                                            |
 | Colin Wilson.  colin@wilsonc.demon.co.uk, or 100114.3641@compuserve.com    |
 *============================================================================*)

</i></font><font color="#FF0000"><b>unit </b></font>cmpExtendedListView<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>ComCtrls<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>LVM_FIRST <font color="#000080">= </font><font color="#800000">$1000</font><font color="#000080">;
  </font>LVM_SETEXTENDEDLISTVIEWSTYLE <font color="#000080">= </font>LVM_FIRST <font color="#000080">+ </font><font color="#800000">54</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TExtendedStyles <font color="#000080">= (</font>lvexGridLines<font color="#000080">, </font>lvexSubItemImages<font color="#000080">, </font>lvexCheckBoxes<font color="#000080">, </font>lvexTrackSelect<font color="#000080">,
                     </font>lvexHeaderDragDrop<font color="#000080">, </font>lvexFullRowSelect<font color="#000080">, </font>lvexOneClickActivate<font color="#000080">, </font>lvexTwoClickActivate<font color="#000080">);
  </font>TExtendedStyleRange <font color="#000080">= </font>lvexGridLines<font color="#000080">..</font>lvexTwoClickActivate<font color="#000080">;
  </font>TExtendedStyleSet <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>TExtendedStyleRange<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>LVS_EX_Styles <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font>TExtendedStyleRange<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Integer <font color="#000080">= (
    </font><font color="#800000">$00000001</font><font color="#000080">, </font><font color="#800000">$00000002</font><font color="#000080">, </font><font color="#800000">$00000004</font><font color="#000080">, </font><font color="#800000">$00000008</font><font color="#000080">,
    </font><font color="#800000">$00000010</font><font color="#000080">, </font><font color="#800000">$00000020</font><font color="#000080">, </font><font color="#800000">$00000040</font><font color="#000080">, </font><font color="#800000">$00000080</font><font color="#000080">);

</font><font color="#FF0000"><b>type
  </b></font>TExtendedListView <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TListView<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>fExtendedStyle <font color="#000080">: </font>TExtendedStyleSet<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetExtendedStyle <font color="#000080">(</font>value <font color="#000080">: </font>TExtendedStyleSet<font color="#000080">);

  </font><font color="#FF0000"><b>protected
    procedure </b></font>CreateWnd<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>published
    property </b></font>ExtendedStyle <font color="#000080">: </font>TExtendedStyleSet <font color="#FF0000"><b>read </b></font>fExtendedStyle <font color="#FF0000"><b>write </b></font>SetExtendedStyle<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure </b></font>TExtendedListView<font color="#000080">.</font>SetExtendedStyle <font color="#000080">(</font>value <font color="#000080">: </font>TExtendedStyleSet<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>exStyle <font color="#000080">: </font>Integer<font color="#000080">;
  </font>i <font color="#000080">: </font>TExtendedStyleRange<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>HandleAllocated <font color="#FF0000"><b>then
  begin
    </b></font>exStyle <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font>Low <font color="#000080">(</font>TExtendedStyleRange<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>High <font color="#000080">(</font>TExtendedStyleRange<font color="#000080">) </font><font color="#FF0000"><b>do
      if </b></font>i <font color="#FF0000"><b>in </b></font>value <font color="#FF0000"><b>then </b></font>exStyle <font color="#000080">:= </font>exStyle <font color="#FF0000"><b>or </b></font>LVS_EX_STYLES <font color="#000080">[</font>i<font color="#000080">];

    </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>LVM_SETEXTENDEDLISTVIEWSTYLE<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>exStyle<font color="#000080">)
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>fExtendedStyle <font color="#000080">:= </font>value<font color="#000080">;
  </font>Refresh
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TExtendedListView<font color="#000080">.</font>CreateWnd<font color="#000080">;

</font><font color="#FF0000"><b>begin
  inherited </b></font>CreateWnd<font color="#000080">;
  </font>SetExtendedStyle <font color="#000080">(</font>fExtendedStyle<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TExtendedListView<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0193.PAS">Original</a><b>]</b></p></body>
</html>
