<html>
<head><title> "Dial Up Networking" by SLAWOMIR SWIDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0372.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt; </font>I<font color="#800000">'d like to have my Delphi Program  dial up my ISP (using the WIN95)

</font>Hi Scott

    <font color="#FF0000"><b>To </b></font>start your Dial Up Connection<font color="#000080">, </font>you can use something like this<font color="#000080">:
</font>WinExec<font color="#000080">(</font><font color="#800000">'rundll32.exe rnaui.dll,RnaDial NAME'</font><font color="#000080">,</font>SW_SHOWNORMAL<font color="#000080">);
</font>where NAME <font color="#FF0000"><b>is </b></font>the exact title <font color="#FF0000"><b>of </b></font>your connectoid <font color="#FF0000"><b>in </b></font>dial up networking<font color="#000080">.
</font><font color="#FF0000"><b>To </b></font>automatic press button <font color="#000080">&quot;</font>Connect<font color="#000080">&quot; </font>you can use this<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Timer1Timer<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>buf<font color="#000080">,</font>buf1 <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
    </font>hnd<font color="#000080">,</font>hnd1 <font color="#000080">: </font>hWnd<font color="#000080">;
    </font>ln  <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     Try
       </b></font>hnd <font color="#000080">:= </font>GetForegroundWindow<font color="#000080">;
       </font>ln<font color="#000080">:=</font>GetWindowTextLength<font color="#000080">(</font>hnd<font color="#000080">);
       </font>GetMem<font color="#000080">(</font>lpStr<font color="#000080">,</font>ln<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
       </font>GetWindowText<font color="#000080">(</font>hnd<font color="#000080">,</font>lpStr<font color="#000080">,</font>ln<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
       </font>Edit1<font color="#000080">.</font>Text <font color="#000080">:= </font>StrPas<font color="#000080">(</font>lpStr<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>lpstr<font color="#000080">=</font><font color="#800000">'Connect with' </font><font color="#FF0000"><b>then
       begin
         </b></font>hnd1 <font color="#000080">:= </font>GetWindow<font color="#000080">(</font>hnd<font color="#000080">,</font>GW_child<font color="#000080">);
         </font>getwindowtext<font color="#000080">(</font>hnd1<font color="#000080">,</font>buf1<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf1<font color="#000080">));
         </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>buf1<font color="#000080">&lt;&gt;</font><font color="#800000">'Connect'</font><font color="#000080">) </font><font color="#FF0000"><b>do
         begin
           </b></font>hnd1 <font color="#000080">:= </font>GetWindow<font color="#000080">(</font>hnd1<font color="#000080">,</font>GW_hwndnext<font color="#000080">);
           </font>getwindowtext<font color="#000080">(</font>hnd1<font color="#000080">,</font>buf1<font color="#000080">,</font>sizeof<font color="#000080">(</font>buf1<font color="#000080">));
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font>beep<font color="#000080">;
         </font>PostMessage<font color="#000080">(</font>hnd1<font color="#000080">,</font>BM_CLICK<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Finally
       </b></font>FreeMem<font color="#000080">(</font>lpStr<font color="#000080">,</font>ln<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0372.PAS">Original</a><b>]</b></p></body>
</html>
