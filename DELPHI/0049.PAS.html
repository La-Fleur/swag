<html>
<head><title> "Copy a desktop window into your program'" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">  <font color="#008000"><i>{************************************************}
  {  Copy DeskTop Demo program                     }
  {************************************************}
  {
    Here's the beginning of the resource:
    -------------------------------------------------------
    MENU_1 MENU
    BEGIN
          MENUITEM &quot;Blit_Upper_Left_Corner_of_Desktop&quot;, 101
    END
    -------------------------------------------------------
    End of Resource (Don't include lines)
  }
  </i></font><font color="#FF0000"><b>program </b></font>MyProgram<font color="#000080">;

  </font><font color="#FF0000"><b>uses </b></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>OWindows<font color="#000080">;
  </font><font color="#008000"><i>{$R BMPDESK}

  </i></font><font color="#FF0000"><b>const
    </b></font>idBlitIt <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;

  </font><font color="#FF0000"><b>type
    </b></font>TMyApplication <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TApplication<font color="#000080">)
      </font><font color="#FF0000"><b>procedure </b></font>InitMainWindow<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>type
    </b></font>PMyWindow <font color="#000080">= ^</font>TMyWindow<font color="#000080">;
    </font>TMyWindow <font color="#000080">= </font><font color="#FF0000"><b>object</b></font><font color="#000080">(</font>TWindow<font color="#000080">)
      </font><font color="#FF0000"><b>constructor </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWIndowsObject<font color="#000080">; </font>Name<font color="#000080">: </font>PChar<font color="#000080">);
      </font><font color="#FF0000"><b>destructor </b></font>Done<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>procedure </b></font>BlitIt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
        </font><font color="#FF0000"><b>virtual </b></font>Cm_First <font color="#000080">+ </font>idBlitIt<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{--------------------------------------------------}
  { TMyWindow's method implementations:              }
  {--------------------------------------------------}

  </i></font><font color="#FF0000"><b>constructor </b></font>TMyWindow<font color="#000080">.</font>Init<font color="#000080">(</font>AParent<font color="#000080">: </font>PWindowsObject<font color="#000080">; </font>Name<font color="#000080">: </font>PChar<font color="#000080">);
  </font><font color="#FF0000"><b>begin
    inherited </b></font>Init<font color="#000080">(</font>AParent<font color="#000080">, </font>Name<font color="#000080">);
    </font>Attr<font color="#000080">.</font>Menu <font color="#000080">:= </font>LoadMenu<font color="#000080">(</font>HInstance<font color="#000080">, </font><font color="#800000">'Menu_1'</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>destructor </b></font>TMyWindow<font color="#000080">.</font>Done<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    inherited </b></font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>procedure </b></font>TMyWindow<font color="#000080">.</font>BlitIt<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TMessage<font color="#000080">);
  </font><font color="#FF0000"><b>var
    </b></font>DeskDc<font color="#000080">: </font>HDC<font color="#000080">;
    </font>TempDC<font color="#000080">, </font>PaintDC<font color="#000080">: </font>HDC<font color="#000080">;
    </font>MyBitMap<font color="#000080">: </font>HBitMap<font color="#000080">;
    </font>R<font color="#000080">: </font>TRect<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>DeskDc <font color="#000080">:= </font>GetDC<font color="#000080">(</font>GetDeskTopWindow<font color="#000080">);
    </font>PaintDC <font color="#000080">:= </font>GetDC<font color="#000080">(</font>HWindow<font color="#000080">);
    </font>GetClientRect<font color="#000080">(</font>HWindow<font color="#000080">, </font>R<font color="#000080">);
    </font>BitBlt<font color="#000080">(</font>PaintDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>R<font color="#000080">.</font>right<font color="#000080">, </font>R<font color="#000080">.</font>bottom<font color="#000080">, </font>DeskDC<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,
  </font>SRCCopy<font color="#000080">);
    </font>ReleaseDC<font color="#000080">(</font>HWindow<font color="#000080">, </font>PaintDC<font color="#000080">);
    </font>ReleaseDC<font color="#000080">(</font>GetDeskTopWindow<font color="#000080">, </font>DeskDC<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{--------------------------------------------------}
  { TMyApplication's method implementations:         }
  {--------------------------------------------------}

  </i></font><font color="#FF0000"><b>procedure </b></font>TMyApplication<font color="#000080">.</font>InitMainWindow<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>MainWindow <font color="#000080">:= </font>New<font color="#000080">(</font>PMyWindow<font color="#000080">, </font>Init<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#800000">'Sample ObjectWindows
                      </font><font color="#FF0000"><b>Program</b></font><font color="#800000">'));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{--------------------------------------------------}
  { Main program:                                    }
  {--------------------------------------------------}

  </i></font><font color="#FF0000"><b>var

    </b></font>MyApp<font color="#000080">: </font>TMyApplication<font color="#000080">;

  </font><font color="#FF0000"><b>begin
    </b></font>MyApp<font color="#000080">.</font>Init<font color="#000080">(</font><font color="#800000">'MyProgram'</font><font color="#000080">);
    </font>MyApp<font color="#000080">.</font>Run<font color="#000080">;
    </font>MyApp<font color="#000080">.</font>Done<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">.




























</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0049.PAS">Original</a><b>]</b></p></body>
</html>
