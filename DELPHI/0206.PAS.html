<html>
<head><title> "Components: NewSpeedbutton" by AVONTURE CHRISTOPHE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0206.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
  DELPHI 1.0

  Two new freeware components based on TSpeedButton and TBitBtn.  The most
  improvement is the ability to put an Icon replacing the only BMP picture.

  On somes ICON,  the result  is not  very good  but in the most case, the
  result is great.


  TAVCSpeedButton:

      - PopupMenu Feature
      - Icon

  TBitBtn:

      - Icon


   Sample:
   ------

   var
      btTry: TAVCSpeedButton;

   ...

      btTry.LoadIcon (LoadIcon(hInstance, 'MAINICON'));


               &Eacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&raquo;
               &ordm;                                        &ordm;&deg;
               &ordm;          AVONTURE CHRISTOPHE           &ordm;&deg;
               &ordm;              AVC SOFTWARE              &ordm;&deg;
               &ordm;     BOULEVARD EDMOND MACHTENS 157/53   &ordm;&deg;
               &ordm;           B-1080 BRUXELLES             &ordm;&deg;
               &ordm;              BELGIQUE                  &ordm;&deg;
               &ordm;                                        &ordm;&deg;
               &Egrave;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&Iacute;&frac14;&deg;
               &deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;&deg;


}
</i></font><font color="#FF0000"><b>unit </b></font>Icobtn<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>Buttons<font color="#000080">, </font>Extctrls<font color="#000080">, </font>Menus<font color="#000080">;

</font><font color="#FF0000"><b>type

  </b></font>TAVCSpeedButton <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TSpeedButton<font color="#000080">)
  </font><font color="#FF0000"><b>private
    procedure </b></font>WM_RBUTTONDOWN <font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">); </font><font color="#FF0000"><b>message </b></font>WM_RBUTTONDOWN<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor </b></font>Create<font color="#000080">(</font>Owner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor  </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure   </b></font>LoadIcon<font color="#000080">(</font>Ico<font color="#000080">: </font>hIcon<font color="#000080">);
  </font><font color="#FF0000"><b>published
    </b></font>PopupMenu <font color="#000080">: </font>TPopupMenu<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>TAVCBitBtn <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TBitBtn<font color="#000080">)
  </font><font color="#FF0000"><b>protected
  public
    constructor </b></font>Create<font color="#000080">(</font>Owner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor  </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure   </b></font>LoadIcon<font color="#000080">(</font>Ico<font color="#000080">: </font>hIcon<font color="#000080">);
  </font><font color="#FF0000"><b>published
  end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

Uses </b></font>ShellAPI<font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TAVCBitBtn<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>Owner<font color="#000080">);
  </font>Parent <font color="#000080">:= (</font>Owner <font color="#FF0000"><b>as </b></font>TWinControl<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TAVCBitBtn<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAVCBitBtn<font color="#000080">.</font>LoadIcon<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>pic <font color="#000080">: </font>TPicture<font color="#000080">;
   </font>iico <font color="#000080">: </font>TIcon<font color="#000080">;
</font><font color="#FF0000"><b>begin

   </b></font>iico        <font color="#000080">:= </font>TIcon<font color="#000080">.</font>Create<font color="#000080">;
   </font>iico<font color="#000080">.</font>Handle <font color="#000080">:= </font>ico<font color="#000080">;
   </font>Pic         <font color="#000080">:= </font>TPicture<font color="#000080">.</font>Create<font color="#000080">;
   </font>Pic<font color="#000080">.</font>Icon    <font color="#000080">:= </font>iico<font color="#000080">;
   </font>Glyph       <font color="#000080">:= </font>TBitmap<font color="#000080">.</font>Create<font color="#000080">;
   </font>Height      <font color="#000080">:= </font>iico<font color="#000080">.</font>Height<font color="#000080">+</font><font color="#800000">8</font><font color="#000080">;

   </font><font color="#FF0000"><b>WITH </b></font>Glyph <font color="#FF0000"><b>DO
      BEGIN
         </b></font>Width  <font color="#000080">:= </font>iico<font color="#000080">.</font>Width<font color="#000080">+</font><font color="#800000">30</font><font color="#000080">;
         </font>Height <font color="#000080">:= </font>iico<font color="#000080">.</font>Height<font color="#000080">;
         </font>Canvas<font color="#000080">.</font>Draw <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Pic<font color="#000080">.</font>Icon<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>iico<font color="#000080">.</font>free<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ ******************************************************** }

</i></font><font color="#FF0000"><b>constructor </b></font>TAVCSpeedButton<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>Owner<font color="#000080">);
  </font>Parent <font color="#000080">:= (</font>Owner <font color="#FF0000"><b>as </b></font>TWinControl<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor </b></font>TAVCSpeedButton<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAVCSpeedButton<font color="#000080">.</font>LoadIcon<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>pic <font color="#000080">: </font>TPicture<font color="#000080">;
   </font>iico <font color="#000080">: </font>TIcon<font color="#000080">;
</font><font color="#FF0000"><b>begin

   </b></font>iico        <font color="#000080">:= </font>TIcon<font color="#000080">.</font>Create<font color="#000080">;
   </font>iico<font color="#000080">.</font>Handle <font color="#000080">:= </font>ico<font color="#000080">;
   </font>Pic         <font color="#000080">:= </font>TPicture<font color="#000080">.</font>Create<font color="#000080">;
   </font>Pic<font color="#000080">.</font>Icon    <font color="#000080">:= </font>iico<font color="#000080">;
   </font>Glyph       <font color="#000080">:= </font>TBitmap<font color="#000080">.</font>Create<font color="#000080">;
   </font>Height      <font color="#000080">:= </font>iico<font color="#000080">.</font>Height<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;
   </font>Width       <font color="#000080">:= </font>iico<font color="#000080">.</font>width<font color="#000080">+</font><font color="#800000">4</font><font color="#000080">;

   </font><font color="#FF0000"><b>WITH </b></font>Glyph <font color="#FF0000"><b>DO
      BEGIN
         </b></font>Width  <font color="#000080">:= </font>iico<font color="#000080">.</font>Width<font color="#000080">;
         </font>Height <font color="#000080">:= </font>iico<font color="#000080">.</font>Height<font color="#000080">;
         </font>Canvas<font color="#000080">.</font>Draw <font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>Pic<font color="#000080">.</font>Icon<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

   </font>iico<font color="#000080">.</font>free<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAVCSpeedButton<font color="#000080">.</font>WM_RBUTTONDOWN<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Where<font color="#000080">: </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>begin

   IF NOT </b></font><font color="#000080">(</font>PopupMenu <font color="#000080">= </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
         </b></font>GetCursorPos <font color="#000080">(</font>Where<font color="#000080">);
         </font><font color="#FF0000"><b>WITH </b></font>PopupMenu <font color="#FF0000"><b>DO
            BEGIN
               </b></font>PopupComponent <font color="#000080">:= </font>TComponent<font color="#000080">(</font>Self<font color="#000080">);
               </font>Popup <font color="#000080">(</font>Where<font color="#000080">.</font>X<font color="#000080">, </font>Where<font color="#000080">.</font>Y<font color="#000080">);
            </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>RegisterComponents <font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TAVCBitBtn<font color="#000080">]);
   </font>RegisterComponents <font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TAVCSpeedButton<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0206.PAS">Original</a><b>]</b></p></body>
</html>
