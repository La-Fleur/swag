<html>
<head><title> "Divide a file in to many 1440 Kb volumes" by CAMERON COLE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0323.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{The following code is off the top of my head so use with caution as it
has NO error checking in it and I have never used to for the purposes
you are describing.  You will need to reverse the code to put the files
back together when they are done.  Try this (Good Luck):

You could use DOS copy with the /b to put it back together

 copy /b file1 file2 file3 output.fil

}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>BitBtn1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>inFile<font color="#000080">,</font>outFile<font color="#000080">: </font><font color="#FF0000"><b>FILE</b></font><font color="#000080">;
   </font>CopyBuffer <font color="#000080">: </font>POINTER<font color="#000080">; </font><font color="#008000"><i>{ buffer for copying }

   </i></font>iRecsOK<font color="#000080">, </font>iRecsWr<font color="#000080">, </font>iX<font color="#000080">: </font>Integer<font color="#000080">;
   </font>sFileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>CONST
  </b></font>ChunkSize <font color="#000080">: </font>LONGINT <font color="#000080">= </font><font color="#800000">1424000</font><font color="#000080">; </font><font color="#008000"><i>{ copy in 1.44 meg chunks }

</i></font><font color="#FF0000"><b>begin

  </b></font>GETMEM <font color="#000080">(</font>CopyBuffer<font color="#000080">, </font>ChunkSize<font color="#000080">); </font><font color="#008000"><i>{ allocate the buffer }

  </i></font>sFileName <font color="#000080">:= </font><font color="#800000">'d:\demo\winsave'</font><font color="#000080">;
  </font>Assignfile<font color="#000080">(</font>inFile<font color="#000080">,</font>sFileName <font color="#000080">+ </font><font color="#800000">'.ZIP'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>inFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);

 </font>iX <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>repeat
      </b></font>AssignFile<font color="#000080">(</font>outFile<font color="#000080">,</font>sFileName <font color="#000080">+ </font>IntToStr<font color="#000080">(</font>iX<font color="#000080">) + </font><font color="#800000">'.ZIP'</font><font color="#000080">);

      </font>Rewrite<font color="#000080">(</font>outFile<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>iX<font color="#000080">);
      </font>BlockRead<font color="#000080">(</font>InFile<font color="#000080">, </font>CopyBuffer<font color="#000080">^, </font>Chunksize<font color="#000080">, </font>iRecsOK<font color="#000080">);
      </font>BlockWrite<font color="#000080">(</font>OutFile<font color="#000080">, </font>CopyBuffer<font color="#000080">^, </font>iRecsOK<font color="#000080">, </font>iRecsWr<font color="#000080">);
      </font>CloseFile<font color="#000080">(</font>outFile<font color="#000080">);
   </font><font color="#FF0000"><b>until </b></font><font color="#000080">(</font>iRecsOK <font color="#000080">&lt; </font>Chunksize<font color="#000080">);

</font>CloseFile<font color="#000080">(</font>inFile<font color="#000080">);
</font>FREEMEM <font color="#000080">(</font>CopyBuffer<font color="#000080">, </font>ChunkSize<font color="#000080">); </font><font color="#008000"><i>{ free the buffer }
</i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0323.PAS">Original</a><b>]</b></p></body>
</html>
