<html>
<head><title> "Always on Top" by TODD JACOBS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0397.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>

<font color="#008000"><i>(* Always on Top *)

{I had a hard time finding out how to ensure a form always remains on top 
of all other forms. fsAlwaysOnTop only affects the z-order within the 
current application. To ensure that it remains on top of other forms from 
other programs as well, one needs to use the Windows API.

Including the following in a form's OnCreate event will designate it as a 
topmost window.}

     </i></font><font color="#FF0000"><b>procedure </b></font>TYourForm<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
     </font><font color="#FF0000"><b>begin
          </b></font>SetWindowPos<font color="#000080">(</font>YourForm<font color="#000080">.</font>Handle<font color="#000080">,
          </font>HWND_TOPMOST<font color="#000080">,
          </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,
          </font>SWP_NOMOVE <font color="#FF0000"><b>OR
          </b></font>SWP_NOACTIVATE <font color="#FF0000"><b>OR
          </b></font>SWP_NOSIZE<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{However, you need to keep reminding Windows to restore your window to the 
top of the z-order ahead of any other topmost windows by adding the 
following to the form's OnPaint event. Otherwise, other programs that 
modify the z-order can paint over yours.}

     </i></font><font color="#FF0000"><b>procedure </b></font>TYourForm<font color="#000080">.</font>FormPaint<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
     </font><font color="#FF0000"><b>begin
          </b></font>SetZOrder<font color="#000080">(</font>True<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0397.PAS">Original</a><b>]</b></p></body>
</html>
