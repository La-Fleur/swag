<html>
<head><title> "Panel with moving Star background" by MICHAEL WILCOX</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0195.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>mjwstar<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>extctrls<font color="#000080">;

</font><font color="#008000"><i>{ TMJWstar component - version 1.00

  Copyright 1996 (c) by Michael Wilcox
  All Rights Reserved.

  Email:    mwilcox@economat.demon.co.uk
            michael@economatics.co.uk

  Address:  68 Upper Wortley Road
            Rotherham
            South Yorkshire
            S61 2AD
            U.K.

  This component:
    - is Freeware, do not pay money for it!!!
    - is used at your own risk.
    - is open to amendments - please give credit.
    - can be published or supplied on CD-ROM (only if not amended)

  Other components/applications I have created and released:

    TMJWstar          - Panel with moving stars as a background.
                        (MJWSTAR.ZIP)
                        www.delphi32.com
                        Compuserve Delphi32 Forum.

    TMJWcrt           - Simulates a DOS CRT screen.
                        (MJWCRT.ZIP)
                        www.delphi32.com
                        Compuserve Delphi32 Forum.

    MWTerm            - Terminal Emulator, Application (DOS)
                        MWTERM.ZIP
                        www.picksys.com

  Future components, email me if you are interested:

    TMJWcom32         - Win '95 Serial Comms.
                        (SORRY - NOT RELEASED YET)

    TMJWemulator      - ADDS A2/DEBUG terminal emulator parser used with TMJWcrt.
                        (SORRY - NOT RELEASED YET)

    TMJWTextScroll    - Scrolling Credits.
                        (SORRY - NOT RELEASED YET)

    TMJWdigit         - Digital Numbers 0 to 9.
                        (SORRY - NOT RELEASED YET)

  Thanks to:
    - Matthias Laschat (STARFLD.PAS)
    - Marco Cantu, &quot;Mastering Delphi&quot;
    - Dave Jewell, PC PRO magazine.
    - David P J Hill, for use of compuserve.
    - Borland &amp; TeamB (compuserve)

  Features:
    - Inherited Panel component with moving stars as a background.
    - Warps during design time.
    - Forward and Reverse Warps. (Reverse speed eg: -20)
    - Option of raised/lowered Bevels.

  Last Note:
    - Please Email me if you use this component, I would value your comments.
    - I feel it is wrong for developers to charge for components, they should be
      written to support Borland Delphi and its users - otherwise it could be a
      world of C++ and Visual Basic. It should be the completed application that
      is sold - if you must make money!!!

  Thank you... enjoy...

  Amendment History - contributions with thanks:
  	1.00		08/10/96		Michael Wilcox.
}

</i></font><font color="#FF0000"><b>type
  </b></font>TMJWStar <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TCustomPanel<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private }
    </i></font>FNumberOfStars <font color="#000080">: </font>word<font color="#000080">;
    </font>FZoom<font color="#000080">,
    </font>FSpeed     <font color="#000080">: </font>Integer<font color="#000080">;
    </font>TStarData  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">1000</font><font color="#000080">] </font><font color="#FF0000"><b>of record
                    </b></font>x<font color="#000080">, </font>y<font color="#000080">, </font>z <font color="#000080">: </font>single<font color="#000080">;
                 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FWrapStars <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>awidth<font color="#000080">,
    </font>bwidth     <font color="#000080">: </font>Integer<font color="#000080">;
    </font>FInterval  <font color="#000080">: </font>integer<font color="#000080">;
    </font>FWarp      <font color="#000080">: </font>Boolean<font color="#000080">;
    </font>Timer      <font color="#000080">: </font>TTimer<font color="#000080">;
    </font>FWarp10    <font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>GenerateStars<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>MoveStars<font color="#000080">(</font>mx<font color="#000080">, </font>my<font color="#000080">, </font>mz <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>WrapStars<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetSpeed<font color="#000080">(</font>i <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetZoomFactor<font color="#000080">(</font>i <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetNumberOfStars<font color="#000080">(</font>i <font color="#000080">: </font>word<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetInterval<font color="#000080">(</font>Value <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetWarp<font color="#000080">(</font>Onn <font color="#000080">: </font>Boolean<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>TimeHit<font color="#000080">(</font>Sender <font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public }
    </i></font><font color="#FF0000"><b>constructor </b></font>create<font color="#000080">(</font>Aowner <font color="#000080">: </font>Tcomponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>paintstars<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>paint<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>redraw<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published }
    </i></font><font color="#FF0000"><b>property </b></font>Width<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Height<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>NumberOfStars <font color="#000080">: </font>word <font color="#FF0000"><b>read </b></font>FNumberOfStars <font color="#FF0000"><b>write </b></font>SetNumberOfStars<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ZoomFactor <font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>FZoom <font color="#FF0000"><b>write </b></font>SetZoomFactor<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Speed <font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>FSpeed <font color="#FF0000"><b>write </b></font>SetSpeed<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>WarpStart <font color="#000080">: </font>boolean <font color="#FF0000"><b>read </b></font>FWarp <font color="#FF0000"><b>write </b></font>SetWarp<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>WarpInterval <font color="#000080">: </font>integer <font color="#FF0000"><b>read </b></font>FInterval <font color="#FF0000"><b>write </b></font>SetInterval<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Warp10 <font color="#000080">: </font>Boolean <font color="#FF0000"><b>read </b></font>Fwarp10 <font color="#FF0000"><b>write </b></font>Fwarp10<font color="#000080">;

    </font><font color="#FF0000"><b>property </b></font>Align<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>BevelOuter<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>BevelWidth<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>BorderStyle<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>DragCursor<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>DragMode<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Ctl3D<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Locked<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ParentShowHint<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>PopupMenu<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ShowHint<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>TabOrder<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>TabStop<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Visible<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnClick<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnDblClick<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnDragDrop<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnDragOver<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnEndDrag<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnEnter<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnExit<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseDown<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseMove<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseUp<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnResize<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const

  </b></font>a <font color="#000080">: </font>longint <font color="#000080">= </font><font color="#800000">200</font><font color="#000080">;
  </font>grays        <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">15</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>longint<font color="#000080">=(</font><font color="#800000">$ffffff</font><font color="#000080">,</font><font color="#800000">$ffffff</font><font color="#000080">,</font><font color="#800000">$ffffff</font><font color="#000080">,</font><font color="#800000">$ffffff</font><font color="#000080">,
                                          </font><font color="#800000">$eeeeee</font><font color="#000080">,</font><font color="#800000">$dddddd</font><font color="#000080">,</font><font color="#800000">$cccccc</font><font color="#000080">,</font><font color="#800000">$bbbbbb</font><font color="#000080">,
                                          </font><font color="#800000">$aaaaaa</font><font color="#000080">,</font><font color="#800000">$999999</font><font color="#000080">,</font><font color="#800000">$888888</font><font color="#000080">,</font><font color="#800000">$777777</font><font color="#000080">,
                                          </font><font color="#800000">$555555</font><font color="#000080">,</font><font color="#800000">$333333</font><font color="#000080">,</font><font color="#800000">$111111</font><font color="#000080">,</font><font color="#800000">$000000</font><font color="#000080">);

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation


</b></font><font color="#008000"><i>{Create Method}
</i></font><font color="#FF0000"><b>constructor </b></font>TMJWstar<font color="#000080">.</font>Create<font color="#000080">(</font>Aowner <font color="#000080">: </font>Tcomponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>create<font color="#000080">(</font>Aowner<font color="#000080">);
  </font>width <font color="#000080">:= </font><font color="#800000">300</font><font color="#000080">;
  </font>height <font color="#000080">:= </font><font color="#800000">200</font><font color="#000080">;
  </font>FNumberOfStars <font color="#000080">:= </font><font color="#800000">200</font><font color="#000080">;
  </font>FZoom <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
  </font>FSpeed <font color="#000080">:= </font><font color="#800000">20</font><font color="#000080">;
  </font>color <font color="#000080">:= </font>clblack<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>screen<font color="#000080">.</font>width <font color="#000080">&gt; </font><font color="#800000">2000 </font><font color="#FF0000"><b>then </b></font>awidth <font color="#000080">:= </font>screen<font color="#000080">.</font>width<font color="#000080">*</font><font color="#800000">2 </font><font color="#FF0000"><b>else </b></font>awidth <font color="#000080">:= </font><font color="#800000">2000</font><font color="#000080">;
  </font>bwidth <font color="#000080">:= </font>awidth <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
  </font>GenerateStars<font color="#000080">;
  </font>FInterval <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>FWarp <font color="#000080">:= </font>false<font color="#000080">;
  </font>FWarp10 <font color="#000080">:= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Destroy Method}
</i></font><font color="#FF0000"><b>destructor </b></font>TMJWstar<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Generate Star Data}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>GenerateStars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>FNumberOfStars <font color="#FF0000"><b>do
     with </b></font>TStarData<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
     begin
         </b></font>x<font color="#000080">:=</font>integer<font color="#000080">(</font>random<font color="#000080">(</font>awidth<font color="#000080">))-</font><font color="#800000">1000</font><font color="#000080">;
         </font>y<font color="#000080">:=</font>integer<font color="#000080">(</font>random<font color="#000080">(</font>awidth<font color="#000080">))-</font>bwidth<font color="#000080">;
         </font>z<font color="#000080">:=</font>integer<font color="#000080">(</font>random<font color="#000080">(</font>awidth<font color="#000080">));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Wrap Stars}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>WrapStars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
    for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>FNumberOfStars <font color="#FF0000"><b>do
    with </b></font>TStarData<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      while </b></font>x <font color="#000080">&lt; -</font>bwidth <font color="#FF0000"><b>do </b></font>x <font color="#000080">:= </font>x <font color="#000080">+ </font>awidth<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>x <font color="#000080">&gt;  </font>bwidth <font color="#FF0000"><b>do </b></font>x <font color="#000080">:= </font>x <font color="#000080">- </font>awidth<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>y <font color="#000080">&lt; -</font>bwidth <font color="#FF0000"><b>do </b></font>y <font color="#000080">:= </font>y <font color="#000080">+ </font>awidth<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>y <font color="#000080">&gt;  </font>bwidth <font color="#FF0000"><b>do </b></font>y <font color="#000080">:= </font>y <font color="#000080">- </font>awidth<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>z <font color="#000080">&lt;= </font><font color="#800000">0      </font><font color="#FF0000"><b>do </b></font>z <font color="#000080">:= </font>z <font color="#000080">+ </font>awidth<font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font>z <font color="#000080">&gt;  </font>awidth <font color="#FF0000"><b>do </b></font>z <font color="#000080">:= </font>z <font color="#000080">- </font>awidth<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FWrapStars <font color="#000080">:= </font>false<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Move Stars}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>MoveStars<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>FNumberOfStars <font color="#FF0000"><b>do
     with </b></font>TStarData<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
     begin
          </b></font>x <font color="#000080">:= </font>x <font color="#000080">+ </font>mx<font color="#000080">;
          </font>y <font color="#000080">:= </font>y <font color="#000080">+ </font>my<font color="#000080">;
          </font>z <font color="#000080">:= </font>z <font color="#000080">+ </font>mz<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>FWrapStars <font color="#000080">:= </font>true<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Set Speed}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>SetSpeed<font color="#000080">(</font>i <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	FSpeed <font color="#000080">:= </font>i<font color="#000080">;
  </font>redraw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Set Zoom Factor}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>SetZoomFactor<font color="#000080">(</font>i <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	FZoom <font color="#000080">:= </font>i<font color="#000080">;
  </font>redraw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Set Number of Stars}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>SetNumberOfStars<font color="#000080">(</font>i <font color="#000080">: </font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font><font color="#800000">1000</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>i <font color="#000080">:= </font><font color="#800000">1000</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>i <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">)    </font><font color="#FF0000"><b>then </b></font>i <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
</font>	FNumberOfStars <font color="#000080">:= </font>i<font color="#000080">;
  </font>GenerateStars<font color="#000080">;
  </font>redraw<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Timer Interval}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>SetInterval<font color="#000080">(</font>Value <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Value <font color="#000080">&lt;&gt; </font>FInterval <font color="#FF0000"><b>then
  begin
  </b></font>Timer<font color="#000080">.</font>Free<font color="#000080">;
  </font>Timer <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>FWarp <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Value <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
    </b></font>Timer <font color="#000080">:= </font>TTimer<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
    </font>Timer<font color="#000080">.</font>Interval <font color="#000080">:= </font>Value<font color="#000080">;
    </font>Timer<font color="#000080">.</font>OnTimer <font color="#000080">:= </font>TimeHit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FInterval <font color="#000080">:= </font>Value<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Star timer to move stars}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>SetWarp<font color="#000080">(</font>Onn <font color="#000080">: </font>boolean<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Onn <font color="#000080">&lt;&gt; </font>FWarp <font color="#FF0000"><b>then
  begin
  </b></font>FWarp <font color="#000080">:= </font>Onn<font color="#000080">;
  </font><font color="#FF0000"><b>if not </b></font>Onn <font color="#FF0000"><b>then
    begin
    </b></font>Timer<font color="#000080">.</font>Free<font color="#000080">;
    </font>Timer <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end
  else if </b></font>FInterval <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
    </b></font>Timer <font color="#000080">:= </font>TTimer<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
    </font>Timer<font color="#000080">.</font>Interval <font color="#000080">:= </font>FInterval<font color="#000080">;
    </font>Timer<font color="#000080">.</font>OnTimer <font color="#000080">:= </font>TimeHit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Paint Stars}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>paintstars<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
  </font>rx<font color="#000080">, </font>ry <font color="#000080">: </font>integer<font color="#000080">;
  </font>xmid<font color="#000080">, </font>ymid <font color="#000080">: </font>integer<font color="#000080">;
  </font>azoom <font color="#000080">: </font>single<font color="#000080">;
  </font>Rect<font color="#000080">: </font>TRect<font color="#000080">;
  </font>TopColor<font color="#000080">, </font>BottomColor<font color="#000080">, </font>clr<font color="#000080">: </font>TColor<font color="#000080">;
</font><font color="#FF0000"><b>begin
     if </b></font><font color="#000080">(</font>csDesigning <font color="#FF0000"><b>in </b></font>ComponentState<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Fwarp <font color="#000080">= </font>false<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
</b></font>       	canvas<font color="#000080">.</font>brush<font color="#000080">.</font>color <font color="#000080">:= </font>clblack<font color="#000080">;
        </font>canvas<font color="#000080">.</font>rectangle<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>width<font color="#000080">,</font>height<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>if </b></font>FWrapStars <font color="#FF0000"><b>then </b></font>WrapStars<font color="#000080">;
     </font>azoom <font color="#000080">:= </font>FZoom<font color="#000080">/</font><font color="#800000">100</font><font color="#000080">;

     </font>xmid <font color="#000080">:= </font>width <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
     </font>ymid <font color="#000080">:= </font>height <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;

     </font><font color="#008000"><i>{Draw Background Stars}
</i></font>	   <font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>FNumberOfStars <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>do
     with </b></font>TStarData<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
     begin
</b></font>		      rx<font color="#000080">:=</font>round<font color="#000080">(</font>xmid<font color="#000080">+(</font>a<font color="#000080">*</font>x<font color="#000080">/</font><font color="#800000">300</font><font color="#000080">)* </font>azoom<font color="#000080">);
          </font>ry<font color="#000080">:=</font>round<font color="#000080">(</font>ymid<font color="#000080">+(</font>a<font color="#000080">*</font>y<font color="#000080">/</font><font color="#800000">500</font><font color="#000080">)* </font>azoom<font color="#000080">);
          </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ry <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>top<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
             </b></font><font color="#000080">(</font>ry <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Bottom<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
             </b></font><font color="#000080">(</font>rx <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>Left<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
             </b></font><font color="#000080">(</font>rx <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Right<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
</b></font>    	    canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">] := </font>clWhite<font color="#000080">;
</font>  	 <font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= (</font>FNumberOfStars <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>FNumberOfStars <font color="#FF0000"><b>do
     with </b></font>TStarData<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>do
     begin
          if </b></font>z <font color="#000080">&gt; </font><font color="#800000">0  </font><font color="#FF0000"><b>then
          begin
               if </b></font>Fwarp10 <font color="#000080">= </font>true <font color="#FF0000"><b>then </b></font>clr <font color="#000080">:= </font>grays<font color="#000080">[</font>random<font color="#000080">(</font><font color="#800000">15</font><font color="#000080">)]
                </font><font color="#FF0000"><b>else </b></font>clr <font color="#000080">:= </font>color<font color="#000080">;
               </font><font color="#008000"><i>{Remove Small Star}
               </i></font>rx <font color="#000080">:= </font>round<font color="#000080">(</font>xmid<font color="#000080">+(</font>a<font color="#000080">*</font>x<font color="#000080">/</font>z<font color="#000080">)* </font>azoom<font color="#000080">);
               </font>ry <font color="#000080">:= </font>round<font color="#000080">(</font>ymid<font color="#000080">+(</font>a<font color="#000080">*</font>y<font color="#000080">/</font>z<font color="#000080">)* </font>azoom<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ry <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>top<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>ry <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Bottom<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>rx <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>Left<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>rx <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Right<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
               </b></font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">] := </font>clr<font color="#000080">;
               </font><font color="#FF0000"><b>if </b></font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">) &lt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then
               begin
                    </b></font><font color="#008000"><i>{Remove Large Star}
                  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ry <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>top<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>ry <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Bottom<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>rx <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>Left<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>rx <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Right<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
                  begin
                    </b></font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>clr<font color="#000080">;
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] := </font>clr<font color="#000080">;
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>ry<font color="#000080">] := </font>clr<font color="#000080">;
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>ry<font color="#000080">] := </font>clr<font color="#000080">;
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

          </font>x <font color="#000080">:= </font>x <font color="#000080">+ </font><font color="#800000">0</font><font color="#000080">;
          </font>y <font color="#000080">:= </font>y <font color="#000080">+ </font><font color="#800000">0</font><font color="#000080">;
          </font>z <font color="#000080">:= </font>z <font color="#000080">+ (-</font>FSpeed<font color="#000080">);
          </font>FWrapStars<font color="#000080">:=</font>true<font color="#000080">;

          </font><font color="#FF0000"><b>if </b></font>z <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
          begin
               </b></font><font color="#008000"><i>{Draw Small Star}
               </i></font>rx <font color="#000080">:= </font>round<font color="#000080">(</font>xmid<font color="#000080">+(</font>a<font color="#000080">*</font>x<font color="#000080">/</font>z<font color="#000080">)* </font>azoom<font color="#000080">);
               </font>ry <font color="#000080">:= </font>round<font color="#000080">(</font>ymid<font color="#000080">+(</font>a<font color="#000080">*</font>y<font color="#000080">/</font>z<font color="#000080">)* </font>azoom<font color="#000080">);
               </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ry <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>top<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>ry <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Bottom<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>rx <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>Left<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                  </b></font><font color="#000080">(</font>rx <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Right<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
               </b></font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">] := </font>grays<font color="#000080">[</font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">)];
               </font><font color="#FF0000"><b>if </b></font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">) &lt; </font><font color="#800000">7 </font><font color="#FF0000"><b>then
               begin
                    </b></font><font color="#008000"><i>{Draw Large Star}
                  </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ry <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>top<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>ry <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Bottom<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>rx <font color="#000080">&gt; (</font>ClientRect<font color="#000080">.</font>Left<font color="#000080">+</font>BevelWidth<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>and
                     </b></font><font color="#000080">(</font>rx <font color="#000080">&lt; (</font>ClientRect<font color="#000080">.</font>Right<font color="#000080">-</font>BevelWidth<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
                  begin
                    </b></font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] := </font>grays<font color="#000080">[</font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">)];
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">,</font>ry<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] := </font>grays<font color="#000080">[</font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">)];
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>ry<font color="#000080">] := </font>grays<font color="#000080">[</font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">)];
                    </font>canvas<font color="#000080">.</font>pixels<font color="#000080">[</font>rx<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">,</font>ry<font color="#000080">] := </font>grays<font color="#000080">[</font>round<font color="#000080">(</font>z<font color="#000080">*</font><font color="#800000">15</font><font color="#000080">/</font>awidth<font color="#000080">)];
                  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
               </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{Display Bevel}
  </i></font>Rect <font color="#000080">:= </font>GetClientRect<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>BevelOuter <font color="#000080">&lt;&gt; </font>bvNone <font color="#FF0000"><b>then
  begin
    </b></font>TopColor <font color="#000080">:= </font>clBtnHighlight<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>BevelOuter <font color="#000080">= </font>bvLowered <font color="#FF0000"><b>then </b></font>TopColor <font color="#000080">:= </font>clBtnShadow<font color="#000080">;
    </font>BottomColor <font color="#000080">:= </font>clBtnShadow<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>BevelOuter <font color="#000080">= </font>bvLowered <font color="#FF0000"><b>then </b></font>BottomColor <font color="#000080">:= </font>clBtnHighlight<font color="#000080">;
    </font>Frame3D<font color="#000080">(</font>Canvas<font color="#000080">, </font>Rect<font color="#000080">, </font>TopColor<font color="#000080">, </font>BottomColor<font color="#000080">, </font>BevelWidth<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{paint}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>paint<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>	canvas<font color="#000080">.</font>brush<font color="#000080">.</font>color <font color="#000080">:= </font>clblack<font color="#000080">;
  </font>canvas<font color="#000080">.</font>rectangle<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>width<font color="#000080">,</font>height<font color="#000080">);
  </font>paintstars<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Redraw}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>redraw<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>paint<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Respond to timer by calling Paint method}
</i></font><font color="#FF0000"><b>procedure </b></font>TMJWstar<font color="#000080">.</font>TimeHit<font color="#000080">(</font>Sender <font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>	<font color="#FF0000"><b>if </b></font>FWarp <font color="#FF0000"><b>then
  begin
</b></font>  	paintstars<font color="#000080">;
  </font><font color="#FF0000"><b>end else
  begin
</b></font>	  Timer<font color="#000080">.</font>Free<font color="#000080">;
    </font>Timer <font color="#000080">:= </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Mick'</font><font color="#000080">, [</font>TMJWstar<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0195.PAS">Original</a><b>]</b></p></body>
</html>
