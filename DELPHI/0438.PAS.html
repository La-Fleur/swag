<html>
<head><title> "Change the wallpaper programmatically?" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0438.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Solution <font color="#800000">1
</font>The following code comes from Loyds Help <font color="#FF0000"><b>File </b></font><font color="#000080">(</font>it can be found <font color="#FF0000"><b>on
</b></font>most delphi web pages<font color="#000080">). </font>I haven<font color="#800000">'t tried it but I will use it in one
</font><font color="#FF0000"><b>of </b></font>my apps <font color="#FF0000"><b>as </b></font>soon <font color="#FF0000"><b>as </b></font>I get the bitmap from the client<font color="#000080">. </font>let me know
<font color="#FF0000"><b>if </b></font>it works <font color="#FF0000"><b>for </b></font>you<font color="#000080">.


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font><font color="#FF0000"><b>procedure </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>FormPaint<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;
  </font>Bitmap<font color="#000080">: </font>TBitmap<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>Bitmap <font color="#000080">:= </font>TBitmap<font color="#000080">.</font>Create<font color="#000080">;
  </font>Bitmap<font color="#000080">.</font>LoadFromFile<font color="#000080">(</font><font color="#800000">'C:\WINDOWS\cars.BMP'</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormPaint<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>X<font color="#000080">, </font>Y<font color="#000080">, </font>W<font color="#000080">, </font>H<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Bitmap <font color="#FF0000"><b>do begin
    </b></font>W <font color="#000080">:= </font>Width<font color="#000080">;
    </font>H <font color="#000080">:= </font>Height<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Y <font color="#000080">&lt; </font>Height <font color="#FF0000"><b>do begin
    </b></font>X <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font>X <font color="#000080">&lt; </font>Width <font color="#FF0000"><b>do begin
      </b></font>Canvas<font color="#000080">.</font>Draw<font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">, </font>Bitmap<font color="#000080">);
      </font>Inc<font color="#000080">(</font>X<font color="#000080">, </font>W<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>Y<font color="#000080">, </font>H<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

--------------------------------------------------------------------------------

</font>Solution <font color="#800000">2 
</font>From<font color="#000080">: &quot;</font>Dirk Faber <font color="#000080">&quot; &lt;</font>d<font color="#000080">.</font>j<font color="#000080">.</font>faber<font color="#000080">@</font>student<font color="#000080">.</font>utwente<font color="#000080">.</font>nl<font color="#000080">&gt;

</font>Rob Wilson <font color="#000080">&lt;</font>wilson<font color="#000080">@</font>pelops<font color="#000080">.</font>compd<font color="#000080">.</font>com<font color="#000080">&gt; </font>wrote
<font color="#000080">&gt; </font>Does anyone know how I can change the wallpaper at runtime using a
<font color="#000080">&gt; </font>filename that I specifiy<font color="#000080">?

--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>procedure </b></font>ChangeWallpaper<font color="#000080">(</font>bitmap<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);       </font><font color="#008000"><i>{bitmap contains filename: *.bmp}

</i></font><font color="#FF0000"><b>var </b></font>pBitmap <font color="#000080">: </font>pchar<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>bitmap<font color="#000080">:=</font>bitmap<font color="#000080">+</font><font color="#800000">#0</font><font color="#000080">;
 </font>pBitmap<font color="#000080">:=@</font>bitmap<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
 </font>SystemParametersInfo<font color="#000080">(</font>SPI_SETDESKWALLPAPER<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>pBitmap<font color="#000080">, </font>SPIF_UPDATEINIFILE<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------

&gt; </font>Also<font color="#000080">, </font><font color="#FF0000"><b>is </b></font>there a way <font color="#FF0000"><b>of </b></font>saving it <font color="#FF0000"><b>to </b></font>the INI <font color="#FF0000"><b>file for </b></font>next session<font color="#000080">?
</font>add inifiles <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>uses </b></font>list<font color="#000080">. 
</font>create an inifile <font color="#FF0000"><b>with </b></font>a texteditor like this<font color="#000080">:
--------------------------------------------------------------------------------
 
[</font>LastUsedBitmap<font color="#000080">]
</font>LUBitmap<font color="#000080">= </font>c<font color="#000080">:\</font>mybitmap<font color="#000080">.</font>bmp

<font color="#000080">--------------------------------------------------------------------------------

</font>use a <font color="#FF0000"><b>procedure </b></font>like this<font color="#000080">: (</font>supposed the inifile <font color="#FF0000"><b>is </b></font>like above<font color="#000080">, </font><font color="#FF0000"><b>and is </b></font>named c<font color="#000080">:\</font>Bitmap<font color="#000080">.</font>ini<font color="#000080">)
--------------------------------------------------------------------------------
 
</font><font color="#FF0000"><b>procedure </b></font>WriteToIniFile<font color="#000080">(</font>bitmap <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>MyIniFile <font color="#000080">: </font>TInifile<font color="#000080">;

</font><font color="#FF0000"><b>begin
 </b></font>MyIniFile <font color="#000080">:= </font>Tinifile<font color="#000080">.</font>Create<font color="#000080">( </font><font color="#800000">'c:\Bitmap.ini' </font><font color="#000080">);
 </font>MyIniFile<font color="#000080">.</font>WriteString<font color="#000080">( </font><font color="#800000">'LastUsedBitmap'</font><font color="#000080">, </font><font color="#800000">'LUBitmap'</font><font color="#000080">, </font>bitmap<font color="#000080">);
 </font>MyIniFile<font color="#000080">.</font>Free<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ReadFromIniFile<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>bitmap<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);

</font><font color="#FF0000"><b>var </b></font>MyIniFile <font color="#000080">: </font>TInifile<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>MyIniFile <font color="#000080">:= </font>Tinifile<font color="#000080">.</font>Create<font color="#000080">( </font><font color="#800000">'c:\Bitmap.ini' </font><font color="#000080">);
  </font>bitmap<font color="#000080">:= </font>MyIniFile<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'LastUsedBitmap'</font><font color="#000080">, </font><font color="#800000">'LUBitmap'</font><font color="#000080">);
  </font>MyIniFile<font color="#000080">.</font>Free<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0438.PAS">Original</a><b>]</b></p></body>
</html>
