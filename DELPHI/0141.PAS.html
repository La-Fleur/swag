<html>
<head><title> "Re: Delphi DDE Link with WP Win 6" by RUSSELL BELDING</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0141.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt;: : DDE must be used for my task as WPWIN6 does not support OLE automation.
&gt;
&gt;
&gt;        How can I call the Word Processor to print a DOC or mail merge?
&gt;
&gt;Dennis

Below is some sample code starting WPerfect and establishing a DDE link with it.
For talking to WinWord I use an OLE link. WordPerfect 6.x does not support OLE automation, hence
the need to revert to a DDE link to control Word Perfect.
}

</i></font><font color="#FF0000"><b>procedure </b></font>TFormCases<font color="#000080">.</font>CreateWordPerfect<font color="#000080">(</font>MyDocName <font color="#000080">: </font>String13<font color="#000080">; </font>Path <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>tme <font color="#000080">: </font>TModuleEntry<font color="#000080">; </font>h <font color="#000080">: </font>Word<font color="#000080">; </font>B <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
 with </b></font>DDEClientConv1 <font color="#FF0000"><b>do  begin
  </b></font>ServiceApplication <font color="#000080">:= </font>GWPPath<font color="#000080">; </font><font color="#008000"><i>{ Word Perfect path location as a string }
   </i></font>tme<font color="#000080">.</font>dwSize <font color="#000080">:= </font>sizeof<font color="#000080">(</font>TModuleEntry<font color="#000080">);
   </font>h <font color="#000080">:= </font>ModuleFindName<font color="#000080">(@</font>tme<font color="#000080">,</font><font color="#800000">'WPWIN60'</font><font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>h<font color="#000080">&lt;=</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
    </b></font>SayActivity<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>txtWLIS<font color="#000080">,</font>txtStartWP<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">); </font><font color="#008000"><i>{splash message screen }
    </i></font>SetLink<font color="#000080">(</font><font color="#800000">'WPWIN60_Macros'</font><font color="#000080">, </font><font color="#800000">'Commands'</font><font color="#000080">);
    </font>B<font color="#000080">:=</font>OpenLink<font color="#000080">;
    </font>HideActivity<font color="#000080">; </font><font color="#008000"><i>{ hide slplash message}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ h &lt;=0 }
   </i></font>B<font color="#000080">:= </font>SetLink<font color="#000080">(</font><font color="#800000">'WPWIN60_Macros'</font><font color="#000080">, </font><font color="#800000">'Commands'</font><font color="#000080">);
   </font>B<font color="#000080">:=</font>OpenLink<font color="#000080">;
   </font><font color="#FF0000"><b>if  not </b></font>B <font color="#FF0000"><b>then </b></font>ShowMessage<font color="#000080">(</font><font color="#800000">'WordPerfect DDE Link failed'</font><font color="#000080">);

   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'Type(&quot;Normally WinLaw would create '</font><font color="#000080">+</font>Path<font color="#000080">+</font><font color="#800000">' at this point.&quot;)'</font><font color="#000080">);
   </font>B<font color="#000080">:= </font>ExecuteMacro<font color="#000080">(@</font>CStr<font color="#000080">,</font>False<font color="#000080">);
   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'HardReturn()'</font><font color="#000080">);
   </font>ExecuteMacro<font color="#000080">(@</font>CStr<font color="#000080">,</font>False<font color="#000080">);
   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'Type(&quot;For now it demonstates controlling Word Perfect.&quot;)'</font><font color="#000080">);
   </font>B<font color="#000080">:= </font>ExecuteMacro<font color="#000080">(@</font>CStr<font color="#000080">,</font>False<font color="#000080">);
   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'HardReturn()'</font><font color="#000080">);
   </font>B<font color="#000080">:= </font>ExecuteMacro<font color="#000080">(@</font>CStr<font color="#000080">,</font>False<font color="#000080">);
   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'HardReturn()'</font><font color="#000080">);
   </font>ExecuteMacro<font color="#000080">(@</font>CStr<font color="#000080">,</font>False<font color="#000080">);
   </font>StrPCopy<font color="#000080">(@</font>Cstr<font color="#000080">,</font><font color="#800000">'AppActivate(&quot;WordPerfect&quot;)'</font><font color="#000080">);
   </font>B<font color="#000080">:= </font>ExecuteMacro<font color="#000080">(@</font>Cstr<font color="#000080">,</font>False<font color="#000080">);
   </font><font color="#008000"><i>{if (not B) then ShowMessage('Activation WP failed');}
   </i></font>CloseLink<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0141.PAS">Original</a><b>]</b></p></body>
</html>
