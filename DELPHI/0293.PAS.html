<html>
<head><title> "Getting the date and time stamp of a dat" by JOHN RUTHERFORD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0293.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{==============================================================================}
</i></font><font color="#FF0000"><b>function </b></font>FileDateTime<font color="#000080">( </font><font color="#FF0000"><b>const </b></font>cFileName<font color="#000080">:</font><font color="#FF0000"><b>string </b></font><font color="#000080">; </font>cDateTime<font color="#000080">: </font>char <font color="#000080">) : </font><font color="#FF0000"><b>string </b></font><font color="#000080">;
</font><font color="#008000"><i>{ accepts filename in a string and the cDateTime case/type to return }
</i></font><font color="#FF0000"><b>var
   </b></font>iFile <font color="#000080">: </font>integer   <font color="#000080">;  </font><font color="#008000"><i>{handle to open file}
   </i></font>fBuff <font color="#000080">: </font>TOfStruct <font color="#000080">;  </font><font color="#008000"><i>{Win API structure for file information}
   </i></font>cDate <font color="#000080">: </font><font color="#FF0000"><b>string    </b></font><font color="#000080">;  </font><font color="#008000"><i>{actually holds the file Date and Time}
   </i></font>tDate <font color="#000080">: </font>tDateTime <font color="#000080">;  </font><font color="#008000"><i>{Delphi type actually a double}
   </i></font>iTime <font color="#000080">: </font>longInt   <font color="#000080">;
   </font>aName <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">99</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">; </font><font color="#008000"><i>{easy pre-sized pChar type }
</i></font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{help to find actual path}
     </i></font><font color="#FF0000"><b>if </b></font>cFileName <font color="#000080">= </font><font color="#800000">'Children.dbf' </font><font color="#FF0000"><b>then
        </b></font>strPCopy<font color="#000080">( </font>aName<font color="#000080">, </font><font color="#800000">'\aDelph16\Stella\Data\' </font><font color="#000080">+ </font>cFileName <font color="#000080">)
     </font><font color="#FF0000"><b>else
        </b></font>strPCopy<font color="#000080">( </font>aName<font color="#000080">, </font>cFileName <font color="#000080">) ;

     </font><font color="#FF0000"><b>try
        </b></font>iFile <font color="#000080">:= </font>_lopen<font color="#000080">( </font>aName<font color="#000080">, </font>OF_SHARE_COMPAT <font color="#000080">);
        </font>iTime <font color="#000080">:=  </font>FileGetDate<font color="#000080">(</font>iFile<font color="#000080">);
        </font>tDate <font color="#000080">:=  </font>FileDateToDateTime<font color="#000080">( </font>iTime<font color="#000080">);
        </font>cDate <font color="#000080">:=  </font>DateTimeToStr<font color="#000080">( </font>tDate <font color="#000080">);
     </font><font color="#008000"><i>{  showMessage( 'Date/time ' +cTime );  }

        </i></font><font color="#FF0000"><b>case </b></font>cDateTime <font color="#FF0000"><b>OF      </b></font><font color="#008000"><i>{Date, Time, Both}
          </i></font><font color="#800000">'D' </font><font color="#000080">: </font>FileDateTime <font color="#000080">:= </font>copy<font color="#000080">(</font>cDate<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>pos<font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">, </font>cDate<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">) ;
          </font><font color="#800000">'T' </font><font color="#000080">: </font>FileDateTime <font color="#000080">:= </font>copy<font color="#000080">(</font>cDate<font color="#000080">, </font>length<font color="#000080">(</font>cDate<font color="#000080">)-</font><font color="#800000">8</font><font color="#000080">, </font>length<font color="#000080">(</font>cDate<font color="#000080">)) ;
          </font><font color="#800000">'B' </font><font color="#000080">: </font>FileDateTime <font color="#000080">:= </font>cDate <font color="#000080">;
        </font><font color="#FF0000"><b>end </b></font><font color="#000080">;

     </font>_lclose<font color="#000080">(</font>iFile<font color="#000080">) ;
     </font><font color="#FF0000"><b>except
           </b></font>showMessage<font color="#000080">(</font><font color="#800000">'FileDateTime FAILED'</font><font color="#000080">);
     </font><font color="#FF0000"><b>end
end </b></font><font color="#000080">;
</font><font color="#008000"><i>{==============================================================================}

</i></font>john<font color="#000080">.</font>rutherford<font color="#000080">@</font>emarkt<font color="#000080">.</font>com

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0293.PAS">Original</a><b>]</b></p></body>
</html>
