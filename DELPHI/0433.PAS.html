<html>
<head><title> "Shell_NotifyIcon in DELPHI" by NEIL CLAYTON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0433.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From<font color="#000080">: &quot;</font>Neil Clayton<font color="#000080">&quot; &lt;</font><font color="#800000">100101.602</font><font color="#000080">@</font>compuserve<font color="#000080">.</font>com<font color="#000080">&gt;

</font>Rainer Perl <font color="#000080">&lt;</font>Rainer<font color="#000080">.</font>Perl<font color="#000080">@</font>iddc<font color="#000080">.</font>via<font color="#000080">.</font>at<font color="#000080">&gt; </font>wrote <font color="#FF0000"><b>in </b></font>article

<font color="#000080">&gt; </font>I have a question <font color="#FF0000"><b>to </b></font>the Shell_NotifyIcon <font color="#FF0000"><b>function</b></font><font color="#000080">:
&gt; </font>I can add an icon <font color="#FF0000"><b>to </b></font>the taskbar
<font color="#000080">&gt; </font>I can modify an icon
<font color="#000080">&gt; </font>I can delete an icon<font color="#000080">.
&gt; </font>What I can<font color="#800000">'t do: I can'</font>t receive Messages from the Icon<font color="#000080">!!
</font><font color="#FF0000"><b>To </b></font>receive messages you must add the NIF_MESSAGE flag <font color="#FF0000"><b>to </b></font>your notify structure <font color="#FF0000"><b>and </b></font>tell it what <font color="#FF0000"><b>message to </b></font>send <font color="#FF0000"><b>and to </b></font>which window<font color="#000080">. </font>This <font color="#FF0000"><b>is </b></font>the code that I use<font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>procedure </b></font>TMainForm<font color="#000080">.</font>UpdateTaskBar<font color="#000080">;            </font><font color="#008000"><i>// update the win95 taskbar icon area
</i></font><font color="#FF0000"><b>var
  </b></font>NotifyData<font color="#000080">: </font>TNotifyIconData<font color="#000080">;

</font><font color="#FF0000"><b>begin
  With </b></font>NotifyData <font color="#FF0000"><b>do                                            </b></font><font color="#008000"><i>// set up the data structure
  </i></font><font color="#FF0000"><b>begin
    </b></font>cbSize             <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>TNotifyIconData<font color="#000080">);
    </font>Wnd                <font color="#000080">:= </font>MyForm<font color="#000080">.</font>Handle<font color="#000080">;
    </font>uID                  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>uFlags             <font color="#000080">:= </font>NIF_ICON <font color="#FF0000"><b>or </b></font>NIF_MESSAGE <font color="#FF0000"><b>or </b></font>NIF_TIP<font color="#000080">;   </font><font color="#008000"><i>// ... the aspects to modify ...
    </i></font>uCallbackMessage <font color="#000080">:= </font>WM_MY_MESSAGE<font color="#000080">;                         </font><font color="#008000"><i>// ... the message to send back to us ...
    </i></font>hIcon              <font color="#000080">:= </font>hMyIcon<font color="#000080">;
    </font>szTip              <font color="#000080">:= </font><font color="#800000">'Tool Tip To Display'</font><font color="#000080">;           </font><font color="#008000"><i>// ... and the tool tip
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Shell_NotifyIcon<font color="#000080">(</font>dwMessage<font color="#000080">, @</font>NotifyData<font color="#000080">);                     </font><font color="#008000"><i>// now do the update
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------

</font>WM_MYMESSAGE <font color="#FF0000"><b>is </b></font>a user defined <font color="#FF0000"><b>message</b></font><font color="#000080">. </font>Usually defined <font color="#FF0000"><b>as</b></font><font color="#000080">:


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>const
  </b></font>WM_MYMESSAGE <font color="#000080">= </font>WM_USER <font color="#000080">+ &lt;</font>some number <font color="#000080">- </font>can be zero<font color="#000080">&gt;;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0433.PAS">Original</a><b>]</b></p></body>
</html>
