<html>
<head><title> "D3 : Date Manipulation" by SHIV R. KUMAR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0389.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">I<font color="#800000">'m looking for a function that, with a date as param, would
</font>return the date <font color="#FF0000"><b>of </b></font>the last day <font color="#FF0000"><b>of </b></font>the month<font color="#000080">, </font>i<font color="#000080">.</font>e<font color="#000080">.

</font><font color="#FF0000"><b>function </b></font>TForm1<font color="#000080">.</font>LastDateOfMonth<font color="#000080">(</font>Dt <font color="#000080">: </font>TDateTime<font color="#000080">) : </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>DecodeDate<font color="#000080">(</font>Dt<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
     </font><font color="#008000"><i>{Make the date the first day of the next month}
     </i></font>Day <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
     </font>inc<font color="#000080">(</font>Month<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>Month <font color="#000080">= </font><font color="#800000">13 </font><font color="#FF0000"><b>then begin
        </b></font>Month <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
        </font>inc<font color="#000080">(</font>Year<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#008000"><i>{Covert to TDateTime and minus 1 from it to give you the last day
      of the previous month}
     </i></font>Dt <font color="#000080">:= </font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
     </font>Result <font color="#000080">:= </font>Dt <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0389.PAS">Original</a><b>]</b></p></body>
</html>
