<html>
<head><title> "Status Bar Component" by CRAIG WARD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0146.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
 Author:    Craig Ward
 Copyright: none - public domain

 Date:      20/5/96

 Version:   1.0

 Overview:  Status bar

 Notes:     The captions for each panel (stored within the wrapper component),
            can be accessed via their index. The indices are:
             [0] status panel
             [1] caps-lock panel
             [2] num-lock panel
             [3] scroll-lock panel
             [4] time panel

            The component will automatically check for the state of the caps-lock,
            num-lock, and scroll-lock keys, plus, it will also display the current
            time (all achieved through a private TTimer). Furthermore, the
            component will also automatically display any application hint, by
            setting the application's OnHint method to the custom method that
            is used by the TTimer.
*******************************************************************************}
</i></font><font color="#FF0000"><b>unit </b></font>Cwstatus<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ExtCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type

  </b></font><font color="#008000"><i>{container object for panels}
  </i></font>TStatusPanel <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TPanel<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font>FStatusPanel<font color="#000080">: </font>TPanel<font color="#000080">;            </font><font color="#008000"><i>{the comment panel}
    </i></font>FCapsPanel<font color="#000080">: </font>TPanel<font color="#000080">;              </font><font color="#008000"><i>{the caps-lock panel}
    </i></font>FNumPanel<font color="#000080">: </font>TPanel<font color="#000080">;               </font><font color="#008000"><i>{the num-lock panel}
    </i></font>FScrollPanel<font color="#000080">: </font>TPanel<font color="#000080">;            </font><font color="#008000"><i>{the scroll-lock panel}
    </i></font>FTimePanel<font color="#000080">: </font>TPanel<font color="#000080">;              </font><font color="#008000"><i>{the time panel}
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
    </i></font><font color="#FF0000"><b>constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{wrapper for component}
  </i></font>TcwStatusBar <font color="#000080">= </font><font color="#FF0000"><b>Class</b></font><font color="#000080">(</font>TWinControl<font color="#000080">)
    </font>StatusPanel<font color="#000080">: </font>TStatusPanel<font color="#000080">;
    </font>FTimer<font color="#000080">: </font>TTimer<font color="#000080">;
  </font><font color="#FF0000"><b>private
    function </b></font>GetCaption<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetCaption<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">; </font>Cap<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>mTimer<font color="#000080">(</font>sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>public
    constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Captions<font color="#000080">[</font><font color="#FF0000"><b>Index</b></font><font color="#000080">: </font>Integer<font color="#000080">]: </font><font color="#FF0000"><b>string read </b></font>GetCaption <font color="#FF0000"><b>write </b></font>SetCaption<font color="#000080">;
  </font><font color="#FF0000"><b>published
    property </b></font>Font<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ParentFont<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Align<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{***VCL Preferences************************************************************}

{constructor -
 note: panels created in reverse order}
</i></font><font color="#FF0000"><b>constructor </b></font>TStatusPanel<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
   </font>Align <font color="#000080">:= </font>alBottom<font color="#000080">;            </font><font color="#008000"><i>{default to bottom of form}

  {create time panel}
  </i></font>FTimePanel <font color="#000080">:= </font>TPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>FTimePanel <font color="#FF0000"><b>do
  begin
    </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;              </font><font color="#008000"><i>{set parent to self}
    </i></font>width <font color="#000080">:= </font><font color="#800000">65</font><font color="#000080">;
    </font>Align <font color="#000080">:= </font>alRight<font color="#000080">;            </font><font color="#008000"><i>{set alignment to right}
    </i></font>BevelOuter <font color="#000080">:= </font>bvLowered<font color="#000080">;     </font><font color="#008000"><i>{set bevel appearances}
    </i></font>BevelInner <font color="#000080">:= </font>bvLowered<font color="#000080">;
    </font>Caption <font color="#000080">:= </font><font color="#800000">'Time'</font><font color="#000080">;           </font><font color="#008000"><i>{set caption text}
    </i></font>Alignment <font color="#000080">:= </font>taLeftJustify<font color="#000080">;  </font><font color="#008000"><i>{left-justify caption}
    </i></font>ParentFont <font color="#000080">:= </font>true<font color="#000080">;          </font><font color="#008000"><i>{assume the parent's font}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{create scroll-lock panel}
  </i></font>FScrollPanel <font color="#000080">:= </font>TPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>FScrollPanel <font color="#FF0000"><b>do
  begin
    </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;              </font><font color="#008000"><i>{set parent to self}
    </i></font>width <font color="#000080">:= </font><font color="#800000">40</font><font color="#000080">;
    </font>Align <font color="#000080">:= </font>alRight<font color="#000080">;            </font><font color="#008000"><i>{set alignment to right}
    </i></font>BevelOuter <font color="#000080">:= </font>bvLowered<font color="#000080">;     </font><font color="#008000"><i>{set bevel appearances}
    </i></font>BevelInner <font color="#000080">:= </font>bvLowered<font color="#000080">;
    </font>Caption <font color="#000080">:= </font><font color="#800000">'Scroll'</font><font color="#000080">;         </font><font color="#008000"><i>{set caption text}
    </i></font>Alignment <font color="#000080">:= </font>taLeftJustify<font color="#000080">;  </font><font color="#008000"><i>{left-justify caption}
    </i></font>ParentFont <font color="#000080">:= </font>true<font color="#000080">;          </font><font color="#008000"><i>{assume the parent's font}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{create num-lock panel}
  </i></font>FNumPanel <font color="#000080">:= </font>TPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>FNumPanel <font color="#FF0000"><b>do
  begin
    </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;              </font><font color="#008000"><i>{set parent to self}
    </i></font>width <font color="#000080">:= </font><font color="#800000">40</font><font color="#000080">;
    </font>Align <font color="#000080">:= </font>alRight<font color="#000080">;            </font><font color="#008000"><i>{set alignment to right}
    </i></font>BevelOuter <font color="#000080">:= </font>bvLowered<font color="#000080">;     </font><font color="#008000"><i>{set bevel appearances}
    </i></font>BevelInner <font color="#000080">:= </font>bvLowered<font color="#000080">;
    </font>Caption <font color="#000080">:= </font><font color="#800000">'Num'</font><font color="#000080">;            </font><font color="#008000"><i>{set caption text}
    </i></font>Alignment <font color="#000080">:= </font>taLeftJustify<font color="#000080">;  </font><font color="#008000"><i>{left-justify caption}
    </i></font>ParentFont <font color="#000080">:= </font>true<font color="#000080">;          </font><font color="#008000"><i>{assume the parent's font}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{create caps-lock panel}
  </i></font>FCapsPanel <font color="#000080">:= </font>TPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>FCapsPanel <font color="#FF0000"><b>do
  begin
    </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;              </font><font color="#008000"><i>{set parent to self}
    </i></font>width <font color="#000080">:= </font><font color="#800000">40</font><font color="#000080">;
    </font>Align <font color="#000080">:= </font>alRight<font color="#000080">;            </font><font color="#008000"><i>{set alignment to right}
    </i></font>BevelOuter <font color="#000080">:= </font>bvLowered<font color="#000080">;     </font><font color="#008000"><i>{set bevel appearances}
    </i></font>BevelInner <font color="#000080">:= </font>bvLowered<font color="#000080">;
    </font>Caption <font color="#000080">:= </font><font color="#800000">'Caps'</font><font color="#000080">;           </font><font color="#008000"><i>{set caption text}
    </i></font>Alignment <font color="#000080">:= </font>taLeftJustify<font color="#000080">;  </font><font color="#008000"><i>{left-justify caption}
    </i></font>ParentFont <font color="#000080">:= </font>true<font color="#000080">;          </font><font color="#008000"><i>{assume the parent's font}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{create comment panel}
  </i></font>FStatusPanel <font color="#000080">:= </font>TPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>FStatusPanel <font color="#FF0000"><b>do
  begin
    </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;              </font><font color="#008000"><i>{set parent to self}
    </i></font>Align <font color="#000080">:= </font>alClient<font color="#000080">;           </font><font color="#008000"><i>{set alignment to client}
    </i></font>BevelOuter <font color="#000080">:= </font>bvLowered<font color="#000080">;     </font><font color="#008000"><i>{set bevel appearances}
    </i></font>BevelInner <font color="#000080">:= </font>bvLowered<font color="#000080">;
    </font>Caption <font color="#000080">:= </font><font color="#800000">'Status Panel'</font><font color="#000080">;   </font><font color="#008000"><i>{set caption text}
    </i></font>Alignment <font color="#000080">:= </font>taLeftJustify<font color="#000080">;  </font><font color="#008000"><i>{left-justify caption}
    </i></font>ParentFont <font color="#000080">:= </font>true<font color="#000080">;          </font><font color="#008000"><i>{assume the parent's font}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{constructor - for wrapper}
</i></font><font color="#FF0000"><b>constructor </b></font>TcwStatusBar<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);

   </font><font color="#008000"><i>{create status-panel}
   </i></font>Align <font color="#000080">:= </font>alBottom<font color="#000080">;                        </font><font color="#008000"><i>{default to alBottom}
   </i></font>StatusPanel <font color="#000080">:= </font>TStatusPanel<font color="#000080">.</font>Create<font color="#000080">(</font>self<font color="#000080">); </font><font color="#008000"><i>{create a TStatusPanel instance}
   </i></font><font color="#FF0000"><b>with </b></font>StatusPanel <font color="#FF0000"><b>do
   begin
     </b></font>Parent <font color="#000080">:= </font>self<font color="#000080">;                         </font><font color="#008000"><i>{set parent to self}
     </i></font>Align <font color="#000080">:= </font>alClient<font color="#000080">;                      </font><font color="#008000"><i>{set alignment to client}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>Height <font color="#000080">:= </font><font color="#800000">25</font><font color="#000080">;

   </font><font color="#008000"><i>{create TTimer}
   </i></font>FTimer <font color="#000080">:= </font>TTimer<font color="#000080">.</font>create<font color="#000080">(</font>self<font color="#000080">);
   </font><font color="#FF0000"><b>with </b></font>FTimer <font color="#FF0000"><b>do
    begin
     </b></font>OnTimer <font color="#000080">:= </font>mTimer<font color="#000080">;
     </font>interval <font color="#000080">:= </font><font color="#800000">250</font><font color="#000080">;                        </font><font color="#008000"><i>{update panels quarter of a second}
     </i></font>enabled <font color="#000080">:= </font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#008000"><i>{set application's OnHint to the custom method, used by the TTimer. This will
    force the application, when a hint is encountered, to be displayed in the
    panel.}
   </i></font>application<font color="#000080">.</font>onHint <font color="#000080">:= </font>mTimer<font color="#000080">;

   </font><font color="#008000"><i>{call timer method - this ensures that the application will open with a
    status-bar that is configured and running}
   </i></font>mTimer<font color="#000080">(</font>self<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{destructor - for wrapper}
</i></font><font color="#FF0000"><b>destructor </b></font>TcwStatusBar<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{return caption (of panel in index)}
</i></font><font color="#FF0000"><b>function </b></font>TcwStatusBar<font color="#000080">.</font>GetCaption<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>Index <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">: </font>result <font color="#000080">:= </font>StatusPanel<font color="#000080">.</font>FStatusPanel<font color="#000080">.</font>caption<font color="#000080">;
    </font><font color="#800000">1</font><font color="#000080">: </font>result <font color="#000080">:= </font>StatusPanel<font color="#000080">.</font>FCapsPanel<font color="#000080">.</font>caption<font color="#000080">;
    </font><font color="#800000">2</font><font color="#000080">: </font>result <font color="#000080">:= </font>StatusPanel<font color="#000080">.</font>FNumPanel<font color="#000080">.</font>caption<font color="#000080">;
    </font><font color="#800000">3</font><font color="#000080">: </font>result <font color="#000080">:= </font>StatusPanel<font color="#000080">.</font>FScrollPanel<font color="#000080">.</font>caption<font color="#000080">;
    </font><font color="#800000">4</font><font color="#000080">: </font>result <font color="#000080">:= </font>StatusPanel<font color="#000080">.</font>FTimePanel<font color="#000080">.</font>caption<font color="#000080">;
    </font><font color="#008000"><i>{ Show error if any other Index was entered }
    </i></font><font color="#FF0000"><b>else </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'Invalid Index Value'</font><font color="#000080">, </font>mtWarning<font color="#000080">, [</font>mbOk<font color="#000080">], </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{set caption (of panel in index)}
</i></font><font color="#FF0000"><b>procedure </b></font>TcwStatusBar<font color="#000080">.</font>SetCaption<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">; </font>Cap<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>Index <font color="#FF0000"><b>of
    </b></font><font color="#800000">0</font><font color="#000080">: </font>StatusPanel<font color="#000080">.</font>FStatusPanel<font color="#000080">.</font>Caption <font color="#000080">:= </font>cap<font color="#000080">;
    </font><font color="#800000">1</font><font color="#000080">: </font>StatusPanel<font color="#000080">.</font>FCapsPanel<font color="#000080">.</font>Caption <font color="#000080">:= </font>cap<font color="#000080">;
    </font><font color="#800000">2</font><font color="#000080">: </font>StatusPanel<font color="#000080">.</font>FNumPanel<font color="#000080">.</font>caption <font color="#000080">:= </font>cap<font color="#000080">;
    </font><font color="#800000">3</font><font color="#000080">: </font>StatusPanel<font color="#000080">.</font>FScrollPanel<font color="#000080">.</font>caption <font color="#000080">:= </font>cap<font color="#000080">;
    </font><font color="#800000">4</font><font color="#000080">: </font>StatusPanel<font color="#000080">.</font>FTimePanel<font color="#000080">.</font>caption <font color="#000080">:= </font>cap<font color="#000080">;
    </font><font color="#008000"><i>{ Show an error if any other Index was entered }
    </i></font><font color="#FF0000"><b>else </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'Invalid Index Value'</font><font color="#000080">, </font>mtWarning<font color="#000080">, [</font>mbOk<font color="#000080">], </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{register}
</i></font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'cw_apps'</font><font color="#000080">, [</font>TcwStatusBar<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{***custom routines************************************************************}

{on timer, update captions}
</i></font><font color="#FF0000"><b>procedure </b></font>TcwStatusBar<font color="#000080">.</font>mTimer<font color="#000080">(</font>sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin

 </b></font><font color="#008000"><i>{set hint}
 </i></font>Captions<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">+</font>application<font color="#000080">.</font>hint<font color="#000080">;

 </font><font color="#008000"><i>{set caps lock}
 </i></font><font color="#FF0000"><b>if </b></font>GetKeyState<font color="#000080">(</font>VK_CAPITAL<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  </b></font>Captions<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">' CAP'
 </font><font color="#FF0000"><b>else
  </b></font>Captions<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;

 </font><font color="#008000"><i>{set num lock}
 </i></font><font color="#FF0000"><b>if </b></font>GetKeyState<font color="#000080">(</font>VK_NUMLOCK<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  </b></font>Captions<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">' NUM'
 </font><font color="#FF0000"><b>else
  </b></font>Captions<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;

 </font><font color="#008000"><i>{set scroll lock}
 </i></font><font color="#FF0000"><b>if </b></font>GetKeyState<font color="#000080">(</font>VK_SCROLL<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  </b></font>Captions<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">' SCRL'
 </font><font color="#FF0000"><b>else
  </b></font>Captions<font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] := </font><font color="#800000">''</font><font color="#000080">;

 </font><font color="#008000"><i>{set time}
 </i></font>Captions<font color="#000080">[</font><font color="#800000">4</font><font color="#000080">] := </font><font color="#800000">' '</font><font color="#000080">+</font>TimeToStr<font color="#000080">(</font>now<font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0146.PAS">Original</a><b>]</b></p></body>
</html>
