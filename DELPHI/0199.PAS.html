<html>
<head><title> "A Better Way To Print a Form" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>

<font color="#000000">The following TI details a better way <font color="#FF0000"><b>to </b></font>print the contents <font color="#FF0000"><b>of
</b></font>a form<font color="#000080">, </font>by getting the device independent bits <font color="#FF0000"><b>in </b></font><font color="#800000">256 </font>colors
from the form<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>using those bits <font color="#FF0000"><b>to </b></font>print the form <font color="#FF0000"><b>to </b></font>the
printer<font color="#000080">.

</font><font color="#FF0000"><b>In </b></font>addition<font color="#000080">, </font>a check <font color="#FF0000"><b>is </b></font>made <font color="#FF0000"><b>to </b></font>see <font color="#FF0000"><b>if </b></font>the screen <font color="#FF0000"><b>or </b></font>printer
<font color="#FF0000"><b>is </b></font>a palette device<font color="#000080">, </font><font color="#FF0000"><b>and if </b></font>so<font color="#000080">, </font>palette handling <font color="#FF0000"><b>for </b></font>the device
<font color="#FF0000"><b>is </b></font>enabled<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>the screen device <font color="#FF0000"><b>is </b></font>a palette device<font color="#000080">, </font>an additional
step <font color="#FF0000"><b>is </b></font>taken <font color="#FF0000"><b>to </b></font>fill the bitmap<font color="#800000">'s palette from the system palette,
</font>overcoming some buggy video drivers who don<font color="#800000">'t fill the palette in.

</font>Note<font color="#000080">: </font>Since this code does a screen shot <font color="#FF0000"><b>of </b></font>the form<font color="#000080">, </font>the form must
be the topmost window <font color="#FF0000"><b>and </b></font>the whole from must be viewable when the
form shot <font color="#FF0000"><b>is </b></font>made<font color="#000080">.




</font><font color="#FF0000"><b>unit </b></font>Prntit<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, 
  </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>ExtCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Image1<font color="#000080">: </font>TImage<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}


</i></font><font color="#FF0000"><b>uses </b></font>Printers<font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>dc<font color="#000080">: </font>HDC<font color="#000080">;
  </font>isDcPalDevice <font color="#000080">: </font>BOOL<font color="#000080">;
  </font>MemDc <font color="#000080">:</font>hdc<font color="#000080">;
  </font>MemBitmap <font color="#000080">: </font>hBitmap<font color="#000080">;
  </font>OldMemBitmap <font color="#000080">: </font>hBitmap<font color="#000080">;
  </font>hDibHeader <font color="#000080">: </font>Thandle<font color="#000080">;
  </font>pDibHeader <font color="#000080">: </font>pointer<font color="#000080">;
  </font>hBits <font color="#000080">: </font>Thandle<font color="#000080">;
  </font>pBits <font color="#000080">: </font>pointer<font color="#000080">;
  </font>ScaleX <font color="#000080">: </font>Double<font color="#000080">;
  </font>ScaleY <font color="#000080">: </font>Double<font color="#000080">;
  </font>ppal <font color="#000080">: </font>PLOGPALETTE<font color="#000080">;
  </font>pal <font color="#000080">: </font>hPalette<font color="#000080">;
  </font>Oldpal <font color="#000080">: </font>hPalette<font color="#000080">;
  </font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{Get the screen dc}
  </i></font>dc <font color="#000080">:= </font>GetDc<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
 </font><font color="#008000"><i>{Create a compatible dc}
  </i></font>MemDc <font color="#000080">:= </font>CreateCompatibleDc<font color="#000080">(</font>dc<font color="#000080">);
 </font><font color="#008000"><i>{create a bitmap}
  </i></font>MemBitmap <font color="#000080">:= </font>CreateCompatibleBitmap<font color="#000080">(</font>Dc<font color="#000080">, 
                                      </font>form1<font color="#000080">.</font>width<font color="#000080">, 
                                      </font>form1<font color="#000080">.</font>height<font color="#000080">);
 </font><font color="#008000"><i>{select the bitmap into the dc}
  </i></font>OldMemBitmap <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>MemDc<font color="#000080">, </font>MemBitmap<font color="#000080">);

 </font><font color="#008000"><i>{Lets prepare to try a fixup for broken video drivers}
  </i></font>isDcPalDevice <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>GetDeviceCaps<font color="#000080">(</font>dc<font color="#000080">, </font>RASTERCAPS<font color="#000080">) </font><font color="#FF0000"><b>and 
     </b></font>RC_PALETTE <font color="#000080">= </font>RC_PALETTE <font color="#FF0000"><b>then begin
    </b></font>GetMem<font color="#000080">(</font>pPal<font color="#000080">, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) + 
      (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)));
    </font>FillChar<font color="#000080">(</font>pPal<font color="#000080">^, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) + 
      (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)), </font><font color="#800000">#0</font><font color="#000080">);
    </font>pPal<font color="#000080">^.</font>palVersion <font color="#000080">:= </font><font color="#800000">$300</font><font color="#000080">;
    </font>pPal<font color="#000080">^.</font>palNumEntries <font color="#000080">:= 
      </font>GetSystemPaletteEntries<font color="#000080">(</font>dc<font color="#000080">,
                              </font><font color="#800000">0</font><font color="#000080">,
                              </font><font color="#800000">256</font><font color="#000080">,
                              </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>pPal<font color="#000080">^.</font>PalNumEntries <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>pal <font color="#000080">:= </font>CreatePalette<font color="#000080">(</font>pPal<font color="#000080">^);
      </font>oldPal <font color="#000080">:= </font>SelectPalette<font color="#000080">(</font>MemDc<font color="#000080">, </font>Pal<font color="#000080">, </font>false<font color="#000080">);
      </font>isDcPalDevice <font color="#000080">:= </font>true
    <font color="#FF0000"><b>end else
    </b></font>FreeMem<font color="#000080">(</font>pPal<font color="#000080">, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) + 
           (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#008000"><i>{copy from the screen to the memdc/bitmap}
  </i></font>BitBlt<font color="#000080">(</font>MemDc<font color="#000080">,
         </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,
         </font>form1<font color="#000080">.</font>width<font color="#000080">, </font>form1<font color="#000080">.</font>height<font color="#000080">,
         </font>Dc<font color="#000080">,
         </font>form1<font color="#000080">.</font>left<font color="#000080">, </font>form1<font color="#000080">.</font>top<font color="#000080">,
         </font>SrcCopy<font color="#000080">);

  </font><font color="#FF0000"><b>if </b></font>isDcPalDevice <font color="#000080">= </font>true <font color="#FF0000"><b>then begin
    </b></font>SelectPalette<font color="#000080">(</font>MemDc<font color="#000080">, </font>OldPal<font color="#000080">, </font>false<font color="#000080">);
    </font>DeleteObject<font color="#000080">(</font>Pal<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#008000"><i>{unselect the bitmap}
  </i></font>SelectObject<font color="#000080">(</font>MemDc<font color="#000080">, </font>OldMemBitmap<font color="#000080">);
 </font><font color="#008000"><i>{delete the memory dc}
  </i></font>DeleteDc<font color="#000080">(</font>MemDc<font color="#000080">);
 </font><font color="#008000"><i>{Allocate memory for a DIB structure}
  </i></font>hDibHeader <font color="#000080">:= </font>GlobalAlloc<font color="#000080">(</font>GHND<font color="#000080">,
                            </font>sizeof<font color="#000080">(</font>TBITMAPINFO<font color="#000080">) +
                            (</font>sizeof<font color="#000080">(</font>TRGBQUAD<font color="#000080">) * </font><font color="#800000">256</font><font color="#000080">));
 </font><font color="#008000"><i>{get a pointer to the alloced memory}
  </i></font>pDibHeader <font color="#000080">:= </font>GlobalLock<font color="#000080">(</font>hDibHeader<font color="#000080">);

 </font><font color="#008000"><i>{fill in the dib structure with info on the way we want the DIB}
  </i></font>FillChar<font color="#000080">(</font>pDibHeader<font color="#000080">^, 
           </font>sizeof<font color="#000080">(</font>TBITMAPINFO<font color="#000080">) + (</font>sizeof<font color="#000080">(</font>TRGBQUAD<font color="#000080">) * </font><font color="#800000">256</font><font color="#000080">), 
           </font><font color="#800000">#0</font><font color="#000080">);
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biSize <font color="#000080">:= 
    </font>sizeof<font color="#000080">(</font>TBITMAPINFOHEADER<font color="#000080">);
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biPlanes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biBitCount <font color="#000080">:= </font><font color="#800000">8</font><font color="#000080">;
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biWidth <font color="#000080">:= </font>form1<font color="#000080">.</font>width<font color="#000080">;
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biHeight <font color="#000080">:= </font>form1<font color="#000080">.</font>height<font color="#000080">;
  </font>PBITMAPINFOHEADER<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>biCompression <font color="#000080">:= </font>BI_RGB<font color="#000080">;

 </font><font color="#008000"><i>{find out how much memory for the bits}
  </i></font>GetDIBits<font color="#000080">(</font>dc<font color="#000080">,
            </font>MemBitmap<font color="#000080">,
            </font><font color="#800000">0</font><font color="#000080">,
            </font>form1<font color="#000080">.</font>height<font color="#000080">,
            </font><font color="#FF0000"><b>nil</b></font><font color="#000080">,
            </font>TBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">^),
            </font>DIB_RGB_COLORS<font color="#000080">);

 </font><font color="#008000"><i>{Alloc memory for the bits}
  </i></font>hBits <font color="#000080">:= </font>GlobalAlloc<font color="#000080">(</font>GHND<font color="#000080">, 
                       </font>PBitmapInfoHeader<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>BiSizeImage<font color="#000080">);
 </font><font color="#008000"><i>{Get a pointer to the bits}
  </i></font>pBits <font color="#000080">:= </font>GlobalLock<font color="#000080">(</font>hBits<font color="#000080">);

 </font><font color="#008000"><i>{Call fn again, but this time give us the bits!}
  </i></font>GetDIBits<font color="#000080">(</font>dc<font color="#000080">,
            </font>MemBitmap<font color="#000080">,
            </font><font color="#800000">0</font><font color="#000080">,
            </font>form1<font color="#000080">.</font>height<font color="#000080">,
            </font>pBits<font color="#000080">,
            </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^,
            </font>DIB_RGB_COLORS<font color="#000080">);

 </font><font color="#008000"><i>{Lets try a fixup for broken video drivers}
  </i></font><font color="#FF0000"><b>if </b></font>isDcPalDevice <font color="#000080">= </font>true <font color="#FF0000"><b>then begin
    for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>pPal<font color="#000080">^.</font>PalNumEntries <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbRed <font color="#000080">:= 
        </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peRed<font color="#000080">;
      </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbGreen <font color="#000080">:=
        </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peGreen<font color="#000080">;
      </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbBlue <font color="#000080">:=
        </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peBlue<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>FreeMem<font color="#000080">(</font>pPal<font color="#000080">, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) +
           (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#008000"><i>{Release the screen dc}
  </i></font>ReleaseDc<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>dc<font color="#000080">);
 </font><font color="#008000"><i>{Delete the bitmap}
  </i></font>DeleteObject<font color="#000080">(</font>MemBitmap<font color="#000080">);

 </font><font color="#008000"><i>{Start print job}
  </i></font>Printer<font color="#000080">.</font>BeginDoc<font color="#000080">;

 </font><font color="#008000"><i>{Scale print size}
  </i></font><font color="#FF0000"><b>if </b></font>Printer<font color="#000080">.</font>PageWidth <font color="#000080">&lt; </font>Printer<font color="#000080">.</font>PageHeight <font color="#FF0000"><b>then begin
   </b></font>ScaleX <font color="#000080">:= </font>Printer<font color="#000080">.</font>PageWidth<font color="#000080">;
   </font>ScaleY <font color="#000080">:= </font>Form1<font color="#000080">.</font>Height <font color="#000080">* (</font>Printer<font color="#000080">.</font>PageWidth <font color="#000080">/ </font>Form1<font color="#000080">.</font>Width<font color="#000080">);
  </font><font color="#FF0000"><b>end else begin
   </b></font>ScaleX <font color="#000080">:= </font>Form1<font color="#000080">.</font>Width <font color="#000080">* (</font>Printer<font color="#000080">.</font>PageHeight <font color="#000080">/ </font>Form1<font color="#000080">.</font>Height<font color="#000080">);
   </font>ScaleY <font color="#000080">:= </font>Printer<font color="#000080">.</font>PageHeight<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#008000"><i>{Just incase the printer drver is a palette device}
  </i></font>isDcPalDevice <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>GetDeviceCaps<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>RASTERCAPS<font color="#000080">) </font><font color="#FF0000"><b>and
      </b></font>RC_PALETTE <font color="#000080">= </font>RC_PALETTE <font color="#FF0000"><b>then begin
   </b></font><font color="#008000"><i>{Create palette from dib}
    </i></font>GetMem<font color="#000080">(</font>pPal<font color="#000080">, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) +
          (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)));
    </font>FillChar<font color="#000080">(</font>pPal<font color="#000080">^, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) + 
          (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)), </font><font color="#800000">#0</font><font color="#000080">);
    </font>pPal<font color="#000080">^.</font>palVersion <font color="#000080">:= </font><font color="#800000">$300</font><font color="#000080">;
    </font>pPal<font color="#000080">^.</font>palNumEntries <font color="#000080">:= </font><font color="#800000">256</font><font color="#000080">;
    </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#000080">(</font>pPal<font color="#000080">^.</font>PalNumEntries <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>do begin
      </b></font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peRed <font color="#000080">:= 
        </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbRed<font color="#000080">;
      </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peGreen <font color="#000080">:= 
        </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbGreen<font color="#000080">;
      </font>pPal<font color="#000080">^.</font>palPalEntry<font color="#000080">[</font>i<font color="#000080">].</font>peBlue <font color="#000080">:= 
        </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^.</font>bmiColors<font color="#000080">[</font>i<font color="#000080">].</font>rgbBlue<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>pal <font color="#000080">:= </font>CreatePalette<font color="#000080">(</font>pPal<font color="#000080">^);
    </font>FreeMem<font color="#000080">(</font>pPal<font color="#000080">, </font>sizeof<font color="#000080">(</font>TLOGPALETTE<font color="#000080">) + 
            (</font><font color="#800000">255 </font><font color="#000080">* </font>sizeof<font color="#000080">(</font>TPALETTEENTRY<font color="#000080">)));
    </font>oldPal <font color="#000080">:= </font>SelectPalette<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>Pal<font color="#000080">, </font>false<font color="#000080">);
    </font>isDcPalDevice <font color="#000080">:= </font>true
  <font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#008000"><i>{send the bits to the printer}
  </i></font>StretchDiBits<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">,
                </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,
                </font>Round<font color="#000080">(</font>scaleX<font color="#000080">), </font>Round<font color="#000080">(</font>scaleY<font color="#000080">),
                </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">,
                </font>Form1<font color="#000080">.</font>Width<font color="#000080">, </font>Form1<font color="#000080">.</font>Height<font color="#000080">,
                </font>pBits<font color="#000080">,
                </font>PBitmapInfo<font color="#000080">(</font>pDibHeader<font color="#000080">)^,
                </font>DIB_RGB_COLORS<font color="#000080">,
                </font>SRCCOPY<font color="#000080">);

 </font><font color="#008000"><i>{Just incase you printer drver is a palette device}
  </i></font><font color="#FF0000"><b>if </b></font>isDcPalDevice <font color="#000080">= </font>true <font color="#FF0000"><b>then begin
    </b></font>SelectPalette<font color="#000080">(</font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">, </font>oldPal<font color="#000080">, </font>false<font color="#000080">);
    </font>DeleteObject<font color="#000080">(</font>Pal<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


 </font><font color="#008000"><i>{Clean up allocated memory}
  </i></font>GlobalUnlock<font color="#000080">(</font>hBits<font color="#000080">);
  </font>GlobalFree<font color="#000080">(</font>hBits<font color="#000080">);
  </font>GlobalUnlock<font color="#000080">(</font>hDibHeader<font color="#000080">);
  </font>GlobalFree<font color="#000080">(</font>hDibHeader<font color="#000080">);


 </font><font color="#008000"><i>{End the print job}
  </i></font>Printer<font color="#000080">.</font>EndDoc<font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0199.PAS">Original</a><b>]</b></p></body>
</html>
