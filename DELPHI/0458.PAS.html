<html>
<head><title> "Excellent Strings Unit for D2" by OZZ NIXON JR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0458.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>Unit </b></font>MKString32<font color="#000080">; </font><font color="#008000"><i>{Delphi32 Only!}

///////////////////////////////////////////////////////////////////////////////
// MKString32 Coded in Part by G.E. Ozz Nixon Jr. of www.warpgroup.com       //
// ========================================================================= //
// Original Source for DOS by Mythical Kindom's Mark May (mmay@dnaco.net)    //
// Re-written and distributed with permission!                               //
// See Original Copyright Notice before using any of this code!              //
// Many new commands have beed added, and we have optimized the code to use  //
// Windows API calls when applicable, along with support for french days     //
// And we merged all the stray MK* units into this string unit!              //
///////////////////////////////////////////////////////////////////////////////

</i></font><font color="#FF0000"><b>Interface

Uses
   </b></font>Windows<font color="#000080">, </font><font color="#008000"><i>{api calls!}
   </i></font>SysUtils<font color="#000080">,
   </font>Crc32<font color="#000080">;

</font><font color="#FF0000"><b>Type
   </b></font>DateTime<font color="#000080">=</font><font color="#FF0000"><b>Record
      </b></font>Year<font color="#000080">,
      </font>Month<font color="#000080">,
      </font>Day<font color="#000080">,
      </font>DOW<font color="#000080">,
      </font>Hour<font color="#000080">,
      </font>Min<font color="#000080">,
      </font>Sec<font color="#000080">,
      </font>Sec100<font color="#000080">:</font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>MKDateTime<font color="#000080">=</font><font color="#FF0000"><b>Record
      </b></font>Year<font color="#000080">,
      </font>Month<font color="#000080">,
      </font>Day<font color="#000080">,
      </font>Hour<font color="#000080">,
      </font>Min<font color="#000080">,
      </font>Sec<font color="#000080">:</font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>MKDateType<font color="#000080">=</font><font color="#FF0000"><b>Record
      </b></font>Year<font color="#000080">,
      </font>Month<font color="#000080">,
      </font>Day<font color="#000080">:</font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>LoCase<font color="#000080">(</font>Ch<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>padright<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>ch<font color="#000080">:</font>char<font color="#000080">;</font>l<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>PadLeft<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">;</font>L<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>striplead<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>ch<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>StripTrail<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>StripBoth<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Upper<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Lower<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Proper<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>WWrap<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Max<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>LeftOver<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>ExtractWord<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>N <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>WordCount<font color="#000080">(</font>Str <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>CommaStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Long2Str<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Bin2Str<font color="#000080">(</font>Number<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Str2Bin<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Str2Long<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Long2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Word2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Byte2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Hex2Byte<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Hex2Word<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Hex2Long<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>DateStr<font color="#000080">(</font>DosDate<font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>TimeStr<font color="#000080">(</font>DosDate<font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>AddBackSlash<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>InPath<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>WithBackSlash<font color="#000080">(</font>InPath<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>FormattedDate<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">; </font>Mask<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>FormattedDosDate<font color="#000080">(</font>DosDate<font color="#000080">: </font>LongInt<font color="#000080">; </font>Mask<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>DOWStr<font color="#000080">(</font>Dow<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>DOWShortStr<font color="#000080">(</font>DOW<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ReformatDate<font color="#000080">(</font>ODate<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Mask<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>LongDate<font color="#000080">(</font>DStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>TimeStr2Word<font color="#000080">(</font>TS<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Word2TimeStr<font color="#000080">(</font>CTime<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>MonthStr<font color="#000080">(</font>MonthNo<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>PChar2Str<font color="#000080">(</font>Str<font color="#000080">:</font>PChar<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert asciiz to string}
</i></font><font color="#FF0000"><b>Function  </b></font>Str2PChar<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>PChar<font color="#000080">; </font><font color="#008000"><i>{Convert string to asciiz}
</i></font><font color="#FF0000"><b>Function  </b></font>MKDateToStr<font color="#000080">(</font>MKD<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert YYMMDD to MM-DD-YY}
</i></font><font color="#FF0000"><b>Function  </b></font>StrToMKDate<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert MM-DD-YY to YYMMDD}
</i></font><font color="#FF0000"><b>Function  </b></font>CleanChar<font color="#000080">(</font>InChar<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>CleanStr<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>IsNumeric<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>PosLastChar<font color="#000080">(</font>Ch<font color="#000080">: </font>Char<font color="#000080">; </font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Min<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font>Longint<font color="#000080">):</font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Max<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font>Longint<font color="#000080">):</font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Str2Real<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>real<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>Real2Str<font color="#000080">(</font>Number<font color="#000080">:</font>real<font color="#000080">;</font>Decimals<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetLFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>LongInt<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GetLFlag<font color="#000080">(</font>L<font color="#000080">: </font>LongInt<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetWFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>Word<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GetWFlag<font color="#000080">(</font>L<font color="#000080">: </font>Word<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>SetBFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>Byte<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GetBFlag<font color="#000080">(</font>L<font color="#000080">: </font>Byte<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>StrCRC<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>NameCRC<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>UpdateWordFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Flag<font color="#000080">: </font>Word<font color="#000080">; </font>Mask<font color="#000080">: </font>Word<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>DTToUnixDate<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>UnixToDt<font color="#000080">(</font>SecsPast<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>GregorianToJulian<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ValidDate<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ToUnixDate<font color="#000080">(</font>FDate<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ToUnixDateStr<font color="#000080">(</font>FDate<font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>FromUnixDateStr<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>JulianToGregorian<font color="#000080">(</font>JulianDN <font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Year<font color="#000080">, </font>Month<font color="#000080">,
  </font>Day <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>DaysAgo<font color="#000080">(</font>DStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Flag2Str<font color="#000080">(</font>Number<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>Str2Flag<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>ValidMKDate<font color="#000080">(</font>DT<font color="#000080">: </font>MKDateTime<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Procedure </b></font>DT2MKDT<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>DT2<font color="#000080">: </font>MKDateTime<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>MKDT2DT<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DT<font color="#000080">: </font>MKDateTime<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>DT2<font color="#000080">: </font>DateTime<font color="#000080">);
</font><font color="#FF0000"><b>Procedure </b></font>Str2MKD<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>MKD<font color="#000080">: </font>MKDateType<font color="#000080">);
</font><font color="#FF0000"><b>Function  </b></font>MKD2Str<font color="#000080">(</font>MKD<font color="#000080">: </font>MKDateType<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetDosDate<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetDOW<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>GetResultCode<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>TimeOut<font color="#000080">(</font>Time<font color="#000080">:</font>DWord<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Function  </b></font>CurrentTimerTick<font color="#000080">:</font>DWord<font color="#000080">;

</font><font color="#FF0000"><b>Const
   </b></font>CommaChar<font color="#000080">:</font>Char<font color="#000080">=</font><font color="#800000">','</font><font color="#000080">;
   </font>DecodeHEXTable<font color="#000080">=</font><font color="#800000">'123456789ABCEDF'</font><font color="#000080">;
   </font>EncodeHEXTable<font color="#000080">=</font><font color="#800000">'0'</font><font color="#000080">+</font>DecodeHEXTable<font color="#000080">;

</font><font color="#FF0000"><b>Implementation

Const
   </b></font>C1970 <font color="#000080">= </font><font color="#800000">2440588</font><font color="#000080">;
   </font>D0 <font color="#000080">=    </font><font color="#800000">1461</font><font color="#000080">;
   </font>D1 <font color="#000080">=  </font><font color="#800000">146097</font><font color="#000080">;
   </font>D2 <font color="#000080">= </font><font color="#800000">1721119</font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Real2Str<font color="#000080">(</font>Number<font color="#000080">:</font>real<font color="#000080">;</font>Decimals<font color="#000080">:</font>byte<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>Temp <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
    </b></font>Str<font color="#000080">(</font>Number<font color="#000080">:</font><font color="#800000">20</font><font color="#000080">:</font>Decimals<font color="#000080">,</font>Temp<font color="#000080">);
    </font><font color="#FF0000"><b>repeat
       If </b></font>copy<font color="#000080">(</font>Temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">' ' </font><font color="#FF0000"><b>then </b></font>delete<font color="#000080">(</font>Temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>until </b></font>copy<font color="#000080">(</font>temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>Decimals<font color="#000080">=</font><font color="#800000">255 </font><font color="#008000"><i>{Floating} </i></font><font color="#FF0000"><b>then begin
       While </b></font>Temp<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font><font color="#800000">'0' </font><font color="#FF0000"><b>do </b></font>Delete<font color="#000080">(</font>Temp<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>Temp<font color="#000080">[</font>Length<font color="#000080">(</font>temp<font color="#000080">)]=</font><font color="#800000">'.' </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>temp<font color="#000080">,</font>Length<font color="#000080">(</font>temp<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Result<font color="#000080">:= </font>Temp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2Real<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>real<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>code <font color="#000080">: </font>integer<font color="#000080">;
  </font>Temp <font color="#000080">: </font>real<font color="#000080">;
</font><font color="#FF0000"><b>begin
    If </b></font>length<font color="#000080">(</font>Str<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font><font color="#800000">0
    </font><font color="#FF0000"><b>else begin
       If </b></font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'.' </font><font color="#FF0000"><b>Then </b></font>Str<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">+</font>Str<font color="#000080">;
       </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Insert<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">,</font>Str<font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>Str<font color="#000080">[</font>length<font color="#000080">(</font>Str<font color="#000080">)]=</font><font color="#800000">'.' </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Str<font color="#000080">,</font>length<font color="#000080">(</font>Str<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
       </font>val<font color="#000080">(</font>Str<font color="#000080">,</font>temp<font color="#000080">,</font>code<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>code<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>temp
       <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Min<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font>Longint<font color="#000080">):</font>Longint<font color="#000080">; </font><font color="#008000"><i>{min}
</i></font><font color="#FF0000"><b>Begin
   If </b></font>A<font color="#000080">&lt;</font>B <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>A
   <font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font>B<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Max<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>A<font color="#000080">,</font>B<font color="#000080">:</font>Longint<font color="#000080">):</font>Longint<font color="#000080">;  </font><font color="#008000"><i>{max}
</i></font><font color="#FF0000"><b>Begin
   If </b></font>A<font color="#000080">&gt;</font>B <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>A
   <font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font>B<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LoCase<font color="#000080">(</font>Ch<font color="#000080">:</font>Char<font color="#000080">):</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Char<font color="#000080">(</font>CharLower<font color="#000080">(</font>PChar<font color="#000080">(</font>Ch<font color="#000080">))); </font><font color="#008000"><i>{WIN32API}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>AddBackSlash<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>InPath<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Length<font color="#000080">(</font>InPath<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then Begin
    If </b></font>InPath<font color="#000080">[</font>Length<font color="#000080">(</font>InPath<font color="#000080">)] &lt;&gt; </font><font color="#800000">'\' </font><font color="#FF0000"><b>Then </b></font>InPath<font color="#000080">:=</font>InPath<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WithBackSlash<font color="#000080">(</font>InPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>AddBackSlash<font color="#000080">(</font>InPath<font color="#000080">);
   </font>Result<font color="#000080">:=</font>InPath<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Bin2Str<font color="#000080">(</font>Number<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Temp2<font color="#000080">: </font>Byte<font color="#000080">;
    </font>i<font color="#000080">: </font>Word<font color="#000080">;
    </font>TempStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];

  </font><font color="#FF0000"><b>Begin
  </b></font>Temp2 <font color="#000080">:= </font><font color="#800000">$80</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do
    Begin
    If </b></font><font color="#000080">(</font>Number <font color="#FF0000"><b>and </b></font>Temp2<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
      </b></font>TempStr<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'1'
    </font><font color="#FF0000"><b>Else
      </b></font>TempStr<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">;
    </font>Temp2 <font color="#000080">:= </font>Temp2 <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>TempStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#8</font><font color="#000080">;
  </font>Bin2Str <font color="#000080">:= </font>TempStr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Str2Bin<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>i<font color="#000080">: </font>Word<font color="#000080">;
    </font>Temp1<font color="#000080">: </font>Byte<font color="#000080">;
    </font>Temp2<font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>St <font color="#000080">:= </font>StripBoth<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font>St <font color="#000080">:= </font>PadLeft<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font>Temp1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Temp2 <font color="#000080">:= </font><font color="#800000">$80</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do
    Begin
    If </b></font>St<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">'1' </font><font color="#FF0000"><b>Then
      </b></font>Inc<font color="#000080">(</font>Temp1<font color="#000080">,</font>Temp2<font color="#000080">);
    </font>Temp2 <font color="#000080">:= </font>Temp2 <font color="#FF0000"><b>shr </b></font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Str2Bin <font color="#000080">:= </font>Temp1<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2Long<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>Err<font color="#000080">:</font>Integer<font color="#000080">;
   </font>Temp<font color="#000080">:</font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>St<font color="#000080">:=</font>StripBoth<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>St<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font><font color="#800000">0
   </font><font color="#FF0000"><b>Else Begin
      </b></font>Val<font color="#000080">(</font>St<font color="#000080">,</font>Temp<font color="#000080">,</font>Err<font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font>Err<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Result<font color="#000080">:=</font>Temp
      <font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DateStr<font color="#000080">(</font>DosDate<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>W1<font color="#000080">,</font>W2<font color="#000080">,</font>W3<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DecodeDate<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>DosDate<font color="#000080">),</font>W3<font color="#000080">,</font>W1<font color="#000080">,</font>W2<font color="#000080">);
   </font>Result<font color="#000080">:=</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W1<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+
            </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W2<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'-'</font><font color="#000080">+
            </font>PadLeft<font color="#000080">(</font>Copy<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W3<font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TimeStr<font color="#000080">(</font>DosDate<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>W1<font color="#000080">,</font>W2<font color="#000080">,</font>W3<font color="#000080">,</font>W4<font color="#000080">:</font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DecodeTime<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>DosDate<font color="#000080">),</font>W1<font color="#000080">,</font>W2<font color="#000080">,</font>W3<font color="#000080">,</font>W4<font color="#000080">);
   </font>Result<font color="#000080">:=</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W1<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+
            </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W2<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+
            </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>W3<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Byte2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>Byte<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>EncodeHEXTable<font color="#000080">[(</font>Number <font color="#FF0000"><b>shr </b></font><font color="#800000">4</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">]+
      </font>EncodeHEXTable<font color="#000080">[(</font>Number <font color="#FF0000"><b>And </b></font><font color="#800000">$F</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Word2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>Word<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Byte2Hex<font color="#000080">(</font>Number <font color="#FF0000"><b>Shr </b></font><font color="#800000">8</font><font color="#000080">)+</font>Byte2Hex<font color="#000080">(</font>Number <font color="#FF0000"><b>And </b></font><font color="#800000">$FF</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Long2Hex<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Type
   </b></font>WordRec<font color="#000080">=</font><font color="#FF0000"><b>Record
      </b></font>Lo<font color="#000080">:</font>Word<font color="#000080">;
      </font>Hi<font color="#000080">:</font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Word2Hex<font color="#000080">(</font>WordRec<font color="#000080">(</font>Number<font color="#000080">).</font>Hi<font color="#000080">)+</font>Word2Hex<font color="#000080">(</font>WordRec<font color="#000080">(</font>Number<font color="#000080">).</font>Lo<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Byte<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Str2Long<font color="#000080">(</font><font color="#800000">'H'</font><font color="#000080">+</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Word<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Str2Long<font color="#000080">(</font><font color="#800000">'H'</font><font color="#000080">+</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Hex2Long<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Str2Long<font color="#000080">(</font><font color="#800000">'H'</font><font color="#000080">+</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Long2Str<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TempStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Str<font color="#000080">(</font>Number<font color="#000080">,</font>TempStr<font color="#000080">);
  </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CommaStr<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>Number<font color="#000080">:</font>LongInt<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>StrPos<font color="#000080">:</font>Byte<font color="#000080">;
   </font>NumberStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>NumberStr<font color="#000080">:=</font>Long2Str<font color="#000080">(</font>Number<font color="#000080">);
   </font>StrPos<font color="#000080">:=</font>Length<font color="#000080">(</font>NumberStr<font color="#000080">)-</font><font color="#800000">2</font><font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font>StrPos<font color="#000080">&gt;</font><font color="#800000">1 </font><font color="#FF0000"><b>Do Begin
      </b></font>Insert<font color="#000080">(</font>CommaChar<font color="#000080">,</font>NumberStr<font color="#000080">,</font>StrPos<font color="#000080">);
      </font>StrPos<font color="#000080">:=</font>StrPos<font color="#000080">-</font><font color="#800000">3</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>NumberStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>wordcount<font color="#000080">(</font>str<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>count <font color="#000080">: </font>integer<font color="#000080">;
   </font>i <font color="#000080">: </font>integer<font color="#000080">;
   </font>len <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>len <font color="#000080">:= </font>length<font color="#000080">(</font>str<font color="#000080">);
  </font>count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>i <font color="#000080">&lt;= </font>len <font color="#FF0000"><b>do
    begin
    while </b></font><font color="#000080">((</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">#9</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">';'</font><font color="#000080">))) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&lt;= </font>len <font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>count<font color="#000080">);
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#9</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">';'</font><font color="#000080">))) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>wordcount <font color="#000080">:= </font>count<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>extractword<font color="#000080">(</font>str <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>n <font color="#000080">: </font>integer<font color="#000080">) : </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>count <font color="#000080">: </font>integer<font color="#000080">;
    </font>i <font color="#000080">: </font>integer<font color="#000080">;
    </font>len <font color="#000080">: </font>integer<font color="#000080">;
    </font>done <font color="#000080">: </font>boolean<font color="#000080">;
    </font>retstr <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>retstr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>len <font color="#000080">:= </font>length<font color="#000080">(</font>str<font color="#000080">);
  </font>count <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>done <font color="#000080">:= </font>false<font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>done<font color="#000080">) </font><font color="#FF0000"><b>do
    Begin
    While </b></font><font color="#000080">((</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">#9</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] = </font><font color="#800000">';'</font><font color="#000080">))) </font><font color="#FF0000"><b>do
      </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&lt;= </font>len <font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>count<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>count <font color="#000080">= </font>n <font color="#FF0000"><b>then
      begin
      </b></font>retstr<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>i <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Then
        If </b></font>Str<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">';' </font><font color="#FF0000"><b>Then
          </b></font>RetStr <font color="#000080">:= </font><font color="#800000">';'</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">((</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#9</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">';'</font><font color="#000080">))) </font><font color="#FF0000"><b>do
        begin
        </b></font>retstr<font color="#000080">:=</font>RetStr<font color="#000080">+</font>str<font color="#000080">[</font>i<font color="#000080">];
        </font>inc<font color="#000080">(</font>i<font color="#000080">);
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>done <font color="#000080">:= </font>true<font color="#000080">;
      </font><font color="#FF0000"><b>end
    Else
      while </b></font><font color="#000080">((</font>i <font color="#000080">&lt;= </font>len<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#32</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">#9</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">';'</font><font color="#000080">))) </font><font color="#FF0000"><b>do
        </b></font>inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>extractword <font color="#000080">:= </font>retstr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>WWrap<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Max<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>leftOver<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>TempStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>TempPos<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>LeftOver<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>TempStr <font color="#000080">:= </font>St<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Length<font color="#000080">(</font>TempStr<font color="#000080">) &gt; </font>Max <font color="#FF0000"><b>Then Begin
    </b></font>TempPos <font color="#000080">:= </font>Max<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>TempStr<font color="#000080">[</font>TempPos<font color="#000080">]&lt;&gt;</font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>TempPos<font color="#000080">&gt;(</font>Max<font color="#000080">-</font><font color="#800000">20</font><font color="#000080">))
      </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>TempPos<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>Do
      </b></font>Dec<font color="#000080">(</font>TempPos<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>TempStr<font color="#000080">)&gt;</font>TempPos<font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>LeftOver<font color="#000080">:=</font>Copy<font color="#000080">(</font>TempStr<font color="#000080">,</font>TempPos <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>TempStr<font color="#000080">) - </font>TempPos<font color="#000080">);
    </font>TempStr<font color="#000080">:=</font>Copy<font color="#000080">(</font>TempStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>TempPos<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>Proper<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TempStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>i<font color="#000080">:</font>Integer<font color="#000080">;
   </font>NextUp<font color="#000080">:</font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>TempStr<font color="#000080">:=</font>St<font color="#000080">;
   </font>i<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font>NextUp<font color="#000080">:=</font>True<font color="#000080">;
   </font>TempStr<font color="#000080">:=</font>St<font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font>i<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>TempStr<font color="#000080">) </font><font color="#FF0000"><b>Do Begin
      If Not </b></font><font color="#000080">(</font>TempStr<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">,</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">]) </font><font color="#FF0000"><b>then </b></font>NextUp<font color="#000080">:=</font>True
      <font color="#FF0000"><b>Else Begin
         If </b></font>NextUp <font color="#FF0000"><b>Then Begin
            </b></font>NextUp<font color="#000080">:=</font>False<font color="#000080">;
            </font>TempStr<font color="#000080">[</font>i<font color="#000080">]:=</font>UpCase<font color="#000080">(</font>TempStr<font color="#000080">[</font>i<font color="#000080">]);
         </font><font color="#FF0000"><b>End
         Else </b></font>TempStr<font color="#000080">[</font>i<font color="#000080">] := </font>LoCase<font color="#000080">(</font>TempStr<font color="#000080">[</font>i<font color="#000080">]);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>I<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PadLeft<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">;</font>L<font color="#000080">:</font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TempStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>I<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>I<font color="#000080">:=</font>Length<font color="#000080">(</font>St<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>I<font color="#000080">&gt;=</font>L <font color="#FF0000"><b>Then </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>L<font color="#000080">)
   </font><font color="#FF0000"><b>Else Begin
      </b></font>Setlength<font color="#000080">(</font>TempStr<font color="#000080">,</font>L<font color="#000080">);
      </font>FillChar<font color="#000080">(</font>TempStr<font color="#000080">[</font>I<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],</font>L<font color="#000080">-</font>I<font color="#000080">,</font>Ch<font color="#000080">);
      </font>Move<font color="#000080">(</font>St<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>I<font color="#000080">);
      </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>padright<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>ch<font color="#000080">:</font>char<font color="#000080">;</font>l<font color="#000080">:</font>integer<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TempStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>I<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>I<font color="#000080">:=</font>Length<font color="#000080">(</font>St<font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font>I<font color="#000080">&gt;=</font>L <font color="#FF0000"><b>Then </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>L<font color="#000080">)
   </font><font color="#FF0000"><b>Else Begin
      </b></font>Setlength<font color="#000080">(</font>TempStr<font color="#000080">,</font>L<font color="#000080">);
      </font>FillChar<font color="#000080">(</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>L<font color="#000080">-</font>I<font color="#000080">,</font>Ch<font color="#000080">);
      </font>Move<font color="#000080">(</font>St<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>TempStr<font color="#000080">[(</font>L<font color="#000080">-</font>I<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">],</font>I<font color="#000080">);
      </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Upper<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>AnsiUppercase<font color="#000080">(</font>St<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Lower<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>AnsiLowercase<font color="#000080">(</font>St<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>striplead<font color="#000080">(</font>st<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;</font>ch<font color="#000080">:</font>char<font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Tempstr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
   </b></font>Tempstr<font color="#000080">:=</font>st<font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>TempStr<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>Ch<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>TempStr<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>do
      </b></font>Delete<font color="#000080">(</font>TempStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StripTrail<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>TempStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>TempStr<font color="#000080">:=</font>St<font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>TempStr<font color="#000080">[</font>Length<font color="#000080">(</font>TempStr<font color="#000080">)]=</font>Ch<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>TempStr<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>do
      </b></font>Delete<font color="#000080">(</font>TempStr<font color="#000080">,</font>Length<font color="#000080">(</font>TempStr<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>StripBoth<font color="#000080">(</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>Ch<font color="#000080">:</font>Char<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>StripTrail<font color="#000080">(</font>StripLead<font color="#000080">(</font>St<font color="#000080">,</font>Ch<font color="#000080">),</font>Ch<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FormattedDate<font color="#000080">(</font>DT<font color="#000080">:</font>DateTime<font color="#000080">;</font>Mask<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>DStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font>MStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font>MNStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
    </font>YStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
    </font>HourStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font>MinStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font>SecStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
    </font>TmpStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>CurrPos<font color="#000080">: </font>Word<font color="#000080">;
    </font>i<font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>TmpStr <font color="#000080">:= </font>Mask<font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Upper<font color="#000080">(</font>Mask<font color="#000080">);
  </font>DStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Day<font color="#000080">),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>MStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Month<font color="#000080">),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>YStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Year<font color="#000080">),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);
  </font>HourStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Hour<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>MinStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Min<font color="#000080">), </font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>SecStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Dt<font color="#000080">.</font>Sec<font color="#000080">), </font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>MNStr <font color="#000080">:= </font>MonthStr<font color="#000080">(</font>Dt<font color="#000080">.</font>Month<font color="#000080">,</font>French<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'YYYY'</font><font color="#000080">, </font>Mask<font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
    </b></font>YStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>YStr<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'DD'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>DStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>DStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'YY'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>YStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>YStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'MM'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>MStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>MStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'HH'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>HourStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>HourStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'SS'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>SecStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>SecStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'II'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>MinStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>MinStr<font color="#000080">[</font>i<font color="#000080">];
  </font>CurrPos <font color="#000080">:= </font>Pos<font color="#000080">(</font><font color="#800000">'NNN'</font><font color="#000080">, </font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>CurrPos <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>MNStr<font color="#000080">) </font><font color="#FF0000"><b>Do
      </b></font>TmpStr<font color="#000080">[</font>CurrPos <font color="#000080">+ </font>i <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] := </font>MNStr<font color="#000080">[</font>i<font color="#000080">];
  </font>FormattedDate <font color="#000080">:= </font>TmpStr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>FormattedDosDate<font color="#000080">(</font>DosDate<font color="#000080">: </font>LongInt<font color="#000080">; </font>Mask<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>DT<font color="#000080">:</font>DateTime<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DecodeDate<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>DosDate<font color="#000080">),</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font>DT<font color="#000080">.</font>Month<font color="#000080">,</font>DT<font color="#000080">.</font>Year<font color="#000080">);
   </font>DecodeTime<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>DosDate<font color="#000080">),</font>DT<font color="#000080">.</font>Hour<font color="#000080">,</font>DT<font color="#000080">.</font>Min<font color="#000080">,</font>DT<font color="#000080">.</font>Sec<font color="#000080">,</font>DT<font color="#000080">.</font>Sec100<font color="#000080">);
   </font>FormattedDosDate<font color="#000080">:=</font>FormattedDate<font color="#000080">(</font>DT<font color="#000080">, </font>Mask<font color="#000080">,</font>French<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DOWStr<font color="#000080">(</font>Dow<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   If </b></font>French <font color="#FF0000"><b>then Begin
   Case </b></font>DOW <font color="#FF0000"><b>Of
      </b></font><font color="#800000">0</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Dimanche'</font><font color="#000080">;
      </font><font color="#800000">1</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Lundi'</font><font color="#000080">;
      </font><font color="#800000">2</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Mardi'</font><font color="#000080">;
      </font><font color="#800000">3</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Mercredi'</font><font color="#000080">;
      </font><font color="#800000">4</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Jeudi'</font><font color="#000080">;
      </font><font color="#800000">5</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Vendredi'</font><font color="#000080">;
      </font><font color="#800000">6</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Samedi'</font><font color="#000080">;
   </font><font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">'?????'</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End
   Else Begin
   Case </b></font>DOW <font color="#FF0000"><b>Of
      </b></font><font color="#800000">0</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Sunday'</font><font color="#000080">;
      </font><font color="#800000">1</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Monday'</font><font color="#000080">;
      </font><font color="#800000">2</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Tuesday'</font><font color="#000080">;
      </font><font color="#800000">3</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Wednesday'</font><font color="#000080">;
      </font><font color="#800000">4</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Thursday'</font><font color="#000080">;
      </font><font color="#800000">5</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Friday'</font><font color="#000080">;
      </font><font color="#800000">6</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Saturday'</font><font color="#000080">;
   </font><font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">'?????'</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DOWShortStr<font color="#000080">(</font>DOW<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>DOWStr<font color="#000080">(</font>Dow<font color="#000080">,</font>French<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ReformatDate<font color="#000080">(</font>ODate<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Mask<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DT<font color="#000080">.</font>Year<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>ODate<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font>DT<font color="#000080">.</font>Month<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>ODate<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font>DT<font color="#000080">.</font>Day<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>ODate<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font>DT<font color="#000080">.</font>Year <font color="#000080">&lt; </font><font color="#800000">80 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">)
   </font><font color="#FF0000"><b>Else </b></font>Inc<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font><font color="#800000">1900</font><font color="#000080">);
   </font>Result<font color="#000080">:=</font>FormattedDate<font color="#000080">(</font>DT<font color="#000080">,</font>Mask<font color="#000080">,</font>French<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Word2TimeStr<font color="#000080">(</font>CTime<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Hi<font color="#000080">(</font>CTime<font color="#000080">)),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+
       </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>Lo<font color="#000080">(</font>CTime<font color="#000080">)),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TimeStr2Word<font color="#000080">(</font>TS<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>TS<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">))+(</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>TS<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">8</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MonthStr<font color="#000080">(</font>MonthNo<font color="#000080">:</font>Word<font color="#000080">;</font>French<font color="#000080">:</font>Boolean<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
   Case </b></font>MonthNo <font color="#FF0000"><b>of
      </b></font><font color="#800000">01</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Jan'</font><font color="#000080">;
      </font><font color="#800000">02</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Feb'</font><font color="#000080">;
      </font><font color="#800000">03</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Mar'</font><font color="#000080">;
      </font><font color="#800000">04</font><font color="#000080">:</font><font color="#FF0000"><b>If </b></font>French <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font><font color="#800000">'Avr'
         </font><font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">'Apr'</font><font color="#000080">;
      </font><font color="#800000">05</font><font color="#000080">:</font><font color="#FF0000"><b>If </b></font>French <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:= </font><font color="#800000">'Mai'
         </font><font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">'May'</font><font color="#000080">;
      </font><font color="#800000">06</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Jun'</font><font color="#000080">;
      </font><font color="#800000">07</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Jul'</font><font color="#000080">;
      </font><font color="#800000">08</font><font color="#000080">:</font><font color="#FF0000"><b>If </b></font>French <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font><font color="#800000">'Auo'
         </font><font color="#FF0000"><b>Else </b></font>Result<font color="#000080">:=</font><font color="#800000">'Aug'</font><font color="#000080">;
      </font><font color="#800000">09</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Sep'</font><font color="#000080">;
      </font><font color="#800000">10</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Oct'</font><font color="#000080">;
      </font><font color="#800000">11</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Nov'</font><font color="#000080">;
      </font><font color="#800000">12</font><font color="#000080">:</font>Result<font color="#000080">:=</font><font color="#800000">'Dec'</font><font color="#000080">;
      </font><font color="#FF0000"><b>Else </b></font>Result <font color="#000080">:= </font><font color="#800000">'???'</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PChar2Str<font color="#000080">(</font>Str<font color="#000080">:</font>PChar<font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert asciiz to string}
</i></font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>Strpas<font color="#000080">(</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2PChar<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>PChar<font color="#000080">; </font><font color="#008000"><i>{Convert string to asciiz}
</i></font><font color="#FF0000"><b>Begin
   </b></font>Result<font color="#000080">:=</font>PChar<font color="#000080">(</font>Str<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MKDateToStr<font color="#000080">(</font>MKD<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert YYMMDD to MM-DD-YY}
  </i></font><font color="#FF0000"><b>Begin
  </b></font>MKDateToStr <font color="#000080">:= </font>Copy<font color="#000080">(</font>MKD<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+ </font>Copy<font color="#000080">(</font>MKD<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
    </font>Copy<font color="#000080">(</font>MKD<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>StrToMKDate<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#008000"><i>{Convert MM-DD-YY to YYMMDD}
</i></font><font color="#FF0000"><b>Begin
   </b></font>StrToMKDate<font color="#000080">:=</font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font>Copy<font color="#000080">(</font>Str<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CleanChar<font color="#000080">(</font>InChar<font color="#000080">:</font>Char<font color="#000080">):</font>Char<font color="#000080">;
</font><font color="#FF0000"><b>Const
    </b></font>CtlChars<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">32</font><font color="#000080">]=</font><font color="#800000">'oooooooooXoollo&gt;&lt;|!Pg*|^v&gt;&lt;-^v'</font><font color="#000080">;
    </font>HiChars1<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">64</font><font color="#000080">]=</font><font color="#800000">'CueaaaageeeiiiAAEaaooouuyOUcLYPfarounNao?--//!&lt;&gt;***|||||||||||||'</font><font color="#000080">;
    </font>HiChars2<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">64</font><font color="#000080">]=</font><font color="#800000">'|--|-+||||=+|=++-=--==-||||*****abcnEduto0nd80En=+&gt;&lt;fj/~oo.vn2* '</font><font color="#000080">;

</font><font color="#FF0000"><b>Begin
   Case </b></font>InChar <font color="#FF0000"><b>of
      </b></font><font color="#800000">#0</font><font color="#000080">..</font><font color="#800000">#31</font><font color="#000080">:</font>CleanChar<font color="#000080">:=</font>CtlChars<font color="#000080">[</font>Ord<font color="#000080">(</font>InChar<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">];
      </font><font color="#800000">#128</font><font color="#000080">..</font><font color="#800000">#191</font><font color="#000080">:</font>CleanChar<font color="#000080">:=</font>HiChars1<font color="#000080">[</font>Ord<font color="#000080">(</font>InChar<font color="#000080">)-</font><font color="#800000">127</font><font color="#000080">];
      </font><font color="#800000">#192</font><font color="#000080">..</font><font color="#800000">#255</font><font color="#000080">:</font>CleanChar<font color="#000080">:=</font>HiChars2<font color="#000080">[</font>Ord<font color="#000080">(</font>InChar<font color="#000080">)-</font><font color="#800000">191</font><font color="#000080">];
   </font><font color="#FF0000"><b>Else
      </b></font>CleanChar<font color="#000080">:=</font>InChar<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CleanStr<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>I<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>I<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>do Begin
      </b></font>Str<font color="#000080">[</font>I<font color="#000080">]:=</font>CleanChar<font color="#000080">(</font>Str<font color="#000080">[</font>I<font color="#000080">]);
      </font>Inc<font color="#000080">(</font>I<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>Str<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>IsNumeric<font color="#000080">(</font>Str<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>I<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>I<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>Str<font color="#000080">)) </font><font color="#FF0000"><b>do Begin
      If Not </b></font><font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0'</font><font color="#000080">..</font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>Then Begin
         </b></font>Result<font color="#000080">:=</font>False<font color="#000080">;
         </font>Exit<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>Inc<font color="#000080">(</font>I<font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LongDate<font color="#000080">(</font>DStr<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">;
   </font>DosDate<font color="#000080">: </font>TDateTime<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>DT<font color="#000080">.</font>Year<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font><font color="#FF0000"><b>If </b></font>Dt<font color="#000080">.</font>Year<font color="#000080">&lt;</font><font color="#800000">80 </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font><font color="#800000">2000</font><font color="#000080">)
   </font><font color="#FF0000"><b>Else </b></font>Inc<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font><font color="#800000">1900</font><font color="#000080">);
   </font>DT<font color="#000080">.</font>Month<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font>DT<font color="#000080">.</font>Day<font color="#000080">:=</font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
   </font>DT<font color="#000080">.</font>Hour<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>DT<font color="#000080">.</font>Min<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>DT<font color="#000080">.</font>Sec<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>DosDate<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font>DT<font color="#000080">.</font>Month<font color="#000080">,</font>DT<font color="#000080">.</font>Day<font color="#000080">);
   </font>LongDate<font color="#000080">:=</font>DateTimeToFileDate<font color="#000080">(</font>DosDate<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>PosLastChar<font color="#000080">(</font>Ch<font color="#000080">:</font>Char<font color="#000080">;</font>St<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>I<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
   </b></font>I<font color="#000080">:=</font>Length<font color="#000080">(</font>St<font color="#000080">);
   </font><font color="#FF0000"><b>While </b></font><font color="#000080">((</font>i<font color="#000080">&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>st<font color="#000080">[</font>i<font color="#000080">]&lt;&gt;</font>ch<font color="#000080">)) </font><font color="#FF0000"><b>Do </b></font>Dec<font color="#000080">(</font>i<font color="#000080">);
   </font>Result<font color="#000080">:=</font>I<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>DaysAgo<font color="#000080">(</font>DStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
    </b></font>ODate<font color="#000080">: </font>DateTime<font color="#000080">;
    </font>CDate<font color="#000080">: </font>DateTime<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>DecodeDate<font color="#000080">(</font>Now<font color="#000080">,</font>CDate<font color="#000080">.</font>Year<font color="#000080">,</font>CDate<font color="#000080">.</font>Month<font color="#000080">,</font>CDate<font color="#000080">.</font>Day<font color="#000080">);
  </font>CDate<font color="#000080">.</font>Hour <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>CDate<font color="#000080">.</font>Min <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>CDate<font color="#000080">.</font>Sec <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ODate<font color="#000080">.</font>Year <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>ODate<font color="#000080">.</font>Year <font color="#000080">&lt; </font><font color="#800000">80 </font><font color="#FF0000"><b>Then
    </b></font>Inc<font color="#000080">(</font>ODate<font color="#000080">.</font>Year<font color="#000080">, </font><font color="#800000">2000</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Inc<font color="#000080">(</font>ODate<font color="#000080">.</font>Year<font color="#000080">, </font><font color="#800000">1900</font><font color="#000080">);
  </font>ODate<font color="#000080">.</font>Month <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">));
  </font>ODate<font color="#000080">.</font>Day <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>DStr<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">));
  </font>ODate<font color="#000080">.</font>Hour <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ODate<font color="#000080">.</font>Min <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ODate<font color="#000080">.</font>Sec <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>DaysAgo <font color="#000080">:= </font>GregorianToJulian<font color="#000080">(</font>CDate<font color="#000080">) - </font>GregorianToJulian<font color="#000080">(</font>ODate<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>NameCRC<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>L<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>L <font color="#000080">:= </font>StrCrc<font color="#000080">(</font>Str<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>L <font color="#000080">&gt;= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>L <font color="#000080">&lt; </font><font color="#800000">16</font><font color="#000080">)) </font><font color="#FF0000"><b>Then
    </b></font>Inc<font color="#000080">(</font>L<font color="#000080">,</font><font color="#800000">16</font><font color="#000080">);
  </font>NameCrc <font color="#000080">:= </font>L<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>StrCRC<font color="#000080">(</font>Str<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Crc<font color="#000080">: </font>LongInt<font color="#000080">;
    </font>i<font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Crc <font color="#000080">:= </font><font color="#800000">$ffffffff</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Str<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
    </b></font>Crc <font color="#000080">:= </font>UpdC32<font color="#000080">(</font>Ord<font color="#000080">(</font>UpCase<font color="#000080">(</font>Str<font color="#000080">[</font>i<font color="#000080">])),</font>Crc<font color="#000080">);
    </font>Inc<font color="#000080">(</font>i<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>StrCrc <font color="#000080">:= </font>Crc<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>SetLFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>LongInt<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Setting <font color="#FF0000"><b>Then
    </b></font>L <font color="#000080">:= </font>L <font color="#FF0000"><b>or </b></font>Mask
  <font color="#FF0000"><b>Else
    </b></font>L <font color="#000080">:= (</font>L <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>Mask<font color="#000080">));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetLFlag<font color="#000080">(</font>L<font color="#000080">: </font>LongInt<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>L <font color="#FF0000"><b>and </b></font>Mask<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>GetLFlag <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>GetLFlag <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>SetWFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>Word<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Setting <font color="#FF0000"><b>Then
    </b></font>L <font color="#000080">:= </font>L <font color="#FF0000"><b>or </b></font>Mask
  <font color="#FF0000"><b>Else
    </b></font>L <font color="#000080">:= (</font>L <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>Mask<font color="#000080">));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetWFlag<font color="#000080">(</font>L<font color="#000080">: </font>Word<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>Word<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>L <font color="#FF0000"><b>and </b></font>Mask<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>GetWFlag <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>GetWFlag <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>SetBFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>L<font color="#000080">: </font>Byte<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Setting <font color="#FF0000"><b>Then
    </b></font>L <font color="#000080">:= </font>L <font color="#FF0000"><b>or </b></font>Mask
  <font color="#FF0000"><b>Else
    </b></font>L <font color="#000080">:= (</font>L <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>Mask<font color="#000080">));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GetBFlag<font color="#000080">(</font>L<font color="#000080">: </font>Byte<font color="#000080">; </font>Bit<font color="#000080">: </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Mask<font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Mask <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Mask <font color="#000080">:= </font>Mask <font color="#FF0000"><b>Shl </b></font><font color="#000080">(</font>Bit <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>L <font color="#FF0000"><b>and </b></font>Mask<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>GetBFlag <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>GetBFlag <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>GregorianToJulian<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Century<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>XYear<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Month<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Month <font color="#000080">:= </font>DT<font color="#000080">.</font>Month<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Month <font color="#000080">&lt;= </font><font color="#800000">2 </font><font color="#FF0000"><b>Then
    Begin
    </b></font>Dec<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Dec<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">);
  </font>Century <font color="#000080">:= </font>DT<font color="#000080">.</font>Year <font color="#FF0000"><b>Div </b></font><font color="#800000">100</font><font color="#000080">;
  </font>XYear <font color="#000080">:= </font>DT<font color="#000080">.</font>Year <font color="#FF0000"><b>Mod </b></font><font color="#800000">100</font><font color="#000080">;
  </font>Century <font color="#000080">:= (</font>Century <font color="#000080">* </font>D1<font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">;
  </font>XYear <font color="#000080">:= (</font>XYear <font color="#000080">* </font>D0<font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">;
  </font>GregorianToJulian <font color="#000080">:=  ((((</font>Month <font color="#000080">* </font><font color="#800000">153</font><font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">) + </font>DT<font color="#000080">.</font>Day<font color="#000080">) + </font>D2
    <font color="#000080">+ </font>XYear <font color="#000080">+ </font>Century<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>JulianToGregorian<font color="#000080">(</font>JulianDN <font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Year<font color="#000080">, </font>Month<font color="#000080">,
  </font>Day <font color="#000080">: </font>Integer<font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Temp<font color="#000080">,
    </font>XYear<font color="#000080">: </font>LongInt<font color="#000080">;
    </font>YYear<font color="#000080">,
    </font>YMonth<font color="#000080">,
    </font>YDay<font color="#000080">: </font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Temp <font color="#000080">:= (((</font>JulianDN <font color="#000080">- </font>D2<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">2</font><font color="#000080">) - </font><font color="#800000">1</font><font color="#000080">);
  </font>XYear <font color="#000080">:= (</font>Temp <font color="#FF0000"><b>Mod </b></font>D1<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#800000">3</font><font color="#000080">;
  </font>JulianDN <font color="#000080">:= </font>Temp <font color="#FF0000"><b>Div </b></font>D1<font color="#000080">;
  </font>YYear <font color="#000080">:= (</font>XYear <font color="#FF0000"><b>Div </b></font>D0<font color="#000080">);
  </font>Temp <font color="#000080">:= ((((</font>XYear <font color="#FF0000"><b>mod </b></font>D0<font color="#000080">) + </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>shr </b></font><font color="#800000">2</font><font color="#000080">) * </font><font color="#800000">5</font><font color="#000080">) - </font><font color="#800000">3</font><font color="#000080">;
  </font>YMonth <font color="#000080">:= </font>Temp <font color="#FF0000"><b>Div </b></font><font color="#800000">153</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>YMonth <font color="#000080">&gt;= </font><font color="#800000">10 </font><font color="#FF0000"><b>Then
    Begin
    </b></font>YYear <font color="#000080">:= </font>YYear <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>YMonth <font color="#000080">:= </font>YMonth <font color="#000080">- </font><font color="#800000">12</font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>YMonth <font color="#000080">:= </font>YMonth <font color="#000080">+ </font><font color="#800000">3</font><font color="#000080">;
  </font>YDay <font color="#000080">:= </font>Temp <font color="#FF0000"><b>Mod </b></font><font color="#800000">153</font><font color="#000080">;
  </font>YDay <font color="#000080">:= (</font>YDay <font color="#000080">+ </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">5</font><font color="#000080">;
  </font>Year <font color="#000080">:= </font>YYear <font color="#000080">+ (</font>JulianDN <font color="#000080">* </font><font color="#800000">100</font><font color="#000080">);
  </font>Month <font color="#000080">:= </font>YMonth<font color="#000080">;
  </font>Day <font color="#000080">:= </font>YDay<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>UnixToDt<font color="#000080">(</font>SecsPast<font color="#000080">: </font>LongInt<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>Dt<font color="#000080">: </font>DateTime<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>DateNum<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">:</font>Integer<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>Datenum <font color="#000080">:= (</font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">86400</font><font color="#000080">) + </font>c1970<font color="#000080">;
  </font>Year<font color="#000080">:=</font>DT<font color="#000080">.</font>Year<font color="#000080">;
  </font>Month<font color="#000080">:=</font>DT<font color="#000080">.</font>Month<font color="#000080">;
  </font>Day<font color="#000080">:=</font>DT<font color="#000080">.</font>Day<font color="#000080">;
  </font>JulianToGregorian<font color="#000080">(</font>DateNum<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>DT<font color="#000080">.</font>Year<font color="#000080">:=</font>Year<font color="#000080">;
  </font>DT<font color="#000080">.</font>Month<font color="#000080">:=</font>Month<font color="#000080">;
  </font>DT<font color="#000080">.</font>Day<font color="#000080">:=</font>Day<font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">86400</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Hour <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">3600</font><font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">3600</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Min <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">60</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Sec <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">60</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>DTToUnixDate<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>LongInt<font color="#000080">;
   </font><font color="#FF0000"><b>Var
     </b></font>SecsPast<font color="#000080">, </font>DaysPast<font color="#000080">: </font>LongInt<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>DaysPast <font color="#000080">:= </font>GregorianToJulian<font color="#000080">(</font>DT<font color="#000080">) - </font>c1970<font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>DaysPast <font color="#000080">* </font><font color="#800000">86400</font><font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>SecsPast <font color="#000080">+ (</font>LongInt<font color="#000080">(</font>DT<font color="#000080">.</font>Hour<font color="#000080">) * </font><font color="#800000">3600</font><font color="#000080">) + (</font>DT<font color="#000080">.</font>Min <font color="#000080">* </font><font color="#800000">60</font><font color="#000080">) + (</font>DT<font color="#000080">.</font>Sec<font color="#000080">);
  </font>DTToUnixDate <font color="#000080">:= </font>SecsPast<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>ToUnixDate<font color="#000080">(</font>FDate<font color="#000080">: </font>LongInt<font color="#000080">): </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
      </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>DecodeDate<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>FDate<font color="#000080">),</font>DT<font color="#000080">.</font>Year<font color="#000080">,</font>DT<font color="#000080">.</font>Month<font color="#000080">,</font>DT<font color="#000080">.</font>Day<font color="#000080">);
  </font>DecodeTime<font color="#000080">(</font>FileDateToDateTime<font color="#000080">(</font>FDate<font color="#000080">),</font>DT<font color="#000080">.</font>Hour<font color="#000080">,</font>DT<font color="#000080">.</font>Min<font color="#000080">,</font>DT<font color="#000080">.</font>Sec<font color="#000080">,</font>DT<font color="#000080">.</font>Sec100<font color="#000080">);
  </font>ToUnixDate <font color="#000080">:= </font>DTToUnixDate<font color="#000080">(</font>Dt<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ToUnixDateStr<font color="#000080">(</font>FDate<font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
  </b></font>SecsPast<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>SecsPast <font color="#000080">:= </font>ToUnixDate<font color="#000080">(</font>FDate<font color="#000080">);
  </font>S <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>SecsPast <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>s<font color="#000080">) &lt; </font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>DO
    Begin
    </b></font>s <font color="#000080">:= </font>Chr<font color="#000080">((</font>secspast <font color="#FF0000"><b>And </b></font><font color="#800000">7</font><font color="#000080">) + </font><font color="#800000">$30</font><font color="#000080">) + </font>s<font color="#000080">;
    </font>secspast <font color="#000080">:= (</font>secspast <font color="#FF0000"><b>Shr </b></font><font color="#800000">3</font><font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>ToUnixDateStr <font color="#000080">:= </font>S<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>FromUnixDateStr<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">;
    </font>secspast<font color="#000080">, </font>datenum<font color="#000080">: </font>LONGINT<font color="#000080">;
    </font>n<font color="#000080">: </font>WORD<font color="#000080">;
    </font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">:</font>Integer<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>SecsPast <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>n <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>Do
    </b></font>SecsPast <font color="#000080">:= (</font>SecsPast <font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) + </font>Ord<font color="#000080">(</font>s<font color="#000080">[</font>n<font color="#000080">]) - </font><font color="#800000">$30</font><font color="#000080">;
  </font>Datenum <font color="#000080">:= (</font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">86400</font><font color="#000080">) + </font>c1970<font color="#000080">;
  </font>Year<font color="#000080">:=</font>DT<font color="#000080">.</font>Year<font color="#000080">;
  </font>Month<font color="#000080">:=</font>DT<font color="#000080">.</font>Month<font color="#000080">;
  </font>Day<font color="#000080">:=</font>DT<font color="#000080">.</font>Day<font color="#000080">;
  </font>JulianToGregorian<font color="#000080">(</font>DateNum<font color="#000080">, </font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>day<font color="#000080">);
  </font>DT<font color="#000080">.</font>Year<font color="#000080">:=</font>Year<font color="#000080">;
  </font>DT<font color="#000080">.</font>Month<font color="#000080">:=</font>Month<font color="#000080">;
  </font>DT<font color="#000080">.</font>Day<font color="#000080">:=</font>Day<font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">86400</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Hour <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">3600</font><font color="#000080">;
  </font>SecsPast <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">3600</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Min <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Div </b></font><font color="#800000">60</font><font color="#000080">;
  </font>DT<font color="#000080">.</font>Sec <font color="#000080">:= </font>SecsPast <font color="#FF0000"><b>Mod </b></font><font color="#800000">60</font><font color="#000080">;
  </font>FromUnixDateStr <font color="#000080">:= </font>DateTimeToFileDate<font color="#000080">(</font>StrToDateTime<font color="#000080">(</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Month<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'/'</font><font color="#000080">+
     </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Day<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">'/'</font><font color="#000080">+</font>PadLeft<font color="#000080">(</font>Copy<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Year<font color="#000080">),</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">+
     </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Hour<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+</font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Min<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)+</font><font color="#800000">':'</font><font color="#000080">+
     </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>DT<font color="#000080">.</font>Sec<font color="#000080">),</font><font color="#800000">' '</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)));
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>ValidDate<font color="#000080">(</font>DT<font color="#000080">: </font>DateTime<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Const
    </b></font>DOM<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte <font color="#000080">= (</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">29</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">);

  </font><font color="#FF0000"><b>Var
    </b></font>Valid<font color="#000080">: </font>Boolean<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>Valid <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>DT<font color="#000080">.</font>Month <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>DT<font color="#000080">.</font>Month <font color="#000080">&gt; </font><font color="#800000">12</font><font color="#000080">)) </font><font color="#FF0000"><b>Then
    </b></font>Valid <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Valid <font color="#FF0000"><b>Then
    If </b></font><font color="#000080">((</font>DT<font color="#000080">.</font>Day <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>DT<font color="#000080">.</font>Day <font color="#000080">&gt; </font>DOM<font color="#000080">[</font>DT<font color="#000080">.</font>Month<font color="#000080">])) </font><font color="#FF0000"><b>Then
      </b></font>Valid <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">((</font>Valid<font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>DT<font color="#000080">.</font>Month <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>DT<font color="#000080">.</font>Day <font color="#000080">= </font><font color="#800000">29</font><font color="#000080">)) </font><font color="#FF0000"><b>Then
    If </b></font><font color="#000080">((</font>DT<font color="#000080">.</font>Year <font color="#FF0000"><b>Mod </b></font><font color="#800000">4</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Valid <font color="#000080">:= </font>False<font color="#000080">;
  </font>ValidDate <font color="#000080">:= </font>Valid<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>UpdateWordFlag<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>Flag<font color="#000080">: </font>Word<font color="#000080">; </font>Mask<font color="#000080">: </font>Word<font color="#000080">; </font>Setting<font color="#000080">: </font>Boolean<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
  If </b></font>Setting <font color="#FF0000"><b>Then
    </b></font>Flag <font color="#000080">:= </font>Flag <font color="#FF0000"><b>or </b></font>Mask
  <font color="#FF0000"><b>Else
    </b></font>Flag <font color="#000080">:= </font>Flag <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>Mask<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Flag2Str<font color="#000080">(</font>Number<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>Temp2<font color="#000080">: </font>Byte<font color="#000080">;
    </font>i<font color="#000080">: </font>Word<font color="#000080">;
    </font>TempStr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">8</font><font color="#000080">];

  </font><font color="#FF0000"><b>Begin
  </b></font>Temp2 <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do Begin
    If </b></font><font color="#000080">(</font>Number <font color="#FF0000"><b>and </b></font>Temp2<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>TempStr<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'X'
    </font><font color="#FF0000"><b>Else </b></font>TempStr<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'-'</font><font color="#000080">;
    </font>Temp2 <font color="#000080">:= </font>Temp2 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>TempStr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#8</font><font color="#000080">;
  </font>Flag2Str <font color="#000080">:= </font>TempStr<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>Str2Flag<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Byte<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>i<font color="#000080">: </font>Word<font color="#000080">;
    </font>Temp1<font color="#000080">: </font>Byte<font color="#000080">;
    </font>Temp2<font color="#000080">: </font>Byte<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>St <font color="#000080">:= </font>StripBoth<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
  </font>St <font color="#000080">:= </font>PadLeft<font color="#000080">(</font>St<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">);
  </font>Temp1 <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Temp2 <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">8 </font><font color="#FF0000"><b>Do Begin
    If </b></font>Uppercase<font color="#000080">(</font>Copy<font color="#000080">(</font>St<font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)) = </font><font color="#800000">'X' </font><font color="#FF0000"><b>Then </b></font>Inc<font color="#000080">(</font>Temp1<font color="#000080">,</font>Temp2<font color="#000080">);
    </font>Temp2 <font color="#000080">:= </font>Temp2 <font color="#FF0000"><b>shl </b></font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>Str2Flag <font color="#000080">:= </font>Temp1<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DT2MKDT<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DT<font color="#000080">: </font>DateTime<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>DT2<font color="#000080">: </font>MKDateTime<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
  </b></font>DT2<font color="#000080">.</font>Year <font color="#000080">:= </font>DT<font color="#000080">.</font>Year<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Month <font color="#000080">:= </font>DT<font color="#000080">.</font>Month<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Day <font color="#000080">:= </font>DT<font color="#000080">.</font>Day<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Hour <font color="#000080">:= </font>DT<font color="#000080">.</font>Hour<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Min <font color="#000080">:= </font>DT<font color="#000080">.</font>Min<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Sec <font color="#000080">:= </font>DT<font color="#000080">.</font>Sec<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MKDT2DT<font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>DT<font color="#000080">: </font>MKDateTime<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>DT2<font color="#000080">: </font>DateTime<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
  </b></font>DT2<font color="#000080">.</font>Year <font color="#000080">:= </font>DT<font color="#000080">.</font>Year<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Month <font color="#000080">:= </font>DT<font color="#000080">.</font>Month<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Day <font color="#000080">:= </font>DT<font color="#000080">.</font>Day<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Hour <font color="#000080">:= </font>DT<font color="#000080">.</font>Hour<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Min <font color="#000080">:= </font>DT<font color="#000080">.</font>Min<font color="#000080">;
  </font>DT2<font color="#000080">.</font>Sec <font color="#000080">:= </font>DT<font color="#000080">.</font>Sec<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function  </b></font>ValidMKDate<font color="#000080">(</font>DT<font color="#000080">: </font>MKDateTime<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>Var
    </b></font>DT2<font color="#000080">: </font>DateTime<font color="#000080">;

  </font><font color="#FF0000"><b>Begin
  </b></font>MKDT2DT<font color="#000080">(</font>DT<font color="#000080">, </font>DT2<font color="#000080">);
  </font>ValidMKDate <font color="#000080">:= </font>ValidDate<font color="#000080">(</font>DT2<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>Str2MKD<font color="#000080">(</font>St<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>MKD<font color="#000080">: </font>MKDateType<font color="#000080">);
  </font><font color="#FF0000"><b>Begin
  </b></font>FillChar<font color="#000080">(</font>MKD<font color="#000080">, </font>SizeOf<font color="#000080">(</font>MKD<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>MKD<font color="#000080">.</font>Year <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>St<font color="#000080">, </font><font color="#800000">7</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">));
  </font>MKD<font color="#000080">.</font>Month <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>St<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">));
  </font>MKD<font color="#000080">.</font>Day <font color="#000080">:= </font>Str2Long<font color="#000080">(</font>Copy<font color="#000080">(</font>St<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">));
  </font><font color="#FF0000"><b>If </b></font>MKD<font color="#000080">.</font>Year <font color="#000080">&lt; </font><font color="#800000">80 </font><font color="#FF0000"><b>Then
    </b></font>Inc<font color="#000080">(</font>MKD<font color="#000080">.</font>Year<font color="#000080">, </font><font color="#800000">2000</font><font color="#000080">)
  </font><font color="#FF0000"><b>Else
    </b></font>Inc<font color="#000080">(</font>MKD<font color="#000080">.</font>Year<font color="#000080">, </font><font color="#800000">1900</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>MKD2Str<font color="#000080">(</font>MKD<font color="#000080">: </font>MKDateType<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  </b></font>MKD2Str <font color="#000080">:= </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>MKD<font color="#000080">.</font>Month<font color="#000080">),</font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
             </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>MKD<font color="#000080">.</font>Day<font color="#000080">), </font><font color="#800000">'0'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">) + </font><font color="#800000">'-' </font><font color="#000080">+
             </font>PadLeft<font color="#000080">(</font>Long2Str<font color="#000080">(</font>MKD<font color="#000080">.</font>Year <font color="#FF0000"><b>Mod </b></font><font color="#800000">100</font><font color="#000080">), </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>CurrentTimerTick<font color="#000080">:</font>DWord<font color="#000080">;      </font><font color="#008000"><i>{use this to use Timeout!}
</i></font><font color="#FF0000"><b>Begin
   </b></font>CurrentTimerTick<font color="#000080">:=</font>GetTickCount<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TimeOut<font color="#000080">(</font>Time<font color="#000080">:</font>DWord<font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TimeOut<font color="#000080">:=</font>Time<font color="#000080">-</font>GetTickCount<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetResultCode<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetResultCode<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{expand on this later!}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDosDate<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetDosDate<font color="#000080">:=</font>DateTimeToFileDate<font color="#000080">(</font>Now<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>GetDOW<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>GetDOW<font color="#000080">:=</font>DayOfWeek<font color="#000080">(</font>Now<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>End</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0458.PAS">Original</a><b>]</b></p></body>
</html>
