<html>
<head><title> "Credit Card Verification" by RON LOEWY</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0401.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>(******************************************************************************
*                                  CCardVer                                   *
*                                                                             *
* Credit Card Verification                                                    *
* (c) 1997, HyperAct, Inc. http://www.hyperact.com/                           *
* Written by Ron Loewy (rloewy@hyperact.com)                                  *
*                                                                             *
* To use - set the CardType, CardNumber and ExprDate properties and check the *
*          Valid property for results.                                        *
******************************************************************************)
</i></font><font color="#FF0000"><b>unit </b></font>CCardVer<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
   </b></font>classes
   <font color="#000080">,</font>sysUtils
   <font color="#000080">;

</font><font color="#FF0000"><b>type
   </b></font>TCreditCardType <font color="#000080">= (</font>ccAmex<font color="#000080">, </font>ccVisa<font color="#000080">, </font>ccMasterCard<font color="#000080">, </font>ccDiscover<font color="#000080">, </font>ccOther<font color="#000080">);
   </font>TCreditCardValidity <font color="#000080">= (</font>ccvValid<font color="#000080">, </font>ccvInvalid<font color="#000080">, </font>ccvExpired<font color="#000080">);
   </font>TCreditCardVerify <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TComponent<font color="#000080">)

   </font><font color="#FF0000"><b>private
      </b></font>FCardType <font color="#000080">: </font>TCreditCardType<font color="#000080">;
      </font>FExprDate <font color="#000080">: </font>TDateTime<font color="#000080">;
      </font>FCardNumber <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

      </font><font color="#FF0000"><b>function </b></font>VerifyNumber <font color="#000080">: </font>boolean<font color="#000080">;
      </font><font color="#FF0000"><b>function </b></font>VerifyDate <font color="#000080">: </font>boolean<font color="#000080">;

   </font><font color="#FF0000"><b>protected
      function  </b></font>GetCardValidity <font color="#000080">: </font>TCreditCardValidity<font color="#000080">;

   </font><font color="#FF0000"><b>public
      constructor </b></font>Create<font color="#000080">(</font>AOwner <font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>procedure </b></font>SetCardTypeByName<font color="#000080">(</font>CardName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>procedure </b></font>SetCardExprMonYear<font color="#000080">(</font>mon<font color="#000080">, </font>year <font color="#000080">: </font>integer<font color="#000080">);
      </font><font color="#FF0000"><b>procedure </b></font>SetExprDateFromStr<font color="#000080">(</font>TheStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);

      </font><font color="#FF0000"><b>property </b></font>CardType <font color="#000080">: </font>TCreditCardType <font color="#FF0000"><b>read </b></font>FCardType <font color="#FF0000"><b>write </b></font>FCardType<font color="#000080">;
      </font><font color="#FF0000"><b>property </b></font>ExprDate <font color="#000080">: </font>TDateTime <font color="#FF0000"><b>read </b></font>FExprDate <font color="#FF0000"><b>write </b></font>FExprDate<font color="#000080">;
      </font><font color="#FF0000"><b>property </b></font>CardNumber <font color="#000080">: </font><font color="#FF0000"><b>String read </b></font>FCardNumber <font color="#FF0000"><b>write </b></font>FCardNumber<font color="#000080">;
      </font><font color="#FF0000"><b>property </b></font>Valid <font color="#000080">: </font>TCreditCardValidity <font color="#FF0000"><b>read </b></font>GetCardValidity<font color="#000080">;

   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify class definition }

</i></font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>(******************************************************************************
*                          TCreditCardVerify.Create                           *
******************************************************************************)
</i></font><font color="#FF0000"><b>constructor </b></font>TCreditCardVerify<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
   inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
   </font>CardType <font color="#000080">:= </font>ccOther<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.Create }

(******************************************************************************
*                     TCreditCardVerify.SetCardTypeByName                     *
******************************************************************************)
</i></font><font color="#FF0000"><b>procedure </b></font>TCreditCardVerify<font color="#000080">.</font>SetCardTypeByName<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>CardName <font color="#000080">:= </font>upperCase<font color="#000080">(</font>CardName<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'AMEX'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'AMERICAN EXPRESS'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'OPTIMA'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>CardType <font color="#000080">:= </font>ccAmex
   <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'VISA'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>CardType <font color="#000080">:= </font>ccVisa
   <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'MASTERCARD'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'MC'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'EUROCARD'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>CardType <font color="#000080">:= </font>ccMasterCard
   <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'DISCOVER'</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>CardName <font color="#000080">= </font><font color="#800000">'NOVOUS'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>CardType <font color="#000080">:= </font>ccDiscover
   <font color="#FF0000"><b>else
      </b></font>CardType <font color="#000080">:= </font>ccOther<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.SetCardTypeByName }

(******************************************************************************
*                      TCreditCardVerify.GetCardValidity                      *
******************************************************************************)
</i></font><font color="#FF0000"><b>function </b></font>TCreditCardVerify<font color="#000080">.</font>GetCardValidity<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result <font color="#000080">:= </font>ccvInvalid<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>VerifyNumber<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>exit<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>verifyDate<font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>result <font color="#000080">:= </font>ccvValid
   <font color="#FF0000"><b>else
      </b></font>result <font color="#000080">:= </font>ccvExpired<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.GetCardValidity }

(******************************************************************************
*                       TCreditCardVerify.VerifyNumber                        *
******************************************************************************)
</i></font><font color="#FF0000"><b>function </b></font>TCreditCardVerify<font color="#000080">.</font>VerifyNumber<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>SubSum <font color="#000080">: </font>integer<font color="#000080">;
   </font>CheckSum <font color="#000080">: </font>integer<font color="#000080">;
   </font>i <font color="#000080">: </font>integer<font color="#000080">;
   </font>Number <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>TempChar <font color="#000080">: </font>char<font color="#000080">;
   </font>StartPos <font color="#000080">: </font>integer<font color="#000080">;
   </font>Mask <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result <font color="#000080">:= </font>false<font color="#000080">; </font><font color="#008000"><i>// by default it is not valid 
   </i></font>CheckSum <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>Mask <font color="#000080">:= </font><font color="#800000">'2121212121212121'</font><font color="#000080">;

   </font>Number <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>CardNumber<font color="#000080">) </font><font color="#FF0000"><b>do
      if </b></font><font color="#000080">(</font>CardNumber<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'0' </font><font color="#000080">.. </font><font color="#800000">'9'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
         </b></font>Number <font color="#000080">:= </font>Number <font color="#000080">+ </font>CardNumber<font color="#000080">[</font>i<font color="#000080">];

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>Number<font color="#000080">) &lt; </font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>exit<font color="#000080">;

   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>length<font color="#000080">(</font>Number<font color="#000080">) &lt; </font><font color="#800000">16</font><font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>Number <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>Number<font color="#000080">; 

   </font>Number <font color="#000080">:= </font>lowerCase<font color="#000080">(</font>trim<font color="#000080">(</font>Number<font color="#000080">));

   </font>tempChar <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
   </font>startPos <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Number<font color="#000080">) </font><font color="#FF0000"><b>do begin
      if </b></font><font color="#000080">(</font>Number<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>tempChar <font color="#000080">:= </font>Number<font color="#000080">[</font>i<font color="#000080">];
         </font>StartPos <font color="#000080">:= </font>i<font color="#000080">;
         </font>break<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>case </b></font>CardType <font color="#FF0000"><b>of
      </b></font>ccVisa <font color="#000080">: </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>tempChar <font color="#000080">&lt;&gt; </font><font color="#800000">'4'</font><font color="#000080">) </font><font color="#FF0000"><b>then 
                  </b></font>exit<font color="#000080">;
      </font>ccDiscover <font color="#000080">: </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>tempChar <font color="#000080">&lt;&gt; </font><font color="#800000">'6'</font><font color="#000080">) </font><font color="#FF0000"><b>then 
                  </b></font>exit<font color="#000080">;
      </font>ccMasterCard <font color="#000080">: </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>tempChar <font color="#000080">&lt;&gt; </font><font color="#800000">'5'</font><font color="#000080">) </font><font color="#FF0000"><b>then 
                  </b></font>exit<font color="#000080">;
      </font>ccAmex <font color="#000080">: </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>tempChar <font color="#000080">= </font><font color="#800000">'3'</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
                  if </b></font><font color="#000080">(</font>startPos <font color="#000080">&lt; </font>length<font color="#000080">(</font>Number<font color="#000080">)) </font><font color="#FF0000"><b>then begin
                     if </b></font><font color="#000080">(</font>Number<font color="#000080">[</font>StartPos <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'7'</font><font color="#000080">) </font><font color="#FF0000"><b>then
                        </b></font>exit<font color="#000080">;
                  </font><font color="#FF0000"><b>end else
                     </b></font>exit<font color="#000080">;
               </font><font color="#FF0000"><b>end else 
                  </b></font>exit<font color="#000080">;
      </font>ccOther <font color="#000080">: ;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ case }

   </i></font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font><font color="#800000">16 </font><font color="#FF0000"><b>do begin
      </b></font>tempChar <font color="#000080">:= </font>Number<font color="#000080">[</font>i<font color="#000080">];
      </font>SubSum <font color="#000080">:= (</font>ord<font color="#000080">(</font>TempChar<font color="#000080">) - </font><font color="#800000">48</font><font color="#000080">) * (</font>ord<font color="#000080">(</font>Mask<font color="#000080">[</font>i<font color="#000080">]) - </font><font color="#800000">48</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>SubSum <font color="#000080">&gt; </font><font color="#800000">9</font><font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>dec<font color="#000080">(</font>SubSum<font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
      </font>inc<font color="#000080">(</font>checkSum<font color="#000080">, </font>SubSum<font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>CheckSum <font color="#FF0000"><b>mod </b></font><font color="#800000">10</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>exit<font color="#000080">;

   </font>result <font color="#000080">:= </font>true<font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.VerifyNumber }

(******************************************************************************
*                        TCreditCardVerify.VerifyDate                         *
******************************************************************************)
</i></font><font color="#FF0000"><b>function </b></font>TCreditCardVerify<font color="#000080">.</font>VerifyDate<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>result <font color="#000080">:= (</font>ExprDate <font color="#000080">&gt; </font>now<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.VerifyDate }

(******************************************************************************
*                    TCreditCardVerify.SetCardExprMonYear                     *
******************************************************************************)
</i></font><font color="#FF0000"><b>procedure </b></font>TCreditCardVerify<font color="#000080">.</font>SetCardExprMonYear<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>lastDate <font color="#000080">: </font>byte<font color="#000080">;
   </font>TheTime <font color="#000080">: </font>TDateTime<font color="#000080">;

   </font><font color="#008000"><i>(******************************************************************************
   *                                 IsLeapYear                                  *
   ******************************************************************************)
   </i></font><font color="#FF0000"><b>function </b></font>IsLeapYear<font color="#000080">(</font>Year <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
   </font><font color="#FF0000"><b>begin
     </b></font>Result <font color="#000080">:= (</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">4000 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">((</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">400 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">));
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ IsLeapYear }

</i></font><font color="#FF0000"><b>begin
   if </b></font><font color="#000080">(</font>word<font color="#000080">(</font>year<font color="#000080">) &lt; </font><font color="#800000">100</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>inc<font color="#000080">(</font>year<font color="#000080">, </font><font color="#800000">1900</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>year <font color="#000080">&lt; </font><font color="#800000">1900</font><font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>inc<font color="#000080">(</font>year<font color="#000080">, </font><font color="#800000">100</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>case </b></font>mon <font color="#FF0000"><b>of
    </b></font><font color="#800000">1
    </font><font color="#000080">,</font><font color="#800000">3
    </font><font color="#000080">,</font><font color="#800000">5
    </font><font color="#000080">,</font><font color="#800000">7
    </font><font color="#000080">,</font><font color="#800000">8
    </font><font color="#000080">,</font><font color="#800000">10
    </font><font color="#000080">,</font><font color="#800000">12 </font><font color="#000080">: </font>LastDate <font color="#000080">:= </font><font color="#800000">31</font><font color="#000080">;
    </font><font color="#800000">4
    </font><font color="#000080">,</font><font color="#800000">6
    </font><font color="#000080">,</font><font color="#800000">9
    </font><font color="#000080">,</font><font color="#800000">11 </font><font color="#000080">: </font>LastDate <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
    </font><font color="#800000">2 </font><font color="#000080">: </font><font color="#FF0000"><b>begin
         </b></font>LastDate <font color="#000080">:= </font><font color="#800000">28</font><font color="#000080">;
         </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>IsLeapYear<font color="#000080">(</font>Year<font color="#000080">)) </font><font color="#FF0000"><b>then
            </b></font>inc<font color="#000080">(</font>LastDate<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ Feb. }
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ case }

   </i></font>FExprDate <font color="#000080">:= </font>encodeDate<font color="#000080">(</font>year<font color="#000080">, </font>mon<font color="#000080">, </font>lastDate<font color="#000080">);
   </font>theTime <font color="#000080">:= </font>encodeTime<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">, </font><font color="#800000">59</font><font color="#000080">, </font><font color="#800000">59</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
   </font>FExprDate <font color="#000080">:= </font>FExprDate <font color="#000080">+ </font>TheTime<font color="#000080">; </font><font color="#008000"><i>// last minute of the last date of the month
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ TCreditCardVerify.SetCardExprMonYear }

(******************************************************************************
*                             SetExprDateFromStr                              *
* we assume the format MM/YY here                                             *
******************************************************************************)
</i></font><font color="#FF0000"><b>procedure </b></font>TCreditCardVerify<font color="#000080">.</font>SetExprDateFromStr<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>mon<font color="#000080">, </font>year <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
   </font>pSlash <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>pSlash <font color="#000080">:= </font>pos<font color="#000080">(</font><font color="#800000">'/'</font><font color="#000080">, </font>TheStr<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>TheStr<font color="#000080">) = </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      if </b></font><font color="#000080">(</font>pSlash <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
         </b></font>Mon <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
         </font>Year <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font><font color="#800000">3</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font><font color="#FF0000"><b>end else begin
         </b></font>Mon <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>pSlash <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
         </font>Year <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font>pSlash <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>length<font color="#000080">(</font>TheStr<font color="#000080">));
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>end else if </b></font><font color="#000080">(</font>length<font color="#000080">(</font>TheStr<font color="#000080">) = </font><font color="#800000">5</font><font color="#000080">) </font><font color="#FF0000"><b>then begin
      </b></font>mon <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
      </font>year <font color="#000080">:= </font>copy<font color="#000080">(</font>TheStr<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

   </font>year <font color="#000080">:= </font>trim<font color="#000080">(</font>year<font color="#000080">);
   </font>mon <font color="#000080">:= </font>trim<font color="#000080">(</font>mon<font color="#000080">);

   </font>setCardExprMonYear<font color="#000080">(</font>strToInt<font color="#000080">(</font>Mon<font color="#000080">), </font>strToInt<font color="#000080">(</font>Year<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{ SetExprDateFromStr }

(******************************************************************************
*                                    end.                                     *
******************************************************************************)
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0401.PAS">Original</a><b>]</b></p></body>
</html>
