<html>
<head><title> "How to use a popup menu with a VBX" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0109.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Q:  I want to be able to right click on my VBX and have     a
popup menu display.  When I use a popup menu for the form, it
shows no matter where I right click.  I want to just have it
popup for right clicks on the vbx.

How do I trap for that?

A:  Here it is:
}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormMouseDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font>Button<font color="#000080">: </font>TMouseButton<font color="#000080">;
  </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>button <font color="#000080">= </font>mbRight <font color="#FF0000"><b>then
    with </b></font><font color="#000080">(</font>Sender <font color="#FF0000"><b>AS </b></font>TControl<font color="#000080">) </font><font color="#FF0000"><b>do
      with </b></font>ClientToScreen<font color="#000080">(</font>Point<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">)) </font><font color="#FF0000"><b>do
      begin
        </b></font>PopupMenu1<font color="#000080">.</font>PopupComponent <font color="#000080">:= </font>TComponent<font color="#000080">(</font>Sender<font color="#000080">);
        </font>PopupMenu1<font color="#000080">.</font>Popup<font color="#000080">(</font>X<font color="#000080">,</font>Y<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Note<font color="#000080">: </font>The form<font color="#800000">'s PopupMenu property must be empty, or it will popup
</font>from everywhere<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you want the form <font color="#FF0000"><b>to </b></font>be the only place showing
the popup<font color="#000080">, </font>place this method <font color="#FF0000"><b>on </b></font>the form<font color="#800000">'s OnMouseDown event.  If
</font>you want the VBX <font color="#FF0000"><b>to </b></font>be the only place<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>place it <font color="#FF0000"><b>on </b></font>the VBX<font color="#800000">'s
</font>OnMouseDown event<font color="#000080">, </font>etc<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0109.PAS">Original</a><b>]</b></p></body>
</html>
