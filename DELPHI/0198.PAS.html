<html>
<head><title> "Dynamic creation and circularly linking" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0198.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000"> Question<font color="#000080">:  </font>How <font color="#FF0000"><b>do </b></font>I make a simple method <font color="#FF0000"><b>to </b></font>rotate between forms<font color="#000080">?
            </font>How <font color="#FF0000"><b>do </b></font>I add my own return results <font color="#FF0000"><b>to </b></font>a ShowModal form<font color="#000080">?
            </font>How <font color="#FF0000"><b>do </b></font>I instantiate forms at runtime<font color="#000080">?

 </font>Answer<font color="#000080">:  </font>The method required <font color="#FF0000"><b>is </b></font>quite simple <font color="#FF0000"><b>to </b></font>implement<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>my
    example I used <font color="#800000">3 </font>forms<font color="#000080">, </font>the Mainform<font color="#000080">, </font>Form1<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>Form2<font color="#000080">.  </font>I
    placed a button <font color="#FF0000"><b>on </b></font>the Mainform that will bring up Form1<font color="#000080">, </font><font color="#FF0000"><b>then
    </b></font>from that form you could rotate through any number <font color="#FF0000"><b>of </b></font>forms via
    buttons placed <font color="#FF0000"><b>on </b></font>those forms<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>my example<font color="#000080">, </font>only Form1 <font color="#FF0000"><b>and
    </b></font>Form2 can be flipped between<font color="#000080">.

    </font>step <font color="#800000">1. </font>Places these two lines <font color="#FF0000"><b>in </b></font>the <font color="#FF0000"><b>interface </b></font>section <font color="#FF0000"><b>of </b></font>this
       Form<font color="#000080">, </font>which will be refered <font color="#FF0000"><b>to as </b></font>the main form

       <font color="#FF0000"><b>const
         </b></font>mrNext <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;
         </font>mrPrevious <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;

    </font>step <font color="#800000">2. </font><font color="#FF0000"><b>On </b></font>the main form add a button <font color="#FF0000"><b>and </b></font>add the following block
        <font color="#FF0000"><b>of </b></font>code into it<font color="#000080">.

       </font><font color="#FF0000"><b>var
         </b></font>MyForm<font color="#000080">: </font>TForm<font color="#000080">;
         </font>R<font color="#000080">, </font>CurForm<font color="#000080">: </font>Integer<font color="#000080">;
       </font><font color="#FF0000"><b>begin
          </b></font>R <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
          </font>CurForm <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font><font color="#FF0000"><b>while </b></font>R <font color="#000080">&lt;&gt; </font>mrCancel <font color="#FF0000"><b>do begin
            Case </b></font>CurForm <font color="#FF0000"><b>of
              </b></font><font color="#800000">1</font><font color="#000080">: </font>MyForm <font color="#000080">:= </font>TForm1<font color="#000080">.</font>Create<font color="#000080">(</font>Application<font color="#000080">);
              </font><font color="#800000">2</font><font color="#000080">: </font>MyForm <font color="#000080">:= </font>TForm2<font color="#000080">.</font>Create<font color="#000080">(</font>Application<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>try
              </b></font>R <font color="#000080">:= </font>MyForm<font color="#000080">.</font>ShowModal<font color="#000080">;
            </font><font color="#FF0000"><b>finally
              </b></font>MyForm<font color="#000080">.</font>Free<font color="#000080">;
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
            </font><font color="#FF0000"><b>case </b></font>R <font color="#FF0000"><b>of
              </b></font>MrNext <font color="#000080">: </font>Inc<font color="#000080">(</font>CurForm<font color="#000080">);
              </font>MrPrevious <font color="#000080">: </font>Dec<font color="#000080">(</font>CurForm<font color="#000080">);
            </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
                </font><font color="#008000"><i>// these 2 lines will make sure we don't go out of bounds
            </i></font><font color="#FF0000"><b>if </b></font>CurForm <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>CurForm <font color="#000080">:= </font><font color="#800000">2
            </font><font color="#FF0000"><b>else if </b></font>CurForm <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>CurForm <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>// while
         </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>step <font color="#800000">3. </font>Add forms <font color="#800000">1 </font><font color="#FF0000"><b>and </b></font><font color="#800000">2 </font><font color="#000080">(</font><font color="#FF0000"><b>and </b></font>any others you are going <font color="#FF0000"><b>to </b></font>have<font color="#000080">)
        </font><font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>uses </b></font>statement <font color="#FF0000"><b>for </b></font>the MainForm<font color="#000080">.

    </font>step <font color="#800000">4. </font><font color="#FF0000"><b>On </b></font>Form1 <font color="#FF0000"><b>and </b></font>Form2 add the MainForm <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>uses </b></font><font color="#000080">(</font>so they
        can see the constants<font color="#000080">.

    </font>step <font color="#800000">5. </font><font color="#FF0000"><b>On </b></font>Form1<font color="#000080">, </font>Form2 <font color="#FF0000"><b>and </b></font>all subsequent forms add <font color="#800000">2 </font>TBitBtn<font color="#800000">'s,
        </font>labeled Next <font color="#FF0000"><b>and </b></font>Previous<font color="#000080">.  </font><font color="#FF0000"><b>In </b></font>the OnClick Events <font color="#FF0000"><b>for </b></font>these buttons
        add the following line <font color="#FF0000"><b>of </b></font>code<font color="#000080">.
          </font><font color="#FF0000"><b>If </b></font>it<font color="#800000">'s a Next Button add :  ModalResult := mrNext;
          </font><font color="#FF0000"><b>If </b></font>it<font color="#800000">'s a Previous Button add :  ModalResult := mrPrevious;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0198.PAS">Original</a><b>]</b></p></body>
</html>
