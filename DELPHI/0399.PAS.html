<html>
<head><title> "Rotating textout" by SEAN MATHEWS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0399.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Have a look at the <font color="#FF0000"><b>procedure </b></font>now<font color="#000080">, </font>Should give you some clues<font color="#000080">...
</font>You have <font color="#FF0000"><b>to </b></font>be sure <font color="#FF0000"><b>of </b></font>two things
<font color="#800000">1. </font>You are using a True <font color="#FF0000"><b>Type </b></font>Font<font color="#000080">.
</font><font color="#800000">2. </font><font color="#FF0000"><b>If </b></font>you use an TImage<font color="#000080">, </font>you <font color="#FF0000"><b>set </b></font>the font <font color="#FF0000"><b>of </b></font>the Image CANVAS first<font color="#000080">.

</font>Sean

<font color="#000080">----------
</font><font color="#FF0000"><b>procedure </b></font>DC_TextOut<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>angle<font color="#000080">,</font>size<font color="#000080">:</font>integer<font color="#000080">;</font>txt<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>hfont<font color="#000080">, </font>fontold      <font color="#000080">: </font>integer<font color="#000080">;
    </font>dc                          <font color="#000080">: </font>hdc<font color="#000080">;
    </font>fontname                    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
</b></font>Image1<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'Arial'</font><font color="#000080">;
</font><font color="#FF0000"><b>if </b></font>length<font color="#000080">(</font>txt<font color="#000080">)= </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
     </font>dc <font color="#000080">:= </font>Image1<font color="#000080">.</font>Canvas<font color="#000080">.</font>handle<font color="#000080">;  (</font>Here <font color="#000080">??? </font>handle from component <font color="#FF0000"><b>not </b></font>from
activeform<font color="#000080">)
     </font>SetBkMode<font color="#000080">(</font>dc<font color="#000080">,</font>transparent<font color="#000080">);
     </font>fontname <font color="#000080">:= </font>Image1<font color="#000080">.</font>Canvas<font color="#000080">.</font>font<font color="#000080">.</font>name<font color="#000080">;  (</font>Here <font color="#000080">??? </font>handle from component
<font color="#FF0000"><b>not </b></font>from activeform<font color="#000080">)
     </font>hfont   <font color="#000080">:=
</font>CreateFont<font color="#000080">(-</font>size<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>angle<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>fw_normal<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">$10</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">,</font>PChar<font color="#000080">(</font>fontname<font color="#000080">));
     </font>fontold <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>dc<font color="#000080">,</font>hfont<font color="#000080">);
     </font>TextOut<font color="#000080">(</font>dc<font color="#000080">,</font>x<font color="#000080">,</font>y<font color="#000080">,</font>PChar<font color="#000080">(</font>txt<font color="#000080">),</font>length<font color="#000080">(</font>txt<font color="#000080">));
     </font>SelectObject<font color="#000080">(</font>dc<font color="#000080">, </font>fontold<font color="#000080">);
     </font>DeleteObject<font color="#000080">(</font>hfont<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0399.PAS">Original</a><b>]</b></p></body>
</html>
