<html>
<head><title> "Double Linked Lists" by JEFF ATWOOD</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0166.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>Tlink<font color="#000080">;
</font><font color="#008000"><i>{ TLink unit: doubly linked lists 5/22/95}
{ by Jeff Atwood, JAtwood159@AOL.COM. }
{ }
{ This unit can be used for stacks, deques, and free lists too.  }
{ }
{ I couldn't find a doubly-linked list implemented as an object ANYWHERE }
{ so I wrote it myself, after much trial, error, and poring over         }
{ obscure programming reference books. Hey-- it's not brain surgery, but }
{ pointers can be so naughty. }
{ }
{ For simplicity's sake, and to keep this a one-day project, I am only    }
{ storing simple integers in the cells. You can easily, easily change     }
{ that to any data type supported by Delphi including records. I would    }
{ NOT recommend trying to store a whole object with methods in there...   }
{ I couldn't get that to work. But if you can, E-Mail me. I don't know if }
{ it's even possible. }
{ }
{ There is one main object, which uses the &quot;CELL&quot; record type for each    }
{ entry in the list. I don't know how to hide the CELL record type from   }
{ the user, but it should be internal to this unit. The main object is    }
{ the TLink, which keeps track of the size, first, last, and current      }
{ cell records. You can move around in the list by using the Move methods }
{ and find using the Seek method. It's all fairly straightforward, look   }
{ at the demo form for examples, there are also comments in the code.     }
{ }
{ If you're feeling ambitious, I recommend you modify the cell record to  }
{ store pointers instead of integers. Don't forget to make copies of the  }
{ data, because if you point to the actual location, you're screwed when  }
{ the user destroys that instance. You gotta copy it... How many times    }
{ did I get burned by THAT one?? Also, it would be cool to turn this into }
{ a VCL component, if anyone wants to do that. }
{ }
{ This code is freeware. Please E-Mail me any cool additions, bug fixes,  }
{ rants, raves, etc. at JAtwood159@AOL.COM! Thanks for trying my code, I  }
{ hope it helps someone... }
</i></font><font color="#FF0000"><b>interface
type
  </b></font>CellPtr <font color="#000080">= ^</font>Cell<font color="#000080">;
  </font>Cell <font color="#000080">= </font><font color="#FF0000"><b>record
    </b></font>data<font color="#000080">: </font>Integer<font color="#000080">;
    </font>next<font color="#000080">: </font>CellPtr<font color="#000080">;
    </font>prev<font color="#000080">: </font>CellPtr<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>TList <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TObject<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>top<font color="#000080">: </font>CellPtr<font color="#000080">;
    </font>bottom<font color="#000080">: </font>CellPtr<font color="#000080">;
    </font>current<font color="#000080">: </font>CellPtr<font color="#000080">;
    </font>size<font color="#000080">: </font>Longint<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor </b></font>create<font color="#000080">;
    </font><font color="#FF0000"><b>destructor </b></font>destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>IsEmpty<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetSize<font color="#000080">: </font>Longint<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>InsertBottom<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>InsertTop<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>InsertCurrent<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>FindFirst<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>absLoc<font color="#000080">: </font>longint<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>Delete<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>MoveFirst<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>MoveLast<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>MoveNext<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>MovePrevious<font color="#000080">: </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>Seek<font color="#000080">(</font>absLoc<font color="#000080">: </font>longint<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>item<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{ set up the TList object with default values }
</i></font><font color="#FF0000"><b>constructor </b></font>TList<font color="#000080">.</font>create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>create<font color="#000080">;
  </font>top <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>bottom <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>current <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>size <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ destroy the entire list, cell by cell }
</i></font><font color="#FF0000"><b>destructor </b></font>TList<font color="#000080">.</font>destroy<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>curCell<font color="#000080">: </font>CellPtr<font color="#000080">;
  </font>nextCell<font color="#000080">: </font>CellPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>curCell <font color="#000080">:= </font>top<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font><font color="#000080">(</font>curCell <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>nextCell <font color="#000080">:= </font>curCell<font color="#000080">^.</font>next<font color="#000080">;
    </font>freemem<font color="#000080">(</font>curCell<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Cell<font color="#000080">));
    </font>curCell <font color="#000080">:= </font>nextCell<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>top <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>bottom <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>current <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ returns true if the list has no cells }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>isEmpty<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= (</font>size <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ returns number of cells in list }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>getSize<font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>size<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ insert cell at bottom of list }
</i></font><font color="#FF0000"><b>procedure </b></font>TList<font color="#000080">.</font>InsertBottom<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>newCell<font color="#000080">: </font>CellPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetMem<font color="#000080">(</font>newCell<font color="#000080">, </font>Sizeof<font color="#000080">(</font>Cell<font color="#000080">));
  </font>newCell<font color="#000080">^.</font>data <font color="#000080">:= </font>item<font color="#000080">;
  </font>newCell<font color="#000080">^.</font>prev <font color="#000080">:= </font>bottom<font color="#000080">;
  </font>newCell<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ special case: this is first cell added }
  </i></font><font color="#FF0000"><b>if </b></font>bottom <font color="#000080">= </font><font color="#FF0000"><b>nil then
    </b></font>top <font color="#000080">:= </font>newCell
  <font color="#FF0000"><b>else
    </b></font>bottom<font color="#000080">^.</font>next <font color="#000080">:= </font>newCell<font color="#000080">;
  </font>bottom <font color="#000080">:= </font>newCell<font color="#000080">;
  </font>size <font color="#000080">:= </font>size <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ insert cell at top of list }
</i></font><font color="#FF0000"><b>procedure </b></font>TList<font color="#000080">.</font>InsertTop<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>newCell<font color="#000080">: </font>CellPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetMem<font color="#000080">(</font>newCell<font color="#000080">, </font>Sizeof<font color="#000080">(</font>Cell<font color="#000080">));
  </font>newCell<font color="#000080">^.</font>data <font color="#000080">:= </font>item<font color="#000080">;
  </font>newCell<font color="#000080">^.</font>prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>newCell<font color="#000080">^.</font>next <font color="#000080">:= </font>top<font color="#000080">;
  </font><font color="#008000"><i>{ special case: this is first cell added }
  </i></font><font color="#FF0000"><b>if </b></font>top <font color="#000080">= </font><font color="#FF0000"><b>nil then
    </b></font>bottom <font color="#000080">:= </font>newCell
  <font color="#FF0000"><b>else
    </b></font>top<font color="#000080">^.</font>prev <font color="#000080">:= </font>newCell<font color="#000080">;
  </font>top <font color="#000080">:= </font>newCell<font color="#000080">;
  </font>size <font color="#000080">:= </font>size <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ insert cell after current item }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>InsertCurrent<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>newCell<font color="#000080">: </font>CellPtr<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>current <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>GetMem<font color="#000080">(</font>newCell<font color="#000080">, </font>Sizeof<font color="#000080">(</font>Cell<font color="#000080">));
    </font>newCell<font color="#000080">^.</font>data <font color="#000080">:= </font>item<font color="#000080">;
    </font>newCell<font color="#000080">^.</font>prev <font color="#000080">:= </font>current<font color="#000080">;
    </font>newCell<font color="#000080">^.</font>next <font color="#000080">:= </font>current<font color="#000080">^.</font>next<font color="#000080">;
    </font><font color="#008000"><i>{ special case: current cell is last cell }
    </i></font><font color="#FF0000"><b>if </b></font>current<font color="#000080">^.</font>next <font color="#000080">= </font><font color="#FF0000"><b>nil then
      </b></font>bottom <font color="#000080">:= </font>newCell
    <font color="#FF0000"><b>else
      </b></font>current<font color="#000080">^.</font>next<font color="#000080">^.</font>prev <font color="#000080">:= </font>newCell<font color="#000080">;
    </font>current<font color="#000080">^.</font>next <font color="#000080">:= </font>newCell<font color="#000080">;
    </font>size <font color="#000080">:= </font>size <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ Look for item in data field. Starts at top of list }
{ and looks at every item until a match is found.    }
{ if found, makes matched cell current, and returns  }
{ absolute location of match where 1 = top.          }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>FindFirst<font color="#000080">(</font>item<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>absLoc<font color="#000080">: </font>longint<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>curCell<font color="#000080">: </font>CellPtr<font color="#000080">;
  </font>cnt<font color="#000080">: </font>longInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>False<font color="#000080">;
  </font>curCell <font color="#000080">:= </font>top<font color="#000080">;
  </font>cnt <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>absLoc <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font><font color="#000080">(</font>curCell <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>cnt <font color="#000080">:= </font>cnt <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>curCell<font color="#000080">^.</font>Data <font color="#000080">= </font>item <font color="#FF0000"><b>then begin
      </b></font>absLoc <font color="#000080">:= </font>cnt<font color="#000080">;
      </font>current <font color="#000080">:= </font>curCell<font color="#000080">;
      </font>result <font color="#000080">:= </font>True<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>curCell <font color="#000080">:= </font>curCell<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ delete the current cell }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>Delete<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>label
  </b></font>exitDelete<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ we can only delete the current record }
  </i></font><font color="#FF0000"><b>if </b></font>current <font color="#000080">= </font><font color="#FF0000"><b>nil then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font><font color="#008000"><i>{ see if list has one item }
    </i></font><font color="#FF0000"><b>if </b></font>size <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then begin
      </b></font>top <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font>bottom <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>goto </b></font>exitDelete<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ see if we're at the top of list }
    </i></font><font color="#FF0000"><b>if </b></font>current<font color="#000080">^.</font>prev <font color="#000080">= </font><font color="#FF0000"><b>nil then begin
      </b></font>top <font color="#000080">:= </font>current<font color="#000080">^.</font>next<font color="#000080">;
      </font>top<font color="#000080">^.</font>prev <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>goto </b></font>exitDelete<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ see if we're at the bottom of list }
    </i></font><font color="#FF0000"><b>if </b></font>current<font color="#000080">^.</font>next <font color="#000080">= </font><font color="#FF0000"><b>nil then begin
      </b></font>bottom <font color="#000080">:= </font>current<font color="#000080">^.</font>prev<font color="#000080">;
      </font>bottom<font color="#000080">^.</font>next <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>goto </b></font>exitDelete<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ we must be in middle of list of size &gt; 1 }
    </i></font>current<font color="#000080">^.</font>prev<font color="#000080">^.</font>next <font color="#000080">:= </font>current<font color="#000080">^.</font>next<font color="#000080">;
    </font>current<font color="#000080">^.</font>next<font color="#000080">^.</font>prev <font color="#000080">:= </font>current<font color="#000080">^.</font>prev<font color="#000080">;
    </font><font color="#FF0000"><b>goto </b></font>exitDelete<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ arrgh-- a goto! but this is a textbook goto! }
  </i></font>exitDelete<font color="#000080">: </font><font color="#FF0000"><b>begin
                </b></font>result <font color="#000080">:= </font>True<font color="#000080">;
                </font>freemem<font color="#000080">(</font>current<font color="#000080">, </font>SizeOf<font color="#000080">(</font>Cell<font color="#000080">));
                </font>current <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
                </font>size <font color="#000080">:= </font>size <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
                </font><font color="#FF0000"><b>if </b></font>size <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
                  </b></font>top <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
                  </font>bottom <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
                </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
              </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ make first value in list current }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>MoveFirst<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>top <font color="#000080">= </font><font color="#FF0000"><b>nil then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>current <font color="#000080">:= </font>top<font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ make last value in list current }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>MoveLast<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>bottom <font color="#000080">= </font><font color="#FF0000"><b>nil then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>current <font color="#000080">:= </font>bottom<font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ make next value in list current }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>MoveNext<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>current <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>current<font color="#000080">^.</font>next <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>current <font color="#000080">:= </font>current<font color="#000080">^.</font>next<font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ make previous value in list current }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>MovePrevious<font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>current <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>current<font color="#000080">^.</font>prev <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>current <font color="#000080">:= </font>current<font color="#000080">^.</font>prev<font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ return data item from current list position }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>GetData<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>item<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>current <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else begin
    </b></font>item <font color="#000080">:= </font>current<font color="#000080">^.</font>data<font color="#000080">;
    </font>result <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{ make current the absolute cell N in the list }
{ where top = 1 }
</i></font><font color="#FF0000"><b>function </b></font>TList<font color="#000080">.</font>Seek<font color="#000080">(</font>absloc<font color="#000080">: </font>longint<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>curCell<font color="#000080">: </font>CellPtr<font color="#000080">;
  </font>cnt<font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>absloc <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>exit<font color="#000080">;
  </font>curCell <font color="#000080">:= </font>top<font color="#000080">;
  </font><font color="#FF0000"><b>while not </b></font><font color="#000080">(</font>curCell <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>cnt <font color="#000080">:= </font>cnt <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>cnt <font color="#000080">= </font>absloc <font color="#FF0000"><b>then begin
      </b></font>current <font color="#000080">:= </font>curCell<font color="#000080">;
      </font>result <font color="#000080">:= </font>True<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>curCell <font color="#000080">:= </font>curCell<font color="#000080">^.</font>next<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0166.PAS">Original</a><b>]</b></p></body>
</html>
