<html>
<head><title> "When was that file last accessed?" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0259.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">http<font color="#000080">:</font><font color="#008000"><i>//www.chami.com/
</i></font>When was that <font color="#FF0000"><b>file </b></font>last accessed<font color="#000080">?

--------------------------------------------------------------------------------
</font>Here<font color="#800000">'s an example of how to write a function that'</font>ll return a <font color="#FF0000"><b>file</b></font><font color="#800000">'s last
</font>access time <font color="#000080">(</font><font color="#FF0000"><b>not to </b></font>be confused <font color="#FF0000"><b>with </b></font>the last modified time<font color="#000080">).

</font><font color="#FF0000"><b>function </b></font>GetFileLastAccessTime<font color="#000080">(
  </font>sFileName <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">) : </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>ffd <font color="#000080">: </font>TWin32FindData<font color="#000080">;
  </font>dft <font color="#000080">: </font>DWord<font color="#000080">;
  </font>lft <font color="#000080">: </font>TFileTime<font color="#000080">;
  </font>h   <font color="#000080">: </font>THandle<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>//
  // get file information
  </i></font>h <font color="#000080">:= </font>Windows<font color="#000080">.</font>FindFirstFile<font color="#000080">(
         </font>PChar<font color="#000080">(</font>sFileName<font color="#000080">), </font>ffd<font color="#000080">);
  </font><font color="#FF0000"><b>if</b></font><font color="#000080">(</font>INVALID_HANDLE_VALUE <font color="#000080">&lt;&gt; </font>h<font color="#000080">)</font><font color="#FF0000"><b>then
  begin
    </b></font><font color="#008000"><i>//
    // we're looking for just one file,
    // so close our &quot;find&quot;
    </i></font>Windows<font color="#000080">.</font>FindClose<font color="#000080">( </font>h <font color="#000080">);
    </font><font color="#008000"><i>//
    // convert the FILETIME to
    // local FILETIME
    </i></font>FileTimeToLocalFileTime<font color="#000080">(
      </font>ffd<font color="#000080">.</font>ftLastAccessTime<font color="#000080">, </font>lft <font color="#000080">);
    </font><font color="#008000"><i>//
    // convert FILETIME to
    // DOS time
    </i></font>FileTimeToDosDateTime<font color="#000080">(</font>lft<font color="#000080">,
    </font>LongRec<font color="#000080">(</font>dft<font color="#000080">).</font>Hi<font color="#000080">, </font>LongRec<font color="#000080">(</font>dft<font color="#000080">).</font>Lo<font color="#000080">);
    </font><font color="#008000"><i>//
    // finally, convert DOS time to
    // TDateTime for use in Delphi's
    // native date/time functions
    </i></font>Result <font color="#000080">:= </font>FileDateToDateTime<font color="#000080">(</font>dft<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


&quot;</font>GetFileLastAccessTime<font color="#000080">()&quot; </font>will simply return the <font color="#FF0000"><b>file</b></font><font color="#800000">'s last access time
</font><font color="#FF0000"><b>as </b></font>a Delphi<font color="#800000">'s TDateTime type which you can convert to a string by using
</font>the <font color="#000080">&quot;</font>DateTimeToStr<font color="#000080">()&quot; </font><font color="#FF0000"><b>function</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0259.PAS">Original</a><b>]</b></p></body>
</html>
