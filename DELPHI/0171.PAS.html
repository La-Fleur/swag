<html>
<head><title> "Indespensible Components for DELPHI" by STEFAN BöTHER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0171.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{*******************************************************}
{                                                       }
{       xTool - Component Collection                    }
{                                                       }
{       Copyright (c) 1995 Stefan B&ouml;ther                }
{                            stefc@fabula.com           }
{*******************************************************}
{
  Please look also for our xTools-Nails function toolkit.
  More information you'll find under
    http://ourworld.compuserve.com/homepages/stefc/xprocs.htm

  Any comments and enhancements are welcome, if the're
  sended to  stefc@fabula.com.

   21.02.96  added TMonth &amp; TDay type                                Stefc
   22.02.96  added strFileLoad &amp; strFileSave                         Stefc
   09.03.96  correct sysTempPath                                     Stefc
   09.03.96  added regXXXXX functions for access the registry        Stefc
   24.03.96  added IsWinNT constant                                  Stefc
   24.03.96  added SysMetric object                                  Stefc
   26.03.96  added dateQuicken for controling date input with keys   Stefc
   27.03.96  added TDesktopCanvas here                               Stefc
   28.03.96  added LoadDIBitmap                                      Stefc
   01.04.96  added Question function here                            Stefc
   09.04.96  added sysSaverRunning added                             Stefc
   12.04.96  added timeZoneOffset                                    Stefc
   12.04.96  added timeToInt                                         Stefc
   17.04.96  added strCmdLine                                        Stefc
   17.04.96  added rectBounds                                        Stefc
   17.04.96  added TPersistentRect class                             Stefc
   19.04.96  added strDebug method                                   Stefc
   21.04.96  changed TMonth added noneMonth                          km
   21.04.96  added licence callback                                  Stefc
   21.04.96  added strNiceDateDefault                                km
   21.04.96  added simple strEncrpyt &amp; strDecrypt                    Stefc
   24.04.96  backport to 16 bit                                      Stefc
   24.04.96  added Information method                                Stefc
   24.04.96  use win messageBox with Win95 in Question &amp; Information Stefc
   09.05.96  new function ExtractName                                Stefc
   10.05.96  Added TPersistentRegistry                               Stefc
   12.05.96  fileExec                                                Stefc
   14.05.96  New function Confirmation                               Stefc
   16.05.96  New function strChange                                  Stefc
   29.05.96  New functions comXXXXX                                  Stefc
   09.06.96  New function strSearchReplace                           km
   09.06.96  ported assembler strHash to plain pascal                Stefc
   15.06.96  new variables xLanguage &amp; xLangOfs                      Stefc
   28.06.96  new method sysBeep                                      Stefc
   28.06.96  new method intPercent                                   Stefc
   10.07.96  make compatible with 16 Bit Delphi 1.0                  Stefc
   14.07.96  fileLongName &amp; fileShortName defined                    Stefc
   15.07.96  Correct sysTempPath method                              Stefc
   21.07.96  New functions strContains &amp; strContainsU                Stefc
   28.07.96  comIsCServe also check for xxx@compuServe.com           Stefc
   31.07.96  added strCapitalize after idea from Fred N. Read        Stefc
   04.08.96  strByteSize() now can also display Bytes                Stefc
   05.08.96  added regWriteShellExt()                                Stefc
   06.08.96  added sysColorDepth()                                   Stefc
   07.08.96  added strSoundex()                                      Stefc
}
</i></font><font color="#FF0000"><b>unit </b></font>xProcs<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
 </b></font><font color="#008000"><i>{$IFDEF Win32} </i></font>Windows<font color="#000080">, </font>Registry<font color="#000080">, </font>ShellAPI<font color="#000080">, </font><font color="#008000"><i>{$ELSE} </i></font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font><font color="#008000"><i>{$ENDIF}
  </i></font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>Float <font color="#000080">= </font>Extended<font color="#000080">;    </font><font color="#008000"><i>{ our type for float arithmetic }

 {$IFDEF Win32}        { our type for integer functions, Int_ is ever 32 bit }
  </i></font>Int_  <font color="#000080">= </font>Integer<font color="#000080">;
 </font><font color="#008000"><i>{$ELSE}
  </i></font>Int_  <font color="#000080">= </font>Longint<font color="#000080">;
 </font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>const
  </b></font>XCOMPANY        <font color="#000080">= </font><font color="#800000">'Fabula Software'</font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font><font color="#008000"><i>{ several important ASCII codes }
  </i></font>NULL            <font color="#000080">=  </font><font color="#800000">#0</font><font color="#000080">;
  </font>BACKSPACE       <font color="#000080">=  </font><font color="#800000">#8</font><font color="#000080">;
  </font>TAB             <font color="#000080">=  </font><font color="#800000">#9</font><font color="#000080">;
  </font>LF              <font color="#000080">= </font><font color="#800000">#10</font><font color="#000080">;
  </font>CR              <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">;
  </font>EOF_            <font color="#000080">= </font><font color="#800000">#26</font><font color="#000080">;    </font><font color="#008000"><i>{ 30.07.96 sb }
  </i></font>ESC             <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">;
  </font>BLANK           <font color="#000080">= </font><font color="#800000">#32</font><font color="#000080">;
  </font>SPACE           <font color="#000080">= </font>BLANK<font color="#000080">;

  </font><font color="#008000"><i>{ digits as chars }
  </i></font>ZERO   <font color="#000080">= </font><font color="#800000">'0'</font><font color="#000080">;  </font>ONE  <font color="#000080">= </font><font color="#800000">'1'</font><font color="#000080">;  </font>TWO    <font color="#000080">= </font><font color="#800000">'2'</font><font color="#000080">;  </font>THREE  <font color="#000080">= </font><font color="#800000">'3'</font><font color="#000080">;  </font>FOUR  <font color="#000080">= </font><font color="#800000">'4'</font><font color="#000080">;
  </font>FIVE   <font color="#000080">= </font><font color="#800000">'5'</font><font color="#000080">;  </font>SIX  <font color="#000080">= </font><font color="#800000">'6'</font><font color="#000080">;  </font>SEVEN  <font color="#000080">= </font><font color="#800000">'7'</font><font color="#000080">;  </font>EIGHT  <font color="#000080">= </font><font color="#800000">'8'</font><font color="#000080">;  </font>NINE  <font color="#000080">= </font><font color="#800000">'9'</font><font color="#000080">;

  </font><font color="#008000"><i>{ special codes }
  </i></font>SLASH           <font color="#000080">= </font><font color="#800000">'\'</font><font color="#000080">;     </font><font color="#008000"><i>{ used in filenames }
  </i></font>HEX_PREFIX      <font color="#000080">= </font><font color="#800000">'$'</font><font color="#000080">;     </font><font color="#008000"><i>{ prefix for hexnumbers }

  </i></font>CRLF            <font color="#000080">: </font>PChar <font color="#000080">= </font>CR<font color="#000080">+</font>LF<font color="#000080">;

  </font><font color="#008000"><i>{ common computer sizes }
  </i></font>KBYTE           <font color="#000080">= </font>Sizeof<font color="#000080">(</font>Byte<font color="#000080">) </font><font color="#FF0000"><b>shl </b></font><font color="#800000">10</font><font color="#000080">;
  </font>MBYTE           <font color="#000080">= </font>KBYTE        <font color="#FF0000"><b>shl </b></font><font color="#800000">10</font><font color="#000080">;
  </font>GBYTE           <font color="#000080">= </font>MBYTE        <font color="#FF0000"><b>shl </b></font><font color="#800000">10</font><font color="#000080">;

  </font><font color="#008000"><i>{ Low floating point value }
  </i></font>FLTZERO         <font color="#000080">: </font>Float <font color="#000080">= </font><font color="#800000">0.00000001</font><font color="#000080">;


  </font>DIGITS          <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>Char <font color="#000080">= [</font>ZERO<font color="#000080">..</font>NINE<font color="#000080">];

  </font><font color="#008000"><i>{ important registry keys / items }
  </i></font>REG_CURRENT_VERSION <font color="#000080">= </font><font color="#800000">'Software\Microsoft\Windows\CurrentVersion'</font><font color="#000080">;
  </font>REG_CURRENT_USER    <font color="#000080">= </font><font color="#800000">'RegisteredOwner'</font><font color="#000080">;
  </font>REG_CURRENT_COMPANY <font color="#000080">= </font><font color="#800000">'RegisteredOrganization'</font><font color="#000080">;

  </font>PRIME_16       <font color="#000080">= </font><font color="#800000">65521</font><font color="#000080">;
  </font>PRIME_32       <font color="#000080">= </font><font color="#800000">2147483647</font><font color="#000080">;

  </font>MINSHORTINT    <font color="#000080">= -</font><font color="#800000">128</font><font color="#000080">;               </font><font color="#008000"><i>{ 1.8.96 sb }
  </i></font>MAXSHORTINT    <font color="#000080">=  </font><font color="#800000">127</font><font color="#000080">;
  </font>MINBYTE        <font color="#000080">=  </font><font color="#800000">0</font><font color="#000080">;
  </font>MAXBYTE        <font color="#000080">=  </font><font color="#800000">255</font><font color="#000080">;
  </font>MINWORD        <font color="#000080">=  </font><font color="#800000">0</font><font color="#000080">;
  </font>MAXWORD        <font color="#000080">=  </font><font color="#800000">65535</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TMonth        <font color="#000080">= (</font>NoneMonth<font color="#000080">,</font>January<font color="#000080">,</font>February<font color="#000080">,</font>March<font color="#000080">,</font>April<font color="#000080">,</font>May<font color="#000080">,</font>June<font color="#000080">,</font>July<font color="#000080">,
                   </font>August<font color="#000080">,</font>September<font color="#000080">,</font>October<font color="#000080">,</font>November<font color="#000080">,</font>December<font color="#000080">);

  </font>TDayOfWeek    <font color="#000080">= (</font>Sunday<font color="#000080">,</font>Monday<font color="#000080">,</font>Tuesday<font color="#000080">,</font>Wednesday<font color="#000080">,</font>Thursday<font color="#000080">,</font>Friday<font color="#000080">,</font>Saturday<font color="#000080">);

  </font><font color="#008000"><i>{ Online eMail Service Provider }
  </i></font>TMailProvider <font color="#000080">= (</font>mpCServe<font color="#000080">, </font>mpInternet<font color="#000080">, </font>mpNone<font color="#000080">);

  </font>TLicCallback  <font color="#000080">= </font><font color="#FF0000"><b>function </b></font><font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Code<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;

  </font>TBit          <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">;

  </font><font color="#008000"><i>{ Search and Replace options }
  </i></font>TSROption     <font color="#000080">= (</font>srWord<font color="#000080">,</font>srCase<font color="#000080">,</font>srAll<font color="#000080">);
  </font>TSROptions    <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>TsrOption<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>IsWin95<font color="#000080">,
  </font>IsWinNT   <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>IsFabula  <font color="#000080">: </font>TLicCallBack<font color="#000080">;

  </font>xLanguage <font color="#000080">: </font>Integer<font color="#000080">;
  </font>xLangOfs  <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#008000"><i>{ bit manipulating }
</i></font><font color="#FF0000"><b>function </b></font>bitSet<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>bitOn<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>bitOff<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>bitToggle<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;

</font><font color="#008000"><i>{ String functions }
</i></font><font color="#FF0000"><b>function  </b></font>strHash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>LastBucket<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strCut<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTrim<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTrimA<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTrimChA<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTrimChL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTrimChR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strLeft<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strLower<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strMake<font color="#000080">(</font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadChL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadChR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadChC<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadC<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strPadZeroL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>strChange<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>strRight<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strAddSlash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strDelSlash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strSpace<font color="#000080">(</font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strToken<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTokenCount<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strTokenAt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">; </font>At<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strUpper<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strOemAnsi<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strAnsiOem<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strEqual<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strComp<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strCompU<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strContains<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strContainsU<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strNiceNum<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strNiceDateDefault<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">, </font><font color="#FF0000"><b>Default</b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strNiceDate<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strNiceTime<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strNicePhone<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strReplace<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Replace<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strCmdLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strEncrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Key<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strDecrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Key<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strLastCh<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>strStripLast<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>strByteSize<font color="#000080">(</font>Value<font color="#000080">: </font>Longint<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strSoundex<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>strSearchReplace<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Options<font color="#000080">: </font>TSRoptions<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>strProfile<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">, </font>aSection<font color="#000080">, </font>aEntry<font color="#000080">, </font>aDefault<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>strCapitalize<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{ 31.07.96 sb }

{$IFDEF Win32}
</i></font><font color="#FF0000"><b>procedure </b></font>strDebug<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>strFileLoad<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>strFileSave<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">,</font>aString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{$ENDIF}

{ Integer functions }
</i></font><font color="#FF0000"><b>function  </b></font>intCenter<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intMax<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intMin<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intPow<font color="#000080">(</font>Base<font color="#000080">,</font>Expo<font color="#000080">: </font>Integer<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intPow10<font color="#000080">(</font>Exponent<font color="#000080">: </font>Integer<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intSign<font color="#000080">(</font>a<font color="#000080">: </font>Int_<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intZero<font color="#000080">(</font>a<font color="#000080">: </font>Int_<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intPrime<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>intPercent<font color="#000080">(</font>a<font color="#000080">, </font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;

</font><font color="#008000"><i>{ Floatingpoint functions }
</i></font><font color="#FF0000"><b>function  </b></font>fltAdd<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltDiv<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltEqual<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltEqualZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltGreaterZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltLessZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltNeg<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">; </font>Negate<font color="#000080">: </font>Boolean<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltMul<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltRound<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltSub<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltUnEqualZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltCalc<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Expr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fltPower<font color="#000080">(</font>a<font color="#000080">,</font>n<font color="#000080">: </font>Float<font color="#000080">): </font>Float<font color="#000080">;

</font><font color="#008000"><i>{ Rectangle functions from Golden Software }
</i></font><font color="#FF0000"><b>function  </b></font>rectHeight<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectWidth<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>rectGrow<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>Delta<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>rectRelativeMove<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>DX<font color="#000080">, </font>DY<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>rectMoveTo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>rectSet<font color="#000080">(</font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom<font color="#000080">: </font>Integer<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectInclude<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>P<font color="#000080">: </font>TPoint<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectSetPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>TopLeft<font color="#000080">, </font>BottomRight<font color="#000080">: </font>TPoint<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectIntersection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectIsIntersection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectIsValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectsAreValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Arr<font color="#000080">: </font><font color="#FF0000"><b>array of </b></font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectNull<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectIsNull<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectIsSquare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectCentralPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>rectBounds<font color="#000080">(</font>aLeft<font color="#000080">,</font>aTop<font color="#000080">,</font>aWidth<font color="#000080">,</font>aHeight<font color="#000080">: </font>Integer<font color="#000080">): </font>TRect<font color="#000080">;

</font><font color="#008000"><i>{ date functions }
</i></font><font color="#FF0000"><b>function  </b></font>dateYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateDay<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateEndOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateBeginOfMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateEndOfMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateWeekOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateDayOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateDayOfWeek<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDayOfWeek<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateLeapYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateBeginOfQuarter<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateEndOfQuarter<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateBeginOfWeek<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">;</font>Weekday<font color="#000080">: </font>Integer<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateDaysInMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>dateQuicken<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">; </font>Key<font color="#000080">: </font>Char<font color="#000080">): </font>TDateTime<font color="#000080">;

</font><font color="#008000"><i>{ time functions }
</i></font><font color="#FF0000"><b>function  </b></font>timeHour<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>timeMin<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>timeSec<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>timeToInt<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function  </b></font>timeZoneOffset<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{ com Functions }
</i></font><font color="#FF0000"><b>function  </b></font>comIsCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comIsInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comCisToInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comIntToCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comFaxToCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comNormFax<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">,</font>Fax<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comNormPhone<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Phone<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comNormInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">,</font>Int<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>comNormCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">,</font>Cis<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ file functions }
</i></font><font color="#FF0000"><b>procedure </b></font>fileShredder<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>fileSize<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileWildcard<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function  </b></font>fileTemp<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aExt<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileExec<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aCmdLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>aHide<font color="#000080">, </font>aWait<font color="#000080">: </font>Boolean<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileLongName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileShortName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileShellOpen<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>fileShellPrint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>function  </b></font>ExtractName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#008000"><i>{ system functions }
</i></font><font color="#FF0000"><b>function  </b></font>sysTempPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>sysDelay<font color="#000080">(</font>aMs<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>procedure </b></font>sysBeep<font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>sysColorDepth<font color="#000080">: </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{ 06.08.96 sb }

{$IFDEF Win32}
</i></font><font color="#FF0000"><b>procedure </b></font>sysSaverRunning<font color="#000080">(</font>Active<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#008000"><i>{$ENDIF}

{ registry functions }

{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function  </b></font>regReadString<font color="#000080">(</font>aKey<font color="#000080">: </font>hKey<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>regWriteString<font color="#000080">(</font>aKey<font color="#000080">: </font>hKey<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">,</font>Value<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>regInfoString<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>regCurrentUser<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>function  </b></font>regCurrentCompany<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>regWriteShellExt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aExt<font color="#000080">,</font>aCmd<font color="#000080">,</font>aMenu<font color="#000080">,</font>aExec<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{$ENDIF}

{ several functions }
</i></font><font color="#FF0000"><b>function  </b></font>Question<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>Information<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>function  </b></font>Confirmation<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>{ TRect that can be used persistent as property for components }
  </i></font>TUnitConvertEvent <font color="#000080">= </font><font color="#FF0000"><b>function </b></font><font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">;
    </font>Value<font color="#000080">: </font>Integer<font color="#000080">; </font>Get<font color="#000080">: </font>Boolean<font color="#000080">): </font>Integer <font color="#FF0000"><b>of object</b></font><font color="#000080">;

  </font>TPersistentRect <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TPersistent<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FRect      <font color="#000080">: </font>TRect<font color="#000080">;
    </font>FOnConvert <font color="#000080">: </font>TUnitConvertEvent<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetLeft<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetTop<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetHeight<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetWidth<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>function  </b></font>GetLeft<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function  </b></font>GetTop<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function  </b></font>GetHeight<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function  </b></font>GetWidth<font color="#000080">: </font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor </b></font>Create<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Assign<font color="#000080">(</font>Source<font color="#000080">: </font>TPersistent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Rect<font color="#000080">: </font>TRect <font color="#FF0000"><b>read </b></font>FRect<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnConvert<font color="#000080">: </font>TUnitConvertEvent <font color="#FF0000"><b>read </b></font>FOnConvert <font color="#FF0000"><b>write </b></font>FOnConvert<font color="#000080">;
  </font><font color="#FF0000"><b>published
    property </b></font>Left  <font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>GetLeft   <font color="#FF0000"><b>write </b></font>SetLeft<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Top   <font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>GetTop    <font color="#FF0000"><b>write </b></font>SetTop<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Height<font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>GetHeight <font color="#FF0000"><b>write </b></font>SetHeight<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Width <font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>GetWidth  <font color="#FF0000"><b>write </b></font>SetWidth<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
  { Persistent access of components from the registry }
  </i></font>TPersistentRegistry <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TRegistry<font color="#000080">)
  </font><font color="#FF0000"><b>public
    function  </b></font>ReadComponent<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Owner<font color="#000080">, </font>Parent<font color="#000080">: </font>TComponent<font color="#000080">): </font>TComponent<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WriteComponent<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Component<font color="#000080">: </font>TComponent<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF

  { easy access of the system metrics }
  </i></font>TSystemMetric <font color="#000080">= </font><font color="#FF0000"><b>class
  private
    </b></font>FColorDepth<font color="#000080">,
    </font>FMenuHeight<font color="#000080">,
    </font>FCaptionHeight <font color="#000080">: </font>Integer<font color="#000080">;
    </font>FBorder<font color="#000080">,
    </font>FFrame<font color="#000080">,
    </font>FDlgFrame<font color="#000080">,
    </font>FBitmap<font color="#000080">,
    </font>FHScroll<font color="#000080">,
    </font>FVScroll<font color="#000080">,
    </font>FThumb<font color="#000080">,
    </font>FFullScreen<font color="#000080">,
    </font>FMin<font color="#000080">,
    </font>FMinTrack<font color="#000080">,
    </font>FCursor<font color="#000080">,
    </font>FIcon<font color="#000080">,
    </font>FDoubleClick<font color="#000080">,
    </font>FIconSpacing <font color="#000080">: </font>TPoint<font color="#000080">;
  </font><font color="#FF0000"><b>protected
    constructor </b></font>Create<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Update<font color="#000080">;
  </font><font color="#FF0000"><b>public
    property </b></font>MenuHeight<font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>FMenuHeight<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>CaptionHeight<font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>FCaptionHeight<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Border<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FBorder<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Frame<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FFrame<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>DlgFrame<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FDlgFrame<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Bitmap<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FBitmap<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>HScroll<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FHScroll<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>VScroll<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FVScroll<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Thumb<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FThumb<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>FullScreen<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FFullScreen<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Min<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FMin<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>MinTrack<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FMinTrack<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Cursor<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FCursor<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Icon<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FIcon<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>DoubleClick<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FDoubleClick<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>IconSpacing<font color="#000080">: </font>TPoint <font color="#FF0000"><b>read </b></font>FIconSpacing<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ColorDepth<font color="#000080">: </font>Integer <font color="#FF0000"><b>read </b></font>FColorDepth<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>SysMetric<font color="#000080">: </font>TSystemMetric<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TDesktopCanvas <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TCanvas<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>DC           <font color="#000080">: </font>hDC<font color="#000080">;
  </font><font color="#FF0000"><b>public
    constructor  </b></font>Create<font color="#000080">;
    </font><font color="#FF0000"><b>destructor   </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

uses
  </b></font>SysUtils<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Consts<font color="#000080">, </font>Dialogs<font color="#000080">;

</font><font color="#008000"><i>{ bit manipulating }
</i></font><font color="#FF0000"><b>function </b></font>bitSet<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:= (</font>Value <font color="#FF0000"><b>and </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>TheBit<font color="#000080">)) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>bitOn<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>Value <font color="#FF0000"><b>or </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>TheBit<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>bitOff<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>Value <font color="#FF0000"><b>and </b></font><font color="#000080">((</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>TheBit<font color="#000080">) </font><font color="#FF0000"><b>xor </b></font><font color="#800000">$FFFFFFFF</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>bitToggle<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font>Int_<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>TheBit<font color="#000080">: </font>TBit<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>Value <font color="#FF0000"><b>xor </b></font><font color="#000080">(</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font>TheBit<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ string methods }

</i></font><font color="#FF0000"><b>function </b></font>strHash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>LastBucket<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Result <font color="#000080">:= ((</font>Result <font color="#FF0000"><b>shl </b></font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>xor </b></font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>i<font color="#000080">])) </font><font color="#FF0000"><b>mod </b></font>LastBucket<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTrim<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>StrTrimChR<font color="#000080">(</font>StrTrimChL<font color="#000080">(</font>S<font color="#000080">,</font>BLANK<font color="#000080">),</font>BLANK<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTrimA<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>StrTrimChA<font color="#000080">(</font>S<font color="#000080">,</font>BLANK<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTrimChA<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I               <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>I<font color="#000080">:=</font>Length<font color="#000080">(</font>Result<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font>Result<font color="#000080">[</font>I<font color="#000080">]=</font>C <font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font>I<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTrimChL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Result<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]=</font>C<font color="#000080">) </font><font color="#FF0000"><b>do </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTrimChR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>Result<font color="#000080">)&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>Length<font color="#000080">(</font>Result<font color="#000080">)]=</font>C<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>Result<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strLeft<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strLower<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>AnsiLowerCase<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strMake<font color="#000080">(</font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadChL<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>C<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadChL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Length<font color="#000080">(</font>Result<font color="#000080">)&lt;</font>Len <font color="#FF0000"><b>do </b></font>Result<font color="#000080">:=</font>C<font color="#000080">+</font>Result<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadChR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Length<font color="#000080">(</font>Result<font color="#000080">)&lt;</font>Len <font color="#FF0000"><b>do </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>C<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadChC<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>Length<font color="#000080">(</font>Result<font color="#000080">)&lt;</font>Len <font color="#FF0000"><b>do
  begin
    </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>C<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>Length<font color="#000080">(</font>Result<font color="#000080">)&lt;</font>Len <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>C<font color="#000080">+</font>Result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadChL<font color="#000080">(</font>S<font color="#000080">,</font>BLANK<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadC<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadChC<font color="#000080">(</font>S<font color="#000080">,</font>BLANK<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>function </b></font>strPadR<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadChR<font color="#000080">(</font>S<font color="#000080">,</font>BLANK<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strPadZeroL<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadChL<font color="#000080">(</font>strTrim<font color="#000080">(</font>S<font color="#000080">),</font>ZERO<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strCut<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strLeft<font color="#000080">(</font>strPadR<font color="#000080">(</font>S<font color="#000080">,</font>Len<font color="#000080">),</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strRight<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Len<font color="#000080">&gt;=</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>S
  <font color="#FF0000"><b>else
    </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font>Succ<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">))-</font>Len<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strAddSlash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>strLastCh<font color="#000080">(</font>Result<font color="#000080">)&lt;&gt;</font>SLASH <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>SLASH<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strDelSlash<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>strLastCh<font color="#000080">(</font>Result<font color="#000080">)=</font>SLASH <font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>Result<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strSpace<font color="#000080">(</font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>StrMake<font color="#000080">(</font>BLANK<font color="#000080">,</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strToken<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I               <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>I<font color="#000080">:=</font>Pos<font color="#000080">(</font>Seperator<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>I<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Result<font color="#000080">:=</font>System<font color="#000080">.</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>System<font color="#000080">.</font>Delete<font color="#000080">(</font>S<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>I<font color="#000080">);
  </font><font color="#FF0000"><b>end else
  begin
    </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
    </font>S<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTokenCount<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>StrToken<font color="#000080">(</font>S<font color="#000080">,</font>Seperator<font color="#000080">)&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>do </b></font>Inc<font color="#000080">(</font>Result<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strTokenAt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Seperator<font color="#000080">: </font>Char<font color="#000080">; </font>At<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>j<font color="#000080">,</font>i<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>At <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>j<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>do
  begin
    if </b></font>S<font color="#000080">[</font>j<font color="#000080">]=</font>Seperator <font color="#FF0000"><b>then
       </b></font>Inc<font color="#000080">(</font>i<font color="#000080">)
    </font><font color="#FF0000"><b>else if </b></font>i <font color="#000080">= </font>At <font color="#FF0000"><b>then
       </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>S<font color="#000080">[</font>j<font color="#000080">];
    </font>Inc<font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strUpper<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>AnsiUpperCase<font color="#000080">(</font>S<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strOemAnsi<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$IFDEF Win32}
  </i></font>SetLength<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ELSE}
  </i></font>Result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ENDIF}
  </i></font>OemToAnsiBuff<font color="#000080">(@</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Length<font color="#000080">(</font>S<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strAnsiOem<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$IFDEF Win32}
  </i></font>SetLength<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ELSE}
  </i></font>Result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ENDIF}
  </i></font>AnsiToOemBuff<font color="#000080">(@</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>Length<font color="#000080">(</font>S<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strEqual<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>AnsiCompareText<font color="#000080">(</font>S1<font color="#000080">,</font>S2<font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strCompU<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strEqual<font color="#000080">(</font>strLeft<font color="#000080">(</font>S2<font color="#000080">,</font>Length<font color="#000080">(</font>S1<font color="#000080">)),</font>S1<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strComp<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strLeft<font color="#000080">(</font>S2<font color="#000080">,</font>Length<font color="#000080">(</font>S1<font color="#000080">))=</font>S1<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strContains<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>Pos<font color="#000080">(</font>S1<font color="#000080">,</font>S2<font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strContainsU<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S1<font color="#000080">,</font>S2<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strContains<font color="#000080">(</font>strUpper<font color="#000080">(</font>S1<font color="#000080">),</font>strUpper<font color="#000080">(</font>S2<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strNiceNum<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Seps <font color="#000080">: </font><font color="#FF0000"><b>set of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Seps<font color="#000080">:=[</font>ThousandSeparator<font color="#000080">,</font>DecimalSeparator<font color="#000080">];
  </font>Result<font color="#000080">:= </font>ZERO<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>DIGITS <font color="#000080">+ </font>Seps <font color="#FF0000"><b>then
    begin
      if </b></font>S<font color="#000080">[</font>i<font color="#000080">] = </font>ThousandSeparator <font color="#FF0000"><b>then
         </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>DecimalSeparator
      <font color="#FF0000"><b>else
         </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>S<font color="#000080">[</font>i<font color="#000080">];
      </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>In </b></font>Seps <font color="#FF0000"><b>then </b></font>Seps<font color="#000080">:=[];
    </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strNiceDate<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strNiceDateDefault<font color="#000080">(</font>S<font color="#000080">, </font>DateToStr<font color="#000080">(</font>Date<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>strNiceDateDefault<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">, </font><font color="#FF0000"><b>Default</b></font><font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>(* sinn der Procedure:
   Irgendeinen String &uuml;bergeben und in ein leidlich brauchbares Datum verwandeln.
   Im Wesentlichen zum Abfangen des Kommazeichens auf dem Zehnerfeld.
   eingabe 10 = R&uuml;ckgabe 10 des Laufenden Monats
   eingabe 10.12 = R&uuml;ckgabe des 10.12. des laufenden Jahres.
   eingabe 10.12.96 = R&uuml;ckgabe des Strings
   eingabe 10,12,96 = R&uuml;ckgabe 10.12.95 (wird dann won STRtoDATE() gefressen)
   Eine Plausbilit&auml;tskontrolle des Datums findet nicht Statt.
   Geplante Erweiterung:
   eingabe: +14  = R&uuml;ckgabe 14 Tage Weiter
   eingabe: +3m  = R&uuml;ckgabe 3 Monate ab Heute
   eingabe: +3w  = R&uuml;ckgabe 3 Wochen (3*7 Tage) ab Heute
   Das gleiche auch R&uuml;ckw&auml;rts mit  Minuszeichen
   eingabe: e oder E oder f  = N&auml;chster Erster
   eingabe: e+1m Erster des &uuml;bern&auml;chsten Monats
   Da l&auml;&szlig;t sich aber noch trefflich weiterspinnen

   EV. mit Quelle rausgeben, damit sich die Engl&auml;nder und Franzosen an
   Ihren Datumsformaten selbst erfreuen k&ouml;nnen und wir die passenden umsetzungen
   bekommen. *)
</i></font><font color="#FF0000"><b>var
  </b></font>a        <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">4</font><font color="#000080">];
  </font>heute    <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>i<font color="#000080">,</font>j      <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
  </font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
  </font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
  </font>heute <font color="#000080">:= </font><font color="#FF0000"><b>Default</b></font><font color="#000080">;

  </font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>DIGITS <font color="#FF0000"><b>then
      </b></font>a<font color="#000080">[</font>j<font color="#000080">] := </font>a<font color="#000080">[</font>j<font color="#000080">]+</font>S<font color="#000080">[</font>i<font color="#000080">]
    </font><font color="#FF0000"><b>else if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font>DateSeparator<font color="#000080">] </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
  if </b></font>Length<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    if </b></font>I<font color="#000080">=</font><font color="#800000">2 </font><font color="#FF0000"><b>then
      </b></font>a<font color="#000080">[</font>i<font color="#000080">] :=</font>copy<font color="#000080">(</font>heute<font color="#000080">,</font>i<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">4</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>a<font color="#000080">[</font>i<font color="#000080">] := </font>copy<font color="#000080">(</font>heute<font color="#000080">,</font>i<font color="#000080">*</font><font color="#800000">3</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    if </b></font>length<font color="#000080">(</font>a<font color="#000080">[</font>i<font color="#000080">]) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then
      </b></font>a<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">+</font>a<font color="#000080">[</font>i<font color="#000080">];

  </font>Result<font color="#000080">:=</font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>DateSeparator<font color="#000080">+</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>DateSeparator<font color="#000080">+</font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font><font color="#FF0000"><b>try
    </b></font>StrToDate<font color="#000080">(</font>Result<font color="#000080">);
  </font><font color="#FF0000"><b>except
    </b></font>Result<font color="#000080">:=</font>DateToStr<font color="#000080">(</font>Date<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strNiceTime<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>a   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
  </font>i<font color="#000080">,</font>j <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>j<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:= </font><font color="#800000">''</font><font color="#000080">;
  </font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
  </font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">]:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>DIGITS <font color="#FF0000"><b>then
    begin
      </b></font>a<font color="#000080">[</font>j<font color="#000080">] := </font>a<font color="#000080">[</font>j<font color="#000080">]+</font>S<font color="#000080">[</font>i<font color="#000080">];
    </font><font color="#FF0000"><b>end
    else if </b></font>S<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'.'</font><font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font><font color="#800000">':'</font><font color="#000080">] </font><font color="#FF0000"><b>then
      </b></font>inc<font color="#000080">(</font>J<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>j <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>J <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font><font color="#800000">2 </font><font color="#FF0000"><b>do
    if </b></font>length<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">]) = </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>a<font color="#000080">[</font>j<font color="#000080">] := </font><font color="#800000">'0'</font><font color="#000080">+</font>a<font color="#000080">[</font>j<font color="#000080">] </font><font color="#FF0000"><b>else
    if </b></font>length<font color="#000080">(</font>a<font color="#000080">[</font>j<font color="#000080">]) = </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>a<font color="#000080">[</font>j<font color="#000080">] := </font><font color="#800000">'00'</font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>a<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]+</font>TimeSeparator<font color="#000080">+</font>a<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font>TimeSeparator<font color="#000080">+</font>a<font color="#000080">[</font><font color="#800000">2</font><font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strNicePhone<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>L <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Length<font color="#000080">(</font>S<font color="#000080">) &gt; </font><font color="#800000">3 </font><font color="#FF0000"><b>then
  begin
    </b></font>L<font color="#000080">:=(</font>Length<font color="#000080">(</font>S<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
    </font>Result<font color="#000080">:=</font>strNicePhone<font color="#000080">(</font>strLeft<font color="#000080">(</font>S<font color="#000080">,</font>L<font color="#000080">))+</font>SPACE<font color="#000080">+</font>strNicePhone<font color="#000080">(</font>strRight<font color="#000080">(</font>S<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">)-</font>L<font color="#000080">));
  </font><font color="#FF0000"><b>end else
    </b></font>Result <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strReplace<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>C<font color="#000080">: </font>Char<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Replace<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
    if </b></font>S<font color="#000080">[</font>i<font color="#000080">]=</font>C <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>Replace<font color="#000080">+</font>Result
              <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>S<font color="#000080">[</font>i<font color="#000080">]+</font>Result<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>strChange<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>P <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>P<font color="#000080">:=</font>Pos<font color="#000080">(</font>Source<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>while </b></font>P<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>do
  begin
    </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,</font>P<font color="#000080">,</font>Length<font color="#000080">(</font>Source<font color="#000080">));
    </font>Insert<font color="#000080">(</font>Dest<font color="#000080">,</font>S<font color="#000080">,</font>P<font color="#000080">);
    </font>P<font color="#000080">:=</font>Pos<font color="#000080">(</font>Source<font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strCmdLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>ParamCount <font color="#FF0000"><b>do </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>ParamStr<font color="#000080">(</font>i<font color="#000080">)+</font><font color="#800000">' '</font><font color="#000080">;
  </font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>Result<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ sends a string to debug windows inside the IDE }
{$IFDEF Win32}
</i></font><font color="#FF0000"><b>procedure </b></font>strDebug<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>P    <font color="#000080">: </font>PChar<font color="#000080">;
  </font>CPS  <font color="#000080">: </font>TCopyDataStruct<font color="#000080">;
  </font>aWnd <font color="#000080">: </font>hWnd<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aWnd <font color="#000080">:= </font>FindWindow<font color="#000080">(</font><font color="#800000">'TfrmDbgTerm'</font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>aWnd <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>CPS<font color="#000080">.</font>cbData <font color="#000080">:= </font>Length<font color="#000080">(</font>S<font color="#000080">) + </font><font color="#800000">2</font><font color="#000080">;
    </font>GetMem<font color="#000080">(</font>P<font color="#000080">, </font>CPS<font color="#000080">.</font>cbData<font color="#000080">);
    </font><font color="#FF0000"><b>try
      </b></font>StrPCopy<font color="#000080">(</font>P<font color="#000080">, </font>S<font color="#000080">+</font>CR<font color="#000080">);
      </font>CPS<font color="#000080">.</font>lpData <font color="#000080">:= </font>P<font color="#000080">;
      </font>SendMessage<font color="#000080">(</font>aWnd<font color="#000080">, </font>WM_COPYDATA<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>LParam<font color="#000080">(@</font>CPS<font color="#000080">));
    </font><font color="#FF0000"><b>finally
      </b></font>FreeMem<font color="#000080">(</font>P<font color="#000080">, </font>Length<font color="#000080">(</font>S<font color="#000080">)+</font><font color="#800000">2</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>function </b></font>strSoundex<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>CvTable <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">'B'</font><font color="#000080">..</font><font color="#800000">'Z'</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char <font color="#000080">= (
    </font><font color="#800000">'1'</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'3'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'1'</font><font color="#000080">,   </font><font color="#008000"><i>{'B' .. 'F'}
    </i></font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">,   </font><font color="#008000"><i>{'G' .. 'K'}
    </i></font><font color="#800000">'4'</font><font color="#000080">, </font><font color="#800000">'5'</font><font color="#000080">, </font><font color="#800000">'5'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'1'</font><font color="#000080">,   </font><font color="#008000"><i>{'L' .. 'P'}
    </i></font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'6'</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'3'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">,   </font><font color="#008000"><i>{'Q' .. 'U'}
    </i></font><font color="#800000">'1'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">, </font><font color="#800000">'0'</font><font color="#000080">, </font><font color="#800000">'2' </font><font color="#000080">); </font><font color="#008000"><i>{'V' .. 'Z'}
</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">,</font>j <font color="#000080">: </font>Integer<font color="#000080">;
  </font>aGroup<font color="#000080">,</font>Ch  <font color="#000080">: </font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>Group<font color="#000080">(</font>Ch<font color="#000080">: </font>Char<font color="#000080">): </font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'B' </font><font color="#000080">.. </font><font color="#800000">'Z'</font><font color="#000080">]) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>Ch <font color="#FF0000"><b>In </b></font><font color="#000080">[</font><font color="#800000">'E'</font><font color="#000080">,</font><font color="#800000">'H'</font><font color="#000080">,</font><font color="#800000">'I'</font><font color="#000080">,</font><font color="#800000">'O'</font><font color="#000080">,</font><font color="#800000">'U'</font><font color="#000080">,</font><font color="#800000">'W'</font><font color="#000080">,</font><font color="#800000">'Y'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
       </b></font>Result<font color="#000080">:=</font>CvTable<font color="#000080">[</font>Ch<font color="#000080">]
    </font><font color="#FF0000"><b>else
       </b></font>Result<font color="#000080">:=</font><font color="#800000">'0'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">'000'</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;

  </font>S<font color="#000080">:= </font>strUpper<font color="#000080">(</font>S<font color="#000080">);
  </font>i<font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>j<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>j<font color="#000080">&lt;=</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Ch <font color="#000080">:= </font>S<font color="#000080">[</font>i<font color="#000080">];
    </font>aGroup <font color="#000080">:= </font>Group<font color="#000080">(</font>Ch<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>aGroup <font color="#000080">&lt;&gt; </font><font color="#800000">'0'</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Ch <font color="#000080">&lt;&gt; </font>S<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">((</font>J<font color="#000080">=</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>aGroup <font color="#000080">&lt;&gt; </font>Result<font color="#000080">[</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">])) </font><font color="#FF0000"><b>and
       </b></font><font color="#000080">((</font>i<font color="#000080">&gt;</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>aGroup <font color="#000080">&lt;&gt; </font>Group<font color="#000080">(</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]))) </font><font color="#FF0000"><b>then
    begin
      </b></font>Result<font color="#000080">[</font>j<font color="#000080">] :=</font>aGroup<font color="#000080">;
      </font>Inc<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Inc<font color="#000080">(</font>i<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{while}

  </i></font>Result<font color="#000080">:=</font>S<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]+</font><font color="#800000">'-'</font><font color="#000080">+</font>Result<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strByteSize<font color="#000080">(</font>Value<font color="#000080">: </font>Longint<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>FltToStr<font color="#000080">(</font>F<font color="#000080">: </font>Extended<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Result<font color="#000080">:=</font>FloatToStrF<font color="#000080">(</font>Round<font color="#000080">(</font>F<font color="#000080">),</font>ffNumber<font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  if </b></font>Value <font color="#000080">&gt; </font>GBYTE <font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>FltTostr<font color="#000080">(</font>Value <font color="#000080">/ </font>GBYTE<font color="#000080">)+</font><font color="#800000">' GB'
  </font><font color="#FF0000"><b>else if </b></font>Value <font color="#000080">&gt; </font>MBYTE <font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>FltToStr<font color="#000080">(</font>Value <font color="#000080">/ </font>MBYTE<font color="#000080">)+</font><font color="#800000">' MB'
  </font><font color="#FF0000"><b>else if </b></font>Value <font color="#000080">&gt; </font>KBYTE <font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>FltTostr<font color="#000080">(</font>Value <font color="#000080">/ </font>KBYTE<font color="#000080">)+</font><font color="#800000">' KB'
  </font><font color="#FF0000"><b>else
    </b></font>Result<font color="#000080">:=</font>FltTostr<font color="#000080">(</font>Value <font color="#000080">/ </font>KBYTE<font color="#000080">)+</font><font color="#800000">' Byte'</font><font color="#000080">;   </font><font color="#008000"><i>{ 04.08.96 sb }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>C1 <font color="#000080">= </font><font color="#800000">52845</font><font color="#000080">;
  </font>C2 <font color="#000080">= </font><font color="#800000">22719</font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strEncrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Key<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$IFDEF Win32}
  </i></font>SetLength<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ELSE}
   </i></font>Result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ENDIF}
  </i></font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Result<font color="#000080">[</font>I<font color="#000080">] := </font>Char<font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>Key <font color="#FF0000"><b>shr </b></font><font color="#800000">8</font><font color="#000080">));
    </font>Key <font color="#000080">:= (</font>Ord<font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">]) + </font>Key<font color="#000080">) * </font>C1 <font color="#000080">+ </font>C2<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strDecrypt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Key<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$IFDEF Win32}
  </i></font>SetLength<font color="#000080">(</font>Result<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ELSE}
   </i></font>Result<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font>Chr<font color="#000080">(</font>Length<font color="#000080">(</font>S<font color="#000080">));
 </font><font color="#008000"><i>{$ENDIF}
  </i></font><font color="#FF0000"><b>for </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do begin
    </b></font>Result<font color="#000080">[</font>I<font color="#000080">] := </font>char<font color="#000080">(</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>xor </b></font><font color="#000080">(</font>Key <font color="#FF0000"><b>shr </b></font><font color="#800000">8</font><font color="#000080">));
    </font>Key <font color="#000080">:= (</font>Ord<font color="#000080">(</font>S<font color="#000080">[</font>I<font color="#000080">]) + </font>Key<font color="#000080">) * </font>C1 <font color="#000080">+ </font>C2<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>strLastCh<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>S<font color="#000080">[</font>Length<font color="#000080">(</font>S<font color="#000080">)];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>strStripLast<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Length<font color="#000080">(</font>S<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Delete<font color="#000080">(</font>S<font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>strSearchReplace<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Source<font color="#000080">, </font>Dest<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Options<font color="#000080">: </font>TSRoptions<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>hs<font color="#000080">,</font>hs1<font color="#000080">,</font>hs2<font color="#000080">,</font>hs3<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>i<font color="#000080">,</font>j <font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
 if  </b></font>srCase <font color="#FF0000"><b>in </b></font>Options <font color="#FF0000"><b>then
  begin
   </b></font>hs <font color="#000080">:= </font>s<font color="#000080">;
   </font>hs3 <font color="#000080">:= </font>source<font color="#000080">;
  </font><font color="#FF0000"><b>end
 else
  begin
   </b></font>hs<font color="#000080">:= </font>StrUpper<font color="#000080">(</font>s<font color="#000080">);
   </font>hs3 <font color="#000080">:= </font>StrUpper<font color="#000080">(</font>Source<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font>hs1<font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
 </font>I<font color="#000080">:= </font>pos<font color="#000080">(</font>hs3<font color="#000080">,</font>hs<font color="#000080">);
 </font>j <font color="#000080">:= </font>length<font color="#000080">(</font>hs3<font color="#000080">);
 </font><font color="#FF0000"><b>while </b></font>i <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do
 begin
   </b></font>delete<font color="#000080">(</font>hs<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">+</font>j<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{Anfang Rest ge&auml;ndert 8.7.96 KM}
   </i></font>hs1 <font color="#000080">:= </font>Hs1<font color="#000080">+</font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{Kopieren ge&auml;ndert 8.7.96 KM}
   </i></font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">); </font><font color="#008000"><i>{L&ouml;schen bis Anfang posge&auml;ndert 8.7.96 KM}
   </i></font>hs2 <font color="#000080">:= </font>copy<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>j<font color="#000080">); </font><font color="#008000"><i>{Bis ende pos Sichern}
   </i></font>delete<font color="#000080">(</font>s<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font>j<font color="#000080">); </font><font color="#008000"><i>{L&ouml;schen bis ende Pos}
   </i></font><font color="#FF0000"><b>if    </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font><font color="#000080">(</font>srWord <font color="#FF0000"><b>in </b></font>Options<font color="#000080">))
       </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>pos<font color="#000080">(</font>s<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font><font color="#800000">' .,:;-#''+*?=)(/&amp;%$&sect;&quot;!{[]}\~&lt;&gt;|'</font><font color="#000080">) &gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
    begin
     </b></font><font color="#008000"><i>{Quelle durch ziel erstzen}
     </i></font>hs1 <font color="#000080">:= </font>hs1<font color="#000080">+</font>dest<font color="#000080">;
    </font><font color="#FF0000"><b>end
   else
    begin
     </b></font>hs1 <font color="#000080">:= </font>hs1<font color="#000080">+</font>hs2<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>srall <font color="#FF0000"><b>in </b></font>options <font color="#FF0000"><b>then
    </b></font>I<font color="#000080">:= </font>pos<font color="#000080">(</font>hs3<font color="#000080">,</font>hs<font color="#000080">)
   </font><font color="#FF0000"><b>else
    </b></font>i <font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>s<font color="#000080">:= </font>hs1<font color="#000080">+</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>strProfile<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">, </font>aSection<font color="#000080">, </font>aEntry<font color="#000080">, </font>aDefault<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aTmp<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font><font color="#008000"><i>{$IFDEF Win32}
   </i></font>GetPrivateProfileString<font color="#000080">(</font>PChar<font color="#000080">(</font>aSection<font color="#000080">), </font>PChar<font color="#000080">(</font>aEntry<font color="#000080">),
      </font>PChar<font color="#000080">(</font>aDefault<font color="#000080">), </font>aTmp<font color="#000080">, </font>Sizeof<font color="#000080">(</font>aTmp<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">, </font>PChar<font color="#000080">(</font>aFile<font color="#000080">));
   </font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>aTmp<font color="#000080">);
 </font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>strCapitalize<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;  </font><font color="#008000"><i>{ 31.07.96 sb }
</i></font><font color="#FF0000"><b>var
  </b></font>i      <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Ch     <font color="#000080">: </font>Char<font color="#000080">;
  </font>First  <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>First  <font color="#000080">:= </font>True<font color="#000080">;
  </font>Result <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    </b></font>Ch<font color="#000080">:=</font>S<font color="#000080">[</font>i<font color="#000080">];
    </font><font color="#FF0000"><b>if </b></font>Ch <font color="#FF0000"><b>in </b></font><font color="#000080">[</font>SPACE<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">,</font><font color="#800000">'.'</font><font color="#000080">] </font><font color="#FF0000"><b>then
       </b></font>First<font color="#000080">:=</font>True
    <font color="#FF0000"><b>else if </b></font>First <font color="#FF0000"><b>then
    begin
      </b></font>Ch<font color="#000080">:=</font>strUpper<font color="#000080">(</font>Ch<font color="#000080">)[</font><font color="#800000">1</font><font color="#000080">];
      </font>First<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>Ch<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function </b></font>strFileLoad<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aStr <font color="#000080">: </font>TStrings<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>aStr<font color="#000080">:=</font>TStringList<font color="#000080">.</font>Create<font color="#000080">;
  </font><font color="#FF0000"><b>try
    </b></font>aStr<font color="#000080">.</font>LoadFromFile<font color="#000080">(</font>aFile<font color="#000080">);
    </font>Result<font color="#000080">:=</font>aStr<font color="#000080">.</font>Text<font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>aStr<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>strFileSave<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">,</font>aString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Stream<font color="#000080">: </font>TStream<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Stream <font color="#000080">:= </font>TFileStream<font color="#000080">.</font>Create<font color="#000080">(</font>aFile<font color="#000080">, </font>fmCreate<font color="#000080">);
  </font><font color="#FF0000"><b>try
    </b></font>Stream<font color="#000080">.</font>WriteBuffer<font color="#000080">(</font>Pointer<font color="#000080">(</font>aString<font color="#000080">)^,</font>Length<font color="#000080">(</font>aString<font color="#000080">));
  </font><font color="#FF0000"><b>finally
    </b></font>Stream<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{ Integer stuff }

</i></font><font color="#FF0000"><b>function </b></font>IntCenter<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>a <font color="#FF0000"><b>div </b></font><font color="#800000">2 </font><font color="#000080">- </font>b <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntMax<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>a<font color="#000080">&gt;</font>b <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>a <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>b<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntMin<font color="#000080">(</font>a<font color="#000080">,</font>b<font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>a<font color="#000080">&lt;</font>b <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>a <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>b<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntPow<font color="#000080">(</font>Base<font color="#000080">,</font>Expo<font color="#000080">: </font>Integer<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Loop             <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>Loop<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Expo <font color="#FF0000"><b>do </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">*</font>Base<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntPow10<font color="#000080">(</font>Exponent<font color="#000080">: </font>Integer<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>IntPow<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font>Exponent<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntSign<font color="#000080">(</font>a<font color="#000080">: </font>Int_<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>a<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=-</font><font color="#800000">1 </font><font color="#FF0000"><b>else if </b></font>a<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=+</font><font color="#800000">1 </font><font color="#FF0000"><b>else </b></font>Result<font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntZero<font color="#000080">(</font>a<font color="#000080">: </font>Int_<font color="#000080">; </font>Len<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strPadZeroL<font color="#000080">(</font>IntToStr<font color="#000080">(</font>a<font color="#000080">),</font>Len<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntPrime<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>i <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Value <font color="#FF0000"><b>mod </b></font><font color="#800000">2 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>i <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>repeat
      </b></font>i <font color="#000080">:= </font>i <font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
      </font>Result<font color="#000080">:= </font>Value <font color="#FF0000"><b>mod </b></font>i <font color="#000080">= </font><font color="#800000">0
    </font><font color="#FF0000"><b>until </b></font>Result <font color="#FF0000"><b>or </b></font><font color="#000080">( </font>i <font color="#000080">&gt; </font>Trunc<font color="#000080">(</font>sqrt<font color="#000080">(</font>Value<font color="#000080">)) );
    </font>Result<font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>Result<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>IntPercent<font color="#000080">(</font>a<font color="#000080">, </font>b <font color="#000080">: </font>Int_<font color="#000080">): </font>Int_<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>Trunc<font color="#000080">((</font>a <font color="#000080">/ </font>b<font color="#000080">)*</font><font color="#800000">100</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Floating point stuff }

</i></font><font color="#FF0000"><b>function </b></font>FltAdd<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>P1    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>P2    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>Result<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">+</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltDiv<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>P1<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>P2<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>P2<font color="#000080">=</font><font color="#800000">0.0 </font><font color="#FF0000"><b>then </b></font>P2<font color="#000080">:=</font>FLTZERO<font color="#000080">;       </font><font color="#008000"><i>{ provide division by zero }
  </i></font>Result<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">/</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltEqual<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Diff            <font color="#000080">: </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Diff<font color="#000080">:=</font>fltSub<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>Result<font color="#000080">:=</font>fltEqualZero<font color="#000080">(</font>Diff<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltEqualZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=(</font>P<font color="#000080">&gt;-</font>FLTZERO<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>P<font color="#000080">&lt;</font>FLTZERO<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltGreaterZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>P<font color="#000080">&gt;</font>FLTZERO<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltLessZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>P<font color="#000080">&lt;-</font>FLTZERO<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltNeg<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">; </font>Negate<font color="#000080">: </font>Boolean<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Negate <font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=-</font>P <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>P<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltMul<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>P1    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>P2    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>Result<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">*</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltRound<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Factor  <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Help    <font color="#000080">: </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Factor<font color="#000080">:=</font>IntPow10<font color="#000080">(</font>Decimals<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>P<font color="#000080">&lt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Help<font color="#000080">:=-</font><font color="#800000">0.5 </font><font color="#FF0000"><b>else </b></font>Help<font color="#000080">:=</font><font color="#800000">0.5</font><font color="#000080">;
  </font>Result<font color="#000080">:=</font>Int<font color="#000080">(</font>P<font color="#000080">*</font>Factor<font color="#000080">+</font>Help<font color="#000080">)/</font>Factor<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>fltEqualZero<font color="#000080">(</font>Result<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font><font color="#800000">0.00</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltSub<font color="#000080">(</font>P1<font color="#000080">,</font>P2<font color="#000080">: </font>Float<font color="#000080">; </font>Decimals<font color="#000080">: </font>Integer<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>P1    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>P2    <font color="#000080">:=</font>fltRound<font color="#000080">(</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
  </font>Result<font color="#000080">:=</font>fltRound<font color="#000080">(</font>P1<font color="#000080">-</font>P2<font color="#000080">,</font>Decimals<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltUnEqualZero<font color="#000080">(</font>P<font color="#000080">: </font>Float<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=(</font>P<font color="#000080">&lt;-</font>FLTZERO<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>P<font color="#000080">&gt;</font>FLTZERO<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>FltCalc<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Expr<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>STACKSIZE <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Stack   <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>STACKSIZE<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>double<font color="#000080">;
  </font>oStack  <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>STACKSIZE<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>z<font color="#000080">,</font>n     <font color="#000080">: </font>double<font color="#000080">;
  </font>i<font color="#000080">,</font>j<font color="#000080">,</font>m   <font color="#000080">: </font>integer<font color="#000080">;
  </font>Bracket <font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Bracket<font color="#000080">:= </font>False<font color="#000080">; </font>j <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">; </font>n<font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;</font>z<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font>m<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Expr<font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    if not </b></font>Bracket  <font color="#FF0000"><b>then
       case </b></font>Expr<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>of
         </b></font><font color="#800000">'0' </font><font color="#000080">.. </font><font color="#800000">'9'</font><font color="#000080">: </font><font color="#FF0000"><b>begin
                       </b></font>z<font color="#000080">:=</font>z<font color="#000080">*</font><font color="#800000">10</font><font color="#000080">+</font>ord<font color="#000080">(</font>Expr<font color="#000080">[</font>i<font color="#000080">])-</font>ord<font color="#000080">(</font><font color="#800000">'0'</font><font color="#000080">);
                       </font>n<font color="#000080">:=</font>n<font color="#000080">*</font>m<font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
         </font><font color="#800000">','</font><font color="#000080">,</font><font color="#800000">#46   </font><font color="#000080">: </font>m <font color="#000080">:= </font><font color="#800000">10</font><font color="#000080">;
         </font><font color="#800000">'('       </font><font color="#000080">: </font>Bracket <font color="#000080">:= </font>True<font color="#000080">; </font><font color="#008000"><i>{hier Klammeranfang merken, Z&auml;hler!!}
         </i></font><font color="#800000">'*'</font><font color="#000080">,</font><font color="#800000">'x'</font><font color="#000080">,
         </font><font color="#800000">'X'</font><font color="#000080">,
         </font><font color="#800000">'/'</font><font color="#000080">,</font><font color="#800000">'+'   </font><font color="#000080">: </font><font color="#FF0000"><b>begin
                       </b></font>Stack<font color="#000080">[</font>j<font color="#000080">] := </font>z<font color="#000080">/</font>n<font color="#000080">;
                       </font>oStack<font color="#000080">[</font>j<font color="#000080">] := </font>Expr<font color="#000080">[</font>i<font color="#000080">];
                       </font>Inc<font color="#000080">(</font>j<font color="#000080">);
                       </font>m<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;</font>z<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;</font>n<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
                     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
       </font><font color="#FF0000"><b>end </b></font><font color="#008000"><i>{case}
    </i></font><font color="#FF0000"><b>else
       </b></font>Bracket<font color="#000080">:= </font>Expr<font color="#000080">[</font>i<font color="#000080">]&lt;&gt; </font><font color="#800000">')'</font><font color="#000080">; </font><font color="#008000"><i>{hier Rekursiver Aufruf, Z&auml;hler !!}</i></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Stack<font color="#000080">[</font>j<font color="#000080">] := </font>z<font color="#000080">/</font>n<font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>j <font color="#FF0000"><b>do
    case </b></font>oStack<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'*'</font><font color="#000080">,</font><font color="#800000">'x'</font><font color="#000080">,</font><font color="#800000">'X' </font><font color="#000080">:  </font>Stack<font color="#000080">[</font>i<font color="#000080">]:= </font>Stack<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]*</font>Stack<font color="#000080">[</font>i<font color="#000080">];
      </font><font color="#800000">'/'         </font><font color="#000080">:  </font>Stack<font color="#000080">[</font>i<font color="#000080">]:= </font>Stack<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]/</font>Stack<font color="#000080">[</font>i<font color="#000080">];
      </font><font color="#800000">'+'         </font><font color="#000080">:  </font>Stack<font color="#000080">[</font>i<font color="#000080">]:= </font>Stack<font color="#000080">[</font>i<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]+</font>Stack<font color="#000080">[</font>i<font color="#000080">];
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Result<font color="#000080">:= </font>Stack<font color="#000080">[</font>j<font color="#000080">];
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fltPower<font color="#000080">(</font>a<font color="#000080">, </font>n<font color="#000080">: </font>Float<font color="#000080">): </font>Float<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>Exp<font color="#000080">(</font>n <font color="#000080">* </font>Ln<font color="#000080">(</font>a<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Rectangle Calculations }

</i></font><font color="#FF0000"><b>function </b></font>RectHeight<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>R<font color="#000080">.</font>Bottom <font color="#000080">- </font>R<font color="#000080">.</font>Top<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectWidth<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>R<font color="#000080">.</font>Right <font color="#000080">- </font>R<font color="#000080">.</font>Left<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>RectGrow<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>Delta<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>R <font color="#FF0000"><b>do
  begin
    </b></font>Dec<font color="#000080">(</font>Left<font color="#000080">, </font>Delta<font color="#000080">);
    </font>Dec<font color="#000080">(</font>Top<font color="#000080">, </font>Delta<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Right<font color="#000080">, </font>Delta<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Bottom<font color="#000080">, </font>Delta<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>RectRelativeMove<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>DX<font color="#000080">, </font>DY<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>R <font color="#FF0000"><b>do
  begin
    </b></font>Inc<font color="#000080">(</font>Left<font color="#000080">, </font>DX<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Right<font color="#000080">, </font>DX<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Top<font color="#000080">, </font>DY<font color="#000080">);
    </font>Inc<font color="#000080">(</font>Bottom<font color="#000080">, </font>DY<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>RectMoveTo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  with </b></font>R <font color="#FF0000"><b>do
  begin
    </b></font>Right <font color="#000080">:= </font>X <font color="#000080">+ </font>Right <font color="#000080">- </font>Left<font color="#000080">;
    </font>Bottom <font color="#000080">:= </font>Y <font color="#000080">+ </font>Bottom <font color="#000080">- </font>Top<font color="#000080">;
    </font>Left <font color="#000080">:= </font>X<font color="#000080">;
    </font>Top <font color="#000080">:= </font>Y<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectSet<font color="#000080">(</font>Left<font color="#000080">, </font>Top<font color="#000080">, </font>Right<font color="#000080">, </font>Bottom<font color="#000080">: </font>Integer<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">.</font>Left <font color="#000080">:= </font>Left<font color="#000080">;
  </font>Result<font color="#000080">.</font>Top <font color="#000080">:= </font>Top<font color="#000080">;
  </font>Result<font color="#000080">.</font>Right <font color="#000080">:= </font>Right<font color="#000080">;
  </font>Result<font color="#000080">.</font>Bottom <font color="#000080">:= </font>Bottom<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectSetPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>TopLeft<font color="#000080">, </font>BottomRight<font color="#000080">: </font>TPoint<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">.</font>TopLeft <font color="#000080">:= </font>TopLeft<font color="#000080">;
  </font>Result<font color="#000080">.</font>BottomRight <font color="#000080">:= </font>BottomRight<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectInclude<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= (</font>R1<font color="#000080">.</font>Left <font color="#000080">&gt;= </font>R2<font color="#000080">.</font>Left<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>R1<font color="#000080">.</font>Top <font color="#000080">&gt;= </font>R2<font color="#000080">.</font>Top<font color="#000080">)
    </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>R1<font color="#000080">.</font>Right <font color="#000080">&lt;= </font>R2<font color="#000080">.</font>Right<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>R1<font color="#000080">.</font>Bottom <font color="#000080">&lt;= </font>R2<font color="#000080">.</font>Bottom<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>RectPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">; </font>P<font color="#000080">: </font>TPoint<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= (</font>p<font color="#000080">.</font>x<font color="#000080">&gt;</font>r<font color="#000080">.</font>left<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">.</font>x<font color="#000080">&lt;</font>r<font color="#000080">.</font>right<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">.</font>y<font color="#000080">&gt;</font>r<font color="#000080">.</font>top<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>p<font color="#000080">.</font>y<font color="#000080">&lt;</font>r<font color="#000080">.</font>bottom<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectIntersection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>Result <font color="#FF0000"><b>do
  begin
    </b></font>Left <font color="#000080">:= </font>intMax<font color="#000080">(</font>R1<font color="#000080">.</font>Left<font color="#000080">, </font>R2<font color="#000080">.</font>Left<font color="#000080">);
    </font>Top <font color="#000080">:= </font>intMax<font color="#000080">(</font>R1<font color="#000080">.</font>Top<font color="#000080">, </font>R2<font color="#000080">.</font>Top<font color="#000080">);
    </font>Right <font color="#000080">:= </font>intMin<font color="#000080">(</font>R1<font color="#000080">.</font>Right<font color="#000080">, </font>R2<font color="#000080">.</font>Right<font color="#000080">);
    </font>Bottom <font color="#000080">:= </font>intMin<font color="#000080">(</font>R1<font color="#000080">.</font>Bottom<font color="#000080">, </font>R2<font color="#000080">.</font>Bottom<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if not </b></font>RectIsValid<font color="#000080">(</font>Result<font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>Result <font color="#000080">:= </font>RectSet<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectIsIntersection<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R1<font color="#000080">, </font>R2<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#FF0000"><b>not </b></font>RectIsNull<font color="#000080">(</font>RectIntersection<font color="#000080">(</font>R1<font color="#000080">, </font>R2<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectIsValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>R <font color="#FF0000"><b>do
    </b></font>Result <font color="#000080">:= (</font>Left <font color="#000080">&lt;= </font>Right<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Top <font color="#000080">&lt;= </font>Bottom<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectsAreValid<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Arr<font color="#000080">: </font><font color="#FF0000"><b>array of </b></font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>I <font color="#000080">:= </font>Low<font color="#000080">(</font>Arr<font color="#000080">) </font><font color="#FF0000"><b>to </b></font>High<font color="#000080">(</font>Arr<font color="#000080">) </font><font color="#FF0000"><b>do
    if not </b></font>RectIsValid<font color="#000080">(</font>Arr<font color="#000080">[</font>I<font color="#000080">]) </font><font color="#FF0000"><b>then
    begin
      </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
      </font>exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectNull<font color="#000080">: </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>RectSet<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectIsNull<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>R <font color="#FF0000"><b>do
    </b></font>Result <font color="#000080">:= (</font>Left <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Right <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Top <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Bottom <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectIsSquare<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>RectHeight<font color="#000080">(</font>R<font color="#000080">) = </font>RectWidth<font color="#000080">(</font>R<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>RectCentralPoint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>R<font color="#000080">: </font>TRect<font color="#000080">): </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">.</font>X <font color="#000080">:= </font>R<font color="#000080">.</font>Left <font color="#000080">+ (</font>RectWidth<font color="#000080">(</font>R<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
  </font>Result<font color="#000080">.</font>Y <font color="#000080">:= </font>R<font color="#000080">.</font>Top <font color="#000080">+ (</font>RectHeight<font color="#000080">(</font>R<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>rectBounds<font color="#000080">(</font>aLeft<font color="#000080">,</font>aTop<font color="#000080">,</font>aWidth<font color="#000080">,</font>aHeight<font color="#000080">: </font>Integer<font color="#000080">): </font>TRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>rectSet<font color="#000080">(</font>aLeft<font color="#000080">,</font>aTop<font color="#000080">,</font>aLeft<font color="#000080">+</font>aWidth<font color="#000080">,</font>aTop<font color="#000080">+</font>aHeight<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#008000"><i>{ file functions }

</i></font><font color="#FF0000"><b>procedure </b></font>fileShredder<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>aFile <font color="#000080">: </font>Integer<font color="#000080">;
  </font>aSize <font color="#000080">: </font>Integer<font color="#000080">;
  </font>P     <font color="#000080">: </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aSize<font color="#000080">:=</font>fileSize<font color="#000080">(</font>Filename<font color="#000080">);
  </font>aFile<font color="#000080">:=</font>FileOpen<font color="#000080">(</font>FileName<font color="#000080">,</font>fmOpenReadWrite<font color="#000080">);
  </font><font color="#FF0000"><b>try
    </b></font>Getmem<font color="#000080">(</font>P<font color="#000080">,</font>aSize<font color="#000080">);
    </font>fillchar<font color="#000080">(</font>P<font color="#000080">^,</font>aSize<font color="#000080">,</font><font color="#800000">'X'</font><font color="#000080">);
    </font>FileWrite<font color="#000080">(</font>aFile<font color="#000080">,</font>P<font color="#000080">^,</font>aSize<font color="#000080">);
    </font>Freemem<font color="#000080">(</font>P<font color="#000080">,</font>aSize<font color="#000080">);
  </font><font color="#FF0000"><b>finally
    </b></font>FileClose<font color="#000080">(</font>aFile<font color="#000080">);
    </font>DeleteFile<font color="#000080">(</font>Filename<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fileSize<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>SearchRec       <font color="#000080">: </font>TSearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin                                       </b></font><font color="#008000"><i>{ !Win32! -&gt; GetFileSize }
  </i></font><font color="#FF0000"><b>if </b></font>FindFirst<font color="#000080">(</font>FileName<font color="#000080">,</font>faAnyFile<font color="#000080">,</font>SearchRec<font color="#000080">)=</font><font color="#800000">0
    </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>SearchRec<font color="#000080">.</font>Size
    <font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fileWildcard<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=(</font>Pos<font color="#000080">(</font><font color="#800000">'*'</font><font color="#000080">,</font>Filename<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Pos<font color="#000080">(</font><font color="#800000">'?'</font><font color="#000080">,</font>Filename<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; 

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function </b></font>fileTemp<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aExt<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>aFile <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetTempPath<font color="#000080">(</font>Sizeof<font color="#000080">(</font>Buffer<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">,</font>Buffer<font color="#000080">);
  </font>GetTempFileName<font color="#000080">(</font>Buffer<font color="#000080">,</font><font color="#800000">'TMP'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Buffer<font color="#000080">);
  </font>SetString<font color="#000080">(</font>aFile<font color="#000080">, </font>Buffer<font color="#000080">, </font>StrLen<font color="#000080">(</font>Buffer<font color="#000080">));
  </font>Result<font color="#000080">:=</font>ChangeFileExt<font color="#000080">(</font>aFile<font color="#000080">,</font>aExt<font color="#000080">);
  </font>RenameFile<font color="#000080">(</font>aFile<font color="#000080">,</font>Result<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fileExec<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aCmdLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>aHide<font color="#000080">, </font>aWait<font color="#000080">: </font>Boolean<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>StartupInfo <font color="#000080">: </font>TStartupInfo<font color="#000080">;
  </font>ProcessInfo <font color="#000080">: </font>TProcessInformation<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{setup the startup information for the application }
  </i></font>FillChar<font color="#000080">(</font>StartupInfo<font color="#000080">, </font>SizeOf<font color="#000080">(</font>TStartupInfo<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>StartupInfo <font color="#FF0000"><b>do
  begin
    </b></font>cb<font color="#000080">:= </font>SizeOf<font color="#000080">(</font>TStartupInfo<font color="#000080">);
    </font>dwFlags<font color="#000080">:= </font>STARTF_USESHOWWINDOW <font color="#FF0000"><b>or </b></font>STARTF_FORCEONFEEDBACK<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>aHide <font color="#FF0000"><b>then </b></font>wShowWindow<font color="#000080">:= </font>SW_HIDE
             <font color="#FF0000"><b>else </b></font>wShowWindow<font color="#000080">:= </font>SW_SHOWNORMAL<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Result <font color="#000080">:= </font>CreateProcess<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>PChar<font color="#000080">(</font>aCmdLine<font color="#000080">), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>False<font color="#000080">,
               </font>NORMAL_PRIORITY_CLASS<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>StartupInfo<font color="#000080">, </font>ProcessInfo<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>aWait <font color="#FF0000"><b>then
     if </b></font>Result <font color="#FF0000"><b>then
     begin
       </b></font>WaitForInputIdle<font color="#000080">(</font>ProcessInfo<font color="#000080">.</font>hProcess<font color="#000080">, </font>INFINITE<font color="#000080">);
       </font>WaitForSingleObject<font color="#000080">(</font>ProcessInfo<font color="#000080">.</font>hProcess<font color="#000080">, </font>INFINITE<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fileShellOpen<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>ShellExecute<font color="#000080">( </font>Application<font color="#000080">.</font>Handle<font color="#000080">,
    </font><font color="#800000">'open'</font><font color="#000080">, </font>PChar<font color="#000080">(</font>aFile<font color="#000080">), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>SW_NORMAL<font color="#000080">) &lt;= </font><font color="#800000">32</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>fileShellPrint<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>ShellExecute<font color="#000080">( </font>Application<font color="#000080">.</font>Handle<font color="#000080">,
    </font><font color="#800000">'print'</font><font color="#000080">, </font>PChar<font color="#000080">(</font>aFile<font color="#000080">), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>SW_HIDE<font color="#000080">) &lt;= </font><font color="#800000">32</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>fileLongName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aInfo<font color="#000080">: </font>TSHFileInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>SHGetFileInfo<font color="#000080">(</font>PChar<font color="#000080">(</font>aFile<font color="#000080">),</font><font color="#800000">0</font><font color="#000080">,</font>aInfo<font color="#000080">,</font>Sizeof<font color="#000080">(</font>aInfo<font color="#000080">),</font>SHGFI_DISPLAYNAME<font color="#000080">)&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>aInfo<font color="#000080">.</font>szDisplayName<font color="#000080">)
  </font><font color="#FF0000"><b>else
     </b></font>Result<font color="#000080">:=</font>aFile<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>fileShortName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aFile<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aTmp<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GetShortPathName<font color="#000080">(</font>PChar<font color="#000080">(</font>aFile<font color="#000080">),</font>aTmp<font color="#000080">,</font>Sizeof<font color="#000080">(</font>aTmp<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>aFile
  <font color="#FF0000"><b>else
     </b></font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>aTmp<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>function </b></font>ExtractName<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Filename<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aExt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>aPos <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aExt<font color="#000080">:=</font>ExtractFileExt<font color="#000080">(</font>Filename<font color="#000080">);
  </font>Result<font color="#000080">:=</font>ExtractFileName<font color="#000080">(</font>Filename<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>aExt <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    </b></font>aPos<font color="#000080">:=</font>Pos<font color="#000080">(</font>aExt<font color="#000080">,</font>Result<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>aPos<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
       </b></font>Delete<font color="#000080">(</font>Result<font color="#000080">,</font>aPos<font color="#000080">,</font>Length<font color="#000080">(</font>aExt<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ date calculations }

</i></font><font color="#FF0000"><b>function  </b></font>dateYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Year<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>dateMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Month<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>dateEndOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>dateBeginOfMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>dateEndOfMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Month<font color="#000080">=</font><font color="#800000">12 </font><font color="#FF0000"><b>then
  begin
    </b></font>Inc<font color="#000080">(</font>Year<font color="#000080">);
    </font>Month<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>Inc<font color="#000080">(</font>Month<font color="#000080">);
  </font>Result<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateWeekOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ Armin Hanisch }
</i></font><font color="#FF0000"><b>const
  </b></font>t1<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ShortInt <font color="#000080">= ( -</font><font color="#800000">1</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">,  </font><font color="#800000">1</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">3</font><font color="#000080">, -</font><font color="#800000">3</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">);
  </font>t2<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">7</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>ShortInt <font color="#000080">= ( -</font><font color="#800000">4</font><font color="#000080">,  </font><font color="#800000">2</font><font color="#000080">,  </font><font color="#800000">1</font><font color="#000080">,  </font><font color="#800000">0</font><font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, -</font><font color="#800000">2</font><font color="#000080">, -</font><font color="#800000">3</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>doy1<font color="#000080">,
  </font>doy2    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>NewYear <font color="#000080">: </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>NewYear<font color="#000080">:=</font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">);
  </font>doy1 <font color="#000080">:= </font>dateDayofYear<font color="#000080">(</font>D<font color="#000080">) + </font>t1<font color="#000080">[</font>DayOfWeek<font color="#000080">(</font>NewYear<font color="#000080">)];
  </font>doy2 <font color="#000080">:= </font>dateDayofYear<font color="#000080">(</font>D<font color="#000080">) + </font>t2<font color="#000080">[</font>DayOfWeek<font color="#000080">(</font>D<font color="#000080">)];
  </font><font color="#FF0000"><b>if </b></font>doy1 <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
    </b></font>Result <font color="#000080">:= </font>dateWeekOfYear<font color="#000080">(</font>NewYear<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)
  </font><font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>doy2 <font color="#000080">&gt;= </font>dateDayofYear<font color="#000080">(</font>dateEndOfYear<font color="#000080">(</font>NewYear<font color="#000080">))) </font><font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>else
    </b></font>Result<font color="#000080">:=(</font>doy1<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">7</font><font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateDayOfYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>Trunc<font color="#000080">(</font>D<font color="#000080">-</font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">))+</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateDayOfWeek<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDayOfWeek<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>TDayOfWeek<font color="#000080">(</font>Pred<font color="#000080">(</font>DayOfWeek<font color="#000080">(</font>D<font color="#000080">)));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateLeapYear<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=(</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">4 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">((</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">100 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">400 </font><font color="#000080">= </font><font color="#800000">0</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateBeginOfQuarter<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">):</font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>EncodeDate<font color="#000080">(</font>Year<font color="#000080">,((</font>Month<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">) * </font><font color="#800000">3</font><font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateEndOfQuarter<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>dateBeginOfQuarter<font color="#000080">(</font>dateBeginOfQuarter<font color="#000080">(</font>D<font color="#000080">)+(</font><font color="#800000">3</font><font color="#000080">*</font><font color="#800000">31</font><font color="#000080">))-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateBeginOfWeek<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">; </font>Weekday<font color="#000080">: </font>Integer<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>D<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>DayOfWeek<font color="#000080">(</font>Result<font color="#000080">)&lt;&gt;</font>Weekday <font color="#FF0000"><b>do </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateDaysInMonth<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>const
  </b></font>DaysPerMonth<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">= (</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">28</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">,</font><font color="#800000">30</font><font color="#000080">,</font><font color="#800000">31</font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Month<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Month<font color="#000080">:=</font>dateMonth<font color="#000080">(</font>D<font color="#000080">);
  </font>Result<font color="#000080">:=</font>DaysPerMonth<font color="#000080">[</font>Month<font color="#000080">];
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Month<font color="#000080">=</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font>dateLeapYear<font color="#000080">(</font>D<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Inc<font color="#000080">(</font>Result<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateDay<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeDate<font color="#000080">(</font>D<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Day<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>dateQuicken<font color="#000080">(</font>D<font color="#000080">: </font>TDateTime<font color="#000080">; </font>Key<font color="#000080">: </font>Char<font color="#000080">): </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>const
 </b></font><font color="#008000"><i>{$IFDEF German}
  </i></font>_ToDay    <font color="#000080">= </font><font color="#800000">'H'</font><font color="#000080">;
  </font>_PrevYear <font color="#000080">= </font><font color="#800000">'J'</font><font color="#000080">;
  </font>_NextYear <font color="#000080">= </font><font color="#800000">'R'</font><font color="#000080">;
  </font>_PrevMonth<font color="#000080">= </font><font color="#800000">'M'</font><font color="#000080">;
  </font>_NextMonth<font color="#000080">= </font><font color="#800000">'T'</font><font color="#000080">;
 </font><font color="#008000"><i>{$ELSE}
  </i></font>_ToDay    <font color="#000080">= </font><font color="#800000">'H'</font><font color="#000080">;      </font><font color="#008000"><i>{ if someone knows US keys, please tell us }
  </i></font>_PrevYear <font color="#000080">= </font><font color="#800000">'J'</font><font color="#000080">;
  </font>_NextYear <font color="#000080">= </font><font color="#800000">'R'</font><font color="#000080">;
  </font>_PrevMonth<font color="#000080">= </font><font color="#800000">'M'</font><font color="#000080">;
  </font>_NextMonth<font color="#000080">= </font><font color="#800000">'T'</font><font color="#000080">;
 </font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>begin
  case </b></font>Upcase<font color="#000080">(</font>Key<font color="#000080">) </font><font color="#FF0000"><b>of                     </b></font><font color="#008000"><i>{ Quicken Date Fast Keys }
    </i></font><font color="#800000">'+'        </font><font color="#000080">: </font>Result <font color="#000080">:= </font>D<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#800000">'-'        </font><font color="#000080">: </font>Result <font color="#000080">:= </font>D<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font>_ToDay     <font color="#000080">: </font>Result <font color="#000080">:= </font>Date<font color="#000080">;
    </font>_PrevYear  <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>D <font color="#000080">&lt;&gt; </font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">)  </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">)
                                             </font><font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>dateBeginOfYear<font color="#000080">(</font>D<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>_NextYear  <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>D <font color="#000080">&lt;&gt; </font>dateEndOfYear<font color="#000080">(</font>D<font color="#000080">)    </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>dateEndOfYear<font color="#000080">(</font>D<font color="#000080">)
                                             </font><font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>dateEndOfYear<font color="#000080">(</font>Date<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font>_PrevMonth <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>D <font color="#000080">&lt;&gt; </font>dateBeginOfMonth<font color="#000080">(</font>D<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>dateBeginOfMonth<font color="#000080">(</font>D<font color="#000080">)
                                             </font><font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>dateBeginOfMonth<font color="#000080">(</font>D<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>_NextMonth <font color="#000080">: </font><font color="#FF0000"><b>if </b></font>D <font color="#000080">&lt;&gt; </font>dateEndOfMonth<font color="#000080">(</font>D<font color="#000080">)   </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">:=</font>dateEndOfMonth<font color="#000080">(</font>D<font color="#000080">)
                                             </font><font color="#FF0000"><b>else </b></font>Result<font color="#000080">:=</font>dateEndOfMonth<font color="#000080">(</font>D<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>else </b></font>Result <font color="#000080">:= </font>D<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ time functions }

</i></font><font color="#FF0000"><b>function  </b></font>timeHour<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeTime<font color="#000080">(</font>T<font color="#000080">,</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Hour<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>timeMin<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeTime<font color="#000080">(</font>T<font color="#000080">,</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Minute<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>timeSec<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DecodeTime<font color="#000080">(</font>T<font color="#000080">,</font>Hour<font color="#000080">,</font>Minute<font color="#000080">,</font>Sec<font color="#000080">,</font>Sec100<font color="#000080">);
  </font>Result<font color="#000080">:=</font>Sec<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>timeToInt<font color="#000080">(</font>T<font color="#000080">: </font>TDateTime<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>Trunc<font color="#000080">((</font>MSecsPerday <font color="#000080">* </font>T<font color="#000080">) / </font><font color="#800000">1000</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function  </b></font>timeZoneOffset<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aTimeZoneInfo <font color="#000080">: </font>TTimeZoneInformation<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>GetTimeZoneInformation<font color="#000080">(</font>aTimeZoneInfo<font color="#000080">)&lt;&gt;-</font><font color="#800000">1 </font><font color="#FF0000"><b>then
     </b></font>Result <font color="#000080">:= </font>aTimeZoneInfo<font color="#000080">.</font>Bias
  <font color="#FF0000"><b>else
     </b></font>Result <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{ Communications Functions }

</i></font><font color="#FF0000"><b>function  </b></font>comIsCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aSt<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>PreId<font color="#000080">,
  </font>PostId<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>strContainsU<font color="#000080">(</font><font color="#800000">'@compuserve.com'</font><font color="#000080">,</font>S<font color="#000080">);     </font><font color="#008000"><i>{ 28.7.96 sb This is also on CIS }
  </i></font><font color="#FF0000"><b>if not </b></font>Result <font color="#FF0000"><b>then
     if </b></font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>S<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
     try
       </b></font>aSt<font color="#000080">:=</font>S<font color="#000080">;
       </font>PreId<font color="#000080">:=</font>StrToInt<font color="#000080">(</font>strToken<font color="#000080">(</font>aSt<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">));
       </font>PostId<font color="#000080">:=</font>StrToInt<font color="#000080">(</font>aSt<font color="#000080">);
       </font>Result<font color="#000080">:=(</font>PreId <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>PostId <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">);
     </font><font color="#FF0000"><b>except
       </b></font>Result<font color="#000080">:=</font>False<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>comIsInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aSt <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>PreId<font color="#000080">,
  </font>PostId <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  try
    </b></font>aSt<font color="#000080">:=</font>S<font color="#000080">;
    </font>PreId<font color="#000080">:=</font>strToken<font color="#000080">(</font>aSt<font color="#000080">,</font><font color="#800000">'@'</font><font color="#000080">);
    </font>PostId<font color="#000080">:=</font>aSt<font color="#000080">;
    </font>Result<font color="#000080">:=(</font>Length<font color="#000080">(</font>PreId<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>PostId<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>except
    </b></font>Result<font color="#000080">:=</font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ converts a CIS adress to a correct Internet adress }
</i></font><font color="#FF0000"><b>function  </b></font>comCisToInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>P <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">'INTERNET:'</font><font color="#000080">,</font>S<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>P<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>S<font color="#000080">,</font>P<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">,</font>Length<font color="#000080">(</font>S<font color="#000080">))
  </font><font color="#FF0000"><b>else
  begin
    </b></font>Result<font color="#000080">:=</font>S<font color="#000080">;
    </font>P<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">','</font><font color="#000080">,</font>Result<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>P<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">[</font>P<font color="#000080">]:=</font><font color="#800000">'.'</font><font color="#000080">;
    </font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font><font color="#800000">'@compuserve.com'</font><font color="#000080">;     </font><font color="#008000"><i>{ 22.07.96 sb  Error }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ converts a internet adress to a correct CServe adress }
</i></font><font color="#FF0000"><b>function  </b></font>comIntToCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>P <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>p<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">'@COMPUSERVE.COM'</font><font color="#000080">,</font>strUpper<font color="#000080">(</font>S<font color="#000080">));
  </font><font color="#FF0000"><b>if </b></font>p <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>then
  begin
    </b></font>Result<font color="#000080">:=</font>strLeft<font color="#000080">(</font>S<font color="#000080">,</font>P<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font>P<font color="#000080">:=</font>Pos<font color="#000080">(</font><font color="#800000">'.'</font><font color="#000080">,</font>Result<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>P<font color="#000080">&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Result<font color="#000080">[</font>P<font color="#000080">]:=</font><font color="#800000">','</font><font color="#000080">;
  </font><font color="#FF0000"><b>end else
    </b></font>Result<font color="#000080">:=</font><font color="#800000">'INTERNET:'</font><font color="#000080">+</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ converts a fax adress to a correct CServe adress }
</i></font><font color="#FF0000"><b>function  </b></font>comFaxToCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">'FAX:'</font><font color="#000080">+</font>S<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>comNormFax<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">, </font>Fax<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Name<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>Name<font color="#000080">+</font><font color="#800000">'[fax: '</font><font color="#000080">+</font>Name<font color="#000080">+</font><font color="#800000">'@'</font><font color="#000080">+</font>strTrim<font color="#000080">(</font>Fax<font color="#000080">)+</font><font color="#800000">']'
  </font><font color="#FF0000"><b>else
     </b></font>Result<font color="#000080">:=</font><font color="#800000">'[fax: '</font><font color="#000080">+</font>strTrim<font color="#000080">(</font>Fax<font color="#000080">)+</font><font color="#800000">']'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>comNormInt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">,</font>Int<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>comIsInt<font color="#000080">(</font>Int<font color="#000080">) </font><font color="#FF0000"><b>then
     if </b></font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
        </b></font>Result <font color="#000080">:= </font>Name <font color="#000080">+ </font><font color="#800000">'|smtp: ' </font><font color="#000080">+ </font>strTrim<font color="#000080">(</font>Int<font color="#000080">)
     </font><font color="#FF0000"><b>else
        </b></font>Result <font color="#000080">:= </font><font color="#800000">'smtp: ' </font><font color="#000080">+ </font>strTrim<font color="#000080">(</font>Int<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>comNormCis<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">,</font>Cis<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Name <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
     </b></font>Result <font color="#000080">:= </font>Name <font color="#000080">+ </font><font color="#800000">'[compuserve: ' </font><font color="#000080">+ </font>strTrim<font color="#000080">(</font>Cis<font color="#000080">) + </font><font color="#800000">']'
  </font><font color="#FF0000"><b>else
     </b></font>Result <font color="#000080">:= </font><font color="#800000">'[compuserve: ' </font><font color="#000080">+ </font>strTrim<font color="#000080">(</font>Cis<font color="#000080">) + </font><font color="#800000">']'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>comNormPhone<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Phone<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>strValueAt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>At<font color="#000080">: </font>Integer<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>const
    </b></font>Seperator <font color="#000080">= </font><font color="#800000">','</font><font color="#000080">;
    </font>Str <font color="#000080">= </font><font color="#800000">'&quot;'</font><font color="#000080">;
  </font><font color="#FF0000"><b>var
    </b></font>j<font color="#000080">,</font>i<font color="#000080">: </font>Integer<font color="#000080">;
    </font>FSkip <font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
    </font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>i <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>FSkip<font color="#000080">:= </font>False<font color="#000080">;
    </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>i<font color="#000080">&lt;=</font>At <font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>j<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>S<font color="#000080">)) </font><font color="#FF0000"><b>do
    begin
      if </b></font><font color="#000080">(</font>S<font color="#000080">[</font>j<font color="#000080">]=</font>Str<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>FSkip<font color="#000080">:=</font><font color="#FF0000"><b>not </b></font>FSkip
      <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>S<font color="#000080">[</font>j<font color="#000080">]=</font>Seperator<font color="#000080">) </font><font color="#FF0000"><b>and not </b></font>FSkip <font color="#FF0000"><b>then
         </b></font>Inc<font color="#000080">(</font>i<font color="#000080">)
      </font><font color="#FF0000"><b>else if </b></font>i <font color="#000080">= </font>At <font color="#FF0000"><b>then
         </b></font>Result<font color="#000080">:=</font>Result<font color="#000080">+</font>S<font color="#000080">[</font>j<font color="#000080">];
      </font>Inc<font color="#000080">(</font>j<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>aNumber<font color="#000080">,
  </font>aCountry<font color="#000080">,
  </font>aPrefix<font color="#000080">,
  </font>aDefault<font color="#000080">,
  </font>aLocation  <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font>i          <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aDefault  <font color="#000080">:= </font><font color="#800000">'1,&quot;Hamburg&quot;,&quot;&quot;,&quot;&quot;,&quot;40&quot;,49,0,0,0,&quot;&quot;,1,&quot; &quot;'</font><font color="#000080">;
  </font>aLocation <font color="#000080">:= </font>strProfile<font color="#000080">(</font><font color="#800000">'telephon.ini'</font><font color="#000080">,</font><font color="#800000">'Locations'</font><font color="#000080">,</font><font color="#800000">'CurrentLocation'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>aLocation <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    </b></font>aLocation<font color="#000080">:=</font>strTokenAt<font color="#000080">(</font>aLocation<font color="#000080">,</font><font color="#800000">','</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>aLocation <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    begin
      </b></font>aLocation<font color="#000080">:=</font>strProfile<font color="#000080">(</font><font color="#800000">'telephon.ini'</font><font color="#000080">,</font><font color="#800000">'Locations'</font><font color="#000080">,</font><font color="#800000">'Location'</font><font color="#000080">+</font>aLocation<font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>aLocation <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
         </b></font>aDefault <font color="#000080">:= </font>aLocation<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font>aNumber<font color="#000080">:=</font>strTrim<font color="#000080">(</font>Phone<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>aNumber <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    for </b></font>i<font color="#000080">:=</font>Length<font color="#000080">(</font>aNumber<font color="#000080">) </font><font color="#FF0000"><b>downto </b></font><font color="#800000">1 </font><font color="#FF0000"><b>do
      if not </b></font><font color="#000080">(</font>aNumber<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>DIGITS<font color="#000080">) </font><font color="#FF0000"><b>then
      begin
        if </b></font>aNumber<font color="#000080">[</font>i<font color="#000080">] &lt;&gt; </font><font color="#800000">'+' </font><font color="#FF0000"><b>then </b></font>aNumber<font color="#000080">[</font>i<font color="#000080">] := </font><font color="#800000">'-'</font><font color="#000080">;
        </font><font color="#FF0000"><b>if </b></font>i <font color="#000080">&lt; </font>Length<font color="#000080">(</font>aNumber<font color="#000080">) </font><font color="#FF0000"><b>then                    </b></font><font color="#008000"><i>{ remove duplicate digits }
           </i></font><font color="#FF0000"><b>if </b></font>aNumber<font color="#000080">[</font>i<font color="#000080">]=</font>aNumber<font color="#000080">[</font>i<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">] </font><font color="#FF0000"><b>then
              </b></font>Delete<font color="#000080">(</font>aNumber<font color="#000080">,</font>i<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>if </b></font>aNumber <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
  begin
    if </b></font>aNumber<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] = </font><font color="#800000">'+' </font><font color="#FF0000"><b>then
       </b></font>aCountry <font color="#000080">:= </font>strToken<font color="#000080">(</font>aNumber<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
       </b></font>aCountry <font color="#000080">:= </font><font color="#800000">'+'</font><font color="#000080">+</font>strValueAt<font color="#000080">(</font>aDefault<font color="#000080">,</font><font color="#800000">5</font><font color="#000080">);

    </font>aNumber<font color="#000080">:=</font>strTrimChL<font color="#000080">(</font>aNumber<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>aNumber <font color="#000080">&lt;&gt; </font><font color="#800000">'' </font><font color="#FF0000"><b>then
    begin
      if </b></font>strTokenCount<font color="#000080">(</font>aNumber<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">) &gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then
         </b></font>aPrefix <font color="#000080">:= </font>strTrimChL<font color="#000080">(</font>strToken<font color="#000080">(</font>aNumber<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">),</font><font color="#800000">'0'</font><font color="#000080">)
      </font><font color="#FF0000"><b>else
         </b></font>aPrefix <font color="#000080">:= </font>strValueAt<font color="#000080">(</font>aDefault<font color="#000080">,</font><font color="#800000">4</font><font color="#000080">);

      </font>aNumber<font color="#000080">:= </font>strNicePhone<font color="#000080">(</font>strTrimChA<font color="#000080">(</font>aNumber<font color="#000080">,</font><font color="#800000">'-'</font><font color="#000080">));
      </font>Result <font color="#000080">:= </font>aCountry <font color="#000080">+ </font><font color="#800000">' ('</font><font color="#000080">+</font>aPrefix<font color="#000080">+</font><font color="#800000">') '</font><font color="#000080">+</font>aNumber<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ system functions }

{$IFDEF Win32}
</i></font><font color="#FF0000"><b>function </b></font>sysTempPath<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">1023</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SetString<font color="#000080">(</font>Result<font color="#000080">, </font>Buffer<font color="#000080">, </font>GetTempPath<font color="#000080">(</font>Sizeof<font color="#000080">(</font>Buffer<font color="#000080">)-</font><font color="#800000">1</font><font color="#000080">,</font>Buffer<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ELSE}
</i></font><font color="#FF0000"><b>function </b></font>sysTempPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetTempFileName<font color="#000080">(</font><font color="#800000">#0</font><font color="#000080">,</font><font color="#800000">'TMP'</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>Buffer<font color="#000080">);             </font><font color="#008000"><i>{ 15.07.96 sb }
  </i></font>Result<font color="#000080">:=</font>StrPas<font color="#000080">(</font>Buffer<font color="#000080">);
  </font>DeleteFile<font color="#000080">(</font>Result<font color="#000080">);
  </font>Result<font color="#000080">:=</font>ExtractFilePath<font color="#000080">(</font>Result<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>procedure </b></font>sysDelay<font color="#000080">(</font>aMs<font color="#000080">: </font>Longint<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>TickCount       <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>TickCount<font color="#000080">:=</font>GetTickCount<font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font>GetTickCount <font color="#000080">- </font>TickCount <font color="#000080">&lt; </font>aMs <font color="#FF0000"><b>do </b></font>Application<font color="#000080">.</font>ProcessMessages<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>sysBeep<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>messageBeep<font color="#000080">(</font><font color="#800000">$FFFF</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>sysColorDepth<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aDC<font color="#000080">: </font>hDC<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>try
    </b></font>aDC <font color="#000080">:= </font>GetDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
    </font>Result<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>shl </b></font><font color="#000080">(</font>GetDeviceCaps<font color="#000080">(</font>aDC<font color="#000080">,</font>PLANES<font color="#000080">) * </font>GetDeviceCaps<font color="#000080">(</font>aDC<font color="#000080">, </font>BITSPIXEL<font color="#000080">));
  </font><font color="#FF0000"><b>finally
    </b></font>ReleaseDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>aDC<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
</i></font><font color="#FF0000"><b>procedure </b></font>sysSaverRunning<font color="#000080">(</font>Active<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>aParam<font color="#000080">: </font>Longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SystemParametersInfo <font color="#000080">(</font>SPI_SCREENSAVERRUNNING<font color="#000080">, </font>Word<font color="#000080">(</font>Active<font color="#000080">),@</font>aParam<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{ registry functions }

{$IFDEF Win32 }

</i></font><font color="#FF0000"><b>function </b></font>regReadString<font color="#000080">(</font>aKey<font color="#000080">: </font>HKEY<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aRegistry <font color="#000080">: </font>TRegistry<font color="#000080">;
  </font>aPath     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>aValue    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aRegistry<font color="#000080">:=</font>TRegistry<font color="#000080">.</font>Create<font color="#000080">;
  </font><font color="#FF0000"><b>try
    with </b></font>aRegistry <font color="#FF0000"><b>do
    begin
      </b></font>RootKey<font color="#000080">:=</font>aKey<font color="#000080">;
      </font>aPath<font color="#000080">:=</font>Path<font color="#000080">;
      </font>aValue<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>aPath<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>strLastCh<font color="#000080">(</font>aPath<font color="#000080">)&lt;&gt;</font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>aValue<font color="#000080">:=</font>strLastCh<font color="#000080">(</font>aPath<font color="#000080">)+</font>aValue<font color="#000080">;
        </font>strStripLast<font color="#000080">(</font>aPath<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>OpenKey<font color="#000080">(</font>aPath<font color="#000080">,</font>True<font color="#000080">);
      </font>Result<font color="#000080">:=</font>ReadString<font color="#000080">(</font>aValue<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>aRegistry<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>regWriteString<font color="#000080">(</font>aKey<font color="#000080">: </font>HKEY<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">,</font>Value<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>aRegistry <font color="#000080">: </font>TRegistry<font color="#000080">;
  </font>aPath     <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>aValue    <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>aRegistry<font color="#000080">:=</font>TRegistry<font color="#000080">.</font>Create<font color="#000080">;
  </font><font color="#FF0000"><b>try
    with </b></font>aRegistry <font color="#FF0000"><b>do
    begin
      </b></font>RootKey<font color="#000080">:=</font>aKey<font color="#000080">;
      </font>aPath<font color="#000080">:=</font>Path<font color="#000080">;
      </font>aValue<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
      </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Length<font color="#000080">(</font>aPath<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>strLastCh<font color="#000080">(</font>aPath<font color="#000080">)&lt;&gt;</font><font color="#800000">'\'</font><font color="#000080">) </font><font color="#FF0000"><b>do
      begin
        </b></font>aValue<font color="#000080">:=</font>strLastCh<font color="#000080">(</font>aPath<font color="#000080">)+</font>aValue<font color="#000080">;
        </font>strStripLast<font color="#000080">(</font>aPath<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>OpenKey<font color="#000080">(</font>aPath<font color="#000080">,</font>True<font color="#000080">);
      </font>WriteString<font color="#000080">(</font>aValue<font color="#000080">,</font>Value<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>aRegistry<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>(*!!!
function regReadString(aKey: hKey; const Value: String): String;
var
  aTmp  : array[0..255] of char;
  aCb,
  aType : Integer;
begin
  Result:='';
  if aKey&lt;&gt; 0 then
  begin
    aCb:=Sizeof(aTmp)-1;
   { aData:=@aTmp; }
    if RegQueryValueEx(aKey,PChar(Value),nil,@aType,@aTmp,@aCb)=ERROR_SUCCESS then
       if aType=REG_SZ then Result:=String(aTmp);
  end;
end; *)

</i></font><font color="#FF0000"><b>function </b></font>regInfoString<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Value<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>aKey <font color="#000080">: </font>hKey<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>RegOpenKey<font color="#000080">(</font>HKEY_LOCAL_MACHINE<font color="#000080">,</font>REG_CURRENT_VERSION<font color="#000080">,</font>aKey<font color="#000080">)=</font>ERROR_SUCCESS <font color="#FF0000"><b>then
  begin
    </b></font>Result<font color="#000080">:=</font>regReadString<font color="#000080">(</font>aKey<font color="#000080">,</font>Value<font color="#000080">);
    </font>RegCloseKey<font color="#000080">(</font>aKey<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>regCurrentUser<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>regInfoString<font color="#000080">(</font>REG_CURRENT_USER<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>regCurrentCompany<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>regInfoString<font color="#000080">(</font>REG_CURRENT_COMPANY<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Add a shell extension to the registry }
</i></font><font color="#FF0000"><b>procedure </b></font>regWriteShellExt<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aExt<font color="#000080">,</font>aCmd<font color="#000080">,</font>aMenu<font color="#000080">,</font>aExec<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>s<font color="#000080">, </font>aPath <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  with </b></font>TRegistry<font color="#000080">.</font>Create <font color="#FF0000"><b>do
  try
    </b></font>RootKey <font color="#000080">:= </font>HKEY_CLASSES_ROOT<font color="#000080">;
    </font>aPath   <font color="#000080">:= </font>aExt<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>KeyExists<font color="#000080">(</font>aPath<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>OpenKey<font color="#000080">(</font>aPath<font color="#000080">,</font>False<font color="#000080">);
      </font>S<font color="#000080">:=</font>ReadString<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
      </font>CloseKey<font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>S<font color="#000080">&lt;&gt;</font><font color="#800000">'' </font><font color="#FF0000"><b>then
         if </b></font>KeyExists<font color="#000080">(</font>S<font color="#000080">) </font><font color="#FF0000"><b>then
            </b></font>aPath<font color="#000080">:=</font>S<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>OpenKey<font color="#000080">(</font>aPath<font color="#000080">+</font><font color="#800000">'\Shell\'</font><font color="#000080">+</font>aCmd<font color="#000080">,</font>True<font color="#000080">);
    </font>WriteString<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>aMenu<font color="#000080">);
    </font>CloseKey<font color="#000080">;

    </font>OpenKey<font color="#000080">(</font>aPath<font color="#000080">+</font><font color="#800000">'\Shell\'</font><font color="#000080">+</font>aCmd<font color="#000080">+</font><font color="#800000">'\Command'</font><font color="#000080">,</font>True<font color="#000080">);
    </font>WriteString<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">,</font>aExec <font color="#000080">+ </font><font color="#800000">' %1'</font><font color="#000080">);
    </font>CloseKey<font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}

{ other stuff }

</i></font><font color="#FF0000"><b>function </b></font>MsgBox<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aTitle<font color="#000080">,</font>aMsg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>aFlag<font color="#000080">: </font>Integer<font color="#000080">): </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>ActiveWindow <font color="#000080">: </font>hWnd<font color="#000080">;
  </font>WindowList   <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>TmpA         <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">200</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
  </font>TmpB         <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>ActiveWindow<font color="#000080">:=</font>GetActiveWindow<font color="#000080">;
  </font>WindowList<font color="#000080">:= </font>DisableTaskWindows<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>try
    </b></font>StrPCopy<font color="#000080">(</font>TmpB<font color="#000080">,</font>aTitle<font color="#000080">);
    </font>StrPCopy<font color="#000080">(</font>TmpA<font color="#000080">,</font>aMsg<font color="#000080">);
   </font><font color="#008000"><i>{$IFDEF Win32}
    </i></font>Result<font color="#000080">:=</font>Windows<font color="#000080">.</font>MessageBox<font color="#000080">(</font>Application<font color="#000080">.</font>Handle<font color="#000080">, </font>TmpA<font color="#000080">, </font>TmpB<font color="#000080">, </font>aFlag<font color="#000080">);
   </font><font color="#008000"><i>{$ELSE}
    </i></font>Result<font color="#000080">:=</font>WinProcs<font color="#000080">.</font>MessageBox<font color="#000080">(</font>Application<font color="#000080">.</font>Handle<font color="#000080">, </font>TmpA<font color="#000080">, </font>TmpB<font color="#000080">, </font>aFlag<font color="#000080">);
   </font><font color="#008000"><i>{$ENDIF}
  </i></font><font color="#FF0000"><b>finally
    </b></font>EnableTaskWindows<font color="#000080">(</font>WindowList<font color="#000080">);
    </font>SetActiveWindow<font color="#000080">(</font>ActiveWindow<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Question<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">):</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>IsWin95 <font color="#FF0000"><b>or </b></font>IsWinNT <font color="#FF0000"><b>then
    </b></font>Result<font color="#000080">:=</font>MsgBox<font color="#000080">(</font>LoadStr<font color="#000080">(</font>SMsgdlgConfirm<font color="#000080">),</font>Msg<font color="#000080">, </font>MB_ICONQUESTION <font color="#FF0000"><b>or </b></font>MB_YESNO<font color="#000080">)=</font>IDYES
  <font color="#FF0000"><b>else
    </b></font>Result<font color="#000080">:=</font>messageDlg<font color="#000080">(</font>Msg<font color="#000080">,</font>mtConfirmation<font color="#000080">,[</font>mbYes<font color="#000080">,</font>mbNo<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">)=</font>mrYes<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>Information<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>IsWin95 <font color="#FF0000"><b>or </b></font>IsWinNT <font color="#FF0000"><b>then
     </b></font>MsgBox<font color="#000080">(</font>LoadStr<font color="#000080">(</font>SMsgdlgInformation<font color="#000080">), </font>Msg<font color="#000080">, </font>MB_ICONINFORMATION <font color="#FF0000"><b>or </b></font>MB_OK <font color="#000080">)
  </font><font color="#FF0000"><b>else
     </b></font>messageDlg<font color="#000080">(</font>Msg<font color="#000080">,</font>mtInformation<font color="#000080">,[</font>mbOk<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Confirmation<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Msg<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>IsWin95 <font color="#FF0000"><b>or </b></font>IsWinNT <font color="#FF0000"><b>then
     case </b></font>MsgBox<font color="#000080">(</font>LoadStr<font color="#000080">(</font>SMsgDlgConfirm<font color="#000080">),</font>Msg<font color="#000080">,</font>MB_ICONQUESTION <font color="#FF0000"><b>or </b></font>MB_YESNOCANCEL<font color="#000080">) </font><font color="#FF0000"><b>of
       </b></font>IDYES    <font color="#000080">: </font>Result <font color="#000080">:= </font>mrYes<font color="#000080">;
       </font>IDNO     <font color="#000080">: </font>Result <font color="#000080">:= </font>mrNo<font color="#000080">;
       </font>IDCANCEL <font color="#000080">: </font>Result <font color="#000080">:= </font>mrCancel<font color="#000080">;
       </font><font color="#FF0000"><b>else       </b></font>Result <font color="#000080">:= </font>mrCancel<font color="#000080">;
     </font><font color="#FF0000"><b>end
  else
     </b></font>Result<font color="#000080">:=</font>MessageDlg<font color="#000080">(</font>Msg<font color="#000080">,</font>mtConfirmation<font color="#000080">,[</font>mbYes<font color="#000080">,</font>mbNo<font color="#000080">,</font>mbCancel<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ TPersistentRect }

</i></font><font color="#FF0000"><b>constructor </b></font>TPersistentRect<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FRect<font color="#000080">:=</font>rectSet<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">100</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRect<font color="#000080">.</font>Assign<font color="#000080">(</font>Source<font color="#000080">: </font>TPersistent<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>Value<font color="#000080">: </font>TPersistentRect<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Value <font color="#FF0000"><b>is </b></font>TPersistentRect <font color="#FF0000"><b>then
  begin
    </b></font>Value<font color="#000080">:=</font>Source <font color="#FF0000"><b>as </b></font>TPersistentRect<font color="#000080">;
    </font>FRect<font color="#000080">:=</font>rectBounds<font color="#000080">(</font>Value<font color="#000080">.</font>Left<font color="#000080">,</font>Value<font color="#000080">.</font>Top<font color="#000080">,</font>Value<font color="#000080">.</font>Width<font color="#000080">,</font>Value<font color="#000080">.</font>Height<font color="#000080">);
    </font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>Assign<font color="#000080">(</font>Source<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRect<font color="#000080">.</font>SetLeft<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Value<font color="#000080">&lt;&gt;</font>Left <font color="#FF0000"><b>then
  begin
    if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>Value<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Value<font color="#000080">,</font>False<font color="#000080">);
    </font>FRect<font color="#000080">:=</font>rectBounds<font color="#000080">(</font>Value<font color="#000080">,</font>Top<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRect<font color="#000080">.</font>SetTop<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Value<font color="#000080">&lt;&gt;</font>Top <font color="#FF0000"><b>then
  begin
    if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>Value<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Value<font color="#000080">,</font>False<font color="#000080">);
    </font>FRect<font color="#000080">:=</font>rectBounds<font color="#000080">(</font>Left<font color="#000080">,</font>Value<font color="#000080">,</font>Width<font color="#000080">,</font>Height<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRect<font color="#000080">.</font>SetHeight<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Value<font color="#000080">&lt;&gt;</font>Height <font color="#FF0000"><b>then
  begin
    if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>Value<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Value<font color="#000080">,</font>False<font color="#000080">);
    </font>FRect<font color="#000080">:=</font>rectBounds<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Width<font color="#000080">,</font>Value<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRect<font color="#000080">.</font>SetWidth<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>Value<font color="#000080">&lt;&gt;</font>Width <font color="#FF0000"><b>then
  begin
    if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
       </b></font>Value<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Value<font color="#000080">,</font>False<font color="#000080">);
    </font>FRect<font color="#000080">:=</font>rectBounds<font color="#000080">(</font>Left<font color="#000080">,</font>Top<font color="#000080">,</font>Value<font color="#000080">,</font>Height<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>TPersistentRect<font color="#000080">.</font>GetLeft<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>FRect<font color="#000080">.</font>Left<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Result<font color="#000080">,</font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>TPersistentRect<font color="#000080">.</font>GetTop<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>FRect<font color="#000080">.</font>Top<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Result<font color="#000080">,</font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>TPersistentRect<font color="#000080">.</font>GetHeight<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>rectHeight<font color="#000080">(</font>FRect<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Result<font color="#000080">,</font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>TPersistentRect<font color="#000080">.</font>GetWidth<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result<font color="#000080">:=</font>rectWidth<font color="#000080">(</font>FRect<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Assigned<font color="#000080">(</font>FOnConvert<font color="#000080">) </font><font color="#FF0000"><b>then
     </b></font>Result<font color="#000080">:=</font>FOnConvert<font color="#000080">(</font>Self<font color="#000080">,</font>Result<font color="#000080">,</font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}

{ TPersistentRegistry }

</i></font><font color="#FF0000"><b>function </b></font>TPersistentRegistry<font color="#000080">.</font>ReadComponent<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                                 </font>Owner<font color="#000080">, </font>Parent<font color="#000080">: </font>TComponent<font color="#000080">): </font>TComponent<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>DataSize  <font color="#000080">: </font>Integer<font color="#000080">;
  </font>MemStream <font color="#000080">: </font>TMemoryStream<font color="#000080">;
  </font>Reader    <font color="#000080">: </font>TReader<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>DataSize<font color="#000080">:=</font>GetDataSize<font color="#000080">(</font>Name<font color="#000080">);
  </font>MemStream <font color="#000080">:= </font>TMemoryStream<font color="#000080">.</font>Create<font color="#000080">;
  </font><font color="#FF0000"><b>try
    </b></font>MemStream<font color="#000080">.</font>SetSize<font color="#000080">(</font>DataSize<font color="#000080">);
    </font>ReadBinaryData<font color="#000080">(</font>Name<font color="#000080">,</font>MemStream<font color="#000080">.</font>Memory<font color="#000080">^,</font>DataSize<font color="#000080">);
    </font>MemStream<font color="#000080">.</font>Position <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font>Reader <font color="#000080">:= </font>TReader<font color="#000080">.</font>Create<font color="#000080">(</font>MemStream<font color="#000080">, </font><font color="#800000">256</font><font color="#000080">);
    </font><font color="#FF0000"><b>try
      </b></font>Reader<font color="#000080">.</font>Parent <font color="#000080">:= </font>Parent<font color="#000080">;
      </font>Result <font color="#000080">:= </font>Reader<font color="#000080">.</font>ReadRootComponent<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Owner <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
        try
          </b></font>Owner<font color="#000080">.</font>InsertComponent<font color="#000080">(</font>Result<font color="#000080">);
        </font><font color="#FF0000"><b>except
          </b></font>Result<font color="#000080">.</font>Free<font color="#000080">;
          </font><font color="#FF0000"><b>raise</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>finally
      </b></font>Reader<font color="#000080">.</font>Free<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>finally
    </b></font>MemStream<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPersistentRegistry<font color="#000080">.</font>WriteComponent<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Name<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Component<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>MemStream<font color="#000080">: </font>TMemoryStream<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MemStream <font color="#000080">:= </font>TMemoryStream<font color="#000080">.</font>Create<font color="#000080">;
  </font><font color="#FF0000"><b>try
    </b></font>MemStream<font color="#000080">.</font>WriteComponent<font color="#000080">(</font>Component<font color="#000080">);
    </font>WriteBinaryData<font color="#000080">(</font>Name<font color="#000080">, </font>MemStream<font color="#000080">.</font>Memory<font color="#000080">^, </font>MemStream<font color="#000080">.</font>Size<font color="#000080">);
  </font><font color="#FF0000"><b>finally
    </b></font>MemStream<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}

{ TSystemMetric }

</i></font><font color="#FF0000"><b>constructor </b></font>TSystemMetric<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">;
  </font>Update<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TSystemMetric<font color="#000080">.</font>Update<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>GetSystemPoint<font color="#000080">(</font>ax<font color="#000080">,</font>ay<font color="#000080">: </font>Integer<font color="#000080">):</font>TPoint<font color="#000080">;
  </font><font color="#FF0000"><b>begin
    </b></font>Result<font color="#000080">:=</font>Point<font color="#000080">(</font>GetSystemMetrics<font color="#000080">(</font>ax<font color="#000080">),</font>GetSystemMetrics<font color="#000080">(</font>ay<font color="#000080">));
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>FMenuHeight    <font color="#000080">:=</font>GetSystemMetrics<font color="#000080">(</font>SM_CYMENU<font color="#000080">);
  </font>FCaptionHeight <font color="#000080">:=</font>GetSystemMetrics<font color="#000080">(</font>SM_CYCAPTION<font color="#000080">);
  </font>FBorder        <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXBORDER<font color="#000080">,</font>SM_CYBORDER<font color="#000080">);
  </font>FFrame         <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXFRAME<font color="#000080">,</font>SM_CYFRAME<font color="#000080">);
  </font>FDlgFrame      <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXDLGFRAME<font color="#000080">,</font>SM_CYDLGFRAME<font color="#000080">);
  </font>FBitmap        <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXSIZE<font color="#000080">,</font>SM_CYSIZE<font color="#000080">);
  </font>FHScroll       <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXHSCROLL<font color="#000080">,</font>SM_CYHSCROLL<font color="#000080">);
  </font>FVScroll       <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXVSCROLL<font color="#000080">,</font>SM_CYVSCROLL<font color="#000080">);
  </font>FThumb         <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXHTHUMB<font color="#000080">,</font>SM_CYVTHUMB<font color="#000080">);
  </font>FFullScreen    <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXFULLSCREEN<font color="#000080">,</font>SM_CYFULLSCREEN<font color="#000080">);
  </font>FMin           <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXMIN<font color="#000080">,</font>SM_CYMIN<font color="#000080">);
  </font>FMinTrack      <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXMINTRACK<font color="#000080">,</font>SM_CYMINTRACK<font color="#000080">);
  </font>FCursor        <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXCURSOR<font color="#000080">,</font>SM_CYCURSOR<font color="#000080">);
  </font>FIcon          <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXICON<font color="#000080">,</font>SM_CYICON<font color="#000080">);
  </font>FDoubleClick   <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXDOUBLECLK<font color="#000080">,</font>SM_CYDOUBLECLK<font color="#000080">);
  </font>FIconSpacing   <font color="#000080">:=</font>GetSystemPoint<font color="#000080">(</font>SM_CXICONSPACING<font color="#000080">,</font>SM_CYICONSPACING<font color="#000080">);
  </font>FColorDepth    <font color="#000080">:=</font>sysColorDepth<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{ TDesktopCanvas }

</i></font><font color="#FF0000"><b>constructor </b></font>TDesktopCanvas<font color="#000080">.</font>Create<font color="#000080">;
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">;
  </font>DC<font color="#000080">:=</font>GetDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>Handle<font color="#000080">:=</font>DC<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>destructor  </b></font>TDesktopCanvas<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Handle<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>ReleaseDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>DC<font color="#000080">);
  </font><font color="#FF0000"><b>inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFNDEF Win32}

</i></font><font color="#FF0000"><b>procedure </b></font>DoneXProcs<font color="#000080">; </font><font color="#FF0000"><b>far</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>SysMetric<font color="#000080">.</font>Free<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{$ENDIF}

</i></font><font color="#FF0000"><b>initialization
  </b></font>Randomize<font color="#000080">;

  </font>SysMetric <font color="#000080">:= </font>TSystemMetric<font color="#000080">.</font>Create<font color="#000080">;
  </font>IsWin95   <font color="#000080">:= (</font>GetVersion <font color="#FF0000"><b>and </b></font><font color="#800000">$FF00</font><font color="#000080">) &gt;= </font><font color="#800000">$5F00</font><font color="#000080">;
  </font>IsWinNT   <font color="#000080">:= (</font>GetVersion <font color="#000080">&lt; </font><font color="#800000">$80000000</font><font color="#000080">);
  </font>IsFabula  <font color="#000080">:= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;

</font><font color="#008000"><i>{$IFDEF Win32}
  </i></font>xLanguage <font color="#000080">:= (</font>LoWord<font color="#000080">(</font>GetUserDefaultLangID<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3ff</font><font color="#000080">);
  </font><font color="#FF0000"><b>case </b></font>xLanguage <font color="#FF0000"><b>of
    </b></font>LANG_GERMAN    <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">70000</font><font color="#000080">;
    </font>LANG_ENGLISH   <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">71000</font><font color="#000080">;
    </font>LANG_SPANISH   <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">72000</font><font color="#000080">;
    </font>LANG_RUSSIAN   <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">73000</font><font color="#000080">;
    </font>LANG_ITALIAN   <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">74000</font><font color="#000080">;
    </font>LANG_FRENCH    <font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">75000</font><font color="#000080">;
    </font>LANG_PORTUGUESE<font color="#000080">: </font>xLangOfs <font color="#000080">:= </font><font color="#800000">76000</font><font color="#000080">;
    </font><font color="#FF0000"><b>else             </b></font>xLangOfs <font color="#000080">:= </font><font color="#800000">71000</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{$ENDIF}

{$IFDEF Win32}
</i></font><font color="#FF0000"><b>finalization
  </b></font>SysMetric<font color="#000080">.</font>Free<font color="#000080">;
</font><font color="#008000"><i>{$ELSE}
  </i></font>AddExitProc<font color="#000080">(</font>DoneXProcs<font color="#000080">);
</font><font color="#008000"><i>{$ENDIF}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0171.PAS">Original</a><b>]</b></p></body>
</html>
