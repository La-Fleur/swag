<html>
<head><title> "Determining which font (Large or Small)" by GREG PETERSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0440.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&quot;</font>Greg Peterson<font color="#000080">&quot; &lt;</font>maxint<font color="#000080">@</font>cwnet<font color="#000080">.</font>com<font color="#000080">&gt;

</font><font color="#FF0000"><b>Try </b></font>this<font color="#000080">:
--------------------------------------------------------------------------------
 
</font><font color="#FF0000"><b>FUNCTION </b></font>SmallFonts <font color="#000080">: </font>BOOLEAN<font color="#000080">;
</font><font color="#008000"><i>{returns TRUE if  small fonts are set, FALSE if using Large Fonts }
</i></font><font color="#FF0000"><b>VAR
  </b></font>DC <font color="#000080">: </font>HDC<font color="#000080">; </font><font color="#008000"><i>{ used to check for number of colors available }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>DC <font color="#000080">:= </font>GetDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
  </font>Result <font color="#000080">:=   (</font>GetDeviceCaps<font color="#000080">(</font>DC<font color="#000080">, </font>LOGPIXELSX<font color="#000080">) = </font><font color="#800000">96</font><font color="#000080">); 
  </font><font color="#008000"><i>{ LOGPIXELSX will = 120 if large fonts are in use }
  </i></font>ReleaseDC<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font>DC<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

--------------------------------------------------------------------------------


</font>Large<font color="#000080">/</font>Small Fonts<font color="#000080">?

</font>Gene Eighmy <font color="#000080">&lt;</font>eighmy<font color="#000080">@</font>scott<font color="#000080">.</font>net<font color="#000080">&gt;

&gt; 
&gt; </font>When my programs run <font color="#FF0000"><b>on </b></font>systems <font color="#FF0000"><b>with </b></font>small fonts<font color="#000080">, </font>I
<font color="#000080">&gt; </font>often get strange output<font color="#000080">.  </font>Labels too small <font color="#FF0000"><b>to </b></font>hold all
<font color="#000080">&gt; </font>the text<font color="#000080">, </font>leaving the right<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>the bottom<font color="#000080">, </font>unshown<font color="#000080">, </font><font color="#FF0000"><b>for
</b></font><font color="#000080">&gt; </font>instance<font color="#000080">.  </font>StringGrid<font color="#800000">'s which don'</font>t align <font color="#FF0000"><b>as </b></font>expected<font color="#000080">.
&gt; 
</font><font color="#FF0000"><b>Try </b></font>this<font color="#000080">. </font>This will rescale both the form size <font color="#FF0000"><b>and </b></font>also reform small vs<font color="#000080">. </font>large fonts<font color="#000080">. </font>Call it <font color="#FF0000"><b>in </b></font>Form<font color="#000080">.</font>FormCreate<font color="#000080">. </font>Hope this helps<font color="#000080">. 


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>unit </b></font>geScale<font color="#000080">;

</font><font color="#FF0000"><b>interface
uses </b></font>Forms<font color="#000080">, </font>Controls<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>geAutoScale<font color="#000080">(</font>MForm<font color="#000080">: </font>TForm<font color="#000080">);

</font><font color="#FF0000"><b>implementation
Type
</b></font>TFooClass <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TControl<font color="#000080">); </font><font color="#008000"><i>{ needed to get at protected }
                               { font property }


</i></font><font color="#FF0000"><b>procedure </b></font>geAutoScale<font color="#000080">(</font>MForm<font color="#000080">: </font>TForm<font color="#000080">);
</font><font color="#FF0000"><b>const
     </b></font>cScreenWidth <font color="#000080">:</font>integer <font color="#000080">= </font><font color="#800000">800</font><font color="#000080">;
     </font>cScreenHeight<font color="#000080">:</font>integer <font color="#000080">= </font><font color="#800000">600</font><font color="#000080">;
     </font>cPixelsPerInch<font color="#000080">:</font>integer<font color="#000080">= </font><font color="#800000">96</font><font color="#000080">;
     </font>cFontHeight<font color="#000080">:</font>integer   <font color="#000080">= -</font><font color="#800000">11</font><font color="#000080">;  </font><font color="#008000"><i>{Design-time value of From.Font.Height}

</i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>integer<font color="#000080">;

</font><font color="#FF0000"><b>begin
     </b></font><font color="#008000"><i>{
     IMPORTANT!! : Set Scaled Property of TForm to FALSE with Object Inspector.

     The following routine will scale the form such that it looks the same
     regardless of the screen size or pixels per inch.  The following section
     determines if the screen width differs from the design-time screen size.
     If it differs, Scaled is set true and component positions are rescaled such
     that they appear in the same screen location as the design-time location.
     }
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Screen<font color="#000080">.</font>width <font color="#000080">&amp;;</font>lt<font color="#000080">&gt; </font>cScreenWidth<font color="#000080">)</font><font color="#FF0000"><b>or</b></font><font color="#000080">(</font>Screen<font color="#000080">.</font>PixelsPerInch <font color="#000080">&lt;&gt; </font>cPixelsPerInch<font color="#000080">) </font><font color="#FF0000"><b>then
     begin
          </b></font>MForm<font color="#000080">.</font>scaled <font color="#000080">:= </font>TRUE<font color="#000080">;
          </font>MForm<font color="#000080">.</font>height <font color="#000080">:= </font>MForm<font color="#000080">.</font>height <font color="#000080">* </font>screen<font color="#000080">.</font>Height <font color="#FF0000"><b>DIV </b></font>cScreenHeight<font color="#000080">;
          </font>MForm<font color="#000080">.</font>width  <font color="#000080">:= </font>MForm<font color="#000080">.</font>width  <font color="#000080">* </font>screen<font color="#000080">.</font>width <font color="#FF0000"><b>DIV </b></font>cScreenWidth<font color="#000080">;
          </font>MForm<font color="#000080">.</font>ScaleBy<font color="#000080">(</font>screen<font color="#000080">.</font>width<font color="#000080">, </font>cScreenWidth<font color="#000080">);

     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#008000"><i>{
      This section determines if the run-time font size differs from the design-
      time font size.  If the run-time pixelsperinch differs form the design-time
      pixelsperinch, the fonts must be rescaled in order for the form to appear
      as designed.  Scaling is calculated as the ratio of the design-time font.height
      to run-time font.height.  Font.size will not work as it may equal the design-
      time value yet appear physically larger crowding and overrunning other
      components.    For instance, a form designed in 800x600 small fonts
      has a font.size of 8.  When you run the form on in 800x600 large fonts,
      font.size is also 8 but the text is noticably larger than when run in small
      font mode. This scaling will make them both appear to be the same size.
     }

     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Screen<font color="#000080">.</font>PixelsPerInch <font color="#000080">&lt;&gt; </font>cPixelsPerInch<font color="#000080">) </font><font color="#FF0000"><b>then
     begin

         for </b></font>i <font color="#000080">:= </font>MForm<font color="#000080">.</font>ControlCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>downto </b></font><font color="#800000">0 </font><font color="#FF0000"><b>do
              </b></font>TFooClass<font color="#000080">(</font>MForm<font color="#000080">.</font>Controls<font color="#000080">[</font>i<font color="#000080">]).</font>Font<font color="#000080">.</font>Height <font color="#000080">:=
               (</font>MForm<font color="#000080">.</font>Font<font color="#000080">.</font>Height <font color="#FF0000"><b>div </b></font>cFontHeight<font color="#000080">) *
                 </font>TFooClass<font color="#000080">(</font>MForm<font color="#000080">.</font>Controls<font color="#000080">[</font>i<font color="#000080">]).</font>Font<font color="#000080">.</font>Height<font color="#000080">;

     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0440.PAS">Original</a><b>]</b></p></body>
</html>
