<html>
<head><title> "String Pattern matching" by DAVID STIDOLPH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0352.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From<font color="#000080">: </font>stidolph<font color="#000080">@</font>magnet<font color="#000080">.</font>com <font color="#000080">(</font>David Stidolph<font color="#000080">)

</font>There are many times when you need <font color="#FF0000"><b>to </b></font>compare two strings<font color="#000080">, </font>but want <font color="#FF0000"><b>to
</b></font>use wild cards <font color="#FF0000"><b>in </b></font>the match <font color="#000080">- </font>all last names that <font color="#FF0000"><b>begin with </b></font><font color="#800000">'St'</font><font color="#000080">, </font>etc<font color="#000080">.
</font>The following <font color="#FF0000"><b>is </b></font>a piece <font color="#FF0000"><b>of </b></font>code I got from Sean Stanley <font color="#FF0000"><b>in </b></font>Tallahassee
Florida <font color="#FF0000"><b>in </b></font>C<font color="#000080">. </font>I translated it into Delphi an am uploading it here <font color="#FF0000"><b>for
</b></font>all <font color="#FF0000"><b>to </b></font>use<font color="#000080">. </font>I have <font color="#FF0000"><b>not </b></font>tested it extensivly<font color="#000080">, </font>but the original <font color="#FF0000"><b>function
</b></font>has been tested quite thoughly<font color="#000080">.

--------------------------------------------------------------------------------

</font><font color="#008000"><i>{
  This function takes two strings and compares them.  The first string
  can be anything, but should not contain pattern characters (* or ?).
  The pattern string can have as many of these pattern characters as you want.
  For example: MatchStrings('David Stidolph','*St*') would return True.

  Orignal code by Sean Stanley in C
  Rewritten in Delphi by David Stidolph
}
</i></font><font color="#FF0000"><b>function </b></font>MatchStrings<font color="#000080">(</font>source<font color="#000080">, </font>pattern<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>pSource<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>pPattern<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>MatchPattern<font color="#000080">(</font>element<font color="#000080">, </font>pattern<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;

    </font><font color="#FF0000"><b>function </b></font>IsPatternWild<font color="#000080">(</font>pattern<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>t<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>Result <font color="#000080">:= </font>StrScan<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if not </b></font>Result <font color="#FF0000"><b>then </b></font>Result <font color="#000080">:= </font>StrScan<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'?'</font><font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#800000">0 </font><font color="#000080">= </font>StrComp<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>True
    <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>element<font color="#000080">^ = </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pattern<font color="#000080">^ &lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>False
    <font color="#FF0000"><b>else if </b></font>element<font color="#000080">^ = </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>True
    <font color="#FF0000"><b>else begin
      case </b></font>pattern<font color="#000080">^ </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'*'</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>MatchPattern<font color="#000080">(</font>element<font color="#000080">,@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
             </b></font>Result <font color="#000080">:= </font>True
           <font color="#FF0000"><b>else
             </b></font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>pattern<font color="#000080">);
      </font><font color="#800000">'?'</font><font color="#000080">: </font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>else
        if </b></font>element<font color="#000080">^ = </font>pattern<font color="#000080">^ </font><font color="#FF0000"><b>then
          </b></font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])
        </font><font color="#FF0000"><b>else
          </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>StrPCopy<font color="#000080">(</font>pSource<font color="#000080">,</font>source<font color="#000080">);
  </font>StrPCopy<font color="#000080">(</font>pPattern<font color="#000080">,</font>pattern<font color="#000080">);
  </font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(</font>pSource<font color="#000080">,</font>pPattern<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0352.PAS">Original</a><b>]</b></p></body>
</html>
