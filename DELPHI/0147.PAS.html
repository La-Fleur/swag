<html>
<head><title> "Manage Program Icons" by ANDY COOPER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0147.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>unit </b></font>ProgIcon<font color="#000080">;

</font><font color="#008000"><i>{Please feel free to use these routines as you wish, provided you keep the comments with my name in}
{Any comments or problems then contact me, Andy Cooper - 100622.1041@COMPUSERVE.COM}


</i></font><font color="#FF0000"><b>interface

uses
  </b></font>DdeMan<font color="#000080">;

</font><font color="#008000"><i>{First parameter is a ddeClientConv that has already been created on the calling form}
</i></font><font color="#FF0000"><b>function </b></font>CreateProgManGroup<font color="#000080">(</font>DDEClient <font color="#000080">: </font>TDdeClientConv<font color="#000080">; </font>strGroup <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>function </b></font>CreateProgManItem<font color="#000080">(</font>DDEClient <font color="#000080">: </font>TDdeClientConv<font color="#000080">; </font>strGroup<font color="#000080">, </font>strItem<font color="#000080">, </font>strFile <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>implementation


function </b></font>CreateProgManGroup<font color="#000080">(</font>DDEClient <font color="#000080">: </font>TDdeClientConv<font color="#000080">; </font>strGroup <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{By Andy Cooper - 100622.1041@COMPUSERVE.COM}
</i></font><font color="#FF0000"><b>var
  </b></font>pstrCmd <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  try
    </b></font>StrPCopy <font color="#000080">(</font>pstrCmd<font color="#000080">, </font>Format<font color="#000080">(</font><font color="#800000">'[CreateGroup(%s)]'</font><font color="#000080">, [</font>strGroup<font color="#000080">]) + </font><font color="#800000">#13#10</font><font color="#000080">);
    </font>Result <font color="#000080">:= </font>DDEClient<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font>pstrCmd<font color="#000080">, </font>False<font color="#000080">);
  </font><font color="#FF0000"><b>except
    </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{try}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>CreateProgManItem<font color="#000080">(</font>DDEClient <font color="#000080">: </font>TDdeClientConv<font color="#000080">; </font>strGroup<font color="#000080">, </font>strItem<font color="#000080">, </font>strFile <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{By Andy Cooper - 100622.1041@COMPUSERVE.COM}
</i></font><font color="#FF0000"><b>var
  </b></font>pstrCmd <font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;
</font><font color="#FF0000"><b>begin
  try
    </b></font>StrPCopy <font color="#000080">(</font>pstrCmd<font color="#000080">, </font>Format<font color="#000080">(</font><font color="#800000">'[ShowGroup(%s, 1)]'</font><font color="#000080">, [</font>strGroup<font color="#000080">]) + </font><font color="#800000">#13#10</font><font color="#000080">);
    </font>DDEClient<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font>pstrCmd<font color="#000080">, </font>False<font color="#000080">);
    </font>StrPCopy <font color="#000080">(</font>pstrCmd<font color="#000080">, </font>Format<font color="#000080">(</font><font color="#800000">'[ReplaceItem(%s)]'</font><font color="#000080">, [</font>strItem<font color="#000080">]) + </font><font color="#800000">#13#10</font><font color="#000080">);
    </font>DDEClient<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font>pstrCmd<font color="#000080">, </font>False<font color="#000080">);
    </font>StrPCopy <font color="#000080">(</font>pstrCmd<font color="#000080">, </font>Format<font color="#000080">(</font><font color="#800000">'[AddItem(%s,%s' </font><font color="#000080">+ </font><font color="#800000">',,)]'</font><font color="#000080">, [</font>strFile<font color="#000080">,</font>strItem<font color="#000080">]) + </font><font color="#800000">#13#10</font><font color="#000080">);
    </font>Result <font color="#000080">:= </font>DDEClient<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font>pstrCmd<font color="#000080">, </font>False<font color="#000080">);
    </font>StrPCopy <font color="#000080">(</font>pstrCmd<font color="#000080">, </font>Format<font color="#000080">(</font><font color="#800000">'[ShowGroup(%s, 1)]'</font><font color="#000080">, [</font>strGroup<font color="#000080">]) + </font><font color="#800000">#13#10</font><font color="#000080">);
    </font>DDEClient<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font>pstrCmd<font color="#000080">, </font>False<font color="#000080">);
  </font><font color="#FF0000"><b>except
    </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{try}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0147.PAS">Original</a><b>]</b></p></body>
</html>
