<html>
<head><title> "Re: Splitter Component" by R.VENKATESH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0138.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">*****************************************************************************
</font>The following component might help you<font color="#000080">.
</font>This <font color="#FF0000"><b>is </b></font>derived from TCustomPanel
<font color="#FF0000"><b>To </b></font>install<font color="#000080">:
        </font>Put this source <font color="#FF0000"><b>in </b></font>a <font color="#FF0000"><b>unit</b></font><font color="#000080">.
        </font>Compile <font color="#FF0000"><b>to </b></font>a DCU
        Install it <font color="#FF0000"><b>on </b></font>a component palette
<font color="#FF0000"><b>To </b></font>use<font color="#000080">:
        </font><font color="#FF0000"><b>To </b></font>use <font color="#FF0000"><b>as </b></font>vertical split<font color="#000080">.
                </font><font color="#800000">1. </font>Put a panel <font color="#FF0000"><b>in </b></font>the form<font color="#000080">. </font>Align it <font color="#FF0000"><b>to </b></font>the top 
                    Let us call it DynamicPanel
                    <font color="#FF0000"><b>Set </b></font>Align <font color="#FF0000"><b>property to </b></font>alTop
                <font color="#800000">2. </font>Add the TSplitBar component<font color="#000080">,
                    </font><font color="#FF0000"><b>Set </b></font>the SplitStyle <font color="#FF0000"><b>property to </b></font>splitVertical
                    <font color="#FF0000"><b>Set </b></font>Align <font color="#FF0000"><b>property to </b></font>alTop
                     <font color="#FF0000"><b>Set </b></font>the AdjucentControl <font color="#FF0000"><b>to </b></font>DynamicPanel
               <font color="#800000">3. </font>Add a third panel <font color="#FF0000"><b>and set </b></font>Align <font color="#FF0000"><b>property to </b></font>alClient
                 <font color="#800000">4. </font>Run the application<font color="#000080">. </font>Click <font color="#FF0000"><b>and </b></font>drag the splitbar 
                <font color="#800000">5. </font><font color="#FF0000"><b>Is </b></font>this what you wanted<font color="#000080">.

</font>You can make horizontal <font color="#FF0000"><b>or </b></font>vertical split<font color="#000080">, </font>combination <font color="#FF0000"><b>of </b></font>both<font color="#000080">, </font>any no
<font color="#FF0000"><b>of </b></font>splits <font color="#FF0000"><b>in </b></font>a single form<font color="#000080">. </font>Just use the TPanel<font color="#000080">, </font>TSplitBar <font color="#FF0000"><b>and </b></font>Align
properties <font color="#FF0000"><b>with </b></font>imaginations<font color="#000080">.

**** </font>BUG <font color="#000080">****
</font><font color="#FF0000"><b>If </b></font>you assign a control <font color="#FF0000"><b>as </b></font>the AdjuscentControl <font color="#FF0000"><b>and </b></font>later delete it<font color="#000080">,
</font>this won<font color="#800000">'t be reflected in the SplitBar component. This might generate
</font>faults<font color="#000080">.
</font>There are few more improvements that can be made<font color="#000080">. </font>Correct it <font color="#FF0000"><b>and
</b></font>enjoy<font color="#000080">.
***************

</font>kind regards
R<font color="#000080">.</font>Venkatesh

<font color="#008000"><i>{ ************* The source starts here ****************** }
</i></font><font color="#FF0000"><b>unit </b></font>Splitbar<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ExtCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TSplitStyles <font color="#000080">= ( </font>splitVertical<font color="#000080">, </font>splitHorizontal <font color="#000080">);

  </font>TSplitBar <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TCustomPanel<font color="#000080">)
  </font><font color="#FF0000"><b>private
     </b></font>FSplitStyle <font color="#000080">: </font>TSplitStyles<font color="#000080">;
     </font>InResize    <font color="#000080">: </font>Boolean<font color="#000080">;
     </font>FAdjControl <font color="#000080">: </font>TWinControl<font color="#000080">;
     </font>OldX<font color="#000080">, </font>OldY  <font color="#000080">: </font>Integer<font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>SetSplitStyle<font color="#000080">(</font>TheStyle <font color="#000080">: </font>TSplitStyles<font color="#000080">);

  </font><font color="#FF0000"><b>protected
     procedure </b></font>MouseDown<font color="#000080">(</font>Button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">;
                                 </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>MouseMove<font color="#000080">( </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">; </font>X<font color="#000080">,</font>Y <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>MouseUp<font color="#000080">( </font>Button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">;
                                 </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>public
     constructor </b></font>Create<font color="#000080">( </font>AOwner <font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>published
     property </b></font>Align<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>AdjucentControl <font color="#000080">: </font>TWinControl <font color="#FF0000"><b>read </b></font>FAdjControl <font color="#FF0000"><b>write
</b></font>FAdjControl<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>Enabled<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>ShowHint<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>SplitStyle <font color="#000080">: </font>TSplitStyles <font color="#FF0000"><b>read </b></font>FSplitStyle <font color="#FF0000"><b>write
</b></font>SetSplitStyle<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{*****************************************************************************}
</i></font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TSplitBar<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>constructor </b></font>TSplitBar<font color="#000080">.</font>Create<font color="#000080">( </font>AOwner <font color="#000080">: </font>TComponent <font color="#000080">);
</font><font color="#FF0000"><b>begin
   inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
   </font>Caption     <font color="#000080">:= </font><font color="#800000">' '</font><font color="#000080">;
   </font>InResize    <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>destructor </b></font>TSplitBar<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>begin
   inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>procedure </b></font>TSplitBar<font color="#000080">.</font>SetSplitStyle<font color="#000080">(</font>TheStyle <font color="#000080">: </font>TSplitStyles<font color="#000080">);
</font><font color="#FF0000"><b>begin
   </b></font>FSplitStyle <font color="#000080">:= </font>TheStyle<font color="#000080">;
   </font><font color="#008000"><i>{ The following code is unncessory. 
      You can do this in design time itself }
   </i></font><font color="#FF0000"><b>if </b></font>TheStyle <font color="#000080">= </font>splitVertical <font color="#FF0000"><b>then
   begin
      </b></font>Align <font color="#000080">:= </font>alTop<font color="#000080">;
      </font>Cursor <font color="#000080">:= </font>crVSplit<font color="#000080">;
   </font><font color="#FF0000"><b>end
   else
   begin
      </b></font>Align <font color="#000080">:= </font>alLeft<font color="#000080">;
      </font>Cursor <font color="#000080">:= </font>crHSplit<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>procedure </b></font>TSplitBar<font color="#000080">.</font>MouseDown<font color="#000080">( </font>Button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">:
                                </font>TShiftState<font color="#000080">;   </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
   inherited </b></font>MouseDown<font color="#000080">(</font>Button<font color="#000080">, </font>Shift<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">);
   </font><font color="#FF0000"><b>If NOT </b></font>Enabled <font color="#FF0000"><b>Then </b></font>Exit<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>FAdjControl <font color="#000080">= </font><font color="#FF0000"><b>Nil then </b></font>Exit<font color="#000080">;
   </font>InResize <font color="#000080">:= </font>True<font color="#000080">;
   </font>OldX <font color="#000080">:= </font>X<font color="#000080">;
   </font>OldY <font color="#000080">:= </font>Y<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>procedure </b></font>TSplitBar<font color="#000080">.</font>MouseMove<font color="#000080">( </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">; </font>X<font color="#000080">,</font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
   inherited </b></font>MouseMove<font color="#000080">( </font>Shift<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>InResize <font color="#FF0000"><b>then
   begin
      if </b></font>FSplitStyle <font color="#000080">= </font>splitHorizontal <font color="#FF0000"><b>then
         </b></font>FAdjControl<font color="#000080">.</font>Width <font color="#000080">:= </font>FAdjControl<font color="#000080">.</font>Width <font color="#000080">+ (</font>X <font color="#000080">- </font>OldX<font color="#000080">)
      </font><font color="#FF0000"><b>else
         </b></font>FAdjControl<font color="#000080">.</font>Height <font color="#000080">:= </font>FAdjControl<font color="#000080">.</font>Height <font color="#000080">+ (</font>Y <font color="#000080">- </font>OldY<font color="#000080">)
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{.........................................................................}
</i></font><font color="#FF0000"><b>procedure </b></font>TSplitBar<font color="#000080">.</font>MouseUp<font color="#000080">( </font>Button<font color="#000080">: </font>TMouseButton<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">;
                             </font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
   inherited </b></font>MouseUp<font color="#000080">( </font>Button<font color="#000080">, </font>Shift<font color="#000080">, </font>X<font color="#000080">, </font>Y<font color="#000080">);
   </font>InResize <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{.........................................................................}

</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{ ********** End of source ********************** }
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0138.PAS">Original</a><b>]</b></p></body>
</html>
