<html>
<head><title> "Global Message handler" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0270.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#FF0000"><b>If </b></font>you display more than a few <font color="#000080">[</font>error<font color="#000080">] </font>messages <font color="#FF0000"><b>in </b></font>your application<font color="#000080">,
</font>using a simple method such <font color="#FF0000"><b>as </b></font>the following may <font color="#FF0000"><b>not </b></font>be the best approach<font color="#000080">:
</font>Application<font color="#000080">.</font>MessageBox<font color="#000080">(
  </font><font color="#800000">'File not found'</font><font color="#000080">, </font><font color="#800000">'Error'</font><font color="#000080">, </font>mb_OK <font color="#000080">);


</font>Above method <font color="#FF0000"><b>of </b></font>displaying errors will make it harder <font color="#FF0000"><b>to </b></font>modify actual
messages since they are distributed all over your application source
code<font color="#000080">. </font>It may be better <font color="#FF0000"><b>to </b></font>have a <font color="#000080">&quot;</font>centralized<font color="#000080">&quot; </font><font color="#FF0000"><b>function </b></font>that can display
error messages<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>better yet<font color="#000080">, </font>a centralized <font color="#FF0000"><b>function </b></font>that can display
replaceable error messages<font color="#000080">. </font>Consider the following example<font color="#000080">:

</font><font color="#FF0000"><b>type
  </b></font>cnMessageIDs <font color="#000080">=
    (
      </font>nMsgID_NoError<font color="#000080">,
      </font>nMsgID_FileNotFound<font color="#000080">,
      </font>nMsgID_OutOfMemory<font color="#000080">,
      </font>nMsgID_ExitProgram
      <font color="#008000"><i>// list your other error
      // IDs here...
    </i></font><font color="#000080">);

</font><font color="#FF0000"><b>const
  </b></font>csMessages_ShortVersion
    <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font>Low<font color="#000080">( </font>cnMessageIDs <font color="#000080">)..
              </font>High<font color="#000080">( </font>cnMessageIDs <font color="#000080">) ]
      </font><font color="#FF0000"><b>of </b></font>PChar <font color="#000080">=
    (
      </font><font color="#800000">'No error'</font><font color="#000080">,
      </font><font color="#800000">'File not found'</font><font color="#000080">,
      </font><font color="#800000">'Out of memory'</font><font color="#000080">,
      </font><font color="#800000">'Exit program?'
      </font><font color="#008000"><i>// other error messages...
    </i></font><font color="#000080">);

  </font>csMessages_DetailedVersion
    <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[ </font>Low<font color="#000080">( </font>cnMessageIDs <font color="#000080">)..
              </font>High<font color="#000080">( </font>cnMessageIDs <font color="#000080">) ]
      </font><font color="#FF0000"><b>of </b></font>PChar <font color="#000080">=
    (
      </font><font color="#800000">'No error; please ignore!'</font><font color="#000080">,

      </font><font color="#800000">'File c:\config.sys not found.'</font><font color="#000080">+
      </font><font color="#800000">'Contact your sys. admin.'</font><font color="#000080">,

      </font><font color="#800000">'Out of memory. You need '</font><font color="#000080">+
      </font><font color="#800000">'at least 4M for this function'</font><font color="#000080">,

      </font><font color="#800000">'Exit program? '</font><font color="#000080">+
      </font><font color="#800000">'Save your data first!'
      </font><font color="#008000"><i>// other error messages...
    </i></font><font color="#000080">);


</font><font color="#FF0000"><b>procedure </b></font>MsgDisplay<font color="#000080">(
  </font>cnMessageID <font color="#000080">: </font>cnMessageIDs <font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>// set this to False to display
  // short version of the messages
  </i></font><font color="#FF0000"><b>if</b></font><font color="#000080">( </font>True <font color="#000080">)</font><font color="#FF0000"><b>then
    </b></font>Application<font color="#000080">.</font>MessageBox<font color="#000080">(
      </font>csMessages_DetailedVersion<font color="#000080">[
        </font>cnMessageID <font color="#000080">],
      </font><font color="#800000">'Error'</font><font color="#000080">,
      </font>mb_OK <font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>Application<font color="#000080">.</font>MessageBox<font color="#000080">(
      </font>csMessages_ShortVersion<font color="#000080">[
        </font>cnMessageID <font color="#000080">],
      </font><font color="#800000">'Error'</font><font color="#000080">,
      </font>mb_OK <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>Now<font color="#000080">, </font>whenever you want <font color="#FF0000"><b>to </b></font>display an error <font color="#FF0000"><b>message</b></font><font color="#000080">, </font>you can call the
MsgDisplay<font color="#000080">() </font><font color="#FF0000"><b>function with </b></font>the <font color="#FF0000"><b>message </b></font>ID rather than typing the
<font color="#FF0000"><b>message </b></font>itself<font color="#000080">:

</font>MsgDisplay<font color="#000080">( </font>nMsgID_FileNotFound <font color="#000080">);


</font>MsgDisplay<font color="#000080">() </font><font color="#FF0000"><b>function </b></font>will <font color="#FF0000"><b>not </b></font>only let you keep all your error messages
<font color="#FF0000"><b>in </b></font>one place <font color="#000080">-- </font>inside one <font color="#FF0000"><b>unit for </b></font>example<font color="#000080">, </font>but it will also let you
keep different sets <font color="#FF0000"><b>of </b></font>error messages <font color="#000080">-- </font>novice<font color="#000080">/</font>expert<font color="#000080">, </font>debug<font color="#000080">/</font>release<font color="#000080">,
</font><font color="#FF0000"><b>and </b></font>even different sets <font color="#FF0000"><b>for </b></font>different languages<font color="#000080">.</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0270.PAS">Original</a><b>]</b></p></body>
</html>
