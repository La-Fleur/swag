<html>
<head><title> "Timer" by APOGEE INFORMATION SYSTEMS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0339.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Delphi Timer Component
Created by <font color="#000080">: </font>Adam Chace<font color="#000080">, </font>Apogee Information Systems<font color="#000080">, </font>Inc<font color="#000080">.

</font>Description <font color="#000080">:
  </font>This component enhances the Delphi timer component by allowing easier control over the interval <font color="#FF0000"><b>function</b></font><font color="#000080">. </font>Instead <font color="#FF0000"><b>of </b></font>having <font color="#FF0000"><b>to </b></font>provide the user <font color="#FF0000"><b>with </b></font>three separate edit boxes <font color="#FF0000"><b>to </b></font>control hours<font color="#000080">, </font>minutes <font color="#FF0000"><b>and </b></font>seconds<font color="#000080">, </font>developers can drop this visual component <font color="#FF0000"><b>on </b></font>their form<font color="#000080">. </font>The user <font color="#FF0000"><b>is </b></font>provided <font color="#FF0000"><b>with </b></font>spin buttons that can be used by mouse <font color="#FF0000"><b>or </b></font>keyboard <font color="#FF0000"><b>to set </b></font>the integer<font color="#000080">. </font>The developer can <font color="#FF0000"><b>then </b></font>call the <font color="#000080">&quot;</font>GetTotalSec<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font>get the total number <font color="#FF0000"><b>of </b></font>seconds represented by the time the user entered<font color="#000080">. </font>No time conversion <font color="#FF0000"><b>is </b></font>necessary<font color="#000080">.

</font>Using the Component <font color="#000080">:
  </font>The hours<font color="#000080">, </font>minutes<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>seconds can be <font color="#FF0000"><b>set </b></font>by clicking the spin button 
<font color="#FF0000"><b>to </b></font>increment<font color="#000080">/</font>decrement<font color="#000080">, </font><font color="#FF0000"><b>or </b></font>by tabbing into the individual box <font color="#FF0000"><b>and </b></font>pressing 
either the up <font color="#FF0000"><b>or </b></font>down arrow key<font color="#000080">.  </font>Values can be manually entered <font color="#FF0000"><b>as </b></font>well 
by highlighting the proper box <font color="#FF0000"><b>and </b></font>typing the desired value<font color="#000080">. </font>The developer can <font color="#FF0000"><b>then </b></font>call the <font color="#000080">&quot;</font>GetTotalSec<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font>get the total number <font color="#FF0000"><b>of </b></font>seconds represented <font color="#FF0000"><b>in </b></font>this visual component<font color="#000080">.  </font>You can <font color="#FF0000"><b>then </b></font>just <font color="#FF0000"><b>set </b></font>the timer<font color="#800000">'s &quot;interval&quot; to this value, as the interval property for a ttimer needs to be in seconds.  The component performs conversion for the number of hours, minutes and seconds into seconds.

</font>It could also be used <font color="#FF0000"><b>to </b></font>allow users <font color="#FF0000"><b>to </b></font>easily enter any time<font color="#000080">, </font>like the time a specific event occurred<font color="#000080">, </font>the time a <font color="#FF0000"><b>record </b></font>was entered etc<font color="#000080">.  </font>Simply drop this component onto the form <font color="#FF0000"><b>and </b></font>grab the data the user enters <font color="#FF0000"><b>in </b></font>it by accessing the hour<font color="#000080">, </font>minute <font color="#FF0000"><b>and </b></font>second properties <font color="#FF0000"><b>or </b></font>by calling the GetTime method which returns the time the user entered <font color="#FF0000"><b>as </b></font>a TDateTime <font color="#FF0000"><b>type</b></font><font color="#000080">.
  
</font>Key Properties <font color="#000080">:
</font>    		Hour
                <font color="#000080">----
                  </font>Integer value <font color="#FF0000"><b>of </b></font>the hour represented <font color="#FF0000"><b>in </b></font>the TaisHMSBox<font color="#000080">.
                </font>Minute
                <font color="#000080">------
                  </font>Integer value <font color="#FF0000"><b>of </b></font>the minute represented <font color="#FF0000"><b>in </b></font>the TaisHMSBox<font color="#000080">.
                </font>Second
                <font color="#000080">------
                  </font>Integer value <font color="#FF0000"><b>of </b></font>the second represented <font color="#FF0000"><b>in </b></font>the TaisHMSBox<font color="#000080">.

      </font>Methods
      <font color="#000080">=======
                </font>GetHour<font color="#000080">: </font>Integer<font color="#000080">;
                ----------------
                  </font>Returns the integer value <font color="#FF0000"><b>of </b></font>the hour<font color="#000080">(</font>s<font color="#000080">) </font>selected<font color="#000080">.

                </font>GetMinute<font color="#000080">: </font>Integer<font color="#000080">;
                -------------------
                  </font>Returns the integer value <font color="#FF0000"><b>of </b></font>the minute<font color="#000080">(</font>s<font color="#000080">) </font>selected<font color="#000080">.

                </font>GetSecond<font color="#000080">: </font>Integer<font color="#000080">;
                ------------------
                  </font>Returns the integer value <font color="#FF0000"><b>of </b></font>the second<font color="#000080">(</font>s<font color="#000080">) </font>selected<font color="#000080">.

                </font>GetTime<font color="#000080">: </font>TDateTime<font color="#000080">;
                -------------------
                  </font>Returns the time chosen <font color="#FF0000"><b>as </b></font>a TDateTime<font color="#000080">;

                </font>GetTotalSec<font color="#000080">: </font>longint<font color="#000080">;
                ---------------------
                  </font>Especially useful <font color="#FF0000"><b>for </b></font>setting timers<font color="#000080">, </font>converts the
                  time <font color="#FF0000"><b>to </b></font>seconds <font color="#FF0000"><b>and </b></font>returns this value <font color="#FF0000"><b>as </b></font>a longint<font color="#000080">.

</font>Any feedback<font color="#000080">, </font>comments<font color="#000080">, </font>etc<font color="#000080">. </font>are welcome<font color="#000080">.  </font>Please reply <font color="#FF0000"><b>to </b></font>achace<font color="#000080">@</font>apogeeis<font color="#000080">.</font>com

About Apogee Information Systems<font color="#000080">, </font>Inc<font color="#000080">.

</font>Apogee <font color="#FF0000"><b>is </b></font>an elite consulting <font color="#FF0000"><b>and </b></font>development firm specializing exclusively <font color="#FF0000"><b>in </b></font>Delphi<font color="#000080">, </font>IntraBuilder <font color="#FF0000"><b>and </b></font>Paradox<font color="#000080">.  </font>We assist clients by creating scalable desktop<font color="#000080">, </font>Client<font color="#000080">/</font>Server <font color="#FF0000"><b>and </b></font>data<font color="#000080">-</font>driven Web applications that meet critical business needs<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>more information <font color="#FF0000"><b>on </b></font>our services<font color="#000080">, </font>contact us at<font color="#000080">:

</font>Phone<font color="#000080">:</font> 	<font color="#000080">(</font><font color="#800000">508</font><font color="#000080">) </font><font color="#800000">481</font><font color="#000080">-</font><font color="#800000">1400
</font>FAX<font color="#000080">:</font>	<font color="#000080">(</font><font color="#800000">508</font><font color="#000080">) </font><font color="#800000">481</font><font color="#000080">-</font><font color="#800000">3343
</font>Email<font color="#000080">:</font>	dpainter<font color="#000080">@</font>apogeeis<font color="#000080">.</font>com

Apogee Information Systems<font color="#000080">, </font>Inc<font color="#000080">.
</font><font color="#800000">5 </font>Mount Royal Avenue
Marlboro<font color="#000080">, </font>MA <font color="#800000">01752

</font>Visit Apogee Online at http<font color="#000080">:</font><font color="#008000"><i>//www.apogeeis.com

</i></font>________________________ Copy From Here ________________________________
<font color="#008000"><i>{Copyright (c) 1996 Apogee Information Systems, Inc.}

</i></font><font color="#FF0000"><b>unit </b></font>Aishms<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ExtCtrls<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>Spin<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TaisHMSBox <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TCustomPanel<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FHourEdit<font color="#000080">: </font>TEdit<font color="#000080">;
    </font>FMinuteEdit<font color="#000080">: </font>TEdit<font color="#000080">;
    </font>FSecondEdit<font color="#000080">: </font>TEdit<font color="#000080">;
    </font>FSpin<font color="#000080">: </font>TSpinButton<font color="#000080">;
    </font>FTheOne<font color="#000080">: </font>Char<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CreateEdit <font color="#000080">: </font>TEdit<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CreateSpin<font color="#000080">: </font>TSpinButton<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>CreateLabel <font color="#000080">: </font>TLabel<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SpinUp<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SpinDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>EditOnEnter<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>EditOnExit<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>EditOnKeyDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TOBject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Key<font color="#000080">: </font>Word<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>IncHour<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>IncMinute<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>IncSecond<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>DecSecond<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>DecHour<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>DecMinute<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>IsTheOne <font color="#000080">: </font>Char <font color="#FF0000"><b>read </b></font>FTheOne <font color="#FF0000"><b>write </b></font>FTheOne<font color="#000080">;
    </font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font>fHour<font color="#000080">: </font>Integer<font color="#000080">;
    </font>fMinute <font color="#000080">: </font>Integer<font color="#000080">;
    </font>fSecond<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Paint<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetHour<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetMinute<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetSecond<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>function </b></font>GetHour<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetMinute<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetSecond<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetTotalSec<font color="#000080">: </font>longint<font color="#000080">;
    </font><font color="#FF0000"><b>function </b></font>GetTime<font color="#000080">: </font>TDateTime<font color="#000080">;
    </font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>published
    property </b></font>Color<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>BorderStyle<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>TabStop<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>TabOrder<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Hour <font color="#000080">: </font>Integer
      <font color="#FF0000"><b>read </b></font>GetHour <font color="#FF0000"><b>write </b></font>SetHour<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Minute<font color="#000080">: </font>Integer
      <font color="#FF0000"><b>read </b></font>GetMinute <font color="#FF0000"><b>write </b></font>SetMinute<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Second <font color="#000080">: </font>Integer
      <font color="#FF0000"><b>read </b></font>GetSecond <font color="#FF0000"><b>write </b></font>SetSecond<font color="#000080">;
    </font><font color="#008000"><i>{ Published declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{Return the total seconds represented by the values in hour, minute and second}
{Especially useful for use with timer components}
</i></font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>GetTotalSec <font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>tmp <font color="#000080">: </font>longint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>tmp <font color="#000080">:= (</font>fHour <font color="#000080">* </font><font color="#800000">3600</font><font color="#000080">);
  </font>tmp <font color="#000080">:= </font>tmp <font color="#000080">+ (</font>fMinute <font color="#000080">* </font><font color="#800000">60</font><font color="#000080">);
  </font>tmp <font color="#000080">:= </font>tmp <font color="#000080">+ </font>Second<font color="#000080">;
  </font>Result <font color="#000080">:= </font>tmp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{Return the time represented in the aisHMSBox}
</i></font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>GetTime<font color="#000080">: </font>TDateTime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>EncodeTime<font color="#000080">(</font>fHour<font color="#000080">, </font>fMinute<font color="#000080">, </font>fSecond<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>EditOnEnter<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Hour' </font><font color="#FF0000"><b>then
    begin
      </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clYellow<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'H'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Minute' </font><font color="#FF0000"><b>then
    begin
      </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clYellow<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'M'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Second' </font><font color="#FF0000"><b>then
    begin
      </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clYellow<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'S'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>EditOnKeyDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Key<font color="#000080">: </font>Word<font color="#000080">; </font>Shift<font color="#000080">: </font>TShiftState<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Key<font color="#000080">) = </font>VK_UP<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      Case </b></font>IsTheOne <font color="#FF0000"><b>of
       </b></font><font color="#800000">'H'</font><font color="#000080">:     </font>IncHour<font color="#000080">;
       </font><font color="#800000">'M'</font><font color="#000080">:     </font>IncMinute<font color="#000080">;
       </font><font color="#800000">'S'</font><font color="#000080">:     </font>IncSecond<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Ord<font color="#000080">(</font>Key<font color="#000080">) = </font>VK_DOWN<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      Case </b></font>IsTheOne <font color="#FF0000"><b>of
       </b></font><font color="#800000">'H'</font><font color="#000080">:     </font>DecHour<font color="#000080">;
       </font><font color="#800000">'M'</font><font color="#000080">:     </font>DecMinute<font color="#000080">;
       </font><font color="#800000">'S'</font><font color="#000080">:     </font>DecSecond<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{case}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>EditOnExit<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>newval<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Hour' </font><font color="#FF0000"><b>then
    begin
      try
        </b></font>newval <font color="#000080">:=</font>StrToInt<font color="#000080">(</font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Text<font color="#000080">);
        </font>SetHour<font color="#000080">(</font>newval<font color="#000080">);
      </font><font color="#FF0000"><b>except
        </b></font>SetHour<font color="#000080">(</font>fHour<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'N'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Minute' </font><font color="#FF0000"><b>then
    begin
      try
        </b></font>newval <font color="#000080">:=</font>StrToInt<font color="#000080">(</font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Text<font color="#000080">);
        </font>SetMinute<font color="#000080">(</font>newval<font color="#000080">);
      </font><font color="#FF0000"><b>except
       </b></font>SetMinute<font color="#000080">(</font>fMinute<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'N'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Name <font color="#000080">= </font><font color="#800000">'Second' </font><font color="#FF0000"><b>then
    begin
      try
        </b></font>newval <font color="#000080">:= </font>StrToInt<font color="#000080">(</font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Text<font color="#000080">);
        </font>SetSecond<font color="#000080">(</font>newval<font color="#000080">);
      </font><font color="#FF0000"><b>except
        </b></font>SetSecond<font color="#000080">(</font>fSecond<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>TEdit<font color="#000080">(</font>Sender<font color="#000080">).</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
      </font>IsTheOne <font color="#000080">:= </font><font color="#800000">'N'</font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>IncHour<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fHour <font color="#000080">&gt; </font><font color="#800000">23</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetHour<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetHour<font color="#000080">(</font>fHour <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>DecHour<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fHour <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetHour<font color="#000080">(</font><font color="#800000">23</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetHour<font color="#000080">(</font>fHour <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>IncMinute<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fMinute <font color="#000080">&gt; </font><font color="#800000">58</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetMinute<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetMinute<font color="#000080">(</font>fMinute <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>DecMinute<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fMinute <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetMinute<font color="#000080">(</font><font color="#800000">59</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetMinute<font color="#000080">(</font>fMinute <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>IncSecond<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fSecond <font color="#000080">&gt; </font><font color="#800000">58</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetSecond<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetSecond<font color="#000080">(</font>fSecond <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>DecSecond<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>fSecond <font color="#000080">&lt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>SetSecond<font color="#000080">(</font><font color="#800000">59</font><font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>SetSecond<font color="#000080">(</font>fSecond <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>SpinUp<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Case </b></font>IsTheOne <font color="#FF0000"><b>of
       </b></font><font color="#800000">'H'</font><font color="#000080">:     </font>IncHour<font color="#000080">;
       </font><font color="#800000">'M'</font><font color="#000080">:     </font>IncMinute<font color="#000080">;
       </font><font color="#800000">'S'</font><font color="#000080">:     </font>IncSecond<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>SpinDown<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  Case </b></font>IsTheOne <font color="#FF0000"><b>of
       </b></font><font color="#800000">'H'</font><font color="#000080">:     </font>DecHour<font color="#000080">;
       </font><font color="#800000">'M'</font><font color="#000080">:     </font>DecMinute<font color="#000080">;
       </font><font color="#800000">'S'</font><font color="#000080">:     </font>DecSecond<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>SetHour<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>fHour <font color="#000080">:= </font>Value<font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Text <font color="#000080">:= </font>IntToStr<font color="#000080">(</font>Value<font color="#000080">);
  </font>FHourEdit<font color="#000080">.</font>Repaint<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>GetHour<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>fHour<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>GetMinute<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>fMinute<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>GetSecond<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>fSecond<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>SetMinute<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>fMinute <font color="#000080">:= </font>Value<font color="#000080">;
  </font>FMinuteEdit<font color="#000080">.</font>Text <font color="#000080">:= </font>IntToStr<font color="#000080">(</font>Value<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>SetSecond<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>fSecond <font color="#000080">:= </font>Value<font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Text <font color="#000080">:= </font>IntToStr<font color="#000080">(</font>Value<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>CreateLabel<font color="#000080">: </font>TLabel<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>TLabel<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
  </font>Result<font color="#000080">.</font>Parent <font color="#000080">:= </font>self<font color="#000080">;
  </font>Result<font color="#000080">.</font>Alignment <font color="#000080">:= </font>taCenter<font color="#000080">;
  </font>Result<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'MS Sans Serif'</font><font color="#000080">;
  </font>Result<font color="#000080">.</font>Visible <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>CreateEdit<font color="#000080">: </font>TEdit<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>TEdit<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
  </font>Result<font color="#000080">.</font>Color <font color="#000080">:= </font>clWhite<font color="#000080">;
  </font>Result<font color="#000080">.</font>Parent <font color="#000080">:= </font>Self<font color="#000080">;
  </font>Result<font color="#000080">.</font>Visible <font color="#000080">:= </font>True<font color="#000080">;
  </font>Result<font color="#000080">.</font>OnKeyDown <font color="#000080">:= </font>EditOnKeyDown<font color="#000080">;
  </font>Result<font color="#000080">.</font>OnEnter <font color="#000080">:= </font>EditOnEnter<font color="#000080">;
  </font>Result<font color="#000080">.</font>OnExit <font color="#000080">:= </font>EditOnExit<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TaisHMSBox<font color="#000080">.</font>CreateSpin<font color="#000080">: </font>TSpinButton<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>TSpinButton<font color="#000080">.</font>Create<font color="#000080">(</font>Self<font color="#000080">);
  </font>Result<font color="#000080">.</font>Parent <font color="#000080">:= </font>Self<font color="#000080">;
  </font>Result<font color="#000080">.</font>OnDownClick <font color="#000080">:= </font>SpinDown<font color="#000080">;
  </font>Result<font color="#000080">.</font>OnUpClick <font color="#000080">:= </font>SpinUp<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TaisHMSBox<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>constructor </b></font>TaisHMSBox<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
  </font>BorderStyle <font color="#000080">:= </font>bsSingle<font color="#000080">;
  </font>FHourEdit <font color="#000080">:= </font>CreateEdit<font color="#000080">;
  </font>FMinuteEdit <font color="#000080">:= </font>CreateEdit<font color="#000080">;
  </font>FSecondEdit <font color="#000080">:= </font>CreateEdit<font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Name <font color="#000080">:=</font><font color="#800000">'Hour'</font><font color="#000080">;
  </font>FMinuteEdit<font color="#000080">.</font>Name <font color="#000080">:=</font><font color="#800000">'Minute'</font><font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'Second'</font><font color="#000080">;
  </font>FSpin <font color="#000080">:= </font>CreateSpin<font color="#000080">;
  </font>fHour <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>fMinute <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>fSecond <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TaisHMSBox<font color="#000080">.</font>Paint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{inherited Paint;}
  </i></font>self<font color="#000080">.</font>caption <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>self<font color="#000080">.</font>width <font color="#000080">&gt; </font><font color="#800000">125 </font><font color="#FF0000"><b>then </b></font>self<font color="#000080">.</font>width <font color="#000080">:= </font><font color="#800000">125</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>self<font color="#000080">.</font>height <font color="#000080">&gt;</font><font color="#800000">40 </font><font color="#FF0000"><b>then </b></font>self<font color="#000080">.</font>height <font color="#000080">:= </font><font color="#800000">40</font><font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Width <font color="#000080">:= (</font>self<font color="#000080">.</font>width <font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">);
  </font>FMinuteEdit<font color="#000080">.</font>Width <font color="#000080">:= (</font>self<font color="#000080">.</font>width <font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">);
  </font>FSecondEdit<font color="#000080">.</font>Width <font color="#000080">:= (</font>self<font color="#000080">.</font>width <font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">);
  </font>FHourEdit<font color="#000080">.</font>Height <font color="#000080">:= ((</font>self<font color="#000080">.</font>height <font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">6</font><font color="#000080">);
  </font>FMinuteEdit<font color="#000080">.</font>Height<font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Height<font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Height<font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Height<font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Top <font color="#000080">:= ((</font>self<font color="#000080">.</font>height <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">) - (</font>FHourEdit<font color="#000080">.</font>Height <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">));
  </font>FMinuteEdit<font color="#000080">.</font>Top <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Top<font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Top <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Top<font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Left <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  </font>FMinuteEdit<font color="#000080">.</font>Left <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Left <font color="#000080">+ </font>FMinuteEdit<font color="#000080">.</font>Width <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Left <font color="#000080">:= </font>FMinuteEdit<font color="#000080">.</font>Left <font color="#000080">+ </font>FSecondEdit<font color="#000080">.</font>Width <font color="#000080">+ </font><font color="#800000">4</font><font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'MS Sans Serif'</font><font color="#000080">;
  </font>FMinuteEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'MS Sans Serif'</font><font color="#000080">;
  </font>FSecondEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font><font color="#800000">'MS Sans Serif'</font><font color="#000080">;
  </font>FHourEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size <font color="#000080">:= (</font>FHourEdit<font color="#000080">.</font>Height <font color="#000080">- (</font>FHourEdit<font color="#000080">.</font>Height <font color="#000080">* </font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">3</font><font color="#000080">);
  </font>FSecondEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">;
  </font>FMinuteEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>FSpin <font color="#FF0000"><b>do
    begin
      </b></font>Width <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Width<font color="#000080">;
      </font>Height <font color="#000080">:= </font>self<font color="#000080">.</font>Height<font color="#000080">;
      </font>Left <font color="#000080">:= </font>self<font color="#000080">.</font>width <font color="#000080">- </font>FSpin<font color="#000080">.</font>Width<font color="#000080">;
      </font>Align <font color="#000080">:= </font>alTop<font color="#000080">;
      </font>Font<font color="#000080">.</font>Size <font color="#000080">:= </font>FHourEdit<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">;
      </font>Visible <font color="#000080">:= </font>True<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0339.PAS">Original</a><b>]</b></p></body>
</html>
