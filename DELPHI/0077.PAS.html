<html>
<head><title> "String Pattern matching" by DAVID STIDOLPH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
There are many times when you need to compare two strings, but want to use
wild cards in the match - all last names that begin with 'St', etc.  The
following is a piece of code I got from Sean Stanley in Tallahassee Florida
in C.  I translated it into Delphi an am uploading it here for all to use.
I have not tested it extensivly, but the original function has been tested
quite thoughly.

I would love feedback on this routine - or peoples changes to it.  I want to
forward them to Sean to get him to release more tidbits like this.

{
  This function takes two strings and compares them.  The first string
  can be anything, but should not contain pattern characters (* or ?).
  The pattern string can have as many of these pattern characters as you want.
  For example: MatchStrings('David Stidolph','*St*') would return True.

  Orignal code by Sean Stanley in C
  Rewritten in Delphi by David Stidolph
}
</i></font><font color="#FF0000"><b>function </b></font>MatchStrings<font color="#000080">(</font>source<font color="#000080">, </font>pattern<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>pSource<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>pPattern<font color="#000080">: </font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;

  </font><font color="#FF0000"><b>function </b></font>MatchPattern<font color="#000080">(</font>element<font color="#000080">, </font>pattern<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;

    </font><font color="#FF0000"><b>function </b></font>IsPatternWild<font color="#000080">(</font>pattern<font color="#000080">: </font>PChar<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>var
      </b></font>t<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>Result <font color="#000080">:= </font>StrScan<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if not </b></font>Result <font color="#FF0000"><b>then </b></font>Result <font color="#000080">:= </font>StrScan<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'?'</font><font color="#000080">) &lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>begin
    if </b></font><font color="#800000">0 </font><font color="#000080">= </font>StrComp<font color="#000080">(</font>pattern<font color="#000080">,</font><font color="#800000">'*'</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>True
    <font color="#FF0000"><b>else if </b></font><font color="#000080">(</font>element<font color="#000080">^ = </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>pattern<font color="#000080">^ &lt;&gt; </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">)) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>False
    <font color="#FF0000"><b>else if </b></font>element<font color="#000080">^ = </font>Chr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Result <font color="#000080">:= </font>True
    <font color="#FF0000"><b>else begin
      case </b></font>pattern<font color="#000080">^ </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'*'</font><font color="#000080">: </font><font color="#FF0000"><b>if </b></font>MatchPattern<font color="#000080">(</font>element<font color="#000080">,@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]) </font><font color="#FF0000"><b>then
             </b></font>Result <font color="#000080">:= </font>True
           <font color="#FF0000"><b>else
             </b></font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],</font>pattern<font color="#000080">);
      </font><font color="#800000">'?'</font><font color="#000080">: </font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
      </font><font color="#FF0000"><b>else
        if </b></font>element<font color="#000080">^ = </font>pattern<font color="#000080">^ </font><font color="#FF0000"><b>then
          </b></font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(@</font>element<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">],@</font>pattern<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">])
        </font><font color="#FF0000"><b>else
          </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>begin
  </b></font>StrPCopy<font color="#000080">(</font>pSource<font color="#000080">,</font>source<font color="#000080">);
  </font>StrPCopy<font color="#000080">(</font>pPattern<font color="#000080">,</font>pattern<font color="#000080">);
  </font>Result <font color="#000080">:= </font>MatchPattern<font color="#000080">(</font>pSource<font color="#000080">,</font>pPattern<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0077.PAS">Original</a><b>]</b></p></body>
</html>
