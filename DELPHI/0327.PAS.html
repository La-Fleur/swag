<html>
<head><title> "Re: Reading INI Files" by JENS SCHUMANN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0327.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Hello Nick<font color="#000080">,
</font>That<font color="#800000">'s way to use INI-files
1. </font>Add the Inifile <font color="#FF0000"><b>Unit to </b></font>your <font color="#FF0000"><b>interface uses</b></font><font color="#000080">-</font>section
<font color="#800000">2. </font>create a new <font color="#FF0000"><b>unit with </b></font>your INI<font color="#000080">-</font>defaultvalues <font color="#000080">!!!
</font><font color="#800000">3. </font>Use the OnCreate<font color="#000080">-</font>event <font color="#FF0000"><b>to </b></font>read your INI<font color="#000080">-</font><font color="#FF0000"><b>file
   procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender <font color="#000080">: </font>TObject<font color="#000080">);
   </font><font color="#FF0000"><b>var
       </b></font>Ini <font color="#000080">: </font>TInifile<font color="#000080">;
   </font><font color="#FF0000"><b>begin
     Try
     </b></font>Ini<font color="#000080">:=</font>TInfile<font color="#000080">.</font>Create<font color="#000080">(</font>write the path <font color="#FF0000"><b>and </b></font>the name <font color="#FF0000"><b>of </b></font>your INI<font color="#000080">-</font><font color="#FF0000"><b>file </b></font>here<font color="#000080">);
     </font>CheckBox1<font color="#000080">.</font>Checked<font color="#000080">:=</font>Ini<font color="#000080">.</font>ReadBool<font color="#000080">(</font><font color="#800000">'CheckBox'</font><font color="#000080">,</font><font color="#800000">'Checked'</font><font color="#000080">,</font>DefaultCheckBoxValue<font color="#000080">);
     </font>MyString<font color="#000080">:=</font>Ini<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'MyString'</font><font color="#000080">,</font><font color="#800000">'Value'</font><font color="#000080">,</font>DefaultMyStringValue<font color="#000080">);
     ...
     </font>Ini<font color="#000080">.</font>Free<font color="#000080">;
     </font><font color="#FF0000"><b>Except
       On </b></font>Exception <font color="#FF0000"><b>do
       </b></font>MessageDLG<font color="#000080">(</font><font color="#800000">'Can'</font>t read the INI<font color="#000080">-</font><font color="#FF0000"><b>File</b></font><font color="#800000">',mtError,[mbOk],0);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Try/Except}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#800000">4. </font>Create a new Form <font color="#FF0000"><b>with </b></font>an INI<font color="#000080">-</font>Dialog <font color="#FF0000"><b>with </b></font>the standard dialog<font color="#000080">-</font>elements
   Use the OnClick<font color="#000080">-</font>event <font color="#FF0000"><b>of </b></font>your OkBtn <font color="#FF0000"><b>to </b></font>write <font color="#FF0000"><b>to </b></font>your INI<font color="#000080">-</font><font color="#FF0000"><b>file
   procedure </b></font>TIniForm<font color="#000080">.</font>OkBtnClick<font color="#000080">(</font>Sender <font color="#000080">: </font>TObject<font color="#000080">);
   </font><font color="#FF0000"><b>var
       </b></font>Ini <font color="#000080">: </font>TIniFile<font color="#000080">;
   </font><font color="#FF0000"><b>begin
    Try
     </b></font>Ini<font color="#000080">:=</font>TInfile<font color="#000080">.</font>Create<font color="#000080">(</font>write the path <font color="#FF0000"><b>and </b></font>the name <font color="#FF0000"><b>of </b></font>your INI<font color="#000080">-</font><font color="#FF0000"><b>file </b></font>here<font color="#000080">);
     </font>Ini<font color="#000080">.</font>WriteBool<font color="#000080">(</font><font color="#800000">'CheckBox'</font><font color="#000080">,</font><font color="#800000">'Checked'</font><font color="#000080">,</font>CheckBox1<font color="#000080">.</font>Checked<font color="#000080">);
     </font>Ini<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'MyString'</font><font color="#000080">,</font><font color="#800000">'Value'</font><font color="#000080">,</font>MyString<font color="#000080">);
     ...
     </font>Ini<font color="#000080">.</font>Free<font color="#000080">;
     </font><font color="#FF0000"><b>Except
       On </b></font>Exception <font color="#FF0000"><b>do
       </b></font>MessageDLG<font color="#000080">(</font><font color="#800000">'Can'</font>t read the INI<font color="#000080">-</font><font color="#FF0000"><b>File</b></font><font color="#800000">',mtError,[mbOk],0);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;</font><font color="#008000"><i>{Try/Except}
   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0327.PAS">Original</a><b>]</b></p></body>
</html>
