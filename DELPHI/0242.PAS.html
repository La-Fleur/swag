<html>
<head><title> "Lars Koudal" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0242.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
Hello Gayle Davis...

I would just like to say how pleased i am with the continuing success of
SWAGS..

Below I have included some source of my own. a cd-player, that I believe
is quite nifty, anyways I like it.

I would be very pleased and honored if it was included in SWAGS...

Yours truly,

Lars Koudal


Denmark, 25th of february 1997

A bit of history:
------------------
   I am one of those people who use my cd-rom drive for playing music while I am working,
eventhough at home I have my left shoulder about 5 inches from the volume knop on my
somewhat larger stereo..

   This is a habbit from my good old days where I worked in far less equipped environments.

   Nowadays I have what I need in win95... 

   Back then though, I was never really satisfied with the cd-players out there. So I wrote
my own... I used a lot of routines grabbed from SWAGS.. (Thanks...) I always intended this
to be only for personal use, but as the program grew larger I felt like I perhaps could
earn some bucks selling the damn thing... THAT was in my young and restless days...

   I recently picked up a newer version of swags (haven't done that in more than a year),
and was very thrilled to see how alive this wonderful source of information is..

   Therefore I decided to post the small version of my program... If people want it, I will
ofcourse send the full-scale version as well.. That hasn't been fully written yet, but
the damn thing works...

   This version is called mini... Probaply due to it's small size (compared to the larger one),
but since it is some years ago, I am not quite sure... :-)

   This program uses, as mentioned before, a lot of routines and units from other people. All
grabbed here from swags... Remember! Credit where credit is due!

   When you run this damn thing, it pops up on your dos-screen with a single line...
It shows what song is playing, and how long it has been playing...

  When you press Pgup, it goes one song up. Guess what happens when you press PgDn! :-)

   Press '.' and up comes a list of songs you can pick. Just use up- and down-keys to scroll
and ENTER to make your selection...

The whole thing ends when you press ESC...

   Try to press F1 from inside the player... I had forgotten this little nifty detail until I tried
it out a few minutes ago...

   BTW: If you have a SoundBlaster in your computer, and the routines I use for detecting it
_can_ find it, you can use '+' and '-' to adjust the volume... Pretty nifty...

   I used it a lot from inside Turbo Pascal.. I made it a tool, and just pressed Shift-F5,
and there it was... pretty handy... and a lot faster... Ever used QCD (comes with SndB)??
Goddamn slow!

(If you can't figure out how to make a new tool in TP, don't bother... put the keyboard down!)


Well, so much about the past, a bit about the future..:
--------------------------------------------------------
  As I have written, this code is from my novice years. If you for some reason want to contact me,
don't do so if you just want to complain about the lousy code, the many unused variables and the many
work-arounds I did for making the whole thing work. I provide this code to
help novices people out, as I was helped myself some years ago...

If you DO decide to contact me, you can e-mail me... (Sorry, left FIDO years ago):

lkoudal@usa.net


Have fun!

Yours truly, 


Lars Koudal.



{Installation notes... Cut and paste the files to their original names, and the compile MINI.PAS... THATS IT!
Play around as much as you like...}

{CUT ... Save this as MINI.PAS }
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}


                                 </i></font><font color="#FF0000"><b>PROGRAM </b></font>mini<font color="#000080">;


</font><font color="#008000"><i>{&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;&szlig;}

{This program is determined that you start it with a color-screen
 If you don't have that, or you do not know how to change it to a monochrome
 screen, don't bother... put the keyboard down...


 Lars Koudal....

 hint: look about 15 lines down, and read the comment...
}



</i></font><font color="#FF0000"><b>USES
</b></font><font color="#008000"><i>{  effects,
}  </i></font>CD_Unit<font color="#000080">,
  </font>CD_Vars<font color="#000080">,
  </font>DOS<font color="#000080">,
  </font>CRT<font color="#000080">,
  </font>TPTimer<font color="#000080">,
  </font>TCTimer<font color="#000080">,
  </font>TPBuffer<font color="#000080">,
  </font>ScanCode<font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>TotPlayRec   <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                   </b></font>Frames<font color="#000080">,
                   </font>Seconds<font color="#000080">,
                   </font>Minutes<font color="#000080">,
                   </font>Nada     <font color="#000080">: </font>Byte<font color="#000080">;
                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>CONST
  </b></font>TextVidSeg   <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">$b800</font><font color="#000080">;
  </font>vga_segment  <font color="#000080">= </font><font color="#800000">$0A000</font><font color="#000080">;
  </font>fade_Delay   <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;
  </font>vSeg         <font color="#000080">: </font>Word <font color="#000080">= </font><font color="#800000">$B800</font><font color="#000080">;  </font><font color="#008000"><i>{change for mono}



</i></font><font color="#FF0000"><b>VAR
 </b></font>CurrIndex  <font color="#000080">: </font>Word<font color="#000080">;
 </font>ScreenLoc  <font color="#000080">: </font>Pointer<font color="#000080">;
 </font>ScrollSize <font color="#000080">: </font>Word<font color="#000080">;

  </font>vol_time     <font color="#000080">: </font>longint<font color="#000080">;
  </font>toslet       <font color="#000080">: </font>boolean<font color="#000080">;
  </font>sbfound<font color="#000080">,
  </font>portok       <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>ScrBuf<font color="#000080">,
  </font>Pdwns        <font color="#000080">: </font>Word<font color="#000080">;
  </font>origmode     <font color="#000080">: </font>word<font color="#000080">;
  </font>lcv          <font color="#000080">: </font>Integer<font color="#000080">;
  </font>temp         <font color="#000080">: </font>Char<font color="#000080">;
  </font>a1<font color="#000080">,
  </font>a2<font color="#000080">,
  </font>a3           <font color="#000080">: </font>Byte<font color="#000080">;
  </font>b1<font color="#000080">,
  </font>b2<font color="#000080">,
  </font>b3           <font color="#000080">: </font>Byte<font color="#000080">;
  </font>crc          <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>cdidstr      <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

  </font>number       <font color="#000080">: </font>Byte<font color="#000080">;
  </font>SaveExit     <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>TrackInfo    <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">99</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>PAudioTrackInfo<font color="#000080">;
  </font>I            <font color="#000080">: </font>Integer<font color="#000080">;
  </font>CH           <font color="#000080">: </font>Char<font color="#000080">;
  </font>SP<font color="#000080">,
  </font>EP           <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>LeadOut<font color="#000080">,
  </font>StartP<font color="#000080">,
  </font>TotalPlayTime<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>TotPlay      <font color="#000080">: </font>TotPlayRec<font color="#000080">;
  </font>place        <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>secs<font color="#000080">,
  </font>pps<font color="#000080">,
  </font>s            <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Track        <font color="#000080">: </font>Byte<font color="#000080">;
  </font>StartTrack<font color="#000080">,
  </font>EndTrack<font color="#000080">,
  </font>NumTracks    <font color="#000080">: </font>Integer<font color="#000080">;
  </font>Player       <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">100</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  </font>PlayTime     <font color="#000080">: </font>TotPlayRec<font color="#000080">;
  </font>result       <font color="#000080">: </font>Word<font color="#000080">;
  </font>resultchar   <font color="#000080">: </font>Char<font color="#000080">;
  </font>Hi<font color="#000080">,
  </font>Hi2          <font color="#000080">: </font>Byte<font color="#000080">;
  </font>crstyp       <font color="#000080">: </font>Word<font color="#000080">;
  </font>arbejder     <font color="#000080">: </font>Byte<font color="#000080">;

  </font>lvolume<font color="#000080">,
  </font>rvolume      <font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>{Volume-control}


  </i></font>Scroll_Lock<font color="#000080">,
  </font>Caps_Lock<font color="#000080">,
  </font>Num_Lock<font color="#000080">,
  </font>Ins<font color="#000080">,
  </font>Alt<font color="#000080">,
  </font>Ctrl<font color="#000080">,
  </font>Left_Shift<font color="#000080">,
  </font>Right_Shift  <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Bios_Keys    <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$17</font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>WaitForRetrace<font color="#000080">; </font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Asm
  </b></font><font color="#FF00FF">Mov  DX, 3DAh
  @Rep1:
  In   AL, DX
  Test AL, 08h
  JZ   @Rep1
  @Rep2:
  In   AL, DX
  Test AL, 08h
  JNZ  @Rep2
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>LeadingZero <font color="#000080">(</font>w <font color="#000080">: </font>Word<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Str <font color="#000080">(</font>w<font color="#000080">: </font><font color="#800000">0</font><font color="#000080">, </font>s<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>Length <font color="#000080">(</font>s<font color="#000080">) = </font><font color="#800000">1 </font><font color="#FF0000"><b>Then
    </b></font>s <font color="#000080">:= </font><font color="#800000">'0' </font><font color="#000080">+ </font>s<font color="#000080">;
  </font>LeadingZero <font color="#000080">:= </font>s<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Function </b></font>ITOS <font color="#000080">( </font>nNum<font color="#000080">: </font>LongInt<font color="#000080">; </font>nSpaces<font color="#000080">: </font>Integer <font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
   </b></font>s<font color="#000080">: ^</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Asm
    </b></font><font color="#FF00FF">mov     sp, BP
    push    ss
    push    Word Ptr @RESULT
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  
  </font><font color="#FF0000"><b>If </b></font>nSpaces <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>Str <font color="#000080">( </font>nNum<font color="#000080">: </font>nSpaces<font color="#000080">, </font>s<font color="#000080">^ )
  </font><font color="#FF0000"><b>Else
    </b></font>Str <font color="#000080">( </font>nNum<font color="#000080">: </font><font color="#800000">0</font><font color="#000080">, </font>s<font color="#000080">^ );
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>returnspace <font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>wantedspace<font color="#000080">: </font>Byte<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var
</b></font>i   <font color="#000080">: </font>Byte<font color="#000080">;
</font>temp <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>temp <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>Length <font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>To </b></font>wantedspace <font color="#FF0000"><b>Do
  Begin
    </b></font>temp <font color="#000080">:= </font>temp <font color="#000080">+ </font><font color="#800000">' '</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>returnspace <font color="#000080">:= </font>temp<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{home-made-calculations of which track is currently being played}
</i></font><font color="#FF0000"><b>Procedure </b></font>calctrack<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Min<font color="#000080">, </font>Sec<font color="#000080">: </font>Byte<font color="#000080">;
  </font>i<font color="#000080">: </font>Byte<font color="#000080">;
  </font>svar<font color="#000080">: </font>Boolean<font color="#000080">;
  </font><font color="#008000"><i>{**************}
  </i></font><font color="#FF0000"><b>Procedure </b></font>addtime <font color="#000080">(</font>m<font color="#000080">, </font>s<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  </b></font>Min <font color="#000080">:= </font>Min <font color="#000080">+ </font>m<font color="#000080">;
  </font>Sec <font color="#000080">:= </font>Sec <font color="#000080">+ </font>s<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Sec <font color="#000080">= </font><font color="#800000">60 </font><font color="#FF0000"><b>Then
  Begin
    </b></font>Min <font color="#000080">:= </font>Min <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>Sec <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Sec <font color="#000080">&gt; </font><font color="#800000">60 </font><font color="#FF0000"><b>Then
  Begin
    </b></font>Min <font color="#000080">:= </font>Min <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
    </font>Sec <font color="#000080">:= </font>Sec <font color="#000080">- </font><font color="#800000">60</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{**************}
{**************}
</i></font><font color="#FF0000"><b>Procedure </b></font>bigger <font color="#000080">(</font>m1<font color="#000080">, </font>s1<font color="#000080">, </font>m2<font color="#000080">, </font>s2<font color="#000080">: </font>Byte<font color="#000080">; </font>svar<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#008000"><i>{calculates whether m1:s1 is bigger than m2:s2:}
</i></font><font color="#FF0000"><b>Begin
  If </b></font><font color="#000080">(</font>m1 <font color="#000080">* </font><font color="#800000">60 </font><font color="#000080">+ </font>s1<font color="#000080">) &gt; (</font>m2 <font color="#000080">* </font><font color="#800000">60 </font><font color="#000080">+ </font>s2<font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>svar <font color="#000080">:= </font>True
  <font color="#FF0000"><b>Else </b></font>svar <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#008000"><i>{**************}

</i></font><font color="#FF0000"><b>Begin
  </b></font>track <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Min <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Sec <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>secs <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>place <font color="#000080">:= </font>Head_Location <font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);

  </font><font color="#FF0000"><b>For </b></font>i <font color="#000080">:= </font>starttrack <font color="#FF0000"><b>To </b></font>endtrack <font color="#FF0000"><b>Do
  Begin
    If </b></font>trackinfo <font color="#000080">[</font>i<font color="#000080">]^. </font>startpoint <font color="#000080">&lt; </font>place <font color="#FF0000"><b>Then
    Begin
      </b></font>track <font color="#000080">:= </font>i<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>track <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>track <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Procedure </b></font>NoTracks<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>WriteLn<font color="#000080">;
  </font>WriteLn <font color="#000080">(</font><font color="#800000">'No tracks on disk'</font><font color="#000080">);
  </font>WriteLn<font color="#000080">;
  </font>ExitProc <font color="#000080">:= </font>SaveExit<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Setup<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>TotalPlayTime <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>LeadOut <font color="#000080">:= </font>AudioDiskInfo<font color="#000080">. </font>LeadOutTrack<font color="#000080">;
  
  </font>StartTrack <font color="#000080">:= </font>AudioDiskInfo<font color="#000080">. </font>LowestTrack<font color="#000080">;
  </font>EndTrack <font color="#000080">:= </font>AudioDiskInfo<font color="#000080">. </font>HighestTrack<font color="#000080">;
  </font>NumTracks <font color="#000080">:= </font>EndTrack <font color="#000080">- </font>StartTrack <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  
  
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>StartTrack <font color="#FF0000"><b>To </b></font>EndTrack <font color="#FF0000"><b>Do
  Begin
    </b></font>Track <font color="#000080">:= </font>I<font color="#000080">;
    </font>Audio_Track_Info <font color="#000080">(</font>StartP<font color="#000080">, </font>Track<font color="#000080">);
    </font>New <font color="#000080">(</font>TrackInfo <font color="#000080">[</font>I<font color="#000080">] );
    </font>FillChar <font color="#000080">(</font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^, </font>SizeOf <font color="#000080">(</font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^), </font><font color="#800000">#0</font><font color="#000080">);
    </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>StartPoint <font color="#000080">:= </font>StartP<font color="#000080">;
    </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>TrackControl <font color="#000080">:= </font>Track<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>StartTrack <font color="#FF0000"><b>To </b></font>EndTrack <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>Do
    </b></font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>EndPoint <font color="#000080">:= </font>TrackInfo <font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]^. </font>StartPoint <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

  </font>TrackInfo <font color="#000080">[</font>EndTrack<font color="#000080">]^. </font>EndPoint <font color="#000080">:= </font>AudioDiskInfo<font color="#000080">. </font>LeadOutTrack <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>StartTrack <font color="#FF0000"><b>To </b></font>EndTrack <font color="#FF0000"><b>Do
    </b></font>Move <font color="#000080">(</font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>EndPoint<font color="#000080">, </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>Frames<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);

  </font>TrackInfo <font color="#000080">[</font>StartTrack<font color="#000080">]^. </font>PlayMin <font color="#000080">:= </font>TrackInfo <font color="#000080">[</font>StartTrack<font color="#000080">]^. </font>Minutes<font color="#000080">;
  </font>TrackInfo <font color="#000080">[</font>StartTrack<font color="#000080">]^. </font>PlaySec <font color="#000080">:= </font>TrackInfo <font color="#000080">[</font>StartTrack<font color="#000080">]^. </font>Seconds <font color="#000080">- </font><font color="#800000">2</font><font color="#000080">;

  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font>StartTrack <font color="#000080">+ </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>EndTrack <font color="#FF0000"><b>Do
  Begin
    </b></font>EP <font color="#000080">:= (</font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>Minutes <font color="#000080">* </font><font color="#800000">60</font><font color="#000080">) + </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>Seconds<font color="#000080">;
    </font>SP <font color="#000080">:= (</font>TrackInfo <font color="#000080">[</font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">]^. </font>Minutes <font color="#000080">* </font><font color="#800000">60</font><font color="#000080">) + </font>TrackInfo <font color="#000080">[</font>I <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">]^. </font>Seconds<font color="#000080">;
    </font>EP <font color="#000080">:= </font>EP <font color="#000080">- </font>SP<font color="#000080">;
    </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>PlayMin <font color="#000080">:= </font>EP <font color="#FF0000"><b>Div </b></font><font color="#800000">60</font><font color="#000080">;
    </font>TrackInfo <font color="#000080">[</font>I<font color="#000080">]^. </font>PlaySec <font color="#000080">:= </font>EP <font color="#FF0000"><b>Mod </b></font><font color="#800000">60</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>TotalPlayTime <font color="#000080">:= </font>AudioDiskInfo<font color="#000080">. </font>LeadOutTrack <font color="#000080">- </font>TrackInfo <font color="#000080">[</font>StartTrack<font color="#000080">]^. </font>StartPoint<font color="#000080">;
  </font>Move <font color="#000080">(</font>TotalPlayTime<font color="#000080">, </font>TotPlay<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>Function </b></font>KeyEnh<font color="#000080">:  </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Enh<font color="#000080">:  </font>Byte <font color="#FF0000"><b>Absolute </b></font><font color="#800000">$0040</font><font color="#000080">:</font><font color="#800000">$0096</font><font color="#000080">;
  
</font><font color="#FF0000"><b>Begin
  </b></font>KeyEnh <font color="#000080">:= </font>False<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Enh <font color="#FF0000"><b>And </b></font><font color="#800000">$10</font><font color="#000080">) = </font><font color="#800000">$10 </font><font color="#FF0000"><b>Then
    </b></font>KeyEnh <font color="#000080">:= </font>True<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>InKey <font color="#000080">(</font><font color="#FF0000"><b>Var </b></font>SCAN<font color="#000080">, </font>ASCII<font color="#000080">:  </font>Byte<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>i     <font color="#000080">:  </font>Integer<font color="#000080">;
  </font>Shift<font color="#000080">,
  </font>Ctrl<font color="#000080">,
  </font>Alt   <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Temp<font color="#000080">,
  </font>Flag1 <font color="#000080">: </font>Byte<font color="#000080">;
  </font>HEXCH<font color="#000080">,
  </font>HEXRD<font color="#000080">,
  </font>HEXFL <font color="#000080">: </font>Byte<font color="#000080">;
  </font>reg   <font color="#000080">: </font>Registers<font color="#000080">;
  
</font><font color="#FF0000"><b>Begin
  If </b></font>KeyEnh <font color="#FF0000"><b>Then
  Begin
    </b></font>HEXCH <font color="#000080">:= </font><font color="#800000">$11</font><font color="#000080">;
    </font>HEXRD <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
    </font>HEXFL <font color="#000080">:= </font><font color="#800000">$12</font><font color="#000080">;
  </font><font color="#FF0000"><b>End
  Else
  Begin
    </b></font>HEXCH <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
    </font>HEXRD <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
    </font>HEXFL <font color="#000080">:= </font><font color="#800000">$02</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  
  </font>reg<font color="#000080">. </font>AH <font color="#000080">:= </font>HEXCH<font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>reg<font color="#000080">);
  </font>i <font color="#000080">:= </font>reg<font color="#000080">. </font>Flags <font color="#FF0000"><b>And </b></font>fZero<font color="#000080">;
  
  </font>reg<font color="#000080">. </font>AH <font color="#000080">:= </font>HEXFL<font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>reg<font color="#000080">);
  </font>Flag1 <font color="#000080">:= </font>Reg<font color="#000080">. </font>AL<font color="#000080">;
  </font>Temp  <font color="#000080">:= </font>Flag1 <font color="#FF0000"><b>And </b></font><font color="#800000">$03</font><font color="#000080">;
  
  </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>SHIFT <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>SHIFT <font color="#000080">:= </font>True<font color="#000080">;
  
  </font>Temp  <font color="#000080">:= </font>Flag1 <font color="#FF0000"><b>And </b></font><font color="#800000">$04</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>CTRL <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>CTRL <font color="#000080">:= </font>True<font color="#000080">;
  
  </font>Temp  <font color="#000080">:= </font>Flag1 <font color="#FF0000"><b>And </b></font><font color="#800000">$08</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Temp <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
    </b></font>ALT  <font color="#000080">:= </font>False
  <font color="#FF0000"><b>Else
    </b></font>ALT  <font color="#000080">:= </font>True<font color="#000080">;
  
  </font><font color="#FF0000"><b>If </b></font>i <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
  Begin
    </b></font>reg<font color="#000080">. </font>AH <font color="#000080">:= </font>HEXRD<font color="#000080">;
    </font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>reg<font color="#000080">);
    </font>scan  <font color="#000080">:= </font>reg<font color="#000080">. </font>AH<font color="#000080">;
    </font>ascii <font color="#000080">:= </font>reg<font color="#000080">. </font>AL<font color="#000080">;
    </font>InKey <font color="#000080">:= </font>True<font color="#000080">;
  </font><font color="#FF0000"><b>End
  Else
    </b></font>InKey <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>UpStr <font color="#000080">(</font><font color="#FF0000"><b>CONST </b></font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>ASM
    </b></font><font color="#FF00FF">push DS
    lds  SI, s
    les  DI, @result
    lodsb            </font><font color="#008000"><i>{ load and store length of string }
    </i></font><font color="#FF00FF">stosb
    XOR  CH, CH
    mov  CL, AL
    jcxz @empty      </font><font color="#008000"><i>{ FIX for null length string }
    </i></font><font color="#FF00FF">@upperLoop:
    lodsb
    cmp  AL, 'a'
    jb   @cont
    cmp  AL, 'z'
    ja   @cont
    sub  AL, ' '
    @cont:
    stosb
    loop @UpperLoop
    @empty:
    pop  DS
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>vretrace<font color="#000080">; </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">; </font><font color="#008000"><i>{ vertical retrace }
</i></font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">mov dx,3dah
 @vert1:
  in al,dx
  test al,8
  jz @vert1
 @vert2:
  in al,dx
  test al,8
  jnz @vert2
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Setupsc<font color="#000080">(</font>Col<font color="#000080">, </font>Row<font color="#000080">, </font>ScrollSize <font color="#000080">: </font>Word<font color="#000080">; </font><font color="#FF0000"><b>Var </b></font>ScreenLoc <font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Seg1<font color="#000080">, </font>Ofs1 <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{I guess we're assuming an 80 column text mode }
   </i></font>Ofs1 <font color="#000080">:= (</font>Row<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">160 </font><font color="#000080">+ ((</font>Col<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">)*</font><font color="#800000">2</font><font color="#000080">);

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Mem<font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">:</font><font color="#800000">$49</font><font color="#000080">] = </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Seg1 <font color="#000080">:= </font><font color="#800000">$B000
     </font><font color="#FF0000"><b>else </b></font>Seg1 <font color="#000080">:= </font><font color="#800000">$B800</font><font color="#000080">;

   </font>ScreenLoc <font color="#000080">:= </font>Ptr<font color="#000080">(</font>Seg1<font color="#000080">,</font>Ofs1<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Get_svar<font color="#000080">: </font>Byte <font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>CH<font color="#000080">: </font>Char<font color="#000080">;
  </font>no_svar<font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>no_svar <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
    </b></font>CH <font color="#000080">:= </font>UpCase <font color="#000080">(</font>ReadKey<font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>CH <font color="#000080">= </font>NullKey <font color="#FF0000"><b>THEN
    BEGIN
      CASE </b></font>Ord <font color="#000080">(</font>ReadKey<font color="#000080">) </font><font color="#FF0000"><b>OF
        </b></font>dnarrow<font color="#000080">:
                </font><font color="#FF0000"><b>BEGIN
                  </b></font>get_svar <font color="#000080">:= </font>dnarrow<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>uparrow<font color="#000080">:
                </font><font color="#FF0000"><b>BEGIN
                  </b></font>get_svar <font color="#000080">:= </font>uparrow<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>lfarrow<font color="#000080">:
                </font><font color="#FF0000"><b>BEGIN
                  </b></font>get_svar <font color="#000080">:= </font>lfarrow<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>rtarrow<font color="#000080">:
                </font><font color="#FF0000"><b>BEGIN
                  </b></font>get_Svar <font color="#000080">:= </font>rtarrow<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END
    ELSE
      CASE </b></font>CH <font color="#FF0000"><b>OF
        </b></font>EnterKey  <font color="#000080">:
                   </font><font color="#FF0000"><b>BEGIN
                     </b></font>get_svar <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

        </font>EscapeKey <font color="#000080">:
                   </font><font color="#FF0000"><b>BEGIN
                     </b></font>get_svar <font color="#000080">:= </font><font color="#800000">27</font><font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>UNTIL </b></font>no_svar <font color="#000080">&lt;&gt; </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>Update<font color="#000080">;</font><font color="#FF0000"><b>Assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>ASM
   </b></font><font color="#FF00FF">CLD
   LES  DI, ScreenLoc
   MOV  CX, ScrollSize

   MOV  SI, CurrIndex
   OR   SI, SI
   JZ   @WriteString

   DEC  CX
@ShiftLeft:
   MOV  AL, ES:[DI+2]
   STOSB
   INC  DI
   LOOP @ShiftLeft

   MOV  AL, CS:[SI]
   OR   AL, AL
   JNZ  @NotEndOfStr
   MOV  SI, Offset @Message
   MOV  AL, CS:[SI]
@NotEndOfStr:
   STOSB

   INC  SI
   JMP  @SaveIndex

@WriteString:
   MOV  SI, Offset @Message
@NextChar:
   MOV  AL, CS:[SI]
   OR   AL, AL
   JZ   @WriteString
   STOSB
   INC  DI
   INC  SI
   LOOP @NextChar

@SaveIndex:
   MOV  CurrIndex, SI
   JMP  @Exit

@Message:
   DB '                                                   '
   DB '                                                   '
   DB   '(\/)ini  HELP!                        '
   DB '           Function keys available:'
   DB   '      PgUP : One track up      ...      PgDN : One track down '
   DB  '     ...      &quot;.&quot; : Pick a track using arrow keys      ...      '
   DB 'RightArrow : FastForward      ...      LeftArrow : Rewind      ...     '
   DB 'If you have a Sound Blaster you can use the &quot;+&quot; &amp; &quot;-&quot; keys to control '
   DB 'the volume.....       '
   DB   0                              </font><font color="#008000"><i>{ terminate it with NULL       }
</i></font><font color="#FF00FF">@Exit:
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>help<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>Fedup <font color="#000080">: </font>Boolean<font color="#000080">;
</font>time<font color="#000080">:</font>byte<font color="#000080">;
</font>c<font color="#000080">:</font>byte<font color="#000080">;
</font>emptystr<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font>i<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
   </b></font>fillchar<font color="#000080">(</font>emptystr<font color="#000080">,</font><font color="#800000">80</font><font color="#000080">,</font><font color="#800000">' '</font><font color="#000080">);
   </font>emptystr<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">]:=</font><font color="#800000">#80</font><font color="#000080">;
   </font>ScrollSize <font color="#000080">:= </font><font color="#800000">80</font><font color="#000080">;
   </font>Setupsc<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">,</font>wherey<font color="#000080">,</font>SCrollSize<font color="#000080">,</font>ScreenLoc<font color="#000080">);
   </font>CurrIndex <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font>time<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font>fedup<font color="#000080">:=</font>false<font color="#000080">;
   </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
   </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
   </font>write<font color="#000080">(</font>emptystr<font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font>keypressed <font color="#FF0000"><b>do </b></font>readkey<font color="#000080">;
   </font><font color="#FF0000"><b>Repeat
     </b></font>waitforretrace<font color="#000080">;
     </font>Update<font color="#000080">;
     </font><font color="#FF0000"><b>if </b></font>keypressed <font color="#FF0000"><b>then
     begin
       </b></font>c<font color="#000080">:=</font>get_svar<font color="#000080">;
       </font><font color="#FF0000"><b>if </b></font>c<font color="#000080">=</font>uparrow <font color="#FF0000"><b>then </b></font>inc<font color="#000080">(</font>time<font color="#000080">);
       </font><font color="#FF0000"><b>if </b></font>c<font color="#000080">=</font>dnarrow <font color="#FF0000"><b>then </b></font>dec<font color="#000080">(</font>time<font color="#000080">);
       </font>Fedup <font color="#000080">:= (</font>c <font color="#000080">= </font><font color="#800000">27</font><font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>Fedup<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>IntToStr <font color="#000080">(</font>I<font color="#000080">: </font>LongInt<font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#008000"><i>{Converts any integer type to a string}
</i></font><font color="#FF0000"><b>VAR
  </b></font>S<font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">11</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
  </b></font>Str <font color="#000080">(</font>I<font color="#000080">, </font>S<font color="#000080">);
  </font>IntToStr <font color="#000080">:= </font>S<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>ShowVolume<font color="#000080">;
</font><font color="#FF0000"><b>var
</b></font>i<font color="#000080">:</font>byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
    </b></font>gotoxy<font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font>wherey<font color="#000080">);
    </font>TEXTCOLOR <font color="#000080">(</font>DarkGray<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">32 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>WRITE <font color="#000080">(</font><font color="#800000">'&thorn;'</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font>TEXTCOLOR <font color="#000080">(</font>Yellow<font color="#000080">);
    </font>GOTOXY <font color="#000080">(</font><font color="#800000">33</font><font color="#000080">, </font>wherey<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>lvolume <font color="#FF0000"><b>DIV </b></font><font color="#800000">8 </font><font color="#FF0000"><b>DO
    BEGIN
      </b></font>WRITE <font color="#000080">(</font><font color="#800000">'&THORN;'</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font>vol_time<font color="#000080">:=</font>readtimer<font color="#000080">;
</font>toslet<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Cursoff<font color="#000080">;
</font><font color="#008000"><i>{ Turns the cursor off.  Stores its format for later redisplaying}
</i></font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">Mov AH, 03H
    Mov BH, 00H
    Int 10H
    Mov Crstyp, CX
    Mov AH, 01H
    Mov CX, 65535
    Int 10H
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>Curson<font color="#000080">;
</font><font color="#008000"><i>{Turns the cursor back on, using the cursor display previously stored}
</i></font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">Mov AH, 01H
    Mov CX, Crstyp
    Int 10H
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SetColor <font color="#000080">(</font>Color<font color="#000080">, </font>Red<font color="#000080">, </font>Green<font color="#000080">, </font>Blue <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{Sets the RGB-values for a given color}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>port <font color="#000080">[</font><font color="#800000">$3C8</font><font color="#000080">] := </font>Color<font color="#000080">;
  </font>port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Red<font color="#000080">;
  </font>port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Green<font color="#000080">;
  </font>port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">] := </font>Blue<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>GetColor <font color="#000080">(</font>Nr<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#FF0000"><b>VAR </b></font>R<font color="#000080">, </font>G<font color="#000080">, </font>B<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{Retrieves the RGB-values for a given color}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Port <font color="#000080">[</font><font color="#800000">$3C7</font><font color="#000080">] := </font>Nr<font color="#000080">;
  </font>R <font color="#000080">:= </font>Port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>G <font color="#000080">:= </font>Port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
  </font>B <font color="#000080">:= </font>Port <font color="#000080">[</font><font color="#800000">$3C9</font><font color="#000080">];
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>wait_4_refresh<font color="#000080">; </font><font color="#FF0000"><b>ASSEMBLER</b></font><font color="#000080">;
</font><font color="#008000"><i>{Waits for the monitors vertical retrace}
</i></font><font color="#FF0000"><b>LABEL
  </b></font>wait<font color="#000080">, </font>retr<font color="#000080">;
</font><font color="#FF0000"><b>ASM
  </b></font><font color="#FF00FF">mov  DX, 3DAh
  wait:  IN   AL, DX
  Test AL, 08h
  jz   wait
  retr:  IN   AL, DX
  Test AL, 08h
  jnz  retr
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;





</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>ISCOLOR <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{Returns FALSE for MONO or TRUE for COLOR}
</i></font><font color="#FF0000"><b>VAR
  </b></font>regs  <font color="#000080">: </font>Registers<font color="#000080">;
  </font>video_mode <font color="#000080">: </font>Integer<font color="#000080">;
  </font>equ_lo <font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Intr <font color="#000080">(</font><font color="#800000">$11</font><font color="#000080">, </font>regs<font color="#000080">);
  </font>video_mode <font color="#000080">:= </font>regs<font color="#000080">. </font>AL <font color="#FF0000"><b>AND </b></font><font color="#800000">$30</font><font color="#000080">;
  </font>video_mode <font color="#000080">:= </font>video_mode <font color="#FF0000"><b>SHR </b></font><font color="#800000">4</font><font color="#000080">;
  </font><font color="#FF0000"><b>CASE </b></font>video_mode <font color="#FF0000"><b>OF
    </b></font><font color="#800000">1 </font><font color="#000080">: </font>ISCOLOR <font color="#000080">:= </font>FALSE<font color="#000080">; </font><font color="#008000"><i>{ Monochrome }
    </i></font><font color="#800000">2 </font><font color="#000080">: </font>ISCOLOR <font color="#000080">:= </font>TRUE<font color="#008000"><i>{ Color }
  </i></font><font color="#FF0000"><b>END
END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>SAVESCR <font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>screen <font color="#000080">);
</font><font color="#008000"><i>{Saves the screen in an array of bytes}
</i></font><font color="#FF0000"><b>VAR
  </b></font>vidc <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$B800</font><font color="#000080">: </font><font color="#800000">0000</font><font color="#000080">;
  </font>vidm <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$B000</font><font color="#000080">: </font><font color="#800000">0000</font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>ISCOLOR <font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ if MONO }
    </i></font>Move <font color="#000080">(</font>vidm<font color="#000080">, </font>screen<font color="#000080">, </font><font color="#800000">6000</font><font color="#000080">)
  </font><font color="#FF0000"><b>ELSE </b></font><font color="#008000"><i>{ else COLOR }
    </i></font>Move <font color="#000080">(</font>vidc<font color="#000080">, </font>screen<font color="#000080">, </font><font color="#800000">6000</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RESTORESCR <font color="#000080">( </font><font color="#FF0000"><b>VAR </b></font>screen <font color="#000080">);
</font><font color="#008000"><i>{Restores the screen previous stored in an array of bytes}
</i></font><font color="#FF0000"><b>VAR
  </b></font>vidc <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$B800</font><font color="#000080">: </font><font color="#800000">0000</font><font color="#000080">;
  </font>vidm <font color="#000080">: </font>Byte <font color="#FF0000"><b>ABSOLUTE </b></font><font color="#800000">$B000</font><font color="#000080">: </font><font color="#800000">0000</font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF NOT </b></font>ISCOLOR <font color="#FF0000"><b>THEN </b></font><font color="#008000"><i>{ if MONO }
    </i></font>Move <font color="#000080">(</font>screen<font color="#000080">, </font>vidm<font color="#000080">, </font><font color="#800000">6000</font><font color="#000080">)
  </font><font color="#FF0000"><b>ELSE </b></font><font color="#008000"><i>{ else COLOR }
    </i></font>Move <font color="#000080">(</font>screen<font color="#000080">, </font>vidc<font color="#000080">, </font><font color="#800000">6000</font><font color="#000080">)
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>working<font color="#000080">;
</font><font color="#008000"><i>{Displays an 'working'-status on the screen}
</i></font><font color="#FF0000"><b>VAR
  </b></font>X<font color="#000080">, </font>Y<font color="#000080">: </font>Byte<font color="#000080">;
  </font>c<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>playing <font color="#FF0000"><b>THEN
  BEGIN
    </b></font>X <font color="#000080">:= </font>WhereX<font color="#000080">;
    </font>Y <font color="#000080">:= </font>WhereY<font color="#000080">;
    </font>c <font color="#000080">:= </font>TextAttr<font color="#000080">;

    </font>TextBackground <font color="#000080">(</font>Blue<font color="#000080">);
    </font>TextColor <font color="#000080">(</font>Black<font color="#000080">);
    </font>GotoXY <font color="#000080">(</font><font color="#800000">70</font><font color="#000080">, </font><font color="#800000">3</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>arbejder <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN </b></font>Write <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>arbejder <font color="#000080">= </font><font color="#800000">2 </font><font color="#FF0000"><b>THEN </b></font>Write <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>arbejder <font color="#000080">= </font><font color="#800000">3 </font><font color="#FF0000"><b>THEN </b></font>Write <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);
    </font><font color="#FF0000"><b>IF </b></font>arbejder <font color="#000080">= </font><font color="#800000">4 </font><font color="#FF0000"><b>THEN </b></font>Write <font color="#000080">(</font><font color="#800000">''</font><font color="#000080">);

    </font><font color="#FF0000"><b>IF </b></font>arbejder <font color="#000080">&lt; </font><font color="#800000">4 </font><font color="#FF0000"><b>THEN </b></font>Inc <font color="#000080">(</font>arbejder<font color="#000080">)
    </font><font color="#FF0000"><b>ELSE
      </b></font>arbejder <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
    </font>GotoXY <font color="#000080">(</font>X<font color="#000080">, </font>Y<font color="#000080">);
    </font>TextAttr <font color="#000080">:= </font>c<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>center <font color="#000080">(</font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Y<font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#008000"><i>{Centers a given string on a given line on the screen}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>GotoXY <font color="#000080">(</font><font color="#800000">40 </font><font color="#000080">- (</font>Length <font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>DIV </b></font><font color="#800000">2</font><font color="#000080">), </font>Y<font color="#000080">);
  </font>Write <font color="#000080">(</font>s<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>Function </b></font>hex<font color="#000080">(</font>a <font color="#000080">: </font>Word<font color="#000080">; </font>b <font color="#000080">: </font>Byte<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Const </b></font>digit <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">$0</font><font color="#000080">..</font><font color="#800000">$F</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char <font color="#000080">= </font><font color="#800000">'0123456789ABCDEF'</font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>i <font color="#000080">: </font>Byte<font color="#000080">;
  </font>xstring <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>xstring<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>b <font color="#FF0000"><b>Do
  Begin
    </b></font>Insert<font color="#000080">(</font>digit<font color="#000080">[</font>a <font color="#FF0000"><b>And </b></font><font color="#800000">$000F</font><font color="#000080">], </font>xstring<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">);
    </font>a<font color="#000080">:=</font>a <font color="#FF0000"><b>ShR </b></font><font color="#800000">4
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font>hex<font color="#000080">:=</font>xstring
<font color="#FF0000"><b>End</b></font><font color="#000080">; </font><font color="#008000"><i>{hex}

{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>Procedure </b></font>SoundPort<font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>xbyte1<font color="#000080">, </font>xbyte2<font color="#000080">, </font>xbyte3<font color="#000080">, </font>xbyte4<font color="#000080">: </font>Byte<font color="#000080">;
  </font>xword<font color="#000080">, </font>xword1<font color="#000080">, </font>xword2<font color="#000080">, </font>temp<font color="#000080">, </font>sbport<font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
  </b></font>sbfound<font color="#000080">:=</font>False<font color="#000080">;
  </font>xbyte1<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>xbyte1 <font color="#000080">&lt; </font><font color="#800000">7</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>sbfound<font color="#000080">) </font><font color="#FF0000"><b>Do
  Begin
    </b></font>sbport<font color="#000080">:=</font><font color="#800000">$200 </font><font color="#000080">+ (</font><font color="#800000">$10 </font><font color="#000080">* </font>xbyte1<font color="#000080">);
    </font>xword1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
    </font>portok<font color="#000080">:=</font>False<font color="#000080">;
    </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>xword1 <font color="#000080">&lt; </font><font color="#800000">$201</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>portok<font color="#000080">) </font><font color="#FF0000"><b>Do
    Begin
      If </b></font><font color="#000080">(</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0C</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
        </b></font>portok<font color="#000080">:=</font>True<font color="#000080">;
      </font>Inc<font color="#000080">(</font>xword1<font color="#000080">)
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>portok <font color="#FF0000"><b>Then
    Begin
      </b></font>xbyte3<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0C</font><font color="#000080">];
      </font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0C</font><font color="#000080">]:=</font><font color="#800000">$D3</font><font color="#000080">;
      </font><font color="#FF0000"><b>For </b></font>xword2<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">$1000 </font><font color="#FF0000"><b>Do </b></font><font color="#008000"><i>{nothing}</i></font><font color="#000080">;
      </font>xbyte4<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">];
      </font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]:=</font><font color="#800000">1</font><font color="#000080">;
      </font>xbyte2<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">];
      </font>xbyte2<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">];
      </font>xbyte2<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">];
      </font>xbyte2<font color="#000080">:=</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">];
      </font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]:=</font><font color="#800000">0</font><font color="#000080">;
      </font>xbyte2<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
      </font><font color="#FF0000"><b>Repeat
        </b></font>xword1<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
        </font>portok<font color="#000080">:=</font>False<font color="#000080">;
        </font><font color="#FF0000"><b>While </b></font><font color="#000080">(</font>xword1 <font color="#000080">&lt; </font><font color="#800000">$201</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font><font color="#FF0000"><b>Not </b></font>portok<font color="#000080">) </font><font color="#FF0000"><b>Do
        Begin
          If </b></font><font color="#000080">(</font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0E</font><font color="#000080">] </font><font color="#FF0000"><b>And </b></font><font color="#800000">$80</font><font color="#000080">) = </font><font color="#800000">$80 </font><font color="#FF0000"><b>Then
            </b></font>portok<font color="#000080">:=</font>True<font color="#000080">;
          </font>Inc<font color="#000080">(</font>xword1<font color="#000080">)
        </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>If </b></font>portok <font color="#FF0000"><b>Then
          If </b></font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0A</font><font color="#000080">] = </font><font color="#800000">$AA </font><font color="#FF0000"><b>Then
            </b></font>sbfound<font color="#000080">:=</font>True<font color="#000080">;
        </font>Inc<font color="#000080">(</font>xbyte2<font color="#000080">);
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>xbyte2 <font color="#000080">= </font><font color="#800000">$10</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>portok<font color="#000080">);
      </font><font color="#FF0000"><b>If Not </b></font>portok <font color="#FF0000"><b>Then
      Begin
        </b></font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">$0C</font><font color="#000080">]:=</font>xbyte3<font color="#000080">;
        </font>Port<font color="#000080">[</font>sbport <font color="#000080">+ </font><font color="#800000">6</font><font color="#000080">]:=</font>xbyte4<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>sbfound <font color="#FF0000"><b>Then
    Begin
    End
    Else
      </b></font>Inc<font color="#000080">(</font>xbyte1<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>pickatrack<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#008000"><i>{Displays the user with a list of tracks to pick}
</i></font><font color="#FF0000"><b>VAR
  </b></font>Top<font color="#000080">, </font>Bottom  <font color="#000080">: </font>Byte<font color="#000080">;
  </font>change      <font color="#000080">: </font>Boolean<font color="#000080">; </font><font color="#008000"><i>{scroller vi op/ned?}
  </i></font>slut        <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>i           <font color="#000080">: </font>Byte<font color="#000080">;
  </font>c           <font color="#000080">: </font>Byte<font color="#000080">;
  </font>curr        <font color="#000080">: </font>Byte<font color="#000080">;
  </font>index       <font color="#000080">: </font>Byte<font color="#000080">;
  </font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>topl<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>topl <font color="#000080">:= </font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">; </font><font color="#008000"><i>{topline}

  </i></font>pickatrack <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>s <font color="#000080">:= </font><font color="#800000">'                         '</font><font color="#000080">;
  </font>change <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>curr  <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>slut  <font color="#000080">:= </font>FALSE<font color="#000080">;
  </font>Top   <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>index <font color="#000080">:= </font>endtrack<font color="#000080">;


  </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
  </font>gotoxy<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">,</font>topl<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'Select                           '</font><font color="#000080">);

  </font>gotoxy<font color="#000080">(</font><font color="#800000">42</font><font color="#000080">,</font>topl<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);
  </font>write<font color="#000080">( </font><font color="#800000">'   &sup3;      '</font><font color="#000080">);

  </font>curr<font color="#000080">:=</font>track<font color="#000080">;
  </font><font color="#FF0000"><b>REPEAT
  BEGIN
    </b></font>TextBackground <font color="#000080">(</font>Black<font color="#000080">);
    </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
    </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font>Top <font color="#FF0000"><b>TO </b></font>Bottom <font color="#FF0000"><b>DO
    BEGIN
      </b></font>GotoXY <font color="#000080">(</font><font color="#800000">43</font><font color="#000080">, </font>topl <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">' '</font><font color="#000080">);
      </font><font color="#FF0000"><b>IF </b></font>i <font color="#000080">= </font>track <font color="#FF0000"><b>THEN
      BEGIN
        </b></font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">+ </font>Blink<font color="#000080">);
        </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>i<font color="#000080">) );
        </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
        </font>Write <font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">);
        </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">+ </font>Blink<font color="#000080">);
        </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>i<font color="#000080">]^. </font>playmin<font color="#000080">) );
        </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
        </font>Write <font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
        </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">+ </font>Blink<font color="#000080">);
        </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>i<font color="#000080">]^. </font>playsec<font color="#000080">) );
      </font><font color="#FF0000"><b>END
      ELSE
      BEGIN
        </b></font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>i<font color="#000080">) );
        </font>Write <font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">);
        </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>i<font color="#000080">]^. </font>playmin<font color="#000080">) );
        </font>Write <font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
        </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>i<font color="#000080">]^. </font>playsec<font color="#000080">) );
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>curr <font color="#000080">= </font>track <font color="#FF0000"><b>THEN
    BEGIN
      </b></font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>GotoXY <font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font>topl <font color="#000080">+  </font><font color="#800000">1</font><font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>curr<font color="#000080">) );
      </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">);
      </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>curr<font color="#000080">]^. </font>playmin<font color="#000080">) );
      </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>Write <font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
      </font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>curr<font color="#000080">]^. </font>playsec<font color="#000080">) );
    </font><font color="#FF0000"><b>END
    ELSE
    BEGIN
      </b></font>TextColor <font color="#000080">(</font>lightgray<font color="#000080">);
      </font>GotoXY <font color="#000080">(</font><font color="#800000">44</font><font color="#000080">, </font>topl <font color="#000080">+  </font><font color="#800000">1</font><font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>curr<font color="#000080">) );
      </font>Write <font color="#000080">(</font><font color="#800000">'&sup3;'</font><font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>curr<font color="#000080">]^. </font>playmin<font color="#000080">) );
      </font>Write <font color="#000080">(</font><font color="#800000">':'</font><font color="#000080">);
      </font>Write <font color="#000080">(</font>leadingzero <font color="#000080">(</font>trackinfo <font color="#000080">[</font>curr<font color="#000080">]^. </font>playsec<font color="#000080">) );
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font>textbackground<font color="#000080">(</font>black<font color="#000080">);
    </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
    </font>gotoxy<font color="#000080">(</font><font color="#800000">39</font><font color="#000080">,</font>topl<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);

    </font><font color="#FF0000"><b>if </b></font>curr<font color="#000080">=</font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'( )'</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>curr<font color="#000080">=</font>index <font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'( )'</font><font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">((</font>curr<font color="#000080">&lt;</font>index<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Curr<font color="#000080">&gt;</font><font color="#800000">1</font><font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'()'</font><font color="#000080">);

    </font><font color="#FF0000"><b>repeat
      </b></font>calctrack<font color="#000080">;
      </font>q_channel_info<font color="#000080">;
      </font>textcolor<font color="#000080">(</font>yellow<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>track<font color="#000080">));
      </font>gotoxy<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>textcolor<font color="#000080">(</font>white<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>endtrack<font color="#000080">));
      </font>textcolor<font color="#000080">(</font>yellow<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>qchannelinfo<font color="#000080">.</font>minutes<font color="#000080">));
      </font>gotoxy<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>qchannelinfo<font color="#000080">.</font>seconds<font color="#000080">));
    </font><font color="#FF0000"><b>until </b></font>keypressed<font color="#000080">;


    </font>c <font color="#000080">:= </font>get_Svar<font color="#000080">;


    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>c <font color="#000080">= </font>uparrow<font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      IF </b></font><font color="#000080">(</font>curr <font color="#000080">= </font>Top<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Top <font color="#000080">&gt; </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>Dec <font color="#000080">(</font>Top<font color="#000080">);
        </font>Dec <font color="#000080">(</font>curr<font color="#000080">);
        </font>change <font color="#000080">:= </font>TRUE<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>curr <font color="#000080">&gt; </font>Top<font color="#000080">) </font><font color="#FF0000"><b>THEN </b></font>Dec <font color="#000080">(</font>curr<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>c <font color="#000080">= </font>dnarrow<font color="#000080">) </font><font color="#FF0000"><b>THEN
    BEGIN
      IF </b></font><font color="#000080">(</font>curr <font color="#000080">&lt; </font>index<font color="#000080">)</font><font color="#FF0000"><b>THEN
      begin
        </b></font>Inc <font color="#000080">(</font>curr<font color="#000080">);
        </font>inc<font color="#000080">(</font>top<font color="#000080">);
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>c <font color="#000080">= </font><font color="#800000">100 </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>pickatrack <font color="#000080">:= </font>curr<font color="#000080">;
      </font>slut <font color="#000080">:= </font>TRUE<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font>c <font color="#000080">= </font><font color="#800000">27 </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>TextBackground <font color="#000080">(</font>Black<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">,</font>topl<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);</font>write<font color="#000080">(</font><font color="#800000">'                     '</font><font color="#000080">);
      </font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">; </font><font color="#008000"><i>{while}
  </i></font><font color="#FF0000"><b>UNTIL </b></font>slut<font color="#000080">;
  </font>TextBackground <font color="#000080">(</font>Black<font color="#000080">);
  </font>gotoxy<font color="#000080">(</font><font color="#800000">32</font><font color="#000080">,</font>topl<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">);</font>write<font color="#000080">(</font><font color="#800000">'                       '</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>colwrite <font color="#000080">(</font>col<font color="#000080">, </font>startline<font color="#000080">: </font>Byte<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#008000"><i>{Writes a given line downwards from the given column and the given startline}
</i></font><font color="#FF0000"><b>VAR
</b></font>i<font color="#000080">, </font>j<font color="#000080">: </font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>j <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>i <font color="#000080">:= </font>startline <font color="#FF0000"><b>TO </b></font>startline<font color="#000080">+ </font>Length <font color="#000080">(</font>s<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>GotoXY <font color="#000080">(</font>col<font color="#000080">, </font>i<font color="#000080">);
    </font>Write <font color="#000080">(</font>s <font color="#000080">[</font>j<font color="#000080">] );
    </font>Inc <font color="#000080">(</font>j<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;




</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>stuffthebuff<font color="#000080">;
</font><font color="#008000"><i>{Empties the buffer}
</i></font><font color="#FF0000"><b>VAR
  </b></font>chartoskip<font color="#000080">: </font>Char<font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  WHILE </b></font>KeyPressed <font color="#FF0000"><b>DO
    </b></font>chartoskip <font color="#000080">:= </font>ReadKey<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>FUNCTION </b></font>Get_Scan_Code <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>HTregs <font color="#000080">: </font>Registers<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>HTregs<font color="#000080">. </font>AH <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>HTregs<font color="#000080">);
  </font>Get_Scan_Code <font color="#000080">:= </font>HTregs<font color="#000080">. </font>AX<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;




</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>fuckthebuff<font color="#000080">;
</font><font color="#008000"><i>{Flushes the keyboard-buffer}
</i></font><font color="#FF0000"><b>BEGIN
  ASM
    </b></font><font color="#FF00FF">Mov AX, $0C00;
    Int 21h;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
{&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;&Uuml;}
</i></font><font color="#FF0000"><b>VAR
  </b></font>currtrack    <font color="#000080">: </font>Byte<font color="#000080">;
  </font>ieren        <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>slut         <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>newtrack     <font color="#000080">: </font>Byte<font color="#000080">;
  </font>xkor<font color="#000080">,
  </font>ykor         <font color="#000080">: </font>Byte<font color="#000080">;
  </font>timepassed<font color="#000080">:</font>longint<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>origmode     <font color="#000080">:= </font>LastMode<font color="#000080">;
  </font>cursoff<font color="#000080">;
  </font>soundport<font color="#000080">;
  </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">48</font><font color="#000080">;
  </font>lvolume <font color="#000080">:= </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">];
  </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">49</font><font color="#000080">;
  </font>rvolume <font color="#000080">:= </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">];
  </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">65</font><font color="#000080">;


  </font>xkor         <font color="#000080">:= </font>WhereX<font color="#000080">;
  </font>ykor         <font color="#000080">:= </font>WhereY<font color="#000080">;
  </font>TextColor <font color="#000080">(</font>LightGray<font color="#000080">);
  </font>TextBackground <font color="#000080">(</font>Black<font color="#000080">);

  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>white<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'(\/)ini'</font><font color="#000080">);
  </font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
  </font>writeln<font color="#000080">(</font><font color="#800000">'  v.1   Checking CD-ROM ... '</font><font color="#000080">);

  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
  </font>Audio_Disk_Info<font color="#000080">;
  </font>Setup<font color="#000080">;

  </font><font color="#FF0000"><b>IF </b></font>AudioDiskInfo<font color="#000080">. </font>HighestTrack <font color="#000080">&lt; </font><font color="#800000">1 </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>delay<font color="#000080">(</font><font color="#800000">200</font><font color="#000080">);
    </font>Audio_Disk_Info<font color="#000080">;
    </font>Setup<font color="#000080">;
    </font>WriteLn <font color="#000080">(</font><font color="#800000">'Not an audio-CD!'</font><font color="#000080">);
    </font>curson<font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);

  </font>gotoxy<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">,</font>wherey<font color="#000080">);
  </font>write<font color="#000080">(</font><font color="#800000">'(\/)ini  v.1     xx/xx xx:XX                                           L/th 1996'</font><font color="#000080">);
  </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);


  </font>gotoxy<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">,</font>wherey<font color="#000080">);
  </font>slut <font color="#000080">:= </font>FALSE<font color="#000080">;

  </font>textcolor<font color="#000080">(</font>white<font color="#000080">);

  </font>audio_status_info<font color="#000080">;
  </font>q_channel_info<font color="#000080">;
  </font>audio_status_info<font color="#000080">;
  </font>audio_disk_info<font color="#000080">;
  </font>Play_Audio <font color="#000080">(</font>trackinfo <font color="#000080">[</font>starttrack<font color="#000080">]^. </font>startpoint<font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);


  </font><font color="#FF0000"><b>REPEAT
    REPEAT
      if </b></font>toslet <font color="#FF0000"><b>then
      begin
        if </b></font>elapsedtime<font color="#000080">(</font>vol_time<font color="#000080">,</font>readtimer<font color="#000080">)&gt;</font><font color="#800000">700 </font><font color="#FF0000"><b>then
        begin
          </b></font>gotoxy<font color="#000080">(</font><font color="#800000">33</font><font color="#000080">,</font>wherey<font color="#000080">);
          </font>write<font color="#000080">(</font><font color="#800000">'                                '</font><font color="#000080">);
          </font>toslet<font color="#000080">:=</font>false<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

      </font>fuckthebuff<font color="#000080">;
      </font>calctrack<font color="#000080">;
      </font>q_channel_info<font color="#000080">;
      </font>gotoxy<font color="#000080">(</font><font color="#800000">18</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>track<font color="#000080">));
      </font>gotoxy<font color="#000080">(</font><font color="#800000">21</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>textcolor<font color="#000080">(</font>white<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>endtrack<font color="#000080">));
      </font>textcolor<font color="#000080">(</font>yellow<font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">24</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>qchannelinfo<font color="#000080">.</font>minutes<font color="#000080">));
      </font>gotoxy<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">,</font>wherey<font color="#000080">);
      </font>write<font color="#000080">(</font>leadingzero<font color="#000080">(</font>qchannelinfo<font color="#000080">.</font>seconds<font color="#000080">));
    </font><font color="#FF0000"><b>UNTIL </b></font>InKey <font color="#000080">(</font>Hi<font color="#000080">, </font>Hi2<font color="#000080">);

    </font><font color="#008000"><i>{ESC (EXIT AUDIO)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">27</font><font color="#000080">) )  </font><font color="#FF0000"><b>THEN </b></font>slut <font color="#000080">:= </font>TRUE<font color="#000080">;

    </font><font color="#008000"><i>{Page Up (UP ONE TRACK)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">73</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">224</font><font color="#000080">) ) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>playing<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>track <font color="#000080">&lt; </font>endtrack<font color="#000080">) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>pause_audio<font color="#000080">;
      </font>play_audio <font color="#000080">(</font>trackinfo <font color="#000080">[</font>track <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]^. </font>startpoint<font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{Page Down (DOWN ONE TRACK)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">81</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">224</font><font color="#000080">) ) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>playing<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>track <font color="#000080">&gt; </font>starttrack<font color="#000080">) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      IF </b></font><font color="#000080">( (</font>place <font color="#000080">&lt; (</font>trackinfo <font color="#000080">[</font>track<font color="#000080">]^. </font>startpoint <font color="#000080">+ </font><font color="#800000">3000</font><font color="#000080">) ) ) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>pause_audio<font color="#000080">;
        </font>play_audio <font color="#000080">(</font>trackinfo <font color="#000080">[</font>track <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">]^. </font>startpoint<font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>place <font color="#000080">&gt; (</font>trackinfo <font color="#000080">[</font>track<font color="#000080">]^. </font>startpoint <font color="#000080">+ </font><font color="#800000">3000</font><font color="#000080">) ) ) </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>pause_audio<font color="#000080">;
        </font>play_audio <font color="#000080">(</font>trackinfo <font color="#000080">[</font>track<font color="#000080">]^. </font>startpoint<font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{Right Arrow (SKIP 3-4 SECS)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">224</font><font color="#000080">) ) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>playing<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>place<font color="#000080">+ (</font><font color="#800000">3000</font><font color="#000080">) ) &lt;
       </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">) )
    </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>pause_audio<font color="#000080">;
      </font>play_audio <font color="#000080">(</font>place<font color="#000080">+</font><font color="#800000">1000</font><font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{Left Arrow (SKIP 3-4 SECS)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">75</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">224</font><font color="#000080">) ) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>playing<font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">( (</font>place<font color="#000080">- (</font><font color="#800000">3000 </font><font color="#000080">* </font><font color="#800000">4</font><font color="#000080">) ) &gt;
       </font>trackinfo <font color="#000080">[</font>starttrack<font color="#000080">]^. </font>startpoint<font color="#000080">) )
    </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>pause_audio<font color="#000080">;
      </font>play_audio <font color="#000080">((</font>place<font color="#000080">- </font><font color="#800000">1000</font><font color="#000080">), </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
      </font>delay<font color="#000080">(</font><font color="#800000">20</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{Middle key (PAUSE/RESUME)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">76</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      IF </b></font>playing <font color="#FF0000"><b>THEN
      BEGIN
        </b></font>io_control <font color="#000080">(</font>stopplay<font color="#000080">);
        </font>audio_status_info<font color="#000080">;
      </font><font color="#FF0000"><b>END
      ELSE
      BEGIN
        </b></font>resume_play<font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">52</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">46</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>newtrack <font color="#000080">:= </font>pickatrack<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>newtrack <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      BEGIN
        </b></font>pause_audio<font color="#000080">;
        </font>play_audio <font color="#000080">(</font>trackinfo <font color="#000080">[</font>newtrack<font color="#000080">]^. </font>startpoint<font color="#000080">, </font>trackinfo <font color="#000080">[</font>endtrack<font color="#000080">]^. </font>endpoint<font color="#000080">);
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

    </font><font color="#008000"><i>{HELP MENU!}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">59</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      </b></font>fuckthebuff<font color="#000080">;
      </font>help<font color="#000080">;
      </font>gotoxy<font color="#000080">(</font><font color="#800000">01</font><font color="#000080">,</font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
      </font>write<font color="#000080">(</font><font color="#800000">'(\/)ini  v.1     xx/xx xx:XX                                           L/th 1996'</font><font color="#000080">);
      </font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;



</font><font color="#008000"><i>{ VOLUME-CONTROL!}

{'-' (Reduce BOTH volumes)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">74</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">45</font><font color="#000080">) </font><font color="#FF0000"><b>AND NOT </b></font><font color="#000080">( (</font>left_shift<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>right_shift<font color="#000080">) ) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      if </b></font>sbfound <font color="#FF0000"><b>then
      begin
        IF </b></font>rvolume <font color="#000080">&gt; </font><font color="#800000">04 </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>DEC <font color="#000080">(</font>rvolume<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
          </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">49</font><font color="#000080">;
          </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">] := </font>rvolume<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>lvolume <font color="#000080">&gt; </font><font color="#800000">04 </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>DEC <font color="#000080">(</font>lvolume<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
          </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">48</font><font color="#000080">;
          </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">] := </font>lvolume<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>showvolume<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#008000"><i>{'+' (Increase BOTH volumes)}
    </i></font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>Hi <font color="#000080">= </font><font color="#800000">78</font><font color="#000080">) </font><font color="#FF0000"><b>AND </b></font><font color="#000080">(</font>Hi2 <font color="#000080">= </font><font color="#800000">43</font><font color="#000080">) </font><font color="#FF0000"><b>AND NOT </b></font><font color="#000080">( (</font>left_shift<font color="#000080">) </font><font color="#FF0000"><b>OR </b></font><font color="#000080">(</font>right_shift<font color="#000080">) ) ) </font><font color="#FF0000"><b>THEN
    BEGIN
      if </b></font>sbfound <font color="#FF0000"><b>then
      begin
        IF </b></font>rvolume <font color="#000080">&lt; </font><font color="#800000">252 </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>INC <font color="#000080">(</font>rvolume<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
          </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">49</font><font color="#000080">;
          </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">] := </font>rvolume<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>IF </b></font>lvolume <font color="#000080">&lt; </font><font color="#800000">252 </font><font color="#FF0000"><b>THEN
        BEGIN
          </b></font>INC <font color="#000080">(</font>lvolume<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
          </font>port <font color="#000080">[</font><font color="#800000">$224</font><font color="#000080">] := </font><font color="#800000">48</font><font color="#000080">;
          </font>port <font color="#000080">[</font><font color="#800000">$225</font><font color="#000080">] := </font>lvolume<font color="#000080">;
        </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
        </font>showvolume<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{ VOLUME-CONTROL!}
   </i></font>stuffthebuff<font color="#000080">;
  </font><font color="#FF0000"><b>UNTIL </b></font>slut<font color="#000080">;
</font>gotoxy<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">,</font>wherey<font color="#000080">);
</font>textcolor<font color="#000080">(</font>lightgray<font color="#000080">);
</font>writeln<font color="#000080">(</font><font color="#800000">'(\/)ini  v.1     Mini-CD-ROM-player                                    L/th 1996'</font><font color="#000080">);
</font>curson<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.


</font><font color="#008000"><i>{CUT OFF ...}

{CUT ... Save this as CD_UNIT.PAS}
</i></font><font color="#FF0000"><b>UNIT </b></font>CD_Unit<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

USES </b></font>DOS<font color="#000080">, </font>CD_Vars<font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>Drive   <font color="#000080">: </font>Integer<font color="#000080">;  </font><font color="#008000"><i>{ Must set drive before all operations }
  </i></font>SubUnit <font color="#000080">: </font>Integer<font color="#000080">;
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>IO_Control <font color="#000080">(</font>Command <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>FUNCTION </b></font>File_Name <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Read_VTOC <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>VTOC <font color="#000080">: </font>VTOCArray<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>Index <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CD_Check <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>Vol_Desc <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>ErrCode <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>CD_Dev_Req <font color="#000080">(</font>DevPointer <font color="#000080">: </font>Pointer<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>Get_Dir_Entry <font color="#000080">(</font>PathName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>VAR </b></font>Format<font color="#000080">, </font>ErrCode <font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>DeviceStatus<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Channel_Info<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Disk_Info<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Track_Info <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>StartPoint <font color="#000080">: </font>LongInt<font color="#000080">;
                           </font><font color="#FF0000"><b>VAR </b></font>TrackControl <font color="#000080">: </font>Byte<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Status_Info<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Q_Channel_Info<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Lock <font color="#000080">(</font>LockDrive <font color="#000080">: </font>Boolean<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>Resetcd<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Eject<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CloseTray<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Resume_Play<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Pause_Audio<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Play_Audio <font color="#000080">(</font>StartSec<font color="#000080">, </font>EndSec <font color="#000080">: </font>LongInt<font color="#000080">);

</font><font color="#FF0000"><b>FUNCTION </b></font>Sector_Size <font color="#000080">(</font>ReadMode <font color="#000080">: </font>Integer<font color="#000080">) : </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Volume_Size <font color="#000080">: </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Media_Changed <font color="#000080">: </font>Boolean<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Head_Location <font color="#000080">(</font>AddrMode <font color="#000080">: </font>Byte<font color="#000080">) : </font>LongInt<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Read_Drive_Bytes <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>ReadBytes <font color="#000080">: </font>DriveByteArray<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>Read_Long <font color="#000080">(</font>TransAddr <font color="#000080">: </font>Pointer<font color="#000080">; </font>StartSec <font color="#000080">: </font>LongInt<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>SeekSec <font color="#000080">(</font>StartSec <font color="#000080">: </font>LongInt<font color="#000080">);

</font><font color="#FF0000"><b>PROCEDURE </b></font>DevClose<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DevOpen<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>OutputFlush<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InputFlush<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>UPC_Code <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

CONST
  </b></font>CarryFlag  <font color="#000080">= </font><font color="#800000">$0001</font><font color="#000080">;

</font><font color="#FF0000"><b>TYPE
  </b></font>PointerHalf <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                  </b></font>LoHalf<font color="#000080">, </font>HiHalf <font color="#000080">: </font>Word<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>VAR
  </b></font>Regs       <font color="#000080">: </font>Registers<font color="#000080">;
  </font>IOBlock    <font color="#000080">: </font>IOControl<font color="#000080">;
  </font>DriveBytes <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">130</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  
</font><font color="#FF0000"><b>PROCEDURE </b></font>Clear_Regs<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>Regs<font color="#000080">, </font>SizeOf <font color="#000080">(</font>Regs<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CD_Intr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Regs<font color="#000080">. </font>AH <font color="#000080">:= </font><font color="#800000">$15</font><font color="#000080">;
  </font>Intr <font color="#000080">(</font><font color="#800000">$2F</font><font color="#000080">, </font>Regs<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>MSCDEX_Ver<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0C</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
  </font>CD_Intr<font color="#000080">;
  </font>MSCDEX_Version<font color="#000080">. </font>Minor <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Regs<font color="#000080">. </font>BX <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>MSCDEX_Version<font color="#000080">. </font>Major <font color="#000080">:= </font><font color="#800000">1
  </font><font color="#FF0000"><b>ELSE
  BEGIN
    </b></font>MSCDEX_Version<font color="#000080">. </font>Major <font color="#000080">:= </font>Regs<font color="#000080">. </font>BH<font color="#000080">;
    </font>MSCDEX_Version<font color="#000080">. </font>Minor <font color="#000080">:= </font>Regs<font color="#000080">. </font>BL<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Initialize<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>NumberOfCD <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$00</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
  </font>CD_Intr<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Regs<font color="#000080">. </font>BX <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>NumberOfCD <font color="#000080">:= </font>Regs<font color="#000080">. </font>BX<font color="#000080">;
    </font>FirstCD <font color="#000080">:= </font>Regs<font color="#000080">. </font>CX<font color="#000080">;
    </font>Clear_Regs<font color="#000080">;
    </font>FillChar <font color="#000080">(</font>DriverList<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriverList<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
    </font>FillChar <font color="#000080">(</font>UnitList<font color="#000080">, </font>SizeOf <font color="#000080">(</font>UnitList<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
    </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$01</font><font color="#000080">;               </font><font color="#008000"><i>{ Get List of Driver Header Addresses }
    </i></font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>Seg <font color="#000080">(</font>DriverList<font color="#000080">);
    </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>Ofs <font color="#000080">(</font>DriverList<font color="#000080">);
    </font>CD_Intr<font color="#000080">;
    </font>Clear_Regs<font color="#000080">;
    </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0D</font><font color="#000080">;               </font><font color="#008000"><i>{ Get List of CD-ROM Units }
    </i></font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>Seg <font color="#000080">(</font>UnitList<font color="#000080">);
    </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>Ofs <font color="#000080">(</font>UnitList<font color="#000080">);
    </font>CD_Intr<font color="#000080">;
    </font>MSCDEX_Ver<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>File_Name <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>FN <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">38</font><font color="#000080">];
</font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font>Code <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#008000"><i>{
  Copyright Filename     =  1
  Abstract Filename      =  2
  Bibliographic Filename =  3
  }
  </i></font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
  </font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>Seg <font color="#000080">(</font>FN<font color="#000080">);
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>Ofs <font color="#000080">(</font>FN<font color="#000080">);
  </font>CD_Intr<font color="#000080">;
  </font>Code <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Regs<font color="#000080">. </font>Flags <font color="#FF0000"><b>AND </b></font>CarryFlag<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>File_Name <font color="#000080">:= </font>FN
  <font color="#FF0000"><b>ELSE
    </b></font>File_Name <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>Read_VTOC <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>VTOC <font color="#000080">: </font>VTOCArray<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>Index <font color="#000080">: </font>Integer<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#008000"><i>{ On entry -
     Index = Vol Desc Number to read from 0 to ?
  On return
     Case Index of
            1    : Standard Volume Descriptor
            $FF  : Volume Descriptor Terminator
            0    : All others
}
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$05</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
  </font>Regs<font color="#000080">. </font>DX <font color="#000080">:= </font>Index<font color="#000080">;
  </font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>Seg <font color="#000080">(</font>VTOC<font color="#000080">);
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>Ofs <font color="#000080">(</font>VTOC<font color="#000080">);
  </font>CD_Intr<font color="#000080">;
  </font>Index <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Regs<font color="#000080">. </font>Flags <font color="#FF0000"><b>AND </b></font>CarryFlag<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>Read_VTOC <font color="#000080">:= </font>TRUE
  <font color="#FF0000"><b>ELSE
    </b></font>Read_VTOC <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CD_Check <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0B</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
  </font>CD_Intr<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Regs<font color="#000080">. </font>BX <font color="#000080">&lt;&gt; </font><font color="#800000">$ADAD </font><font color="#FF0000"><b>THEN
    </b></font>Code <font color="#000080">:= </font><font color="#800000">2
  </font><font color="#FF0000"><b>ELSE
  BEGIN
    IF </b></font>Regs<font color="#000080">. </font>AX <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>Code <font color="#000080">:= </font><font color="#800000">0
    </font><font color="#FF0000"><b>ELSE
      </b></font>Code <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Vol_Desc <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>Code <font color="#000080">: </font>Integer<font color="#000080">;
                   </font><font color="#FF0000"><b>VAR </b></font>ErrCode <font color="#000080">: </font>Integer<font color="#000080">);

  </font><font color="#FF0000"><b>FUNCTION </b></font>Get_Vol_Desc <font color="#000080">: </font>Byte<font color="#000080">;
    </font><font color="#FF0000"><b>BEGIN
      </b></font>Clear_Regs<font color="#000080">;
      </font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
      </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0E</font><font color="#000080">;
      </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font><font color="#800000">$0000</font><font color="#000080">;
      </font>CD_Intr<font color="#000080">;
      </font>Code <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Regs<font color="#000080">. </font>Flags <font color="#FF0000"><b>AND </b></font>CarryFlag<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
        </b></font>ErrCode <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;
      </font>Get_Vol_Desc <font color="#000080">:= </font>Regs<font color="#000080">. </font>DH<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>ErrCode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Code <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Regs<font color="#000080">. </font>DH <font color="#000080">:= </font>Code<font color="#000080">;
    </font>Regs<font color="#000080">. </font>DL <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font><font color="#800000">$0001</font><font color="#000080">;
    </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0E</font><font color="#000080">;
    </font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
    </font>CD_Intr<font color="#000080">;
    </font>Code <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX<font color="#000080">;
    </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Regs<font color="#000080">. </font>Flags <font color="#FF0000"><b>AND </b></font>CarryFlag<font color="#000080">) &lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>ErrCode <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>ErrCode <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
    </b></font>Code <font color="#000080">:= </font>Get_Vol_Desc<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Get_Dir_Entry <font color="#000080">(</font>PathName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
                        </font><font color="#FF0000"><b>VAR </b></font>Format<font color="#000080">, </font>ErrCode <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DirBuf<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DirBuf<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>PathName <font color="#000080">:= </font>PathName <font color="#000080">+ </font><font color="#800000">#0</font><font color="#000080">;
  </font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$0F</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>CL <font color="#000080">:= </font>Drive<font color="#000080">;
  </font>Regs<font color="#000080">. </font>CH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>Seg <font color="#000080">(</font>PathName<font color="#000080">);
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>Ofs <font color="#000080">(</font>PathName<font color="#000080">);
  </font>Regs<font color="#000080">. </font>SI <font color="#000080">:= </font>Seg <font color="#000080">(</font>DirBuf<font color="#000080">);
  </font>Regs<font color="#000080">. </font>DI <font color="#000080">:= </font>Ofs <font color="#000080">(</font>DirBuf<font color="#000080">);
  </font>CD_Intr<font color="#000080">;
  </font>ErrCode <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX<font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">(</font>Regs<font color="#000080">. </font>Flags <font color="#FF0000"><b>AND </b></font>CarryFlag<font color="#000080">) = </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
  BEGIN
    </b></font>Move <font color="#000080">(</font>DirBuf<font color="#000080">. </font>NameArray <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font>DirBuf<font color="#000080">. </font>FileName <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">38</font><font color="#000080">);
    </font>DirBuf<font color="#000080">. </font>FileName <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font><font color="#800000">#12</font><font color="#000080">; </font><font color="#008000"><i>{ File names are only 8.3 }
    </i></font>Format <font color="#000080">:= </font>Regs<font color="#000080">. </font>AX
  <font color="#FF0000"><b>END
  ELSE
    </b></font>Format <font color="#000080">:= </font><font color="#800000">$FF</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CD_Dev_Req <font color="#000080">(</font>DevPointer <font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>Clear_Regs<font color="#000080">;
  </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">$10</font><font color="#000080">;
  </font>Regs<font color="#000080">. </font>CX <font color="#000080">:= </font>Drive<font color="#000080">;
  </font>Regs<font color="#000080">. </font>ES <font color="#000080">:= </font>PointerHalf <font color="#000080">(</font>DevPointer<font color="#000080">).</font>HiHalf<font color="#000080">;
  </font>Regs<font color="#000080">. </font>BX <font color="#000080">:= </font>PointerHalf <font color="#000080">(</font>DevPointer<font color="#000080">).</font>LoHalf<font color="#000080">;
  </font>CD_Intr<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>IO_Control <font color="#000080">(</font>Command <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">26</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Status <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>TransAddr <font color="#000080">:= @</font>DriveBytes<font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Command <font color="#000080">:= </font>Command<font color="#000080">;
  
  </font>FillChar <font color="#000080">(</font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Reserved<font color="#000080">, </font><font color="#800000">8</font><font color="#000080">, </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>CD_Dev_Req <font color="#000080">(@</font>IOBlock<font color="#000080">);
  
  </font>Busy <font color="#000080">:=   (</font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">512</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  
  
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Channel_Info<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">4</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">9</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>AudioChannel<font color="#000080">, </font><font color="#800000">9</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DeviceStatus<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">6</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>DoorOpen     <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>DoorLocked   <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">2 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>AudioManip   <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  </font>DiscInDrive  <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">8 </font><font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Disk_Info<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">10</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>AudioDiskInfo<font color="#000080">, </font><font color="#800000">6</font><font color="#000080">);
  
  </font>Playing <font color="#000080">:= </font>Busy<font color="#000080">;
  
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Track_Info <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>StartPoint <font color="#000080">: </font>LongInt<font color="#000080">;
                           </font><font color="#FF0000"><b>VAR </b></font>TrackControl <font color="#000080">: </font>Byte<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">11</font><font color="#000080">;
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>TrackControl<font color="#000080">;   </font><font color="#008000"><i>{ Track number }
  </i></font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>StartPoint<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  
  </font>TrackControl <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font><font color="#800000">7</font><font color="#000080">];
  
  </font>Playing <font color="#000080">:= </font>Busy<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Q_Channel_Info<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">12</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>QChannelInfo<font color="#000080">, </font><font color="#800000">11</font><font color="#000080">);
  
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Audio_Status_Info<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">15</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Paused <font color="#000080">:= (</font>Word <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] ) </font><font color="#FF0000"><b>AND </b></font><font color="#800000">1</font><font color="#000080">) &lt;&gt; </font><font color="#800000">0</font><font color="#000080">;
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">4</font><font color="#000080">], </font>Last_Start<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">8</font><font color="#000080">], </font>Last_End<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  
  </font>Playing <font color="#000080">:= </font>Busy<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Eject<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlOutput<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Resetcd<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);

  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">2</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlOutput<font color="#000080">);
  </font>Busy <font color="#000080">:= </font>TRUE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Lock <font color="#000080">(</font>LockDrive <font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>LockDrive <font color="#FF0000"><b>THEN
    </b></font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">1
  </font><font color="#FF0000"><b>ELSE
    </b></font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font><font color="#800000">0</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlOutput<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>CloseTray<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlOutput<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>VAR
  </b></font>AudioPlay <font color="#000080">: </font>Audio_Play<font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>Play <font color="#000080">(</font>StartLoc<font color="#000080">, </font>NumSec <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>AudioPlay<font color="#000080">, </font>SizeOf <font color="#000080">(</font>AudioPlay<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Command <font color="#000080">:= </font>PlayCD<font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">22</font><font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>Start <font color="#000080">:= </font>StartLoc<font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>NumSecs <font color="#000080">:= </font>NumSec<font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>AddrMode <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  
  </font>CD_Dev_Req <font color="#000080">(@</font>AudioPlay<font color="#000080">);
  </font>Play <font color="#000080">:= ( (</font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">32768</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">);
  
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Play_Audio <font color="#000080">(</font>StartSec<font color="#000080">, </font>EndSec <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>SP<font color="#000080">,
  </font>EP     <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>SArray <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  </font>EArray <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>Move <font color="#000080">(</font>StartSec<font color="#000080">, </font>SArray <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">4</font><font color="#000080">);
  </font>Move <font color="#000080">(</font>EndSec<font color="#000080">, </font>EArray <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">], </font><font color="#800000">4</font><font color="#000080">);
  </font>SP <font color="#000080">:= </font>SArray <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];           </font><font color="#008000"><i>{ Must use longint or get negative result }
  </i></font>SP <font color="#000080">:= (</font>SP <font color="#000080">* </font><font color="#800000">75 </font><font color="#000080">* </font><font color="#800000">60</font><font color="#000080">) + (</font>SArray <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] * </font><font color="#800000">75</font><font color="#000080">) + </font>SArray <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>EP <font color="#000080">:= </font>EArray <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">];
  </font>EP <font color="#000080">:= (</font>EP <font color="#000080">* </font><font color="#800000">75 </font><font color="#000080">* </font><font color="#800000">60</font><font color="#000080">) + (</font>EArray <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] * </font><font color="#800000">75</font><font color="#000080">) + </font>EArray <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">];
  </font>EP <font color="#000080">:= </font>EP <font color="#000080">- </font>SP<font color="#000080">;
  
  </font>Playing <font color="#000080">:= </font>Play <font color="#000080">(</font>StartSec<font color="#000080">, </font>EP<font color="#000080">);
  </font>Audio_Status_Info<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Pause_Audio<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  IF </b></font>Playing <font color="#FF0000"><b>THEN
  BEGIN
    </b></font>FillChar <font color="#000080">(</font>AudioPlay<font color="#000080">, </font>SizeOf <font color="#000080">(</font>AudioPlay<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
    </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Command <font color="#000080">:= </font>stopplay<font color="#000080">; </font><font color="#008000"><i>{stopplay}
    </i></font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
    </font>CD_Dev_Req <font color="#000080">(@</font>AudioPlay<font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>Audio_Status_Info<font color="#000080">;
  </font>Playing <font color="#000080">:= </font>FALSE<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Resume_Play<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>AudioPlay<font color="#000080">, </font>SizeOf <font color="#000080">(</font>AudioPlay<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Command <font color="#000080">:= </font>ResumePlay<font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
  </font>AudioPlay<font color="#000080">. </font>APReq<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>AudioPlay<font color="#000080">);
  </font>Audio_Status_Info<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Sector_Size <font color="#000080">(</font>ReadMode <font color="#000080">: </font>Integer<font color="#000080">) : </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>SecSize <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">7</font><font color="#000080">;
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>ReadMode<font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>SecSize<font color="#000080">, </font><font color="#800000">2</font><font color="#000080">);
  </font>Sector_Size <font color="#000080">:= </font>SecSize<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>(*Function CD_GetVol:Boolean;
begin
  CtlBlk[0] := 4;                           { die Lautstaerke lesen }
  CD_GetVol := CD_IOCtl(IoCtlRead, 8);
  if ((R.Flags and FCARRY) = 0)
   then Move(CtlBlk[1], CD.VolInfo, 8)
   else FillChar( CD.VolInfo, 8, 0)
end;

Function CD_SetVol:Boolean;
begin
  CtlBlk[0] := 3;                          { die Lautstaerke setzen }
  CD_SetVol := CD_IOCtl( IoCtlWrite, 8);
end;
*)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>Volume_Size <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>VolSize <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">8</font><font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">5</font><font color="#000080">;

  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>VolSize<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>Volume_Size <font color="#000080">:= </font>VolSize<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Media_Changed <font color="#000080">: </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>VAR </b></font>MedChng <font color="#000080">: </font>Byte<font color="#000080">;
  
  </font><font color="#008000"><i>{  1  :  Media not changed
  0  :  Don't Know
  -1  :  Media changed
  }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">9</font><font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">], </font>MedChng<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>Inc <font color="#000080">(</font>MedChng<font color="#000080">);
  </font><font color="#FF0000"><b>CASE </b></font>MedChng <font color="#FF0000"><b>OF
    </b></font><font color="#800000">2    </font><font color="#000080">: </font>Media_Changed <font color="#000080">:= </font>FALSE<font color="#000080">;
    </font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0  </font><font color="#000080">: </font>Media_Changed <font color="#000080">:= </font>TRUE<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>Head_Location <font color="#000080">(</font>AddrMode <font color="#000080">: </font>Byte<font color="#000080">) : </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>HeadLoc <font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">1</font><font color="#000080">;
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">2</font><font color="#000080">] := </font>AddrMode<font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">6</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>HeadLoc<font color="#000080">, </font><font color="#800000">4</font><font color="#000080">);
  </font>Head_Location <font color="#000080">:= </font>HeadLoc<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>Read_Drive_Bytes <font color="#000080">(</font><font color="#FF0000"><b>VAR </b></font>ReadBytes <font color="#000080">: </font>DriveByteArray<font color="#000080">);
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">5</font><font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">130</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);

  </font>Move <font color="#000080">(</font>DriveBytes <font color="#000080">[</font><font color="#800000">3</font><font color="#000080">], </font>ReadBytes<font color="#000080">, </font><font color="#800000">128</font><font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>FUNCTION </b></font>UPC_Code <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>I<font color="#000080">, </font>J<font color="#000080">, </font>K <font color="#000080">: </font>Integer<font color="#000080">;
  </font>TempStr <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriveBytes<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriveBytes<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>TempStr <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>DriveBytes <font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font><font color="#800000">14</font><font color="#000080">;
  
  </font>IOBlock<font color="#000080">. </font>NumBytes <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
  
  </font>IO_Control <font color="#000080">(</font>IOCtlInput<font color="#000080">);
  
  </font><font color="#FF0000"><b>IF </b></font><font color="#000080">( (</font>IOBlock<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Status <font color="#FF0000"><b>AND </b></font><font color="#800000">32768</font><font color="#000080">) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>THEN</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">3 </font><font color="#FF0000"><b>TO </b></font><font color="#800000">9 </font><font color="#FF0000"><b>DO
  BEGIN
    </b></font>J <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$0F</font><font color="#000080">;
    </font>K <font color="#000080">:= </font>DriveBytes <font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>AND </b></font><font color="#800000">$F0</font><font color="#000080">;
    </font>TempStr <font color="#000080">:= </font>TempStr <font color="#000080">+ </font>Chr <font color="#000080">(</font>J <font color="#000080">+ </font><font color="#800000">48</font><font color="#000080">);
    </font>TempStr <font color="#000080">:= </font>TempStr <font color="#000080">+ </font>Chr <font color="#000080">(</font>K <font color="#000080">+ </font><font color="#800000">48</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>IF </b></font>Length <font color="#000080">(</font>TempStr<font color="#000080">) &gt; </font><font color="#800000">13 </font><font color="#FF0000"><b>THEN
    </b></font>TempStr <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr <font color="#000080">(</font>Ord <font color="#000080">(</font>TempStr <font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] ) - </font><font color="#800000">1</font><font color="#000080">);
  </font>UPC_Code <font color="#000080">:= </font>TempStr<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>PROCEDURE </b></font>Read_Long <font color="#000080">(</font>TransAddr <font color="#000080">: </font>Pointer<font color="#000080">; </font>StartSec <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>RL <font color="#000080">: </font>ReadControl<font color="#000080">;
  </font><font color="#008000"><i>{
  ReadControl = Record
  IOReq_Hdr : Req_Hdr;
  AddrMode  : Byte;
  TransAddr : Pointer;
  NumSecs   : Word;
  StartSec  : LongInt;
  ReadMode  : Byte;
  IL_Size,
  IL_Skip   : Byte;
  End;
  }
</i></font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>RL<font color="#000080">, </font>SizeOf <font color="#000080">(</font>RL<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">27</font><font color="#000080">;
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Command <font color="#000080">:= </font>ReadLong<font color="#000080">;
  </font>RL<font color="#000080">. </font>AddrMode <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>RL<font color="#000080">. </font>TransAddr <font color="#000080">:= </font>TransAddr<font color="#000080">;
  </font>RL<font color="#000080">. </font>NumSecs <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>RL<font color="#000080">. </font>StartSec <font color="#000080">:= </font>StartSec<font color="#000080">;
  </font>RL<font color="#000080">. </font>ReadMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>RL<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>SeekSec <font color="#000080">(</font>StartSec <font color="#000080">: </font>LongInt<font color="#000080">);
</font><font color="#FF0000"><b>VAR
  </b></font>RL <font color="#000080">: </font>ReadControl<font color="#000080">;
  
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>RL<font color="#000080">, </font>SizeOf <font color="#000080">(</font>RL<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Len <font color="#000080">:= </font><font color="#800000">24</font><font color="#000080">;
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
  </font>RL<font color="#000080">. </font>IOReq_Hdr<font color="#000080">. </font>Command <font color="#000080">:= </font>SeekCmd<font color="#000080">;
  </font>RL<font color="#000080">. </font>AddrMode <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font>RL<font color="#000080">. </font>StartSec <font color="#000080">:= </font>StartSec<font color="#000080">;
  </font>RL<font color="#000080">. </font>ReadMode <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>RL<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>InputFlush<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>IOReq <font color="#000080">: </font>Req_Hdr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>IOReq<font color="#000080">, </font>SizeOf <font color="#000080">(</font>IOReq<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>IOReq <font color="#FF0000"><b>DO
  BEGIN
    </b></font>Len     <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
    </font>Command <font color="#000080">:= </font><font color="#800000">7</font><font color="#000080">;
    </font>Status  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>IOReq<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>OutputFlush<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>IOReq <font color="#000080">: </font>Req_Hdr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>IOReq<font color="#000080">, </font>SizeOf <font color="#000080">(</font>IOReq<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>IOReq <font color="#FF0000"><b>DO
  BEGIN
    </b></font>Len     <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
    </font>Command <font color="#000080">:= </font><font color="#800000">11</font><font color="#000080">;
    </font>Status  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>IOReq<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DevOpen<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>IOReq <font color="#000080">: </font>Req_Hdr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>IOReq<font color="#000080">, </font>SizeOf <font color="#000080">(</font>IOReq<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>IOReq <font color="#FF0000"><b>DO
  BEGIN
    </b></font>Len     <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
    </font>Command <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>Status  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>IOReq<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>DevClose<font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>IOReq <font color="#000080">: </font>Req_Hdr<font color="#000080">;
</font><font color="#FF0000"><b>BEGIN
  </b></font>FillChar <font color="#000080">(</font>IOReq<font color="#000080">, </font>SizeOf <font color="#000080">(</font>IOReq<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font><font color="#FF0000"><b>WITH </b></font>IOReq <font color="#FF0000"><b>DO
  BEGIN
    </b></font>Len     <font color="#000080">:= </font><font color="#800000">13</font><font color="#000080">;
    </font>SubUnit <font color="#000080">:= </font>SubUnit<font color="#000080">;
    </font>Command <font color="#000080">:= </font><font color="#800000">14</font><font color="#000080">;
    </font>Status  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>CD_Dev_Req <font color="#000080">(@</font>IOReq<font color="#000080">);
</font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#008000"><i>{************************************************************}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font>NumberOfCD <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FirstCD <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FillChar <font color="#000080">(</font>MSCDEX_Version<font color="#000080">, </font>SizeOf <font color="#000080">(</font>MSCDEX_Version<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>Initialize<font color="#000080">;
  </font>Drive <font color="#000080">:= </font>FirstCD<font color="#000080">;
  </font>SubUnit <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{CUT OFF ...}

{CUT ... Save this as CD_VARS.PAS}

</i></font><font color="#FF0000"><b>UNIT </b></font>CD_Vars<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE

TYPE
  </b></font>ListBuf    <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                 </b></font>UnitCode <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>UnitSeg<font color="#000080">,
                 </font>UnitOfs  <font color="#000080">: </font>Word<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font>VTOCArray  <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">2048</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  </font>DriveByteArray <font color="#000080">= </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">128</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  
  </font>Req_Hdr    <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                 </b></font>Len     <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>SubUnit <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Command <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Status  <font color="#000080">: </font>Word<font color="#000080">;
                 </font>Reserved<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>CONST
  </b></font>Init       <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>IoCtlInput <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>InputFlush <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>IOCtlOutput <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
  </font>DevOpen    <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
  </font>DevClose   <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
  </font>ReadLong   <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;
  </font>ReadLongP  <font color="#000080">= </font><font color="#800000">130</font><font color="#000080">;
  </font>SeekCmd    <font color="#000080">= </font><font color="#800000">131</font><font color="#000080">;
  </font>PlayCD     <font color="#000080">= </font><font color="#800000">132</font><font color="#000080">;
  </font>StopPlay   <font color="#000080">= </font><font color="#800000">133</font><font color="#000080">;
  </font>ResumePlay <font color="#000080">= </font><font color="#800000">136</font><font color="#000080">;
  
</font><font color="#FF0000"><b>TYPE
  
  </b></font>Audio_Play <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                 </b></font>APReq    <font color="#000080">: </font>Req_Hdr<font color="#000080">;
                 </font>AddrMode <font color="#000080">: </font>Byte<font color="#000080">;
                 </font>Start    <font color="#000080">: </font>LongInt<font color="#000080">;
                 </font>NumSecs  <font color="#000080">: </font>LongInt<font color="#000080">;
               </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>IOControl <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                </b></font>IOReq_Hdr <font color="#000080">: </font>Req_Hdr<font color="#000080">;
                </font>MediaDesc <font color="#000080">: </font>Byte<font color="#000080">;
                </font>TransAddr <font color="#000080">: </font>Pointer<font color="#000080">;
                </font>NumBytes  <font color="#000080">: </font>Word<font color="#000080">;
                </font>StartSec  <font color="#000080">: </font>Word<font color="#000080">;
                </font>ReqVol    <font color="#000080">: </font>Pointer<font color="#000080">;
              </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>ReadControl <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                  </b></font>IOReq_Hdr <font color="#000080">: </font>Req_Hdr<font color="#000080">;
                  </font>AddrMode  <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>TransAddr <font color="#000080">: </font>Pointer<font color="#000080">;
                  </font>NumSecs   <font color="#000080">: </font>Word<font color="#000080">;
                  </font>StartSec  <font color="#000080">: </font>LongInt<font color="#000080">;
                  </font>ReadMode  <font color="#000080">: </font>Byte<font color="#000080">;
                  </font>IL_Size<font color="#000080">,
                  </font>IL_Skip   <font color="#000080">: </font>Byte<font color="#000080">;
                </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>AudioDiskInfoRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                       </b></font>LowestTrack    <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>HighestTrack   <font color="#000080">: </font>Byte<font color="#000080">;
                       </font>LeadOutTrack   <font color="#000080">: </font>LongInt<font color="#000080">;
                       </font><font color="#008000"><i>{new!}
                       </i></font>VolInfo<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">8</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">; </font><font color="#008000"><i>{ Lautst.-Einstellungen }
                     </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>PAudioTrackInfo   <font color="#000080">= ^</font>AudioTrackInfoRec<font color="#000080">;
  </font>AudioTrackInfoRec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                        </b></font>Track           <font color="#000080">: </font>Integer<font color="#000080">;
                        </font>StartPoint      <font color="#000080">: </font>LongInt<font color="#000080">;
                        </font>EndPoint        <font color="#000080">: </font>LongInt<font color="#000080">;
                        </font>Frames<font color="#000080">,
                        </font>Seconds<font color="#000080">,
                        </font>Minutes<font color="#000080">,
                        </font>PlayMin<font color="#000080">,
                        </font>PlaySec<font color="#000080">,
                        </font>TrackControl    <font color="#000080">: </font>Byte<font color="#000080">;
                      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>MSCDEX_Ver_Rec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                     </b></font>Major<font color="#000080">,
                     </font>Minor       <font color="#000080">: </font>Integer<font color="#000080">;
                   </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>DirBufRec    <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                   </b></font>XAR_Len   <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>FileStart <font color="#000080">: </font>LongInt<font color="#000080">;
                   </font>BlockSize <font color="#000080">: </font>Integer<font color="#000080">;
                   </font>FileLen   <font color="#000080">: </font>LongInt<font color="#000080">;
                   </font>DT        <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>Flags     <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>InterSize <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>InterSkip <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>VSSN      <font color="#000080">: </font>Integer<font color="#000080">;
                   </font>NameLen   <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>NameArray <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">38</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Char<font color="#000080">;
                   </font>FileVer   <font color="#000080">: </font>Integer<font color="#000080">;
                   </font>SysUseLen <font color="#000080">: </font>Byte<font color="#000080">;
                   </font>SysUseData<font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">220</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
                   </font>FileName  <font color="#000080">: </font><font color="#FF0000"><b>String </b></font><font color="#000080">[</font><font color="#800000">38</font><font color="#000080">];
                 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
  </font>Q_Channel_Rec <font color="#000080">= </font><font color="#FF0000"><b>RECORD
                    </b></font>Control     <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Track       <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Index       <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Minutes     <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Seconds     <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Frame       <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>Zero        <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>AMinutes    <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>ASeconds    <font color="#000080">: </font>Byte<font color="#000080">;
                    </font>AFrame      <font color="#000080">: </font>Byte<font color="#000080">;
                  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  
</font><font color="#FF0000"><b>VAR
  </b></font>AudioChannel   <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">9</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  </font>DoorOpen<font color="#000080">,
  </font>DoorLocked<font color="#000080">,
  </font>AudioManip<font color="#000080">,
  </font>DiscInDrive    <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>AudioDiskInfo  <font color="#000080">: </font>AudioDiskInfoRec<font color="#000080">;
  </font>DriverList     <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>ListBuf<font color="#000080">;
  </font>NumberOfCD     <font color="#000080">: </font>Integer<font color="#000080">;
  </font>FirstCD        <font color="#000080">: </font>Integer<font color="#000080">;
  </font>UnitList       <font color="#000080">: </font><font color="#FF0000"><b>ARRAY </b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">26</font><font color="#000080">] </font><font color="#FF0000"><b>OF </b></font>Byte<font color="#000080">;
  </font>MSCDEX_Version <font color="#000080">: </font>MSCDEX_Ver_Rec<font color="#000080">;
  </font>QChannelInfo   <font color="#000080">: </font>Q_Channel_Rec<font color="#000080">;
  </font>Busy<font color="#000080">,
  </font>Playing<font color="#000080">,
  </font>Paused         <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>Last_Start<font color="#000080">,
  </font>Last_End       <font color="#000080">: </font>LongInt<font color="#000080">;
  </font>DirBuf         <font color="#000080">: </font>DirBufRec<font color="#000080">;
  
</font><font color="#FF0000"><b>IMPLEMENTATION

BEGIN
  </b></font>FillChar <font color="#000080">(</font>DriverList<font color="#000080">, </font>SizeOf <font color="#000080">(</font>DriverList<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>FillChar <font color="#000080">(</font>UnitList<font color="#000080">, </font>SizeOf <font color="#000080">(</font>UnitList<font color="#000080">), </font><font color="#800000">#0</font><font color="#000080">);
  </font>NumberOfCD  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FirstCD  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>MSCDEX_Version<font color="#000080">. </font>Major <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>MSCDEX_Version<font color="#000080">. </font>Minor <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{CUT OFF ...}


{CUT ... Save this as TPTIMER.PAS}

{$S-,R-,I-,V-,B-}

{*********************************************************}
{*                   TPTIMER.PAS 2.00                    *}
{*                by TurboPower Software                 *}
{*********************************************************}

</i></font><font color="#FF0000"><b>UNIT </b></font>TpTimer<font color="#000080">;
  </font><font color="#008000"><i>{-Allows events to be timed with 1 microsecond resolution}

</i></font><font color="#FF0000"><b>INTERFACE

PROCEDURE </b></font>InitializeTimer<font color="#000080">;
  </font><font color="#008000"><i>{-Reprogram the timer chip to allow 1 microsecond resolution}

</i></font><font color="#FF0000"><b>PROCEDURE </b></font>RestoreTimer<font color="#000080">;
  </font><font color="#008000"><i>{-Restore the timer chip to its normal state}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ReadTimer <font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#008000"><i>{-Read the timer with 1 microsecond resolution}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ElapsedTime <font color="#000080">(</font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Real<font color="#000080">;
  </font><font color="#008000"><i>{-Calculate time elapsed (in milliseconds) between Start and Stop}

</i></font><font color="#FF0000"><b>FUNCTION </b></font>ElapsedTimeString <font color="#000080">(</font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{-Return time elapsed (in milliseconds) between Start and Stop as a string}

  {==========================================================================}

</i></font><font color="#FF0000"><b>IMPLEMENTATION

CONST
  </b></font>TimerResolution <font color="#000080">= </font><font color="#800000">1193181.667</font><font color="#000080">;
</font><font color="#FF0000"><b>VAR
  </b></font>SaveExitProc <font color="#000080">: </font>Pointer<font color="#000080">;
  </font>Delta <font color="#000080">: </font>LongInt<font color="#000080">;
  
</font><font color="#FF0000"><b>FUNCTION </b></font>Cardinal <font color="#000080">(</font>L <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Real<font color="#000080">;
    </font><font color="#008000"><i>{-Return the unsigned equivalent of L as a real}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{Cardinal}
    </i></font><font color="#FF0000"><b>IF </b></font>L <font color="#000080">&lt; </font><font color="#800000">0 </font><font color="#FF0000"><b>THEN
      </b></font>Cardinal <font color="#000080">:= </font><font color="#800000">4294967296.0 </font><font color="#000080">+ </font>L
    <font color="#FF0000"><b>ELSE
      </b></font>Cardinal <font color="#000080">:= </font>L<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{Cardinal}

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>ElapsedTime <font color="#000080">(</font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>LongInt<font color="#000080">) : </font>Real<font color="#000080">;
    </font><font color="#008000"><i>{-Calculate time elapsed (in milliseconds) between Start and Stop}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ElapsedTime}
    </i></font>ElapsedTime <font color="#000080">:= </font><font color="#800000">1000.0 </font><font color="#000080">* </font>Cardinal <font color="#000080">(</font>Stop <font color="#000080">- (</font>Start <font color="#000080">+ </font>Delta<font color="#000080">) ) / </font>TimerResolution<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{ElapsedTime}

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>ElapsedTimeString <font color="#000080">(</font>Start<font color="#000080">, </font>Stop <font color="#000080">: </font>LongInt<font color="#000080">) : </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#008000"><i>{-Return time elapsed (in milliseconds) between Start and Stop as a string}
  </i></font><font color="#FF0000"><b>VAR
    </b></font>R <font color="#000080">: </font>Real<font color="#000080">;
    </font>S <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ElapsedTimeString}
    </i></font>R <font color="#000080">:= </font>ElapsedTime <font color="#000080">(</font>Start<font color="#000080">, </font>Stop<font color="#000080">);
    </font>Str <font color="#000080">(</font>R<font color="#000080">: </font><font color="#800000">0</font><font color="#000080">: </font><font color="#800000">3</font><font color="#000080">, </font>S<font color="#000080">);
    </font>ElapsedTimeString <font color="#000080">:= </font>S<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{ElapsedTimeString}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>InitializeTimer<font color="#000080">;
    </font><font color="#008000"><i>{-Reprogram the timer chip to allow 1 microsecond resolution}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{InitializeTimer}
    {select timer mode 2, read/write channel 0}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$43</font><font color="#000080">] := </font><font color="#800000">$34</font><font color="#000080">;        </font><font color="#008000"><i>{00110100b}
    </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(</font><font color="#800000">$EB </font><font color="#000080">/ </font><font color="#800000">$00</font><font color="#000080">);         </font><font color="#008000"><i>{jmp short $+2 ;delay}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;        </font><font color="#008000"><i>{LSB = 0}
    </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(</font><font color="#800000">$EB </font><font color="#000080">/ </font><font color="#800000">$00</font><font color="#000080">);         </font><font color="#008000"><i>{jmp short $+2 ;delay}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;        </font><font color="#008000"><i>{MSB = 0}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{InitializeTimer}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>RestoreTimer<font color="#000080">;
    </font><font color="#008000"><i>{-Restore the timer chip to its normal state}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{RestoreTimer}
    {select timer mode 3, read/write channel 0}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$43</font><font color="#000080">] := </font><font color="#800000">$36</font><font color="#000080">;        </font><font color="#008000"><i>{00110110b}
    </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(</font><font color="#800000">$EB </font><font color="#000080">/ </font><font color="#800000">$00</font><font color="#000080">);         </font><font color="#008000"><i>{jmp short $+2 ;delay}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;        </font><font color="#008000"><i>{LSB = 0}
    </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(</font><font color="#800000">$EB </font><font color="#000080">/ </font><font color="#800000">$00</font><font color="#000080">);         </font><font color="#008000"><i>{jmp short $+2 ;delay}
    </i></font>Port <font color="#000080">[</font><font color="#800000">$40</font><font color="#000080">] := </font><font color="#800000">$00</font><font color="#000080">;        </font><font color="#008000"><i>{MSB = 0}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{RestoreTimer}

  </i></font><font color="#FF0000"><b>FUNCTION </b></font>ReadTimer <font color="#000080">: </font>LongInt<font color="#000080">;
    </font><font color="#008000"><i>{-Read the timer with 1 microsecond resolution}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{ReadTimer}
    </i></font><font color="#FF0000"><b>INLINE </b></font><font color="#000080">(
    </font><font color="#800000">$FA </font><font color="#000080">/                   </font><font color="#008000"><i>{cli             ;Disable interrupts}
    </i></font><font color="#800000">$BA </font><font color="#000080">/ </font><font color="#800000">$20 </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/           </font><font color="#008000"><i>{mov  dx,$20     ;Address PIC ocw3}
    </i></font><font color="#800000">$B0 </font><font color="#000080">/ </font><font color="#800000">$0A </font><font color="#000080">/               </font><font color="#008000"><i>{mov  al,$0A     ;Ask to read irr}
    </i></font><font color="#800000">$EE </font><font color="#000080">/                   </font><font color="#008000"><i>{out  dx,al}
    </i></font><font color="#800000">$B0 </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  al,$00     ;Latch timer 0}
    </i></font><font color="#800000">$E6 </font><font color="#000080">/ </font><font color="#800000">$43 </font><font color="#000080">/               </font><font color="#008000"><i>{out  $43,al}
    </i></font><font color="#800000">$EC </font><font color="#000080">/                   </font><font color="#008000"><i>{in   al,dx      ;Read irr}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$C7 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  di,ax      ;Save it in DI}
    </i></font><font color="#800000">$E4 </font><font color="#000080">/ </font><font color="#800000">$40 </font><font color="#000080">/               </font><font color="#008000"><i>{in   al,$40     ;Counter --&gt; bx}
    </i></font><font color="#800000">$88 </font><font color="#000080">/ </font><font color="#800000">$C3 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  bl,al      ;LSB in BL}
    </i></font><font color="#800000">$E4 </font><font color="#000080">/ </font><font color="#800000">$40 </font><font color="#000080">/               </font><font color="#008000"><i>{in   al,$40}
    </i></font><font color="#800000">$88 </font><font color="#000080">/ </font><font color="#800000">$C7 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  bh,al      ;MSB in BH}
    </i></font><font color="#800000">$F7 </font><font color="#000080">/ </font><font color="#800000">$D3 </font><font color="#000080">/               </font><font color="#008000"><i>{not  bx         ;Need ascending counter}
    </i></font><font color="#800000">$E4 </font><font color="#000080">/ </font><font color="#800000">$21 </font><font color="#000080">/               </font><font color="#008000"><i>{in   al,$21     ;Read PIC imr}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$C6 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  si,ax      ;Save it in SI}
    </i></font><font color="#800000">$B0 </font><font color="#000080">/ </font><font color="#800000">$FF </font><font color="#000080">/               </font><font color="#008000"><i>{mov  al,$0FF    ;Mask all interrupts}
    </i></font><font color="#800000">$E6 </font><font color="#000080">/ </font><font color="#800000">$21 </font><font color="#000080">/               </font><font color="#008000"><i>{out  $21,al}
    </i></font><font color="#800000">$B8 </font><font color="#000080">/ </font><font color="#800000">$40 </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/           </font><font color="#008000"><i>{mov  ax,$40     ;read low word of time}
    </i></font><font color="#800000">$8E </font><font color="#000080">/ </font><font color="#800000">$C0 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  es,ax      ;from BIOS data area}
    </i></font><font color="#800000">$26 </font><font color="#000080">/ </font><font color="#800000">$8B </font><font color="#000080">/ </font><font color="#800000">$16 </font><font color="#000080">/ </font><font color="#800000">$6C </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/   </font><font color="#008000"><i>{mov  dx,es:[$6C]}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$F0 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  ax,si      ;Restore imr from SI}
    </i></font><font color="#800000">$E6 </font><font color="#000080">/ </font><font color="#800000">$21 </font><font color="#000080">/               </font><font color="#008000"><i>{out  $21,al}
    </i></font><font color="#800000">$FB </font><font color="#000080">/                   </font><font color="#008000"><i>{sti             ;Enable interrupts}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$F8 </font><font color="#000080">/               </font><font color="#008000"><i>{mov  ax,di      ;Retrieve old irr}
    </i></font><font color="#800000">$A8 </font><font color="#000080">/ </font><font color="#800000">$01 </font><font color="#000080">/               </font><font color="#008000"><i>{test al,$01     ;Counter hit 0?}
    </i></font><font color="#800000">$74 </font><font color="#000080">/ </font><font color="#800000">$07 </font><font color="#000080">/               </font><font color="#008000"><i>{jz   done       ;Jump if not}
    </i></font><font color="#800000">$81 </font><font color="#000080">/ </font><font color="#800000">$FB </font><font color="#000080">/ </font><font color="#800000">$FF </font><font color="#000080">/ </font><font color="#800000">$00 </font><font color="#000080">/       </font><font color="#008000"><i>{cmp  bx,$FF     ;Counter &gt; $FF?}
    </i></font><font color="#800000">$77 </font><font color="#000080">/ </font><font color="#800000">$01 </font><font color="#000080">/               </font><font color="#008000"><i>{ja   done       ;Done if so}
    </i></font><font color="#800000">$42 </font><font color="#000080">/                   </font><font color="#008000"><i>{inc  dx         ;Else count int req.}
    {done:}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$5E </font><font color="#000080">/ </font><font color="#800000">$FC </font><font color="#000080">/           </font><font color="#008000"><i>{mov [bp-4],bx   ;set function result}
    </i></font><font color="#800000">$89 </font><font color="#000080">/ </font><font color="#800000">$56 </font><font color="#000080">/ </font><font color="#800000">$FE</font><font color="#000080">);          </font><font color="#008000"><i>{mov [bp-2],dx}
  </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{ReadTimer}

  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>Calibrate<font color="#000080">;
    </font><font color="#008000"><i>{-Calibrate the timer}
  </i></font><font color="#FF0000"><b>CONST
    </b></font>Reps <font color="#000080">= </font><font color="#800000">1000</font><font color="#000080">;
  </font><font color="#FF0000"><b>VAR
    </b></font>I <font color="#000080">: </font>Word<font color="#000080">;
    </font>L1<font color="#000080">, </font>L2<font color="#000080">, </font>Diff <font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{Calibrate}
    </i></font>Delta <font color="#000080">:= </font>MaxInt<font color="#000080">;
    </font><font color="#FF0000"><b>FOR </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>TO </b></font>Reps <font color="#FF0000"><b>DO BEGIN
      </b></font>L1 <font color="#000080">:= </font>ReadTimer<font color="#000080">;
      </font>L2 <font color="#000080">:= </font>ReadTimer<font color="#000080">;
      </font><font color="#008000"><i>{use the minimum difference}
      </i></font>Diff <font color="#000080">:= </font>L2 <font color="#000080">- </font>L1<font color="#000080">;
      </font><font color="#FF0000"><b>IF </b></font>Diff <font color="#000080">&lt; </font>Delta <font color="#FF0000"><b>THEN
        </b></font>Delta <font color="#000080">:= </font>Diff<font color="#000080">;
    </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{Calibrate}

  {$F+}
  </i></font><font color="#FF0000"><b>PROCEDURE </b></font>OurExitProc<font color="#000080">;
    </font><font color="#008000"><i>{-Restore timer chip to its original state}
  </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>{OurExitProc}
    </i></font>ExitProc <font color="#000080">:= </font>SaveExitProc<font color="#000080">;
    </font>RestoreTimer<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;                       </font><font color="#008000"><i>{OurExitProc}
  {$F-}

</i></font><font color="#FF0000"><b>BEGIN
  </b></font><font color="#008000"><i>{set up our exit handler}
  </i></font>SaveExitProc <font color="#000080">:= </font>ExitProc<font color="#000080">;
  </font>ExitProc <font color="#000080">:= @</font>OurExitProc<font color="#000080">;
  
  </font><font color="#008000"><i>{reprogram the timer chip}
  </i></font>InitializeTimer<font color="#000080">;
  
  </font><font color="#008000"><i>{adjust for speed of machine}
  </i></font>Calibrate<font color="#000080">;
</font><font color="#FF0000"><b>END</b></font><font color="#000080">.


</font><font color="#008000"><i>{CUT OFF...}


{CUT ... Save this as TCTIMER.PAS}

</i></font><font color="#FF0000"><b>UNIT </b></font>tctimer<font color="#000080">;

</font><font color="#FF0000"><b>INTERFACE
USES </b></font>tptimer<font color="#000080">;

  </font><font color="#FF0000"><b>VAR
    </b></font>start <font color="#000080">: </font>LongInt<font color="#000080">;
    
  </font><font color="#FF0000"><b>PROCEDURE </b></font>StartTimer<font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>WriteElapsedTime<font color="#000080">;



</font><font color="#FF0000"><b>IMPLEMENTATION

PROCEDURE </b></font>StartTimer<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>start <font color="#000080">:= </font>ReadTimer<font color="#000080">;
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE  </b></font>WriteElapsedTime<font color="#000080">;
  </font><font color="#FF0000"><b>VAR </b></font>stop <font color="#000080">: </font>LongInt<font color="#000080">;
  </font><font color="#FF0000"><b>BEGIN
    </b></font>stop <font color="#000080">:= </font>ReadTimer<font color="#000080">;
    </font>WriteLn <font color="#000080">(</font><font color="#800000">'calc = '</font><font color="#000080">, (</font>ElapsedTime <font color="#000080">(</font>start<font color="#000080">, </font>stop<font color="#000080">) / </font><font color="#800000">1000</font><font color="#000080">): </font><font color="#800000">10</font><font color="#000080">: </font><font color="#800000">6</font><font color="#000080">, </font><font color="#800000">' sec'</font><font color="#000080">);
  </font><font color="#FF0000"><b>END</b></font><font color="#000080">;


</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{CUT OFF...}

{CUT ... Save this as TPBUFFER.PAS}

</i></font><font color="#FF0000"><b>UNIT </b></font>TPbuffer<font color="#000080">;

</font><font color="#008000"><i>(* TP-Buffer unit version 1.1 /Update              *)
(* Using the keyboard's buffer in Turbo Pascal     *)
(* This unit is released to the public domain      *)
(* by Lavi Tidhar on 5-10-1992                     *)

(* This unit adds three special functions not      *)
(* incuded in the Turbo Pascal regular package     *)

(* You may alter this source code, move the        *)
(* procedures to your own programs. Please do      *)
(* NOT change these lines of documentation         *)

(* This source might teach you about how to        *)
(* use interrupts in pascal, and the keyboard's    *)
(* buffer. from the other hand, it might not :-)   *)

(* Used: INT 16, functions 0 and 1                 *)
(*       INT 21, function 0Ch                      *)

(* INT 16 - KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
           AH = 00h
           Return: AH = scan code
                   AL = character         *)

(* INT 16 - KEYBOARD - CHECK BUFFER, DO NOT CLEAR
           AH = 01h
           Return: ZF = 0 character in buffer
                       AH = scan code
                       AL = character
                       ZF = 1 no character in buffer *)

(* INT 21 - DOS - CLEAR KEYBOARD BUFFER
        AH = 0Ch
        AL must be 1, 6, 7, 8, or 0Ah.
        Notes: Flushes all typeahead input, then executes function specified by AL
        (effectively moving it to AH and repeating the INT 21 call).
        If AL contains a value not in the list above, the keyboard buffer is
        flushed and no other action is taken. *)

(* For more details/help etc, you can contact me on: *)

(* Mail: Lavi Tidhar
         46 Bantam Dr.
         Blairgowrie
         2194
         South Africa
*)

(* Phone:
          International: +27-11-787-8093
          South Africa:  (011)-787-8093
*)

(* Netmail: The Catacomb BBS 5:7101/45 (fidonet)
            The Catacomb BBS 80:80/100 (pipemail)
*)

</i></font><font color="#FF0000"><b>INTERFACE

USES </b></font>DOS<font color="#000080">;

</font><font color="#FF0000"><b>FUNCTION </b></font>GetScanCode<font color="#000080">: </font>Byte<font color="#000080">; </font><font color="#008000"><i>(* Get SCAN CODE from buffer, wait if empty *)
</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetKey<font color="#000080">: </font>Char<font color="#000080">;      </font><font color="#008000"><i>(* Get Char from buffer, do NOT wait *)
</i></font><font color="#FF0000"><b>PROCEDURE </b></font>FlushKB<font color="#000080">;

</font><font color="#FF0000"><b>IMPLEMENTATION

FUNCTION </b></font>GetKey<font color="#000080">: </font>Char<font color="#000080">;
 </font><font color="#FF0000"><b>VAR </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;
 </font><font color="#FF0000"><b>BEGIN
   </b></font>Regs<font color="#000080">. </font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;                </font><font color="#008000"><i>(* Int 16 function 1 *)
   </i></font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>Regs<font color="#000080">);           </font><font color="#008000"><i>(* Read a charecter from the keyboard buffer *)
   </i></font>GetKey <font color="#000080">:= </font>Chr <font color="#000080">(</font>Regs<font color="#000080">. </font>AL<font color="#000080">);     </font><font color="#008000"><i>(* do not wait. If no char was found, CHR(0) *)
 </i></font><font color="#FF0000"><b>END</b></font><font color="#000080">;                        </font><font color="#008000"><i>(* (nul) is returned *)

</i></font><font color="#FF0000"><b>FUNCTION </b></font>GetScanCode<font color="#000080">: </font>Byte<font color="#000080">;   </font><font color="#008000"><i>(* Int 16 function 0 *)
 </i></font><font color="#FF0000"><b>VAR </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;         </font><font color="#008000"><i>(* The same as CRT's Readkey, but gives you *)
 </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>(* the scan code. Esp usefull when you want to *)
   </i></font>Regs<font color="#000080">. </font>AH <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;               </font><font color="#008000"><i>(* use special keys as the arrows, there will *)
   </i></font>Intr <font color="#000080">(</font><font color="#800000">$16</font><font color="#000080">, </font>Regs<font color="#000080">);          </font><font color="#008000"><i>(* be a conflict when using ReadKey *)
   </i></font>GetScanCode <font color="#000080">:= </font>Regs<font color="#000080">. </font>AH<font color="#000080">;
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>PROCEDURE </b></font>FlushKB<font color="#000080">;           </font><font color="#008000"><i>(* INT 21 function 0C *)
 </i></font><font color="#FF0000"><b>VAR </b></font>Regs<font color="#000080">: </font>Registers<font color="#000080">;         </font><font color="#008000"><i>(* Flushes (erase) the keyboard buffer *)
 </i></font><font color="#FF0000"><b>BEGIN                      </b></font><font color="#008000"><i>(* ONLY. No other function is executed *)
   </i></font>Regs<font color="#000080">. </font>AH <font color="#000080">:= </font><font color="#800000">$0C</font><font color="#000080">;
   </font>Regs<font color="#000080">. </font>AL <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
   </font>Intr <font color="#000080">(</font><font color="#800000">$21</font><font color="#000080">, </font>Regs<font color="#000080">);
 </font><font color="#FF0000"><b>END</b></font><font color="#000080">;

</font><font color="#FF0000"><b>END</b></font><font color="#000080">.

</font><font color="#008000"><i>{CUT OFF...}


{CUT... Save this as SCANCODE.PAS}

</i></font><font color="#FF0000"><b>UNIT </b></font>ScanCode<font color="#000080">;

</font><font color="#008000"><i>{ This UNIT is created by Wayne Boyd, aka Vipramukhya Swami, BBS phone
   (604)431-6260, Fidonet node 1:153/763. It's function is to facilitate
   the use of Function keys and Alt keys in a program. It includes F1
   through F10, Shift-F1 through Shift-F10, Ctrl-F1 through Ctrl-F10,
   and Alt-F1 through Alt-F10. It also includes all of the alt keys, all
   of the Ctrl keys and many other keys as well. This UNIT and source code
   are copyrighted material and may not be used for commercial use
   without express written permission from the author. Use at your own
   risk. I take absolutely no responsibility for it, and there are no
   guarantees that it will do anything more than take up space on your
   disk. }


</i></font><font color="#FF0000"><b>INTERFACE

CONST
  
  </b></font>F1  <font color="#000080">= </font><font color="#800000">59</font><font color="#000080">;   </font>CtrlF1  <font color="#000080">=  </font><font color="#800000">94</font><font color="#000080">;   </font>AltF1  <font color="#000080">= </font><font color="#800000">104</font><font color="#000080">;   </font>Homekey   <font color="#000080">= </font><font color="#800000">71</font><font color="#000080">;
  </font>F2  <font color="#000080">= </font><font color="#800000">60</font><font color="#000080">;   </font>CtrlF2  <font color="#000080">=  </font><font color="#800000">95</font><font color="#000080">;   </font>AltF2  <font color="#000080">= </font><font color="#800000">105</font><font color="#000080">;   </font>Endkey    <font color="#000080">= </font><font color="#800000">79</font><font color="#000080">;
  </font>F3  <font color="#000080">= </font><font color="#800000">61</font><font color="#000080">;   </font>CtrlF3  <font color="#000080">=  </font><font color="#800000">96</font><font color="#000080">;   </font>AltF3  <font color="#000080">= </font><font color="#800000">106</font><font color="#000080">;   </font>PgUp      <font color="#000080">= </font><font color="#800000">73</font><font color="#000080">;
  </font>F4  <font color="#000080">= </font><font color="#800000">62</font><font color="#000080">;   </font>CtrlF4  <font color="#000080">=  </font><font color="#800000">97</font><font color="#000080">;   </font>AltF4  <font color="#000080">= </font><font color="#800000">107</font><font color="#000080">;   </font>PgDn      <font color="#000080">= </font><font color="#800000">81</font><font color="#000080">;
  </font>F5  <font color="#000080">= </font><font color="#800000">63</font><font color="#000080">;   </font>CtrlF5  <font color="#000080">=  </font><font color="#800000">98</font><font color="#000080">;   </font>AltF5  <font color="#000080">= </font><font color="#800000">108</font><font color="#000080">;   </font>UpArrow   <font color="#000080">= </font><font color="#800000">72</font><font color="#000080">;
  </font>F6  <font color="#000080">= </font><font color="#800000">64</font><font color="#000080">;   </font>CtrlF6  <font color="#000080">=  </font><font color="#800000">99</font><font color="#000080">;   </font>AltF6  <font color="#000080">= </font><font color="#800000">109</font><font color="#000080">;   </font>RtArrow   <font color="#000080">= </font><font color="#800000">77</font><font color="#000080">;
  </font>F7  <font color="#000080">= </font><font color="#800000">65</font><font color="#000080">;   </font>CtrlF7  <font color="#000080">= </font><font color="#800000">100</font><font color="#000080">;   </font>AltF7  <font color="#000080">= </font><font color="#800000">110</font><font color="#000080">;   </font>DnArrow   <font color="#000080">= </font><font color="#800000">80</font><font color="#000080">;
  </font>F8  <font color="#000080">= </font><font color="#800000">66</font><font color="#000080">;   </font>CtrlF8  <font color="#000080">= </font><font color="#800000">101</font><font color="#000080">;   </font>AltF8  <font color="#000080">= </font><font color="#800000">111</font><font color="#000080">;   </font>LfArrow   <font color="#000080">= </font><font color="#800000">75</font><font color="#000080">;
  </font>F9  <font color="#000080">= </font><font color="#800000">67</font><font color="#000080">;   </font>CtrlF9  <font color="#000080">= </font><font color="#800000">102</font><font color="#000080">;   </font>AltF9  <font color="#000080">= </font><font color="#800000">112</font><font color="#000080">;   </font>InsertKey <font color="#000080">= </font><font color="#800000">82</font><font color="#000080">;
  </font>F10 <font color="#000080">= </font><font color="#800000">68</font><font color="#000080">;   </font>CtrlF10 <font color="#000080">= </font><font color="#800000">103</font><font color="#000080">;   </font>AltF10 <font color="#000080">= </font><font color="#800000">113</font><font color="#000080">;   </font>DeleteKey <font color="#000080">= </font><font color="#800000">83</font><font color="#000080">;
  
  </font>AltQ <font color="#000080">= </font><font color="#800000">16</font><font color="#000080">;   </font>AltA <font color="#000080">= </font><font color="#800000">30</font><font color="#000080">;   </font>AltZ <font color="#000080">= </font><font color="#800000">44</font><font color="#000080">;   </font>Alt1 <font color="#000080">= </font><font color="#800000">120</font><font color="#000080">;  </font>ShftF1 <font color="#000080">= </font><font color="#800000">84</font><font color="#000080">;
  </font>AltW <font color="#000080">= </font><font color="#800000">17</font><font color="#000080">;   </font>AltS <font color="#000080">= </font><font color="#800000">31</font><font color="#000080">;   </font>AltX <font color="#000080">= </font><font color="#800000">45</font><font color="#000080">;   </font>Alt2 <font color="#000080">= </font><font color="#800000">121</font><font color="#000080">;  </font>ShftF2 <font color="#000080">= </font><font color="#800000">85</font><font color="#000080">;
  </font>AltE <font color="#000080">= </font><font color="#800000">18</font><font color="#000080">;   </font>AltD <font color="#000080">= </font><font color="#800000">32</font><font color="#000080">;   </font>AltC <font color="#000080">= </font><font color="#800000">46</font><font color="#000080">;   </font>Alt3 <font color="#000080">= </font><font color="#800000">122</font><font color="#000080">;  </font>ShftF3 <font color="#000080">= </font><font color="#800000">86</font><font color="#000080">;
  </font>AltR <font color="#000080">= </font><font color="#800000">19</font><font color="#000080">;   </font>AltF <font color="#000080">= </font><font color="#800000">33</font><font color="#000080">;   </font>AltV <font color="#000080">= </font><font color="#800000">47</font><font color="#000080">;   </font>Alt4 <font color="#000080">= </font><font color="#800000">123</font><font color="#000080">;  </font>ShftF4 <font color="#000080">= </font><font color="#800000">87</font><font color="#000080">;
  </font>AltT <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;   </font>AltG <font color="#000080">= </font><font color="#800000">34</font><font color="#000080">;   </font>AltB <font color="#000080">= </font><font color="#800000">48</font><font color="#000080">;   </font>Alt5 <font color="#000080">= </font><font color="#800000">124</font><font color="#000080">;  </font>ShftF5 <font color="#000080">= </font><font color="#800000">88</font><font color="#000080">;
  </font>AltY <font color="#000080">= </font><font color="#800000">21</font><font color="#000080">;   </font>AltH <font color="#000080">= </font><font color="#800000">35</font><font color="#000080">;   </font>AltN <font color="#000080">= </font><font color="#800000">49</font><font color="#000080">;   </font>Alt6 <font color="#000080">= </font><font color="#800000">125</font><font color="#000080">;  </font>ShftF6 <font color="#000080">= </font><font color="#800000">89</font><font color="#000080">;
  </font>AltU <font color="#000080">= </font><font color="#800000">22</font><font color="#000080">;   </font>AltJ <font color="#000080">= </font><font color="#800000">36</font><font color="#000080">;   </font>AltM <font color="#000080">= </font><font color="#800000">50</font><font color="#000080">;   </font>Alt7 <font color="#000080">= </font><font color="#800000">126</font><font color="#000080">;  </font>ShftF7 <font color="#000080">= </font><font color="#800000">90</font><font color="#000080">;
  </font>AltI <font color="#000080">= </font><font color="#800000">23</font><font color="#000080">;   </font>AltK <font color="#000080">= </font><font color="#800000">37</font><font color="#000080">;                </font>Alt8 <font color="#000080">= </font><font color="#800000">127</font><font color="#000080">;  </font>ShftF8 <font color="#000080">= </font><font color="#800000">91</font><font color="#000080">;
  </font>AltO <font color="#000080">= </font><font color="#800000">24</font><font color="#000080">;   </font>AltL <font color="#000080">= </font><font color="#800000">38</font><font color="#000080">;                </font>Alt9 <font color="#000080">= </font><font color="#800000">128</font><font color="#000080">;  </font>ShftF9 <font color="#000080">= </font><font color="#800000">92</font><font color="#000080">;
  </font>AltP <font color="#000080">= </font><font color="#800000">25</font><font color="#000080">;   </font>CtrlLf <font color="#000080">= </font><font color="#800000">115</font><font color="#000080">;             </font>Alt0 <font color="#000080">= </font><font color="#800000">129</font><font color="#000080">;  </font>ShftF10 <font color="#000080">= </font><font color="#800000">93</font><font color="#000080">;
  </font>CtrlRt <font color="#000080">= </font><font color="#800000">116</font><font color="#000080">;
  
  </font>CtrlA  <font color="#000080">= </font><font color="#800000">#1</font><font color="#000080">;  </font>CtrlK <font color="#000080">= </font><font color="#800000">#11</font><font color="#000080">; </font>CtrlU <font color="#000080">= </font><font color="#800000">#21</font><font color="#000080">; </font>CtrlB <font color="#000080">= </font><font color="#800000">#2</font><font color="#000080">;  </font>CtrlL <font color="#000080">= </font><font color="#800000">#12</font><font color="#000080">;
  </font>CtrlV  <font color="#000080">= </font><font color="#800000">#22</font><font color="#000080">; </font>CtrlC <font color="#000080">= </font><font color="#800000">#3</font><font color="#000080">;  </font>CtrlM <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">; </font>CtrlW <font color="#000080">= </font><font color="#800000">#23</font><font color="#000080">; </font>CtrlD <font color="#000080">= </font><font color="#800000">#4</font><font color="#000080">;
  </font>CtrlN  <font color="#000080">= </font><font color="#800000">#14</font><font color="#000080">; </font>CtrlX <font color="#000080">= </font><font color="#800000">#24</font><font color="#000080">; </font>CtrlE <font color="#000080">= </font><font color="#800000">#5</font><font color="#000080">;  </font>CtrlO <font color="#000080">= </font><font color="#800000">#15</font><font color="#000080">; </font>CtrlY <font color="#000080">= </font><font color="#800000">#25</font><font color="#000080">;
  </font>CtrlF  <font color="#000080">= </font><font color="#800000">#6</font><font color="#000080">;  </font>CtrlP <font color="#000080">= </font><font color="#800000">#16</font><font color="#000080">; </font>CtrlZ <font color="#000080">= </font><font color="#800000">#26</font><font color="#000080">; </font>CtrlG <font color="#000080">= </font><font color="#800000">#7</font><font color="#000080">;  </font>CtrlQ <font color="#000080">= </font><font color="#800000">#17</font><font color="#000080">;
  </font>CtrlS  <font color="#000080">= </font><font color="#800000">#19</font><font color="#000080">; </font>CtrlH <font color="#000080">= </font><font color="#800000">#8</font><font color="#000080">;  </font>CtrlR <font color="#000080">= </font><font color="#800000">#18</font><font color="#000080">; </font>CtrlI <font color="#000080">= </font><font color="#800000">#9</font><font color="#000080">;  </font>CtrlJ <font color="#000080">= </font><font color="#800000">#10</font><font color="#000080">;
  </font>CtrlT <font color="#000080">= </font><font color="#800000">#20</font><font color="#000080">;  </font>BSpace <font color="#000080">= </font><font color="#800000">#8</font><font color="#000080">; </font>EscapeKey <font color="#000080">= </font><font color="#800000">#27</font><font color="#000080">; </font>EnterKey <font color="#000080">= </font><font color="#800000">#13</font><font color="#000080">; </font>NullKey <font color="#000080">= </font><font color="#800000">#0</font><font color="#000080">;
  
</font><font color="#FF0000"><b>IMPLEMENTATION

END</b></font><font color="#000080">.

</font><font color="#008000"><i>{CUT OFF...}
</i></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0242.PAS">Original</a><b>]</b></p></body>
</html>
