<html>
<head><title> "Number of Days in a month" by CARL STEINHILBER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Since Delphi's TDateTime data type stores dates in
number of days since 1/1/0001, all you need to do is
subtract the TDateTime of the first day of the month
in question from the TDateTime of the first day of the
following month.

The following function will return an integer representing
the number of days in any given month:
}

</i></font><font color="#FF0000"><b>function </b></font>daysHathTheMonth<font color="#000080">(</font>whichMonth<font color="#000080">, </font>whichYear<font color="#000080">:</font>integer<font color="#000080">):</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>beginDate<font color="#000080">, </font>endDate <font color="#000080">:</font>TDateTime<font color="#000080">;
   </font>beginMonth<font color="#000080">,</font>endMonth<font color="#000080">,</font>beginYear<font color="#000080">,</font>endYear<font color="#000080">:</font>word<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>beginMonth <font color="#000080">:= </font>whichMonth<font color="#000080">;
   </font>beginYear <font color="#000080">:= </font>whichYear<font color="#000080">;
   </font>endMonth <font color="#000080">:= </font>whichMonth <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font>endYear <font color="#000080">:= </font>whichYear<font color="#000080">;
   </font><font color="#FF0000"><b>if </b></font>beginMonth <font color="#000080">&gt; </font><font color="#800000">11 </font><font color="#FF0000"><b>then
      begin
          </b></font><font color="#008000"><i>{the month in question is December, so the following
               TDateTime would be January 1st of the following year}
           </i></font>beginMonth <font color="#000080">:= </font><font color="#800000">12</font><font color="#000080">;
           </font>endMonth <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
           </font>endYear <font color="#000080">:= </font>whichYear <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
   </font>beginDate <font color="#000080">:= </font>encodeDate<font color="#000080">(</font>beginYear<font color="#000080">,</font>beginMonth<font color="#000080">,</font><font color="#800000">01</font><font color="#000080">);
   </font>endDate <font color="#000080">:= </font>encodeDate<font color="#000080">(</font>endYear<font color="#000080">,</font>endMonth<font color="#000080">,</font><font color="#800000">01</font><font color="#000080">);
   </font>daysHathTheMonth<font color="#000080">:= </font>strToInt<font color="#000080">(</font>floatToStr<font color="#000080">(</font>endDate <font color="#000080">- </font>beginDate<font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
==============================================================

</font><font color="#FF0000"><b>To </b></font>test it<font color="#000080">, </font>just call<font color="#000080">:
 </font>showMessage<font color="#000080">(</font>intToStr<font color="#000080">(</font>daysHathTheMonth<font color="#000080">(</font><font color="#800000">04</font><font color="#000080">,</font><font color="#800000">1996</font><font color="#000080">)));

</font>You can easily add a <font color="#FF0000"><b>case </b></font>statement <font color="#FF0000"><b>in </b></font>order <font color="#FF0000"><b>to </b></font>be able <font color="#FF0000"><b>to
</b></font>pass the <font color="#FF0000"><b>function </b></font>a <font color="#FF0000"><b>string </b></font>such <font color="#FF0000"><b>as </b></font><font color="#800000">'Feb'</font><font color="#000080">, </font>etc<font color="#000080">. </font><font color="#FF0000"><b>if </b></font>you
want<font color="#000080">, </font>but I find integers<font color="#000080">/</font>words more convenient since
all <font color="#FF0000"><b>of </b></font>Delphi<font color="#800000">'s Date and Time Routines use them.

</font><font color="#000080">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 </font>Carl Steinhilber         csteinhilber<font color="#000080">@</font>graphicmedia<font color="#000080">.</font>com
<font color="#000080">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0131.PAS">Original</a><b>]</b></p></body>
</html>
