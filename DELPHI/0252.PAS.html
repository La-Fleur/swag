<html>
<head><title> "Windows directory" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0252.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From <font color="#000080">: </font>Keith Anderson

<font color="#000080">&gt; </font>I have searched all my Tip collections etc<font color="#000080">. </font><font color="#FF0000"><b>and not </b></font>found an answer <font color="#FF0000"><b>for </b></font>a
<font color="#000080">&gt; </font>very simple question<font color="#000080">: </font>how can I find <font color="#FF0000"><b>out </b></font>the Windows directory from Delphi1<font color="#000080">/</font><font color="#800000">2</font><font color="#000080">?

</font>Here<font color="#800000">'s code for Delphi 2.x:  (don'</font>t know about delphi <font color="#800000">1.</font>x<font color="#000080">)

  </font><font color="#FF0000"><b>Function </b></font>WindowsPath<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#008000"><i>{returns the directory of C:\WINDOWS\ on the current machine}
  </i></font><font color="#FF0000"><b>var </b></font>d<font color="#000080">:</font>integer<font color="#000080">;
    </font><font color="#FF0000"><b>begin
      </b></font>setlength<font color="#000080">(</font>result<font color="#000080">,</font><font color="#800000">500</font><font color="#000080">);
      </font>d<font color="#000080">:=</font>getwindowsdirectory<font color="#000080">(</font>pchar<font color="#000080">(</font>result<font color="#000080">),</font><font color="#800000">500</font><font color="#000080">);
      </font>setlength<font color="#000080">(</font>result<font color="#000080">,</font>d<font color="#000080">);
      </font>result<font color="#000080">:=</font>fixpath<font color="#000080">(</font>result<font color="#000080">,</font>result<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


*************************************
</font>Keith Anderson
mailto<font color="#000080">:</font>keith<font color="#000080">@</font>purescience<font color="#000080">.</font>com
http<font color="#000080">:</font><font color="#008000"><i>//www.purescience.com
</i></font><font color="#000080">*************************************

&lt; </font>from <font color="#000080">: </font>Igor Ilutkin<font color="#000080">, </font>More about Windows directory

<font color="#FF0000"><b>function </b></font>TMainFM<font color="#000080">.</font>GetWinDir<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>wd<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>wd <font color="#000080">:= </font>StrAlloc<font color="#000080">(</font><font color="#800000">256</font><font color="#000080">);
  </font>GetWindowsDirectory<font color="#000080">(</font>wd<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
  </font>GetWinDir <font color="#000080">:= </font>StrPas<font color="#000080">(</font>wd<font color="#000080">) + </font><font color="#800000">'\'</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TMainFM<font color="#000080">.</font>GetRunDir<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetRunDir <font color="#000080">:= </font>ExtractFilePath<font color="#000080">(</font>ParamStr<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">));
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0252.PAS">Original</a><b>]</b></p></body>
</html>
