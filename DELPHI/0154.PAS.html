<html>
<head><title> "Re: Popup Menus at runtime" by DARREN CLARK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0154.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{
&gt; Can you add menu items to the standard popup menu of a form?
&gt; 
&gt; I want to do the same thing that Borland did for their PageControl
&gt; component.  If you right-click on the Page Control, you get the same std
&gt; menu but with a couple of new items inserted at the top (e.g. New Page).
&gt; 
&gt; I remember reading a post asking about how to create menus at runtime.
&gt; I don't think it was answered through the newsgroup, so...
&gt; How do you create menus at runtime?
&gt; 

Do you mean add things to the right click menu when designing? Or create a popup 
when the program is running? 

When running simply create a TPopupMenu and assign it to the PopupMenu property.
This can either be done at design-time or run-time.  It won't show at design time 
however, since that menu is the form designers.

To add items to the context menu that is shown at design-time, you need to create 
a new component editor for your component.

You'll need to override GetVerbCount to return the number of items you want to
add to the menu, and GetVerb to actually fill the list of items.  You'll also
need to override ExecuteVerb to actually do the actions.

For example:
}

</i></font>TMyEditor <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TComponentEditor<font color="#000080">)
</font><font color="#FF0000"><b>public
  function </b></font>GetVerbCount <font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>GetVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ExecuteVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;\
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TMyEditor<font color="#000080">.</font>GetVerbCount <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>Result <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TMyEditor<font color="#000080">.</font>GetVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  case </b></font>Index <font color="#FF0000"><b>of
        </b></font><font color="#800000">0 </font><font color="#000080">: </font>Result <font color="#000080">:= </font><font color="#800000">'Say Hi'</font><font color="#000080">;
         </font><font color="#800000">1 </font><font color="#000080">: </font>Result <font color="#000080">:= </font><font color="#800000">'Say Bye'</font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyEditor<font color="#000080">.</font>ExecuteVerb<font color="#000080">(</font>Index <font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
   </b></font>MyMsg <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     case </b></font>Index <font color="#FF0000"><b>of
        </b></font><font color="#800000">0 </font><font color="#000080">: </font>MyMsg <font color="#000080">:= </font><font color="#800000">'Hi'</font><font color="#000080">;
        </font><font color="#800000">1 </font><font color="#000080">: </font>MyMsg <font color="#000080">:= </font><font color="#800000">'Bye;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>MessageDlg<font color="#000080">(</font>MyMsg<font color="#000080">,</font>mtInformation<font color="#000080">,[</font>mbOK<font color="#000080">],</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>You<font color="#800000">'ll also need to register the component editor in the Register proc for the 
</font>component<font color="#000080">.

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'My Component Page'</font><font color="#000080">,[</font>TMyComponent<font color="#000080">]);
     </font>RegisterComponentEditor<font color="#000080">(</font>TMyComponent<font color="#000080">,</font>TMyEditor<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0154.PAS">Original</a><b>]</b></p></body>
</html>
