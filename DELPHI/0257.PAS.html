<html>
<head><title> "Creating a function with multiple args" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0257.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">Sometimes it<font color="#800000">'s necessary to pass undefined number of [different type]
</font>variables <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>function </b></font><font color="#000080">-- </font>look at Format<font color="#000080">() </font><font color="#FF0000"><b>function in </b></font>Delphi <font color="#FF0000"><b>and
</b></font><font color="#000080">*</font>printf<font color="#000080">() </font>functions <font color="#FF0000"><b>in </b></font>C<font color="#000080">/</font>C<font color="#000080">++ </font><font color="#FF0000"><b>for </b></font>example<font color="#000080">. </font>Once you analyze the following
code<font color="#000080">, </font>you<font color="#800000">'ll be on your way to creating mysterious variable parameter
</font>functions<font color="#000080">...

</font><font color="#008000"><i>//
// FunctionWithVarArgs()
//
// skeleton for a function that
// can accept vairable number of
// multi-type variables
//
// here are some examples on how
// to call this function:
//
// FunctionWithVarArgs(
//   [ 1, True, 3, '5', '0' ] );
//
// FunctionWithVarArgs(
//   [ 'one', 5 ] );
//
// FunctionWithVarArgs( [] );
//
</i></font><font color="#FF0000"><b>procedure </b></font>FunctionWithVarArgs<font color="#000080">(
  </font><font color="#FF0000"><b>const </b></font>ArgsList <font color="#000080">: </font><font color="#FF0000"><b>array of const </b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>ArgsListTyped <font color="#000080">:
    </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$FFF0 </font><font color="#FF0000"><b>div </b></font>SizeOf<font color="#000080">(</font>TVarRec<font color="#000080">)]
      </font><font color="#FF0000"><b>of </b></font>TVarRec <font color="#FF0000"><b>absolute </b></font>ArgsList<font color="#000080">;
  </font>n         <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  for </b></font>n <font color="#000080">:= </font>Low<font color="#000080">( </font>ArgsList <font color="#000080">) </font><font color="#FF0000"><b>to
           </b></font>High<font color="#000080">( </font>ArgsList <font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    with </b></font>ArgsListTyped<font color="#000080">[ </font>n <font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      case </b></font>VType <font color="#FF0000"><b>of
        </b></font>vtInteger   <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VInteger here}      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtBoolean   <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VBoolean here}      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtChar      <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VChar here}         </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtExtended  <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VExtended here}     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtString    <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VString here}       </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtPointer   <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VPointer here}      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtPChar     <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VPChar here}        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtObject    <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VObject here}       </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtClass     <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VClass here}        </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtWideChar  <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VWideChar here}     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtPWideChar <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VPWideChar here}    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtAnsiString<font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VAnsiString here}   </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtCurrency  <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VCurrency here}     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>vtVariant   <font color="#000080">: </font><font color="#FF0000"><b>begin
          </b></font><font color="#008000"><i>{handle VVariant here}      </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>else          begin
          </b></font><font color="#008000"><i>{handle unknown type here} </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>//
// example function created using
// the above skeleton
//
// AddNumbers() will return the
// sum of all the integers passed
// to it
//
// AddNumbers( [1, 2, 3] )
//   will return 6
//
//
</i></font><font color="#FF0000"><b>function </b></font>AddNumbers<font color="#000080">(
  </font><font color="#FF0000"><b>const </b></font>ArgsList <font color="#000080">: </font><font color="#FF0000"><b>array of const </b></font><font color="#000080">)
    : </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>ArgsListTyped <font color="#000080">:
    </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">$FFF0 </font><font color="#FF0000"><b>div </b></font>SizeOf<font color="#000080">(</font>TVarRec<font color="#000080">)]
      </font><font color="#FF0000"><b>of </b></font>TVarRec <font color="#FF0000"><b>absolute </b></font>ArgsList<font color="#000080">;
  </font>n         <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font><font color="#FF0000"><b>for </b></font>n <font color="#000080">:= </font>Low<font color="#000080">( </font>ArgsList <font color="#000080">) </font><font color="#FF0000"><b>to
           </b></font>High<font color="#000080">( </font>ArgsList <font color="#000080">) </font><font color="#FF0000"><b>do
  begin
    with </b></font>ArgsListTyped<font color="#000080">[ </font>n <font color="#000080">] </font><font color="#FF0000"><b>do
    begin
      case </b></font>VType <font color="#FF0000"><b>of
        </b></font>vtInteger   <font color="#000080">: </font>Result <font color="#000080">:= </font>Result <font color="#000080">+ </font>VInteger<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0257.PAS">Original</a><b>]</b></p></body>
</html>
