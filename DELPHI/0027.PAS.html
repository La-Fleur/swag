<html>
<head><title> "File Copying in DELPHI" by DAVID STIDOLPH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">I wrote the following <font color="#FF0000"><b>function to </b></font>copy a <font color="#FF0000"><b>file and </b></font>keep the 
attributes<font color="#000080">/</font>date<font color="#000080">-</font>time the same <font color="#FF0000"><b>on </b></font>the copied <font color="#FF0000"><b>file</b></font><font color="#000080">.  </font>Hope this helps<font color="#000080">!

</font><font color="#FF0000"><b>function </b></font>FileCopy<font color="#000080">(</font>source<font color="#000080">,</font>dest<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>fSrc<font color="#000080">,</font>fDst<font color="#000080">,</font>len<font color="#000080">: </font>Integer<font color="#000080">;
  </font>size<font color="#000080">: </font>Longint<font color="#000080">;
  </font>buffer<font color="#000080">: </font><font color="#FF0000"><b>packed array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">2047</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>False<font color="#000080">; </font><font color="#008000"><i>{ Assume that it WONT work }
  </i></font><font color="#FF0000"><b>if </b></font>source <font color="#000080">&lt;&gt; </font>dest <font color="#FF0000"><b>then begin
    </b></font>fSrc <font color="#000080">:= </font>FileOpen<font color="#000080">(</font>source<font color="#000080">,</font>fmOpenRead<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>fSrc <font color="#000080">&gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
      </b></font>size <font color="#000080">:= </font>FileSeek<font color="#000080">(</font>fSrc<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">);
      </font>FileSeek<font color="#000080">(</font>fSrc<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
      </font>fDst <font color="#000080">:= </font>FileCreate<font color="#000080">(</font>dest<font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>fDst <font color="#000080">&gt;= </font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
        while </b></font>size <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>do begin
          </b></font>len <font color="#000080">:= </font>FileRead<font color="#000080">(</font>fSrc<font color="#000080">,</font>buffer<font color="#000080">,</font>sizeof<font color="#000080">(</font>buffer<font color="#000080">));
          </font>FileWrite<font color="#000080">(</font>fDst<font color="#000080">,</font>buffer<font color="#000080">,</font>len<font color="#000080">);
          </font>size <font color="#000080">:= </font>size <font color="#000080">- </font>len<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>FileSetDate<font color="#000080">(</font>fDst<font color="#000080">,</font>FileGetDate<font color="#000080">(</font>fSrc<font color="#000080">));
        </font>FileClose<font color="#000080">(</font>fDst<font color="#000080">);
        </font>FileSetAttr<font color="#000080">(</font>dest<font color="#000080">,</font>FileGetAttr<font color="#000080">(</font>source<font color="#000080">));
        </font>Result <font color="#000080">:= </font>True<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
      </font>FileClose<font color="#000080">(</font>fSrc<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0027.PAS">Original</a><b>]</b></p></body>
</html>
