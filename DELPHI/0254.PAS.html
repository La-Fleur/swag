<html>
<head><title> "Delete files with the ability to undo or" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0254.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">--------------------------------------------------------------------------------
</font>Windows will <font color="#FF0000"><b>not </b></font>let the user <font color="#FF0000"><b>or </b></font>your <font color="#FF0000"><b>program </b></font>undo <font color="#FF0000"><b>file </b></font>delete operations
that your perform using low<font color="#000080">-</font>level functions such <font color="#FF0000"><b>as </b></font>DeleteFile<font color="#000080">() </font>from
your <font color="#FF0000"><b>program</b></font><font color="#000080">. </font>Following <font color="#FF0000"><b>function</b></font><font color="#000080">, </font>however<font color="#000080">, </font>will delete a <font color="#FF0000"><b>file with </b></font>the
ability <font color="#FF0000"><b>to </b></font>undo <font color="#000080">(</font>recycle<font color="#000080">) </font>by sending the <font color="#FF0000"><b>file to </b></font>the <font color="#000080">&quot;</font>Recycle Bin<font color="#000080">.&quot;

</font><font color="#FF0000"><b>uses </b></font>ShellAPI<font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DeleteFileWithUndo<font color="#000080">(
  </font>sFileName <font color="#000080">: </font><font color="#FF0000"><b>string </b></font><font color="#000080">)
    : </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>fos <font color="#000080">: </font>TSHFileOpStruct<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FillChar<font color="#000080">( </font>fos<font color="#000080">, </font>SizeOf<font color="#000080">( </font>fos <font color="#000080">), </font><font color="#800000">0 </font><font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>fos <font color="#FF0000"><b>do
  begin
    </b></font>wFunc  <font color="#000080">:= </font>FO_DELETE<font color="#000080">;
    </font>pFrom  <font color="#000080">:= </font>PChar<font color="#000080">( </font>sFileName <font color="#000080">);
    </font>fFlags <font color="#000080">:= </font>FOF_ALLOWUNDO
              <font color="#FF0000"><b>or </b></font>FOF_NOCONFIRMATION
              <font color="#FF0000"><b>or </b></font>FOF_SILENT<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Result <font color="#000080">:= ( </font><font color="#800000">0 </font><font color="#000080">= </font>ShFileOperation<font color="#000080">( </font>fos <font color="#000080">) );
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>To </b></font>delete a <font color="#FF0000"><b>file</b></font><font color="#000080">, </font>simply pass the <font color="#FF0000"><b>file </b></font>name <font color="#FF0000"><b>to </b></font>DeleteFileWithUndo<font color="#000080">() </font><font color="#FF0000"><b>and
</b></font>it will return True <font color="#FF0000"><b>if </b></font>the operation was successful
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0254.PAS">Original</a><b>]</b></p></body>
</html>
