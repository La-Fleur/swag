<html>
<head><title> "Conversion of the ActiveScript header" by BRIAN DUPRAS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0402.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{unti AXScript v.1.0 05/28/97 - converted header file for Microsoft ActiveScript.

Original conversion of the ActiveScript header by David Zajac (dzajac@HiWAAY.net)
for Delphi 2.x.

Modified by Brian Dupras (bdupras@dimensional.com) for Delphi 3.0 using interfaces
instead of classes (which was necessary for D2).

This unit is released to the public.  No warrenty or guarentee of *anything*
is expressed or implied.  Use this code at your own risk - any damage is your
own fault for trusting me.  If you find any error in this code, fix it.  If
you're nice, let me know about the error so I can fix it, too.

This code has to date (May 28, 1997) only been tested for creating a host for
ActiveScript.  I have not tried creating a scripting engine with it (and probably
never will).  But I've been able to host both MS JScript and MS VBScript.

Good luck,
    Brian Dupras  5/28/97

----------------------------------------------------------------------------------

Ahh..updates.  I've updated this unit slilghtly, and created a helper unit called
(and aptly so) AXScriptHelp.  The only major additions were those to support
MS IE4.  The other updates to this unit were minor - a few slight type differences
and some parameter name changes.  Mostly cosmetic stuff.

Again, Good luck,

Brian 7/6/97


By the way, JScript, VBScript and ActiveScript are registered trademarks of
Microsoft Corporation.


----------------------------------------------------------------------------------
More updates still.  Thank you Gary Warren King for noticing that I'm an idiot.

The identifiers : SCRIPTTHREADID_CURRENT, SCRIPTTHREADID_BASE, and
SCRIPTTHREADID_ALL were originally thought to be C++ MACROS.  Upon second look,
however, they're not macros, they're #define constants that typcast the values
-1, -2, and -3 to the #typdef SCRIPTTHREADID.  Looking into another's activescript
conversion confirmed this, so the change has been made and duely noted.

We'll call this version 1.1 of the ActivScp.h conversion.  

Brian Dupras  8/26/97


p.s.  At the time of this writing, a slightly older demo using this header is
available at the Delphi Super Page.  The URL is
http://SunSITE.icm.edu.pl/delphi/, and the file is axscpd1.zip.  It can be
found under Delphi 3, Apps With Sources.  I plan to pust axscpd2.zip real soon
now, so get that one if it's there.
}


</i></font><font color="#FF0000"><b>unit </b></font>AXScript<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>ActiveX<font color="#000080">;


</font><font color="#FF0000"><b>const
  </b></font><font color="#008000"><i>//Category IDs
  </i></font>CATID_ActiveScript<font color="#000080">:</font>TGUID<font color="#000080">=              </font><font color="#800000">'{F0B7A1A1-9847-11cf-8F20-00805F2CD064}'</font><font color="#000080">;
  </font>CATID_ActiveScriptParse<font color="#000080">:</font>TGUID<font color="#000080">=         </font><font color="#800000">'{F0B7A1A2-9847-11cf-8F20-00805F2CD064}'</font><font color="#000080">;

  </font><font color="#008000"><i>//Interface IDs
  </i></font>IID_IActiveScriptSite<font color="#000080">:</font>TGUID<font color="#000080">=           </font><font color="#800000">'{DB01A1E3-A42B-11cf-8F20-00805F2CD064}'</font><font color="#000080">;
  </font>IID_IActiveScriptSiteWindow<font color="#000080">:</font>TGUID<font color="#000080">=     </font><font color="#800000">'{D10F6761-83E9-11cf-8F20-00805F2CD064}'</font><font color="#000080">;
  </font>IID_IActiveScript<font color="#000080">:</font>TGUID<font color="#000080">=               </font><font color="#800000">'{BB1A2AE1-A4F9-11cf-8F20-00805F2CD064}'</font><font color="#000080">;
  </font>IID_IActiveScriptParse<font color="#000080">:</font>TGUID<font color="#000080">=          </font><font color="#800000">'{BB1A2AE2-A4F9-11cf-8F20-00805F2CD064}'</font><font color="#000080">;
  </font>IID_IActiveScriptParseProcedure<font color="#000080">:</font>TGUID<font color="#000080">= </font><font color="#800000">'{1CFF0050-6FDD-11d0-9328-00A0C90DCAA9}'</font><font color="#000080">;
  </font>IID_IActiveScriptError<font color="#000080">:</font>TGUID<font color="#000080">=          </font><font color="#800000">'{EAE1BA61-A4ED-11cf-8F20-00805F2CD064}'</font><font color="#000080">;


   </font><font color="#008000"><i>// Constants used by ActiveX Scripting:
   </i></font>SCRIPTITEM_ISVISIBLE     <font color="#000080">= </font><font color="#800000">$00000002</font><font color="#000080">;
   </font>SCRIPTITEM_ISSOURCE      <font color="#000080">= </font><font color="#800000">$00000004</font><font color="#000080">;
   </font>SCRIPTITEM_GLOBALMEMBERS <font color="#000080">= </font><font color="#800000">$00000008</font><font color="#000080">;
   </font>SCRIPTITEM_ISPERSISTENT  <font color="#000080">= </font><font color="#800000">$00000040</font><font color="#000080">;
   </font>SCRIPTITEM_CODEONLY      <font color="#000080">= </font><font color="#800000">$00000200</font><font color="#000080">;
   </font>SCRIPTITEM_NOCODE        <font color="#000080">= </font><font color="#800000">$00000400</font><font color="#000080">;
   </font>SCRIPTITEM_ALL_FLAGS     <font color="#000080">= (</font>SCRIPTITEM_ISSOURCE <font color="#FF0000"><b>or
                               </b></font>SCRIPTITEM_ISVISIBLE <font color="#FF0000"><b>or
                               </b></font>SCRIPTITEM_ISPERSISTENT <font color="#FF0000"><b>or
                               </b></font>SCRIPTITEM_GLOBALMEMBERS <font color="#FF0000"><b>or
                               </b></font>SCRIPTITEM_NOCODE <font color="#FF0000"><b>or
                               </b></font>SCRIPTITEM_CODEONLY<font color="#000080">);

   </font><font color="#008000"><i>// IActiveScript::AddTypeLib() input flags

   </i></font>SCRIPTTYPELIB_ISCONTROL    <font color="#000080">= </font><font color="#800000">$00000010</font><font color="#000080">;
   </font>SCRIPTTYPELIB_ISPERSISTENT <font color="#000080">= </font><font color="#800000">$00000040</font><font color="#000080">;
   </font>SCRIPTTYPELIB_ALL_FLAGS    <font color="#000080">= (</font>SCRIPTTYPELIB_ISCONTROL <font color="#FF0000"><b>or
                                 </b></font>SCRIPTTYPELIB_ISPERSISTENT<font color="#000080">);

</font><font color="#008000"><i>// IActiveScriptParse::AddScriptlet() and IActiveScriptParse::ParseScriptText() input flags */

   </i></font>SCRIPTTEXT_DELAYEXECUTION    <font color="#000080">= </font><font color="#800000">$00000001</font><font color="#000080">;
   </font>SCRIPTTEXT_ISVISIBLE         <font color="#000080">= </font><font color="#800000">$00000002</font><font color="#000080">;
   </font>SCRIPTTEXT_ISEXPRESSION      <font color="#000080">= </font><font color="#800000">$00000020</font><font color="#000080">;
   </font>SCRIPTTEXT_ISPERSISTENT      <font color="#000080">= </font><font color="#800000">$00000040</font><font color="#000080">;
   </font>SCRIPTTEXT_HOSTMANAGESSOURCE <font color="#000080">= </font><font color="#800000">$00000080</font><font color="#000080">;
   </font>SCRIPTTEXT_ALL_FLAGS         <font color="#000080">= (</font>SCRIPTTEXT_DELAYEXECUTION <font color="#FF0000"><b>or
                                   </b></font>SCRIPTTEXT_ISVISIBLE <font color="#FF0000"><b>or
                                   </b></font>SCRIPTTEXT_ISEXPRESSION <font color="#FF0000"><b>or
                                   </b></font>SCRIPTTEXT_HOSTMANAGESSOURCE <font color="#FF0000"><b>or
                                   </b></font>SCRIPTTEXT_ISPERSISTENT<font color="#000080">);


</font><font color="#008000"><i>// IActiveScriptParseProcedure::ParseProcedureText() input flags

  </i></font>SCRIPTPROC_HOSTMANAGESSOURCE  <font color="#000080">= </font><font color="#800000">$00000080</font><font color="#000080">;
  </font>SCRIPTPROC_IMPLICIT_THIS      <font color="#000080">= </font><font color="#800000">$00000100</font><font color="#000080">;
  </font>SCRIPTPROC_IMPLICIT_PARENTS   <font color="#000080">= </font><font color="#800000">$00000200</font><font color="#000080">;
  </font>SCRIPTPROC_ALL_FLAGS          <font color="#000080">= (</font>SCRIPTPROC_HOSTMANAGESSOURCE <font color="#FF0000"><b>or
                                   </b></font>SCRIPTPROC_IMPLICIT_THIS <font color="#FF0000"><b>or
                                   </b></font>SCRIPTPROC_IMPLICIT_PARENTS<font color="#000080">);


</font><font color="#008000"><i>// IActiveScriptSite::GetItemInfo() input flags */

   </i></font>SCRIPTINFO_IUNKNOWN  <font color="#000080">= </font><font color="#800000">$00000001</font><font color="#000080">;
   </font>SCRIPTINFO_ITYPEINFO <font color="#000080">= </font><font color="#800000">$00000002</font><font color="#000080">;
   </font>SCRIPTINFO_ALL_FLAGS <font color="#000080">= (</font>SCRIPTINFO_IUNKNOWN <font color="#FF0000"><b>or
                           </b></font>SCRIPTINFO_ITYPEINFO<font color="#000080">);


</font><font color="#008000"><i>// IActiveScript::Interrupt() Flags */

   </i></font>SCRIPTINTERRUPT_DEBUG          <font color="#000080">= </font><font color="#800000">$00000001</font><font color="#000080">;
   </font>SCRIPTINTERRUPT_RAISEEXCEPTION <font color="#000080">= </font><font color="#800000">$00000002</font><font color="#000080">;
   </font>SCRIPTINTERRUPT_ALL_FLAGS      <font color="#000080">= (</font>SCRIPTINTERRUPT_DEBUG <font color="#FF0000"><b>or
                                     </b></font>SCRIPTINTERRUPT_RAISEEXCEPTION<font color="#000080">);



</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>//new IE4 types
  </i></font>TUserHWND<font color="#000080">=</font>HWND<font color="#000080">;
  </font>TUserBSTR<font color="#000080">=</font>TBStr<font color="#000080">;
  </font>TUserExcepInfo<font color="#000080">=</font>TExcepInfo<font color="#000080">;
  </font>TUserVariant<font color="#000080">=</font>OleVariant<font color="#000080">;

  </font><font color="#008000"><i>// script state values
  </i></font>TScriptState <font color="#000080">= (
    </font>SCRIPTSTATE_UNINITIALIZED<font color="#000080">,
    </font>SCRIPTSTATE_STARTED<font color="#000080">,
    </font>SCRIPTSTATE_CONNECTED<font color="#000080">,
    </font>SCRIPTSTATE_DISCONNECTED<font color="#000080">,
    </font>SCRIPTSTATE_CLOSED<font color="#000080">,
    </font>SCRIPTSTATE_INITIALIZED
    <font color="#000080">);

  </font><font color="#008000"><i>// script thread state values */
  </i></font>TScriptThreadState <font color="#000080">= (
    </font>SCRIPTTHREADSTATE_NOTINSCRIPT<font color="#000080">,
    </font>SCRIPTTHREADSTATE_RUNNING
    <font color="#000080">);


  </font><font color="#008000"><i>// Thread IDs */
  </i></font>TScriptThreadID <font color="#000080">= </font>DWORD<font color="#000080">;

</font><font color="#FF0000"><b>const  </b></font><font color="#008000"><i>//Note: these SCRIPTTHREADID constants were originally macros
       //in the first version of this file.  See the note at the top
       //for more information. (Thanks to Gary Warren King.)
  </i></font>SCRIPTTHREADID_CURRENT        <font color="#000080">= </font>TScriptThreadId<font color="#000080">(-</font><font color="#800000">1</font><font color="#000080">);
  </font>SCRIPTTHREADID_BASE           <font color="#000080">= </font>TScriptThreadId<font color="#000080">(-</font><font color="#800000">2</font><font color="#000080">);
  </font>SCRIPTTHREADID_ALL            <font color="#000080">= </font>TScriptThreadId<font color="#000080">(-</font><font color="#800000">3</font><font color="#000080">);

</font><font color="#FF0000"><b>type
  </b></font><font color="#008000"><i>//Forward declarations
  </i></font>IActiveScript <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;
  </font>IActiveScriptParse <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;
  </font>IActiveScriptParseProcedure <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;
  </font>IActiveScriptSite <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;
  </font>IActiveScriptSiteWindow <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;
  </font>IActiveScriptError <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">;


  </font>IActiveScriptError <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
    [</font><font color="#800000">'{EAE1BA61-A4ED-11CF-8F20-00805F2CD064}'</font><font color="#000080">]

    </font><font color="#008000"><i>// HRESULT GetExceptionInfo(
    //     [out] EXCEPINFO *pexcepinfo);
    </i></font><font color="#FF0000"><b>function </b></font>GetExceptionInfo<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>ExcepInfo<font color="#000080">: </font>TExcepInfo<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetSourcePosition(
    //     [out] DWORD *pdwSourceCOntext,
    //     [out] ULONG *pulLineNumber,
    //     [out] LONG *plCharacterPosition);
    </i></font><font color="#FF0000"><b>function </b></font>GetSourcePosition<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>SourceContext<font color="#000080">: </font>DWORD<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>LineNumber<font color="#000080">: </font>ULONG<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>CharacterPosition<font color="#000080">: </font>LONGINT<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetSourceLineText(
    //     [out] BSTR *pbstrSourceLine);
    </i></font><font color="#FF0000"><b>function </b></font>GetSourceLineText<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>SourceLine<font color="#000080">: </font>LPWSTR<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>//IActiveScriptError interface


  </i></font>IActiveScriptSite <font color="#000080">= </font><font color="#FF0000"><b>Interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
    [</font><font color="#800000">'{DB01A1E3-A42B-11CF-8F20-00805F2CD064}'</font><font color="#000080">]
    </font><font color="#008000"><i>// HRESULT GetLCID(
    //     [out] LCID *plcid);
    // Allows the host application to indicate the local ID for localization
    // of script/user interaction
    </i></font><font color="#FF0000"><b>function </b></font>GetLCID<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>Lcid<font color="#000080">: </font>TLCID<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetItemInfo(
    //     [in] LPCOLESTR pstrName,
    //     [in] DWORD dwReturnMask,
    //     [out] IUnknown **ppiunkItem,
    //     [out] ITypeInfo **ppti);
    // Called by the script engine to look up named items in host application.
    // Used to map unresolved variable names in scripts to automation interface
    // in host application.  The dwReturnMask parameter will indicate whether
    // the actual object (SCRIPTINFO_INKNOWN) or just a coclass type description
    // (SCRIPTINFO_ITYPEINFO)  is desired.
    </i></font><font color="#FF0000"><b>function </b></font>GetItemInfo<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pstrName<font color="#000080">: </font>POleStr<font color="#000080">; </font>dwReturnMask<font color="#000080">: </font>DWORD<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>ppiunkItem<font color="#000080">: </font>IUnknown<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>Info<font color="#000080">: </font>ITypeInfo<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetDocVersionString(
    //     [out] BSTR *pbstrVersion);
    // Called by the script engine to get a text-based version number of the
    // current document.  This string can be used to validate that any cached
    // state that the script engine may have saved is consistent with the
    // current document.
    </i></font><font color="#FF0000"><b>function </b></font>GetDocVersionString<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>Version<font color="#000080">: </font>TBSTR<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT OnScriptTerminate(
    //     [in] const VARIANT *pvarResult,
    //     [in] const EXCEPINFO *pexcepinfo);
    // Called by the script engine when the script terminates.  In most cases
    // this method is not called, as it is possible that the parsed script may
    // be used to dispatch events from the host application
    </i></font><font color="#FF0000"><b>function </b></font>OnScriptTerminate<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pvarResult<font color="#000080">: </font>OleVariant<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>pexcepinfo<font color="#000080">: </font>TExcepInfo<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT OnStateChange(
    //     [in] SCRIPTSTATE ssScriptState);
    // Called by the script engine when state changes either explicitly via
    // SetScriptState or implicitly via other script engine events.
    </i></font><font color="#FF0000"><b>function </b></font>OnStateChange<font color="#000080">(</font>ScriptState<font color="#000080">: </font>TScriptState<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT OnScriptError(
    //     [in] IActiveScriptError *pscripterror);
    // Called when script execution or parsing encounters an error.  The script
    // engine will provide an implementation of IActiveScriptError that
    // describes the runtime error in terms of an EXCEPINFO in addition to
    // indicating the location of the error in the original script text.
    </i></font><font color="#FF0000"><b>function </b></font>OnScriptError<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pscripterror<font color="#000080">: </font>IActiveScriptError<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT OnEnterScript(void);
    // Called by the script engine to indicate the beginning of a unit of work.
    </i></font><font color="#FF0000"><b>function </b></font>OnEnterScript<font color="#000080">: </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT OnLeaveScript(void);
    // Called by the script engine to indicate the completion of a unit of work.
    </i></font><font color="#FF0000"><b>function </b></font>OnLeaveScript<font color="#000080">: </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>//IActiveScriptSite interface


  </i></font>IActiveScriptSiteWindow <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
   [</font><font color="#800000">'{D10F6761-83E9-11CF-8F20-00805F2CD064}'</font><font color="#000080">]
    </font><font color="#008000"><i>// HRESULT GetWindow(
    //     [out] HWND *phwnd);
    </i></font><font color="#FF0000"><b>function </b></font>GetWindow<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>Handle<font color="#000080">: </font>HWND<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT EnableModeless(
    //     [in] BOOL fEnable);
    </i></font><font color="#FF0000"><b>function </b></font>EnableModeless<font color="#000080">(</font>fEnable<font color="#000080">: </font>BOOL<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>//IActiveScriptSiteWindow interface

  </i></font>IActiveScript <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
    [</font><font color="#800000">'{BB1A2AE1-A4F9-11CF-8F20-00805F2CD064}'</font><font color="#000080">]
    </font><font color="#008000"><i>// HRESULT SetScriptSite(
    //     [in] IActiveScriptSite *pass);
    // Conects the host's application site object to the engine
    </i></font><font color="#FF0000"><b>function </b></font>SetScriptSite<font color="#000080">(</font>ActiveScriptSite<font color="#000080">: </font>IActiveScriptSite<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetScriptSite(
    //     [in] REFIID riid,
    //     [iid_is][out] void **ppvObject);
    // Queries the engine for the connected site
    </i></font><font color="#FF0000"><b>function </b></font>GetScriptSite<font color="#000080">(</font>riid<font color="#000080">: </font>TGUID<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>OleObject<font color="#000080">: </font>Pointer<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT SetScriptState(
    //     [in] SCRIPTSTATE ss);
    // Causes the engine to enter the designate state
    </i></font><font color="#FF0000"><b>function </b></font>SetScriptState<font color="#000080">(</font>State<font color="#000080">: </font>TScriptState<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetScriptState(
    //     [out] SCRIPTSTATE *pssState);
    // Queries the engine for its current state
    </i></font><font color="#FF0000"><b>function </b></font>GetScriptState<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>State<font color="#000080">: </font>TScriptState<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT Close(void);
    // Forces the engine to enter the closed state, resetting any parsed scripts
    // and disconnecting/releasing all of the host's objects.
    </i></font><font color="#FF0000"><b>function </b></font>Close<font color="#000080">: </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT AddNamedItem(
    //     [in] LPCOLESTR pstrName,
    //     [in] DWORD dwFlags);
    // Adds a variable name to the namespace of the script engine. The engine
    // will call the site's GetItemInfo to resolve the name to an object.
    </i></font><font color="#FF0000"><b>function </b></font>AddNamedItem<font color="#000080">(</font>Name<font color="#000080">: </font>POleStr<font color="#000080">; </font>Flags<font color="#000080">: </font>DWORD<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT AddTypeLib(
    //     [in] REFGUID rguidTypeLib,
    //     [in] DWORD dwMajor,
    //     [in] DWORD dwMinor,
    //     [in] DWORD dwFlags);
    // Adds the type and constant defintions contained in the designated type
    // library to the namespace of the scripting engine.
    </i></font><font color="#FF0000"><b>function </b></font>AddTypeLib<font color="#000080">(</font>TypeLib<font color="#000080">: </font>TGUID<font color="#000080">; </font>Major<font color="#000080">: </font>DWORD<font color="#000080">; </font>Minor<font color="#000080">: </font>DWORD<font color="#000080">; </font>Flags<font color="#000080">: </font>DWORD<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetScriptDispatch(
    //     [in] LPCOLESTR pstrItemName,
    //     [out] IDispatch **ppdisp);
    // Gets the IDispatch pointer to the scripting engine.
    </i></font><font color="#FF0000"><b>function </b></font>GetScriptDispatch<font color="#000080">(</font>ItemName<font color="#000080">: </font>POleStr<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>Disp<font color="#000080">: </font>IDispatch<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetCurrentScriptThreadID(
    //     [out] SCRIPTTHREADID *pstidThread);
    // Gets the script's logical thread ID that corresponds to the current
    // physical thread.  This allows script engines to execute script code on
    // arbitrary threads that may be distinct from the site's thread.
    </i></font><font color="#FF0000"><b>function </b></font>GetCurrentScriptThreadID<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>Thread<font color="#000080">: </font>TScriptThreadID<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetScriptThreadID(
    //     [in] DWORD dwWin32ThreadID,
    //     [out] SCRIPTTHREADID *pstidThread);
    // Gets the logical thread ID that corresponds to the specified physical
    // thread.  This allows script engines to execute script code on arbitrary
    // threads that may be distinct from the sites thread.
    </i></font><font color="#FF0000"><b>function </b></font>GetScriptThreadID<font color="#000080">(</font>Win32ThreadID<font color="#000080">: </font>DWORD<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>Thread<font color="#000080">: </font>TScriptThreadID<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT GetScriptThreadState(
    //     [in] SCRIPTTHREADID stidThread,
    //     [out] SCRIPTTHREADSTATE *pstsState);
    // Gets the logical thread ID running state, which is either
    // SCRIPTTHREADSTATE_NOTINSCRIPT or SCRIPTTHEADSTATE_RUNNING.
    </i></font><font color="#FF0000"><b>function </b></font>GetScriptThreadState<font color="#000080">(</font>Thread<font color="#000080">: </font>TScriptThreadID<font color="#000080">; </font><font color="#FF0000"><b>out </b></font>State<font color="#000080">: </font>TScriptThreadState<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT InterruptScriptThread(
    //     [in] SCRIPTTHREADID stidThread,
    //     [in] const EXCEPINFO *pexcepInfo,
    //     [in] DWORD dwFlags);
    // Similar to Terminatethread, this method stope the execution of a script thread.
    </i></font><font color="#FF0000"><b>function </b></font>InterruptScriptThread<font color="#000080">(</font>Thread<font color="#000080">: </font>TScriptThreadID<font color="#000080">; </font><font color="#FF0000"><b>const </b></font>ExcepInfo<font color="#000080">: </font>TExcepInfo<font color="#000080">; </font>Flags<font color="#000080">: </font>DWORD<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT Clone(
    //     [out] IActiveScript **ppscript);
    // Duplicates the current script engine, replicating any parsed script text
    // and named items, but no the actual pointers to the site's objects.
    </i></font><font color="#FF0000"><b>function </b></font>Clone<font color="#000080">(</font><font color="#FF0000"><b>out </b></font>ActiveScript<font color="#000080">: </font>IActiveScript<font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>//IActiveScript interface

  </i></font>IActiveScriptParse <font color="#000080">= </font><font color="#FF0000"><b>interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
    [</font><font color="#800000">'{BB1A2AE2-A4F9-11CF-8F20-00805F2CD064}'</font><font color="#000080">]

    </font><font color="#008000"><i>// HRESULT InitNew(void);
    </i></font><font color="#FF0000"><b>function </b></font>InitNew<font color="#000080">: </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT AddScriptlet(
    //     [in] LPCOLESTR pstrDefaultName,
    //     [in] LPCOLESTR pstrCode,
    //     [in] LPCOLESTR pstrItemName,
    //     [in] LPCOLESTR pstrSubItemName,
    //     [in] LPCOLESTR pstrEventName,
    //     [in] LPCOLESTR pstrDelimiter,
    //     [in] DWORD dwSourceContextCookie,
    //     [in] ULONG ulStartingLineNumber,
    //     [in] DWORD dwFlags,
    //     [out] BSTR *pbstrName,
    //     [out] EXCEPINFO *pexcepinfo);
    </i></font><font color="#FF0000"><b>function </b></font>AddScriptlet<font color="#000080">(
          </font>DefaultName<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>Code<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>ItemName<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>SubItemName<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>EventName<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>Delimiter<font color="#000080">: </font>POleStr<font color="#000080">;
          </font>SourceContextCookie<font color="#000080">: </font>DWORD<font color="#000080">;
          </font>StartingLineNnumber<font color="#000080">: </font>ULONG<font color="#000080">;
          </font>Flags<font color="#000080">: </font>DWORD<font color="#000080">;
      </font><font color="#FF0000"><b>out </b></font>Name<font color="#000080">: </font>TBSTR<font color="#000080">;
      </font><font color="#FF0000"><b>out </b></font>ExcepInfo<font color="#000080">: </font>TExcepInfo
    <font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

    </font><font color="#008000"><i>// HRESULT STDMETHODCALLTYPE ParseScriptText(
    //     [in] LPCOLESTR pstrCode,
    //     [in] LPCOLESTR pstrItemName,
    //     [in] IUnknown  *punkContext,
    //     [in] LPCOLESTR pstrDelimiter,
    //     [in] DWORD dwSourceContextCookie,
    //     [in] ULONG ulStartingLineNumber,
    //     [in] DWORD dwFlags,
    //     [out] VARIANT *pvarResult,
    //     [out] EXCEPINFO *pexcepinfo);
    </i></font><font color="#FF0000"><b>function </b></font>ParseScriptText<font color="#000080">(
      </font><font color="#FF0000"><b>const </b></font>pstrCode<font color="#000080">: </font>POLESTR<font color="#000080">;
      </font><font color="#FF0000"><b>const </b></font>pstrItemName<font color="#000080">: </font>POLESTR<font color="#000080">;
      </font><font color="#FF0000"><b>const </b></font>punkContext<font color="#000080">: </font>IUnknown<font color="#000080">;
      </font><font color="#FF0000"><b>const </b></font>pstrDelimiter<font color="#000080">: </font>POLESTR<font color="#000080">;
            </font>dwSourceContextCookie<font color="#000080">: </font>DWORD<font color="#000080">;
            </font>ulStartingLineNumber<font color="#000080">: </font>ULONG<font color="#000080">;
            </font>dwFlags<font color="#000080">: </font>DWORD<font color="#000080">;
      </font><font color="#FF0000"><b>out   </b></font>pvarResult<font color="#000080">: </font>OleVariant<font color="#000080">;
      </font><font color="#FF0000"><b>out   </b></font>pExcepInfo<font color="#000080">: </font>TExcepInfo
    <font color="#000080">): </font>HRESULT<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>//IActivScriptParse interface


</i></font>IActiveScriptParseProcedure<font color="#000080">=</font><font color="#FF0000"><b>interface</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
  [</font><font color="#800000">'{1CFF0050-6FDD-11d0-9328-00A0C90DCAA9}'</font><font color="#000080">]

  </font><font color="#FF0000"><b>function </b></font>ParseProcedureText<font color="#000080">(
     </font><font color="#FF0000"><b>const </b></font>pstrCode<font color="#000080">: </font>POLESTR<font color="#000080">;
     </font><font color="#FF0000"><b>const </b></font>pstrFormalParams<font color="#000080">: </font>POLESTR<font color="#000080">;
     </font><font color="#FF0000"><b>const </b></font>pstrItemName<font color="#000080">: </font>POLESTR<font color="#000080">;
           </font>punkContext<font color="#000080">: </font>IUnknown<font color="#000080">;
     </font><font color="#FF0000"><b>const </b></font>pstrDelimiter<font color="#000080">: </font>POLESTR<font color="#000080">;
           </font>dwSourceContextCookie<font color="#000080">: </font>DWord<font color="#000080">;
           </font>ulStartingLineNumber<font color="#000080">: </font>ULong<font color="#000080">;
           </font>dwFlags<font color="#000080">: </font>DWord<font color="#000080">;
     </font><font color="#FF0000"><b>out   </b></font>ppdisp<font color="#000080">: </font>IDispatch
  <font color="#000080">): </font>HResult<font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;  </font><font color="#008000"><i>//IActivScriptParseProcedure interface


</i></font><font color="#FF0000"><b>implementation


end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0402.PAS">Original</a><b>]</b></p></body>
</html>
