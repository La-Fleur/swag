<html>
<head><title> "Re: EmptyTable Generic procedure" by HUTTEMAN <HUTTEMAN@PERIGEE.NET></title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0322.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">what you need <font color="#FF0000"><b>to do is </b></font>create a new TTable <font color="#FF0000"><b>object </b></font>inside <font color="#FF0000"><b>of </b></font>your <font color="#FF0000"><b>procedure</b></font><font color="#000080">.
</font>The following code will <font color="#FF0000"><b>do </b></font>what you need<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>EmptyTable<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>DbName<font color="#000080">, </font>TbName<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'Empty ' </font><font color="#000080">+ </font>TbName <font color="#000080">+ </font><font color="#800000">' Table? Are you sure?'</font><font color="#000080">, </font>mtConfirmation<font color="#000080">,
                [</font>mbYes<font color="#000080">, </font>mbNo<font color="#000080">], </font><font color="#800000">0</font><font color="#000080">) = </font>mrYes <font color="#FF0000"><b>then begin
    with </b></font>TTable<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>do try
      </b></font>DatabaseName <font color="#000080">:= </font>DbName<font color="#000080">;
      </font>TableName <font color="#000080">:= </font>TbName<font color="#000080">;
      </font><font color="#FF0000"><b>repeat
        try
          </b></font>EmptyTable<font color="#000080">;
          </font>ShowMessage<font color="#000080">(</font>TbName <font color="#000080">+ </font><font color="#800000">' Table Empty!'</font><font color="#000080">);
          </font>exit<font color="#000080">;
        </font><font color="#FF0000"><b>except
          on </b></font>EDatabaseError <font color="#FF0000"><b>do begin
            </b></font><font color="#008000"><i>{ Ask if it is OK to retry }
            </i></font><font color="#FF0000"><b>if </b></font>MessageDlg<font color="#000080">(</font><font color="#800000">'EmptyTable failed'</font><font color="#000080">,</font>mtError<font color="#000080">, [</font>mbAbort<font color="#000080">, </font>mbRetry<font color="#000080">], </font><font color="#800000">0</font><font color="#000080">)
                          &lt;&gt; </font>mrRetry <font color="#FF0000"><b>then begin
              raise</b></font><font color="#000080">; </font><font color="#008000"><i>{ If not, reraise to abort }
            </i></font><font color="#FF0000"><b>end
            </b></font><font color="#008000"><i>{ Otherwise resume the repeat loop }
          </i></font><font color="#FF0000"><b>end
        end</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>until </b></font>false<font color="#000080">;
    </font><font color="#FF0000"><b>finally
      </b></font>Free
    <font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0322.PAS">Original</a><b>]</b></p></body>
</html>
