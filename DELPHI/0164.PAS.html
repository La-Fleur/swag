<html>
<head><title> "Dates for Delphi" by DENNIS PASSMORE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>JDates<font color="#000080">;

</font><font color="#008000"><i>{ A unit providing Julian day numbers and date manipulations.

  NOTE:
   The range of Dates this unit will handle is 1/1/1900 to 1/1/2078

  Version 1.00 - 10/26/1987 - First general release

  Scott Bussinger
  Professional Practice Systems
  110 South 131st Street
  Tacoma, WA  98444
  (206)531-8944
  Compuserve 72247,2671

  Version 1.01 - 10/09/1995 - Updated for use with Delphi v1.0
                   Lets see some other code last this long without change

  Dennis Passmore
  1929 Mango Tree Drive
  Edgewater Fl, 32141

  Compuserve 71240,2464 }

</i></font><font color="#FF0000"><b>interface
uses
  </b></font>Sysutils<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>BlankDate <font color="#000080">= </font><font color="#800000">$FFFF</font><font color="#000080">;                         </font><font color="#008000"><i>{ Constant for Not-a-real-Date }

</i></font><font color="#FF0000"><b>type </b></font>TDate <font color="#000080">= </font>Word<font color="#000080">;
     </font>TDay <font color="#000080">= (</font>Sunday<font color="#000080">,</font>Monday<font color="#000080">,</font>Tuesday<font color="#000080">,</font>Wednesday<font color="#000080">,</font>Thursday<font color="#000080">,</font>Friday<font color="#000080">,</font>Saturday<font color="#000080">);
     </font>TDaySet <font color="#000080">= </font><font color="#FF0000"><b>set of </b></font>TDay<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetDate<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Wday<font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#008000"><i>{ replacement for old WINDOS proc }

</i></font><font color="#FF0000"><b>procedure </b></font>GetTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>MSec<font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#008000"><i>{ replacement for old WINDOS proc }

</i></font><font color="#FF0000"><b>function  </b></font>CurrentJDate<font color="#000080">: </font>Tdate<font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>ValidDate<font color="#000080">(</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">): </font>boolean<font color="#000080">;
  </font><font color="#008000"><i>{ Check if the day,month,year is a real date storable in a Date variable }


</i></font><font color="#FF0000"><b>procedure </b></font>DMYtoDate<font color="#000080">(</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Julian<font color="#000080">: </font>TDate<font color="#000080">);
  </font><font color="#008000"><i>{ Convert from day,month,year to a date }

</i></font><font color="#FF0000"><b>procedure </b></font>DateToDMY<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#008000"><i>{ Convert from a date to day,month,year }

</i></font><font color="#FF0000"><b>function </b></font>BumpDate<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">;</font>Days<font color="#000080">,</font>Months<font color="#000080">,</font>Years<font color="#000080">: </font>Integer<font color="#000080">): </font>TDate<font color="#000080">;
  </font><font color="#008000"><i>{ Add (or subtract) the number of days, months, and years to a date }

</i></font><font color="#FF0000"><b>function </b></font>DayOfWeek<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">): </font>TDay<font color="#000080">;
  </font><font color="#008000"><i>{ Return the day of the week for the date }

</i></font><font color="#FF0000"><b>function </b></font>DayString<font color="#000080">(</font>WeekDay<font color="#000080">: </font>TDay<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Return a string version of a day of the week }

</i></font><font color="#FF0000"><b>function </b></font>MonthString<font color="#000080">(</font>Month<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Return a string version of a month }

</i></font><font color="#FF0000"><b>function </b></font>DateToStr<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Convert a date to a sortable string }

</i></font><font color="#FF0000"><b>function </b></font>StrToDate<font color="#000080">(</font>StrVar<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>TDate<font color="#000080">;
  </font><font color="#008000"><i>{ Convert a sortable string form to a date }

</i></font><font color="#FF0000"><b>implementation

procedure </b></font>GetDate<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">,</font>Wday<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>td<font color="#000080">: </font>TDatetime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>td <font color="#000080">:= </font>Date<font color="#000080">;

  </font>DeCodeDate<font color="#000080">(</font>td<font color="#000080">,</font>Year<font color="#000080">,</font>Month<font color="#000080">,</font>Day<font color="#000080">);
  </font>Wday <font color="#000080">:= </font>sysutils<font color="#000080">.</font>DayofWeek<font color="#000080">(</font>td<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>GetTime<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>MSec<font color="#000080">: </font>Word<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>td<font color="#000080">: </font>TDatetime<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>td <font color="#000080">:= </font>Now<font color="#000080">;
  </font>DecodeTime<font color="#000080">(</font>td<font color="#000080">,</font>Hour<font color="#000080">,</font>Min<font color="#000080">,</font>Sec<font color="#000080">,</font>MSec<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>CurrentJdate<font color="#000080">: </font>Tdate<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>w<font color="#000080">: </font>word<font color="#000080">;
 </font>jd<font color="#000080">: </font>TDate<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetDate<font color="#000080">(</font>y<font color="#000080">,</font>m<font color="#000080">,</font>d<font color="#000080">,</font>w<font color="#000080">);
  </font>DMYtoDate<font color="#000080">(</font>d<font color="#000080">,</font>m<font color="#000080">,</font>y<font color="#000080">,</font>jd<font color="#000080">);
  </font>CurrentJDate<font color="#000080">:= </font>jd<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ValidDate<font color="#000080">(</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">): </font>boolean<font color="#000080">;
  </font><font color="#008000"><i>{ Check if the day,month,year is a real date storable in a Date variable }
</i></font><font color="#FF0000"><b>begin
  if </b></font><font color="#008000"><i>{(Day&lt;1) or }</i></font><font color="#000080">(</font>Year<font color="#000080">&lt;</font><font color="#800000">1900</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Year<font color="#000080">&gt;</font><font color="#800000">2078</font><font color="#000080">) </font><font color="#FF0000"><b>then
    </b></font>ValidDate <font color="#000080">:= </font>false
  <font color="#FF0000"><b>else
    case </b></font>Month <font color="#FF0000"><b>of
      </b></font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">7</font><font color="#000080">,</font><font color="#800000">8</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">: </font>ValidDate <font color="#000080">:= </font>Day <font color="#000080">&lt;= </font><font color="#800000">31</font><font color="#000080">;

      </font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">6</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">: </font>ValidDate <font color="#000080">:= </font>Day <font color="#000080">&lt;= </font><font color="#800000">30</font><font color="#000080">;
      </font><font color="#800000">2</font><font color="#000080">: </font>ValidDate <font color="#000080">:= </font>Day <font color="#000080">&lt;= </font><font color="#800000">28 </font><font color="#000080">+ </font>ord<font color="#000080">((</font>Year <font color="#FF0000"><b>mod </b></font><font color="#800000">4</font><font color="#000080">)=</font><font color="#800000">0</font><font color="#000080">)*</font>ord<font color="#000080">(</font>Year<font color="#000080">&lt;&gt;</font><font color="#800000">1900</font><font color="#000080">)
      </font><font color="#FF0000"><b>else </b></font>ValidDate <font color="#000080">:= </font>false
    <font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DMYtoDate<font color="#000080">(</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Julian<font color="#000080">: </font>TDate<font color="#000080">);
  </font><font color="#008000"><i>{ Convert from day,month,year to a date }
  { Stored as number of days since January 1, 1900 }
  { Note that no error checking takes place in this routine -- use ValidDate }
</i></font><font color="#FF0000"><b>begin
if </b></font><font color="#000080">(</font>Year<font color="#000080">=</font><font color="#800000">1900</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Month<font color="#000080">&lt;</font><font color="#800000">3</font><font color="#000080">) </font><font color="#FF0000"><b>then
  if </b></font>Month <font color="#000080">= </font><font color="#800000">1 </font><font color="#FF0000"><b>then
    </b></font>Julian <font color="#000080">:= </font>pred<font color="#000080">(</font>Day<font color="#000080">)
  </font><font color="#FF0000"><b>else
    </b></font>Julian <font color="#000080">:= </font>Day <font color="#000080">+ </font><font color="#800000">30
</font><font color="#FF0000"><b>else
  begin
    if </b></font>Month <font color="#000080">&gt; </font><font color="#800000">2 </font><font color="#FF0000"><b>then
      </b></font>dec<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      begin
        </b></font>inc<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);
        </font>dec<font color="#000080">(</font>Year<font color="#000080">)

      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>dec<font color="#000080">(</font>Year<font color="#000080">,</font><font color="#800000">1900</font><font color="#000080">);
    </font>Julian <font color="#000080">:= (</font><font color="#800000">1461</font><font color="#000080">*</font>longint<font color="#000080">(</font>Year<font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">4</font><font color="#000080">) + ((</font><font color="#800000">153</font><font color="#000080">*</font>Month<font color="#000080">+</font><font color="#800000">2</font><font color="#000080">) </font><font color="#FF0000"><b>div </b></font><font color="#800000">5</font><font color="#000080">) + </font>Day <font color="#000080">+ </font><font color="#800000">58</font><font color="#000080">;
  </font><font color="#FF0000"><b>end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DateToDMY<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">;</font><font color="#FF0000"><b>var </b></font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">: </font>Word<font color="#000080">);
  </font><font color="#008000"><i>{ Convert from a date to day,month,year }
</i></font><font color="#FF0000"><b>var
  </b></font>LongTemp<font color="#000080">: </font>longint<font color="#000080">;
      </font>Temp<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>Julian <font color="#000080">&lt;= </font><font color="#800000">58 </font><font color="#FF0000"><b>then
    begin
      </b></font>Year <font color="#000080">:= </font><font color="#800000">1900</font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Julian <font color="#000080">&lt;= </font><font color="#800000">30 </font><font color="#FF0000"><b>then
        begin
          </b></font>Month <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
          </font>Day <font color="#000080">:= </font>succ<font color="#000080">(</font>Julian<font color="#000080">)
        </font><font color="#FF0000"><b>end
      else
        begin
          </b></font>Month <font color="#000080">:= </font><font color="#800000">2</font><font color="#000080">;
          </font>Day <font color="#000080">:= </font>Julian <font color="#000080">- </font><font color="#800000">30
        </font><font color="#FF0000"><b>end
    end
  else
    begin
      </b></font>LongTemp <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">*</font>longint<font color="#000080">(</font>Julian<font color="#000080">) - </font><font color="#800000">233</font><font color="#000080">;

      </font>Year <font color="#000080">:= </font>LongTemp <font color="#FF0000"><b>div </b></font><font color="#800000">1461</font><font color="#000080">;
      </font>Temp <font color="#000080">:= </font>LongTemp <font color="#FF0000"><b>mod </b></font><font color="#800000">1461 </font><font color="#FF0000"><b>div </b></font><font color="#800000">4 </font><font color="#000080">* </font><font color="#800000">5 </font><font color="#000080">+ </font><font color="#800000">2</font><font color="#000080">;
      </font>Month <font color="#000080">:= </font>Temp <font color="#FF0000"><b>div </b></font><font color="#800000">153</font><font color="#000080">;
      </font>Day <font color="#000080">:= </font>Temp <font color="#FF0000"><b>mod </b></font><font color="#800000">153 </font><font color="#FF0000"><b>div </b></font><font color="#800000">5 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
      </font>inc<font color="#000080">(</font>Year<font color="#000080">,</font><font color="#800000">1900</font><font color="#000080">);
      </font><font color="#FF0000"><b>if </b></font>Month <font color="#000080">&lt; </font><font color="#800000">10 </font><font color="#FF0000"><b>then
        </b></font>inc<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">3</font><font color="#000080">)
      </font><font color="#FF0000"><b>else
        begin
          </b></font>dec<font color="#000080">(</font>Month<font color="#000080">,</font><font color="#800000">9</font><font color="#000080">);
          </font>inc<font color="#000080">(</font>Year<font color="#000080">)
        </font><font color="#FF0000"><b>end
    end
end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>BumpDate<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">;</font>Days<font color="#000080">,</font>Months<font color="#000080">,</font>Years<font color="#000080">: </font>Integer<font color="#000080">): </font>TDate<font color="#000080">;
  </font><font color="#008000"><i>{ Add (or subtract) the number of days, months, and years to a date }
  { Note that months and years are added first before days }
  { Note further that there are no overflow/underflow checks }
</i></font><font color="#FF0000"><b>var </b></font>Day<font color="#000080">: </font>Word<font color="#000080">;
    </font>Month<font color="#000080">: </font>Word<font color="#000080">;
    </font>Year<font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>DateToDMY<font color="#000080">(</font>Julian<font color="#000080">,</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">);

  </font>Month <font color="#000080">:= </font>Month <font color="#000080">+ </font>Months <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
  </font>Year <font color="#000080">:= </font>Year <font color="#000080">+ </font>Years <font color="#000080">+ (</font>Month <font color="#FF0000"><b>div </b></font><font color="#800000">12</font><font color="#000080">) - </font>ord<font color="#000080">(</font>Month<font color="#000080">&lt;</font><font color="#800000">0</font><font color="#000080">);
  </font>Month <font color="#000080">:= (</font>Month <font color="#000080">+ </font><font color="#800000">12000</font><font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">12 </font><font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
  </font>DMYtoDate<font color="#000080">(</font>Day<font color="#000080">,</font>Month<font color="#000080">,</font>Year<font color="#000080">,</font>Julian<font color="#000080">);
  </font>BumpDate <font color="#000080">:= </font>Julian <font color="#000080">+ </font>Days
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DayOfWeek<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">): </font>TDay<font color="#000080">;
  </font><font color="#008000"><i>{ Return the day of the week for the date }
</i></font><font color="#FF0000"><b>begin
  </b></font>DayOfWeek <font color="#000080">:= </font>TDay<font color="#000080">(</font>succ<font color="#000080">(</font>Julian<font color="#000080">) </font><font color="#FF0000"><b>mod </b></font><font color="#800000">7</font><font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DayString<font color="#000080">(</font>WeekDay<font color="#000080">: </font>TDay<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Return a string version of a day of the week }
</i></font><font color="#FF0000"><b>const </b></font>DayStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font>Sunday<font color="#000080">..</font>Saturday<font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =
     (</font><font color="#800000">'Sunday'</font><font color="#000080">,</font><font color="#800000">'Monday'</font><font color="#000080">,</font><font color="#800000">'Tuesday'</font><font color="#000080">,</font><font color="#800000">'Wednesday'</font><font color="#000080">,</font><font color="#800000">'Thursday'</font><font color="#000080">,</font><font color="#800000">'Friday'</font><font color="#000080">,</font><font color="#800000">'Saturday'</font><font color="#000080">);

</font><font color="#FF0000"><b>begin
  </b></font>DayString <font color="#000080">:= </font>DayStr<font color="#000080">[</font>WeekDay<font color="#000080">]
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>MonthString<font color="#000080">(</font>Month<font color="#000080">: </font>Word<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Return a string version of a month }
  </i></font><font color="#FF0000"><b>const </b></font>MonthStr<font color="#000080">: </font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font><font color="#800000">12</font><font color="#000080">] </font><font color="#FF0000"><b>of string</b></font><font color="#000080">[</font><font color="#800000">9</font><font color="#000080">] =
     (</font><font color="#800000">'January'</font><font color="#000080">,</font><font color="#800000">'February'</font><font color="#000080">,</font><font color="#800000">'March'</font><font color="#000080">,</font><font color="#800000">'April'</font><font color="#000080">,</font><font color="#800000">'May'</font><font color="#000080">,</font><font color="#800000">'June'</font><font color="#000080">,</font><font color="#800000">'July'</font><font color="#000080">,</font><font color="#800000">'August'</font><font color="#000080">,
                                 </font><font color="#800000">'September'</font><font color="#000080">,</font><font color="#800000">'October'</font><font color="#000080">,</font><font color="#800000">'November'</font><font color="#000080">,</font><font color="#800000">'December'</font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>MonthString <font color="#000080">:= </font>MonthStr<font color="#000080">[</font>Month<font color="#000080">]
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>DateToStr<font color="#000080">(</font>Julian<font color="#000080">: </font>TDate<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ Convert a date to a sortable string - NOT displayable }
</i></font><font color="#FF0000"><b>const </b></font>tResult<font color="#000080">: </font><font color="#FF0000"><b>record
                case </b></font>integer <font color="#FF0000"><b>of
                  </b></font><font color="#800000">0</font><font color="#000080">: (</font>Len<font color="#000080">: </font>byte<font color="#000080">;  </font>W<font color="#000080">: </font>word<font color="#000080">);
                  </font><font color="#800000">1</font><font color="#000080">: (</font>Str<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">[</font><font color="#800000">2</font><font color="#000080">])

                </font><font color="#FF0000"><b>end </b></font><font color="#000080">= (</font>Str<font color="#000080">:</font><font color="#800000">'  '</font><font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>tResult<font color="#000080">.</font>W <font color="#000080">:= </font>swap<font color="#000080">(</font>Julian<font color="#000080">);
  </font>DateToStr <font color="#000080">:= </font>tResult<font color="#000080">.</font>Str
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>StrToDate<font color="#000080">(</font>StrVar<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>TDate<font color="#000080">;
  </font><font color="#008000"><i>{ Convert a sortable string form to a date }
</i></font><font color="#FF0000"><b>var </b></font>Temp<font color="#000080">: </font><font color="#FF0000"><b>record
            </b></font>Len<font color="#000080">: </font>byte<font color="#000080">;
              </font>W<font color="#000080">: </font>word
          <font color="#FF0000"><b>end absolute </b></font>StrVar<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>StrToDate <font color="#000080">:= </font>swap<font color="#000080">(</font>Temp<font color="#000080">.</font>W<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0164.PAS">Original</a><b>]</b></p></body>
</html>
