<html>
<head><title> "Re: tMemo co-ordinates" by R.F.P. VAN RIET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0217.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>Memos<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>WinProcs<font color="#000080">, </font>SysUtils<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>Dialogs<font color="#000080">, </font><font color="#FF0000"><b>Message</b></font><font color="#000080">;

</font><font color="#008000"><i>{ Get the line number and column number the cursor is positioned at in the
memo}

</i></font><font color="#FF0000"><b>Procedure </b></font>GetMemoLineCol <font color="#000080">(</font>Memo<font color="#000080">: </font>TCustomMemo<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>MemoLine<font color="#000080">, </font>MemoCol<font color="#000080">:
</font>Integer<font color="#000080">);

</font><font color="#008000"><i>{ Set the cursor position in a memo to the specified line and column }

</i></font><font color="#FF0000"><b>Procedure </b></font>MemoCursorTo <font color="#000080">(</font>Memo<font color="#000080">: </font>TCustomMemo<font color="#000080">; </font>MemoLine<font color="#000080">, </font>MemoCol<font color="#000080">: </font>Integer<font color="#000080">);

</font><font color="#FF0000"><b>Implementation

Procedure </b></font>GetMemoLineCol<font color="#000080">;
</font><font color="#FF0000"><b>begin
   WITH </b></font>Memo <font color="#FF0000"><b>DO
      BEGIN
         </b></font>MemoLine <font color="#000080">:= </font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LINEFROMCHAR<font color="#000080">, </font>SelStart<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
         </font>MemoCol  <font color="#000080">:= </font>SelStart <font color="#000080">- </font>SendMessage <font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LINEINDEX<font color="#000080">, </font>MemoLine<font color="#000080">,
                      </font><font color="#800000">0</font><font color="#000080">) + </font><font color="#800000">1</font><font color="#000080">;
      </font><font color="#FF0000"><b>END</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>MemoCursorTo<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Memo<font color="#000080">.</font>SelStart <font color="#000080">:= </font>SendMessage <font color="#000080">(</font>Memo<font color="#000080">.</font>Handle<font color="#000080">, </font>EM_LINEINDEX<font color="#000080">, </font>MemoLine<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">) +
                   </font>MemoCol <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>Ronan van Riet

Graaf Florishof <font color="#800000">4
3632 </font>BS Loenen a<font color="#000080">/</font>d Vecht
The Netherlands
<font color="#800000">0294</font><font color="#000080">-</font><font color="#800000">233563

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0217.PAS">Original</a><b>]</b></p></body>
</html>
