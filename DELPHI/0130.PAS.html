<html>
<head><title> "Dynamic Arrays like VB" by E.L. LAGERBURG</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0130.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{added by E.L. Lagerburg}


</i></font><font color="#FF0000"><b>Unit </b></font>U_Array<font color="#000080">;

</font><font color="#008000"><i>{Dynamic array by E.L. Lagerburg from the Netherlands}


</i></font><font color="#FF0000"><b>interface
  Uses </b></font>SysUtils<font color="#000080">;

</font><font color="#FF0000"><b>const </b></font>MaxArray <font color="#000080">= </font>MaxInt <font color="#FF0000"><b>div </b></font><font color="#800000">8</font><font color="#000080">;

</font><font color="#FF0000"><b>Type

  </b></font>PByteArray<font color="#000080">=^</font>TByteArray<font color="#000080">;
  </font>TByteArray<font color="#000080">=</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>MaxArray<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte <font color="#000080">;

  </font>TIndexEvent <font color="#000080">= </font><font color="#FF0000"><b>Procedure</b></font><font color="#000080">(</font>Sender<font color="#000080">:</font>Tobject<font color="#000080">;</font>Situation<font color="#000080">:</font>Integer<font color="#000080">;</font>Rec<font color="#000080">:</font>Pointer<font color="#000080">;</font>Index<font color="#000080">:</font>Integer<font color="#000080">) </font><font color="#FF0000"><b>of object</b></font><font color="#000080">;


  </font>Tarray <font color="#000080">= </font><font color="#FF0000"><b>Class</b></font><font color="#000080">(</font>TObject<font color="#000080">)
  </font><font color="#FF0000"><b>Private
     </b></font>FOnForIndex<font color="#000080">:</font>TIndexEvent<font color="#000080">;
     </font>FOnForEach<font color="#000080">:</font>TIndexEvent<font color="#000080">;
     </font>FArray<font color="#000080">:</font>PByteArray<font color="#000080">;
     </font>FRecSize<font color="#000080">,
     </font>FRecCapacity<font color="#000080">:</font>Integer<font color="#000080">;
     </font>FRecCount<font color="#000080">:</font>Integer<font color="#000080">;
  </font><font color="#FF0000"><b>Protected
     procedure </b></font>SetCapacity<font color="#000080">(</font>NewCapacity<font color="#000080">: </font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>Function </b></font>GetSize<font color="#000080">:</font>Integer<font color="#000080">;
     </font><font color="#FF0000"><b>function </b></font>Get<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">): </font>Pointer<font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>Put<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">; </font>Rec<font color="#000080">: </font>Pointer<font color="#000080">);
     </font><font color="#FF0000"><b>Procedure </b></font>Error<font color="#000080">(</font>Nr<font color="#000080">:</font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>Grow<font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>SetCount<font color="#000080">(</font>NewCount<font color="#000080">: </font>Integer<font color="#000080">);
   </font><font color="#FF0000"><b>Public
     Constructor </b></font>Create<font color="#000080">(</font>RecSize<font color="#000080">,</font>RecCapacity<font color="#000080">:</font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>Destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>function </b></font>AddRecord<font color="#000080">(</font>Rec<font color="#000080">:</font>Pointer<font color="#000080">):</font>Integer<font color="#000080">;
     </font><font color="#FF0000"><b>Procedure </b></font>ForEach<font color="#000080">(</font>Situation<font color="#000080">:</font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>Procedure </b></font>ForIndex<font color="#000080">(</font>FromIndex<font color="#000080">,</font>ToIndex<font color="#000080">,</font>Situation<font color="#000080">:</font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>DeleteRecord<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>MoveRecord<font color="#000080">(</font>CurIndex<font color="#000080">, </font>NewIndex<font color="#000080">: </font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>InsertRecord<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">;</font>Rec<font color="#000080">:</font>Pointer<font color="#000080">);
     </font><font color="#FF0000"><b>procedure </b></font>ExchangeRecord<font color="#000080">(</font>Index1<font color="#000080">, </font>Index2<font color="#000080">: </font>Integer<font color="#000080">);
     </font><font color="#FF0000"><b>Procedure </b></font>Clear<font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>ByteArray<font color="#000080">:</font>PByteArray <font color="#FF0000"><b>read </b></font>FArray<font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>Count<font color="#000080">:</font>Integer <font color="#FF0000"><b>read </b></font>FRecCount <font color="#FF0000"><b>write </b></font>SetCount<font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>Size<font color="#000080">:</font>Integer <font color="#FF0000"><b>read </b></font>GetSize<font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>RecordSize<font color="#000080">:</font>Integer <font color="#FF0000"><b>read </b></font>FRecSize<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>Records<font color="#000080">[</font><font color="#FF0000"><b>Index</b></font><font color="#000080">: </font>Integer<font color="#000080">]: </font>Pointer <font color="#FF0000"><b>read </b></font>Get <font color="#FF0000"><b>write </b></font>Put<font color="#000080">; </font><font color="#FF0000"><b>default</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>OnForEach<font color="#000080">:</font>TIndexEvent <font color="#FF0000"><b>read </b></font>FOnForEach <font color="#FF0000"><b>write </b></font>FOnForEach<font color="#000080">;
     </font><font color="#FF0000"><b>Property </b></font>OnForIndex<font color="#000080">:</font>TIndexEvent <font color="#FF0000"><b>read </b></font>FOnForIndex <font color="#FF0000"><b>write </b></font>FOnForIndex<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


   </font>EArrayError <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>Exception<font color="#000080">);


</font><font color="#FF0000"><b>implementation

Constructor </b></font>TArray<font color="#000080">.</font>Create<font color="#000080">(</font>RecSize<font color="#000080">,</font>RecCapacity<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  Inherited </b></font>Create<font color="#000080">;
  </font>FArray<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>FRecSize<font color="#000080">:=</font>RecSize<font color="#000080">;
  </font>FRecCapacity<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>FRecCount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>SetCapacity<font color="#000080">(</font>RecCapacity<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TArray<font color="#000080">.</font>Error<font color="#000080">(</font>Nr<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  raise </b></font>EArrayError<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#800000">'Array index out of bounds '</font><font color="#000080">+</font>intToStr<font color="#000080">(</font>Nr<font color="#000080">));
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>SetCapacity<font color="#000080">(</font>NewCapacity<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  if </b></font><font color="#000080">(</font>NewCapacity <font color="#000080">&lt; </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>NewCapacity <font color="#000080">&gt; </font>MaxArray<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">1</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>NewCapacity <font color="#000080">&lt;&gt; </font>FRecCapacity <font color="#FF0000"><b>then
  begin
    </b></font>ReallocMem<font color="#000080">(</font>FArray<font color="#000080">, </font>NewCapacity <font color="#000080">* </font>FRecSize<font color="#000080">);
    </font>FRecCapacity <font color="#000080">:= </font>NewCapacity<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TArray<font color="#000080">.</font>AddRecord<font color="#000080">(</font>Rec<font color="#000080">:</font>Pointer<font color="#000080">):</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>FRecCount<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Result <font color="#000080">= </font>FRecCapacity <font color="#FF0000"><b>then </b></font>Grow<font color="#000080">;
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Rec<font color="#000080">^,</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>FRecCount<font color="#000080">],</font>FRecSize<font color="#000080">);
  </font>inc<font color="#000080">(</font>FRecCount<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>InsertRecord<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">;</font>Rec<font color="#000080">:</font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Index <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index <font color="#000080">&gt; </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">2</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>FRecCount <font color="#000080">= </font>FRecCapacity <font color="#FF0000"><b>then </b></font>Grow<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>Index <font color="#000080">&lt; </font>FRecCount <font color="#FF0000"><b>then
    </b></font>System<font color="#000080">.</font>Move<font color="#000080">(</font>FArray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">],</font>FArray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">],
      (</font>FRecCount <font color="#000080">- </font>Index<font color="#000080">) * </font>FRecSize<font color="#000080">);
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Rec<font color="#000080">^,</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">],</font>FRecSize<font color="#000080">);
  </font>Inc<font color="#000080">(</font>FRecCount<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>DeleteRecord<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Index <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">3</font><font color="#000080">);
  </font>Dec<font color="#000080">(</font>FRecCount<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>Index <font color="#000080">&lt; </font>FRecCount <font color="#FF0000"><b>then
    </b></font>System<font color="#000080">.</font>Move<font color="#000080">(</font>FArray<font color="#000080">^[</font>FRecSize<font color="#000080">*(</font>Index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">)],</font>FArray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">],
      (</font>FRecCount <font color="#000080">- </font>Index<font color="#000080">) * </font>FRecSize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>MoveRecord<font color="#000080">(</font>CurIndex<font color="#000080">, </font>NewIndex<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Rec<font color="#000080">:</font>PByteArray<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>CurIndex <font color="#000080">&lt;&gt; </font>NewIndex <font color="#FF0000"><b>then
  begin
    if </b></font><font color="#000080">(</font>NewIndex <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>NewIndex <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">4</font><font color="#000080">);
    </font>Rec<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
    </font>ReallocMem<font color="#000080">(</font>Rec<font color="#000080">,</font>FRecSize<font color="#000080">);
    </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>CurIndex<font color="#000080">],</font>Rec<font color="#000080">^,</font>FRecSize<font color="#000080">);
    </font>DeleteRecord<font color="#000080">(</font>CurIndex<font color="#000080">);
    </font>InsertRecord<font color="#000080">(</font>NewIndex<font color="#000080">,</font>Rec<font color="#000080">);
    </font>ReallocMem<font color="#000080">(</font>Rec<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>ExchangeRecord<font color="#000080">(</font>Index1<font color="#000080">, </font>Index2<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>Rec<font color="#000080">:</font>PByteArray<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Index1 <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index1 <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>or
    </b></font><font color="#000080">(</font>Index2 <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index2 <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">5</font><font color="#000080">);
  </font>Rec<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
  </font>ReallocMem<font color="#000080">(</font>Rec<font color="#000080">,</font>FRecSize<font color="#000080">);
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index1<font color="#000080">],</font>Rec<font color="#000080">^,</font>FRecSize<font color="#000080">);
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index2<font color="#000080">],</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index1<font color="#000080">],</font>FRecSize<font color="#000080">);
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Rec<font color="#000080">^,</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index2<font color="#000080">],</font>FRecSize<font color="#000080">);
  </font>ReallocMem<font color="#000080">(</font>Rec<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>SetCount<font color="#000080">(</font>NewCount<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>NewCount <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>NewCount <font color="#000080">&gt; </font>MaxArray<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">6</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>NewCount <font color="#000080">&gt; </font>FRecCapacity <font color="#FF0000"><b>then </b></font>SetCapacity<font color="#000080">(</font>NewCount<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font>NewCount <font color="#000080">&gt; </font>FRecCount <font color="#FF0000"><b>then
    </b></font>FillChar<font color="#000080">(</font>FArray<font color="#000080">^[</font>FRecCount<font color="#000080">*</font>FRecSize<font color="#000080">],(</font>NewCount <font color="#000080">- </font>FRecCount<font color="#000080">) * </font>FRecSize<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>FRecCount <font color="#000080">:= </font>NewCount<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>Grow<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Delta<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>FRecCapacity <font color="#000080">&gt; </font><font color="#800000">8 </font><font color="#FF0000"><b>then </b></font>Delta <font color="#000080">:= </font><font color="#800000">16 </font><font color="#FF0000"><b>else
    if </b></font>FRecCapacity <font color="#000080">&gt; </font><font color="#800000">4 </font><font color="#FF0000"><b>then </b></font>Delta <font color="#000080">:= </font><font color="#800000">8 </font><font color="#FF0000"><b>else
      </b></font>Delta <font color="#000080">:= </font><font color="#800000">4</font><font color="#000080">;
  </font>SetCapacity<font color="#000080">(</font>FRecCapacity <font color="#000080">+ </font>Delta<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TArray<font color="#000080">.</font>Get<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">): </font>Pointer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  if </b></font><font color="#000080">(</font>Index <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">7</font><font color="#000080">);
  </font>Result<font color="#000080">:=@</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">];
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TArray<font color="#000080">.</font>Clear<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FRecCount<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
  </font>SetCapacity<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TArray<font color="#000080">.</font>Put<font color="#000080">(</font>Index<font color="#000080">: </font>Integer<font color="#000080">; </font>Rec<font color="#000080">: </font>Pointer<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  if </b></font><font color="#000080">(</font>Index <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Index <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">8</font><font color="#000080">);
  </font>System<font color="#000080">.</font>Move<font color="#000080">(</font>Rec<font color="#000080">^,</font>Farray<font color="#000080">^[</font>FRecSize<font color="#000080">*</font>Index<font color="#000080">],</font>FRecSize<font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TArray<font color="#000080">.</font>ForEach<font color="#000080">(</font>Situation<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Teller<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If not </b></font>Assigned<font color="#000080">(</font>FOnForEach<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>For </b></font>Teller<font color="#000080">:=</font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>FRecCount<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
  Begin
    </b></font>FOnForEach<font color="#000080">(</font>Self<font color="#000080">,</font>Situation<font color="#000080">,</font>Get<font color="#000080">(</font>Teller<font color="#000080">),</font>Teller<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TArray<font color="#000080">.</font>ForIndex<font color="#000080">(</font>FromIndex<font color="#000080">,</font>ToIndex<font color="#000080">,</font>Situation<font color="#000080">:</font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>Var </b></font>Teller<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If not </b></font>Assigned<font color="#000080">(</font>FOnForIndex<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>FromIndex <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>FromIndex <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">9</font><font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ToIndex <font color="#000080">&lt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>ToIndex <font color="#000080">&gt;= </font>FRecCount<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Error<font color="#000080">(</font><font color="#800000">10</font><font color="#000080">);
  </font><font color="#FF0000"><b>For </b></font>Teller<font color="#000080">:=</font>FromIndex <font color="#FF0000"><b>to </b></font>ToIndex <font color="#FF0000"><b>do
  Begin
    </b></font>FOnForIndex<font color="#000080">(</font>Self<font color="#000080">,</font>Situation<font color="#000080">,</font>Get<font color="#000080">(</font>Teller<font color="#000080">),</font>Teller<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TArray<font color="#000080">.</font>GetSize<font color="#000080">:</font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Result<font color="#000080">:=</font>FRecSize <font color="#000080">* </font>FRecCount<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>TArray<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Clear<font color="#000080">;
  </font><font color="#FF0000"><b>Inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0130.PAS">Original</a><b>]</b></p></body>
</html>
