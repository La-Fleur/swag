<html>
<head><title> "Re: IShellLink Example" by RADEK VOLTR</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0230.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">     This <font color="#FF0000"><b>is </b></font>last source code <font color="#FF0000"><b>for </b></font>my ShellLink component<font color="#000080">.

     </font><font color="#008000"><i>//******************************************************* //*
     </i></font>Shell Link Component <font color="#FF0000"><b>for </b></font>Delphi <font color="#800000">2.0           </font><font color="#000080">* </font><font color="#008000"><i>//*
                                      </i></font><font color="#000080">* </font><font color="#008000"><i>//*   this is end version
                         </i></font><font color="#000080">* </font><font color="#008000"><i>//*
            </i></font><font color="#000080">* </font><font color="#008000"><i>//*   for new versions send e-mail,s-mail,fax           * //*
       </i></font><font color="#FF0000"><b>with </b></font>you name <font color="#FF0000"><b>and </b></font>e<font color="#000080">-</font>mail adress <font color="#FF0000"><b>to </b></font><font color="#000080">&gt;              * </font><font color="#008000"><i>//*
                                            </i></font><font color="#000080">* </font><font color="#008000"><i>//*
     </i></font>voltr<font color="#000080">.</font>radek<font color="#000080">/</font><font color="#800000">4600</font><font color="#000080">/</font>epr<font color="#000080">@</font>epr1<font color="#000080">.</font>ccmail<font color="#000080">.</font>x400<font color="#000080">.</font>cez<font color="#000080">.</font>cz     <font color="#000080">* </font><font color="#008000"><i>//*
                                         </i></font><font color="#000080">* </font><font color="#008000"><i>//*    (c) 1996 Radek Voltr
                            </i></font><font color="#000080">* </font><font color="#008000"><i>//*             Kozeluzska 1523
               </i></font><font color="#000080">* </font><font color="#008000"><i>//*             Kadan 43201    CZECH Republic   Europe  *
     //*             fax. 42 398 2776                        * //*
     </i></font>note<font color="#000080">: </font>this version <font color="#FF0000"><b>is </b></font>free                     <font color="#000080">*
     </font><font color="#008000"><i>//*******************************************************

     </i></font><font color="#FF0000"><b>unit </b></font>SheLink<font color="#000080">;

     </font><font color="#FF0000"><b>interface

     uses
     </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">,
     </font>Dialogs<font color="#000080">, </font>Ole2<font color="#000080">;

     </font><font color="#FF0000"><b>const
     </b></font>SLR_NO_UI           <font color="#000080">= </font>_0001<font color="#000080">;
     </font>SLR_ANY_MATCH       <font color="#000080">= </font>_0002<font color="#000080">;
     </font>SLR_UPDATE          <font color="#000080">= </font>_0004<font color="#000080">;

     </font>SLGP_SHORTPATH      <font color="#000080">= </font>_0001<font color="#000080">;
     </font>SLGP_UNCPRIORITY    <font color="#000080">= </font>_0002<font color="#000080">;

     </font>CLSID_ShellLink<font color="#000080">:    </font>TCLSID <font color="#000080">= (</font>D1<font color="#000080">:</font>_00021401<font color="#000080">; </font>D2<font color="#000080">:</font>_0<font color="#000080">; </font>D3<font color="#000080">:</font>_0<font color="#000080">;
     </font>D4<font color="#000080">:(</font>_C0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_46<font color="#000080">));
     </font>IID_IShellLink<font color="#000080">:      </font>TCLSID <font color="#000080">= (</font>D1<font color="#000080">:</font>_000214EE<font color="#000080">; </font>D2<font color="#000080">:</font>_0<font color="#000080">; </font>D3<font color="#000080">:</font>_0<font color="#000080">;
     </font>D4<font color="#000080">:(</font>_C0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_0<font color="#000080">,</font>_46<font color="#000080">));

     </font><font color="#FF0000"><b>type
     </b></font>PShellLink <font color="#000080">= ^</font>IShellLink<font color="#000080">;
     </font>IShellLink <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>IUnknown<font color="#000080">)
     </font><font color="#FF0000"><b>public
     Function </b></font>GetPath<font color="#000080">(</font>pszFile<font color="#000080">:</font>PChar<font color="#000080">;</font>cchMaxPath<font color="#000080">:</font>Integer<font color="#000080">;</font><font color="#FF0000"><b>var
     </b></font>pfd<font color="#000080">:</font>TWin32FindData<font color="#000080">;</font>fFlags<font color="#000080">:</font>DWord<font color="#000080">):</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>GetIDList<font color="#000080">(</font>ppidl<font color="#000080">:</font>pointer<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">; </font><font color="#FF0000"><b>Function </b></font>SetIDList<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pidl<font color="#000080">:</font>pointer<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">; </font><font color="#FF0000"><b>Function
     </b></font>GetDescription<font color="#000080">(</font>pszName<font color="#000080">:</font>PChar<font color="#000080">;</font>cchMaxName<font color="#000080">:</font>Integer<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetDescription<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>pszName<font color="#000080">:</font>PChar<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>GetWorkingDirectory<font color="#000080">(</font>pszDir<font color="#000080">:</font>PChar<font color="#000080">;</font>cchMaxPath<font color="#000080">:</font>Integer<font color="#000080">)
     :</font>HResult<font color="#000080">;
     </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetWorkingDirectory<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pszDir<font color="#000080">:</font>PChar<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>GetArguments<font color="#000080">(</font>pszDir<font color="#000080">:</font>PChar<font color="#000080">;</font>cchMaxPath<font color="#000080">:</font>Integer<font color="#000080">) :</font>HResult<font color="#000080">;
     </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetArguments<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pszArgs<font color="#000080">:</font>PChar<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>GetHotkey<font color="#000080">(</font>pwHotkey<font color="#000080">:</font>PWord<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">; </font><font color="#FF0000"><b>Function </b></font>SetHotkey<font color="#000080">(</font>wHotkey<font color="#000080">:</font>Word<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">; </font><font color="#FF0000"><b>Function </b></font>GetShowCmd<font color="#000080">(</font>piShowCmd<font color="#000080">:</font>PInteger<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetShowCmd<font color="#000080">(</font>iShowCmd<font color="#000080">:</font>Integer<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">; </font><font color="#FF0000"><b>Function
     </b></font>GetIconLocation<font color="#000080">(</font>pszIconPath<font color="#000080">:</font>PChar<font color="#000080">;</font>cchIconPath<font color="#000080">:</font>Integer<font color="#000080">;</font>piIcon<font color="#000080">:</font>PInteger<font color="#000080">)
     :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetIconLocation<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pszIconPath<font color="#000080">:</font>PChar<font color="#000080">;</font>iIcon<font color="#000080">:</font>Integer<font color="#000080">)
     :</font>HResult<font color="#000080">;
     </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetRelativePath<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>pszPathRel<font color="#000080">:</font>PChar<font color="#000080">;</font>dwReserved<font color="#000080">:</font>Dword<font color="#000080">)
     :</font>HResult<font color="#000080">;
     </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">; </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>Resolve<font color="#000080">(</font>wnd<font color="#000080">:</font>hWnd<font color="#000080">;</font>fFlags<font color="#000080">:</font>Dword<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>Function </b></font>SetPath<font color="#000080">(</font><font color="#FF0000"><b>Const </b></font>pszFile<font color="#000080">:</font>PChar<font color="#000080">) :</font>HResult<font color="#000080">; </font><font color="#FF0000"><b>virtual</b></font><font color="#000080">; </font><font color="#FF0000"><b>stdcall</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>abstract</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


     </font><font color="#FF0000"><b>type
     </b></font>TShellLink <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TComponent<font color="#000080">)
     </font><font color="#FF0000"><b>private
     </b></font><font color="#008000"><i>{ Private declarations }
     </i></font><font color="#FF0000"><b>procedure </b></font>fSetSelfPath<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>protected
     </b></font><font color="#008000"><i>{ Protected declarations }
     </i></font>fUpdate<font color="#000080">:</font>Boolean<font color="#000080">;
     </font>fPath<font color="#000080">,
     </font>fTarget<font color="#000080">,
     </font>fWorkingDir<font color="#000080">,
     </font>fDescription<font color="#000080">,
     </font>fArguments<font color="#000080">,
     </font>fIconLocation<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font>fIconNumber<font color="#000080">,
     </font>fShowCmd<font color="#000080">,
     </font>fHotKey<font color="#000080">:</font>Word<font color="#000080">;
     </font><font color="#FF0000"><b>public
     </b></font><font color="#008000"><i>{ Public declarations }
     //    constructor Create;
     </i></font><font color="#FF0000"><b>procedure </b></font>SetSelfPath<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>procedure </b></font>SetUpdate<font color="#000080">(</font><font color="#FF0000"><b>const
     </b></font>S<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>procedure </b></font>CreateNew<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">,</font>Target<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>procedure
     </b></font>SaveToFile<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">);
     </font><font color="#FF0000"><b>published
     </b></font><font color="#008000"><i>{ Published declarations }
     </i></font><font color="#FF0000"><b>property </b></font>Path<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fPath <font color="#FF0000"><b>write </b></font>fSetSelfPath<font color="#000080">; </font><font color="#FF0000"><b>property
     </b></font>Target<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fTarget <font color="#FF0000"><b>write </b></font>fTarget<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>WorkingDir<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fWorkingDir <font color="#FF0000"><b>write </b></font>fWorkingDir<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>Description<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fDescription <font color="#FF0000"><b>write </b></font>fDescription<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>Arguments<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fArguments <font color="#FF0000"><b>write </b></font>fArguments<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>IconLocation<font color="#000080">:</font><font color="#FF0000"><b>String read </b></font>fIconLocation <font color="#FF0000"><b>write </b></font>fIconLocation<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>HotKey<font color="#000080">:</font>word <font color="#FF0000"><b>read </b></font>fHotKey <font color="#FF0000"><b>write </b></font>fHotKey<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>ShowCmd<font color="#000080">:</font>word <font color="#FF0000"><b>read </b></font>fShowCmd <font color="#FF0000"><b>write </b></font>fShowCmd<font color="#000080">;
     </font><font color="#FF0000"><b>property </b></font>IconNumber<font color="#000080">:</font>word <font color="#FF0000"><b>read </b></font>fIconNumber <font color="#FF0000"><b>write </b></font>fIconNumber<font color="#000080">; </font><font color="#FF0000"><b>property
     </b></font>Update<font color="#000080">:</font>boolean <font color="#FF0000"><b>read </b></font>fUpdate <font color="#FF0000"><b>write </b></font>SetUpdate<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>implementation

     procedure Register</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>begin
     </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Win95'</font><font color="#000080">, [</font>TShellLink<font color="#000080">]); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;


     </font><font color="#FF0000"><b>procedure </b></font>TShellLink<font color="#000080">.</font>SetSelfPath<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>var </b></font>X3<font color="#000080">:</font>PChar<font color="#000080">;
     </font>hresx<font color="#000080">:</font>HResult<font color="#000080">;
     </font>Psl<font color="#000080">:</font>IShellLink<font color="#000080">;
     </font>Ppf<font color="#000080">:</font>IPersistFile<font color="#000080">;
     </font>Saver<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Max_Path<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>WideChar<font color="#000080">; </font>X1<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>Of </b></font>Char<font color="#000080">;
     </font>Data<font color="#000080">:</font>TWin32FindData<font color="#000080">;</font>I<font color="#000080">,</font>Y<font color="#000080">:</font>INteger<font color="#000080">;</font>W<font color="#000080">:</font>Word<font color="#000080">;
     </font><font color="#FF0000"><b>begin
     </b></font>hresx<font color="#000080">:=</font>CoCreateInstance<font color="#000080">(</font>CLSID_ShellLink<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>CLSCTX_INPROC_SERVER<font color="#000080">,</font>IID_I
     ShellLink<font color="#000080">, </font>psl<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>QueryInterface<font color="#000080">(</font>IID_IPersistFile<font color="#000080">,</font>ppf<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     </b></font>Exit<font color="#000080">;
     </font>X3<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
     </font>StrPCopy<font color="#000080">(</font>X3<font color="#000080">,</font>S<font color="#000080">);
     </font>MultiByteToWideChar<font color="#000080">(</font>CP_ACP<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>X3<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,</font>Saver<font color="#000080">,</font>Max_Path<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>ppf<font color="#000080">.</font>Load<font color="#000080">(</font>Saver<font color="#000080">,</font>STGM_READ<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'File not found (or not link)'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand
     <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">); </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>Resolve<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font>SLR_ANY_MATCH<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">; </font>hresx<font color="#000080">:=
     </font>psl<font color="#000080">.</font>GetWorkingDirectory<font color="#000080">(@</font>X1<font color="#000080">,</font>MAX_PATH <font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get WD'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fWorkingDir<font color="#000080">:=</font>StrPas<font color="#000080">(@</font>X1<font color="#000080">);

     </font>hresx<font color="#000080">:= </font>psl<font color="#000080">.</font>GetPath<font color="#000080">( @</font>X1<font color="#000080">,</font>MAX_PATH<font color="#000080">,</font>Data<font color="#000080">,</font>SLGP_UNCPRIORITY<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0
     </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get GP'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fTarget<font color="#000080">:=</font>StrPas<font color="#000080">(@</font>X1<font color="#000080">);

     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>GetIconLocation<font color="#000080">(@</font>X1<font color="#000080">,</font>MAX_PATH<font color="#000080">,@</font>I<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get IL'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fIconLocation<font color="#000080">:=</font>StrPas<font color="#000080">(@</font>X1<font color="#000080">);
     </font>fIconNumber<font color="#000080">:=</font>I<font color="#000080">;

     </font>hresx<font color="#000080">:= </font>psl<font color="#000080">.</font>GetDescription<font color="#000080">(@</font>X1<font color="#000080">,</font>MAX_PATH <font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get DE'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fDescription<font color="#000080">:=</font>StrPas<font color="#000080">(@</font>X1<font color="#000080">);

     </font>Y<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>hresx<font color="#000080">:= </font>psl<font color="#000080">.</font>GetShowCmd<font color="#000080">(@</font>Y<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get SC'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fShowCmd<font color="#000080">:=</font>Y<font color="#000080">;

     </font>W<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>hresx<font color="#000080">:= </font>psl<font color="#000080">.</font>GetHotKey<font color="#000080">(@</font>W<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get HK'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fHotKey<font color="#000080">:=</font>W<font color="#000080">;

     </font>hresx<font color="#000080">:= </font>psl<font color="#000080">.</font>GetArguments<font color="#000080">(@</font>X1<font color="#000080">,</font>MAX_PATH <font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in get AR'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>fArguments<font color="#000080">:=</font>StrPas<font color="#000080">(@</font>X1<font color="#000080">);

     </font>ppf<font color="#000080">.</font>release<font color="#000080">;
     </font>psl<font color="#000080">.</font>release<font color="#000080">;
     </font>StrDispose<font color="#000080">(</font>X3<font color="#000080">);
     </font>fPath<font color="#000080">:=</font>S<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TShellLink<font color="#000080">.</font>SetUpdate<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font>Boolean<font color="#000080">); </font><font color="#FF0000"><b>begin
     </b></font>SetSelfPath<font color="#000080">(</font>fPath<font color="#000080">);
     </font>fUpdate<font color="#000080">:=</font>True<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TShellLink<font color="#000080">.</font>fSetSelfPath<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>S<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>begin
     </b></font>SetSelfPath<font color="#000080">(</font>S<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TShellLink<font color="#000080">.</font>CreateNew<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">,</font>Target<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>var
     </b></font>X1<font color="#000080">,</font>X3<font color="#000080">:</font>PChar<font color="#000080">;</font>S<font color="#000080">,</font>S2<font color="#000080">,</font>S3<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];
     </font>hresx<font color="#000080">:</font>HResult<font color="#000080">;
     </font>Psl<font color="#000080">:</font>IShellLink<font color="#000080">;
     </font>Ppf<font color="#000080">:</font>IPersistFile<font color="#000080">;
     </font>Saver<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Max_Path<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>WideChar<font color="#000080">; </font><font color="#FF0000"><b>begin
     </b></font>hresx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>hresx<font color="#000080">:=</font>CoCreateInstance<font color="#000080">(</font>CLSID_ShellLink<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>CLSCTX_INPROC_SERVER<font color="#000080">,</font>IID_I
     ShellLink<font color="#000080">, </font>psl<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in create instance'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or
     </b></font>mb_ok<font color="#000080">); </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>X1<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
     </font>X3<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
     </font><font color="#FF0000"><b>try
     </b></font>StrPCopy<font color="#000080">(</font>X1<font color="#000080">,</font>Target<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetPath<font color="#000080">(</font>X1<font color="#000080">);
     </font><font color="#FF0000"><b>if </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in set path'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>QueryInterface<font color="#000080">(</font>IID_IPersistFile<font color="#000080">,</font>ppf<font color="#000080">); </font><font color="#FF0000"><b>if </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in query interface'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or
     </b></font>mb_ok<font color="#000080">); </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>StrPCopy<font color="#000080">(</font>X3<font color="#000080">,</font>Path<font color="#000080">);

     </font>MultiByteToWideChar<font color="#000080">(</font>CP_ACP<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>X3<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,</font>Saver<font color="#000080">,</font>Max_Path<font color="#000080">);

     </font>hresx<font color="#000080">:=</font>ppf<font color="#000080">.</font>Save<font color="#000080">(</font>Saver<font color="#000080">,</font>True<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in save'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>finally
     </b></font>ppf<font color="#000080">.</font>release<font color="#000080">;
     </font>psl<font color="#000080">.</font>release<font color="#000080">;
     </font>StrDispose<font color="#000080">(</font>X1<font color="#000080">);
     </font>StrDispose<font color="#000080">(</font>X3<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TShellLink<font color="#000080">.</font>SaveToFile<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Path<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">); </font><font color="#FF0000"><b>var
     </b></font>X1<font color="#000080">,</font>X3<font color="#000080">:</font>PChar<font color="#000080">;</font>S<font color="#000080">,</font>S2<font color="#000080">,</font>S3<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">255</font><font color="#000080">];
     </font>hresx<font color="#000080">:</font>HResult<font color="#000080">;
     </font>Psl<font color="#000080">:</font>IShellLink<font color="#000080">;
     </font>Ppf<font color="#000080">:</font>IPersistFile<font color="#000080">;
     </font>Saver<font color="#000080">:</font><font color="#FF0000"><b>Array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font>Max_Path<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>WideChar<font color="#000080">; </font><font color="#FF0000"><b>begin
     </b></font>hresx<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
     </font>hresx<font color="#000080">:=</font>CoCreateInstance<font color="#000080">(</font>CLSID_ShellLink<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>CLSCTX_INPROC_SERVER<font color="#000080">,</font>IID_I
     ShellLink<font color="#000080">, </font>psl<font color="#000080">);
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in create instance'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or
     </b></font>mb_ok<font color="#000080">); </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>X1<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
     </font>X3<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font><font color="#800000">255</font><font color="#000080">);
     </font><font color="#FF0000"><b>try
     </b></font>StrPCopy<font color="#000080">(</font>X1<font color="#000080">,</font>fTarget<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetPath<font color="#000080">(</font>PChar<font color="#000080">(</font>fTarget<font color="#000080">));
     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in set path'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>StrPCopy<font color="#000080">(</font>X1<font color="#000080">,</font>fDescription<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetDescription<font color="#000080">(</font>X1<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetWorkingDirectory<font color="#000080">(</font>PChar<font color="#000080">(</font>fWorkingDir<font color="#000080">));
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetArguments<font color="#000080">(</font>PChar<font color="#000080">(</font>fArguments<font color="#000080">));
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetHotKey<font color="#000080">(</font>fHotKey<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetShowCmd<font color="#000080">(</font>fShowCmd<font color="#000080">);
     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>SetIconLocation<font color="#000080">(</font>PChar<font color="#000080">(</font>fIconLocation<font color="#000080">),</font>IconNumber<font color="#000080">);


     </font>hresx<font color="#000080">:=</font>psl<font color="#000080">.</font>QueryInterface<font color="#000080">(</font>IID_IPersistFile<font color="#000080">,</font>ppf<font color="#000080">); </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in query interface'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or
     </b></font>mb_ok<font color="#000080">); </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>StrPCopy<font color="#000080">(</font>X3<font color="#000080">,</font>Path<font color="#000080">);

     </font>MultiByteToWideChar<font color="#000080">(</font>CP_ACP<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font>X3<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,</font>Saver<font color="#000080">,</font>Max_Path<font color="#000080">);

     </font>hresx<font color="#000080">:=</font>ppf<font color="#000080">.</font>Save<font color="#000080">(</font>Saver<font color="#000080">,</font>True<font color="#000080">);

     </font><font color="#FF0000"><b>If </b></font>hresx<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then
     begin
     </b></font>MessageBox<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">'Error in save'</font><font color="#000080">,</font><font color="#800000">'!! Error !!'</font><font color="#000080">,</font>mb_IconHand <font color="#FF0000"><b>or </b></font>mb_ok<font color="#000080">);
     </font>Exit<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font>ppf<font color="#000080">.</font>release<font color="#000080">;
     </font><font color="#FF0000"><b>finally
     </b></font>psl<font color="#000080">.</font>release<font color="#000080">;
     </font>StrDispose<font color="#000080">(</font>X1<font color="#000080">);
     </font>StrDispose<font color="#000080">(</font>X3<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


     </font><font color="#FF0000"><b>begin
     end</b></font><font color="#000080">.


     *******************************************************
     </font><font color="#FF0000"><b>and </b></font>this <font color="#FF0000"><b>is </b></font>sample code <font color="#FF0000"><b>for </b></font>create link <font color="#FF0000"><b>and </b></font>retrieve information from
     link
     <font color="#000080">*******************************************************

     </font><font color="#FF0000"><b>unit </b></font>test1<font color="#000080">;

     </font><font color="#FF0000"><b>interface

     uses
     </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">,
     </font>Dialogs<font color="#000080">, </font>SheLink<font color="#000080">, </font>StdCtrls<font color="#000080">,</font>Ole2<font color="#000080">;

     </font><font color="#FF0000"><b>type
     </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
     </font>GroupBox1<font color="#000080">: </font>TGroupBox<font color="#000080">;
     </font>Memo1<font color="#000080">: </font>TMemo<font color="#000080">;
     </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
     </font>Link<font color="#000080">: </font>TShellLink<font color="#000080">;
     </font>Open1<font color="#000080">: </font>TOpenDialog<font color="#000080">;
     </font>GroupBox2<font color="#000080">: </font>TGroupBox<font color="#000080">;
     </font>Edit1<font color="#000080">: </font>TEdit<font color="#000080">;
     </font>Label1<font color="#000080">: </font>TLabel<font color="#000080">;
     </font>Button2<font color="#000080">: </font>TButton<font color="#000080">;
     </font>Label2<font color="#000080">: </font>TLabel<font color="#000080">;
     </font>Edit2<font color="#000080">: </font>TEdit<font color="#000080">;
     </font>Button3<font color="#000080">: </font>TButton<font color="#000080">;
     </font>Open2<font color="#000080">: </font>TOpenDialog<font color="#000080">;
     </font>Save<font color="#000080">: </font>TSaveDialog<font color="#000080">;
     </font>Button4<font color="#000080">: </font>TButton<font color="#000080">;
     </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>procedure
     </b></font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>procedure </b></font>Button3Click<font color="#000080">(</font>Sender<font color="#000080">:
     </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>procedure </b></font>Button4Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>procedure
     </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>procedure </b></font>FormDestroy<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
     </font><font color="#FF0000"><b>private
     </b></font><font color="#008000"><i>{ Private declarations }
     </i></font><font color="#FF0000"><b>public
     </b></font><font color="#008000"><i>{ Public declarations }
     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>var
     </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

     </font><font color="#FF0000"><b>implementation

     </b></font><font color="#008000"><i>{_R *.DFM}

     </i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin If Not
     </b></font>Open1<font color="#000080">.</font>Execute <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
     </font>Link<font color="#000080">.</font>SetSelfPath<font color="#000080">(</font>Open1<font color="#000080">.</font>FileName<font color="#000080">);
     </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Arguments :'</font><font color="#000080">+</font>Link<font color="#000080">.</font>Arguments<font color="#000080">);
     </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Description :'</font><font color="#000080">+</font>Link<font color="#000080">.</font>Description<font color="#000080">);
     </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Hotkey :'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>Link<font color="#000080">.</font>Hotkey<font color="#000080">));
     </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'Target :'</font><font color="#000080">+</font>Link<font color="#000080">.</font>Target<font color="#000080">); </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'WorkingDir
     </font><font color="#000080">:</font><font color="#800000">'+Link.WorkingDir); end;

     </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin If </b></font>Open2<font color="#000080">.</font>Execute
     <font color="#FF0000"><b>then </b></font>Edit1<font color="#000080">.</font>Text<font color="#000080">:=</font>Open2<font color="#000080">.</font>FileName<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button3Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin If </b></font>Save<font color="#000080">.</font>Execute
     <font color="#FF0000"><b>then </b></font>Edit2<font color="#000080">.</font>Text<font color="#000080">:=</font>Save<font color="#000080">.</font>FileName<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button4Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin
     </b></font>Link<font color="#000080">.</font>CreateNew<font color="#000080">(</font>Edit2<font color="#000080">.</font>Text<font color="#000080">,</font>Edit1<font color="#000080">.</font>Text<font color="#000080">); </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin </b></font>CoInitialize<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
                       </font><font color="#008000"><i>// required for Shell link end;

     </i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormDestroy<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">); </font><font color="#FF0000"><b>begin
     </b></font>CoUninitialize<font color="#000080">;                      </font><font color="#008000"><i>// required for Shell link end;

     </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.

     </font>a tadu je k tomu form

     <font color="#FF0000"><b>object </b></font>Form1<font color="#000080">: </font>TForm1
     Left <font color="#000080">= </font><font color="#800000">223
     </font>Top <font color="#000080">= </font><font color="#800000">107
     </font>Width <font color="#000080">= </font><font color="#800000">435
     </font>Height <font color="#000080">= </font><font color="#800000">300
     </font>Caption <font color="#000080">= </font><font color="#800000">'Shell Link Demo'
     </font>Font<font color="#000080">.</font>Color <font color="#000080">= </font>clWindowText
     Font<font color="#000080">.</font>Height <font color="#000080">= -</font><font color="#800000">11
     </font>Font<font color="#000080">.</font>Name <font color="#000080">= </font><font color="#800000">'MS Sans Serif'
     </font>Font<font color="#000080">.</font>Style <font color="#000080">= []
     </font>OnCreate <font color="#000080">= </font>FormCreate
     OnDestroy <font color="#000080">= </font>FormDestroy
     PixelsPerInch <font color="#000080">= </font><font color="#800000">96
     </font>TextHeight <font color="#000080">= </font><font color="#800000">13
     </font><font color="#FF0000"><b>object </b></font>GroupBox1<font color="#000080">: </font>TGroupBox
     Left <font color="#000080">= </font><font color="#800000">4
     </font>Top <font color="#000080">= </font><font color="#800000">4
     </font>Width <font color="#000080">= </font><font color="#800000">419
     </font>Height <font color="#000080">= </font><font color="#800000">147
     </font>Caption <font color="#000080">= </font><font color="#800000">' Get info from shell link ' </font>TabOrder <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>object </b></font>Memo1<font color="#000080">:
     </font>TMemo
     Left <font color="#000080">= </font><font color="#800000">6
     </font>Top <font color="#000080">= </font><font color="#800000">18
     </font>Width <font color="#000080">= </font><font color="#800000">407
     </font>Height <font color="#000080">= </font><font color="#800000">101
     </font>TabOrder <font color="#000080">= </font><font color="#800000">0
     </font><font color="#FF0000"><b>end
     object </b></font>Button1<font color="#000080">: </font>TButton
     Left <font color="#000080">= </font><font color="#800000">6
     </font>Top <font color="#000080">= </font><font color="#800000">120
     </font>Width <font color="#000080">= </font><font color="#800000">407
     </font>Height <font color="#000080">= </font><font color="#800000">25
     </font>Caption <font color="#000080">= </font><font color="#800000">'Get info'
     </font>TabOrder <font color="#000080">= </font><font color="#800000">1
     </font>OnClick <font color="#000080">= </font>Button1Click
     <font color="#FF0000"><b>end
     end
     object </b></font>GroupBox2<font color="#000080">: </font>TGroupBox
     Left <font color="#000080">= </font><font color="#800000">4
     </font>Top <font color="#000080">= </font><font color="#800000">154
     </font>Width <font color="#000080">= </font><font color="#800000">419
     </font>Height <font color="#000080">= </font><font color="#800000">117
     </font>Caption <font color="#000080">= </font><font color="#800000">' Create new link '
     </font>TabOrder <font color="#000080">= </font><font color="#800000">1
     </font><font color="#FF0000"><b>object </b></font>Label1<font color="#000080">: </font>TLabel
     Left <font color="#000080">= </font><font color="#800000">12
     </font>Top <font color="#000080">= </font><font color="#800000">14
     </font>Width <font color="#000080">= </font><font color="#800000">34
     </font>Height <font color="#000080">= </font><font color="#800000">13
     </font>Caption <font color="#000080">= </font><font color="#800000">'Target '
     </font><font color="#FF0000"><b>end
     object </b></font>Label2<font color="#000080">: </font>TLabel
     Left <font color="#000080">= </font><font color="#800000">12
     </font>Top <font color="#000080">= </font><font color="#800000">52
     </font>Width <font color="#000080">= </font><font color="#800000">82
     </font>Height <font color="#000080">= </font><font color="#800000">13
     </font>Caption <font color="#000080">= </font><font color="#800000">'Name of new link'
     </font><font color="#FF0000"><b>end
     object </b></font>Edit1<font color="#000080">: </font>TEdit
     Left <font color="#000080">= </font><font color="#800000">10
     </font>Top <font color="#000080">= </font><font color="#800000">30
     </font>Width <font color="#000080">= </font><font color="#800000">321
     </font>Height <font color="#000080">= </font><font color="#800000">21
     </font>TabOrder <font color="#000080">= </font><font color="#800000">0
     </font>Text <font color="#000080">= </font><font color="#800000">'C:\Autoexec.bat'
     </font><font color="#FF0000"><b>end
     object </b></font>Button2<font color="#000080">: </font>TButton
     Left <font color="#000080">= </font><font color="#800000">338
     </font>Top <font color="#000080">= </font><font color="#800000">26
     </font>Width <font color="#000080">= </font><font color="#800000">75
     </font>Height <font color="#000080">= </font><font color="#800000">25
     </font>Caption <font color="#000080">= </font><font color="#800000">'Browse'
     </font>TabOrder <font color="#000080">= </font><font color="#800000">1
     </font>OnClick <font color="#000080">= </font>Button2Click
     <font color="#FF0000"><b>end
     object </b></font>Edit2<font color="#000080">: </font>TEdit
     Left <font color="#000080">= </font><font color="#800000">10
     </font>Top <font color="#000080">= </font><font color="#800000">68
     </font>Width <font color="#000080">= </font><font color="#800000">321
     </font>Height <font color="#000080">= </font><font color="#800000">21
     </font>TabOrder <font color="#000080">= </font><font color="#800000">2
     </font>Text <font color="#000080">= </font><font color="#800000">'C:\this is shortcut to Autoexec.bat.lnk' </font><font color="#FF0000"><b>end
     object </b></font>Button3<font color="#000080">: </font>TButton
     Left <font color="#000080">= </font><font color="#800000">338
     </font>Top <font color="#000080">= </font><font color="#800000">64
     </font>Width <font color="#000080">= </font><font color="#800000">75
     </font>Height <font color="#000080">= </font><font color="#800000">25
     </font>Caption <font color="#000080">= </font><font color="#800000">'Browse'
     </font>TabOrder <font color="#000080">= </font><font color="#800000">3
     </font>OnClick <font color="#000080">= </font>Button3Click
     <font color="#FF0000"><b>end
     object </b></font>Button4<font color="#000080">: </font>TButton
     Left <font color="#000080">= </font><font color="#800000">10
     </font>Top <font color="#000080">= </font><font color="#800000">90
     </font>Width <font color="#000080">= </font><font color="#800000">405
     </font>Height <font color="#000080">= </font><font color="#800000">25
     </font>Caption <font color="#000080">= </font><font color="#800000">'Create new link (shortcut)' </font>TabOrder <font color="#000080">= </font><font color="#800000">4 </font>OnClick <font color="#000080">=
     </font>Button4Click
     <font color="#FF0000"><b>end
     end
     object </b></font>Link<font color="#000080">: </font>TShellLink
     HotKey <font color="#000080">= </font><font color="#800000">0
     </font>ShowCmd <font color="#000080">= </font><font color="#800000">0
     </font>IconNumber <font color="#000080">= </font><font color="#800000">0
     </font>Update <font color="#000080">= </font>True
     Left <font color="#000080">= </font><font color="#800000">378
     </font>Top <font color="#000080">= </font><font color="#800000">24
     </font><font color="#FF0000"><b>end
     object </b></font>Open1<font color="#000080">: </font>TOpenDialog
     FileEditStyle <font color="#000080">= </font>fsEdit
     Filter <font color="#000080">= </font><font color="#800000">'Link files|*.lnk|Pif files|*.pif' </font>Options <font color="#000080">=
     [</font>ofNoDereferenceLinks<font color="#000080">]
     </font>Left <font color="#000080">= </font><font color="#800000">378
     </font>Top <font color="#000080">= </font><font color="#800000">56
     </font><font color="#FF0000"><b>end
     object </b></font>Open2<font color="#000080">: </font>TOpenDialog
     FileEditStyle <font color="#000080">= </font>fsEdit
     Filter <font color="#000080">= </font><font color="#800000">'All files|*.*'
     </font>Left <font color="#000080">= </font><font color="#800000">302
     </font>Top <font color="#000080">= </font><font color="#800000">170
     </font><font color="#FF0000"><b>end
     object </b></font>Save<font color="#000080">: </font>TSaveDialog
     DefaultExt <font color="#000080">= </font><font color="#800000">'*.lnk'
     </font>FileEditStyle <font color="#000080">= </font>fsEdit
     Filter <font color="#000080">= </font><font color="#800000">'*.lnk|*.lnk'
     </font>Left <font color="#000080">= </font><font color="#800000">302
     </font>Top <font color="#000080">= </font><font color="#800000">216
     </font><font color="#FF0000"><b>end
     end



     </b></font>Bye Radek Voltr

     voltrr1<font color="#000080">@</font>epr1<font color="#000080">.</font>ccmail<font color="#000080">.</font>x400<font color="#000080">.</font>cez<font color="#000080">.</font>cz


</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0230.PAS">Original</a><b>]</b></p></body>
</html>
