<html>
<head><title> "Preventing a Form from Resizing" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0124.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>In </b></font>some cases<font color="#000080">, </font>developers would want <font color="#FF0000"><b>to </b></font>create a regular window
<font color="#000080">(</font>Form<font color="#000080">) </font><font color="#FF0000"><b>in </b></font>Delphi that <font color="#FF0000"><b>contains </b></font>some <font color="#FF0000"><b>of </b></font>the characteristics <font color="#FF0000"><b>of </b></font>a
dialog box<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>they <font color="#FF0000"><b>do not </b></font>want <font color="#FF0000"><b>to </b></font>allow their users
<font color="#FF0000"><b>to </b></font>resize the form at runtime due <font color="#FF0000"><b>to </b></font>user <font color="#FF0000"><b>interface </b></font>design
issues<font color="#000080">.  </font>Other than creating the whole form <font color="#FF0000"><b>as </b></font>a dialog box<font color="#000080">,
</font>there <font color="#FF0000"><b>is not </b></font>a <font color="#FF0000"><b>property or </b></font>a method <font color="#FF0000"><b>to </b></font>handle this <font color="#FF0000"><b>in </b></font>a regular
window <font color="#FF0000"><b>in </b></font>Delphi<font color="#000080">.  </font>But due <font color="#FF0000"><b>to </b></font>the solid connection between Delphi
<font color="#FF0000"><b>and </b></font>the API layer<font color="#000080">, </font>developers can accomplish this easily<font color="#000080">.

</font>The following example demonstrates a way <font color="#FF0000"><b>of </b></font>handling the Windows
<font color="#FF0000"><b>message </b></font><font color="#000080">&quot;</font>WM_GetMinMaxInfo<font color="#000080">&quot; </font>which allows the developer <font color="#FF0000"><b>to </b></font>restrict
the size <font color="#FF0000"><b>of </b></font>windows <font color="#000080">(</font>forms<font color="#000080">) </font>at runtime <font color="#FF0000"><b>to </b></font>a specific value<font color="#000080">.  </font><font color="#FF0000"><b>In
</b></font>this <font color="#FF0000"><b>case</b></font><font color="#000080">, </font>it will be used <font color="#FF0000"><b>to </b></font>disable the functionality <font color="#FF0000"><b>of </b></font>sizing
the window <font color="#000080">(</font>form<font color="#000080">) </font>at runtime<font color="#000080">.

</font>Consider the following <font color="#FF0000"><b>unit</b></font><font color="#000080">:

</font><font color="#FF0000"><b>unit </b></font>getminmax<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font><font color="#FF0000"><b>procedure </b></font>WMGetMinMaxInfo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMGetMinMaxInfo<font color="#000080">);
              </font><font color="#FF0000"><b>message </b></font>WM_GETMINMAXINFO<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMInitMenuPopup<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMInitMenuPopup<font color="#000080">);
              </font><font color="#FF0000"><b>message </b></font>WM_INITMENUPOPUP<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>WMNCHitTest<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMNCHitTest<font color="#000080">);
              </font><font color="#FF0000"><b>message </b></font>WM_NCHitTest<font color="#000080">;
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

 </i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>WMGetMinMaxInfo<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMGetMinMaxInfo<font color="#000080">);
 </font><font color="#FF0000"><b>begin
     inherited</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>with </b></font>Msg<font color="#000080">.</font>MinMaxInfo<font color="#000080">^ </font><font color="#FF0000"><b>do
     begin
          </b></font>ptMinTrackSize<font color="#000080">.</font>x<font color="#000080">:= </font>form1<font color="#000080">.</font>width<font color="#000080">;
          </font>ptMaxTrackSize<font color="#000080">.</font>x<font color="#000080">:= </font>form1<font color="#000080">.</font>width<font color="#000080">;
          </font>ptMinTrackSize<font color="#000080">.</font>y<font color="#000080">:= </font>form1<font color="#000080">.</font>height<font color="#000080">;
          </font>ptMaxTrackSize<font color="#000080">.</font>y<font color="#000080">:= </font>form1<font color="#000080">.</font>height<font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>WMInitMenuPopup<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMInitMenuPopup<font color="#000080">);
 </font><font color="#FF0000"><b>begin
      inherited</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>if </b></font>Msg<font color="#000080">.</font>SystemMenu <font color="#FF0000"><b>then
         </b></font>EnableMenuItem<font color="#000080">(</font>Msg<font color="#000080">.</font>MenuPopup<font color="#000080">, </font>SC_SIZE<font color="#000080">, </font>MF_BYCOMMAND <font color="#FF0000"><b>or </b></font>MF_GRAYED<font color="#000080">)
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

 </font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>WMNCHitTest<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Msg<font color="#000080">: </font>TWMNCHitTest<font color="#000080">);
 </font><font color="#FF0000"><b>begin
      inherited</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>with </b></font>Msg <font color="#FF0000"><b>do
           if </b></font>Result <font color="#FF0000"><b>in </b></font><font color="#000080">[</font>HTLEFT<font color="#000080">, </font>HTRIGHT<font color="#000080">, </font>HTBOTTOM<font color="#000080">, </font>HTBOTTOMRIGHT<font color="#000080">,
                     </font>HTBOTTOMLEFT<font color="#000080">, </font>HTTOP<font color="#000080">, </font>HTTOPRIGHT<font color="#000080">, </font>HTTOPLEFT<font color="#000080">] </font><font color="#FF0000"><b>then
              </b></font>Result<font color="#000080">:= </font>HTNOWHERE
 <font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.  </font><font color="#008000"><i>{ End of Unit}

</i></font>A <font color="#FF0000"><b>message </b></font>handler <font color="#FF0000"><b>for </b></font>the windows <font color="#FF0000"><b>message </b></font><font color="#000080">&quot;</font>WM_GetMinMaxInfo<font color="#000080">&quot; </font><font color="#FF0000"><b>in
</b></font>the code above was used <font color="#FF0000"><b>to set </b></font>the minimum <font color="#FF0000"><b>and </b></font>maximum TrackSize
<font color="#FF0000"><b>of </b></font>the window <font color="#FF0000"><b>to </b></font>equal the width <font color="#FF0000"><b>and </b></font>height <font color="#FF0000"><b>of </b></font>the form at design
time<font color="#000080">.  </font>That was actually enough <font color="#FF0000"><b>to </b></font>disable the resizing <font color="#FF0000"><b>of </b></font>the
window <font color="#000080">(</font>form<font color="#000080">), </font>but the example went <font color="#FF0000"><b>on to </b></font>handle another couple
<font color="#FF0000"><b>of </b></font>messages just <font color="#FF0000"><b>to </b></font>make the application look professional<font color="#000080">.  </font>The
first <font color="#FF0000"><b>message </b></font>was the <font color="#000080">&quot;</font>WMInitMenuPopup<font color="#000080">&quot;  </font><font color="#FF0000"><b>and </b></font>that was <font color="#FF0000"><b>to </b></font>gray <font color="#FF0000"><b>out
</b></font>the size option from the System Menu so that the application does
<font color="#FF0000"><b>not </b></font>give the impression that this functionality <font color="#FF0000"><b>is </b></font>available<font color="#000080">.
</font>The second <font color="#FF0000"><b>message </b></font>was the <font color="#000080">&quot;</font>WMNCHitTest<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font>that was used <font color="#FF0000"><b>to
</b></font>disable the change <font color="#FF0000"><b>of </b></font>the cursor icon whenever the mouse goes
over one <font color="#FF0000"><b>of </b></font>the borders <font color="#FF0000"><b>of </b></font>the window <font color="#000080">(</font>form<font color="#000080">) </font><font color="#FF0000"><b>for </b></font>the same reason
which <font color="#FF0000"><b>is not to </b></font>give the impression that the resizing
functionality <font color="#FF0000"><b>is </b></font>available<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0124.PAS">Original</a><b>]</b></p></body>
</html>
