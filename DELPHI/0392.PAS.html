<html>
<head><title> "Re: details of a table" by BRUCE HEARDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0392.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt; </font>I would like <font color="#FF0000"><b>to </b></font>get the details <font color="#FF0000"><b>of </b></font>a table<font color="#800000">'s indexes and save the
</font><font color="#000080">&gt; </font>details <font color="#FF0000"><b>to </b></font>a  <font color="#FF0000"><b>file</b></font><font color="#000080">. </font>Could someone please advise <font color="#FF0000"><b>and </b></font>possibly please
<font color="#000080">&gt; </font>provide a snippet <font color="#FF0000"><b>of </b></font>code

Here <font color="#FF0000"><b>is </b></font>a bit <font color="#FF0000"><b>of </b></font>code from one <font color="#FF0000"><b>of </b></font>my apps<font color="#000080">.
</font>It walks through a table extracting all the index information <font color="#FF0000"><b>for </b></font>hat 
table<font color="#000080">, </font><font color="#FF0000"><b>and then </b></font>writes it <font color="#FF0000"><b>to </b></font>a ini <font color="#FF0000"><b>file</b></font><font color="#000080">, </font>so that I can read it back 
<font color="#FF0000"><b>in </b></font>later when the indexes become corrupted<font color="#000080">..

</font>Hope this helps<font color="#000080">..


</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>WriteIndexesToFile<font color="#000080">(</font>TN<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>begin
      with </b></font>Table1 <font color="#FF0000"><b>do
       begin
        </b></font>Close<font color="#000080">;
        </font>TableName <font color="#000080">:= </font>TN<font color="#000080">;
        </font>Exclusive <font color="#000080">:= </font>TRUE<font color="#000080">;
        </font>Open<font color="#000080">;
        </font>Indexdefs<font color="#000080">.</font>Update<font color="#000080">;
        </font>ini<font color="#000080">.</font>WriteInteger<font color="#000080">(</font>TN<font color="#000080">,</font><font color="#800000">'Num_Indexes'</font><font color="#000080">,</font>Indexdefs<font color="#000080">.</font>Count<font color="#000080">);
        </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>Indexdefs<font color="#000080">.</font>Count<font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
         begin
          </b></font>ini<font color="#000080">.</font>writeString<font color="#000080">(</font>TN<font color="#000080">,</font><font color="#800000">'Name_'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>i<font color="#000080">),</font>IndexDefs<font color="#000080">.</font>Items<font color="#000080">[
          </font>I<font color="#000080">].</font>Name<font color="#000080">);
          </font>ini<font color="#000080">.</font>writeString<font color="#000080">(</font>TN<font color="#000080">,</font><font color="#800000">'Fields_'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>i<font color="#000080">),</font>IndexDefs<font color="#000080">.</font>Item
          s<font color="#000080">[</font>I<font color="#000080">].</font>Fields<font color="#000080">); 
          </font>s1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
          </font>s1 <font color="#000080">:= </font>GetOptions <font color="#000080">(</font>IndexDefs<font color="#000080">.</font>items<font color="#000080">[</font>i<font color="#000080">].</font>Options<font color="#000080">); </font><font color="#008000"><i>{Converts 
the IndexDefs' options into a spintable string, so that can save them 
to file }
          </i></font>ini<font color="#000080">.</font>WriteString<font color="#000080">(</font>TN<font color="#000080">,</font><font color="#800000">'Options_'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>i<font color="#000080">),</font>s1<font color="#000080">);
         </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
        </font>close<font color="#000080">;
       </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0392.PAS">Original</a><b>]</b></p></body>
</html>
