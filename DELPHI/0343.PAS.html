<html>
<head><title> "Re: Search the Hard Disk" by JENS SCHUMANN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0343.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">the code below <font color="#FF0000"><b>is </b></font>searching <font color="#FF0000"><b>for </b></font>delphi<font color="#000080">.</font>exe<font color="#000080">. </font>Attention<font color="#000080">, </font>it<font color="#800000">'s possible that you
</font>need a bigger stacksize<font color="#000080">. </font><font color="#FF0000"><b>With </b></font>my HD <font color="#800000">2</font><font color="#000080">,</font><font color="#800000">5 </font>GByte <font color="#000080">/ </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">2 </font>GByte <font color="#FF0000"><b>is </b></font>used a stacksize <font color="#FF0000"><b>of
</b></font><font color="#800000">16384 </font>Byte <font color="#FF0000"><b>is </b></font>ok<font color="#000080">. </font>It<font color="#800000">'s dependent on the number of directories on your HD.

</font>Regards
<font color="#000080">:) </font>Jens
jensschumann<font color="#000080">@</font>t<font color="#000080">.</font>online<font color="#000080">.</font>de
http<font color="#000080">:</font><font color="#008000"><i>//home.t-online.de/home/jensschumann
</i></font>Germany<font color="#000080">/</font>Gerdau

<font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Label1<font color="#000080">: </font>TLabel<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private-Deklarationen }
    </i></font><font color="#FF0000"><b>procedure </b></font>ListFiles<font color="#000080">(</font>D<font color="#000080">,</font>Name<font color="#000080">,</font>SearchName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public-Deklarationen }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>ListFiles<font color="#000080">(</font><font color="#800000">'c:\'</font><font color="#000080">,</font><font color="#800000">'*.*'</font><font color="#000080">,</font><font color="#800000">'delphi.exe'</font><font color="#000080">); </font><font color="#008000"><i>{Searching for delphi.exe}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>ListFiles<font color="#000080">(</font>D<font color="#000080">,</font>Name<font color="#000080">,</font>SearchName <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
    </b></font>SR            <font color="#000080">: </font>TSearchRec<font color="#000080">;
</font><font color="#FF0000"><b>begin
  If </b></font>D<font color="#000080">[</font>Length<font color="#000080">(</font>D<font color="#000080">)]&lt;&gt;</font><font color="#800000">'\' </font><font color="#FF0000"><b>then
    </b></font>D<font color="#000080">:=</font>D<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FindFirst<font color="#000080">(</font>D<font color="#000080">+</font>Name<font color="#000080">,</font>faAnyFile<font color="#000080">,</font>SR<font color="#000080">)=</font><font color="#800000">0</font><font color="#FF0000"><b>then
    Repeat
      If </b></font><font color="#000080">(</font>SR<font color="#000080">.</font>Attr<font color="#000080">&lt;&gt;</font>faDirectory<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>SR<font color="#000080">.</font>Name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then
        If </b></font>AnsiUpperCase<font color="#000080">(</font>SR<font color="#000080">.</font>Name<font color="#000080">)=</font>AnsiUpperCase<font color="#000080">(</font>SearchName<font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>Label1<font color="#000080">.</font>Caption<font color="#000080">:=</font>D<font color="#000080">+</font>SR<font color="#000080">.</font>Name<font color="#000080">; </font><font color="#008000"><i>{If found then set label1.caption}
    </i></font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>FindNext<font color="#000080">(</font>SR<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
  </font>FindClose<font color="#000080">(</font>SR<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>FindFirst<font color="#000080">(</font>D<font color="#000080">+</font><font color="#800000">'*.*'</font><font color="#000080">,</font>faDirectory<font color="#000080">,</font>SR<font color="#000080">)=</font><font color="#800000">0 </font><font color="#FF0000"><b>then
    begin
      Repeat
        If </b></font><font color="#000080">((</font>Sr<font color="#000080">.</font>Attr <font color="#FF0000"><b>and </b></font>faDirectory<font color="#000080">)=</font>faDirectory<font color="#000080">) </font><font color="#FF0000"><b>and
            </b></font><font color="#000080">(</font>SR<font color="#000080">.</font>Name<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>then
          </b></font>ListFiles<font color="#000080">(</font>D<font color="#000080">+</font>SR<font color="#000080">.</font>Name<font color="#000080">+</font><font color="#800000">'\'</font><font color="#000080">,</font>Name<font color="#000080">,</font>SearchName<font color="#000080">);
      </font><font color="#FF0000"><b>Until </b></font><font color="#000080">(</font>FindNext<font color="#000080">(</font>SR<font color="#000080">)&lt;&gt;</font><font color="#800000">0</font><font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>FindClose<font color="#000080">(</font>SR<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0343.PAS">Original</a><b>]</b></p></body>
</html>
