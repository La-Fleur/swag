<html>
<head><title> "Determining the Cursor Position in Memo" by RANDY L. HABEN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0135.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
&gt; Is it possible to get the position of the cursor (lines and columns)
&gt; for a memo field. If not, is there a component somewhere that will
&gt; let me do this.

I had the same problem with an editor I wrote called TabNotes.  You can get this from:

 http://www.reusable.com

Anyway, here is how I got the info for a descendant of TMemo called TNotePad:

{The following two methods are used to get row/column coordinates.     }
{There are no messages that explicitly provide column information but the}
{EM_GETSEL message provides the position of the caret if a selection is  }
{not currently active. When text is selected the caret can be positioned at }
{the beginning or the end of the selection depending how it was selected.}
{Thus these methods may be slightly inaccurate while text is selected. }

</i></font><font color="#FF0000"><b>function  </b></font>TNotePad<font color="#000080">.</font>GetColumn<font color="#000080">: </font>SmallInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= (</font>SelStart<font color="#000080">+</font>SelLength<font color="#000080">) -        </font><font color="#008000"><i>{Assume that caret is at end of Selection}
            </i></font>Perform<font color="#000080">(</font>EM_LINEINDEX<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">); </font><font color="#008000"><i>{Method version of SendMessage}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function  </b></font>TNotePad<font color="#000080">.</font>GetRow<font color="#000080">: </font>SmallInt<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Result <font color="#000080">:= </font>LongRec<font color="#000080">(</font>Perform<font color="#000080">(</font>EM_LINEFROMCHAR<font color="#000080">, -</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">)).</font>Lo<font color="#000080">; </font><font color="#008000"><i>{Get Low word}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0135.PAS">Original</a><b>]</b></p></body>
</html>
