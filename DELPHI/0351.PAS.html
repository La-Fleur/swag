<html>
<head><title> "Equivalent of Trim$()" by JOSEPH BUI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0351.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">Solution <font color="#800000">2 
</font>From<font color="#000080">: </font>jbui<font color="#000080">@</font>scd<font color="#000080">.</font>hp<font color="#000080">.</font>com <font color="#000080">(</font>Joseph Bui<font color="#000080">)

</font><font color="#FF0000"><b>For </b></font>Mid<font color="#800000">$</font><font color="#000080">, </font>use Copy<font color="#000080">(</font>S<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">; </font>start<font color="#000080">, </font>length<font color="#000080">: </font>byte<font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">; 
</font>You can make copy perform Right<font color="#800000">$ </font><font color="#FF0000"><b>and </b></font>Left<font color="#800000">$ </font><font color="#FF0000"><b>as </b></font>well by doing<font color="#000080">:
</font>Copy<font color="#000080">(</font>S<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Length<font color="#000080">) </font><font color="#FF0000"><b>for </b></font>left<font color="#800000">$ </font><font color="#FF0000"><b>and 
</b></font>Copy<font color="#000080">(</font>S<font color="#000080">, </font>Start<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">) </font><font color="#FF0000"><b>for </b></font>right<font color="#800000">$
</font>Note<font color="#000080">: </font>Start <font color="#FF0000"><b>and </b></font>Length are the byte positions <font color="#FF0000"><b>of </b></font>your starting point<font color="#000080">, </font>get these <font color="#FF0000"><b>with </b></font>Pos<font color="#000080">().
</font>Here are some functions I wrote that come <font color="#FF0000"><b>in </b></font>handy <font color="#FF0000"><b>for </b></font>me<font color="#000080">. </font>Way down at the bottom <font color="#FF0000"><b>is </b></font>a trim<font color="#000080">() </font><font color="#FF0000"><b>function </b></font>that you can modify into TrimRight<font color="#800000">$ </font><font color="#FF0000"><b>and </b></font>TrimLeft<font color="#800000">$</font><font color="#000080">. </font>Also<font color="#000080">, </font>they all take <font color="#FF0000"><b>pascal </b></font>style strings<font color="#000080">, </font>but you can modify them <font color="#FF0000"><b>to </b></font>easily null terminated<font color="#000080">.



--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>const
   </b></font>BlackSpace <font color="#000080">= [</font><font color="#800000">#33</font><font color="#000080">..</font><font color="#800000">#126</font><font color="#000080">];

</font><font color="#008000"><i>{
   squish() returns a string with all whitespace not inside single
quotes deleted.
}
</i></font><font color="#FF0000"><b>function </b></font>squish<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Index<font color="#000080">: </font>byte<font color="#000080">;
   </font>InString<font color="#000080">: </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>InString<font color="#000080">:=</font>False<font color="#000080">;
   </font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
   </font><font color="#FF0000"><b>for </b></font>Index<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>Length<font color="#000080">(</font>Search<font color="#000080">) </font><font color="#FF0000"><b>do
   begin
      if </b></font>InString <font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Search<font color="#000080">[</font>Index<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>BlackSpace<font color="#000080">) </font><font color="#FF0000"><b>then
         </b></font>AppendStr<font color="#000080">(</font>Result<font color="#000080">, </font>Search<font color="#000080">[</font>Index<font color="#000080">]);
      </font>InString<font color="#000080">:=((</font>Search<font color="#000080">[</font>Index<font color="#000080">] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Search<font color="#000080">[</font>Index <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">] &lt;&gt; </font><font color="#800000">'\'</font><font color="#000080">))
            </font><font color="#FF0000"><b>xor </b></font>InString<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   before() returns everything before the first occurance of
Find in Search. If Find does not occur in Search, Search is
returned.
}
</i></font><font color="#FF0000"><b>function </b></font>before<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">, </font>Find<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>index<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>index<font color="#000080">:=</font>Pos<font color="#000080">(</font>Find<font color="#000080">, </font>Search<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>index <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Result<font color="#000080">:=</font>Search
   <font color="#FF0000"><b>else
      </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>Search<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>index <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   after() returns everything after the first occurance of
Find in Search. If Find does not occur in Search, a null
string is returned.
}
</i></font><font color="#FF0000"><b>function </b></font>after<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">, </font>Find<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>index<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>index<font color="#000080">:=</font>Pos<font color="#000080">(</font>Find<font color="#000080">, </font>Search<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font>index <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>then
      </b></font>Result<font color="#000080">:=</font><font color="#800000">''
   </font><font color="#FF0000"><b>else
      </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>Search<font color="#000080">, </font>index <font color="#000080">+ </font>Length<font color="#000080">(</font>Find<font color="#000080">), </font><font color="#800000">255</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   RPos() returns the index of the first character of the last
occurance of Find in Search. Returns 0 if Find does not occur
in Search. Like Pos() but searches in reverse.
}
</i></font><font color="#FF0000"><b>function </b></font>RPos<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Find<font color="#000080">, </font>Search<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>FindPtr<font color="#000080">, </font>SearchPtr<font color="#000080">, </font>TempPtr<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>FindPtr<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font>Length<font color="#000080">(</font>Find<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
   </font>SearchPtr<font color="#000080">:=</font>StrAlloc<font color="#000080">(</font>Length<font color="#000080">(</font>Search<font color="#000080">)+</font><font color="#800000">1</font><font color="#000080">);
   </font>StrPCopy<font color="#000080">(</font>FindPtr<font color="#000080">,</font>Find<font color="#000080">);
   </font>StrPCopy<font color="#000080">(</font>SearchPtr<font color="#000080">,</font>Search<font color="#000080">);
   </font>Result<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>repeat
      </b></font>TempPtr<font color="#000080">:=</font>StrRScan<font color="#000080">(</font>SearchPtr<font color="#000080">, </font>FindPtr<font color="#000080">^);
      </font><font color="#FF0000"><b>if </b></font>TempPtr <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil then
         if </b></font><font color="#000080">(</font>StrLComp<font color="#000080">(</font>TempPtr<font color="#000080">, </font>FindPtr<font color="#000080">, </font>Length<font color="#000080">(</font>Find<font color="#000080">)) = </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
         begin
            </b></font>Result<font color="#000080">:=</font>TempPtr <font color="#000080">- </font>SearchPtr <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
            </font>TempPtr<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>end
         else
            </b></font>TempPtr<font color="#000080">:=</font><font color="#800000">#0</font><font color="#000080">;
   </font><font color="#FF0000"><b>until </b></font>TempPtr <font color="#000080">= </font><font color="#FF0000"><b>nil</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   inside() returns the string between the most inside nested
Front ... Back pair.
}
</i></font><font color="#FF0000"><b>function </b></font>inside<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">, </font>Front<font color="#000080">, </font>Back<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Index<font color="#000080">, </font>Len<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Index<font color="#000080">:=</font>RPos<font color="#000080">(</font>Front<font color="#000080">, </font>before<font color="#000080">(</font>Search<font color="#000080">, </font>Back<font color="#000080">));
   </font>Len<font color="#000080">:=</font>Pos<font color="#000080">(</font>Back<font color="#000080">, </font>Search<font color="#000080">);
   </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>Index <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Len <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>then
      </b></font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>Search<font color="#000080">, </font>Index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">, </font>Len <font color="#000080">- (</font>Index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">))
   </font><font color="#FF0000"><b>else
      </b></font>Result<font color="#000080">:=</font><font color="#800000">''</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   leftside() returns what is to the left of inside() or Search.
}
</i></font><font color="#FF0000"><b>function </b></font>leftside<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">, </font>Front<font color="#000080">, </font>Back<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Result<font color="#000080">:=</font>before<font color="#000080">(</font>Search<font color="#000080">, </font>Front <font color="#000080">+ </font>inside<font color="#000080">(</font>Search<font color="#000080">, </font>Front<font color="#000080">, </font>Back<font color="#000080">) + </font>Back<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   rightside() returns what is to the right of inside() or Null.
}
</i></font><font color="#FF0000"><b>function </b></font>rightside<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">, </font>Front<font color="#000080">, </font>Back<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Result<font color="#000080">:=</font>after<font color="#000080">(</font>Search<font color="#000080">, </font>Front <font color="#000080">+ </font>inside<font color="#000080">(</font>Search<font color="#000080">, </font>Front<font color="#000080">, </font>Back<font color="#000080">) + </font>Back<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#008000"><i>{
   trim() returns a string with all right and left whitespace removed.
}
</i></font><font color="#FF0000"><b>function </b></font>trim<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Search<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>Index<font color="#000080">: </font>byte<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Index<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Index <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Search<font color="#000080">)) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>Search<font color="#000080">[</font>Index<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>BlackSpace<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>Index<font color="#000080">:=</font>Index <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>Search<font color="#000080">, </font>Index<font color="#000080">, </font><font color="#800000">255</font><font color="#000080">);
   </font>Index<font color="#000080">:=</font>Length<font color="#000080">(</font>Result<font color="#000080">);
   </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>Index <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>and not </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>Index<font color="#000080">] </font><font color="#FF0000"><b>in </b></font>BlackSpace<font color="#000080">) </font><font color="#FF0000"><b>do
      </b></font>Index<font color="#000080">:=</font>Index <font color="#000080">- </font><font color="#800000">1</font><font color="#000080">;
   </font>Result<font color="#000080">:=</font>Copy<font color="#000080">(</font>Result<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>Index<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0351.PAS">Original</a><b>]</b></p></body>
</html>
