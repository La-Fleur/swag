<html>
<head><title> "Capitalize the first letter of each word" by VARIOUS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0355.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Erik Sperling Johansen <font color="#000080">&lt;</font>erik<font color="#000080">@</font>info<font color="#000080">-</font>pro<font color="#000080">.</font>no<font color="#000080">&gt;
--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>function </b></font>LowCase<font color="#000080">(</font>ch <font color="#000080">: </font>CHAR<font color="#000080">) : </font>CHAR<font color="#000080">;
</font><font color="#FF0000"><b>begin
  case </b></font>ch <font color="#FF0000"><b>of
    </b></font><font color="#800000">'A'</font><font color="#000080">..</font><font color="#800000">'Z' </font><font color="#000080">: </font>LowCase <font color="#000080">:= </font>CHR <font color="#000080">(</font>ORD<font color="#000080">(</font>ch<font color="#000080">)+</font><font color="#800000">31</font><font color="#000080">);
  </font><font color="#FF0000"><b>else
    </b></font>LowCase <font color="#000080">:= </font>ch<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Proper <font color="#000080">(</font>source<font color="#000080">, </font>separators <font color="#000080">: </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">) : </font><font color="#FF0000"><b>STRING</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>LastWasSeparator <font color="#000080">: </font>BOOLEAN<font color="#000080">;
  </font>ndx              <font color="#000080">: </font>INTEGER<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LastWasSeparator <font color="#000080">:= </font>TRUE<font color="#000080">;  
  </font>ndx <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>while </b></font><font color="#000080">(</font>ndx<font color="#000080">&lt;=</font>Length<font color="#000080">(</font>source<font color="#000080">)) </font><font color="#FF0000"><b>do begin
    if </b></font>LastWasSeparator
    <font color="#FF0000"><b>then </b></font>source<font color="#000080">[</font>ndx<font color="#000080">] := </font>UpCase<font color="#000080">(</font>source<font color="#000080">[</font>ndx<font color="#000080">])
    </font><font color="#FF0000"><b>else </b></font>source<font color="#000080">[</font>ndx<font color="#000080">] := </font>LowCase<font color="#000080">(</font>source<font color="#000080">[</font>ndx<font color="#000080">]);
    </font>LastWasSeparator <font color="#000080">:= </font>Pos<font color="#000080">(</font>source<font color="#000080">[</font>ndx<font color="#000080">], </font>separators<font color="#000080">)&gt;</font><font color="#800000">0</font><font color="#000080">;
    </font>inc<font color="#000080">(</font>ndx<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>source<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------

</font>From<font color="#000080">: &quot;</font>Cleon T<font color="#000080">. </font>Bailey<font color="#000080">&quot; &lt;</font>baileyct<font color="#000080">@</font>ionet<font color="#000080">.</font>net<font color="#000080">&gt;
--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>Function  </b></font>TfrmLoadProtocolTable<font color="#000080">.</font>ToMixCase<font color="#000080">(</font>InString<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Var </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>Result <font color="#000080">:= </font>LowerCase<font color="#000080">(</font>InString<font color="#000080">);
  </font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] := </font>UpCase<font color="#000080">(</font>Result<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>InString<font color="#000080">) - </font><font color="#800000">1 </font><font color="#FF0000"><b>Do Begin
    If </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">' '</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">''''</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'&quot;'</font><font color="#000080">)
    </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'-'</font><font color="#000080">) </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'.'</font><font color="#000080">)  </font><font color="#FF0000"><b>Or </b></font><font color="#000080">(</font>Result<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'('</font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Result<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">] := </font>UpCase<font color="#000080">(</font>Result<font color="#000080">[</font>I <font color="#000080">+ </font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

--------------------------------------------------------------------------------

</font>From<font color="#000080">: &quot;</font>Paul Motyer<font color="#000080">&quot; &lt;</font>paulm<font color="#000080">@</font>linuxserver<font color="#000080">.</font>pccity<font color="#000080">.</font>com<font color="#000080">.</font>au<font color="#000080">&gt;

</font>Both Tim Stannard<font color="#800000">'s and Cleon T. Bailey'</font>s functions will bomb <font color="#FF0000"><b>in </b></font>D2 <font color="#FF0000"><b>if </b></font>sent an empty <font color="#FF0000"><b>string </b></font><font color="#000080">(</font>where accessing InString<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">] </font>causes an access violation<font color="#000080">, </font>the second attempt will <font color="#FF0000"><b>do </b></font>the same <font color="#FF0000"><b>if </b></font>the last character <font color="#FF0000"><b>is in </b></font>the <font color="#FF0000"><b>set</b></font><font color="#000080">.
</font><font color="#FF0000"><b>try </b></font>this instead<font color="#000080">:
--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>function </b></font>proper<font color="#000080">(</font>s<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">):</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>t<font color="#000080">:</font><font color="#FF0000"><b>string</b></font><font color="#000080">;
    </font>i<font color="#000080">:</font>integer<font color="#000080">;
    </font>newWord<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
if </b></font>s<font color="#000080">=</font><font color="#800000">'' </font><font color="#FF0000"><b>then </b></font>exit<font color="#000080">;
</font>s<font color="#000080">:=</font>lowercase<font color="#000080">(</font>s<font color="#000080">);
</font>t<font color="#000080">:=</font>uppercase<font color="#000080">(</font>s<font color="#000080">);
</font>newWord<font color="#000080">:=</font>true<font color="#000080">;
</font><font color="#FF0000"><b>for </b></font>i<font color="#000080">:=</font><font color="#800000">1 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>s<font color="#000080">) </font><font color="#FF0000"><b>do
    begin
    if </b></font>newWord <font color="#FF0000"><b>and </b></font><font color="#000080">(</font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">]) </font><font color="#FF0000"><b>then
       begin </b></font>s<font color="#000080">[</font>i<font color="#000080">]:=</font>t<font color="#000080">[</font>i<font color="#000080">]; </font>newWord<font color="#000080">:=</font>false<font color="#000080">; </font>continue<font color="#000080">; </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>s<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>in </b></font><font color="#000080">[</font><font color="#800000">'a'</font><font color="#000080">..</font><font color="#800000">'z'</font><font color="#000080">,</font><font color="#800000">''''</font><font color="#000080">] </font><font color="#FF0000"><b>then </b></font>continue<font color="#000080">;
    </font>newWord<font color="#000080">:=</font>true<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>result<font color="#000080">:=</font>s<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0355.PAS">Original</a><b>]</b></p></body>
</html>
