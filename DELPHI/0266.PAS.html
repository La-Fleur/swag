<html>
<head><title> "Setting Windows wallpaper revisited" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0266.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000080">--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>uses
  </b></font>Registry<font color="#000080">, </font>WinProcs<font color="#000080">, </font>SysUtils<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font><font color="#008000"><i>// WallPaperStyles
  </i></font>WPS_Tile      <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>WPS_Center    <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>WPS_SizeToFit <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>WPS_XY        <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;

</font><font color="#008000"><i>//
// sWallpaperBMPPath
//   - path to a BMP file
//
// nStyle
//   - any of the above WallPaperStyles
//
// nX, nY
//   - if the nStyle is set to WPS_XY,
//     nX and nY can be used to set the
//     exact position of the wall paper
//
</i></font><font color="#FF0000"><b>procedure </b></font>SetWallpaperExt<font color="#000080">(
  </font>sWallpaperBMPPath <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>nStyle<font color="#000080">,
  </font>nX<font color="#000080">, </font>nY <font color="#000080">: </font>integer <font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>reg    <font color="#000080">: </font>TRegIniFile<font color="#000080">;
  </font>s1     <font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>X<font color="#000080">, </font>Y   <font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>//
  // change registry
  //
  // HKEY_CURRENT_USER\
  //   Control Panel\Desktop
  //     TileWallpaper (REG_SZ)
  //     Wallpaper (REG_SZ)
  //     WallpaperStyle (REG_SZ)
  //     WallpaperOriginX (REG_SZ)
  //     WallpaperOriginY (REG_SZ)
  //
  </i></font>reg <font color="#000080">:= </font>TRegIniFile<font color="#000080">.</font>Create<font color="#000080">(
           </font><font color="#800000">'Control Panel\Desktop' </font><font color="#000080">);

  </font><font color="#FF0000"><b>with </b></font>reg <font color="#FF0000"><b>do
  begin
    </b></font>s1 <font color="#000080">:= </font><font color="#800000">'0'</font><font color="#000080">;
    </font>X  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
    </font>Y  <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

    </font><font color="#FF0000"><b>case </b></font>nStyle <font color="#FF0000"><b>of
      </b></font>WPS_Tile  <font color="#000080">: </font>s1 <font color="#000080">:= </font><font color="#800000">'1'</font><font color="#000080">;
      </font>WPS_Center<font color="#000080">: </font>nStyle <font color="#000080">:= </font>WPS_Tile<font color="#000080">;
      </font>WPS_XY    <font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>nStyle <font color="#000080">:= </font>WPS_Tile<font color="#000080">;
        </font>X <font color="#000080">:= </font>nX<font color="#000080">;
        </font>Y <font color="#000080">:= </font>nY<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>WriteString<font color="#000080">( </font><font color="#800000">''</font><font color="#000080">,
      </font><font color="#800000">'Wallpaper'</font><font color="#000080">,
      </font>sWallpaperBMPPath <font color="#000080">);

    </font>WriteString<font color="#000080">( </font><font color="#800000">''</font><font color="#000080">,
      </font><font color="#800000">'TileWallpaper'</font><font color="#000080">,
      </font>s1 <font color="#000080">);

    </font>WriteString<font color="#000080">( </font><font color="#800000">''</font><font color="#000080">,
      </font><font color="#800000">'WallpaperStyle'</font><font color="#000080">,
      </font>IntToStr<font color="#000080">( </font>nStyle <font color="#000080">) );

    </font>WriteString<font color="#000080">( </font><font color="#800000">''</font><font color="#000080">,
      </font><font color="#800000">'WallpaperOriginX'</font><font color="#000080">,
      </font>IntToStr<font color="#000080">( </font>X <font color="#000080">) );

    </font>WriteString<font color="#000080">( </font><font color="#800000">''</font><font color="#000080">,
      </font><font color="#800000">'WallpaperOriginY'</font><font color="#000080">,
      </font>IntToStr<font color="#000080">( </font>Y <font color="#000080">) );
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>reg<font color="#000080">.</font>Free<font color="#000080">;

  </font><font color="#008000"><i>//
  // let everyone know that we
  // changed a system parameter
  //
  </i></font>SystemParametersInfo<font color="#000080">(
    </font>SPI_SETDESKWALLPAPER<font color="#000080">,
    </font><font color="#800000">0</font><font color="#000080">,
    </font><font color="#FF0000"><b>Nil</b></font><font color="#000080">,
    </font>SPIF_SENDWININICHANGE <font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>Here are two examples <font color="#FF0000"><b>on </b></font>how <font color="#FF0000"><b>to </b></font>call the above SetWallpaperExt<font color="#000080">() </font><font color="#FF0000"><b>function</b></font><font color="#000080">.

  </font><font color="#008000"><i>// set wallpaper to winnt.bmp and
  // stretch it to fit the screen
  </i></font>SetWallpaperExt<font color="#000080">(
    </font><font color="#800000">'c:\winnt\winnt.bmp'</font><font color="#000080">,
    </font>WPS_SizeToFit<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0 </font><font color="#000080">);

  </font><font color="#008000"><i>// set the wallpaper origin
  // to (10, 200)
  </i></font>SetWallpaperExt<font color="#000080">(
    </font><font color="#800000">'c:\winnt\winnt.bmp'</font><font color="#000080">,
    </font>WPS_XY<font color="#000080">, </font><font color="#800000">10</font><font color="#000080">, </font><font color="#800000">200 </font><font color="#000080">);


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0266.PAS">Original</a><b>]</b></p></body>
</html>
