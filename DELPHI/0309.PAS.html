<html>
<head><title> "Print direct to printer" by JAVIER CELUCE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0309.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">A two months ago Gareet Wilson answer this question <font color="#FF0000"><b>and </b></font>I tested that work
fine<font color="#000080">...

</font>The best way I have found <font color="#FF0000"><b>is to do </b></font>the following<font color="#000080">, </font>which <font color="#FF0000"><b>uses </b></font>the Windows
printing routines<font color="#000080">, </font>but sends data directly <font color="#FF0000"><b>to </b></font>the printer <font color="#000080">(</font>you may have
<font color="#FF0000"><b>to </b></font>changes things around<font color="#000080">, </font>but this <font color="#FF0000"><b>is </b></font>a good outline<font color="#000080">}. </font>I figured <font color="#FF0000"><b>out </b></font>a
lot <font color="#FF0000"><b>of </b></font>this from <font color="#000080">&quot;</font>Three Printing Techniques <font color="#FF0000"><b>for </b></font>Windows <font color="#800000">95 </font>Console
Applications<font color="#000080">,&quot; </font>by David Tamashiro <font color="#FF0000"><b>in </b></font>the C<font color="#000080">/</font>C<font color="#000080">++ </font>User<font color="#800000">'s Journal, January
1997.

</font><font color="#000080">**</font>First<font color="#000080">, </font>include the following<font color="#000080">:

</font><font color="#FF0000"><b>var
  </b></font>PrinterHandle<font color="#000080">:</font>THandle<font color="#000080">;  </font><font color="#008000"><i>{the handle to the printer}

</i></font><font color="#FF0000"><b>uses </b></font>WinSpool<font color="#000080">, </font>Printers<font color="#000080">;

</font><font color="#FF0000"><b>type </b></font>TDocInfo1<font color="#000080">=</font><font color="#FF0000"><b>packed record </b></font><font color="#008000"><i>{the replacement for DOC_INFO_1}
  </i></font>lpszDocName<font color="#000080">: </font>PAnsiChar<font color="#000080">;
  </font>lpszOutputFile<font color="#000080">: </font>PAnsiChar<font color="#000080">;
  </font>lpszDatatype<font color="#000080">: </font>PAnsiChar<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

**</font><font color="#FF0000"><b>Then</b></font><font color="#000080">, </font>open a printer according <font color="#FF0000"><b>to </b></font>its name<font color="#000080">:

</font><font color="#FF0000"><b>var
  </b></font>CTitle<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">31</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>CMode<font color="#000080">:</font><font color="#FF0000"><b>array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">4</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>Char<font color="#000080">;
  </font>DocInfo<font color="#000080">:</font>TDocInfo1<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>StrPLopy<font color="#000080">(</font>CTitle<font color="#000080">, </font><font color="#800000">'My Title'</font><font color="#000080">); </font><font color="#008000"><i>{setup our title buffer}
  </i></font>StrPCopy<font color="#000080">(</font>CMode<font color="#000080">, </font><font color="#800000">'RAW'</font><font color="#000080">); </font><font color="#008000"><i>{put &quot;RAW&quot; in our mode buffer}
  </i></font>FillChar<font color="#000080">(</font>DocInfo<font color="#000080">, </font>SizeOf<font color="#000080">(</font>DocInfo<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);  </font><font color="#008000"><i>{fill the DocInfo structure
with zero's}
  </i></font><font color="#FF0000"><b>with </b></font>DocInfo <font color="#FF0000"><b>do
  begin
    </b></font>lpszDocName<font color="#000080">:=</font>CTitle<font color="#000080">;  </font><font color="#008000"><i>{set the title of our document}
    </i></font>lpszOutputFile<font color="#000080">:=</font><font color="#FF0000"><b>nil</b></font><font color="#000080">;  </font><font color="#008000"><i>{specify no output file}
    </i></font>lpszDatatype<font color="#000080">:=</font>CMode<font color="#000080">;  </font><font color="#008000"><i>{set the mode, which we have specified as
&quot;RAW&quot;}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>OpenPrinter<font color="#000080">(</font><font color="#800000">'Printer Name Here'</font><font color="#000080">, </font>PrinterHandle<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
  </font>StartDocPrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, @</font>DocInfo<font color="#000080">);
  </font>StartPagePrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">);


**</font>Now<font color="#000080">, </font>print your text<font color="#000080">:

</font><font color="#FF0000"><b>var
  </b></font>Count<font color="#000080">:</font>DWord<font color="#000080">; </font><font color="#008000"><i>{the number of bytes written}
</i></font><font color="#FF0000"><b>begin
  </b></font>WritePrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">, </font>PChar<font color="#000080">(</font>printText<font color="#000080">), </font>Length<font color="#000080">(</font>printText<font color="#000080">),
</font>Count<font color="#000080">);


**</font>When you are finished printing<font color="#000080">, </font>tidy things up<font color="#000080">:

  </font>EndPagePrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">);  </font><font color="#008000"><i>{end the page}
  </i></font>EndDocPrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">); </font><font color="#008000"><i>{end the document}
  </i></font><font color="#FF0000"><b>if </b></font>PrinterHandle<font color="#000080">&lt;&gt;</font><font color="#800000">0 </font><font color="#FF0000"><b>then  </b></font><font color="#008000"><i>{if we have a printer handle}
  </i></font><font color="#FF0000"><b>begin
    </b></font>ClosePrinter<font color="#000080">(</font>PrinterHandle<font color="#000080">);  </font><font color="#008000"><i>{close the printer}
    </i></font>PrinterHandle<font color="#000080">:=</font><font color="#800000">0</font><font color="#000080">; </font><font color="#008000"><i>{show that we have closed the printer}
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>I think that about covers it<font color="#000080">. </font>Hope this helps<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0309.PAS">Original</a><b>]</b></p></body>
</html>
