<html>
<head><title> "Re: Rotating Text" by DAVID S. BECKER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0229.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Try </b></font>the following <font color="#FF0000"><b>function</b></font><font color="#000080">.  </font>I don<font color="#800000">'t remember where I got it from, but it
</font>works well<font color="#000080">!  </font>The only thing <font color="#FF0000"><b>to </b></font>remember here <font color="#FF0000"><b>is </b></font>the parameter <font color="#800000">'d' </font><font color="#FF0000"><b>is in
</b></font>tenths <font color="#FF0000"><b>of </b></font>a degree<font color="#000080">.  </font>So<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>you want <font color="#FF0000"><b>to </b></font>rotate the text <font color="#800000">45 </font>degrees<font color="#000080">, </font><font color="#800000">'d'
</font>should be <font color="#800000">450.  </font>Sorry <font color="#FF0000"><b>for </b></font>the funny wrapping<font color="#000080">, </font>I<font color="#800000">'m sure you can figure it
</font><font color="#FF0000"><b>out</b></font><font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>CanvasTextOutAngle<font color="#000080">(</font>c<font color="#000080">: </font>TCanvas<font color="#000080">; </font>x<font color="#000080">,</font>y<font color="#000080">: </font>Integer<font color="#000080">; </font>d<font color="#000080">: </font>Word<font color="#000080">; </font>s<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>LogRec<font color="#000080">: </font>TLOGFONT<font color="#000080">;     </font><font color="#008000"><i>{* Storage area for font information *}
  </i></font>OldFontHandle<font color="#000080">,        </font><font color="#008000"><i>{* The old font handle *}
  </i></font>NewFontHandle<font color="#000080">: </font>HFONT<font color="#000080">; </font><font color="#008000"><i>{* Temporary font handle *}
</i></font><font color="#FF0000"><b>begin
  if </b></font>Application<font color="#000080">.</font>Terminated <font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
  </font><font color="#008000"><i>{* Get the current font information. We only want to modify the angle *}
  </i></font>GetObject<font color="#000080">(</font>c<font color="#000080">.</font>Font<font color="#000080">.</font>Handle<font color="#000080">, </font>SizeOf<font color="#000080">(</font>LogRec<font color="#000080">), </font>Addr<font color="#000080">(</font>LogRec<font color="#000080">));
  </font><font color="#008000"><i>{* Modify the angle. &quot;The angle, in tenths of a degrees, between the base
     line of a character and the x-axis.&quot; (Windows API Help file.)*}
  </i></font>LogRec<font color="#000080">.</font>lfEscapement <font color="#000080">:= </font>d<font color="#000080">;
  </font><font color="#008000"><i>{* Create a new font handle using the modified old font handle *}
  </i></font>NewFontHandle <font color="#000080">:= </font>CreateFontIndirect<font color="#000080">(</font>LogRec<font color="#000080">);
  </font><font color="#008000"><i>{* Save the old font handle! We have to put it back when we are done! *}
  </i></font>OldFontHandle <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>c<font color="#000080">.</font>Handle<font color="#000080">,</font>NewFontHandle<font color="#000080">);
  </font><font color="#008000"><i>{* Finally. Output the text! *}
  </i></font>c<font color="#000080">.</font>Brush<font color="#000080">.</font>Style <font color="#000080">:= </font>bsClear<font color="#000080">;
  </font>c<font color="#000080">.</font>TextOut<font color="#000080">(</font>x<font color="#000080">,</font>y<font color="#000080">,</font>s<font color="#000080">);
  </font><font color="#008000"><i>{* Put the font back the way we found it! *}
  </i></font>NewFontHandle <font color="#000080">:= </font>SelectObject<font color="#000080">(</font>c<font color="#000080">.</font>Handle<font color="#000080">,</font>OldFontHandle<font color="#000080">);
  </font><font color="#008000"><i>{* Delete the temporary (NewFontHandle) that we created *}
  </i></font>DeleteObject<font color="#000080">(</font>NewFontHandle<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{* CanvasTextOutAngle *}

</i></font><font color="#000080">--
</font>David S<font color="#000080">. </font>Becker
ADP Dealer Services <font color="#000080">(</font>Plaza R<font color="#000080">&amp;</font>D<font color="#000080">)
</font>dsb<font color="#000080">@</font>plaza<font color="#000080">.</font>ds<font color="#000080">.</font>adp<font color="#000080">.</font>com
<font color="#000080">(</font><font color="#800000">503</font><font color="#000080">)</font><font color="#800000">402</font><font color="#000080">-</font><font color="#800000">3236

</font>Stephen Gould <font color="#000080">&lt;</font>sgould<font color="#000080">@</font>extro<font color="#000080">.</font>ucc<font color="#000080">.</font>su<font color="#000080">.</font>OZ<font color="#000080">.</font>AU<font color="#000080">&gt; </font>wrote <font color="#FF0000"><b>in </b></font>article
<font color="#000080">&lt;</font><font color="#800000">59</font>tup1<font color="#800000">$1</font>i9<font color="#000080">@</font>metro<font color="#000080">.</font>ucc<font color="#000080">.</font>su<font color="#000080">.</font>OZ<font color="#000080">.</font>AU<font color="#000080">&gt;...
&gt; </font>Hi<font color="#000080">,
&gt; 
&gt; </font>Does anyone know <font color="#FF0000"><b>of </b></font>a good way <font color="#FF0000"><b>to </b></font>rotate text <font color="#FF0000"><b>and </b></font>display it <font color="#FF0000"><b>in </b></font>a 
<font color="#000080">&gt; </font>PaintBox<font color="#000080">. </font>At the moment I am creating a TCanvas <font color="#FF0000"><b>object in </b></font>memory<font color="#000080">, </font>drawing

<font color="#000080">&gt; </font>the text <font color="#FF0000"><b>on </b></font>it<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>rotating the whole canvas <font color="#FF0000"><b>and </b></font>dumping it <font color="#FF0000"><b>in </b></font>the 
<font color="#000080">&gt; </font>paintbox<font color="#000080">. </font><font color="#FF0000"><b>Is </b></font>there a better way<font color="#000080">? </font>The text comes <font color="#FF0000"><b>out </b></font>looking pretty bad<font color="#000080">.
&gt; 
&gt; </font>Steve<font color="#000080">.
&gt; </font>gouldy<font color="#000080">@</font>mad<font color="#000080">.</font>scientist<font color="#000080">.</font>com
<font color="#000080">&gt;
&gt;</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0229.PAS">Original</a><b>]</b></p></body>
</html>
