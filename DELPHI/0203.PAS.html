<html>
<head><title> "Delphi Components Writing" by JOHN M. MIANO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0203.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">I notices that the Delphi FAQ has <font color="#FF0000"><b>not </b></font>been updated <font color="#FF0000"><b>in </b></font>over a year<font color="#000080">.  </font>Since much 
<font color="#FF0000"><b>of </b></font>the information needed <font color="#FF0000"><b>to </b></font>write Delphi components <font color="#FF0000"><b>is </b></font>undocumented I thought 
that maybe there should be a component writing FAQ<font color="#000080">.

</font>I have been going through some <font color="#FF0000"><b>of </b></font>my source code <font color="#FF0000"><b>to </b></font>get some <font color="#FF0000"><b>of </b></font>the tricks 
that I have had <font color="#FF0000"><b>to </b></font>use <font color="#FF0000"><b>in </b></font>writing components<font color="#000080">.  </font>I am going through my mail <font color="#FF0000"><b>to 
</b></font>see what tricks people have sent me <font color="#FF0000"><b>and </b></font>I will attempt <font color="#FF0000"><b>to </b></font>give credit <font color="#FF0000"><b>to </b></font>those 
who have mailed me information<font color="#000080">.

</font>Right now this document <font color="#FF0000"><b>is </b></font>short but hopefully it will grow over time<font color="#000080">.  </font>Some 
<font color="#FF0000"><b>of </b></font>the information enclose has never been <font color="#FF0000"><b>published</b></font><font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you have 
something <font color="#FF0000"><b>to </b></font>contribute <font color="#FF0000"><b>or </b></font>suggestions <font color="#FF0000"><b>then </b></font>mail them <font color="#FF0000"><b>to </b></font>me<font color="#000080">.

</font>So hear goes<font color="#000080">......


</font>The Unofficial Delphi Component Writing FAQ

Maintainer<font color="#000080">:     </font>John M<font color="#000080">. </font>Miano   miano<font color="#000080">@</font>worldnet<font color="#000080">.</font>att<font color="#000080">.</font>net
Version<font color="#000080">:        </font><font color="#800000">1
</font>Last Updated<font color="#000080">:   </font><font color="#800000">30</font><font color="#000080">-</font>Aug<font color="#000080">-</font><font color="#800000">96

</font><font color="#000080">------------------------------------------------------------------------
</font>Table <font color="#FF0000"><b>of </b></font>Contents

Section <font color="#800000">1 </font><font color="#000080">- </font>Introduction
<font color="#800000">1.1. </font>What <font color="#FF0000"><b>is </b></font>the purpose <font color="#FF0000"><b>of </b></font>this document<font color="#000080">?

</font>Section <font color="#800000">2 </font><font color="#000080">- </font>IDE 
<font color="#800000">2.1. </font>How can I locate problems the result when my component <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>in </b></font>the 
IDE<font color="#000080">?
</font><font color="#800000">2.2. </font>How <font color="#FF0000"><b>do </b></font>I view assembly langugage the Delphi Generates<font color="#000080">?
</font><font color="#800000">2.3. </font>I can create my control at run time but it crashes at design time<font color="#000080">.  </font>What 
<font color="#FF0000"><b>is </b></font>wrong<font color="#000080">?
</font><font color="#800000">2.4. </font>How can I make my control work only <font color="#FF0000"><b>in </b></font>design mode<font color="#000080">?

</font>Section <font color="#800000">3 </font><font color="#000080">- </font>Using other components within a component
<font color="#800000">3.1. </font>How can I add a scroll bar component <font color="#FF0000"><b>to </b></font>my component <font color="#FF0000"><b>and </b></font>have it work at
<font color="#FF0000"><b>in </b></font>design mode<font color="#000080">?
</font><font color="#800000">3.2. </font>How <font color="#FF0000"><b>do </b></font>I create a Windows <font color="#800000">'95-style scroll bar?

</font>Section <font color="#800000">4 </font><font color="#000080">- </font>Bound Controls
<font color="#800000">4.1. </font>Where <font color="#FF0000"><b>is </b></font>the documentation <font color="#FF0000"><b>for </b></font>the TDataLink <font color="#FF0000"><b>class</b></font><font color="#000080">?

</font>Section <font color="#800000">5 </font><font color="#000080">- </font>VCL
<font color="#800000">5.1. </font>How can I step through the VCL source <font color="#FF0000"><b>while </b></font>debugging

Section <font color="#800000">6 </font><font color="#000080">- </font>Other Sources <font color="#FF0000"><b>of </b></font>Information
<font color="#800000">6.1. </font>Are there any books one how <font color="#FF0000"><b>to </b></font>write Delphi components<font color="#000080">?

</font>Section <font color="#800000">7 </font><font color="#000080">- </font>Persistant Objects
<font color="#800000">7.1. </font>How can I save a complex <font color="#FF0000"><b>object </b></font>containing child objects <font color="#FF0000"><b>to </b></font>the <font color="#000080">.</font>DFM 
<font color="#FF0000"><b>file</b></font><font color="#000080">.

------------------------------------------------------------------------
</font>Section <font color="#800000">1 </font><font color="#000080">- </font>Introductions

<font color="#800000">1.1. </font>What <font color="#FF0000"><b>is </b></font>the purpose <font color="#FF0000"><b>of </b></font>this document<font color="#000080">?

</font>The purpose <font color="#FF0000"><b>of </b></font>this document <font color="#FF0000"><b>is to </b></font>answer common <font color="#FF0000"><b>or </b></font>undocumented questions
related <font color="#FF0000"><b>to </b></font>writing Delphi components<font color="#000080">.  </font>This information <font color="#FF0000"><b>is </b></font>provided <font color="#FF0000"><b>as is</b></font><font color="#000080">.  
</font>There are no guarentee <font color="#FF0000"><b>as to </b></font>its correctness<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>you find error <font color="#FF0000"><b>or </b></font>ommissions 
sent them <font color="#FF0000"><b>to </b></font>the author<font color="#000080">.

</font>This document <font color="#FF0000"><b>is </b></font>rather short at the moment but hopefully it will grow over 
time<font color="#000080">.

------------------------------------------------------------------------
</font>Section <font color="#800000">2 </font><font color="#000080">- </font>IDE Problems

<font color="#800000">2.1. </font>How can I locate problems the result when my component <font color="#FF0000"><b>is </b></font>used <font color="#FF0000"><b>in </b></font>the 
IDE<font color="#000080">?

</font>The only solution <font color="#FF0000"><b>to </b></font>locating problems I have found it <font color="#FF0000"><b>to</b></font><font color="#000080">:

</font><font color="#800000">1. </font><font color="#FF0000"><b>In </b></font>Delphi go <font color="#FF0000"><b>to </b></font>Tools<font color="#000080">/</font>Options <font color="#FF0000"><b>then </b></font>go <font color="#FF0000"><b>to </b></font>the <font color="#000080">&quot;</font><font color="#FF0000"><b>Library</b></font><font color="#000080">&quot; </font>page<font color="#000080">.
</font>Check the <font color="#000080">&quot;</font>Compile <font color="#FF0000"><b>With </b></font>Debug Info<font color="#000080">&quot; </font>box<font color="#000080">.
</font><font color="#800000">2. </font>Rebuild the <font color="#FF0000"><b>library</b></font><font color="#000080">.
</font><font color="#800000">3. </font>Run Delphi from within Turbo Debugger<font color="#000080">.

</font><font color="#FF0000"><b>If </b></font>you get a GPF you can use view the stack <font color="#FF0000"><b>and </b></font>get some idea where the 
problem <font color="#FF0000"><b>is </b></font>occuring<font color="#000080">.

</font><font color="#800000">2.2. </font>How <font color="#FF0000"><b>do </b></font>I view assembly langugage the Delphi Generates<font color="#000080">?

</font>From Glen Boyd

Borland<font color="#000080">/</font>Delphi<font color="#000080">/</font><font color="#800000">2.0</font><font color="#000080">/</font>Debugging add a <font color="#FF0000"><b>string </b></font>value called EnableCPU <font color="#FF0000"><b>and set
</b></font>its <font color="#FF0000"><b>string </b></font>value <font color="#FF0000"><b>to </b></font><font color="#800000">1.  </font>This add the CPU window <font color="#FF0000"><b>to </b></font>the view menu<font color="#000080">.  </font>The CPU 
window <font color="#FF0000"><b>is
</b></font>active at run time <font color="#FF0000"><b>for </b></font>stepping through <font color="#FF0000"><b>and </b></font>stuff like that<font color="#000080">.

</font><font color="#800000">2.3. </font>I can create my control at run time but it crashes at design time<font color="#000080">.  </font>What 
<font color="#FF0000"><b>is </b></font>wrong<font color="#000080">?

</font><font color="#800000">1. </font>You component must descent from TComponent

<font color="#800000">2. </font>Your constructory <font color="#FF0000"><b>and destructor </b></font>declarations must look like<font color="#000080">:

</font><font color="#FF0000"><b>Constructor </b></font>Create <font color="#000080">(</font>AOwner <font color="#000080">: </font>TComponent<font color="#000080">) ; </font><font color="#FF0000"><b>Override </b></font><font color="#000080">;
</font><font color="#FF0000"><b>Destructor </b></font>Destroy <font color="#000080">; </font><font color="#FF0000"><b>Override </b></font><font color="#000080">;

</font><font color="#800000">3  </font>You will get an Access Violation<font color="#000080">/</font>GPF <font color="#FF0000"><b>if </b></font>you component has any <font color="#FF0000"><b>published 
</b></font>properties that <font color="#FF0000"><b>do not </b></font>have a <font color="#FF0000"><b>property </b></font>editor defined<font color="#000080">.  </font>These include <font color="#FF0000"><b>array 
</b></font>properties <font color="#FF0000"><b>and </b></font>properties <font color="#FF0000"><b>of </b></font>types you create<font color="#000080">. 

</font>How <font color="#FF0000"><b>do </b></font>I make a component work only <font color="#FF0000"><b>in </b></font>design mode<font color="#000080">?

</font>The trick <font color="#FF0000"><b>is to </b></font>use the <font color="#FF0000"><b>Register function</b></font><font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>only called <font color="#FF0000"><b>in </b></font>design 
mode<font color="#000080">.  </font>You can
use it <font color="#FF0000"><b>to set </b></font>a flag that your constructors can check<font color="#000080">.

</font><font color="#800000">2.4. </font>How can I make my control work only <font color="#FF0000"><b>in </b></font>design mode<font color="#000080">?

</font>The <font color="#FF0000"><b>Register procedure is </b></font>only called <font color="#FF0000"><b>in </b></font>design mode<font color="#000080">.  </font>You can define a flag 
<font color="#FF0000"><b>in </b></font>your module <font color="#FF0000"><b>and </b></font>have your <font color="#FF0000"><b>register procedure set </b></font>that flag<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>that flag 
<font color="#FF0000"><b>is </b></font>clear <font color="#FF0000"><b>in </b></font>your <font color="#FF0000"><b>constructor then </b></font>you are <font color="#FF0000"><b>not in </b></font>design mode<font color="#000080">.

------------------------------------------------------------------------
</font>Section <font color="#800000">3 </font><font color="#000080">- </font>Using other components within a component

<font color="#800000">3.1. </font>How can I add a scroll bar component <font color="#FF0000"><b>to </b></font>my component <font color="#FF0000"><b>and </b></font>have it work at 
<font color="#FF0000"><b>in </b></font>design mode<font color="#000080">?

</font>You need <font color="#FF0000"><b>to </b></font>define your own scroll bar <font color="#FF0000"><b>class </b></font>that intercepts the 
CM_DESIGNHITTEST <font color="#FF0000"><b>message</b></font><font color="#000080">.

</font>TMyScrollBar <font color="#000080">= </font><font color="#FF0000"><b>class </b></font><font color="#000080">(</font>TScrollBar<font color="#000080">)
      </font><font color="#FF0000"><b>Procedure </b></font>CMDesignHitTest <font color="#000080">(</font><font color="#FF0000"><b>var Message </b></font><font color="#000080">: </font>TCMDesignHitTest<font color="#000080">) ; </font><font color="#FF0000"><b>Message 
</b></font>CM_DESIGNHITTEST <font color="#000080">;
    </font><font color="#FF0000"><b>End </b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TMyScrollBar<font color="#000080">.</font>CMDesignHitTest <font color="#000080">(</font><font color="#FF0000"><b>var Message </b></font><font color="#000080">: </font>TCMDesignHitTest<font color="#000080">) ;
  </font><font color="#FF0000"><b>Begin
  Message</b></font><font color="#000080">.</font>Result <font color="#000080">:= </font><font color="#800000">1 </font><font color="#000080">;
  </font><font color="#FF0000"><b>End </b></font><font color="#000080">;

</font>When your component creates one <font color="#FF0000"><b>of </b></font>these scroll bars it needs <font color="#FF0000"><b>to </b></font>use

TMyScrollBar<font color="#000080">.</font>Create <font color="#000080">(</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">) 

</font>rather <font color="#FF0000"><b>then

</b></font>TMyScrollBar<font color="#000080">.</font>Create <font color="#000080">(</font>Self<font color="#000080">)

</font>otherwise the scroll bar will display sizing handles when it <font color="#FF0000"><b>is </b></font>click<font color="#000080">.   </font>This 
means you need <font color="#FF0000"><b>to </b></font>be sure <font color="#FF0000"><b>to </b></font>explicitly free the scroll bar <font color="#FF0000"><b>in </b></font>your
component<font color="#800000">'s destructor.

3.2 </font>How <font color="#FF0000"><b>do </b></font>I create a Windows <font color="#800000">'95-style scroll bar?

</font>You need <font color="#FF0000"><b>to set </b></font>the page size <font color="#FF0000"><b>for </b></font>the scroll bar<font color="#000080">.   </font>The following code
sequence
illustrates this<font color="#000080">:

</font><font color="#FF0000"><b>Procedure </b></font>SetPageSize <font color="#000080">(</font>ScrollBar <font color="#000080">: </font>TScrollBar <font color="#000080">; </font>PageSize <font color="#000080">: </font>Integer<font color="#000080">) ;
  </font><font color="#FF0000"><b>Var
    </b></font>ScrollInfo <font color="#000080">: </font>TScrollInfo <font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  </b></font>ScrollInfo<font color="#000080">.</font>cbSize <font color="#000080">:= </font>Sizeof <font color="#000080">(</font>ScrollInfo<font color="#000080">) ;
  </font>ScrollInfo<font color="#000080">.</font>fMask <font color="#000080">:= </font>SIF_PAGE <font color="#000080">;
  </font>ScrollInfo<font color="#000080">.</font>nPage <font color="#000080">:= </font>PageSize <font color="#000080">;   
  </font>SetScrollInfo <font color="#000080">(</font>ScrollBar<font color="#000080">.</font>Handle<font color="#000080">, </font>SB_CTL<font color="#000080">, </font>ScrollInfo<font color="#000080">, </font>True<font color="#000080">) ;
  </font><font color="#FF0000"><b>End </b></font><font color="#000080">;

</font><font color="#FF0000"><b>To </b></font>retrieve the page size use<font color="#000080">:

</font><font color="#FF0000"><b>Function </b></font>GetpageSize <font color="#000080">(</font>ScrollBar <font color="#000080">: </font>TScrollBar<font color="#000080">) ;
  </font><font color="#FF0000"><b>Var
    </b></font>ScrollInfo <font color="#000080">: </font>TScrollInfo <font color="#000080">;
  </font><font color="#FF0000"><b>Begin
  If </b></font>HandleAllocated <font color="#FF0000"><b>Then
    Begin
    </b></font>ScrollInfo<font color="#000080">.</font>cbSize <font color="#000080">:= </font>Sizeof <font color="#000080">(</font>ScrollInfo<font color="#000080">) ;
    </font>ScrollInfo<font color="#000080">.</font>fMask <font color="#000080">:= </font>SIF_PAGE <font color="#000080">;
    </font>GetScrollInfo <font color="#000080">(</font>ScrollBar<font color="#000080">.</font>Handle<font color="#000080">, </font>SB_CTL<font color="#000080">, </font>ScrollInfo<font color="#000080">) ;
    </font>Result <font color="#000080">:= </font>ScrollInfo<font color="#000080">.</font>nPage <font color="#000080">;
    </font><font color="#FF0000"><b>End </b></font><font color="#000080">;

------------------------------------------------------------------------
</font>Section <font color="#800000">4 </font><font color="#000080">- </font>Bound Controls

<font color="#800000">4.1. </font>Where <font color="#FF0000"><b>is </b></font>the documentation <font color="#FF0000"><b>for </b></font>the TDataLink <font color="#FF0000"><b>class</b></font><font color="#000080">?

</font><font color="#FF0000"><b>As far as </b></font>I can tell the only documentation <font color="#FF0000"><b>for </b></font>TDataLink that exists <font color="#FF0000"><b>in </b></font>the 
entire universe <font color="#FF0000"><b>is </b></font>what follows

Properties<font color="#000080">:
===========

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>Active <font color="#000080">: </font>Boolean <font color="#000080">(</font><font color="#FF0000"><b>Read </b></font>Only<font color="#000080">)
----------------------------------------

</font>Returns true when the data link <font color="#FF0000"><b>is </b></font>connected <font color="#FF0000"><b>to </b></font>an active datasource<font color="#000080">.
</font>The ActiveChanged method <font color="#FF0000"><b>is </b></font>called <font color="#FF0000"><b>to </b></font>give notification when the state
changes<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>ActiveRecord<font color="#000080">: (</font><font color="#FF0000"><b>Read</b></font><font color="#000080">/</font><font color="#FF0000"><b>Write</b></font><font color="#000080">)
--------------------------------------

</font>This sets <font color="#FF0000"><b>or </b></font>returns the current <font color="#FF0000"><b>record </b></font>within the TDatalink<font color="#800000">'s buffer window.  
</font>Valid values are
<font color="#800000">0</font><font color="#000080">..</font>BufferCount <font color="#000080">- </font><font color="#800000">1.  </font>There appear <font color="#FF0000"><b>to </b></font>be no range checks so assigning values 
outside this range produces unpredictable results<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>BufferCount<font color="#000080">: (</font><font color="#FF0000"><b>Read</b></font><font color="#000080">/</font><font color="#FF0000"><b>Write</b></font><font color="#000080">)
-------------------------------------

</font>The TDataLink maintains a window <font color="#FF0000"><b>of </b></font>records into the dataset  This <font color="#FF0000"><b>property is
</b></font>the size <font color="#FF0000"><b>of </b></font>this window <font color="#FF0000"><b>and </b></font>determines the maximum number <font color="#FF0000"><b>of </b></font>row that can be 
view simultaneously<font color="#000080">.  </font><font color="#FF0000"><b>For </b></font>most controls you would use a BufferCount <font color="#FF0000"><b>of </b></font>one<font color="#000080">.  
</font><font color="#FF0000"><b>For </b></font>controls such <font color="#FF0000"><b>as </b></font>a data grid this value <font color="#FF0000"><b>is </b></font>the number <font color="#FF0000"><b>of </b></font>visible rows<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>DataSet<font color="#000080">: </font>TDataSet <font color="#000080">(</font><font color="#FF0000"><b>Read</b></font><font color="#000080">)
------------------------------------

</font>The dataset the TDataLink <font color="#FF0000"><b>is </b></font>attached <font color="#FF0000"><b>to</b></font><font color="#000080">.  </font>This <font color="#FF0000"><b>is </b></font>a shortcut <font color="#FF0000"><b>to 
</b></font>DataSource<font color="#000080">.</font>DataSet<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>DataSource<font color="#000080">: </font>TDataSource <font color="#000080">(</font><font color="#FF0000"><b>Read</b></font><font color="#000080">/</font><font color="#FF0000"><b>Write</b></font><font color="#000080">)
------------------------------------------------

</font>Sets <font color="#FF0000"><b>or </b></font>returns data source control the TDataLink <font color="#FF0000"><b>is </b></font>attached <font color="#FF0000"><b>to</b></font><font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>DataSourceFixed<font color="#000080">: </font>Boolean <font color="#000080">(</font><font color="#FF0000"><b>Read</b></font><font color="#000080">/</font><font color="#FF0000"><b>WRite</b></font><font color="#000080">)
-------------------------------------------------

</font>This <font color="#FF0000"><b>property is </b></font>used <font color="#FF0000"><b>to </b></font>prevent the data source <font color="#FF0000"><b>for </b></font>the TDataLink from being
changed<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>this <font color="#FF0000"><b>property is set to </b></font>Trye <font color="#FF0000"><b>then </b></font>assigning a value <font color="#FF0000"><b>to </b></font>the 
DataSource <font color="#FF0000"><b>property </b></font>will result <font color="#FF0000"><b>in </b></font>an exception<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>Editing<font color="#000080">: </font>Boolean <font color="#000080">(</font><font color="#FF0000"><b>Read </b></font>Only<font color="#000080">)
----------------------------------------

</font>Returns true <font color="#FF0000"><b>if </b></font>the datalink <font color="#FF0000"><b>is in </b></font>edit mode<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font><font color="#FF0000"><b>ReadOnly</b></font><font color="#000080">: </font>Boolean <font color="#000080">(</font><font color="#FF0000"><b>read</b></font><font color="#000080">/</font><font color="#FF0000"><b>Write</b></font><font color="#000080">)
------------------------------------------

</font>This <font color="#FF0000"><b>property </b></font>determines <font color="#FF0000"><b>if </b></font>the TDataLink <font color="#FF0000"><b>is read </b></font>only<font color="#000080">.  </font>It does <font color="#FF0000"><b>not </b></font>appear <font color="#FF0000"><b>to
</b></font>affect the attached datalink
<font color="#FF0000"><b>or </b></font>dataset<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>this <font color="#FF0000"><b>property is set to </b></font>True the datalink will <font color="#FF0000"><b>not </b></font>go into 
edit mode<font color="#000080">.

</font><font color="#FF0000"><b>Property</b></font><font color="#000080">:       </font>RecordCount<font color="#000080">: </font>Integer <font color="#000080">(</font><font color="#FF0000"><b>Read</b></font><font color="#000080">)
---------------------------------------

</font>The <font color="#FF0000"><b>property </b></font>returns the approximate number <font color="#FF0000"><b>of </b></font>records <font color="#FF0000"><b>in </b></font>the attached 
dataset<font color="#000080">.

</font>Methods<font color="#000080">:
========

</font><font color="#FF0000"><b>function </b></font>Edit<font color="#000080">: </font>Boolean<font color="#000080">;
-----------------------

</font>Puts the TDatalink<font color="#800000">'s attached dataset into edit mode.

</font>Return Value<font color="#000080">:
        </font>True <font color="#000080">=&gt; </font>Success
        False <font color="#000080">=&gt; </font>Failure

<font color="#FF0000"><b>procedure </b></font>UpdateRecord<font color="#000080">;
-----------------------

</font>It appears that this <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>function </b></font>that <font color="#FF0000"><b>is </b></font>intended <font color="#FF0000"><b>to </b></font>be called by other
parts <font color="#FF0000"><b>of </b></font>the data base <font color="#FF0000"><b>interface and </b></font>should <font color="#FF0000"><b>not </b></font>be called directly<font color="#000080">.  </font>All it
does <font color="#FF0000"><b>is set </b></font>a flag <font color="#FF0000"><b>and </b></font>call UpdateData <font color="#000080">(</font>described below<font color="#000080">).


</font><font color="#FF0000"><b>Virtual </b></font>Methods
<font color="#000080">===============

</font>The mechanism <font color="#FF0000"><b>for </b></font>having the TDataLink <font color="#FF0000"><b>object </b></font>communicate <font color="#FF0000"><b>with </b></font>a component <font color="#FF0000"><b>is 
to override </b></font>these procedures<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>ActiveChanged
<font color="#000080">------------------------

</font>This <font color="#FF0000"><b>procedure is </b></font>called whenever the datasource the TDataLink <font color="#FF0000"><b>is </b></font>attached <font color="#FF0000"><b>to 
</b></font>becomes active <font color="#FF0000"><b>or
</b></font>inactive<font color="#000080">.  </font>Use the Active <font color="#FF0000"><b>property to </b></font>determine whether <font color="#FF0000"><b>or not </b></font>the link <font color="#FF0000"><b>is 
</b></font>active<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>CheckBrowseMode
<font color="#000080">-------------------------

</font>This method appears <font color="#FF0000"><b>to </b></font>get called before any changes take place <font color="#FF0000"><b>to </b></font>the
database<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>DataSetChanged<font color="#000080">;
-------------------------

</font>This <font color="#FF0000"><b>procedure </b></font>gets called when the following events occur<font color="#000080">:

   </font>o  Moving <font color="#FF0000"><b>to </b></font>the start <font color="#FF0000"><b>of </b></font>the dataset
   o Moving <font color="#FF0000"><b>to </b></font>the <font color="#FF0000"><b>end of </b></font>the dataset
   o Inserting <font color="#FF0000"><b>or </b></font>Appending <font color="#FF0000"><b>to </b></font>the dataset
   o Deleting a <font color="#FF0000"><b>record </b></font>from the dataset
   o Canceling the editing <font color="#FF0000"><b>of </b></font>a <font color="#FF0000"><b>record
   </b></font>o Updating a <font color="#FF0000"><b>record

</b></font>The non<font color="#000080">-</font>overrident action <font color="#FF0000"><b>for </b></font>this <font color="#FF0000"><b>procedure is to </b></font>call
        RecordChanged <font color="#000080">(</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">)

</font><font color="#FF0000"><b>procedure </b></font>DataSetScrolled<font color="#000080">(</font>Distance<font color="#000080">: </font>Integer<font color="#000080">)
--------------------------------------------

</font>This <font color="#FF0000"><b>procedure is </b></font>called whenever the current <font color="#FF0000"><b>record in </b></font>the dataset changes<font color="#000080">.  
</font>The Distance parameter tells how <font color="#FF0000"><b>far </b></font>the buffer window into the dataset was 
scrolled <font color="#000080">(</font>This seems <font color="#FF0000"><b>to </b></font>always be <font color="#FF0000"><b>in </b></font>the range <font color="#000080">-</font><font color="#800000">1</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">1</font><font color="#000080">).

</font>Use the ActiveRecord <font color="#FF0000"><b>to </b></font>determine which <font color="#FF0000"><b>record </b></font>within the buffer window <font color="#FF0000"><b>is </b></font>the 
current one<font color="#000080">.

</font>It <font color="#FF0000"><b>is not </b></font>possible <font color="#FF0000"><b>to </b></font>force a scroll <font color="#FF0000"><b>of </b></font>the buffer window<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>FocusControl<font color="#000080">(</font>Field<font color="#000080">: </font>TFieldRef<font color="#000080">)
----------------------------------------

</font>This appears <font color="#FF0000"><b>to </b></font>get called <font color="#FF0000"><b>as </b></font>a result <font color="#FF0000"><b>of </b></font>Field<font color="#000080">.</font>FocusControl<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>EditingChanged
<font color="#000080">-------------------------

</font>This <font color="#FF0000"><b>procedure is </b></font>called when the editing state <font color="#FF0000"><b>of </b></font>the TDataLink changes<font color="#000080">.  </font>Use 
the Editing <font color="#FF0000"><b>property to </b></font>determine <font color="#FF0000"><b>if </b></font>the TDataLink <font color="#FF0000"><b>is in </b></font>edit mode <font color="#FF0000"><b>or not</b></font><font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>LayoutChanged
<font color="#000080">-----------------------

</font>This <font color="#FF0000"><b>procedure is </b></font>called when the layout <font color="#FF0000"><b>of </b></font>the attached dataset changes <font color="#000080">(</font>e<font color="#000080">.</font>g<font color="#000080">. 
</font>column added<font color="#000080">) .

</font><font color="#FF0000"><b>procedure </b></font>RecordChanged<font color="#000080">(</font>Field<font color="#000080">: </font>TField<font color="#000080">)
--------------------------------------

</font>This <font color="#FF0000"><b>procedure </b></font>gets called when<font color="#000080">:

   </font>o The current <font color="#FF0000"><b>record is </b></font>edited
   o The <font color="#FF0000"><b>record</b></font><font color="#800000">'s text has changed

</font><font color="#FF0000"><b>If </b></font>the Field parameter <font color="#FF0000"><b>is </b></font>non<font color="#000080">-</font><font color="#FF0000"><b>nil then </b></font>the change occured <font color="#FF0000"><b>to </b></font>the specified 
field<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>UpdateData
<font color="#000080">--------------------

</font>This <font color="#FF0000"><b>procedure is </b></font>called immediately before a <font color="#FF0000"><b>record is </b></font>updated <font color="#FF0000"><b>in </b></font>the 
database<font color="#000080">.  </font>You can call the Abort <font color="#FF0000"><b>procedure to </b></font>prevent the <font color="#FF0000"><b>record </b></font>from being 
updated<font color="#000080">.


------------------------------------------------------------------------
</font>Section <font color="#800000">5 </font><font color="#000080">- </font>VCL
<font color="#800000">5.1. </font>How can I step through the VCL source <font color="#FF0000"><b>while </b></font>debugging

Copy the VCL source modules you are interested <font color="#FF0000"><b>in </b></font>stepping through <font color="#FF0000"><b>to </b></font>your 
project directory <font color="#FF0000"><b>then </b></font>rebuild the VCL <font color="#FF0000"><b>library</b></font><font color="#000080">.  </font>You will <font color="#FF0000"><b>then </b></font>be able <font color="#FF0000"><b>to </b></font>step 
through the VCL source modules<font color="#000080">.

------------------------------------------------------------------------
</font>Section <font color="#800000">6 </font><font color="#000080">- </font>Other Sources <font color="#FF0000"><b>of </b></font>Information

<font color="#800000">6.1. </font>Are there any books one how <font color="#FF0000"><b>to write </b></font>Delphi components<font color="#000080">?

</font>I have seen a couple <font color="#FF0000"><b>out </b></font>there but the only one I can recommend <font color="#FF0000"><b>is

</b></font><font color="#000080">&quot;</font>Developing Delphi Components<font color="#000080">&quot; </font>by Ray Konopka

<font color="#000080">------------------------------------------------------------------------
</font>Section <font color="#800000">7 </font><font color="#000080">- </font>Persistant Objects

<font color="#800000">7.1. </font>How can I save a complex <font color="#FF0000"><b>object </b></font>containing child objects <font color="#FF0000"><b>to </b></font>the <font color="#000080">.</font>DFM 
<font color="#FF0000"><b>file</b></font><font color="#000080">.

</font>I have tried all sorts <font color="#FF0000"><b>of </b></font>schemes using DefineProperties <font color="#FF0000"><b>and </b></font>WriteComponents 
<font color="#FF0000"><b>and </b></font>they all failed <font color="#FF0000"><b>to </b></font>work<font color="#000080">. </font><font color="#FF0000"><b>As far as </b></font>I can the only way <font color="#FF0000"><b>to do </b></font>this <font color="#FF0000"><b>is to </b></font>use 
Delphi<font color="#800000">'s default mechanism to store your child objects.  

</font>A sequence that does work <font color="#FF0000"><b>for </b></font>saving <font color="#FF0000"><b>to </b></font>a stream <font color="#FF0000"><b>is</b></font><font color="#000080">:

</font><font color="#800000">1. </font>Make all <font color="#FF0000"><b>of </b></font>the classes whose objects you want <font color="#FF0000"><b>to </b></font>save descent from 
TComponent<font color="#000080">.
</font><font color="#800000">2. </font>Make all <font color="#FF0000"><b>of </b></font>the values you want <font color="#FF0000"><b>to </b></font>save <font color="#FF0000"><b>published</b></font><font color="#000080">.
</font><font color="#800000">3. </font>Within your <font color="#FF0000"><b>Register procedure </b></font>add a call <font color="#FF0000"><b>to </b></font>RegisterComponents containing 
all <font color="#FF0000"><b>of </b></font>the classes you wish <font color="#FF0000"><b>to </b></font>store<font color="#000080">.
</font><font color="#800000">4. </font>Each <font color="#FF0000"><b>class </b></font>that owns child classes needs <font color="#FF0000"><b>to overload </b></font>the <font color="#FF0000"><b>procedure 
</b></font>GetChildren<font color="#000080">.  </font>Within this <font color="#FF0000"><b>procedure is </b></font>needs <font color="#FF0000"><b>to </b></font>call the <font color="#FF0000"><b>procedure </b></font>passed <font color="#FF0000"><b>as 
</b></font>an argument <font color="#FF0000"><b>for </b></font>each child <font color="#FF0000"><b>to </b></font>be <font color="#FF0000"><b>stored</b></font><font color="#000080">.

</font>Getting the objects <font color="#FF0000"><b>out of </b></font>the stream <font color="#FF0000"><b>is </b></font>a little trickier<font color="#000080">.  </font>Your parent 
<font color="#FF0000"><b>object </b></font>may need <font color="#FF0000"><b>to overload </b></font>the GetChildOwner <font color="#FF0000"><b>and </b></font>GetChildParent functions<font color="#000080">.  
</font>Otherwise Delphi will <font color="#FF0000"><b>try to </b></font>make the child owned by the form<font color="#000080">.


------------------------------------------------------------------------
</font>Copyright <font color="#800000">1996 </font><font color="#000080">- </font>John Miano

Contributers

Glen Boyd

</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0203.PAS">Original</a><b>]</b></p></body>
</html>
