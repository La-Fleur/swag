<html>
<head><title> "Help on Printer Control Codes" by DAVID BLOCK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0448.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">From<font color="#000080">: </font>dblock<font color="#000080">@</font>vdn<font color="#000080">.</font>com <font color="#000080">(</font>David Block<font color="#000080">)

</font>Vincent Lim <font color="#000080">&lt;</font>kaneda<font color="#000080">@</font>singnet<font color="#000080">.</font>com<font color="#000080">.</font>sg<font color="#000080">&gt; </font>wrote<font color="#000080">:

</font>How <font color="#FF0000"><b>do </b></font>I send Printer Control Codes <font color="#FF0000"><b>to </b></font>the printer without having them
translated into unprintable characters<font color="#000080">?
</font><font color="#FF0000"><b>Not </b></font>sure <font color="#FF0000"><b>if </b></font>it <font color="#FF0000"><b>is </b></font>Windows API <font color="#FF0000"><b>or </b></font>Delphi <font color="#FF0000"><b>is </b></font>the culprit<font color="#000080">.
</font>When I write the printer control codes<font color="#000080">, </font>they are just printed <font color="#FF0000"><b>as
</b></font>unprintable characters rather than being interpreted by the printer<font color="#000080">.
</font>You need <font color="#FF0000"><b>to </b></font>use the Passthrough printer Escape <font color="#FF0000"><b>function to </b></font>send data directly <font color="#FF0000"><b>to </b></font>the printer<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>you<font color="#800000">'re using WriteLn, then it won'</font>t work<font color="#000080">. </font>Here<font color="#800000">'s some code to get you started: 


</font><font color="#000080">--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>unit </b></font>Passthru<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses </b></font>printers<font color="#000080">, </font>WinProcs<font color="#000080">, </font>WinTypes<font color="#000080">, </font>SysUtils<font color="#000080">;

</font><font color="#FF0000"><b>Procedure       </b></font>PrintTest<font color="#000080">;

</font><font color="#FF0000"><b>implementation

Type
        </b></font>TPassThroughData <font color="#000080">= </font><font color="#FF0000"><b>Record
                </b></font>nLen <font color="#000080">: </font>Integer<font color="#000080">;
                </font>Data <font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>byte<font color="#000080">;
        </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>DirectPrint<font color="#000080">(</font>s <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>var
        </b></font>PTBlock <font color="#000080">: </font>TPassThroughData<font color="#000080">;
</font><font color="#FF0000"><b>Begin
        </b></font>PTBlock<font color="#000080">.</font>nLen <font color="#000080">:= </font>Length<font color="#000080">(</font>s<font color="#000080">);
        </font>StrPCopy<font color="#000080">(@</font>PTBlock<font color="#000080">.</font>Data<font color="#000080">,</font>s<font color="#000080">);
        </font>Escape<font color="#000080">(</font>printer<font color="#000080">.</font>handle<font color="#000080">, </font>PASSTHROUGH<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,@</font>PTBlock<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;



</font><font color="#FF0000"><b>Procedure </b></font>PrintTest<font color="#000080">;
</font><font color="#FF0000"><b>Begin
        </b></font>Printer<font color="#000080">.</font>BeginDoc<font color="#000080">;
        </font>DirectPrint<font color="#000080">(</font>CHR<font color="#000080">(</font><font color="#800000">27</font><font color="#000080">)+</font><font color="#800000">'&amp;l1O'</font><font color="#000080">+</font><font color="#800000">'Hello, World!'</font><font color="#000080">);
        </font>Printer<font color="#000080">.</font>EndDoc<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0448.PAS">Original</a><b>]</b></p></body>
</html>
