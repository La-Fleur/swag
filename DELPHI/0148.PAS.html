<html>
<head><title> "Send Tabs when Enter is pressed" by PIERRE MARMET</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0148.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Sorry you must use the sendmessage API to do this.
use the winsight32 to spy this message !.
you can find in compsit.pas a new component witch send a TAB key
when you press ENTER

Best regards

Pierre

pmarmet@mnet.fr
}

</i></font><font color="#FF0000"><b>unit </b></font>compsit<font color="#000080">;
</font><font color="#008000"><i>//*******************************************
// Classe TDBedite
// avec gestion de la touche ENTREE
// (c)SIT 8/5/1996 MARMET Pierre
//*******************************************


</i></font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>StdCtrls<font color="#000080">,</font>DBCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TDBEdite <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TDBEdit<font color="#000080">)

  </font><font color="#FF0000"><b>private
  </b></font>Tentree<font color="#000080">: </font>integer<font color="#000080">;
  </font>varia<font color="#000080">: </font>boolean<font color="#000080">;
  </font>oldvalue<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;            </font><font color="#008000"><i>{memorise l'ancienne valeur du composant}

  </i></font><font color="#FF0000"><b>function </b></font>getpierre<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>setpierre <font color="#000080">(</font>param1<font color="#000080">: </font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>WndProc<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">) ;</font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#008000"><i>{ D&eacute;clarations priv&eacute;es }
  </i></font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ D&eacute;clarations prot&eacute;g&eacute;es }


  </i></font><font color="#FF0000"><b>public
  constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ D&eacute;clarations publiques }
  </i></font><font color="#FF0000"><b>published
  </b></font><font color="#008000"><i>//property ENTREE: Boolean read Getpierre write Setpierre default True;
  </i></font><font color="#000080">/ </font><font color="#FF0000"><b>property </b></font>ENTERKey<font color="#000080">: </font>integer <font color="#FF0000"><b>read </b></font>getpierre <font color="#FF0000"><b>write </b></font>setpierre <font color="#FF0000"><b>default </b></font><font color="#800000">1</font><font color="#000080">;
  </font><font color="#FF0000"><b>property </b></font>DoEnterKey<font color="#000080">: </font>boolean <font color="#FF0000"><b>read </b></font>varia <font color="#FF0000"><b>write </b></font>varia<font color="#000080">;
    </font><font color="#008000"><i>{ D&eacute;clarations publi&eacute;es }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Exemples'</font><font color="#000080">, [</font>TDBEdite<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Constructor </b></font>TDBEdite<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>begin
     inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
</font><font color="#008000"><i>//     ENTERKey := 1;
     </i></font>varia<font color="#000080">:=</font>True<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TDBEdite<font color="#000080">.</font>getpierre<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
     </b></font>result <font color="#000080">:= </font>Tentree<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TDBEdite<font color="#000080">.</font>setpierre<font color="#000080">(</font>param1<font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
     if </b></font>param1 <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>param1<font color="#000080">:=</font><font color="#800000">1</font><font color="#000080">;
     </font>Tentree<font color="#000080">:=</font>param1<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>procedure </b></font>TDBEdite<font color="#000080">.</font>WndProc<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TMessage<font color="#000080">);
</font><font color="#FF0000"><b>begin

  if </b></font><font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">.</font>msg <font color="#000080">= </font>WM_CHAR<font color="#000080">) </font><font color="#FF0000"><b>then

     begin

     </b></font><font color="#008000"><i>// La touche ENTREE provoque une tabulation sur le controle
     </i></font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">.</font>WParam <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">( </font>varia <font color="#000080">= </font>True <font color="#000080">) </font><font color="#FF0000"><b>then
          begin
              </b></font>sendmessage<font color="#000080">(</font>self<font color="#000080">.</font>Handle<font color="#000080">,</font>WM_USER<font color="#000080">+</font><font color="#800000">$B900</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,</font><font color="#800000">$F0001</font><font color="#000080">);
              </font>exit<font color="#000080">;
          </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#FF0000"><b>inherited </b></font>WndProc<font color="#000080">(</font><font color="#FF0000"><b>Message</b></font><font color="#000080">);        </font><font color="#008000"><i>{ r&eacute;partition normale }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;



</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0148.PAS">Original</a><b>]</b></p></body>
</html>
