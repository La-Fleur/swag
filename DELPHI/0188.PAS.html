<html>
<head><title> "Making Your Delphi 2.0 Applications "Sin" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0188.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>(*
This TI demonstrates how to make your Delphi 2.0
application &quot;sing&quot; by loading and playing a wave file
four different ways:

1) Use the sndPlaySound() function to directly
play a wave file.

2) Read the wave file into memory, then use the
sndPlaySound() to play the wave file

3) Use sndPlaySound to directly play a wave
file thats embedded in a resource file attached
to your application.

4) Read a wave file thats embedded in a resource
 file attached to your application into memory,
 then use the sndPlaySound() to play the wave file.

 To build the project you will need to:

1) Create a wave file called 'hello.wav'
in the project's directory.

2) Create a text file called 'snddata.rc'
in the project's directory.

3) Add the following line to the file 'snddata.rc':
HELLO WAVE hello.wav

4) At a dos prompt, go to your project directory
and compile the .rc file using the Borland Resource
compiler (brcc32.exe) by typing the path to brcc32.exe
and giving 'snddata.rc' as a parameter.

Example:

bin\brcc32 snddata.rc

This will create the file 'snddata.res' that
Delphi will link with your application's .exe
file.

Final Note: Keep on Jamm'n!

*)

</i></font><font color="#FF0000"><b>unit </b></font>PlaySnd1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">,
  </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>PlaySndFromFile<font color="#000080">: </font>TButton<font color="#000080">;
    </font>PlaySndFromMemory<font color="#000080">: </font>TButton<font color="#000080">;
    </font>PlaySndbyLoadRes<font color="#000080">: </font>TButton<font color="#000080">;
    </font>PlaySndFromRes<font color="#000080">: </font>TButton<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>PlaySndFromFileClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>PlaySndFromMemoryClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>PlaySndFromResClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>PlaySndbyLoadResClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

{$R snddata.res}

</i></font><font color="#FF0000"><b>uses </b></font>MMSystem<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>PlaySndFromFileClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>sndPlaySound<font color="#000080">(</font><font color="#800000">'hello.wav'</font><font color="#000080">,
                </font>SND_FILENAME <font color="#FF0000"><b>or </b></font>SND_SYNC<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>PlaySndFromMemoryClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>f<font color="#000080">: </font><font color="#FF0000"><b>file</b></font><font color="#000080">;
  </font>p<font color="#000080">: </font>pointer<font color="#000080">;
  </font>fs<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>AssignFile<font color="#000080">(</font>f<font color="#000080">, </font><font color="#800000">'hello.wav'</font><font color="#000080">);
  </font>Reset<font color="#000080">(</font>f<font color="#000080">,</font><font color="#800000">1</font><font color="#000080">);
  </font>fs <font color="#000080">:= </font>FileSize<font color="#000080">(</font>f<font color="#000080">);
  </font>GetMem<font color="#000080">(</font>p<font color="#000080">, </font>fs<font color="#000080">);
  </font>BlockRead<font color="#000080">(</font>f<font color="#000080">, </font>p<font color="#000080">^, </font>fs<font color="#000080">);
  </font>CloseFile<font color="#000080">(</font>f<font color="#000080">);
  </font>sndPlaySound<font color="#000080">(</font>p<font color="#000080">,
               </font>SND_MEMORY <font color="#FF0000"><b>or </b></font>SND_SYNC<font color="#000080">);
  </font>FreeMem<font color="#000080">(</font>p<font color="#000080">, </font>fs<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>PlaySndFromResClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>PlaySound<font color="#000080">(</font><font color="#800000">'HELLO'</font><font color="#000080">,
            </font>hInstance<font color="#000080">,
            </font>SND_RESOURCE <font color="#FF0000"><b>or </b></font>SND_SYNC<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>PlaySndbyLoadResClick<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>h<font color="#000080">: </font>THandle<font color="#000080">;
  </font>p<font color="#000080">: </font>pointer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>h <font color="#000080">:= </font>FindResource<font color="#000080">(</font>hInstance<font color="#000080">,
                    </font><font color="#800000">'HELLO'</font><font color="#000080">,
                    </font><font color="#800000">'WAVE'</font><font color="#000080">);
  </font>h <font color="#000080">:= </font>LoadResource<font color="#000080">(</font>hInstance<font color="#000080">, </font>h<font color="#000080">);
  </font>p <font color="#000080">:= </font>LockResource<font color="#000080">(</font>h<font color="#000080">);
  </font>sndPlaySound<font color="#000080">(</font>p<font color="#000080">,
               </font>SND_MEMORY <font color="#FF0000"><b>or </b></font>SND_SYNC<font color="#000080">);
  </font>UnLockResource<font color="#000080">(</font>h<font color="#000080">);
  </font>FreeResource<font color="#000080">(</font>h<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0188.PAS">Original</a><b>]</b></p></body>
</html>
