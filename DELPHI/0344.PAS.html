<html>
<head><title> "Saving Richedit as tBlobStream" by MIKE BARDILL</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0344.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">From<font color="#000080">: </font>Mike Bardill <font color="#000080">&lt;</font>rrmike<font color="#000080">@</font>minster<font color="#000080">.</font>york<font color="#000080">.</font>ac<font color="#000080">.</font>uk<font color="#000080">&gt;


</font>Saving a TRichEdit <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>file and </b></font>storing the <font color="#FF0000"><b>file is </b></font>a perfectly good way
<font color="#FF0000"><b>of </b></font>saving the data <font color="#FF0000"><b>to </b></font>the table<font color="#000080">, </font>but the same can be achieved without an
intermediate <font color="#FF0000"><b>file </b></font>by using a TBlobStream<font color="#000080">. </font>The example below <font color="#FF0000"><b>is for </b></font>reading
a TRichEdit from a table<font color="#000080">, </font>but a similar approach <font color="#800000">'in reverse' </font><font color="#FF0000"><b>with </b></font>a
bmWrite will save into the table<font color="#000080">.


--------------------------------------------------------------------------------


</font><font color="#FF0000"><b>procedure </b></font>ReadRichEditFromTable<font color="#000080">(</font>Table <font color="#000080">: </font>TTable<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>RichEdit <font color="#000080">: </font>TRichEdit<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>BlobStream <font color="#000080">: </font>TBlobStream<font color="#000080">;
</font><font color="#FF0000"><b>begin
  try
    </b></font>BlobStream <font color="#000080">:= </font>TBlobStream<font color="#000080">.</font>Create<font color="#000080">(</font>Table<font color="#000080">.</font>FieldByName<font color="#000080">(</font><font color="#800000">'BODY'</font><font color="#000080">) </font><font color="#FF0000"><b>as </b></font>TBlobField<font color="#000080">, </font>bmRead<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font><font color="#FF0000"><b>not </b></font>Table<font color="#000080">.</font>FieldByName<font color="#000080">(</font><font color="#800000">'BLOBFieldName'</font><font color="#000080">).</font>IsNull<font color="#000080">) </font><font color="#FF0000"><b>then
    begin
      </b></font>RichEdit<font color="#000080">.</font>Lines<font color="#000080">.</font>LoadFromStream <font color="#000080">(</font>BlobStream<font color="#000080">);
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>finally
    </b></font>BlobStream<font color="#000080">.</font>Free<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0344.PAS">Original</a><b>]</b></p></body>
</html>
