<html>
<head><title> "Shortcut in code" by THANH QUACH</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0382.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt;</font>How <font color="#FF0000"><b>do </b></font>you create a shortcut <font color="#FF0000"><b>in </b></font>code<font color="#000080">, </font>given a <font color="#FF0000"><b>program </b></font>executable <font color="#FF0000"><b>and </b></font>its
path<font color="#000080">?


</font><font color="#FF0000"><b>Try </b></font>the following code <font color="#FF0000"><b>to </b></font>see <font color="#FF0000"><b>if </b></font>it helps<font color="#000080">.

</font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>uses  </b></font>ShlObj<font color="#000080">, </font>ActiveX<font color="#000080">, </font>ComObj<font color="#000080">, </font>Registry<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>MyObject<font color="#000080">: </font>IUnknown<font color="#000080">;   </font><font color="#008000"><i>// IUnknown interface
  </i></font>MySLink<font color="#000080">: </font>IShellLink<font color="#000080">; </font><font color="#008000"><i>{The IShellLink interface provides an interface to
                        allow an application to create and resolve shell
links}
  </i></font>MyPFile<font color="#000080">: </font>IPersistFile<font color="#000080">; </font><font color="#008000"><i>{The IPersistFile interface provides methods for an
                          object to load and save itself in a disk file }
  </i></font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>Directory<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font>WFileName<font color="#000080">: </font>WideString<font color="#000080">;
  </font>MyReg<font color="#000080">: </font>TRegIniFile<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>MyObject <font color="#000080">:= </font>CreateComObject<font color="#000080">(</font>CLSID_ShellLink<font color="#000080">);
  </font>MySLink <font color="#000080">:= </font>MyObject <font color="#FF0000"><b>as </b></font>IShellLink<font color="#000080">;    </font><font color="#008000"><i>// See on line help for IShellLink
</i></font><font color="#FF0000"><b>interface
  </b></font>MyPFile <font color="#000080">:= </font>MyObject <font color="#FF0000"><b>as </b></font>IPersistFile<font color="#000080">; </font><font color="#008000"><i>// See on line help for IPersistFile
</i></font><font color="#FF0000"><b>interface
  </b></font>FileName <font color="#000080">:= </font><font color="#800000">'NOTEPAD.EXE'</font><font color="#000080">;
  </font><font color="#FF0000"><b>with </b></font>MySLink <font color="#FF0000"><b>do
    begin
      </b></font>SetArguments<font color="#000080">(</font><font color="#800000">'C:\AUTOEXEC.BAT'</font><font color="#000080">);
      </font>SetPath<font color="#000080">(</font>PChar<font color="#000080">(</font>FileName<font color="#000080">));
      </font>SetWorkingDirectory<font color="#000080">(</font>PChar<font color="#000080">(</font>ExtractFilePath<font color="#000080">(</font>FileName<font color="#000080">)));
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>MyReg <font color="#000080">:=
</font>TRegIniFile<font color="#000080">.</font>Create<font color="#000080">(</font><font color="#800000">'Software\MicroSoft\Windows\CurrentVersion\Explorer'</font><font color="#000080">);
  </font><font color="#008000"><i>// Put the shortcut on your desktop
  </i></font>Directory <font color="#000080">:= </font>MyReg<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'Shell Folders'</font><font color="#000080">,</font><font color="#800000">'Desktop'</font><font color="#000080">,</font><font color="#800000">''</font><font color="#000080">);

  </font><font color="#008000"><i>// put the shortcut on your start menu
  { Directory := MyReg.ReadString('Shell Folders','Start Menu','')+
    CreateDir(Directory); }

  </i></font>WFileName <font color="#000080">:= </font>Directory <font color="#000080">+ </font><font color="#800000">'\NotePad.lnk'</font><font color="#000080">;
  </font>MyPFile<font color="#000080">.</font>Save<font color="#000080">(</font>PWChar<font color="#000080">(</font>WFileName<font color="#000080">),</font>False<font color="#000080">);
  </font>MyReg<font color="#000080">.</font>Free<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0382.PAS">Original</a><b>]</b></p></body>
</html>
