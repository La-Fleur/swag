<html>
<head><title> "AVI Player" by ANDREA MOLINO</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0304.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">This <font color="#FF0000"><b>is </b></font>a control <font color="#FF0000"><b>for </b></font>playing avi files<font color="#000080">.

</font><font color="#FF0000"><b>unit </b></font>AVICtrl<font color="#000080">;

</font><font color="#FF0000"><b>interface

</b></font><font color="#008000"><i>{                           TAVIControl V 0.9b
                              Programmed by
                              Andrea Molino
                           easytarg@mbox.vol.it
}

</i></font><font color="#FF0000"><b>uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>CommCtrl<font color="#000080">;

</font><font color="#FF0000"><b>Type
  </b></font>TAVIControlState <font color="#000080">= (</font>acsClose<font color="#000080">, </font>acsOpen<font color="#000080">, </font>acsPlay<font color="#000080">);
  </font>TAVIControlError <font color="#000080">= (</font>acrOK<font color="#000080">, </font>acrOpenFailed<font color="#000080">, </font>acrPlayFailed<font color="#000080">, </font>acsSeekFailed<font color="#000080">);

  </font>TAVIControl <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TWinControl<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FAVIState<font color="#000080">: </font>TAVIControlState<font color="#000080">;
    </font>FAVIName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font>FFrameFrom<font color="#000080">: </font>SmallInt<font color="#000080">;
    </font>FFrameTo<font color="#000080">: </font>SmallInt<font color="#000080">;
    </font>FFrameSeek<font color="#000080">: </font>SmallInt<font color="#000080">;
    </font>FAutoSize<font color="#000080">: </font>Boolean<font color="#000080">;
    </font>FAutoRepeat<font color="#000080">: </font>Boolean<font color="#000080">;
    </font>FLastOpStatus<font color="#000080">: </font>TAVIControlError<font color="#000080">;
    </font>FAux<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>SetAVIState<font color="#000080">(</font>Val<font color="#000080">: </font>TAVIControlState<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetAVIName<font color="#000080">(</font>Val<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetFrameFrom<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetFrameTo<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetFrameSeek<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetAutoSize<font color="#000080">(</font>Val<font color="#000080">: </font>Boolean<font color="#000080">);
    </font><font color="#FF0000"><b>Procedure </b></font>SetAutoRepeat<font color="#000080">(</font>Val<font color="#000080">: </font>Boolean<font color="#000080">);
    </font><font color="#FF0000"><b>Function  </b></font>GetLastOpStatus<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>protected
    procedure </b></font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Params<font color="#000080">: </font>TCreateParams<font color="#000080">); </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>CreateWnd<font color="#000080">; </font><font color="#FF0000"><b>Override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>public
    Constructor </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Destructor </b></font>Destroy<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>Function  </b></font>Open<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>Close<font color="#000080">;
    </font><font color="#FF0000"><b>Function  </b></font>Play<font color="#000080">(</font>FName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>RepCount<font color="#000080">: </font>SmallInt<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Function  </b></font>Seek<font color="#000080">(</font>Frame<font color="#000080">: </font>SmallInt<font color="#000080">): </font>Boolean<font color="#000080">;
    </font><font color="#FF0000"><b>Procedure </b></font>Stop<font color="#000080">;
  </font><font color="#FF0000"><b>published
    Property </b></font>AVIState<font color="#000080">: </font>TAVIControlState <font color="#FF0000"><b>Read </b></font>FAVIState <font color="#FF0000"><b>Write </b></font>SetAVIState <font color="#FF0000"><b>Default </b></font>acsClose<font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>AVIName<font color="#000080">: </font><font color="#FF0000"><b>String Read </b></font>FAVIName <font color="#FF0000"><b>Write </b></font>SetAVIName<font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>FrameFrom<font color="#000080">: </font>SmallInt <font color="#FF0000"><b>Read </b></font>FFrameFrom <font color="#FF0000"><b>Write </b></font>SetFrameFrom <font color="#FF0000"><b>Default </b></font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>FrameTo<font color="#000080">: </font>SmallInt <font color="#FF0000"><b>Read </b></font>FFrameTo <font color="#FF0000"><b>Write </b></font>SetFrameTo <font color="#FF0000"><b>Default </b></font><font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>FrameSeek<font color="#000080">: </font>SmallInt <font color="#FF0000"><b>Read </b></font>FFrameSeek <font color="#FF0000"><b>Write </b></font>SetFrameSeek <font color="#FF0000"><b>Default </b></font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>AutoSize<font color="#000080">: </font>Boolean <font color="#FF0000"><b>Read </b></font>FAutoSize <font color="#FF0000"><b>Write </b></font>SetAutoSize <font color="#FF0000"><b>Default </b></font>False<font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>AutoRepeat<font color="#000080">: </font>Boolean <font color="#FF0000"><b>Read </b></font>FAutoRepeat <font color="#FF0000"><b>Write </b></font>SetAutoRepeat <font color="#FF0000"><b>Default </b></font>True<font color="#000080">;
    </font><font color="#FF0000"><b>Property </b></font>ZStatus<font color="#000080">: </font><font color="#FF0000"><b>String Read </b></font>GetLastOpStatus <font color="#FF0000"><b>Write </b></font>FAux<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Align<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Enabled<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>PopupMenu<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>ShowHint<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Visible<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseDown<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseMove<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>OnMouseUp<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

Constructor </b></font>TAVIControl<font color="#000080">.</font>Create<font color="#000080">(</font>AOwner<font color="#000080">: </font>TComponent<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  inherited </b></font>Create<font color="#000080">(</font>AOwner<font color="#000080">);
  </font>ControlStyle <font color="#000080">:= </font>ControlStyle <font color="#000080">-[</font>csSetCaption<font color="#000080">];
  </font>FAVIState <font color="#000080">:= </font>acsClose<font color="#000080">;
  </font>FFrameFrom <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FFrameTo <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
  </font>FAutoSize <font color="#000080">:= </font>False<font color="#000080">;
  </font>FAutoRepeat <font color="#000080">:= </font>True<font color="#000080">;
  </font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font>Width <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
  </font>Height <font color="#000080">:= </font><font color="#800000">30</font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Destructor </b></font>TAVIControl<font color="#000080">.</font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Inherited </b></font>Destroy<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAVIControl<font color="#000080">.</font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Params<font color="#000080">: </font>TCreateParams<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>{ACS_AUTOPLAY    - Starts playing the animation as soon as the animation clip is opened.
 ACS_CENTER      - Centers the animation in the animation control's window.
 ACS_TRANSPARENT - Draws the animation using a transparent background rather than
                   the background color specified in the animation clip.}
  </i></font>InitCommonControls<font color="#000080">;
  </font><font color="#FF0000"><b>Inherited </b></font>CreateParams<font color="#000080">(</font>Params<font color="#000080">);
  </font>CreateSubClass<font color="#000080">(</font>Params<font color="#000080">, </font><font color="#800000">'SysAnimate32'</font><font color="#000080">);
  </font><font color="#FF0000"><b>With </b></font>Params <font color="#FF0000"><b>do
  Begin
    </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>Or </b></font>ACS_TRANSPARENT<font color="#000080">;
    </font><font color="#FF0000"><b>If Not </b></font>FAutoSize <font color="#FF0000"><b>Then </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>Or </b></font>ACS_CENTER<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAVIControl<font color="#000080">.</font>CreateWnd<font color="#000080">;
</font><font color="#FF0000"><b>begin
  Inherited </b></font>CreateWnd<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsOpen <font color="#FF0000"><b>Then </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then
  Begin
    </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">);
    </font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetAVIState<font color="#000080">(</font>Val<font color="#000080">: </font>TAVIControlState<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FAVIState <font color="#FF0000"><b>Then
  Begin
    </b></font>FAVIState <font color="#000080">:= </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>Case </b></font>FAVIState <font color="#FF0000"><b>Of
      </b></font>acsOpen <font color="#000080">: </font><font color="#FF0000"><b>Begin
                  </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">)
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>acsPlay <font color="#000080">: </font><font color="#FF0000"><b>Begin
                  </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">);
                  </font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
                </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>acsClose<font color="#000080">: </font>Close<font color="#000080">;
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetAVIName<font color="#000080">(</font>Val<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>FTmpState<font color="#000080">: </font>TAVIControlState<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FAVIName <font color="#FF0000"><b>Then
  Begin
    </b></font>FAVIName <font color="#000080">:= </font>Val<font color="#000080">;
    </font>FTmpState <font color="#000080">:= </font>FAVIState<font color="#000080">;
    </font>Close<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>FTmpState <font color="#000080">= </font>acsOpen <font color="#FF0000"><b>Then </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">);
    </font><font color="#FF0000"><b>If </b></font>FTmpState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetFrameFrom<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FFrameFrom <font color="#FF0000"><b>Then
  Begin
    </b></font>FFrameFrom <font color="#000080">:= </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetFrameTo<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FFrameTo <font color="#FF0000"><b>Then
  Begin
    </b></font>FFrameTo <font color="#000080">:= </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetFrameSeek<font color="#000080">(</font>Val<font color="#000080">: </font>SmallInt<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FFrameSeek <font color="#FF0000"><b>Then
  Begin
    </b></font>FFrameSeek <font color="#000080">:= </font>Val<font color="#000080">;
    </font>Seek<font color="#000080">(</font>FrameSeek<font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetAutoSize<font color="#000080">(</font>Val<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FAutoSize <font color="#FF0000"><b>Then
  Begin
    </b></font>FAutoSize <font color="#000080">:= </font>Val<font color="#000080">;
    </font>RecreateWnd<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>SetAutoRepeat<font color="#000080">(</font>Val<font color="#000080">: </font>Boolean<font color="#000080">);
</font><font color="#FF0000"><b>Begin
  If </b></font>Val <font color="#000080">&lt;&gt; </font>FAutoRepeat <font color="#FF0000"><b>Then
  Begin
    </b></font>FAutoRepeat <font color="#000080">:= </font>Val<font color="#000080">;
    </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>Play<font color="#000080">(</font><font color="#800000">''</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TAVIControl<font color="#000080">.</font>GetLastOpStatus<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font><font color="#FF0000"><b>Begin
  Case </b></font>FLastOpStatus <font color="#FF0000"><b>Of
    </b></font>acrOK        <font color="#000080">: </font>Result <font color="#000080">:= </font><font color="#800000">'OK'</font><font color="#000080">;
    </font>acrOpenFailed<font color="#000080">: </font>Result <font color="#000080">:= </font><font color="#800000">'Open Failed'</font><font color="#000080">;
    </font>acrPlayFailed<font color="#000080">: </font>Result <font color="#000080">:= </font><font color="#800000">'Play Failed'</font><font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TAVIControl<font color="#000080">.</font>Open<font color="#000080">(</font>FileName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">&lt;&gt; </font>acsClose <font color="#FF0000"><b>Then </b></font>Close<font color="#000080">;
  </font>Res <font color="#000080">:= </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>ACM_OPEN<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>LongInt<font color="#000080">(</font>PChar<font color="#000080">(</font>FileName<font color="#000080">)));
  </font>FAVIName <font color="#000080">:= </font>FileName<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>Res <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>FAVIState <font color="#000080">:= </font>acsOpen
  <font color="#FF0000"><b>Else </b></font>FLastOpStatus <font color="#000080">:= </font>acrOpenFailed<font color="#000080">;
  </font>Result <font color="#000080">:= (</font>Res <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>Close<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font>Res <font color="#000080">:= </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>ACM_OPEN<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font>FAVIState <font color="#000080">:= </font>acsClose<font color="#000080">;
  </font>Repaint<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TAVIControl<font color="#000080">.</font>Seek<font color="#000080">(</font>Frame<font color="#000080">: </font>SmallInt<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsClose <font color="#FF0000"><b>Then </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">)
  </font><font color="#FF0000"><b>Else If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>Stop<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">&lt;&gt; </font>acsClose <font color="#FF0000"><b>Then
  Begin
    </b></font>Res <font color="#000080">:= </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>ACM_PLAY<font color="#000080">, </font><font color="#800000">1</font><font color="#000080">, </font>MAKELONG<font color="#000080">(</font>Frame<font color="#000080">, </font>Frame<font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font>Res <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>FLastOpStatus <font color="#000080">:= </font>acsSeekFailed<font color="#000080">;
    </font>Result <font color="#000080">:= (</font>Res <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End
  Else </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>TAVIControl<font color="#000080">.</font>Play<font color="#000080">(</font>FName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>RepCount<font color="#000080">: </font>SmallInt<font color="#000080">): </font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
  </font>Rep<font color="#000080">: </font>SmallInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FName <font color="#000080">= </font><font color="#800000">'' </font><font color="#FF0000"><b>Then </b></font>Open<font color="#000080">(</font>FAVIName<font color="#000080">)
  </font><font color="#FF0000"><b>Else </b></font>Open<font color="#000080">(</font>FName<font color="#000080">);
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">&lt;&gt; </font>acsClose <font color="#FF0000"><b>Then
  Begin
    If </b></font>FAutoRepeat <font color="#FF0000"><b>And </b></font><font color="#000080">(</font>RepCount <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>Then </b></font>Rep <font color="#000080">:= -</font><font color="#800000">1
    </font><font color="#FF0000"><b>Else If </b></font>RepCount <font color="#000080">= </font><font color="#800000">0 </font><font color="#FF0000"><b>Then </b></font>Rep <font color="#000080">:= </font><font color="#800000">1
    </font><font color="#FF0000"><b>Else </b></font>Rep <font color="#000080">:= </font>RepCount<font color="#000080">;
    </font>Res <font color="#000080">:= </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>ACM_PLAY<font color="#000080">, </font>Rep<font color="#000080">, </font>MAKELONG<font color="#000080">(</font>FFrameFrom<font color="#000080">, </font>FFrameTo<font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font><font color="#000080">(</font>Res <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font>FAutoRepeat <font color="#FF0000"><b>Then </b></font>FAVIState <font color="#000080">:= </font>acsPlay
    <font color="#FF0000"><b>Else </b></font>FLastOpStatus <font color="#000080">:= </font>acrPlayFailed<font color="#000080">;
    </font>Result <font color="#000080">:= (</font>Res <font color="#000080">&lt;&gt; </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>End
  Else </b></font>Result <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>TAVIControl<font color="#000080">.</font>Stop<font color="#000080">;
</font><font color="#FF0000"><b>Var
  </b></font>Res<font color="#000080">: </font>LongInt<font color="#000080">;
</font><font color="#FF0000"><b>Begin
  </b></font>FLastOpStatus <font color="#000080">:= </font>acrOK<font color="#000080">;
  </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">&lt;&gt; </font>acsClose <font color="#FF0000"><b>Then
  Begin
    </b></font>Res <font color="#000080">:= </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>ACM_PLAY<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">, </font>MAKELONG<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">0</font><font color="#000080">));
    </font><font color="#FF0000"><b>If </b></font>FAVIState <font color="#000080">= </font>acsPlay <font color="#FF0000"><b>Then </b></font>FAVIState <font color="#000080">:= </font>acsOpen<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'MyGold'</font><font color="#000080">, [</font>TAVIControl<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0304.PAS">Original</a><b>]</b></p></body>
</html>
