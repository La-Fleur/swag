<html>
<head><title> "Nice Printer Control Object" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0162.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Here is an example that prints columns that are right, left, and center
justified.  There are headers, footers, and, generally, a bunch o' things
here.  This app encapsulates functionality to print text, lines, boxes
and shaded boxes. Text can be left or right justified and centered.
Columns can be  created and text can be left or right justified within the
columns or  text can be centered.  Lines of any thickness can be drawn.
Boxes can be drawn with any thickness.  The boxes can be shaded if desired.
Headers and footers can be created and the header/footer areas can be shaded
if desired.  Page numbering can contain custom text and can be placed
anywhere desired.
}


{******* prnMain.pas *******}

</i></font><font color="#FF0000"><b>unit </b></font>Prnmain<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>ExtCtrls<font color="#000080">, </font>Printers<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>HeaderLines <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;                        </font><font color="#008000"><i>{ Number of allowable header lines }
  </i></font>FooterLines <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;                        </font><font color="#008000"><i>{ Number of allowable footer lines }
  </i></font>Columns <font color="#000080">= </font><font color="#800000">20</font><font color="#000080">;                           </font><font color="#008000"><i>{ Number of allowable columns }
        
</i></font><font color="#FF0000"><b>type
  </b></font>THeaderRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>Text<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">240</font><font color="#000080">];                   </font><font color="#008000"><i>{ Header text }
     </i></font>YPosition<font color="#000080">: </font>Single<font color="#000080">;                   </font><font color="#008000"><i>{ Inches from the top }
     </i></font>Alignment<font color="#000080">: </font>Integer<font color="#000080">;                  </font><font color="#008000"><i>{ 0:Left 1:Center 2:Right }

     </i></font>FontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                </font><font color="#008000"><i>{ Font name }
     </i></font>FontSize<font color="#000080">: </font>Integer<font color="#000080">;                   </font><font color="#008000"><i>{ Font size }
     </i></font>FontStyle<font color="#000080">: </font>TFontStyles<font color="#000080">;              </font><font color="#008000"><i>{ Font style }
     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>TFooterRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>Text<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">240</font><font color="#000080">];                   </font><font color="#008000"><i>{ Footer text }
     </i></font>YPosition<font color="#000080">: </font>Single<font color="#000080">;                   </font><font color="#008000"><i>{ Inches from the top }
     </i></font>Alignment<font color="#000080">: </font>Integer<font color="#000080">;                  </font><font color="#008000"><i>{ 0:Left 1:Center 2:Right }
     </i></font>FontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];                </font><font color="#008000"><i>{ Font name }
     </i></font>FontSize<font color="#000080">: </font>Integer<font color="#000080">;                   </font><font color="#008000"><i>{ Font size }
     </i></font>FontStyle<font color="#000080">: </font>TFontStyles<font color="#000080">;              </font><font color="#008000"><i>{ Font style }

     </i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>THeaderCoordinates <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>XTop<font color="#000080">: </font>Single<font color="#000080">;
     </font>YTop<font color="#000080">: </font>Single<font color="#000080">;
     </font>XBottom<font color="#000080">: </font>Single<font color="#000080">;
     </font>YBottom<font color="#000080">: </font>Single<font color="#000080">;
     </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">;
     </font>Shading<font color="#000080">: </font>Word<font color="#000080">;
     </font>LineWidth<font color="#000080">: </font>Word<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;   

  </font>TFooterCoordinates <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>XTop<font color="#000080">: </font>Single<font color="#000080">;
     </font>YTop<font color="#000080">: </font>Single<font color="#000080">;
     </font>XBottom<font color="#000080">: </font>Single<font color="#000080">;
     </font>YBottom<font color="#000080">: </font>Single<font color="#000080">;
     </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">;
     </font>Shading<font color="#000080">: </font>Word<font color="#000080">;
     </font>LineWidth<font color="#000080">: </font>Word<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;   

  </font>TPageNumberRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>YPosition<font color="#000080">: </font>Single<font color="#000080">;
     </font>Text<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">240</font><font color="#000080">];
     </font>Alignment<font color="#000080">: </font>Word<font color="#000080">; 
     </font>FontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">80</font><font color="#000080">];
     </font>FontSize<font color="#000080">: </font>Word<font color="#000080">;
     </font>FontStyle<font color="#000080">: </font>TFontStyles<font color="#000080">;

     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>TColumnInformationRecord <font color="#000080">= </font><font color="#FF0000"><b>Record
     </b></font>XPosition<font color="#000080">: </font>Single<font color="#000080">;
     </font>Length<font color="#000080">: </font>Single<font color="#000080">;
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>TPrintObject <font color="#000080">= </font><font color="#FF0000"><b>class
     private
        </b></font>TopMargin<font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{ Top margin in pixels }
        </i></font>BottomMargin<font color="#000080">: </font>Integer<font color="#000080">;            </font><font color="#008000"><i>{ Bottom margin in pixels }
        </i></font>LeftMargin<font color="#000080">: </font>Integer<font color="#000080">;              </font><font color="#008000"><i>{ Left margin in pixels }
        </i></font>RightMargin<font color="#000080">: </font>Integer<font color="#000080">;             </font><font color="#008000"><i>{ Right margin in pixels }
        </i></font>PixelsPerInchVertical<font color="#000080">: </font>Integer<font color="#000080">;   </font><font color="#008000"><i>{ Number of pixels per inch along Y axis }
        </i></font>PixelsPerInchHorizontal<font color="#000080">: </font>Integer<font color="#000080">; </font><font color="#008000"><i>{ Number of pixels per inch along X axis }
        </i></font>TotalPageWidthPixels<font color="#000080">: </font>Integer<font color="#000080">;    </font><font color="#008000"><i>{ Full width of page in pixels - includes gutters }

        </i></font>TotalPageHeightPixels<font color="#000080">: </font>Integer<font color="#000080">;   </font><font color="#008000"><i>{ Full height of page in pixels - includes gutters }
        </i></font>TotalPageHeightInches<font color="#000080">: </font>Single<font color="#000080">;    </font><font color="#008000"><i>{ Height of page in inches }
        </i></font>TotalPageWidthInches<font color="#000080">: </font>Single<font color="#000080">;     </font><font color="#008000"><i>{ Width of page in inches }
        </i></font>GutterLeft<font color="#000080">: </font>Integer<font color="#000080">;              </font><font color="#008000"><i>{ Unprintable area on left }
        </i></font>GutterRight<font color="#000080">: </font>Integer<font color="#000080">;             </font><font color="#008000"><i>{ Unprintable area on right }
        </i></font>GutterTop<font color="#000080">: </font>Integer<font color="#000080">;               </font><font color="#008000"><i>{ Unprintable area on top }
        </i></font>GutterBottom<font color="#000080">: </font>Integer<font color="#000080">;            </font><font color="#008000"><i>{ Unprintable area on bottom }
        </i></font>DetailTop<font color="#000080">: </font>Single<font color="#000080">;                </font><font color="#008000"><i>{ Inches from the top where the detail section starts }
        </i></font>DetailBottom<font color="#000080">: </font>Single<font color="#000080">;             </font><font color="#008000"><i>{ Inches from the top where the detail section ends }

        </i></font>LastYPosition<font color="#000080">: </font>Single<font color="#000080">;            </font><font color="#008000"><i>{ The Y position where the last write occurred }
        </i></font>AutoPaging<font color="#000080">: </font>Boolean<font color="#000080">;              </font><font color="#008000"><i>{ Are new pages automatically generated? }
        </i></font>CurrentTab<font color="#000080">: </font>Single<font color="#000080">;               </font><font color="#008000"><i>{ The value of the current tab }
        </i></font>CurrentFontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">30</font><font color="#000080">];
        </font>CurrentFontSize<font color="#000080">: </font>Integer<font color="#000080">;
        </font>CurrentFontStyle<font color="#000080">: </font>TFontStyles<font color="#000080">;
        </font>TextMetrics<font color="#000080">: </font>TTextMetric<font color="#000080">;
        </font>Header<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>HeaderLines<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>THeaderRecord<font color="#000080">;
        </font>Footer<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>FooterLines<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TFooterRecord<font color="#000080">;
        </font>ColumnInformation<font color="#000080">: </font><font color="#FF0000"><b>Array</b></font><font color="#000080">[</font><font color="#800000">1</font><font color="#000080">..</font>Columns<font color="#000080">] </font><font color="#FF0000"><b>of </b></font>TColumnInformationRecord<font color="#000080">;
        </font>PageNumber<font color="#000080">: </font>TPageNumberRecord<font color="#000080">;

        </font>HeaderCoordinates<font color="#000080">: </font>THeaderCoordinates<font color="#000080">;
        </font>FooterCoordinates<font color="#000080">: </font>TFooterCoordinates<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>CalculateLineHeight<font color="#000080">: </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>InchesToPixelsHorizontal<font color="#000080">( </font>Inches<font color="#000080">: </font>Single <font color="#000080">): </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>InchesToPixelsVertical<font color="#000080">( </font>Inches<font color="#000080">: </font>Single <font color="#000080">): </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>PixelsToInchesHorizontal<font color="#000080">( </font>Pixels<font color="#000080">: </font>Integer <font color="#000080">): </font>Single<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>PixelsToInchesVertical<font color="#000080">( </font>Pixels<font color="#000080">: </font>Integer <font color="#000080">): </font>Single<font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>LinesToPixels<font color="#000080">( </font>Line<font color="#000080">:</font>Integer <font color="#000080">): </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>CalculateMeasurements<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>_DrawBox<font color="#000080">( </font>XTop<font color="#000080">:</font>Word<font color="#000080">; </font>YTop<font color="#000080">:</font>Word<font color="#000080">; </font>XBottom<font color="#000080">:</font>Word<font color="#000080">; </font>YBottom<font color="#000080">:</font>Word<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);
     </font><font color="#FF0000"><b>public
        procedure </b></font>Start<font color="#000080">;

        </font><font color="#FF0000"><b>procedure </b></font>Quit<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>Abort<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>SetMargins<font color="#000080">( </font>Top<font color="#000080">:</font>Single<font color="#000080">; </font>Bottom<font color="#000080">:</font>Single<font color="#000080">; </font>Left<font color="#000080">:</font>Single<font color="#000080">; </font>Right<font color="#000080">:</font>Single <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetFontInformation<font color="#000080">( </font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">:</font>Word<font color="#000080">; </font>Style<font color="#000080">: </font>TFontStyles <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteLine<font color="#000080">( </font>X<font color="#000080">:</font>Single<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteLineRight<font color="#000080">( </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteLineCenter<font color="#000080">( </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteLineColumnRight<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteLineColumnCenter<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>DrawLine<font color="#000080">( </font>TopX<font color="#000080">:</font>Single<font color="#000080">; </font>TopY<font color="#000080">:</font>Single<font color="#000080">; </font>BottomX<font color="#000080">:</font>Single<font color="#000080">; </font>BottomY<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetLineWidth<font color="#000080">( </font>Width<font color="#000080">:</font>Word <font color="#000080">);

        </font><font color="#FF0000"><b>function  </b></font>GetLineWidth<font color="#000080">: </font>Word<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>SetTab<font color="#000080">( </font>Inches<font color="#000080">:</font>Single <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>NewPage<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetLinesPerPage<font color="#000080">: </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>GetPixelsPerInch<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>X<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Y<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>GetPixelsPerPage<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>X<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Y<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>GetGutter<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Top<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Bottom<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Left<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Right<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>function  </b></font>GetTextWidth<font color="#000080">( </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetLineHeightPixels<font color="#000080">: </font>Word<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetLineHeightInches<font color="#000080">: </font>Single<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetPageNumber<font color="#000080">:</font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetColumnsPerLine<font color="#000080">: </font>Integer<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>SetOrientation<font color="#000080">( </font>Orient<font color="#000080">: </font>TPrinterOrientation <font color="#000080">);

        </font><font color="#FF0000"><b>procedure </b></font>SetHeaderInformation<font color="#000080">( </font>Line<font color="#000080">:</font>Integer<font color="#000080">; </font>YPosition<font color="#000080">: </font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; 
                     </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>FontSize<font color="#000080">: </font>Word<font color="#000080">; </font>FontStyle<font color="#000080">: </font>TFontStyles <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetFooterInformation<font color="#000080">( </font>Line<font color="#000080">:</font>Integer<font color="#000080">; </font>YPosition<font color="#000080">: </font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; 
                     </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>FontSize<font color="#000080">: </font>Word<font color="#000080">; </font>FontStyle<font color="#000080">: </font>TFontStyles <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>WriteHeader<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>WriteFooter<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>SaveCurrentFont<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>RestoreCurrentFont<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>SetDetailTopBottom<font color="#000080">( </font>Top<font color="#000080">: </font>Single<font color="#000080">; </font>Bottom<font color="#000080">: </font>Single <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetAutoPaging<font color="#000080">( </font>Value<font color="#000080">: </font>Boolean <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetPageNumberInformation<font color="#000080">( </font>YPosition<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; 
                     </font>FontSize<font color="#000080">:</font>Word<font color="#000080">; </font>FontStyle<font color="#000080">:</font>TFontStyles <font color="#000080">);

        </font><font color="#FF0000"><b>procedure </b></font>WritePageNumber<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>WriteLineColumn<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>DrawBox<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>DrawBoxShaded<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetHeaderDimensions<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">;
                  </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetFooterDimensions<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">;
                  </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>CreateColumn<font color="#000080">( </font>Number<font color="#000080">:</font>Word<font color="#000080">; </font>XPosition<font color="#000080">:</font>Single<font color="#000080">; </font>Length<font color="#000080">:</font>Single <font color="#000080">);
        </font><font color="#FF0000"><b>procedure </b></font>SetYPosition<font color="#000080">( </font>YPosition<font color="#000080">:</font>Single <font color="#000080">);
        </font><font color="#FF0000"><b>function  </b></font>GetYPosition<font color="#000080">: </font>Single<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>NextLine<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetLinesLeft<font color="#000080">: </font>Word<font color="#000080">;
        </font><font color="#FF0000"><b>function  </b></font>GetLinesInDetailArea<font color="#000080">: </font>Word<font color="#000080">;

        </font><font color="#FF0000"><b>procedure </b></font>SetTopOfPage<font color="#000080">;
        </font><font color="#FF0000"><b>procedure </b></font>NewLines<font color="#000080">( </font>Number<font color="#000080">:</font>Word <font color="#000080">);
        </font><font color="#FF0000"><b>function </b></font>GetFontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
        </font><font color="#FF0000"><b>function </b></font>GetFontSize<font color="#000080">: </font>Word<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure </b></font>TPrintObject<font color="#000080">.</font>Start<font color="#000080">;

   </font><font color="#008000"><i>{ This function MUST be called first before any other printing function }

   </i></font><font color="#FF0000"><b>var
      </b></font>Top<font color="#000080">,</font>Bottom<font color="#000080">,</font>Left<font color="#000080">,</font>Right<font color="#000080">: </font>Single<font color="#000080">;
      </font>I<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>BeginDoc<font color="#000080">;

   </font>AutoPaging <font color="#000080">:= </font>True<font color="#000080">;

   </font>CalculateMeasurements<font color="#000080">;

   </font>PageNumber<font color="#000080">.</font>Text <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;

   </font>Top <font color="#000080">:= </font>PixelsToInchesVertical<font color="#000080">( </font>GutterTop <font color="#000080">);
   </font>Bottom <font color="#000080">:= </font>PixelsToInchesVertical<font color="#000080">( </font>GutterBottom <font color="#000080">);
   </font>Left <font color="#000080">:= </font>PixelsToInchesHorizontal<font color="#000080">( </font>GutterLeft <font color="#000080">);
   </font>Right <font color="#000080">:= </font>PixelsToInchesHorizontal<font color="#000080">( </font>GutterRight <font color="#000080">);
   </font>SetMargins<font color="#000080">( </font>Top<font color="#000080">,</font>Bottom<font color="#000080">,</font>Left<font color="#000080">,</font>Right <font color="#000080">);

   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>HeaderLines <font color="#FF0000"><b>Do

      </b></font>Header<font color="#000080">[</font>I<font color="#000080">].</font>Text <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>Boxed <font color="#000080">:= </font>False<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>Shading <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>FooterLines <font color="#FF0000"><b>Do
      </b></font>Footer<font color="#000080">[</font>I<font color="#000080">].</font>Text <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>Boxed <font color="#000080">:= </font>False<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>Shading <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;

   </font>CurrentTab <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;

   </font>LastYPosition <font color="#000080">:= </font><font color="#800000">0.0</font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;              

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>Quit<font color="#000080">;

   </font><font color="#008000"><i>{ 'Quit' must always be called when printing is completed }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>WriteHeader<font color="#000080">;
   </font>WriteFooter<font color="#000080">;
   </font>WritePageNumber<font color="#000080">;

   </font>Printer<font color="#000080">.</font>EndDoc
   <font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetMargins<font color="#000080">( </font>Top<font color="#000080">:</font>Single<font color="#000080">; </font>Bottom<font color="#000080">:</font>Single<font color="#000080">; </font>Left<font color="#000080">:</font>Single<font color="#000080">; </font>Right<font color="#000080">:</font>Single <font color="#000080">);

   </font><font color="#008000"><i>{ Set the top, bottom, left and right margins in inches }


   </i></font><font color="#FF0000"><b>var
      </b></font>Value<font color="#000080">: </font>Single<font color="#000080">;
      </font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ If the sum of the left and right margins exceeds the width of the page,
     set the left margin to the value of 'GutterLeft' and set the right
     margin to the value of 'GutterRight' }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Left <font color="#000080">+ </font>Right <font color="#000080">&gt;= </font>TotalPageWidthInches <font color="#000080">) </font><font color="#FF0000"><b>Then
      Begin
      </b></font>Left <font color="#000080">:= </font>GutterLeft<font color="#000080">;
      </font>Right <font color="#000080">:= </font>GutterRight<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Left <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Left <font color="#000080">:= </font>GutterLeft<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Right <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Right <font color="#000080">:= </font>GutterRight<font color="#000080">;

   </font><font color="#008000"><i>{ If the sum of the top and bottom margins exceeds the height of the 
     page, set the top margin to the value of 'GutterTop' and set the 
     bottom margin to the value of 'GutterBottom' }

   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Top <font color="#000080">+ </font>Bottom <font color="#000080">&gt;= </font>TotalPageHeightInches <font color="#000080">) </font><font color="#FF0000"><b>Then
      Begin
      </b></font>Top <font color="#000080">:= </font>GutterTop<font color="#000080">;
      </font>Bottom <font color="#000080">:= </font>GutterBottom<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Top <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Top <font color="#000080">:= </font>GutterTop<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Bottom <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Bottom <font color="#000080">:= </font>GutterBottom<font color="#000080">;

   </font><font color="#008000"><i>{ Convert everything to pixels }
   </i></font>TopMargin <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>Top <font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>TopMargin <font color="#000080">&lt; </font>GutterTop <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>TopMargin <font color="#000080">:= </font>GutterTop<font color="#000080">;

   </font>BottomMargin <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>Bottom <font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>BottomMargin <font color="#000080">&lt; </font>GutterBottom <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>BottomMargin <font color="#000080">:= </font>GutterBottom<font color="#000080">;

   </font>LeftMargin <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>Left <font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>LeftMargin <font color="#000080">&lt; </font>GutterLeft <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>LeftMargin <font color="#000080">:= </font>GutterLeft<font color="#000080">;

   </font>RightMargin <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>Right <font color="#000080">);

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>RightMargin <font color="#000080">&lt; </font>GutterRight <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>RightMargin <font color="#000080">:= </font>GutterRight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLine<font color="#000080">( </font>X<font color="#000080">:</font>Single<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Write some text.  The parameters represent inches from the left ('X')
     and top ('Y') margins. }

   </i></font><font color="#FF0000"><b>var
      </b></font>XPixels<font color="#000080">: </font>Integer<font color="#000080">;
      </font>YPixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ How many pixels are there in the inches represented by 'X'? }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>X <font color="#000080">&gt;= </font><font color="#800000">0.0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>XPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>X <font color="#000080">)
   </font><font color="#FF0000"><b>Else
      </b></font>XPixels <font color="#000080">:= </font>LeftMargin<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>XPixels <font color="#000080">&lt; </font>GutterLeft <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>XPixels <font color="#000080">:= </font>GutterLeft<font color="#000080">;

   </font><font color="#008000"><i>{ If there is a tab set, increase 'XPixels' by the amount of the tab }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>CurrentTab <font color="#000080">&gt; </font><font color="#800000">0.0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then

      </b></font>Inc<font color="#000080">( </font>XPixels<font color="#000080">,</font>InchesToPixelsHorizontal<font color="#000080">(</font>CurrentTab<font color="#000080">) );

   </font><font color="#008000"><i>{ How many pixels are there in the inches represented by 'Y'? }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Y <font color="#000080">&gt; -</font><font color="#800000">0.01 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font><font color="#008000"><i>{ Printing will occur at an absolute location from the top of the 
        page. }
      </i></font><font color="#FF0000"><b>Begin
      </b></font>YPixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>Y <font color="#000080">);
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>YPixels <font color="#000080">&lt; </font>GutterTop <font color="#000080">) </font><font color="#FF0000"><b>Then
         </b></font>YPixels <font color="#000080">:= </font>GutterTop<font color="#000080">;
      </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>YPixels <font color="#000080">&gt; </font>TotalPageHeightPixels <font color="#000080">) </font><font color="#FF0000"><b>Then
         </b></font>YPixels <font color="#000080">:= </font>TotalPageHeightPixels <font color="#000080">- </font>GutterBottom<font color="#000080">;

      </font>LastYPosition <font color="#000080">:= </font>Y<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Y <font color="#000080">= -</font><font color="#800000">1.0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font><font color="#008000"><i>{ Write the text at the next line }
      </i></font><font color="#FF0000"><b>Begin
      If </b></font><font color="#000080">( </font>AutoPaging <font color="#000080">= </font>True <font color="#000080">) </font><font color="#FF0000"><b>Then
         Begin
         </b></font><font color="#008000"><i>{ If the next line we're going to write to exceeds beyond the 

           bottom of the detail section, issue a new page }
         </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>LastYPosition <font color="#000080">+ </font>GetLineHeightInches <font color="#000080">&gt; </font>DetailBottom <font color="#000080">) </font><font color="#FF0000"><b>Then
            </b></font>NewPage<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font>YPixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>LastYPosition <font color="#000080">+ </font>GetLineHeightInches <font color="#000080">);
      </font>LastYPosition <font color="#000080">:= </font>LastYPosition <font color="#000080">+ </font>GetLineHeightInches<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Y <font color="#000080">= -</font><font color="#800000">2.0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font><font color="#008000"><i>{ Write the text on the current line }
      </i></font>YPixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>LastYPosition <font color="#000080">);      

   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextOut<font color="#000080">( </font>XPixels<font color="#000080">-</font>GutterLeft<font color="#000080">,</font>YPixels<font color="#000080">-</font>GutterTop<font color="#000080">,</font>Text <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLineColumn<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Write text, left aligned against the column represented by
     'ColumnInformation[ColumnNumber]' }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>WriteLine<font color="#000080">( </font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>XPosition<font color="#000080">,</font>Y<font color="#000080">,</font>Text <font color="#000080">);

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLineColumnRight<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Write text, right aligned against the column represented by
     'ColumnInformation[ColumnNumber]' }

   </i></font><font color="#FF0000"><b>var
      </b></font>PixelLength<font color="#000080">: </font>Word<font color="#000080">;
      </font>StartPixel<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ How many pixels does the text in 'Text' require? }
   </i></font>PixelLength <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font>Text <font color="#000080">);

   </font><font color="#008000"><i>{ Calculate where printing should start }
   </i></font>StartPixel <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>XPosition <font color="#000080">+ 
      </font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>Length <font color="#000080">) - </font>PixelLength<font color="#000080">;

   </font>SetTab<font color="#000080">( </font><font color="#800000">0.0 </font><font color="#000080">);
   </font>WriteLine<font color="#000080">( </font>PixelsToInchesHorizontal<font color="#000080">(</font>StartPixel<font color="#000080">),</font>Y<font color="#000080">,</font>Text <font color="#000080">);
   </font>SetTab<font color="#000080">( </font>CurrentTab <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLineRight<font color="#000080">( </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Print a line of text right justified 'Y' inches from the top }

   </i></font><font color="#FF0000"><b>var
      </b></font>PixelLength<font color="#000080">: </font>Word<font color="#000080">;
      </font>StartPixel<font color="#000080">: </font>Word<font color="#000080">;


   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ How many pixels does the text in 'Text' require? }
   </i></font>PixelLength <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font>Text <font color="#000080">);

   </font><font color="#008000"><i>{ Calculate where printing should start }
   </i></font>StartPixel <font color="#000080">:= (</font>TotalPageWidthPixels<font color="#000080">-</font>GutterLeft<font color="#000080">-</font>GutterRight<font color="#000080">) - </font>PixelLength<font color="#000080">;

   </font>SetTab<font color="#000080">( </font><font color="#800000">0.0 </font><font color="#000080">);       
   </font>WriteLine<font color="#000080">( </font>PixelsToInchesHorizontal<font color="#000080">(</font>StartPixel<font color="#000080">),</font>Y<font color="#000080">,</font>Text <font color="#000080">);
   </font>SetTab<font color="#000080">( </font>CurrentTab <font color="#000080">);       
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLineCenter<font color="#000080">( </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Print a line of text centered at Y inches from the top }

   </i></font><font color="#FF0000"><b>var
      </b></font>PixelLength<font color="#000080">: </font>Integer<font color="#000080">;
      </font>StartPixel<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ How many pixels does the text in 'Text' require? }
   </i></font>PixelLength <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font>Text <font color="#000080">);

   </font><font color="#008000"><i>{ Calculate where printing should start }
   </i></font>StartPixel <font color="#000080">:= ((</font>GutterLeft<font color="#000080">+(</font>TotalPageWidthPixels<font color="#000080">-</font>GutterRight<font color="#000080">)) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">) - (</font>PixelLength <font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">);   

   </font>SetTab<font color="#000080">( </font><font color="#800000">0.0 </font><font color="#000080">);
   </font>WriteLine<font color="#000080">( </font>PixelsToInchesHorizontal<font color="#000080">(</font>StartPixel<font color="#000080">),</font>Y<font color="#000080">,</font>Text <font color="#000080">);

   </font>SetTab<font color="#000080">( </font>CurrentTab <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteLineColumnCenter<font color="#000080">( </font>ColumnNumber<font color="#000080">:</font>Word<font color="#000080">; </font>Y<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">);

   </font><font color="#008000"><i>{ Print a line of text centered within the column number represented by
     'ColumnNumber', at Y inches from the top }

   </i></font><font color="#FF0000"><b>var
      </b></font>PixelLength<font color="#000080">: </font>Integer<font color="#000080">;
      </font>StartPixel<font color="#000080">: </font>Integer<font color="#000080">;
      </font>Pixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ How many pixels does the text in 'Text' require? }
   </i></font>PixelLength <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font>Text <font color="#000080">);

   </font><font color="#008000"><i>{ Calculate where printing should start }
   </i></font>Pixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>Length <font color="#000080">);
   </font>StartPixel <font color="#000080">:= (</font>InchesToPixelsHorizontal<font color="#000080">( </font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>Length <font color="#000080">) </font><font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">) +
      </font>InchesToPixelsHorizontal<font color="#000080">(</font>ColumnInformation<font color="#000080">[</font>ColumnNumber<font color="#000080">].</font>XPosition<font color="#000080">) - (</font>PixelLength <font color="#FF0000"><b>Div </b></font><font color="#800000">2</font><font color="#000080">);

   </font>SetTab<font color="#000080">( </font><font color="#800000">0.0 </font><font color="#000080">);
   </font>WriteLine<font color="#000080">( </font>PixelsToInchesHorizontal<font color="#000080">(</font>StartPixel<font color="#000080">),</font>Y<font color="#000080">,</font>Text <font color="#000080">);
   </font>SetTab<font color="#000080">( </font>CurrentTab <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>DrawLine<font color="#000080">( </font>TopX<font color="#000080">:</font>Single<font color="#000080">; </font>TopY<font color="#000080">:</font>Single<font color="#000080">; </font>BottomX<font color="#000080">:</font>Single<font color="#000080">; </font>BottomY<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#008000"><i>{ Draw a line beginning at a particular X,Y coordinate and ending at a
     particular X,Y coordinate. }

   </i></font><font color="#FF0000"><b>var
      </b></font>TopXPixels<font color="#000080">, </font>BottomXPixels<font color="#000080">, </font>TopYPixels<font color="#000080">, </font>BottomYPixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>TopXPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>TopX <font color="#000080">);
   </font>BottomXPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>BottomX <font color="#000080">);
   </font>TopYPixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>TopY <font color="#000080">);
   </font>BottomYPixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>BottomY <font color="#000080">);

   </font>Dec<font color="#000080">( </font>TopXPixels<font color="#000080">,</font>GutterLeft <font color="#000080">);
   </font>Dec<font color="#000080">( </font>BottomXPixels<font color="#000080">,</font>GutterLeft <font color="#000080">);
   </font>Dec<font color="#000080">( </font>TopYPixels<font color="#000080">,</font>GutterTop <font color="#000080">);
   </font>Dec<font color="#000080">( </font>BottomYPixels<font color="#000080">,</font>GutterTop <font color="#000080">);


   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Pen<font color="#000080">.</font>Width <font color="#000080">:= </font>LineWidth<font color="#000080">;

   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>MoveTo<font color="#000080">( </font>TopXPixels<font color="#000080">,</font>TopYPixels <font color="#000080">);
   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>LineTo<font color="#000080">( </font>BottomXPixels<font color="#000080">,</font>BottomYPixels <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetFontInformation<font color="#000080">( </font>Name<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Size<font color="#000080">:</font>Word<font color="#000080">; </font>Style<font color="#000080">: </font>TFontStyles <font color="#000080">);

   </font><font color="#008000"><i>{ Change the current font information }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name <font color="#000080">:= </font>Name<font color="#000080">;
   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Size <font color="#000080">:= </font>Size<font color="#000080">;
   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Style <font color="#000080">:= </font>Style<font color="#000080">;

   </font>CalculateMeasurements<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetFontName<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Return the current font name }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetFontSize<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#008000"><i>{ Return the current font size }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetOrientation<font color="#000080">( </font>Orient<font color="#000080">: </font>TPrinterOrientation <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>Orientation <font color="#000080">:= </font>Orient<font color="#000080">;
                                       
   </font>CalculateMeasurements<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>CalculateLineHeight<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Calculate the height of a line plus the normal amount of space between
     each line }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>TextMetrics<font color="#000080">.</font>tmHeight <font color="#000080">+ </font>TextMetrics<font color="#000080">.</font>tmExternalLeading<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>NewPage<font color="#000080">;

   </font><font color="#008000"><i>{ Issue a new page }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>WriteHeader<font color="#000080">;
   </font>WriteFooter<font color="#000080">;
   </font>WritePageNumber<font color="#000080">;
   </font>LastYPosition <font color="#000080">:= </font>DetailTop <font color="#000080">- </font>GetLineHeightInches<font color="#000080">;

   </font>Printer<font color="#000080">.</font>NewPage<font color="#000080">;

   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetPageNumber<font color="#000080">;

   </font><font color="#008000"><i>{ Return the current page number }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Printer<font color="#000080">.</font>PageNumber<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetTextWidth<font color="#000080">( </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String </b></font><font color="#000080">): </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Return the width of the text contained in 'Text' in pixels }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font>Text <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLineHeightPixels<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>CalculateLineHeight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLineHeightInches<font color="#000080">: </font>Single<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>PixelsToInchesVertical<font color="#000080">( </font>GetLineHeightPixels <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>_DrawBox<font color="#000080">( </font>XTop<font color="#000080">:</font>Word<font color="#000080">; </font>YTop<font color="#000080">:</font>Word<font color="#000080">; </font>XBottom<font color="#000080">:</font>Word<font color="#000080">; </font>YBottom<font color="#000080">:</font>Word<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#008000"><i>{ The low level routine which actually draws the box and shades it as

     desired. The paramaters are in pixels and not inches. }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Pen<font color="#000080">.</font>Width <font color="#000080">:= </font>LineWidth<font color="#000080">;
   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Brush<font color="#000080">.</font>Color <font color="#000080">:= </font>RGB<font color="#000080">( </font>Shading<font color="#000080">,</font>Shading<font color="#000080">,</font>Shading <font color="#000080">);

   </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Rectangle<font color="#000080">( </font>XTop<font color="#000080">,</font>YTop<font color="#000080">,</font>XBottom<font color="#000080">,</font>YBottom <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>DrawBox<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#008000"><i>{ Draw a box at the X,Y coordinates passed in the parameters }

   </i></font><font color="#FF0000"><b>var
      </b></font>BLinePixels<font color="#000080">,</font>BColPixels<font color="#000080">,</font>ELinePixels<font color="#000080">,</font>EColPixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>BLinePixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>YTop <font color="#000080">) - </font>GutterTop<font color="#000080">;
   </font>ELinePixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>YBottom <font color="#000080">) - </font>GutterTop<font color="#000080">;

   </font>BColPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>XTop <font color="#000080">) - </font>GutterLeft<font color="#000080">;
   </font>EColPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>XBottom <font color="#000080">) - </font>GutterLeft<font color="#000080">;

   </font>_DrawBox<font color="#000080">( </font>BColPixels<font color="#000080">,</font>BLinePixels<font color="#000080">,</font>EColPixels<font color="#000080">,</font>ELinePixels<font color="#000080">,</font>LineWidth<font color="#000080">,</font><font color="#800000">255 </font><font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>DrawBoxShaded<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#008000"><i>{ Draw a box at the X,Y coordinates passed in the parameters }


   </i></font><font color="#FF0000"><b>var
      </b></font>BLinePixels<font color="#000080">,</font>BColPixels<font color="#000080">,</font>ELinePixels<font color="#000080">,</font>EColPixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>BLinePixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>YTop <font color="#000080">) - </font>GutterTop<font color="#000080">;
   </font>ELinePixels <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>YBottom <font color="#000080">) - </font>GutterTop<font color="#000080">;

   </font>BColPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>XTop <font color="#000080">) - </font>GutterLeft<font color="#000080">;
   </font>EColPixels <font color="#000080">:= </font>InchesToPixelsHorizontal<font color="#000080">( </font>XBottom <font color="#000080">) - </font>GutterLeft<font color="#000080">;

   </font>_DrawBox<font color="#000080">( </font>BColPixels<font color="#000080">,</font>BLinePixels<font color="#000080">,</font>EColPixels<font color="#000080">,</font>ELinePixels<font color="#000080">,</font>LineWidth<font color="#000080">,</font>Shading <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLinesPerPage<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Return the number of lines on the entire page }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= (</font>TotalPageHeightPixels <font color="#000080">- </font>GutterTop <font color="#000080">- </font>GutterBottom<font color="#000080">) </font><font color="#FF0000"><b>Div </b></font>CalculateLineHeight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLinesInDetailArea<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#008000"><i>{ Return the number of lines in the detail area }

   </i></font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>InchesToPixelsVertical<font color="#000080">( </font>DetailBottom <font color="#000080">- </font>DetailTop <font color="#000080">) </font><font color="#FF0000"><b>Div </b></font>CalculateLineHeight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;


</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>GetPixelsPerInch<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>X<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Y<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>X <font color="#000080">:= </font>PixelsPerInchHorizontal<font color="#000080">;
   </font>Y <font color="#000080">:= </font>PixelsPerInchVertical<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>GetPixelsPerPage<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>X<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Y<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>X <font color="#000080">:= </font>TotalPageWidthPixels <font color="#000080">- </font>GutterLeft <font color="#000080">- </font>GutterRight<font color="#000080">;
   </font>Y <font color="#000080">:= </font>TotalPageHeightPixels <font color="#000080">- </font>GutterTop <font color="#000080">- </font>GutterBottom<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>GetGutter<font color="#000080">( </font><font color="#FF0000"><b>var </b></font>Top<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Bottom<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Left<font color="#000080">:</font>Word<font color="#000080">; </font><font color="#FF0000"><b>var </b></font>Right<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>Top <font color="#000080">:= </font>GutterTop<font color="#000080">;
   </font>Bottom <font color="#000080">:= </font>GutterBottom<font color="#000080">;
   </font>Left <font color="#000080">:= </font>GutterLeft<font color="#000080">;
   </font>Right <font color="#000080">:= </font>GutterRight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>Abort<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>Abort<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetColumnsPerLine<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ How many columns are there in a Line? }


   </i></font><font color="#FF0000"><b>var
      </b></font>Pixels<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Pixels <font color="#000080">:= </font>TotalPageWidthPixels <font color="#000080">- </font>GutterLeft <font color="#000080">- </font>GutterRight<font color="#000080">;

   </font>Result <font color="#000080">:= </font>Pixels <font color="#FF0000"><b>Div </b></font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>TextWidth<font color="#000080">( </font><font color="#800000">'B' </font><font color="#000080">);      
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;  

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>InchesToPixelsHorizontal<font color="#000080">( </font>Inches<font color="#000080">: </font>Single <font color="#000080">): </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Convert the horizontal inches represented in 'Inches' to pixels }

   </i></font><font color="#FF0000"><b>var
      </b></font>Value<font color="#000080">: </font>Single<font color="#000080">;
      </font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>I<font color="#000080">: </font>Integer<font color="#000080">;
                  
   </font><font color="#FF0000"><b>Begin
   </b></font>Value <font color="#000080">:= </font>Inches <font color="#000080">* </font>PixelsPerInchHorizontal<font color="#000080">;
   </font>Buffer <font color="#000080">:= </font>FloatToStr<font color="#000080">( </font>Value <font color="#000080">);

   </font><font color="#008000"><i>{ If there is a decimal point in 'Buffer', remove it. }
   </i></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While</b></font><font color="#000080">( (</font>Buffer<font color="#000080">[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>I <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Buffer<font color="#000080">)) ) </font><font color="#FF0000"><b>Do
      </b></font>Inc<font color="#000080">( </font>I <font color="#000080">);
   </font>Buffer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">( </font>I<font color="#000080">-</font><font color="#800000">1 </font><font color="#000080">);


   </font>Result <font color="#000080">:= </font>StrToInt<font color="#000080">( </font>Buffer <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>InchesToPixelsVertical<font color="#000080">( </font>Inches<font color="#000080">: </font>Single <font color="#000080">): </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Convert the vertical inches represented in 'Inches' to pixels }

   </i></font><font color="#FF0000"><b>var
      </b></font>Value<font color="#000080">: </font>Single<font color="#000080">;
      </font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>I<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Value <font color="#000080">:= </font>Inches <font color="#000080">* </font>PixelsPerInchVertical<font color="#000080">;
   </font>Buffer <font color="#000080">:= </font>FloatToStr<font color="#000080">( </font>Value <font color="#000080">);

      </font><font color="#008000"><i>{ If there is a decimal point in 'Buffer', remove it. }
   </i></font>I <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;
   </font><font color="#FF0000"><b>While</b></font><font color="#000080">( (</font>Buffer<font color="#000080">[</font>I<font color="#000080">] &lt;&gt; </font><font color="#800000">'.'</font><font color="#000080">) </font><font color="#FF0000"><b>And </b></font><font color="#000080">(</font>I <font color="#000080">&lt;= </font>Length<font color="#000080">(</font>Buffer<font color="#000080">)) ) </font><font color="#FF0000"><b>Do
      </b></font>Inc<font color="#000080">( </font>I <font color="#000080">);
   </font>Buffer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">( </font>I<font color="#000080">-</font><font color="#800000">1 </font><font color="#000080">);

   </font>Result <font color="#000080">:= </font>StrToInt<font color="#000080">( </font>Buffer <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>PixelsToInchesHorizontal<font color="#000080">( </font>Pixels<font color="#000080">: </font>Integer <font color="#000080">): </font>Single<font color="#000080">;


   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Pixels <font color="#000080">/ </font>PixelsPerInchHorizontal<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>PixelsToInchesVertical<font color="#000080">( </font>Pixels<font color="#000080">: </font>Integer <font color="#000080">): </font>Single<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Pixels <font color="#000080">/ </font>PixelsPerInchVertical<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>LinesToPixels<font color="#000080">( </font>Line<font color="#000080">:</font>Integer <font color="#000080">): </font>Integer<font color="#000080">;

   </font><font color="#008000"><i>{ Calculate the number of vertical pixels in 'Line' }

   </i></font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">( </font>Line <font color="#000080">&lt;= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Line <font color="#000080">:= </font><font color="#800000">1</font><font color="#000080">;

   </font>Result <font color="#000080">:= (</font>Line<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">) * </font>CalculateLineHeight<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetLineWidth<font color="#000080">( </font>Width<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Pen<font color="#000080">.</font>Width <font color="#000080">:= </font>Width<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLineWidth<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Pen<font color="#000080">.</font>Width<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>CalculateMeasurements<font color="#000080">;


   </font><font color="#008000"><i>{ Calculate some necessary measurements.  Thanks to Robert Fabiszak
     CompuServe: 70304,2047 for the Escape() Windows API calls. }

   </i></font><font color="#FF0000"><b>var
      </b></font>pt<font color="#000080">: </font>TPoint<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font><font color="#008000"><i>{ Call the Windows API function GetTextMetrics() to get the specifics
     of the particular font. }
   </i></font>GetTextMetrics<font color="#000080">( </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">,</font>TextMetrics <font color="#000080">);

   </font><font color="#008000"><i>{ Calculate the number of pixels per inch vertical and horizontal.
     'GetDeviceCaps' is a Windows API call. }
   </i></font>PixelsPerInchVertical <font color="#000080">:= </font>GetDeviceCaps<font color="#000080">( </font>Printer<font color="#000080">.</font>Handle<font color="#000080">,</font>LOGPIXELSY <font color="#000080">);
   </font>PixelsPerInchHorizontal <font color="#000080">:= </font>GetDeviceCaps<font color="#000080">( </font>Printer<font color="#000080">.</font>Handle<font color="#000080">,</font>LOGPIXELSX <font color="#000080">);

   </font><font color="#008000"><i>{ Get the gutter on the left and top.  'Escape' is a Windows API 

     call. }
   </i></font>Escape<font color="#000080">( </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">,</font>GETPRINTINGOFFSET<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">,@</font>pt <font color="#000080">);
   </font>GutterLeft <font color="#000080">:= </font>pt<font color="#000080">.</font>X<font color="#000080">;
   </font>GutterTop <font color="#000080">:= </font>pt<font color="#000080">.</font>Y<font color="#000080">;

   </font>Escape<font color="#000080">( </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Handle<font color="#000080">,</font>GETPHYSPAGESIZE<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#FF0000"><b>Nil</b></font><font color="#000080">,@</font>pt <font color="#000080">);
   </font>TotalPageWidthPixels <font color="#000080">:= </font>pt<font color="#000080">.</font>X<font color="#000080">;
   </font>TotalPageHeightPixels <font color="#000080">:= </font>pt<font color="#000080">.</font>Y<font color="#000080">;
   </font>TotalPageWidthInches <font color="#000080">:= </font>pt<font color="#000080">.</font>X <font color="#000080">/ </font>PixelsPerInchHorizontal<font color="#000080">;
   </font>TotalPageHeightInches <font color="#000080">:= </font>pt<font color="#000080">.</font>Y <font color="#000080">/ </font>PixelsPerInchVertical<font color="#000080">;

   </font>GutterRight <font color="#000080">:= </font>TotalPageWidthPixels <font color="#000080">- </font>GutterLeft <font color="#000080">- </font>Printer<font color="#000080">.</font>PageWidth<font color="#000080">;
   </font>GutterBottom <font color="#000080">:= </font>TotalPageHeightPixels <font color="#000080">- </font>GutterTop <font color="#000080">- </font>Printer<font color="#000080">.</font>PageHeight<font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>TopMargin <font color="#000080">&lt; </font>GutterTop <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>TopMargin <font color="#000080">:= </font>GutterTop<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>BottomMargin <font color="#000080">&lt; </font>GutterBottom <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>BottomMargin <font color="#000080">:= </font>GutterBottom<font color="#000080">;
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>LeftMargin <font color="#000080">&lt; </font>GutterLeft <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>LeftMargin <font color="#000080">:= </font>GutterLeft<font color="#000080">;

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>RightMargin <font color="#000080">&lt; </font>GutterRight <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>RightMargin <font color="#000080">:= </font>GutterRight<font color="#000080">;   
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetHeaderInformation<font color="#000080">( </font>Line<font color="#000080">:</font>Integer<font color="#000080">; </font>YPosition<font color="#000080">: </font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; 
   </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>FontSize<font color="#000080">: </font>Word<font color="#000080">; </font>FontStyle<font color="#000080">: </font>TFontStyles <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">( </font>Line <font color="#000080">&gt; </font>HeaderLines <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;

   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>Text <font color="#000080">:= </font>Text<font color="#000080">;
   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>YPosition <font color="#000080">:= </font>YPosition<font color="#000080">;
   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>Alignment <font color="#000080">:= </font>Alignment<font color="#000080">;
   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>FontName <font color="#000080">:= </font>FontName<font color="#000080">;
   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>FontSize <font color="#000080">:= </font>FontSize<font color="#000080">;
   </font>Header<font color="#000080">[</font>Line<font color="#000080">].</font>FontStyle <font color="#000080">:= </font>FontStyle<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetFooterInformation<font color="#000080">( </font>Line<font color="#000080">:</font>Integer<font color="#000080">; </font>YPosition<font color="#000080">: </font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; 

   </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>FontSize<font color="#000080">: </font>Word<font color="#000080">; </font>FontStyle<font color="#000080">: </font>TFontStyles <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   If </b></font><font color="#000080">( </font>Line <font color="#000080">&gt; </font>FooterLines <font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>Exit<font color="#000080">;

   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>Text <font color="#000080">:= </font>Text<font color="#000080">;
   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>YPosition <font color="#000080">:= </font>YPosition<font color="#000080">;
   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>Alignment <font color="#000080">:= </font>Alignment<font color="#000080">;
   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>FontName <font color="#000080">:= </font>FontName<font color="#000080">;
   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>FontSize <font color="#000080">:= </font>FontSize<font color="#000080">;
   </font>Footer<font color="#000080">[</font>Line<font color="#000080">].</font>FontStyle <font color="#000080">:= </font>FontStyle<font color="#000080">;   
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteHeader<font color="#000080">;

   </font><font color="#008000"><i>{ If any headers are defined, write them }

   </i></font><font color="#FF0000"><b>var
      </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>SaveCurrentFont<font color="#000080">;
   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>HeaderLines <font color="#FF0000"><b>Do
      Begin
      If </b></font><font color="#000080">( </font>Length<font color="#000080">(</font>Header<font color="#000080">[</font>I<font color="#000080">].</font>Text<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then

         Begin
         With </b></font>Header<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>Do
            Begin
            </b></font>SetFontInformation<font color="#000080">( </font>FontName<font color="#000080">,</font>FontSize<font color="#000080">,</font>FontStyle <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLine<font color="#000080">( </font>LeftMargin<font color="#000080">, </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLineCenter<font color="#000080">( </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">2 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLineRight<font color="#000080">( </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

      </font>RestoreCurrentFont<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Does the user desire a box around the header? }
   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>HeaderCoordinates<font color="#000080">.</font>Boxed <font color="#000080">= </font>True <font color="#000080">) </font><font color="#FF0000"><b>Then
      Begin
      If </b></font><font color="#000080">( </font>HeaderCoordinates<font color="#000080">.</font>Shading <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then

         </b></font>DrawBoxShaded<font color="#000080">( </font>HeaderCoordinates<font color="#000080">.</font>XTop<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>YTop<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>XBottom<font color="#000080">,
            </font>HeaderCoordinates<font color="#000080">.</font>YBottom<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>LineWidth<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>Shading<font color="#000080">)
      </font><font color="#FF0000"><b>Else
         </b></font>DrawBox<font color="#000080">( </font>HeaderCoordinates<font color="#000080">.</font>XTop<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>YTop<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>XBottom<font color="#000080">,
            </font>HeaderCoordinates<font color="#000080">.</font>YBottom<font color="#000080">,</font>HeaderCoordinates<font color="#000080">.</font>LineWidth <font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WriteFooter<font color="#000080">;

   </font><font color="#008000"><i>{ If any footers are defined, write them }

   </i></font><font color="#FF0000"><b>var
      </b></font>I<font color="#000080">: </font>Integer<font color="#000080">;
      </font>Temp<font color="#000080">: </font>Boolean<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>SaveCurrentFont<font color="#000080">;

   </font><font color="#008000"><i>{ Set 'AutoPaging' off.  Otherwise the footer will not get written
     correctly. }
   </i></font>Temp <font color="#000080">:= </font>AutoPaging<font color="#000080">;
   </font>AutoPaging <font color="#000080">:= </font>False<font color="#000080">;
      
   </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>FooterLines <font color="#FF0000"><b>Do

      Begin
      If </b></font><font color="#000080">( </font>Length<font color="#000080">(</font>Footer<font color="#000080">[</font>I<font color="#000080">].</font>Text<font color="#000080">) &gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
         Begin
         With </b></font>Footer<font color="#000080">[</font>I<font color="#000080">] </font><font color="#FF0000"><b>Do
            Begin
            </b></font>SetFontInformation<font color="#000080">( </font>FontName<font color="#000080">,</font>FontSize<font color="#000080">,</font>FontStyle <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLine<font color="#000080">( </font>LeftMargin<font color="#000080">, </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLineCenter<font color="#000080">( </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>Alignment <font color="#000080">= </font><font color="#800000">2 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
               </b></font>WriteLineRight<font color="#000080">( </font>YPosition<font color="#000080">, </font>Text <font color="#000080">);
            </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

      </font>RestoreCurrentFont<font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font><font color="#008000"><i>{ Does the user desire a box around the footer? }

   </i></font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>FooterCoordinates<font color="#000080">.</font>Boxed <font color="#000080">= </font>True <font color="#000080">) </font><font color="#FF0000"><b>Then
      Begin
      If </b></font><font color="#000080">( </font>FooterCoordinates<font color="#000080">.</font>Shading <font color="#000080">&gt; </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
         </b></font>DrawBoxShaded<font color="#000080">( </font>FooterCoordinates<font color="#000080">.</font>XTop<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>YTop<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>XBottom<font color="#000080">,
            </font>FooterCoordinates<font color="#000080">.</font>YBottom<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>LineWidth<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>Shading <font color="#000080">)
      </font><font color="#FF0000"><b>Else
         </b></font>DrawBox<font color="#000080">( </font>FooterCoordinates<font color="#000080">.</font>XTop<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>YTop<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>XBottom<font color="#000080">,
            </font>FooterCoordinates<font color="#000080">.</font>YBottom<font color="#000080">,</font>FooterCoordinates<font color="#000080">.</font>LineWidth <font color="#000080">);
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>AutoPaging <font color="#000080">:= </font>Temp<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SaveCurrentFont<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>CurrentFontName <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Name<font color="#000080">;
   </font>CurrentFontSize <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Size<font color="#000080">;
   </font>CurrentFontStyle <font color="#000080">:= </font>Printer<font color="#000080">.</font>Canvas<font color="#000080">.</font>Font<font color="#000080">.</font>Style<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;                                       


</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>RestoreCurrentFont<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>SetFontInformation<font color="#000080">( </font>CurrentFontName<font color="#000080">,</font>CurrentFontSize<font color="#000080">,</font>CurrentFontStyle <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetDetailTopBottom<font color="#000080">( </font>Top<font color="#000080">: </font>Single<font color="#000080">; </font>Bottom<font color="#000080">: </font>Single <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>DetailTop <font color="#000080">:= </font>Top<font color="#000080">;
   </font>DetailBottom <font color="#000080">:= </font>Bottom<font color="#000080">;

   </font>LastYPosition <font color="#000080">:= </font>Top <font color="#000080">- </font>GetLineHeightInches<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetAutoPaging<font color="#000080">( </font>Value<font color="#000080">: </font>Boolean <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>AutoPaging <font color="#000080">:= </font>Value<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetPageNumberInformation<font color="#000080">( </font>YPosition<font color="#000080">:</font>Single<font color="#000080">; </font>Text<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>Alignment<font color="#000080">:</font>Word<font color="#000080">; </font>FontName<font color="#000080">:</font><font color="#FF0000"><b>String</b></font><font color="#000080">; 
   </font>FontSize<font color="#000080">:</font>Word<font color="#000080">; </font>FontStyle<font color="#000080">:</font>TFontStyles <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>PageNumber<font color="#000080">.</font>Text <font color="#000080">:= </font>Text<font color="#000080">;

   </font>PageNumber<font color="#000080">.</font>YPosition <font color="#000080">:= </font>YPosition<font color="#000080">;
   </font>PageNumber<font color="#000080">.</font>Alignment <font color="#000080">:= </font>Alignment<font color="#000080">;
   </font>PageNumber<font color="#000080">.</font>FontName <font color="#000080">:= </font>FontName<font color="#000080">;
   </font>PageNumber<font color="#000080">.</font>FontSize <font color="#000080">:= </font>FontSize<font color="#000080">;
   </font>PageNumber<font color="#000080">.</font>FontStyle <font color="#000080">:= </font>FontStyle<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>WritePageNumber<font color="#000080">;

   </font><font color="#FF0000"><b>var
      </b></font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
      </font>Temp<font color="#000080">: </font>Boolean<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Buffer <font color="#000080">:= </font>Format<font color="#000080">( </font>PageNumber<font color="#000080">.</font>Text<font color="#000080">,[</font>Printer<font color="#000080">.</font>PageNumber<font color="#000080">] );

   </font>SaveCurrentFont<font color="#000080">;
   </font>SetFontInformation<font color="#000080">( </font>PageNumber<font color="#000080">.</font>FontName<font color="#000080">,</font>PageNumber<font color="#000080">.</font>FontSize<font color="#000080">,</font>PageNumber<font color="#000080">.</font>FontStyle <font color="#000080">);

   </font>Temp <font color="#000080">:= </font>AutoPaging<font color="#000080">;
   </font>AutoPaging <font color="#000080">:= </font>False<font color="#000080">;
                                   

   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>PageNumber<font color="#000080">.</font>Alignment <font color="#000080">= </font><font color="#800000">0 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>WriteLine<font color="#000080">( </font>LeftMargin<font color="#000080">, </font>PageNumber<font color="#000080">.</font>YPosition<font color="#000080">, </font>Buffer <font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>PageNumber<font color="#000080">.</font>Alignment <font color="#000080">= </font><font color="#800000">1 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>WriteLineCenter<font color="#000080">( </font>PageNumber<font color="#000080">.</font>YPosition<font color="#000080">, </font>Buffer <font color="#000080">);
   </font><font color="#FF0000"><b>If </b></font><font color="#000080">( </font>PageNumber<font color="#000080">.</font>Alignment <font color="#000080">= </font><font color="#800000">2 </font><font color="#000080">) </font><font color="#FF0000"><b>Then
      </b></font>WriteLineRight<font color="#000080">( </font>PageNumber<font color="#000080">.</font>YPosition<font color="#000080">, </font>Buffer <font color="#000080">);

   </font>AutoPaging <font color="#000080">:= </font>Temp<font color="#000080">;

   </font>RestoreCurrentFont<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetTab<font color="#000080">( </font>Inches<font color="#000080">:</font>Single <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>CurrentTab <font color="#000080">:= </font>Inches<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetHeaderDimensions<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">;
   </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>HeaderCoordinates<font color="#000080">.</font>XTop <font color="#000080">:= </font>XTop<font color="#000080">;

   </font>HeaderCoordinates<font color="#000080">.</font>XBottom <font color="#000080">:= </font>XBottom<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>YTop <font color="#000080">:= </font>YTop<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>YBottom <font color="#000080">:= </font>YBottom<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>Boxed <font color="#000080">:= </font>Boxed<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>LineWidth <font color="#000080">:= </font>LineWidth<font color="#000080">;
   </font>HeaderCoordinates<font color="#000080">.</font>Shading <font color="#000080">:= </font>Shading<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetFooterDimensions<font color="#000080">( </font>XTop<font color="#000080">:</font>Single<font color="#000080">; </font>YTop<font color="#000080">:</font>Single<font color="#000080">; </font>XBottom<font color="#000080">:</font>Single<font color="#000080">; </font>YBottom<font color="#000080">:</font>Single<font color="#000080">;
   </font>Boxed<font color="#000080">: </font>Boolean<font color="#000080">; </font>LineWidth<font color="#000080">:</font>Word<font color="#000080">; </font>Shading<font color="#000080">:</font>Word <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>FooterCoordinates<font color="#000080">.</font>XTop <font color="#000080">:= </font>XTop<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>XBottom <font color="#000080">:= </font>XBottom<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>YTop <font color="#000080">:= </font>YTop<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>YBottom <font color="#000080">:= </font>YBottom<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>Boxed <font color="#000080">:= </font>Boxed<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>LineWidth <font color="#000080">:= </font>LineWidth<font color="#000080">;
   </font>FooterCoordinates<font color="#000080">.</font>Shading <font color="#000080">:= </font>Shading<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>CreateColumn<font color="#000080">( </font>Number<font color="#000080">:</font>Word<font color="#000080">; </font>XPosition<font color="#000080">:</font>Single<font color="#000080">; </font>Length<font color="#000080">:</font>Single <font color="#000080">);


   </font><font color="#FF0000"><b>Begin
   </b></font>ColumnInformation<font color="#000080">[</font>Number<font color="#000080">].</font>XPosition <font color="#000080">:= </font>XPosition<font color="#000080">;
   </font>ColumnInformation<font color="#000080">[</font>Number<font color="#000080">].</font>Length <font color="#000080">:= </font>Length<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetYPosition<font color="#000080">( </font>YPosition<font color="#000080">:</font>Single <font color="#000080">);

   </font><font color="#FF0000"><b>Begin
   </b></font>LastYPosition <font color="#000080">:= </font>YPosition<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
    
</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetYPosition<font color="#000080">: </font>Single<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Result <font color="#000080">:= </font>LastYPosition<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>NextLine<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>LastYPosition <font color="#000080">:= </font>LastYPosition <font color="#000080">+ </font>GetLineHeightInches<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;   

</font><font color="#FF0000"><b>function </b></font>TPrintObject<font color="#000080">.</font>GetLinesLeft<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#008000"><i>{ Return the number of lines left in the detail area }

   </i></font><font color="#FF0000"><b>var
      </b></font>Lines<font color="#000080">: </font>Single<font color="#000080">;
      </font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">20</font><font color="#000080">];
      </font>I<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>Lines <font color="#000080">:= (</font>DetailBottom <font color="#000080">- </font>LastYPosition<font color="#000080">) / </font>GetLineHeightInches<font color="#000080">;

   </font>Buffer <font color="#000080">:= </font>FloatToStr<font color="#000080">( </font>Lines <font color="#000080">);

   </font><font color="#008000"><i>{ Buffer contains the number of lines left as a floating point number.
     Find the decimal and truncate the string at that point.  So, if there
     are 2.99 lines left, 2 will be returned.  Better to be conservative. }
   </i></font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Length<font color="#000080">(</font>Buffer<font color="#000080">) </font><font color="#FF0000"><b>Do
      Begin
      If </b></font><font color="#000080">( </font>Buffer<font color="#000080">[</font>I<font color="#000080">] = </font><font color="#800000">'.' </font><font color="#000080">) </font><font color="#FF0000"><b>Then
         Begin
         </b></font>Buffer<font color="#000080">[</font><font color="#800000">0</font><font color="#000080">] := </font>Chr<font color="#000080">(</font>I<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">);
         </font>Break<font color="#000080">;
         </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
      </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

   </font>Result <font color="#000080">:= </font>StrToInt<font color="#000080">( </font>Buffer <font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>SetTopOfPage<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   </b></font>LastYPosition <font color="#000080">:= </font>DetailTop<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintObject<font color="#000080">.</font>NewLines<font color="#000080">( </font>Number<font color="#000080">:</font>Word <font color="#000080">);


   </font><font color="#008000"><i>{ Generate the number of line feeds represented in 'Number' }

   </i></font><font color="#FF0000"><b>var
      </b></font>I<font color="#000080">: </font>Word<font color="#000080">;

   </font><font color="#FF0000"><b>Begin
   For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font>Number <font color="#FF0000"><b>Do
      </b></font>NextLine<font color="#000080">;
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.

</font><font color="#008000"><i>{******* demo.pas *******}

</i></font><font color="#FF0000"><b>unit </b></font>Demo<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>ExtCtrls<font color="#000080">, </font>StdCtrls<font color="#000080">, </font>Mask<font color="#000080">, </font>DBCtrls<font color="#000080">, </font>Menus<font color="#000080">, </font>PrnMain<font color="#000080">;

</font><font color="#FF0000"><b>const
  </b></font>LeftMargin <font color="#000080">= </font><font color="#800000">0.5</font><font color="#000080">;
  </font>RightMargin <font color="#000080">= </font><font color="#800000">0.5</font><font color="#000080">;
  </font>TopMargin <font color="#000080">= </font><font color="#800000">0.5</font><font color="#000080">;
  </font>BottomMargin <font color="#000080">= </font><font color="#800000">0.5</font><font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TPrintForm <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
   </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
   </font>Button2<font color="#000080">: </font>TButton<font color="#000080">;
   </font>PixelsPerInch<font color="#000080">: </font>TPanel<font color="#000080">;
   </font>PixelsPerPage<font color="#000080">: </font>TPanel<font color="#000080">;
   </font>Gutters<font color="#000080">: </font>TPanel<font color="#000080">;
   </font>LineHeight<font color="#000080">: </font>TPanel<font color="#000080">;
   </font>FontInformation<font color="#000080">: </font>TPanel<font color="#000080">;

   </font>LinesInDetailArea<font color="#000080">: </font>TPanel<font color="#000080">;
   </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
   </font><font color="#FF0000"><b>procedure </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
   </font><font color="#FF0000"><b>procedure </b></font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
   </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
   </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>PrintForm<font color="#000080">: </font>TPrintForm<font color="#000080">;
  </font>Prn<font color="#000080">: </font>TPrintObject<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TPrintForm<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);

  </font><font color="#FF0000"><b>var
     </b></font>Buffer<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
     </font>Code<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
     </font>ECHOCode<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">[</font><font color="#800000">10</font><font color="#000080">];
     </font>HeaderLine<font color="#000080">: </font>Boolean<font color="#000080">;
     </font>I<font color="#000080">: </font>Word<font color="#000080">;
 
  </font><font color="#FF0000"><b>Begin
  </b></font><font color="#008000"><i>{ Define the dimensions of the header area.  I want the header area
    lightly shaded.  If I wanted no shading, the last parameter would be
    255. }
  </i></font><font color="#FF0000"><b>with </b></font>prn <font color="#FF0000"><b>do 
  begin
    </b></font>SetHeaderDimensions<font color="#000080">( </font><font color="#800000">0.25</font><font color="#000080">,</font><font color="#800000">0.25</font><font color="#000080">,</font><font color="#800000">8.25</font><font color="#000080">,</font><font color="#800000">1.25</font><font color="#000080">,</font>True<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">225 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Define two header lines }
    </i></font>SetHeaderInformation<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0.5</font><font color="#000080">,</font><font color="#800000">'This is header line number 1'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,[</font>fsBold<font color="#000080">] );

    </font>SetHeaderInformation<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1.0</font><font color="#000080">,</font>DateToStr<font color="#000080">(</font>Date<font color="#000080">),</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,[] );

    </font><font color="#008000"><i>{ Define the dimensions of the footer area.  I want the footer area
      lightly shaded.  If I wanted no shading, the last parameter would be
      255. }
    </i></font>SetFooterDimensions<font color="#000080">( </font><font color="#800000">0.25</font><font color="#000080">,</font><font color="#800000">9.40</font><font color="#000080">,</font><font color="#800000">8.25</font><font color="#000080">,</font><font color="#800000">10.20</font><font color="#000080">,</font>True<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#800000">225 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Define two footer lines }
    </i></font>SetFooterInformation<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">9.5</font><font color="#000080">,</font><font color="#800000">'This is footer line number 1'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">14</font><font color="#000080">,[</font>fsBold<font color="#000080">] );
    </font>SetFooterInformation<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">9.85</font><font color="#000080">,</font><font color="#800000">'This is footer line number 2'</font><font color="#000080">,</font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">12</font><font color="#000080">,[</font>fsBold<font color="#000080">] );

    </font><font color="#008000"><i>{ I would like page numbering, right justified on the very bottom of the
      page. }
    </i></font>SetPageNumberInformation<font color="#000080">( </font><font color="#800000">10.25</font><font color="#000080">,</font><font color="#800000">'Page: %d'</font><font color="#000080">,</font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">9</font><font color="#000080">,[</font>fsBold<font color="#000080">] );


    </font><font color="#008000"><i>{ Set the current position to the top of the detail area }
    </i></font>SetTopOfPage<font color="#000080">;

    </font><font color="#008000"><i>{ Write three lines, the first left justified, the second centered and
      the third right justified.  The first line gets printed two inches
      from the top.  The next two lines get printed at the next line from
      the previous line. The '-1' for the first parameter indicates that
      printing should be on the next line.  If '-2' is passed as a 
      parameter, printing would occur on the current line. }
    </i></font>WriteLine<font color="#000080">( -</font><font color="#800000">1.0</font><font color="#000080">,</font><font color="#800000">2.0</font><font color="#000080">,</font><font color="#800000">'This is a line left justified' </font><font color="#000080">);
    </font>WriteLineCenter<font color="#000080">( -</font><font color="#800000">1.0</font><font color="#000080">,</font><font color="#800000">'This is a line centered' </font><font color="#000080">);
    </font>WriteLineRight<font color="#000080">( -</font><font color="#800000">1.0</font><font color="#000080">,</font><font color="#800000">'This is a line right justified' </font><font color="#000080">);


    </font><font color="#008000"><i>{ Create five columns.  The first parameter is the column number, the
      second parameter is the location in inches from the left and the third
      parameter is the length in inches. }
    </i></font>CreateColumn<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,</font><font color="#800000">0.25</font><font color="#000080">,</font><font color="#800000">1.5 </font><font color="#000080">);
    </font>CreateColumn<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,</font><font color="#800000">1.80</font><font color="#000080">,</font><font color="#800000">1.5 </font><font color="#000080">);
    </font>CreateColumn<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,</font><font color="#800000">3.35</font><font color="#000080">,</font><font color="#800000">1.5 </font><font color="#000080">);
    </font>CreateColumn<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">,</font><font color="#800000">4.90</font><font color="#000080">,</font><font color="#800000">1.5 </font><font color="#000080">);
    </font>CreateColumn<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">,</font><font color="#800000">6.50</font><font color="#000080">,</font><font color="#800000">1.5 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Start writing column text (left justified) at three inches from the
      top }
    </i></font>SetYPosition<font color="#000080">( </font><font color="#800000">3.0 </font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">10 </font><font color="#FF0000"><b>Do
       Begin
       </b></font><font color="#008000"><i>{ The first parameter of 'WriteLineColumn' is the column number and
         the second parameter indicates that printing should occur on the
         current line (in this case, three inches from the top).  If the 

         second parameter was -1, printing would occur on the next line. }
       </i></font>WriteLineColumn<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 1, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumn<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 2, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumn<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 3, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumn<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 4, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumn<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 5, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font><font color="#008000"><i>{ Generate a line feed }
       </i></font>NextLine<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ Start writing column text (right justified) at six inches from the 
      top }
    </i></font>SetYPosition<font color="#000080">( </font><font color="#800000">5.0 </font><font color="#000080">);

    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">10 </font><font color="#FF0000"><b>Do
       Begin
       </b></font>WriteLineColumnRight<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 1, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnRight<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 2, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnRight<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 3, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnRight<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 4, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnRight<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 5, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>NextLine<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
                                                             
    </font><font color="#008000"><i>{ Start writing column text (centered) at seven inches from the 
      top }
    </i></font>SetYPosition<font color="#000080">( </font><font color="#800000">7.0 </font><font color="#000080">);
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">10 </font><font color="#FF0000"><b>Do
       Begin
       </b></font>WriteLineColumnCenter<font color="#000080">( </font><font color="#800000">1</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 1, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );

       </font>WriteLineColumnCenter<font color="#000080">( </font><font color="#800000">2</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 2, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnCenter<font color="#000080">( </font><font color="#800000">3</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 3, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnCenter<font color="#000080">( </font><font color="#800000">4</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 4, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>WriteLineColumnCenter<font color="#000080">( </font><font color="#800000">5</font><font color="#000080">,-</font><font color="#800000">2</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'Column 5, Line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );
       </font>NextLine<font color="#000080">;
       </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

    </font><font color="#008000"><i>{ Start a new page }
    </i></font>NewPage<font color="#000080">;

    </font><font color="#008000"><i>{ Change the font information }
    </i></font>SetFontInformation<font color="#000080">( </font><font color="#800000">'Courier'</font><font color="#000080">,</font><font color="#800000">20</font><font color="#000080">,[</font>fsBold<font color="#000080">,</font>fsUnderline<font color="#000080">] );

    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">10 </font><font color="#FF0000"><b>Do
       </b></font>WriteLine<font color="#000080">( </font>LeftMargin<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'This is line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );

    </font><font color="#008000"><i>{ Set a tab of .5 inches }
    </i></font>SetTab<font color="#000080">( </font><font color="#800000">0.5 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Change the font information }
    </i></font>SetFontInformation<font color="#000080">( </font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">10</font><font color="#000080">,[</font>fsItalic<font color="#000080">] );

    </font>NextLine<font color="#000080">;
    </font><font color="#FF0000"><b>For </b></font>I <font color="#000080">:= </font><font color="#800000">1 </font><font color="#FF0000"><b>To </b></font><font color="#800000">10 </font><font color="#FF0000"><b>Do
       </b></font><font color="#008000"><i>{ Since a tab of .5 is set, this text will actually get printed at
         1.0 inches from the left }
       </i></font>WriteLine<font color="#000080">( </font>LeftMargin<font color="#000080">,-</font><font color="#800000">1</font><font color="#000080">,</font>Format<font color="#000080">(</font><font color="#800000">'This is line %d'</font><font color="#000080">,[</font>I<font color="#000080">]) );

    </font><font color="#008000"><i>{ Draw some lines of varying thickness }
    </i></font>DrawLine<font color="#000080">( </font><font color="#800000">2.5</font><font color="#000080">,</font><font color="#800000">5.0</font><font color="#000080">,</font><font color="#800000">6.0</font><font color="#000080">,</font><font color="#800000">8.5</font><font color="#000080">,</font><font color="#800000">5 </font><font color="#000080">);
    </font>DrawLine<font color="#000080">( </font><font color="#800000">6.2</font><font color="#000080">,</font><font color="#800000">5.2</font><font color="#000080">,</font><font color="#800000">3.0</font><font color="#000080">,</font><font color="#800000">8.7</font><font color="#000080">,</font><font color="#800000">20 </font><font color="#000080">);
                                                            
    </font><font color="#008000"><i>{ We're all done.  Always call 'Quit' }
    </i></font>Quit<font color="#000080">;
    </font>Free<font color="#000080">;
    </font>Exit<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintForm<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>X<font color="#000080">,</font>Y<font color="#000080">: </font>Word<font color="#000080">;

  </font>Top<font color="#000080">,</font>Bottom<font color="#000080">,</font>Left<font color="#000080">,</font>Right<font color="#000080">: </font>Word<font color="#000080">;

</font><font color="#FF0000"><b>Begin
    </b></font><font color="#008000"><i>{ Create a TPrintObject }
    </i></font>Prn <font color="#000080">:= </font>TPrintObject<font color="#000080">.</font>Create<font color="#000080">;
</font>	<font color="#FF0000"><b>with </b></font>prn <font color="#FF0000"><b>do 
    begin

    </b></font><font color="#008000"><i>{ Must always call 'Start' first thing }
    </i></font>Start<font color="#000080">;

    </font><font color="#008000"><i>{ Set left, right, top and bottom margins - in inches }
    </i></font>SetMargins<font color="#000080">( </font>LeftMargin<font color="#000080">,</font>RightMargin<font color="#000080">,</font>TopMargin<font color="#000080">,</font>BottomMargin <font color="#000080">);

    </font><font color="#008000"><i>{ Define what the 'detail' section dimensions will be.  The detail section
      is the space between the header and the footer areas. }
    </i></font>SetDetailTopBottom<font color="#000080">( </font><font color="#800000">1.4</font><font color="#000080">,</font><font color="#800000">9.4 </font><font color="#000080">);

    </font><font color="#008000"><i>{ Set default information }
    </i></font>SetFontInformation<font color="#000080">( </font><font color="#800000">'Arial'</font><font color="#000080">,</font><font color="#800000">11</font><font color="#000080">,[] ); 

    </font>GetPixelsPerInch<font color="#000080">( </font>X<font color="#000080">,</font>Y <font color="#000080">);
    </font>PixelsPerInch<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Pixels Per Inch      X: %d  Y: %d'</font><font color="#000080">,[</font>X<font color="#000080">,</font>Y<font color="#000080">] );


    </font>GetPixelsPerPage<font color="#000080">( </font>X<font color="#000080">,</font>Y <font color="#000080">);
    </font>PixelsPerPage<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Pixels Per Page      X: %d  Y: %d'</font><font color="#000080">,[</font>X<font color="#000080">,</font>Y<font color="#000080">] );

    </font>GetGutter<font color="#000080">( </font>Top<font color="#000080">,</font>Bottom<font color="#000080">,</font>Left<font color="#000080">,</font>Right <font color="#000080">);
    </font>Gutters<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Gutters     Top: %d   Bottom: %d   Left: %d   Right: %d'</font><font color="#000080">,[</font>Top<font color="#000080">,</font>Bottom<font color="#000080">,</font>Left<font color="#000080">,</font>Right<font color="#000080">] );

    </font>LineHeight<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Height of Each Line:   %d'</font><font color="#000080">,[</font>GetLineHeightPixels<font color="#000080">] );

    </font>FontInformation<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Font Name: %s     Font Size: %d'</font><font color="#000080">,[</font>GetFontName<font color="#000080">,</font>GetFontSize<font color="#000080">] );

    </font>LinesInDetailArea<font color="#000080">.</font>Caption <font color="#000080">:= </font>Format<font color="#000080">( </font><font color="#800000">'Lines in Detail Area: %d'</font><font color="#000080">,[</font>GetLinesInDetailArea<font color="#000080">] );

</font>	<font color="#FF0000"><b>end</b></font><font color="#000080">; </font><font color="#008000"><i>{with}
</i></font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TPrintForm<font color="#000080">.</font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);

  </font><font color="#FF0000"><b>Begin
  </b></font>Close<font color="#000080">;
  </font>Halt<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.


</font><font color="#008000"><i>{******* project.dpr *******}

</i></font><font color="#FF0000"><b>program </b></font>Project<font color="#000080">;

</font><font color="#FF0000"><b>uses
  </b></font>Forms<font color="#000080">,
  </font>Prnmain <font color="#FF0000"><b>in </b></font><font color="#800000">'PRNMAIN.PAS'</font><font color="#000080">,
  </font>Demo <font color="#FF0000"><b>in </b></font><font color="#800000">'DEMO.PAS' </font><font color="#008000"><i>{PrintForm}</i></font><font color="#000080">;

</font><font color="#008000"><i>{$R *.RES}

</i></font><font color="#FF0000"><b>begin
  </b></font>Application<font color="#000080">.</font>CreateForm<font color="#000080">(</font>TPrintForm<font color="#000080">, </font>PrintForm<font color="#000080">);
  </font>Application<font color="#000080">.</font>Run<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
 

</font><font color="#008000"><i>{******* demo.dfm *******}

</i></font><font color="#FF0000"><b>object </b></font>PrintForm<font color="#000080">: </font>TPrintForm
  Left <font color="#000080">= </font><font color="#800000">104
  </font>Top <font color="#000080">= </font><font color="#800000">90
  </font>BorderIcons <font color="#000080">= [</font>biSystemMenu<font color="#000080">]
  </font>BorderStyle <font color="#000080">= </font>bsDialog
  Caption <font color="#000080">= </font><font color="#800000">'Print Demonstration'
  </font>ClientHeight <font color="#000080">= </font><font color="#800000">317

  </font>ClientWidth <font color="#000080">= </font><font color="#800000">427
  </font>Color <font color="#000080">= </font>clSilver
  Font<font color="#000080">.</font>Color <font color="#000080">= </font>clWindowText
  Font<font color="#000080">.</font>Height <font color="#000080">= -</font><font color="#800000">13
  </font>Font<font color="#000080">.</font>Name <font color="#000080">= </font><font color="#800000">'System'
  </font>Font<font color="#000080">.</font>Style <font color="#000080">= []
  </font>PixelsPerInch <font color="#000080">= </font><font color="#800000">96
  </font>Position <font color="#000080">= </font>poScreenCenter
  OnCreate <font color="#000080">= </font>FormCreate
  TextHeight <font color="#000080">= </font><font color="#800000">16
  </font><font color="#FF0000"><b>object </b></font>Button1<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">276
    </font>Top <font color="#000080">= </font><font color="#800000">270
    </font>Width <font color="#000080">= </font><font color="#800000">61
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Caption <font color="#000080">= </font><font color="#800000">'&amp;Print'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">0
    </font>OnClick <font color="#000080">= </font>Button1Click
  <font color="#FF0000"><b>end
  object </b></font>Button2<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">342
    </font>Top <font color="#000080">= </font><font color="#800000">270
    </font>Width <font color="#000080">= </font><font color="#800000">61
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Cancel <font color="#000080">= </font>True
    Caption <font color="#000080">= </font><font color="#800000">'&amp;Cancel'
    </font>ModalResult <font color="#000080">= </font><font color="#800000">2
    </font>TabOrder <font color="#000080">= </font><font color="#800000">1
    </font>OnClick <font color="#000080">= </font>Button2Click
  <font color="#FF0000"><b>end
  object </b></font>PixelsPerInch<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">12
    </font>Width <font color="#000080">= </font><font color="#800000">415
    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">2
  </font><font color="#FF0000"><b>end
  object </b></font>PixelsPerPage<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">42
    </font>Width <font color="#000080">= </font><font color="#800000">415

    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">3
  </font><font color="#FF0000"><b>end
  object </b></font>Gutters<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">72
    </font>Width <font color="#000080">= </font><font color="#800000">415
    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">4
  </font><font color="#FF0000"><b>end
  object </b></font>LineHeight<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">102
    </font>Width <font color="#000080">= </font><font color="#800000">415
    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">5
  </font><font color="#FF0000"><b>end
  object </b></font>FontInformation<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">132
    </font>Width <font color="#000080">= </font><font color="#800000">415
    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">6
  </font><font color="#FF0000"><b>end
  object </b></font>LinesInDetailArea<font color="#000080">: </font>TPanel
    Left <font color="#000080">= </font><font color="#800000">6
    </font>Top <font color="#000080">= </font><font color="#800000">162
    </font>Width <font color="#000080">= </font><font color="#800000">415
    </font>Height <font color="#000080">= </font><font color="#800000">25
    </font>TabOrder <font color="#000080">= </font><font color="#800000">7
  </font><font color="#FF0000"><b>end
end
</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0162.PAS">Original</a><b>]</b></p></body>
</html>
