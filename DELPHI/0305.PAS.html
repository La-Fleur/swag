<html>
<head><title> "CRT32" by FRANK ZIMMER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0305.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>Implementation of </b></font>Turbo <font color="#FF0000"><b>Pascal </b></font>CRT<font color="#000080">-</font><font color="#FF0000"><b>Unit for </b></font>Win32
Console Subsystem

_________________ Make <font color="#FF0000"><b>file </b></font>CRT32<font color="#000080">.</font>inf ________________________________
filename<font color="#000080">=</font>Crt32
replacements<font color="#000080">=
</font>fileversion<font color="#000080">=</font><font color="#800000">1.0.0127
</font>filedescription<font color="#000080">=</font><font color="#FF0000"><b>Implementation of </b></font>Turbo <font color="#FF0000"><b>Pascal </b></font>CRT<font color="#000080">-</font><font color="#FF0000"><b>Unit for </b></font>Win32 Console Subsystem
target<font color="#000080">=</font>Delphi <font color="#800000">2.0
</font>author name<font color="#000080">=</font>Frank Zimmer
author e<font color="#000080">-</font>mail<font color="#000080">=</font>fzimmer<font color="#000080">@</font>compuserve<font color="#000080">.</font>com
autor URL<font color="#000080">=
</font><font color="#FF0000"><b>file </b></font>status<font color="#000080">=</font>freeware
full source<font color="#000080">=
</font>category<font color="#000080">=</font>Miscellaneous

_________________ Make <font color="#FF0000"><b>file </b></font>CRT32<font color="#000080">.</font>int ________________________________
<font color="#008000"><i>{$APPTYPE CONSOLE}
</i></font><font color="#FF0000"><b>unit </b></font>crt32<font color="#000080">;
</font><font color="#008000"><i>{# freeware}
{# version 1.0.0127}
{# Date 18.01.1997}
{# Author Frank Zimmer}
{# description
 Copyright &copy; 1997, Frank Zimmer, 100703.1602@compuserve.com
 Version: 1.0.0119
 Date:    18.01.1997

 an Implementation of Turbo Pascal CRT-Unit for Win32 Console Subsystem
 testet with Windows NT 4.0
 At Startup you get the Focus to the Console!!!!

 implemention now ( *are not in the original Crt-Unit):
 Procedure and Function:
   ClrScr
   ClrEol
   WhereX
   WhereY
   GotoXY
   InsLine
   DelLine
   HighVideo
   LowVideo
   NormVideo
   TextBackground
   TextColor
   Delay             // use no processtime
   KeyPressed
   ReadKey           // use no processtime
   Sound             // with Windows NT your could use the Variables SoundFrequenz, SoundDuration
   NoSound
   *TextAttribut     // Set TextBackground and TextColor at the same time, usefull for Lastmode
   *FlushInputBuffer // Flush the Keyboard and all other Events
   *ConsoleEnd       // output of 'Press any key' and wait for key input when not pipe
   *Pipe             // True when the output is redirected to a pipe or a file

 Variables:
   WindMin           // the min. WindowRect
   WindMax           // the max. WindowRect
   *ViewMax          // the max. ConsoleBuffer start at (1,1);
   TextAttr          // Actual Attributes only by changing with this Routines
   LastMode          // Last Attributes only by changing with this Routines
   *SoundFrequenz    // with Windows NT your could use thise Variables
   *SoundDuration    // how long bells the speaker  -1 until ??, default = -1
   *HConsoleInput    // the Input-handle;
   *HConsoleOutput   // the Output-handle;
   *HConsoleError    // the Error-handle;


 This Source is freeware, have fun :-)

 History
   23.01.97   Sound, delay, Codepage inserted and setfocus to the console
   24.01.97   Redirected status
}

</i></font><font color="#FF0000"><b>interface
uses </b></font>windows<font color="#000080">,</font>messages<font color="#000080">;
</font><font color="#008000"><i>{$ifdef win32}
</i></font><font color="#FF0000"><b>const
  </b></font>Black           <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>Blue            <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>Green           <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>Cyan            <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>Red             <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>Magenta         <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
  </font>Brown           <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
  </font>LightGray       <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>DarkGray        <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>LightBlue       <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
  </font>LightGreen      <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
  </font>LightCyan       <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
  </font>LightRed        <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
  </font>LightMagenta    <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
  </font>Yellow          <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
  </font>White           <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>WhereX<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>Function </b></font>WhereY<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ClrEol<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>InsLine<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>DelLine<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>GotoXY<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>HighVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>LowVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>NormVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>TextBackground<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>TextColor<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>TextAttribut<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">,</font>Background<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>Delay<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ms<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>function </b></font>KeyPressed<font color="#000080">:</font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>ReadKey<font color="#000080">:</font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>Sound<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>NoSound<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ConsoleEnd<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>FlushInputBuffer<font color="#000080">;
  </font><font color="#FF0000"><b>Function </b></font>Pipe<font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>HConsoleInput<font color="#000080">:</font>thandle<font color="#000080">;
  </font>HConsoleOutput<font color="#000080">:</font>thandle<font color="#000080">;
  </font>HConsoleError<font color="#000080">:</font>Thandle<font color="#000080">;
  </font>WindMin<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>WindMax<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>ViewMax<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>TextAttr <font color="#000080">: </font>Word<font color="#000080">;
  </font>LastMode <font color="#000080">: </font>Word<font color="#000080">;
  </font>SoundFrequenz <font color="#000080">:</font>Integer<font color="#000080">;
  </font>SoundDuration <font color="#000080">: </font>Integer<font color="#000080">;
</font><font color="#008000"><i>{$endif win32}

</i></font><font color="#FF0000"><b>implementation
</b></font>_________________ Make <font color="#FF0000"><b>file </b></font>CRT32<font color="#000080">.</font>pas ________________________________
<font color="#008000"><i>{$APPTYPE CONSOLE}
</i></font><font color="#FF0000"><b>unit </b></font>crt32<font color="#000080">;
</font><font color="#008000"><i>{# freeware}
{# version 1.0.0127}
{# Date 18.01.1997}
{# Author Frank Zimmer}
{# description
 Copyright &copy; 1997, Frank Zimmer, 100703.1602@compuserve.com
 Version: 1.0.0119
 Date:    18.01.1997

 an Implementation of Turbo Pascal CRT-Unit for Win32 Console Subsystem
 testet with Windows NT 4.0
 At Startup you get the Focus to the Console!!!!

 ( with * are not in the original Crt-Unit):
 Procedure and Function:
   ClrScr
   ClrEol
   WhereX
   WhereY
   GotoXY
   InsLine
   DelLine
   HighVideo
   LowVideo
   NormVideo
   TextBackground
   TextColor
   Delay             // use no processtime
   KeyPressed
   ReadKey           // use no processtime
   Sound             // with Windows NT your could use the Variables SoundFrequenz, SoundDuration
   NoSound
   *TextAttribut     // Set TextBackground and TextColor at the same time, usefull for Lastmode
   *FlushInputBuffer // Flush the Keyboard and all other Events
   *ConsoleEnd       // output of 'Press any key' and wait for key input when not pipe
   *Pipe             // True when the output is redirected to a pipe or a file

 Variables:
   WindMin           // the min. WindowRect
   WindMax           // the max. WindowRect
   *ViewMax          // the max. ConsoleBuffer start at (1,1);
   TextAttr          // Actual Attributes only by changing with this Routines
   LastMode          // Last Attributes only by changing with this Routines
   *SoundFrequenz    // with Windows NT your could use these Variables
   *SoundDuration    // how long bells the speaker  -1 until ??, default = -1
   *HConsoleInput    // the Input-handle;
   *HConsoleOutput   // the Output-handle;
   *HConsoleError    // the Error-handle;


 This Source is freeware, have fun :-)

 History
   18.01.97   the first implementation
   23.01.97   Sound, delay, Codepage inserted and setfocus to the console
   24.01.97   Redirected status
}

</i></font><font color="#FF0000"><b>interface
uses </b></font>windows<font color="#000080">,</font>messages<font color="#000080">;
</font><font color="#008000"><i>{$ifdef win32}
</i></font><font color="#FF0000"><b>const
  </b></font>Black           <font color="#000080">= </font><font color="#800000">0</font><font color="#000080">;
  </font>Blue            <font color="#000080">= </font><font color="#800000">1</font><font color="#000080">;
  </font>Green           <font color="#000080">= </font><font color="#800000">2</font><font color="#000080">;
  </font>Cyan            <font color="#000080">= </font><font color="#800000">3</font><font color="#000080">;
  </font>Red             <font color="#000080">= </font><font color="#800000">4</font><font color="#000080">;
  </font>Magenta         <font color="#000080">= </font><font color="#800000">5</font><font color="#000080">;
  </font>Brown           <font color="#000080">= </font><font color="#800000">6</font><font color="#000080">;
  </font>LightGray       <font color="#000080">= </font><font color="#800000">7</font><font color="#000080">;
  </font>DarkGray        <font color="#000080">= </font><font color="#800000">8</font><font color="#000080">;
  </font>LightBlue       <font color="#000080">= </font><font color="#800000">9</font><font color="#000080">;
  </font>LightGreen      <font color="#000080">= </font><font color="#800000">10</font><font color="#000080">;
  </font>LightCyan       <font color="#000080">= </font><font color="#800000">11</font><font color="#000080">;
  </font>LightRed        <font color="#000080">= </font><font color="#800000">12</font><font color="#000080">;
  </font>LightMagenta    <font color="#000080">= </font><font color="#800000">13</font><font color="#000080">;
  </font>Yellow          <font color="#000080">= </font><font color="#800000">14</font><font color="#000080">;
  </font>White           <font color="#000080">= </font><font color="#800000">15</font><font color="#000080">;

  </font><font color="#FF0000"><b>Function </b></font>WhereX<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>Function </b></font>WhereY<font color="#000080">: </font>integer<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ClrEol<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ClrScr<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>InsLine<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>DelLine<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>GotoXY<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>HighVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>LowVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>NormVideo<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>TextBackground<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>TextColor<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>TextAttribut<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">,</font>Background<font color="#000080">:</font>word<font color="#000080">);
  </font><font color="#FF0000"><b>procedure </b></font>Delay<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ms<font color="#000080">:</font>integer<font color="#000080">);
  </font><font color="#FF0000"><b>function </b></font>KeyPressed<font color="#000080">:</font>boolean<font color="#000080">;
  </font><font color="#FF0000"><b>function </b></font>ReadKey<font color="#000080">:</font>Char<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>Sound<font color="#000080">;
  </font><font color="#FF0000"><b>Procedure </b></font>NoSound<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>ConsoleEnd<font color="#000080">;
  </font><font color="#FF0000"><b>procedure </b></font>FlushInputBuffer<font color="#000080">;
  </font><font color="#FF0000"><b>Function </b></font>Pipe<font color="#000080">:</font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>HConsoleInput<font color="#000080">:</font>tHandle<font color="#000080">;
  </font>HConsoleOutput<font color="#000080">:</font>thandle<font color="#000080">;
  </font>HConsoleError<font color="#000080">:</font>Thandle<font color="#000080">;
  </font>WindMin<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>WindMax<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>ViewMax<font color="#000080">:</font>tcoord<font color="#000080">;
  </font>TextAttr <font color="#000080">: </font>Word<font color="#000080">;
  </font>LastMode <font color="#000080">: </font>Word<font color="#000080">;
  </font>SoundFrequenz <font color="#000080">:</font>Integer<font color="#000080">;
  </font>SoundDuration <font color="#000080">: </font>Integer<font color="#000080">;

</font><font color="#008000"><i>{$endif win32}

</i></font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$ifdef win32}
</i></font><font color="#FF0000"><b>uses </b></font>sysutils<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>StartAttr<font color="#000080">:</font>word<font color="#000080">;
  </font>OldCP<font color="#000080">:</font>integer<font color="#000080">;
  </font>CrtPipe <font color="#000080">: </font>Boolean<font color="#000080">;
  </font>German <font color="#000080">: </font>boolean<font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ClrEol<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>tC <font color="#000080">:</font>tCoord<font color="#000080">;
  </font>Len<font color="#000080">,</font>Nw<font color="#000080">: </font>integer<font color="#000080">;
  </font>Cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>len <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>x<font color="#000080">-</font>cbi<font color="#000080">.</font>dwcursorposition<font color="#000080">.</font>x<font color="#000080">;
  </font>tc<font color="#000080">.</font>x <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwcursorposition<font color="#000080">.</font>x<font color="#000080">;
  </font>tc<font color="#000080">.</font>y <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwcursorposition<font color="#000080">.</font>y<font color="#000080">;
  </font>FillConsoleOutputAttribute<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>textattr<font color="#000080">,</font>len<font color="#000080">,</font>tc<font color="#000080">,</font>nw<font color="#000080">);
  </font>FillConsoleOutputCharacter<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font>len<font color="#000080">,</font>tc<font color="#000080">,</font>nw<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ClrScr<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>tc <font color="#000080">:</font>tcoord<font color="#000080">;
  </font>nw<font color="#000080">: </font>integer<font color="#000080">;
  </font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>tc<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>tc<font color="#000080">.</font>y <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>FillConsoleOutputAttribute<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>textattr<font color="#000080">,</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>x<font color="#000080">*</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>y<font color="#000080">,</font>tc<font color="#000080">,</font>nw<font color="#000080">);
  </font>FillConsoleOutputCharacter<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font><font color="#800000">#32</font><font color="#000080">,</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>x<font color="#000080">*</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>y<font color="#000080">,</font>tc<font color="#000080">,</font>nw<font color="#000080">);
  </font>setConsoleCursorPosition<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>tc<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WhereX<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>result <font color="#000080">:= </font>tcoord<font color="#000080">(</font>cbi<font color="#000080">.</font>dwCursorPosition<font color="#000080">).</font>x<font color="#000080">+</font><font color="#800000">1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Function </b></font>WhereY<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>result <font color="#000080">:= </font>tcoord<font color="#000080">(</font>cbi<font color="#000080">.</font>dwCursorPosition<font color="#000080">).</font>y<font color="#000080">+</font><font color="#800000">1
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>GotoXY<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>x<font color="#000080">,</font>y<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>var </b></font>coord <font color="#000080">:</font>tcoord<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>coord<font color="#000080">.</font>x <font color="#000080">:= </font>x<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>coord<font color="#000080">.</font>y <font color="#000080">:= </font>y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>setConsoleCursorPosition<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>coord<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>InsLine<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
 </font>ssr<font color="#000080">:</font>tsmallrect<font color="#000080">;
 </font>coord <font color="#000080">:</font>tcoord<font color="#000080">;
 </font>ci <font color="#000080">:</font>tcharinfo<font color="#000080">;
 </font>nw<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>coord <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwCursorPosition<font color="#000080">;
  </font>ssr<font color="#000080">.</font>left <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ssr<font color="#000080">.</font>top <font color="#000080">:= </font>coord<font color="#000080">.</font>y<font color="#000080">;
  </font>ssr<font color="#000080">.</font>right <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>right<font color="#000080">;
  </font>ssr<font color="#000080">.</font>bottom <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>bottom<font color="#000080">;
  </font>ci<font color="#000080">.</font>asciichar <font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
  </font>ci<font color="#000080">.</font>attributes <font color="#000080">:= </font>cbi<font color="#000080">.</font>wattributes<font color="#000080">;
  </font>coord<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>coord<font color="#000080">.</font>y <font color="#000080">:= </font>coord<font color="#000080">.</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>ScrollConsoleScreenBuffer<font color="#000080">(</font>HconsoleOutput<font color="#000080">,</font>ssr<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>coord<font color="#000080">,</font>ci<font color="#000080">);
  </font>coord<font color="#000080">.</font>y <font color="#000080">:= </font>coord<font color="#000080">.</font>y<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">;
  </font>FillConsoleOutputAttribute<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>textattr<font color="#000080">,</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>x<font color="#000080">*</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>y<font color="#000080">,</font>coord<font color="#000080">,</font>nw<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>DelLine<font color="#000080">;
</font><font color="#FF0000"><b>var
 </b></font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
 </font>ssr<font color="#000080">:</font>tsmallrect<font color="#000080">;
 </font>coord <font color="#000080">:</font>tcoord<font color="#000080">;
 </font>ci <font color="#000080">:</font>tcharinfo<font color="#000080">;
 </font>nw<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">);
  </font>coord <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwCursorPosition<font color="#000080">;
  </font>ssr<font color="#000080">.</font>left <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>ssr<font color="#000080">.</font>top <font color="#000080">:= </font>coord<font color="#000080">.</font>y<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
  </font>ssr<font color="#000080">.</font>right <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>right<font color="#000080">;
  </font>ssr<font color="#000080">.</font>bottom <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>bottom<font color="#000080">;
  </font>ci<font color="#000080">.</font>asciichar <font color="#000080">:= </font><font color="#800000">#32</font><font color="#000080">;
  </font>ci<font color="#000080">.</font>attributes <font color="#000080">:= </font>cbi<font color="#000080">.</font>wattributes<font color="#000080">;
  </font>coord<font color="#000080">.</font>x <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
  </font>coord<font color="#000080">.</font>y <font color="#000080">:= </font>coord<font color="#000080">.</font>y<font color="#000080">;
  </font>ScrollConsoleScreenBuffer<font color="#000080">(</font>HconsoleOutput<font color="#000080">,</font>ssr<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>coord<font color="#000080">,</font>ci<font color="#000080">);
  </font>FillConsoleOutputAttribute<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>textattr<font color="#000080">,</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>x<font color="#000080">*</font>cbi<font color="#000080">.</font>dwsize<font color="#000080">.</font>y<font color="#000080">,</font>coord<font color="#000080">,</font>nw<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TextBackground<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= (</font>color <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>textattr <font color="#FF0000"><b>and </b></font><font color="#800000">$f</font><font color="#000080">);
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TextColor<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= (</font>color <font color="#FF0000"><b>and </b></font><font color="#800000">$f</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>textattr <font color="#FF0000"><b>and </b></font><font color="#800000">$f0</font><font color="#000080">);
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TextAttribut<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>Color<font color="#000080">,</font>Background<font color="#000080">:</font>word<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= (</font>color <font color="#FF0000"><b>and </b></font><font color="#800000">$f</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Background <font color="#FF0000"><b>shl </b></font><font color="#800000">4</font><font color="#000080">);
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>HighVideo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= </font>textattr <font color="#FF0000"><b>or </b></font><font color="#800000">$8</font><font color="#000080">;
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>LowVideo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= </font>textattr <font color="#FF0000"><b>and </b></font><font color="#800000">$f7</font><font color="#000080">;
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>NormVideo<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>LastMode <font color="#000080">:= </font>TextAttr<font color="#000080">;
  </font>textattr <font color="#000080">:= </font>startAttr<font color="#000080">;
  </font>SetConsoleTextAttribute<font color="#000080">(</font>hconsoleoutput<font color="#000080">,</font>textattr<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>FlushInputBuffer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>FlushConsoleInputBuffer<font color="#000080">(</font>hconsoleinput<font color="#000080">)
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>keypressed<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>var </b></font>NumberOfEvents<font color="#000080">:</font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>GetNumberOfConsoleInputEvents<font color="#000080">(</font>hconsoleinput<font color="#000080">,</font>NumberOfEvents<font color="#000080">);
  </font>result <font color="#000080">:= </font>NumberOfEvents <font color="#000080">&gt; </font><font color="#800000">0</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>ReadKey<font color="#000080">: </font>Char<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>NumRead<font color="#000080">:       </font>Integer<font color="#000080">;
  </font>InputRec<font color="#000080">:      </font>TInputRecord<font color="#000080">;
</font><font color="#FF0000"><b>begin
  while not </b></font>ReadConsoleInput<font color="#000080">(</font>HConsoleInput<font color="#000080">,
                             </font>InputRec<font color="#000080">,
                             </font><font color="#800000">1</font><font color="#000080">,
                             </font>NumRead<font color="#000080">) </font><font color="#FF0000"><b>or
           </b></font><font color="#000080">(</font>InputRec<font color="#000080">.</font>EventType <font color="#000080">&lt;&gt; </font>KEY_EVENT<font color="#000080">) </font><font color="#FF0000"><b>do</b></font><font color="#000080">;
  </font>Result <font color="#000080">:= </font>InputRec<font color="#000080">.</font>KeyEvent<font color="#000080">.</font>AsciiChar
<font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>delay<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>ms<font color="#000080">:</font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>sleep<font color="#000080">(</font>ms<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>Sound<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>windows<font color="#000080">.</font>beep<font color="#000080">(</font>SoundFrequenz<font color="#000080">,</font>soundduration<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>Procedure </b></font>NoSound<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>windows<font color="#000080">.</font>beep<font color="#000080">(</font>soundfrequenz<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>ConsoleEnd<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font>isconsole <font color="#FF0000"><b>and not </b></font>crtpipe <font color="#FF0000"><b>then
  begin
    if </b></font>wherex <font color="#000080">&gt; </font><font color="#800000">1 </font><font color="#FF0000"><b>then </b></font>writeln<font color="#000080">;
    </font>textcolor<font color="#000080">(</font>green<font color="#000080">);
    </font>setfocus<font color="#000080">(</font>GetCurrentProcess<font color="#000080">);
    </font><font color="#FF0000"><b>if </b></font>german <font color="#FF0000"><b>then </b></font>write<font color="#000080">(</font><font color="#800000">'Bitte eine Taste dr&uuml;cken!'</font><font color="#000080">)
              </font><font color="#FF0000"><b>else </b></font>write<font color="#000080">(</font><font color="#800000">'Press any key!'</font><font color="#000080">);
    </font>normvideo<font color="#000080">;
    </font>FlushInputBuffer<font color="#000080">;
    </font>ReadKey<font color="#000080">;
    </font>FlushInputBuffer<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>function </b></font>Pipe<font color="#000080">:</font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>result <font color="#000080">:= </font>crtpipe<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>init<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>cbi <font color="#000080">: </font>TConsoleScreenBufferInfo<font color="#000080">;
  </font>tc <font color="#000080">: </font>tcoord<font color="#000080">;
</font><font color="#FF0000"><b>begin
 </b></font>SetActiveWindow<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">);
 </font>HConsoleInput <font color="#000080">:= </font>GetStdHandle<font color="#000080">(</font>STD_InPUT_HANDLE<font color="#000080">);
 </font>HConsoleOutput <font color="#000080">:= </font>GetStdHandle<font color="#000080">(</font>STD_OUTPUT_HANDLE<font color="#000080">);
 </font>HConsoleError <font color="#000080">:= </font>GetStdHandle<font color="#000080">(</font>STD_Error_HANDLE<font color="#000080">);
 </font><font color="#FF0000"><b>if </b></font>getConsoleScreenBufferInfo<font color="#000080">(</font>HConsoleOutput<font color="#000080">,</font>cbi<font color="#000080">) </font><font color="#FF0000"><b>then
 begin
   </b></font>TextAttr <font color="#000080">:= </font>cbi<font color="#000080">.</font>wAttributes<font color="#000080">;
   </font>StartAttr <font color="#000080">:= </font>cbi<font color="#000080">.</font>wAttributes<font color="#000080">;
   </font>lastmode  <font color="#000080">:= </font>cbi<font color="#000080">.</font>wAttributes<font color="#000080">;
   </font>tc<font color="#000080">.</font>x <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>left<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font>tc<font color="#000080">.</font>y <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>top<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font>windmin <font color="#000080">:= </font>tc<font color="#000080">;
   </font>ViewMax <font color="#000080">:= </font>cbi<font color="#000080">.</font>dwsize<font color="#000080">;
   </font>tc<font color="#000080">.</font>x <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>right<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font>tc<font color="#000080">.</font>y <font color="#000080">:= </font>cbi<font color="#000080">.</font>srwindow<font color="#000080">.</font>bottom<font color="#000080">+</font><font color="#800000">1</font><font color="#000080">;
   </font>windmax <font color="#000080">:= </font>tc<font color="#000080">;
   </font>crtpipe <font color="#000080">:= </font>false<font color="#000080">;
 </font><font color="#FF0000"><b>end else </b></font>crtpipe <font color="#000080">:= </font>true<font color="#000080">;
 </font>SoundFrequenz <font color="#000080">:= </font><font color="#800000">1000</font><font color="#000080">;
 </font>SoundDuration <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
 </font>oldCp <font color="#000080">:= </font>GetConsoleoutputCP<font color="#000080">;
 </font>SetConsoleoutputCP<font color="#000080">(</font><font color="#800000">1252</font><font color="#000080">);
 </font>german <font color="#000080">:= </font><font color="#800000">$07 </font><font color="#000080">= (</font>LoWord<font color="#000080">(</font>GetUserDefaultLangID<font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#800000">$3ff</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>initialization
  </b></font>init<font color="#000080">;
</font><font color="#FF0000"><b>finalization
 </b></font>SetConsoleoutputCP<font color="#000080">(</font>oldcp<font color="#000080">);
</font><font color="#008000"><i>{$endif win32}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0305.PAS">Original</a><b>]</b></p></body>
</html>
