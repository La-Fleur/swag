<html>
<head><title> "getting the component index at runtime" by BRAD AISA</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0416.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">From<font color="#000080">: </font>baisa<font color="#000080">@</font>tor<font color="#000080">.</font>hookup<font color="#000080">.</font>net <font color="#000080">(</font>Brad Aisa<font color="#000080">)

</font><font color="#FF0000"><b>In </b></font>article <font color="#000080">&lt;</font><font color="#800000">4</font>uevrf<font color="#800000">$331</font><font color="#000080">@</font>duke<font color="#000080">.</font>telepac<font color="#000080">.</font>pt<font color="#000080">&gt;, </font>delphinidae<font color="#000080">@</font>mail<font color="#000080">.</font>telepac<font color="#000080">.</font>pt <font color="#000080">(</font>Claudio Tereso<font color="#000080">) </font>wrote<font color="#000080">: &gt;</font>i need <font color="#FF0000"><b>to </b></font>find the component index <font color="#FF0000"><b>in </b></font>the parent<font color="#800000">'s order. &gt;i tried to modify prjexp.dll but with success? &gt;does any one have an idea? 

</font>Here <font color="#FF0000"><b>is </b></font>a <font color="#FF0000"><b>function </b></font>that does this<font color="#000080">. </font>It gets the parent control<font color="#000080">, </font><font color="#FF0000"><b>and then </b></font>iterates through its children<font color="#000080">, </font>looking <font color="#FF0000"><b>for </b></font>a match<font color="#000080">. </font>This has been tested <font color="#FF0000"><b>and </b></font>works<font color="#000080">.



--------------------------------------------------------------------------------


</font><font color="#008000"><i>{ function to return index order of a component in its parent's
    component collection; returns -1 if not found or no parent }
</i></font><font color="#FF0000"><b>function </b></font>IndexInParent<font color="#000080">(</font>vControl<font color="#000080">: </font>TControl<font color="#000080">): </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>ParentControl<font color="#000080">: </font>TWinControl<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{we &quot;cousin&quot; cast to get at the protected Parent property in base class }
  </i></font>ParentControl <font color="#000080">:= </font>TForm<font color="#000080">(</font>vControl<font color="#000080">.</font>Parent<font color="#000080">);
  </font><font color="#FF0000"><b>if </b></font><font color="#000080">(</font>ParentControl <font color="#000080">&lt;&gt; </font><font color="#FF0000"><b>nil</b></font><font color="#000080">) </font><font color="#FF0000"><b>then
  begin
    for </b></font>Result <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ParentControl<font color="#000080">.</font>ControlCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
    begin
      if </b></font><font color="#000080">(</font>ParentControl<font color="#000080">.</font>Controls<font color="#000080">[</font>Result<font color="#000080">] = </font>vControl<font color="#000080">) </font><font color="#FF0000"><b>then </b></font>Exit<font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#008000"><i>{ if we make it here, then wasn't found, or didn't have parent}
  </i></font>Result <font color="#000080">:= -</font><font color="#800000">1</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0416.PAS">Original</a><b>]</b></p></body>
</html>
