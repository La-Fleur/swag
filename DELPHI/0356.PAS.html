<html>
<head><title> "Determine if two strings sound alike?" by LLOYD'S HELPFILE</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0356.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#008000"><i>{ This code came from Lloyd's help file! }

</i></font>Soundex <font color="#FF0000"><b>function</b></font><font color="#000080">--</font>determines whether two words sound alike<font color="#000080">. </font>Written after reading an article <font color="#FF0000"><b>in </b></font>PC Magazine about the Soundex algorithm<font color="#000080">. </font>Pass the <font color="#FF0000"><b>function </b></font>a <font color="#FF0000"><b>string</b></font><font color="#000080">. </font>It returns a Soundex value <font color="#FF0000"><b>string</b></font><font color="#000080">. </font>This value can be saved <font color="#FF0000"><b>in </b></font>a database <font color="#FF0000"><b>or </b></font>compared <font color="#FF0000"><b>to </b></font>another Soundex value<font color="#000080">. </font><font color="#FF0000"><b>If </b></font>two words have the same Soundex value<font color="#000080">, </font><font color="#FF0000"><b>then </b></font>they sound alike <font color="#000080">(</font>more <font color="#FF0000"><b>or </b></font>less<font color="#000080">). 
</font>Note that the Soundex algorithm ignores the first letter <font color="#FF0000"><b>of </b></font>a word<font color="#000080">. </font>Thus<font color="#000080">, &quot;</font>won<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font><font color="#000080">&quot;</font>one<font color="#000080">&quot; </font>will have different Soundex values<font color="#000080">, </font>but <font color="#000080">&quot;</font>Won<font color="#000080">&quot; </font><font color="#FF0000"><b>and </b></font><font color="#000080">&quot;</font>Wunn<font color="#000080">&quot; </font>will have the same values<font color="#000080">.

</font>Soundex <font color="#FF0000"><b>is </b></font>especially useful <font color="#FF0000"><b>in </b></font>databases when one does <font color="#FF0000"><b>not </b></font>know how <font color="#FF0000"><b>to </b></font>spell a last name<font color="#000080">.



--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>Function </b></font>Soundex<font color="#000080">(</font>OriginalWord<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Tempstring1<font color="#000080">, </font>Tempstring2<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  </font>Count<font color="#000080">: </font>integer<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>Tempstring1 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>Tempstring2 <font color="#000080">:= </font><font color="#800000">''</font><font color="#000080">;
  </font>OriginalWord <font color="#000080">:= </font>Uppercase<font color="#000080">(</font>OriginalWord<font color="#000080">); </font><font color="#008000"><i>{Make original word uppercase}
  </i></font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font>OriginalWord<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]); </font><font color="#008000"><i>{Use the first letter of the word}
  </i></font><font color="#FF0000"><b>for </b></font>Count <font color="#000080">:= </font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>OriginalWord<font color="#000080">) </font><font color="#FF0000"><b>do
    </b></font><font color="#008000"><i>{Assign a numeric value to each letter, except the first}

    </i></font><font color="#FF0000"><b>case </b></font>OriginalWord<font color="#000080">[</font>Count<font color="#000080">] </font><font color="#FF0000"><b>of
      </b></font><font color="#800000">'B'</font><font color="#000080">,</font><font color="#800000">'F'</font><font color="#000080">,</font><font color="#800000">'P'</font><font color="#000080">,</font><font color="#800000">'V'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'1'</font><font color="#000080">);
      </font><font color="#800000">'C'</font><font color="#000080">,</font><font color="#800000">'G'</font><font color="#000080">,</font><font color="#800000">'J'</font><font color="#000080">,</font><font color="#800000">'K'</font><font color="#000080">,</font><font color="#800000">'Q'</font><font color="#000080">,</font><font color="#800000">'S'</font><font color="#000080">,</font><font color="#800000">'X'</font><font color="#000080">,</font><font color="#800000">'Z'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'2'</font><font color="#000080">);
      </font><font color="#800000">'D'</font><font color="#000080">,</font><font color="#800000">'T'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'3'</font><font color="#000080">);
      </font><font color="#800000">'L'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'4'</font><font color="#000080">);
      </font><font color="#800000">'M'</font><font color="#000080">,</font><font color="#800000">'N'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'5'</font><font color="#000080">);
      </font><font color="#800000">'R'</font><font color="#000080">: </font>Appendstr<font color="#000080">(</font>Tempstring1<font color="#000080">, </font><font color="#800000">'6'</font><font color="#000080">);
      </font><font color="#008000"><i>{All other letters, punctuation and numbers are ignored}
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font>Appendstr<font color="#000080">(</font>Tempstring2<font color="#000080">, </font>OriginalWord<font color="#000080">[</font><font color="#800000">1</font><font color="#000080">]);
  </font><font color="#008000"><i>{Go through the result removing any consecutive duplicate numeric values.}

  </i></font><font color="#FF0000"><b>for </b></font>Count<font color="#000080">:=</font><font color="#800000">2 </font><font color="#FF0000"><b>to </b></font>length<font color="#000080">(</font>Tempstring1<font color="#000080">) </font><font color="#FF0000"><b>do
    if </b></font>Tempstring1<font color="#000080">[</font>Count<font color="#000080">-</font><font color="#800000">1</font><font color="#000080">]&lt;&gt;</font>Tempstring1<font color="#000080">[</font>Count<font color="#000080">] </font><font color="#FF0000"><b>then
        </b></font>Appendstr<font color="#000080">(</font>Tempstring2<font color="#000080">,</font>Tempstring1<font color="#000080">[</font>Count<font color="#000080">]);
  </font>Soundex<font color="#000080">:=</font>Tempstring2<font color="#000080">; </font><font color="#008000"><i>{This is the soundex value}
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------
</font>SoundAlike<font color="#000080">--</font>pass two strings <font color="#FF0000"><b>to </b></font>this <font color="#FF0000"><b>function</b></font><font color="#000080">. </font>It returns True <font color="#FF0000"><b>if </b></font>they sound alike<font color="#000080">, </font>False <font color="#FF0000"><b>if </b></font>they don<font color="#800000">'t. Simply calls the Soundex function. 


</font><font color="#000080">--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>Function </b></font>SoundAlike<font color="#000080">(</font>Word1<font color="#000080">, </font>Word2<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">): </font>boolean<font color="#000080">;
</font><font color="#FF0000"><b>begin
  if </b></font><font color="#000080">(</font>Word1 <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>and </b></font><font color="#000080">(</font>Word2 <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>True
  <font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>Word1 <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>or </b></font><font color="#000080">(</font>Word2 <font color="#000080">= </font><font color="#800000">''</font><font color="#000080">) </font><font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>False
  <font color="#FF0000"><b>else
  if </b></font><font color="#000080">(</font>Soundex<font color="#000080">(</font>Word1<font color="#000080">) = </font>Soundex<font color="#000080">(</font>Word2<font color="#000080">)) </font><font color="#FF0000"><b>then </b></font>result <font color="#000080">:= </font>True
  <font color="#FF0000"><b>else </b></font>result <font color="#000080">:= </font>False<font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0356.PAS">Original</a><b>]</b></p></body>
</html>
