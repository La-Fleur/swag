<html>
<head><title> "Drag And Drop" by GAVIN CARTER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0289.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
If anyone is still intrested I think I've got simple code that works fine.
Just put a list box on the form, and then drag to the box, it will the add
the path of the file to the listbox. }

</i></font><font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">, </font>Forms<font color="#000080">,
</font>Dialogs<font color="#000080">,
  </font>StdCtrls<font color="#000080">, </font>shellapi<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>ListBox1<font color="#000080">: </font>TListBox<font color="#000080">;

   </font><font color="#FF0000"><b>procedure </b></font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private

procedure </b></font>WMDROPFILES<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TWMDROPFILES<font color="#000080">); </font><font color="#FF0000"><b>message </b></font>WM_DROPFILES<font color="#000080">;
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>WMDROPFILES<font color="#000080">(</font><font color="#FF0000"><b>var Message</b></font><font color="#000080">: </font>TWMDROPFILES<font color="#000080">);
</font><font color="#FF0000"><b>const
   </b></font>cnmaxfilenamelen <font color="#000080">= </font><font color="#800000">255</font><font color="#000080">;
</font><font color="#FF0000"><b>var
   </b></font>i<font color="#000080">,</font>ncount <font color="#000080">: </font>integer<font color="#000080">;
   </font>acfilename <font color="#000080">: </font><font color="#FF0000"><b>array </b></font><font color="#000080">[</font><font color="#800000">0</font><font color="#000080">..</font><font color="#800000">255</font><font color="#000080">] </font><font color="#FF0000"><b>of </b></font>char<font color="#000080">;

</font><font color="#FF0000"><b>begin

     </b></font>ncount <font color="#000080">:= </font>dragqueryfile <font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">.</font>drop<font color="#000080">, </font><font color="#800000">$FFFFFFFF</font><font color="#000080">,</font>acfilename<font color="#000080">,</font>cnmaxfilenamelen<font color="#000080">);
     </font><font color="#FF0000"><b>for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ncount <font color="#000080">-</font><font color="#800000">1 </font><font color="#FF0000"><b>do
     begin
     </b></font>dragqueryfile <font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">.</font>drop<font color="#000080">,</font>i<font color="#000080">,</font>acfilename<font color="#000080">,</font>cnmaxfilenamelen<font color="#000080">);
     </font>listbox1<font color="#000080">.</font>items<font color="#000080">.</font>add<font color="#000080">(</font>acfilename<font color="#000080">);
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

     </font>dragfinish<font color="#000080">(</font><font color="#FF0000"><b>message</b></font><font color="#000080">.</font>drop<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
</b></font>DragAcceptFiles<font color="#000080">( </font>Handle<font color="#000080">, </font>True <font color="#000080">);

</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0289.PAS">Original</a><b>]</b></p></body>
</html>
