<html>
<head><title> "TEdit component with Left" by EDDIE SHIPMAN</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0396.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#FF0000"><b>unit </b></font>AlignEdit<font color="#000080">;
</font><font color="#008000"><i>(*
   Edit Component that allows left, centered, or right justified text.
   Be sure to use the MaxLength property to disallow overflow of the
   control.

   This is essentially a multiline control set to be the size of a single
   line edit control, wherein the text alignment is available.

*)
</i></font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Controls<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TAlignEdit <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TEdit<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
    </i></font>FTextAlign <font color="#000080">: </font>TAlignment<font color="#000080">;
    </font>FMaxLength<font color="#000080">: </font>Integer<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>SetTextAlignment<font color="#000080">(</font>Value<font color="#000080">: </font>TAlignment<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetMaxLength<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>CreateWnd<font color="#000080">; </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>protected
    </b></font><font color="#008000"><i>{ Protected declarations }
    </i></font><font color="#FF0000"><b>procedure </b></font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Params<font color="#000080">: </font>TCreateParams<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>published
    </b></font><font color="#008000"><i>{ Published declarations }
    </i></font><font color="#FF0000"><b>property </b></font>MaxLength<font color="#000080">: </font>Integer        <font color="#FF0000"><b>read </b></font>FMaxLength <font color="#FF0000"><b>write </b></font>SetMaxLength
<font color="#FF0000"><b>default </b></font><font color="#800000">0</font><font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Alignment <font color="#000080">: </font>TAlignment <font color="#FF0000"><b>read </b></font>FTextAlign <font color="#FF0000"><b>write </b></font>SetTextAlignment
<font color="#FF0000"><b>default </b></font>taLeftJustify<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;

</font><font color="#FF0000"><b>implementation

procedure </b></font>TAlignEdit<font color="#000080">.</font>CreateParams<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>Params<font color="#000080">: </font>TCreateParams<font color="#000080">);
</font><font color="#FF0000"><b>begin
  inherited </b></font>CreateParams<font color="#000080">(</font>Params<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>Params <font color="#FF0000"><b>do
  begin
    </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>or </b></font>ES_MULTILINE<font color="#000080">;
    </font><font color="#FF0000"><b>case </b></font>FTextAlign <font color="#FF0000"><b>of
    </b></font>taLeftJustify<font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>or </b></font>ES_LEFT<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>taCenter<font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>or </b></font>ES_CENTER<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font>taRightJustify<font color="#000080">:
      </font><font color="#FF0000"><b>begin
        </b></font>Style <font color="#000080">:= </font>Style <font color="#FF0000"><b>or </b></font>ES_RIGHT<font color="#000080">;
      </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
    </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAlignEdit<font color="#000080">.</font>SetTextAlignment<font color="#000080">(</font>Value<font color="#000080">: </font>TAlignment<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FTextAlign <font color="#000080">&lt;&gt; </font>Value <font color="#FF0000"><b>then
  begin
    </b></font>FTextAlign <font color="#000080">:= </font>Value<font color="#000080">;
    </font>RecreateWnd<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAlignEdit<font color="#000080">.</font>SetMaxLength<font color="#000080">(</font>Value<font color="#000080">: </font>Integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FMaxLength <font color="#000080">&lt;&gt; </font>Value <font color="#FF0000"><b>then
  begin
    </b></font>FMaxLength <font color="#000080">:= </font>Value<font color="#000080">;
    </font><font color="#FF0000"><b>if </b></font>HandleAllocated <font color="#FF0000"><b>then </b></font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LIMITTEXT<font color="#000080">, </font>Value<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TAlignEdit<font color="#000080">.</font>CreateWnd<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{
    had to override this method because it was not updating
    the EM_LIMITTEXT when the alignment was set to taLeftJustify
  }
  </i></font><font color="#FF0000"><b>inherited </b></font>CreateWnd<font color="#000080">;
  </font>SendMessage<font color="#000080">(</font>Handle<font color="#000080">, </font>EM_LIMITTEXT<font color="#000080">, </font>FMaxLength<font color="#000080">, </font><font color="#800000">0</font><font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure Register</b></font><font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>RegisterComponents<font color="#000080">(</font><font color="#800000">'Samples'</font><font color="#000080">, [</font>TAlignEdit<font color="#000080">]);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0396.PAS">Original</a><b>]</b></p></body>
</html>
