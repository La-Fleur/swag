<html>
<head><title> "Print from WinWord with DDE" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0163.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
This answer involves opening an existing Word file that has a bookmark already saved.  This code will select and replace the text at the bookmark with our own text, and then it will print.
Note:  The ExecuteMacro() commands are separated into different buttons because of a timing issue.  If you want everything to work from the same procedure, change the TRUE to FALSE.
}
</i></font><font color="#FF0000"><b>unit </b></font>Unit1<font color="#000080">;
</font><font color="#FF0000"><b>interface
uses
  </b></font>SysUtils<font color="#000080">, </font>WinTypes<font color="#000080">, </font>WinProcs<font color="#000080">, </font>Messages<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>DdeMan<font color="#000080">, </font>StdCtrls<font color="#000080">;
</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>DCC<font color="#000080">: </font>TDdeClientConv<font color="#000080">;
    </font>Button2<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Button3<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Button4<font color="#000080">: </font>TButton<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Button3Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>Button4Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;
</font><font color="#FF0000"><b>implementation
</b></font><font color="#008000"><i>{$R *.DFM}
</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>P<font color="#000080">: </font>PChar<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>WinExec<font color="#000080">(</font><font color="#800000">'e:\winapps\winword\winword.exe'</font><font color="#000080">, </font>sw_ShowNormal<font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>DCC <font color="#FF0000"><b>do begin
    </b></font>SetLink<font color="#000080">(</font><font color="#800000">'winword'</font><font color="#000080">, </font><font color="#800000">''</font><font color="#000080">);
    </font><font color="#FF0000"><b>if not </b></font>OpenLink <font color="#FF0000"><b>then
      </b></font>ShowMessage<font color="#000080">(</font><font color="#800000">'Link not established'</font><font color="#000080">)
    </font><font color="#FF0000"><b>else
      </b></font>ExecuteMacro<font color="#000080">(</font><font color="#800000">'[FileOpen(&quot;c:\temp\foobar.doc&quot;)]'</font><font color="#000080">, </font>True<font color="#000080">);
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>DCC<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font><font color="#800000">'[EditGoTo(&quot;TheBookmarkName&quot;)]'</font><font color="#000080">, </font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button3Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>DCC<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font><font color="#800000">'[Insert(&quot;This is the new text that is inserted.&quot;)]'</font><font color="#000080">, </font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button4Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font>DCC<font color="#000080">.</font>ExecuteMacro<font color="#000080">(</font><font color="#800000">'[FilePrint]'</font><font color="#000080">, </font>True<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font><font color="#008000"><i>{****************************************************}
</i></font><font color="#FF0000"><b>object </b></font>Form1<font color="#000080">: </font>TForm1
  Left <font color="#000080">= </font><font color="#800000">202
  </font>Top <font color="#000080">= </font><font color="#800000">102
  </font>Width <font color="#000080">= </font><font color="#800000">403
  </font>Height <font color="#000080">= </font><font color="#800000">89
  </font>Caption <font color="#000080">= </font><font color="#800000">'Form1'
  </font>Font<font color="#000080">.</font>Color <font color="#000080">= </font>clWindowText
  Font<font color="#000080">.</font>Height <font color="#000080">= -</font><font color="#800000">13
  </font>Font<font color="#000080">.</font>Name <font color="#000080">= </font><font color="#800000">'System'
  </font>Font<font color="#000080">.</font>Style <font color="#000080">= []
  </font>PixelsPerInch <font color="#000080">= </font><font color="#800000">96
  </font>TextHeight <font color="#000080">= </font><font color="#800000">16
  </font><font color="#FF0000"><b>object </b></font>Button1<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">8
    </font>Top <font color="#000080">= </font><font color="#800000">16
    </font>Width <font color="#000080">= </font><font color="#800000">89
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Caption <font color="#000080">= </font><font color="#800000">'Open'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">0
    </font>OnClick <font color="#000080">= </font>Button1Click
  <font color="#FF0000"><b>end
  object </b></font>Button2<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">104
    </font>Top <font color="#000080">= </font><font color="#800000">16
    </font>Width <font color="#000080">= </font><font color="#800000">89
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Caption <font color="#000080">= </font><font color="#800000">'Find Bkmk'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">1
    </font>OnClick <font color="#000080">= </font>Button2Click
  <font color="#FF0000"><b>end
  object </b></font>Button3<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">200
    </font>Top <font color="#000080">= </font><font color="#800000">16
    </font>Width <font color="#000080">= </font><font color="#800000">89
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Caption <font color="#000080">= </font><font color="#800000">'Replace'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">2
    </font>OnClick <font color="#000080">= </font>Button3Click
  <font color="#FF0000"><b>end
  object </b></font>Button4<font color="#000080">: </font>TButton
    Left <font color="#000080">= </font><font color="#800000">296
    </font>Top <font color="#000080">= </font><font color="#800000">16
    </font>Width <font color="#000080">= </font><font color="#800000">89
    </font>Height <font color="#000080">= </font><font color="#800000">33
    </font>Caption <font color="#000080">= </font><font color="#800000">'Print'
    </font>TabOrder <font color="#000080">= </font><font color="#800000">3
    </font>OnClick <font color="#000080">= </font>Button4Click
  <font color="#FF0000"><b>end
  object </b></font>DCC<font color="#000080">: </font>TDdeClientConv
    ConnectMode <font color="#000080">= </font>ddeManual
  <font color="#FF0000"><b>end
end
</b></font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0163.PAS">Original</a><b>]</b></p></body>
</html>
