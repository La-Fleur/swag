<html>
<head><title> "Global exception handler" by CHAMI</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0264.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">--------------------------------------------------------------------------------
</font>Although it<font color="#800000">'s easy enough to catch errors (or exceptions) using &quot;try / catch&quot;
</font>blocks<font color="#000080">, </font>some applications might benefit from having a global exception
handler<font color="#000080">. </font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font>you may want your own global exception handler <font color="#FF0000"><b>to
</b></font>handle <font color="#000080">&quot;</font>common<font color="#000080">&quot; </font>errors such <font color="#FF0000"><b>as </b></font><font color="#000080">&quot;</font>divide by zero<font color="#000080">,&quot; &quot;</font><font color="#FF0000"><b>out of </b></font>space<font color="#000080">,&quot; </font>etc<font color="#000080">.
</font>Thanks <font color="#FF0000"><b>to </b></font>TApplication<font color="#800000">'s &quot;OnException&quot; event -- which occurs when an
</font>unhandled exception occurs <font color="#FF0000"><b>in </b></font>your application<font color="#000080">, </font>it only takes three
<font color="#000080">(</font><font color="#FF0000"><b>or </b></font>so<font color="#000080">) </font>easy steps get our own exception handler going<font color="#000080">:</font><font color="#800000">1. </font>Declare your
custom exception handler <font color="#FF0000"><b>in </b></font>your form<font color="#800000">'s &quot;public declarations&quot; section.
</font><font color="#FF0000"><b>For </b></font>example<font color="#000080">, </font><font color="#FF0000"><b>if </b></font>your form <font color="#FF0000"><b>is </b></font>named <font color="#000080">&quot;</font>Form1<font color="#000080">:&quot;

    </font><font color="#008000"><i>{ Public declarations }

    { begin new code }
    </i></font><font color="#FF0000"><b>procedure </b></font>MyExceptionHandler<font color="#000080">(
      </font>Sender <font color="#000080">: </font>TObject<font color="#000080">; </font>E <font color="#000080">: </font>Exception <font color="#000080">);
    </font><font color="#008000"><i>{ end new code }


</i></font><font color="#800000">2. </font>Define your exception handler <font color="#FF0000"><b>in </b></font>the <font color="#000080">&quot;</font><font color="#FF0000"><b>implementation</b></font><font color="#000080">&quot; </font>section<font color="#000080">:

</font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>MyExceptionHandler<font color="#000080">(
  </font>Sender <font color="#000080">: </font>TObject<font color="#000080">; </font>E <font color="#000080">: </font>Exception <font color="#000080">);
</font><font color="#FF0000"><b>var
  </b></font>wRetVal <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font>wRetVal <font color="#000080">:= </font>MessageDlg<font color="#000080">(
    </font><font color="#008000"><i>{
     E.Message contains the
     actual error message
     we'll customize it a bit...
    }
    </i></font><font color="#800000">'ERROR: ' </font><font color="#000080">+ </font>E<font color="#000080">.</font><font color="#FF0000"><b>Message</b></font><font color="#000080">,

    </font>mtError<font color="#000080">,
    </font>mbAbortRetryIgnore<font color="#000080">,
    </font><font color="#800000">0
  </font><font color="#000080">);

  </font><font color="#FF0000"><b>case </b></font>wRetVal <font color="#FF0000"><b>of
    </b></font>mrAbort<font color="#000080">:
    </font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{ handle &quot;Abort&quot; here... }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


    </font>mrRetry<font color="#000080">:
    </font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{ handle &quot;Retry&quot; here... }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font>mrIgnore<font color="#000080">:
    </font><font color="#FF0000"><b>begin
      </b></font><font color="#008000"><i>{ handle &quot;Ignore&quot; here... }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

    </font><font color="#FF0000"><b>else
    begin
      </b></font><font color="#008000"><i>{
       handle &quot;other&quot; action here...
       for example, if user choose to
       close the message box without
       clicking on any buttons
      }
    </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

  </font><font color="#008000"><i>{
   you could also call the default
   exception handler:

     Application.ShowException( E );
  }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font><font color="#800000">3. </font><font color="#FF0000"><b>Finally</b></font><font color="#000080">, </font>assign the newly created exception handler <font color="#FF0000"><b>to </b></font>your
application<font color="#800000">'s OnException event.

</font><font color="#FF0000"><b>procedure
  </b></font>TForm1<font color="#000080">.</font>FormCreate<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ begin new code }
  </i></font>Application<font color="#000080">.</font>OnException <font color="#000080">:=
    </font>MyExceptionHandler<font color="#000080">;
  </font><font color="#008000"><i>{ end new code }
</i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;


</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0264.PAS">Original</a><b>]</b></p></body>
</html>
