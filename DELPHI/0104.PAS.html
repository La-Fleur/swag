<html>
<head><title> "Associate a string with a component" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
Q:  Is there a way to associate a string with each component?

A:  Since the Tag property is a longint, you can type cast it
as a Pointer or PChar.  So, you can basically store a pointer
to a record by using the Tag property.

Note:  You're not going to be able to store the string, or
pointer rather, at design time. This is something you'll have
to do at run time. Take a look at this example:
}
 </i></font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
   for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ComponentCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do

     if </b></font>Components<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>is </b></font>TEdit <font color="#FF0000"><b>then
       </b></font>Components<font color="#000080">[</font>i<font color="#000080">].</font>Tag <font color="#000080">:= </font>LongInt<font color="#000080">(</font>NewStr<font color="#000080">(</font><font color="#800000">'Hello '</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>i<font color="#000080">)));
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Here<font color="#000080">, </font>I loop through the components <font color="#FF0000"><b>on </b></font>the form<font color="#000080">.  </font><font color="#FF0000"><b>If </b></font>the 
component <font color="#FF0000"><b>is </b></font>a TEdit<font color="#000080">, </font>I assign a pointer <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>string to </b></font>its Tag 
<font color="#FF0000"><b>property</b></font><font color="#000080">.  </font>The NewStr <font color="#FF0000"><b>function </b></font>returns a PString <font color="#000080">(</font>pointer <font color="#FF0000"><b>to </b></font>a 
<font color="#FF0000"><b>string</b></font><font color="#000080">).  </font>A pointer <font color="#FF0000"><b>is </b></font>basically the same <font color="#FF0000"><b>as </b></font>a longint <font color="#FF0000"><b>or 
</b></font>better<font color="#000080">, </font>occupies the same number <font color="#FF0000"><b>of </b></font>bytes <font color="#FF0000"><b>in </b></font>memory<font color="#000080">. </font>Therefore<font color="#000080">, 
</font>you can <font color="#FF0000"><b>type </b></font>cast the return value <font color="#FF0000"><b>of </b></font>NewStr <font color="#FF0000"><b>as </b></font>a LongInt <font color="#FF0000"><b>and 
</b></font>store it <font color="#FF0000"><b>in </b></font>the Tag <font color="#FF0000"><b>property of </b></font>the TEdit component<font color="#000080">.  </font>Keep <font color="#FF0000"><b>in 
</b></font>mind that this could have been a pointer <font color="#FF0000"><b>to </b></font>an entire <font color="#FF0000"><b>record</b></font><font color="#000080">.  
</font>Now I<font color="#800000">'ll use that value:

 </font><font color="#FF0000"><b>var
  </b></font>i<font color="#000080">: </font>integer<font color="#000080">;
 </font><font color="#FF0000"><b>begin
   for </b></font>i <font color="#000080">:= </font><font color="#800000">0 </font><font color="#FF0000"><b>to </b></font>ComponentCount <font color="#000080">- </font><font color="#800000">1 </font><font color="#FF0000"><b>do
     if </b></font>Components<font color="#000080">[</font>i<font color="#000080">] </font><font color="#FF0000"><b>is </b></font>TEdit <font color="#FF0000"><b>then begin
       </b></font>TEdit<font color="#000080">(</font>Components<font color="#000080">[</font>i<font color="#000080">]).</font>Text <font color="#000080">:= </font>PString<font color="#000080">(</font>Components<font color="#000080">[</font>i<font color="#000080">].</font>Tag<font color="#000080">)^;
       </font>DisposeStr<font color="#000080">(</font>PString<font color="#000080">(</font>Components<font color="#000080">[</font>i<font color="#000080">].</font>Tag<font color="#000080">));
     </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
 </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Here<font color="#000080">, </font>again I loop through the components <font color="#FF0000"><b>and </b></font>work <font color="#FF0000"><b>on </b></font>only the 
TEdits<font color="#000080">.  </font>This time<font color="#000080">, </font>I extract the value <font color="#FF0000"><b>of </b></font>the component<font color="#800000">'s Tag 
</font><font color="#FF0000"><b>property </b></font>by typecasting it <font color="#FF0000"><b>as </b></font>a PString <font color="#000080">(</font>Pointer <font color="#FF0000"><b>to </b></font>a <font color="#FF0000"><b>string</b></font><font color="#000080">) 
</font><font color="#FF0000"><b>and </b></font>assigning that value <font color="#FF0000"><b>to </b></font>the TEdit<font color="#800000">'s Text property. Of 
</font>course<font color="#000080">, </font>I must dereference it <font color="#FF0000"><b>with </b></font>the caret <font color="#000080">(^) </font>symbol<font color="#000080">.  </font>Once 
I <font color="#FF0000"><b>do </b></font>that<font color="#000080">, </font>I dispose <font color="#FF0000"><b>of </b></font>the <font color="#FF0000"><b>string stored in </b></font>the edit 
component<font color="#000080">.  </font>Important note<font color="#000080">: </font><font color="#FF0000"><b>if </b></font>you store anything <font color="#FF0000"><b>in </b></font>the 
TEdit<font color="#800000">'s Tag property as a pointer, you are responsible for 
</font>disposing <font color="#FF0000"><b>of </b></font>it also<font color="#000080">.

</font>FYI<font color="#000080">, </font>Since Delphi objects are really pointers <font color="#FF0000"><b>to class 
</b></font>instances<font color="#000080">, </font>you can also store objects <font color="#FF0000"><b>in </b></font>the Tag <font color="#FF0000"><b>property</b></font><font color="#000080">. </font><font color="#FF0000"><b>As 
</b></font>long <font color="#FF0000"><b>as </b></font>you remember <font color="#FF0000"><b>to </b></font>Free them<font color="#000080">.

</font>Three methods spring <font color="#FF0000"><b>to </b></font>mind <font color="#FF0000"><b>to </b></font>use Tags <font color="#FF0000"><b>to </b></font>access strings that 
persist from app <font color="#FF0000"><b>to </b></font>app<font color="#000080">.

</font><font color="#800000">1.  </font><font color="#FF0000"><b>If </b></font>your strings stay the same forever<font color="#000080">, </font>create a <font color="#FF0000"><b>string
</b></font>resource <font color="#FF0000"><b>in </b></font>Resource Workshop <font color="#000080">(</font><font color="#FF0000"><b>or </b></font>equiv<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>use the Tags <font color="#FF0000"><b>as 
</b></font>indexes into your <font color="#FF0000"><b>string </b></font>resource<font color="#000080">.

</font><font color="#800000">2.  </font>Use TIniFile <font color="#FF0000"><b>and </b></font>create a section <font color="#FF0000"><b>for </b></font>your strings<font color="#000080">, </font><font color="#FF0000"><b>and 
</b></font>give each <font color="#FF0000"><b>string </b></font>a name <font color="#FF0000"><b>with </b></font>number so that your ini <font color="#FF0000"><b>file </b></font>has a 
section like this<font color="#000080">:

[</font>strings<font color="#000080">]
</font>string1<font color="#000080">=</font>Aristotle
string2<font color="#000080">=</font>Plato
string3<font color="#000080">=</font>Well this <font color="#FF0000"><b>is </b></font>Delphi<font color="#000080">, </font>after all

<font color="#FF0000"><b>Then </b></font>you can fetch them back <font color="#FF0000"><b>out </b></font>this way<font color="#000080">:

  </font><font color="#FF0000"><b>var </b></font>s1<font color="#000080">: </font><font color="#FF0000"><b>string</b></font><font color="#000080">;
  ...
  </font>s1 <font color="#000080">:= </font>IniFile1<font color="#000080">.</font>ReadString<font color="#000080">(</font><font color="#800000">'strings'</font><font color="#000080">, </font><font color="#800000">'string'</font><font color="#000080">+</font>IntToStr<font color="#000080">(</font>Tag<font color="#000080">), </font><font color="#800000">''</font><font color="#000080">);

</font><font color="#800000">3.  </font>Put your strings into a <font color="#FF0000"><b>file</b></font><font color="#000080">, </font><font color="#FF0000"><b>with </b></font>each followed by a
carriage return<font color="#000080">.  </font>Read them into a TStringList<font color="#000080">.  </font><font color="#FF0000"><b>Then </b></font>your Tags
become an index into this stringlist<font color="#000080">:

  </font>StringList1<font color="#000080">.</font>LoadFromFile<font color="#000080">(</font><font color="#800000">'slist.txt'</font><font color="#000080">);
  ...
  </font>s1 <font color="#000080">:= </font>StringList1<font color="#000080">[</font>Tag<font color="#000080">];

</font>Given the way Delphi <font color="#FF0000"><b>is set </b></font>up<font color="#000080">, </font>I think the inifile method <font color="#FF0000"><b>is </b></font>easiest<font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0104.PAS">Original</a><b>]</b></p></body>
</html>
