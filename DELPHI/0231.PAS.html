<html>
<head><title> "Reversing ShortStrings Revisited" by PAUL SOBOLIK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0231.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
In answer to a fellow subscriber's request, I recently posted to this list a
Delphi Assembler procedure to reverse ShortStrings. After someone pointed out
to me in a private message that my routine was slower than his all-Pascal
alternative, I tried again, and managed to come up with an asm procedure that
actually has a (modest) speed advantage. It is presented below, in case
anyone else can use it.

--Paul Sobolik
}
</i></font><font color="#FF0000"><b>procedure </b></font>RevString3<font color="#000080">(</font><font color="#FF0000"><b>var </b></font>s<font color="#000080">: </font>ShortString<font color="#000080">); </font><font color="#FF0000"><b>assembler</b></font><font color="#000080">;
</font><font color="#FF0000"><b>asm
  </b></font><font color="#FF00FF">push esi
  push edi

  mov esi,eax
  mov edi,eax
  xor eax,eax
  lodsb
  add edi,eax
  dec edi
  add eax,2
  shr eax,2
  mov ecx,eax
  jecxz @@done
@@loop:
  mov ax,[esi]
  mov dx,[edi]
  xchg al,ah
  mov [edi],ax
  sub edi,2
  xchg dl,dh
  mov [esi],dx
  add esi,2
  dec ecx
  jnz @@loop
@@done:
  pop edi
  pop esi
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0231.PAS">Original</a><b>]</b></p></body>
</html>
