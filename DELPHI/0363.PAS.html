<html>
<head><title> "D3 : How to copy text from TMemo to Blob" by CHRIS CUMMINGS</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0363.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000080">&gt; </font>I tried <font color="#000080">: </font>Table1BlobField1<font color="#000080">.</font>Assign<font color="#000080">(</font>Memo1<font color="#000080">.</font>lines<font color="#000080">) </font>but this
<font color="#000080">&gt;  </font>won<font color="#800000">'t work. Get an error message telling me that this
</font><font color="#000080">&gt;  </font>field <font color="#FF0000"><b>is not </b></font>a BLOB<font color="#000080">.

</font>I had found this snip <font color="#FF0000"><b>of </b></font>code <font color="#FF0000"><b>in </b></font>a mag<font color="#000080">. </font>some time back<font color="#000080">.  </font>It seems <font color="#FF0000"><b>to
</b></font>work well<font color="#000080">.  </font>It <font color="#FF0000"><b>uses </b></font>a TStringList which should work <font color="#FF0000"><b>with </b></font>the TMemo<font color="#000080">.

</font><font color="#FF0000"><b>procedure </b></font>TMain1<font color="#000080">.</font>ListBoxToDBMemo<font color="#000080">(</font>DestTable<font color="#000080">: </font>TTable<font color="#000080">; </font>Destfield<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
</font>SourceList<font color="#000080">: </font>TStringList<font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>BlobStream1<font color="#000080">: </font>TBlobStream<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>BlobStream1<font color="#000080">:=</font>TBlobStream<font color="#000080">.</font>Create<font color="#000080">(</font>TMemoField<font color="#000080">(</font>DestTable<font color="#000080">.</font>FieldByName<font color="#000080">(
</font>DestField<font color="#000080">)),</font>bmWrite<font color="#000080">);
</font><font color="#FF0000"><b>try
   </b></font>BlobStream1<font color="#000080">.</font>Write<font color="#000080">(</font>SourceList<font color="#000080">.</font>GetText<font color="#000080">^,</font>StrLen<font color="#000080">(</font>SourceList<font color="#000080">.</font>GetText<font color="#000080">));
   </font><font color="#FF0000"><b>finally
      </b></font>BlobStream1<font color="#000080">.</font>free<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMain1<font color="#000080">.</font>DBMemoToListBox<font color="#000080">(</font>SourceTable<font color="#000080">: </font>TTable<font color="#000080">; </font>SourceField<font color="#000080">:
</font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>DestList<font color="#000080">: </font>TStringList<font color="#000080">);
</font><font color="#FF0000"><b>var
</b></font>BlobStream1<font color="#000080">:  </font>TBlobStream<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font>BlobStream1<font color="#000080">:=</font>TBlobStream<font color="#000080">.</font>Create<font color="#000080">(</font>TMemoField<font color="#000080">(</font>SourceTable<font color="#000080">.</font>FieldByName<font color="#000080">(
</font>SourceField<font color="#000080">)),</font>bmRead<font color="#000080">);
</font><font color="#FF0000"><b>try
   </b></font>DestList<font color="#000080">.</font>LoadFromStream<font color="#000080">(</font>BlobStream1<font color="#000080">);
   </font><font color="#FF0000"><b>finally
     </b></font>BlobStream1<font color="#000080">.</font>free<font color="#000080">;
   </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0363.PAS">Original</a><b>]</b></p></body>
</html>
