<html>
<head><title> "CreateProcess. Executing another program" by DANIEL J. WOJCIK</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0395.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code>
<font color="#000000">Hi

<font color="#000080">&gt; </font>From<font color="#000080">:          </font>Ahmad Rosadi Djarkasih <font color="#000080">&lt;</font>djar<font color="#000080">@</font>arjuna<font color="#000080">.</font>telkom<font color="#000080">.</font>net<font color="#000080">.</font>id<font color="#000080">&gt; </font>I
<font color="#000080">&gt; </font>need <font color="#FF0000"><b>to </b></font>exec an app <font color="#FF0000"><b>and </b></font>wait <font color="#FF0000"><b>until </b></font>that particular app <font color="#FF0000"><b>is </b></font>terminated
<font color="#000080">&gt; ? </font>How can I <font color="#FF0000"><b>do </b></font>it <font color="#FF0000"><b>in </b></font><font color="#800000">32 </font>bit environment <font color="#000080">? </font>Since <font color="#FF0000"><b>function
</b></font><font color="#000080">&gt; </font>GetModuleUsage <font color="#FF0000"><b>is </b></font>obsolete <font color="#FF0000"><b>in </b></font>Win32 API<font color="#000080">.

</font>WinExec <font color="#FF0000"><b>and </b></font>WinExecAndWait follow<font color="#000080">:

---------------------------------------------------
 </font>Following are two examples which I<font color="#800000">'ve used to launch other 
</font>applications<font color="#000080">. </font>They have both come <font color="#FF0000"><b>in </b></font>handy<font color="#000080">. </font>Source edited from <font color="#FF0000"><b>public 
</b></font>newsgroup postings<font color="#000080">. </font><font color="#800000">100</font><font color="#000080">% </font>FreeWare<font color="#000080">. </font>All I asked <font color="#FF0000"><b>is</b></font><font color="#000080">: </font>nothing<font color="#000080">!! </font>It<font color="#800000">'s 
</font>free<font color="#000080">, </font><font color="#FF0000"><b>do </b></font>what you want <font color="#FF0000"><b>with </b></font>it<font color="#000080">.

 -</font>Nick Webster
 nwebster<font color="#000080">@</font>circle<font color="#000080">.</font>net
 Some Guy <font color="#FF0000"><b>On </b></font>The Net
 Asheville<font color="#000080">, </font>North Carolina<font color="#000080">. </font>USA

<font color="#008000"><i>{------= Launch Another Program Method One =-----------------------}

 // Path and filename are hard coded  

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button2Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>Var
  </b></font>Fn <font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">;
 </font>TSI <font color="#000080">: </font>TStartupInfo<font color="#000080">;
 </font>TPI <font color="#000080">: </font>TProcessInformation<font color="#000080">;
</font><font color="#FF0000"><b>begin
      </b></font>Fn <font color="#000080">:= </font><font color="#800000">'C:\TEST.EXE'</font><font color="#000080">;
      </font>WndHandle <font color="#000080">:= </font><font color="#800000">0</font><font color="#000080">;
      </font>FillChar<font color="#000080">(</font>TSI<font color="#000080">, </font>SizeOf<font color="#000080">(</font>TSI<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
      </font>TSI<font color="#000080">.</font>CB <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>TSI<font color="#000080">);
       </font><font color="#FF0000"><b>If </b></font>CreateProcess <font color="#000080">(</font>PChar<font color="#000080">(</font>Fn<font color="#000080">), </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">, </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">, </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">, </font>False<font color="#000080">,
       </font>DETACHED_PROCESS<font color="#000080">, </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">,   </font><font color="#FF0000"><b>NIL</b></font><font color="#000080">, </font>TSI<font color="#000080">, </font>TPI<font color="#000080">) </font><font color="#FF0000"><b>Then
     Begin
      </b></font>ShowMessage<font color="#000080">(</font><font color="#800000">'Look I started another program!'</font><font color="#000080">);
     </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{------= End Method One---------------------------------------------}


{-----= Launch Another Program Method Two =-------------------------}

// aCmdLine  Path and filename of file to launch            : String
// aHide     Hide this program while the launched one runs  : Boolean
// aWait     Wait for the launched program to finish        : Boolean 

</i></font><font color="#FF0000"><b>Function </b></font>TForm1<font color="#000080">.</font>FileExec<font color="#000080">(</font><font color="#FF0000"><b>const </b></font>aCmdLine<font color="#000080">: </font><font color="#FF0000"><b>String</b></font><font color="#000080">; </font>aHide<font color="#000080">, </font>aWait<font color="#000080">: </font>Boolean<font color="#000080">):
</font>Boolean<font color="#000080">;
</font><font color="#FF0000"><b>var
  </b></font>StartupInfo <font color="#000080">: </font>TStartupInfo<font color="#000080">;
  </font>ProcessInfo <font color="#000080">: </font>TProcessInformation<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{setup the startup information for the application }
  </i></font>FillChar<font color="#000080">(</font>StartupInfo<font color="#000080">, </font>SizeOf<font color="#000080">(</font>TStartupInfo<font color="#000080">), </font><font color="#800000">0</font><font color="#000080">);
  </font><font color="#FF0000"><b>with </b></font>StartupInfo <font color="#FF0000"><b>do
  Begin
    </b></font>cb <font color="#000080">:= </font>SizeOf<font color="#000080">(</font>TStartupInfo<font color="#000080">);
    </font>dwFlags <font color="#000080">:= </font>STARTF_USESHOWWINDOW <font color="#FF0000"><b>or </b></font>STARTF_FORCEONFEEDBACK<font color="#000080">;
     </font><font color="#FF0000"><b>If </b></font>aHide <font color="#FF0000"><b>Then </b></font>wShowWindow <font color="#000080">:= </font>SW_HIDE
      <font color="#FF0000"><b>else </b></font>wShowWindow <font color="#000080">:= </font>SW_SHOWNORMAL<font color="#000080">;
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;

  </font>Result <font color="#000080">:= </font>CreateProcess<font color="#000080">(</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,</font>PChar<font color="#000080">(</font>aCmdLine<font color="#000080">), </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>False<font color="#000080">,
               </font>NORMAL_PRIORITY_CLASS<font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font><font color="#FF0000"><b>nil</b></font><font color="#000080">, </font>StartupInfo<font color="#000080">, </font>ProcessInfo<font color="#000080">);

  </font><font color="#FF0000"><b>If </b></font>aWait <font color="#FF0000"><b>Then
   If </b></font>Result <font color="#FF0000"><b>Then
    Begin
     </b></font>WaitForInputIdle<font color="#000080">(</font>ProcessInfo<font color="#000080">.</font>hProcess<font color="#000080">, </font>INFINITE<font color="#000080">);
     </font>WaitForSingleObject<font color="#000080">(</font>ProcessInfo<font color="#000080">.</font>hProcess<font color="#000080">, </font>INFINITE<font color="#000080">);
    </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font><font color="#008000"><i>{-----= End Method Two =--------------------------------------------}



</i></font><font color="#000080">--
</font>Daniel J<font color="#000080">. </font>Wojcik
Help prevent forest fires<font color="#000080">...</font>chop down a tree today<font color="#000080">!
--
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0395.PAS">Original</a><b>]</b></p></body>
</html>
