<html>
<head><title> "Windows API about Printer" by RHONDA CROWDER</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0421.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#000000">From<font color="#000080">: </font>David <font color="#FF0000"><b>and </b></font>Rhonda Crowder <font color="#000080">&lt;</font>dcrowder<font color="#000080">@</font>bridge<font color="#000080">.</font>net<font color="#000080">&gt;

&gt;&gt; </font>I want <font color="#FF0000"><b>to </b></font>obtain the values <font color="#000080">(</font>left<font color="#000080">, </font>right<font color="#000080">, </font>top<font color="#000080">, </font>bottom<font color="#000080">) </font><font color="#FF0000"><b>of </b></font><font color="#000080">&quot;</font>unprintable area<font color="#000080">&quot; </font>from the printer<font color="#000080">. 

</font><font color="#FF0000"><b>In </b></font>August Delphi Developer <font color="#000080">&quot;</font>Take Control <font color="#FF0000"><b>of </b></font>your printer <font color="#FF0000"><b>with </b></font>a custom Delphi <font color="#FF0000"><b>Class</b></font><font color="#000080">&quot;: 

</font><font color="#FF0000"><b>To </b></font>get the Left <font color="#FF0000"><b>and </b></font>Top Printer Margins use the Windows Escape <font color="#FF0000"><b>Function with </b></font>the parameter GETPRINTINGOFFSET<font color="#000080">.


--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>var
  </b></font>pntMargins <font color="#000080">: </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{ @ means &quot; the address of the variable&quot; }
  </i></font>Escape<font color="#000080">(</font>Printer<font color="#000080">.</font>Handle<font color="#000080">, </font>GETPRINTINGOFFSET<font color="#000080">,</font><font color="#800000">0</font><font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,@</font>prntMargins<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

--------------------------------------------------------------------------------

</font>Getting the Right <font color="#FF0000"><b>and </b></font>Bottom Margins aren<font color="#800000">'t quite so straightforward. There isn'</font>t an equivalent Escape call<font color="#000080">. </font>You obtain these values by getting the physical width <font color="#000080">(</font>physWidth<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>height <font color="#000080">(</font>physHeight<font color="#000080">) </font><font color="#FF0000"><b>of </b></font>the page<font color="#000080">, </font>the printable width <font color="#000080">(</font>PrintWidth<font color="#000080">) </font><font color="#FF0000"><b>and </b></font>height <font color="#000080">(</font>PrintHeight<font color="#000080">) </font><font color="#FF0000"><b>of </b></font>the page<font color="#000080">, </font><font color="#FF0000"><b>and then </b></font>carrying <font color="#FF0000"><b>out </b></font>the following sums<font color="#000080">:

</font>RightMargin    <font color="#000080">:= </font>physWidth  <font color="#000080">- </font>PrintWidth  <font color="#000080">- </font>LeftMargin
BottomMargin <font color="#000080">:= </font>physHeight <font color="#000080">- </font>PrintHeight <font color="#000080">- </font>TopMargin
The physical page size <font color="#FF0000"><b>is </b></font>found using Escape<font color="#000080">, </font>this time <font color="#FF0000"><b>with </b></font>the GETPHYSPAGESIZE parameter<font color="#000080">. </font>The point pntPageSize <font color="#FF0000"><b>contains </b></font>the page width <font color="#FF0000"><b>in </b></font>pntPageSize<font color="#000080">.</font>x <font color="#FF0000"><b>and </b></font>page height <font color="#FF0000"><b>in </b></font>pntPageSize<font color="#000080">.</font>y


<font color="#000080">--------------------------------------------------------------------------------

</font><font color="#FF0000"><b>var
  </b></font>pntPageSize <font color="#000080">: </font>TPoint<font color="#000080">;
</font><font color="#FF0000"><b>begin
   </b></font>Escape<font color="#000080">(</font>Printer<font color="#000080">.</font>Handle<font color="#000080">, </font>GETPHYSPAGESIZE<font color="#000080">,</font>o<font color="#000080">,</font><font color="#FF0000"><b>nil</b></font><font color="#000080">,@</font>pntPageSize<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0421.PAS">Original</a><b>]</b></p></body>
</html>
