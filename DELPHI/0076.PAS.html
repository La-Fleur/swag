<html>
<head><title> "SetBounds() in DELPHI" by MARK JOHNSON</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>{
If you are designing a new Delphi control and you need to catch
or limit changes to Left, Top, Width, or Height, there is one
simple way to do it.  However, I have yet to see the slightest
hint of how to do it in the Delphi documentation (including
the CWG).

The key to catching changes to Left, Top, Width, Height, and
even BoundsRect in Delphi is the SetBounds() method (found
in TControl and all descendants).  SetBounds() is a virtual
function used to set the position and size of a control
all in one easy step.  However, what they do not tell you
in the documentation is that TControl.SetBounds() is called
by TControl's SetLeft(), SetTop(), SetWidth(), and SetHeight()
property access methods every time a value is assigned to
the Left, Top, Width, Height, and BoundsRect properties.

Thus, to catch changes to these properties, simply override
the SetBounds() method, do whatever you need with the new
values, and then pass them on to the inherited SetBounds()
method.

In the following example, I have a control that automatically
updates its X &amp; Y custom properties to refer to the center
of the control whenever Left, Top, Width, Height, or BoundsRect
are changed.  Conversely, Left and Top will be updated whenever
X &amp; Y are changed: }

</i></font><font color="#FF0000"><b>type
  </b></font>TMyControl <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TControl<font color="#000080">)
  </font><font color="#FF0000"><b>private
    </b></font>FX<font color="#000080">, </font>FY <font color="#000080">: </font>integer<font color="#000080">;
    </font><font color="#008000"><i>{property access methods}
    </i></font><font color="#FF0000"><b>procedure </b></font>SetX<font color="#000080">(</font>value <font color="#000080">: </font>integer<font color="#000080">);
    </font><font color="#FF0000"><b>procedure </b></font>SetY<font color="#000080">(</font>value <font color="#000080">: </font>integer<font color="#000080">);
    ...
  </font><font color="#FF0000"><b>public
    procedure </b></font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    ...
    </font><font color="#FF0000"><b>property </b></font>X <font color="#000080">: </font>integer <font color="#FF0000"><b>read </b></font>FX <font color="#FF0000"><b>write </b></font>SetX<font color="#000080">;
    </font><font color="#FF0000"><b>property </b></font>Y <font color="#000080">: </font>integer <font color="#FF0000"><b>read </b></font>FY <font color="#FF0000"><b>write </b></font>SetY<font color="#000080">;
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;
...

</font><font color="#FF0000"><b>procedure </b></font>TMyControl<font color="#000080">.</font>SetX<font color="#000080">(</font>value <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FX <font color="#000080">&lt;&gt; </font>value <font color="#FF0000"><b>then 
    </b></font>SetBounds<font color="#000080">(</font>value <font color="#000080">- </font>Width <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">, </font>Top<font color="#000080">, </font>Width<font color="#000080">, </font>Height<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyControl<font color="#000080">.</font>SetY<font color="#000080">(</font>value <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>FY <font color="#000080">&lt;&gt; </font>value <font color="#FF0000"><b>then
    </b></font>SetBounds<font color="#000080">(</font>Left<font color="#000080">, </font>value <font color="#000080">- </font>Height <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">, </font>Width<font color="#000080">, </font>Height<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>procedure </b></font>TMyControl<font color="#000080">.</font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  </b></font><font color="#008000"><i>{Go ahead and let SetBounds() do its thing...}
  </i></font><font color="#FF0000"><b>inherited </b></font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight<font color="#000080">);
  </font><font color="#008000"><i>{Now adjust FX and FY according to our new bounds.}
  </i></font>FX <font color="#000080">:= </font>Width <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
  </font>FY <font color="#000080">:= </font>Height <font color="#FF0000"><b>div </b></font><font color="#800000">2</font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font>Also <font color="#FF0000"><b>not </b></font>mentioned <font color="#FF0000"><b>in </b></font>the documentation <font color="#FF0000"><b>is </b></font>the fact that the
FLeft<font color="#000080">, </font>FTop<font color="#000080">, </font>FWidth<font color="#000080">, </font><font color="#FF0000"><b>and </b></font>FHeight <font color="#FF0000"><b>private </b></font>fields that TControl
<font color="#FF0000"><b>uses to </b></font>keep track <font color="#FF0000"><b>of </b></font>its bounding rectangle are <font color="#FF0000"><b>not </b></font>updated
<font color="#FF0000"><b>in </b></font>the corresponding SetLeft<font color="#000080">(), </font>SetTop<font color="#000080">(), </font>etc<font color="#000080">. </font><font color="#FF0000"><b>property </b></font>access
methods<font color="#000080">.  </font>These variables<font color="#000080">, </font><font color="#FF0000"><b>in </b></font>fact<font color="#000080">, </font><font color="#FF0000"><b>do not </b></font>get updated anywhere
<font color="#FF0000"><b>except in </b></font>TControl<font color="#800000">'s SetBounds() method (as with FX and FY in
</font>the above example<font color="#000080">).

</font>So<font color="#000080">, </font><font color="#FF0000"><b>to </b></font>limit changes <font color="#FF0000"><b>to </b></font>the bounds <font color="#FF0000"><b>of </b></font>your control<font color="#000080">, </font>you can
<font color="#FF0000"><b>override </b></font>SetBounds<font color="#000080">() </font><font color="#FF0000"><b>to </b></font>check <font color="#FF0000"><b>and </b></font>modify any <font color="#FF0000"><b>of </b></font>the properties
before passing the values <font color="#FF0000"><b>on to </b></font>the <font color="#FF0000"><b>inherited </b></font>SetBounds<font color="#000080">()
</font>method<font color="#000080">.

</font><font color="#FF0000"><b>In </b></font>the following example<font color="#000080">, </font>I have a control that limits its
width <font color="#FF0000"><b>and </b></font>height <font color="#FF0000"><b>to </b></font>no more than <font color="#800000">100 </font>pixels<font color="#000080">:

</font><font color="#FF0000"><b>type
  </b></font>TMyControl <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TControl<font color="#000080">)
    ...
  </font><font color="#FF0000"><b>public
    procedure </b></font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight <font color="#000080">: </font>integer<font color="#000080">); </font><font color="#FF0000"><b>override</b></font><font color="#000080">;
    ...
  </font><font color="#FF0000"><b>end</b></font><font color="#000080">;

...
</font><font color="#FF0000"><b>procedure </b></font>TMyControl<font color="#000080">.</font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight <font color="#000080">: </font>integer<font color="#000080">);
</font><font color="#FF0000"><b>begin
  if </b></font>aWidth <font color="#000080">&gt; </font><font color="#800000">100 </font><font color="#FF0000"><b>then
    </b></font>aWidth  <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
  </font><font color="#FF0000"><b>if </b></font>aHeight <font color="#000080">&gt; </font><font color="#800000">100 </font><font color="#FF0000"><b>then
    </b></font>aHeight <font color="#000080">:= </font><font color="#800000">100</font><font color="#000080">;
  </font><font color="#FF0000"><b>inherited </b></font>SetBounds<font color="#000080">(</font>aLeft<font color="#000080">, </font>aTop<font color="#000080">, </font>aWidth<font color="#000080">, </font>aHeight<font color="#000080">);
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0076.PAS">Original</a><b>]</b></p></body>
</html>
