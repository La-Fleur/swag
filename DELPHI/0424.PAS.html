<html>
<head><title> "Using Audio Volume Control API" by SWAG SUPPORT TEAM</title><link rel="STYLESHEET" type="text/css" href="../swagsource.css"></head>
<body><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0424.PAS">Original</a><b>]</b></p><!--StartFragment--><pre><code><font color="#008000"><i>//
</i></font><font color="#FF0000"><b>unit </b></font>WaveUnit<font color="#000080">;

</font><font color="#FF0000"><b>interface

uses
  </b></font>Windows<font color="#000080">, </font>Messages<font color="#000080">, </font>SysUtils<font color="#000080">, </font>Classes<font color="#000080">, </font>Graphics<font color="#000080">, </font>Controls<font color="#000080">,
  </font>Forms<font color="#000080">, </font>Dialogs<font color="#000080">, </font>MMSystem<font color="#000080">, </font>StdCtrls<font color="#000080">;

</font><font color="#FF0000"><b>type
  </b></font>TForm1 <font color="#000080">= </font><font color="#FF0000"><b>class</b></font><font color="#000080">(</font>TForm<font color="#000080">)
    </font>Button1<font color="#000080">: </font>TButton<font color="#000080">;
    </font>Edit1<font color="#000080">: </font>TEdit<font color="#000080">;
    </font>Edit2<font color="#000080">: </font>TEdit<font color="#000080">;
    </font>Memo1<font color="#000080">: </font>TMemo<font color="#000080">;
    </font><font color="#FF0000"><b>procedure </b></font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
  </font><font color="#FF0000"><b>private
    </b></font><font color="#008000"><i>{ Private declarations }
  </i></font><font color="#FF0000"><b>public
    </b></font><font color="#008000"><i>{ Public declarations }
  </i></font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>var
  </b></font>Form1<font color="#000080">: </font>TForm1<font color="#000080">;

</font><font color="#FF0000"><b>implementation

</b></font><font color="#008000"><i>{$R *.DFM}

</i></font><font color="#FF0000"><b>procedure </b></font>TForm1<font color="#000080">.</font>Button1Click<font color="#000080">(</font>Sender<font color="#000080">: </font>TObject<font color="#000080">);
</font><font color="#FF0000"><b>var
 </b></font>NumDevs     <font color="#000080">: </font>Integer<font color="#000080">;
 </font>waveCaps    <font color="#000080">: </font>TWaveOutCaps<font color="#000080">;
 </font>Volume      <font color="#000080">: </font>DWORD<font color="#000080">;
 </font>Left<font color="#000080">, </font>Right <font color="#000080">: </font>Word<font color="#000080">;
 </font>Version     <font color="#000080">: </font>Word<font color="#000080">;
</font><font color="#FF0000"><b>begin
</b></font><font color="#008000"><i>// We should have at least one device
  </i></font>NumDevs <font color="#000080">:= </font>waveOutGetNumDevs<font color="#000080">;
  </font>Edit1<font color="#000080">.</font>Text <font color="#000080">:= </font>Format<font color="#000080">(</font><font color="#800000">'Number of devices is %d'</font><font color="#000080">, [</font>NumDevs<font color="#000080">]);
</font><font color="#008000"><i>// for the 1st device (hard-coded)
// Get Device Caps
  </i></font>waveOutGetDevCaps<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, @</font>waveCaps<font color="#000080">, </font>SizeOf<font color="#000080">(</font>waveCaps<font color="#000080">));
</font><font color="#008000"><i>// Show device caps
  </i></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'I&agrave;&ccedil;&acirc;&agrave;&iacute;&egrave;&aring;: '</font><font color="#000080">+</font>waveCaps<font color="#000080">.</font>szPName<font color="#000080">);
  </font>Version <font color="#000080">:= </font>waveCaps<font color="#000080">.</font>vDriverVersion<font color="#000080">;
  </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font>Format<font color="#000080">(</font><font color="#800000">'A&aring;d&ntilde;&egrave;&yuml; &auml;d&agrave;&eacute;&acirc;&aring;d&agrave;: %d.%d'</font><font color="#000080">, [</font>Hi<font color="#000080">(</font>Version<font color="#000080">), </font>Lo<font color="#000080">(</font>Version<font color="#000080">)]));
  </font><font color="#FF0000"><b>Case </b></font>waveCaps<font color="#000080">.</font>wChannels <font color="#FF0000"><b>of
    </b></font><font color="#800000">1 </font><font color="#000080">: </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'I&icirc;&iacute;&icirc;'</font><font color="#000080">);
    </font><font color="#800000">2 </font><font color="#000080">: </font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'&Ntilde;&ograve;&aring;d&aring;&icirc;'</font><font color="#000080">);
  </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
 </font><font color="#008000"><i>// Standard formats

 </i></font><font color="#FF0000"><b>If </b></font>waveCaps<font color="#000080">.</font>dwFormats <font color="#FF0000"><b>AND </b></font>WAVE_FORMAT_1M08 <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
  </b></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'11.025 kHz, mono, 8-bit'</font><font color="#000080">);
 </font><font color="#FF0000"><b>If </b></font>waveCaps<font color="#000080">.</font>dwFormats <font color="#FF0000"><b>AND </b></font>WAVE_FORMAT_1M16 <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
  </b></font>Memo1<font color="#000080">.</font>Lines<font color="#000080">.</font>Add<font color="#000080">(</font><font color="#800000">'11.025 kHz, mono, 16-bit'</font><font color="#000080">);
</font><font color="#008000"><i>{
WAVE_FORMAT_1S08	11.025 kHz, stereo, 8-bit
WAVE_FORMAT_1S16	11.025 kHz, stereo, 16-bit
WAVE_FORMAT_2M08	22.05 kHz, mono, 8-bit
WAVE_FORMAT_2M16	22.05 kHz, mono, 16-bit
WAVE_FORMAT_2S08	22.05 kHz, stereo, 8-bit
WAVE_FORMAT_2S16	22.05 kHz, stereo, 16-bit
WAVE_FORMAT_4M08	44.1 kHz, mono, 8-bit
WAVE_FORMAT_4M16	44.1 kHz, mono, 16-bit
WAVE_FORMAT_4S08	44.1 kHz, stereo, 8-bit
WAVE_FORMAT_4S16	44.1 kHz, stereo, 16-bit
}

// If Volume Control Supported
  </i></font><font color="#FF0000"><b>If </b></font>waveCaps<font color="#000080">.</font>dwSupport <font color="#FF0000"><b>AND </b></font>WAVECAPS_VOLUME <font color="#000080">&lt;&gt; </font><font color="#800000">0 </font><font color="#FF0000"><b>Then
   Begin
    </b></font>waveOutGetVolume<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, @</font>Volume<font color="#000080">);
    </font>Left  <font color="#000080">:= </font>LoWord<font color="#000080">(</font>Volume<font color="#000080">);
    </font>Right <font color="#000080">:= </font>HiWord<font color="#000080">(</font>Volume<font color="#000080">);
</font><font color="#008000"><i>// Show values of WAVE Device on volume control panel
    </i></font>Edit2<font color="#000080">.</font>Text <font color="#000080">:= </font>Format<font color="#000080">(</font><font color="#800000">'Left : %d, Right : %d'</font><font color="#000080">, [</font>Left<font color="#000080">, </font>Right<font color="#000080">]);
   </font>waveOutSetVolume<font color="#000080">(</font><font color="#800000">0</font><font color="#000080">, </font><font color="#800000">$40008000</font><font color="#000080">);
   </font><font color="#FF0000"><b>End</b></font><font color="#000080">;
</font><font color="#FF0000"><b>end</b></font><font color="#000080">;

</font><font color="#FF0000"><b>end</b></font><font color="#000080">.
</font>
</code></pre><!--EndFragment--><p align="center"><b>[</b><a href="index.html">Back to DELPHI SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="../index.html">Back to Main SWAG index</a><b>]</b>&nbsp;&nbsp;<b>[</b><a href="0424.PAS">Original</a><b>]</b></p></body>
</html>
